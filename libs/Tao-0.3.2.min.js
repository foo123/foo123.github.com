/**
*  Tao
*  A simple, tiny, isomorphic, precise and fast template engine for handling both string and live dom based templates
*
*  @version: 0.3.2
*  https://github.com/foo123/Tao.js
*
**/
!function(e,t,i){"use strict";var s,n="object"==typeof module&&module.exports,l="function"==typeof define&&define.amd;n?module.exports=(module.$deps=module.$deps||{})[t]=module.$deps[t]||i.call(e,{NODE:module})||1:l&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["require","exports","module"],function(t,s,n){return i.call(e,{AMD:n})}):t in e||(e[t]=s=i.call(e,{})||1)&&l&&define(t,[],function(){return s})}(this,"Tao",function(e,t){"use strict";function i(e,t,i){var n;return i=!0===i,e?e.substr&&e.substring?(e=g(e,new RegExp(t.source,"g"),i),n=function l(e){var t,n,r,u,p,h=l.tpl[1],o=h.length,f=[],g="";for(n=0;o>n;n++)t=h[n],r=t[0],p=t[1],u=t[2],r?(i&&!p&&t[3]>-1&&f.length&&(u=u.slice(0,t[3])+"<!--"+f.join("\n")+"-->"+u.slice(t[3]),f=[]),g+=u):(e[s](u)&&(t[3]=String(e[u])),i?p?(g+=t[3],t[4]&&f.push("att:"+t[4]+"|key:"+u+"|"+[t[5],t[3].length].join(","))):g+="<!--key:"+u+"-->"+t[3]+"<!--/key-->":g+=t[3]);return g}):(e=c(e,new RegExp(t.source,""),i),n=function u(e){var t,i,n,l,p,o,f,g,c,d,a,b,x,S,y=u.tpl[0];for(l=h(e),f=l.length,o=0;f>o;o++)if(p=l[o],g=String(e[p]),y[s](p)){for(c=y[p][0],i=0,n=c.length;n>i;i++)c[i][0][r]=g;for(d=y[p][1],i=0,n=d.length;n>i;i++){if(t=d[i],a=t[1],x=a.length,S=x?a[0][r]:"",x>1)for(b=1;x>b;b++)S+=a[b][r];t[0][r]=S}}}):n=function(){},n.tpl=e,n.dispose=function(){n.tpl=null},n}var s="hasOwnProperty",n="lastIndexOf",l="match",r="nodeValue",u="nodeType",p="parentNode",h=Object.keys,o=/[a-zA-Z0-9_\-]/,f=function(e){return parseInt(e,10)},g=function(e,i,l){for(var r,u,p,h,f,g,c,d,a,b,x=[],S=0,y=!1,m=-1,v=0,C=!1,T={};r=i.exec(e);){if(u=i.lastIndex-r[0].length,p=e.slice(S,u),a=-1,l&&(c=p[n]("<"),d=p[n](">"),c>d?(a=-1,C=!0):d>c&&(a=d+1,C=!1)),x.push([1,C,p,a]),C)if(-1<(f=p[n]("="))){for(y="",g=f;f>-1&&o.test(h=p.charAt(--f));)y=h+y;m=u-S-g-2,v=m+r[0].length}else y&&(m=v+u-S-2-1,v+=m+r[0].length);else y=!1,v=0,m=-1;b=r[1]?r[1]:r[0],T[s](b)?T[b].push(x.length):T[b]=[x.length],x.push([0,C,b,t,y,m]),S=i.lastIndex}return p=e.slice(S),a=-1,l&&(c=p[n]("<"),d=p[n](">"),c>d?(a=-1,C=!0):d>c&&(a=d+1,C=!1)),x.push([1,C,p,a]),[T,x]},c=function(e,t,i){var n,h,o,g,c,d,a,b,x,S,y,m,v,C,T,k,w,I,O,j,q;if(h=[],o=[],S=e,S.attributes&&(c=S.attributes.length))if(i&&S.firstChild&&8===S.firstChild[u]&&"att:"===S.firstChild[r].slice(0,4))for(b=S.firstChild[r].split("\n"),c=b.length,C={},g=0;c>g;g++)d=b[g].split("|"),w=d[0].slice(4),y=S.attributes[w],C[s](w)||(C[w]=[1,[]],o.push([y,C[w],S])),C[w][1].push([d[1].slice(4),d[2].split(",").map(f)]);else for(g=0;c>g;g++)y=S.attributes[g],(d=y[r][l](t))&&o.push([0,y,d,S]);if(3===S[u])i&&S.previousSibling&&S.nextSibling&&8===S.previousSibling[u]&&8===S.nextSibling[u]&&"key:"===(m=S.previousSibling[r]).slice(0,4)&&"/key"===S.nextSibling[r]?(d=[S[r],m.slice(4)],h.push([S,d,S[p]])):(d=S[r][l](t))&&h.push([S,d,S[p]]);else if(S.firstChild)for(q=[S=S.firstChild];q.length;){if(S.attributes&&(c=S.attributes.length))if(i&&S.firstChild&&8===S.firstChild[u]&&"att:"===S.firstChild[r].slice(0,4))for(b=S.firstChild[r].split("\n"),c=b.length,C={},g=0;c>g;g++)d=b[g].split("|"),w=d[0].slice(4),y=S.attributes[w],C[s](w)||(C[w]=[1,[]],o.push([y,C[w],S])),C[w][1].push([d[1].slice(4),d[2].split(",").map(f)]);else for(g=0;c>g;g++)y=S.attributes[g],(d=y[r][l](t))&&o.push([y,d,S]);if(S.firstChild)q.push(S=S.firstChild);else{for(3===S[u]&&(i&&S.previousSibling&&S.nextSibling&&8===S.previousSibling[u]&&8===S.nextSibling[u]&&"key:"===(m=S.previousSibling[r]).slice(0,4)&&"/key"===S.nextSibling[r]?(d=[S[r],m.slice(4)],h.push([S,d,S[p]])):(d=S[r][l](t))&&h.push([S,d,S[p]])),S=q.pop();q.length&&!S.nextSibling;)S=q.pop();S.nextSibling&&q.push(S=S.nextSibling)}}for(n={},g=0,c=h.length;c>g;g++)if(a=h[g],j=a[0],d=a[1],S=a[2],k=j[r],k.length>d[0].length){do m=d[1]?d[1]:d[0],v=j.splitText(d.index),j=v.splitText(d[0].length),n[s](m)?n[m][0].push([v,S]):n[m]=[[[v,S]],[]],d=j[r][l](t);while(d)}else m=d[1]?d[1]:d[0],v=j,n[s](m)?n[m][0].push([v,S]):n[m]=[[[v,S]],[]];for(g=0,c=o.length;c>g;g++)if(a=o[g],y=a[0],d=a[1],S=a[2],k=y[r],j=document.createTextNode(k||""),T=[[],[j]],1===d[0])for(b=d[1],x=b.length,O=0,g=0;x>g;g++)I=b[g],m=I[0],v=j.splitText(I[1][0]-O),j=v.splitText(I[1][1]),T[0].push(m),T[1].push(v,j),n[s](m)?(n[m][0].push([v,S]),n[m][1].push([y,T[1],k,S])):n[m]=[[[v,S]],[[y,T[1],k,S]]],O+=I[1][1]+I[1][0];else if(k.length>d[0].length){do m=d[1]?d[1]:d[0],v=j.splitText(d.index),j=v.splitText(d[0].length),T[0].push(m),T[1].push(v,j),n[s](m)?(n[m][0].push([v,S]),n[m][1].push([y,T[1],k,S])):n[m]=[[[v,S]],[[y,T[1],k,S]]],d=j[r][l](t);while(d)}else v=j,m=d[1]?d[1]:d[0],T[0].push(m),n[s](m)?(n[m][0].push([v,S]),n[m][1].push([y,T[1],k,S])):n[m]=[[[v,S]],[[y,T[1],k,S]]];return[n,e]};return i.VERSION="0.3.2",i});