/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.0
* https://github.com/foo123/SciLite
*
**/
!function(t,n,r){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=r.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return r.moduleUri=n.uri,r.call(t)}):n in t||(t[n]=r.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function t(){}var O=Math,N=O.PI,i=O.E,s=1/0,f=NaN,$=1e-15,A=Object.prototype.hasOwnProperty,o=Object.prototype.toString,p=Number.isNaN,b=Array.isArray||function(n){return"[object Array]"===o.call(n)},T={VERSION:"0.9.0",fn:{},op:null,constant:{pi:N,e:i,eps:$,inf:s,Inf:s,nan:f,NaN:f}},m=T.constant,E=T.fn;function g(n){throw"not supported"+(n?" for this input":"")}function _(n,t){return n instanceof t}function d(n){return"function"==typeof n}function q(n){return"[object Object]"===o.call(n)}function I(n){return"string"==typeof n}function z(n){return"number"==typeof n&&!isFinite(n)}function M(n){return"number"==typeof n}function w(n){return Number.isInteger(n)}function u(n){return n instanceof P}function v(n,t){if(M(n)||u(n))return!0;if(!1===t){if(y(n)&&1===n.length)return!0;if(S(n)&&1===n.length&&1===n[0].length)return!0}return!1}function y(n){return b(n)&&v(n[0])}function S(n){return b(n)&&b(n[0])&&v(n[0][0])}function Y(n){return!b(n)}function J(n){return b(n)&&!b(n[0])}function c(n){return b(n)&&b(n[0])}function G(n){return!u(n)||0===n.im}function H(n,t){return M(n)?n:u(n)?t?0===n.im&&n.re:n:y(n)?1===n.length&&H(n[0],t):!!S(n)&&1===n.length&&1===n[0].length&&H(n[0][0],t)}function X(n,t){for(var r=new Array(n),e=0;e<n;++e)r[e]=d(t)?t(e,r):t;return r}function k(n,t,r){for(var e,i,u=new Array(n),o=0;o<n;++o)for(u[o]=i=new Array(t),e=0;e<t;++e)i[e]=d(r)?r(o,e,u):r;return u}function K(n){var t;return b(n)&&(A.call(n,"$mainRet$")?(t=n.$mainRet$,(n=n.map(K)).$mainRet$=K(t)):n=n.map(K)),n}function nn(t,n,r){return!0===t?n:M(n)||r&&u(n)?t(n):b(n)?n.map(function(n){return nn(t,n,r)}):n}function h(n){return I(n)?0<n.length:p(n)?0:M(n)?0!==n:u(n)?h(n.re)||h(n.im):b(n)?0<n.length&&n.length===n.filter(h).length:!0===n}function tn(n,r){return v(r)?v(n)?C(n,r):n.filter(function(n){return tn(n,r)}).length===n.length:!!b(r)&&(v(n)?tn(r,n):n.length===r.length&&n.filter(function(n,t){return tn(n,r[t])}).length===r.length)}function P(n,t,r){var e=this;if(!_(e,P))return new P(n,t,r);u(n)?(e.re=n.re,e.im=n.im):(t=t||0,"polar"===r?(e._rho=O.abs(n),e._theta=t,e.re=e._rho*O.cos(e._theta),e.im=e._rho*O.sin(e._theta)):(e.re=n,e.im=t))}function rn(n){return u(n)?n.im?n.div(n.abs()):O.sign(n.re):O.sign(n)}E.clc=t,E.disp=t,E.clear=t,E.help=t,E.who=t,E.whos=t,E.exist=t,T.exist=function(n,t){return q(t)&&I(n)&&A.call(t,n)?1:0},P.prototype={constructor:P,re:0,im:0,_rho:null,_rho2:null,_theta:null,_str:null,abs:function(n){var t=this;return null==t._rho&&(t._rho=ln(t.re,t.im)),t._rho},norm2:function(){return null==this._rho2&&(this._rho2=O.pow(this.abs(),2)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=0===n.re?(n.im<0?-1:1)*N/2:O.atan(n.im/n.re)),n._theta},add:function(n){return M(n)?new P(this.re+n,this.im):new P(this.re+n.re,this.im+n.im)},sub:function(n){return M(n)?new P(this.re-n,this.im):new P(this.re-n.re,this.im-n.im)},mul:function(n){var t,r,e,i=this;return M(n)?new P(i.re?i.re*n:0,i.im?i.im*n:0):(t=i.re,r=n.re,i=i.im,new P((e=t*(r+(n=n.im)))-n*(t+i),e+r*(i-t)))},div:function(n){var t,r,e,i=this;return M(n)?new P(i.re?i.re/n:0,i.im?i.im/n:0):(e=n.norm2(),t=i.re,r=n.re/e,i=i.im,new P((e=t*(r+(n=-n.im/e)))-n*(t+i),e+r*(i-t)))},pow:function(n){var t,r;return M(n)?new P(O.pow(this.abs(),n),this.angle()*n,"polar"):u(n)?(t=this.abs(),r=this.angle(),new P(O.pow(t,n.re),n.im*O.log(t),"polar").mul(new P(O.exp(-n.im*r),r*n.re,"polar"))):void 0},neg:function(){return new P(-this.re,-this.im)},conj:function(){return new P(this.re,-this.im)},inv:function(){var n=this.norm2();return new P(this.re/n,-this.im/n)},toString:function(){var n=this;return null==n._str&&(n._str=on(n.re)+(n.im<0?" - ":" + ")+on(O.abs(n.im))+"i"),n._str},valueOf:function(){return this.re}};new P(0,1);var en=new P(i,0),un={sign:rn,sqrt:function(n){return n.pow(new P(.5))},exp:function(n){return en.pow(n)},log:function(n){return new P(O.log(n.abs()),n.angle())},sin:function(n){return new P(O.sin(n.re)*O.cosh(n.im),O.cos(n.re)*O.sinh(n.im))},cos:function(n){return new P(O.cos(n.re)*O.cosh(n.im),-O.sin(n.re)*O.sinh(n.im))},tan:function(n){return un.sin(n).div(un.cos(n))},sinh:function(n){return new P(O.sinh(n.re)*O.cos(n.im),O.cosh(n.re)*O.sin(n.im))},cosh:function(n){return new P(O.cosh(n.re)*O.cos(n.im),O.sinh(n.re)*O.sin(n.im))},tanh:function(n){return un.sinh(n).div(un.cosh(n))},asin:null,acos:null,atan:null,asinh:null,acosh:null,atanh:null};function on(n){return p(n)?n="nan":z(n)?n=(n<0?"-":"")+"inf":M(n)?n=w(n)?String(n):n.toFixed(4).replace(/\.0{4}$/,""):u(n)&&(n=String(n)),n}function fn(n){var t;return null==n?n="":I(n)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(n)&&(n="\\text{"+n+"}"):n=p(n)?"\\text{nan}":M(n)?$===n?String($):on(n).split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):u(n)?String(n).split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):S(n)?(t=!1,V(n)>T.MAXPRINTSIZE&&(n=n.map(function(n){return n.slice(0,O.round(T.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-O.round(T.MAXPRINTSIZE/2)))}),t=!0),"\\begin{bmatrix}"+(n=B(n)>T.MAXPRINTSIZE?n.slice(0,O.round(T.MAXPRINTSIZE/2)).concat([X(T.MAXPRINTSIZE,function(n){return O.round(T.MAXPRINTSIZE/2)===n&&t?"\\ddots":"\\vdots"})]).concat(n.slice(1-O.round(T.MAXPRINTSIZE/2))):n).map(function(n){return n.map(fn).join(" & ")}).join(" \\\\ ")+"\\end{bmatrix}"):b(n)?(n=n.length>T.MAXPRINTSIZE?n.slice(0,O.round(T.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(n.slice(1-O.round(T.MAXPRINTSIZE/2))):n).map(fn).join(" \\hskip 1em "):"object"==typeof n||"function"==typeof n?"":String(n),n}function r(n){return b(n)?n.map(r):!u(n)||n.im?n:n.re}function an(n){return b(n)?n.map(an):M(n)?new P(n,0):n}function ln(n,t){n=O.abs(n),t=O.abs(t);var r=0;return 0===n?t:0===t?n:t<n?n*O.sqrt(1+(r=t/n)*r):n<t?t*O.sqrt(1+(r=n/t)*r):n*O.SQRT2}function cn(){var n,t,r,e=0,i=0;if(M(cn.z1))return r=cn.z1,cn.z1=null,r;for(;0===e||1===e;)e=O.random();for(;0===i||1===i;)i=O.random();return t=(n=O.sqrt(-2*O.log(e)))*O.cos(2*N*i),r=n*O.sin(2*N*i),cn.z1=r,t}function C(r,e){if(I(r)){if(I(e))return r===e?1:0;if(v(e))return r===String(e)?1:0;if(y(e))return e.map(function(n){return C(r,n)});if(S(e))return k(B(e),V(e),function(n,t){return C(r,e[n][t])})}else if(M(r)){if(I(e))return String(r)===e?1:0;if(M(e))return r===e?1:0;if(u(e))return e.re===r&&0===e.im?1:0;if(y(e))return e.map(function(n){return C(r,n)});if(S(e))return k(B(e),V(e),function(n,t){return C(r,e[n][t])})}else if(u(r)){if(I(e))return String(r)===e?1:0;if(M(e))return r.re===e&&0===r.im?1:0;if(u(e))return r.re===e.re&&r.im===e.im?1:0;if(y(e))return e.map(function(n){return C(r,n)});if(S(e))return k(B(e),V(e),function(n,t){return C(r,e[n][t])})}else if(y(r)){if(I(e)||v(e))return r.map(function(n){return C(n,e)});if(y(e)){if(r.length!==e.length)throw"eq: inputs have incompatible dimensions";return r.map(function(n,t){return C(n,e[t])})}if(S(e)){if(r.length!==V(e))throw"eq: inputs have incompatible dimensions";return k(B(e),V(e),function(n,t){return C(r[t],e[n][t])})}}else if(S(r)){if(I(e)||v(e))return k(B(r),V(r),function(n,t){return C(r[n][t],e)});if(y(e)){if(V(r)!==e.length)throw"eq: inputs have incompatible dimensions";return k(B(r),V(r),function(n,t){return C(r[n][t],e[t])})}if(S(e)){if(B(r)!==B(e)||V(r)!==V(e))throw"eq: inputs have incompatible dimensions";return k(B(r),V(r),function(n,t){return C(r[n][t],e[n][t])})}}return 0}function L(r,e){if(I(r)){if(I(e))return r<e?1:0;if(v(e))return r<String(e)?1:0;if(y(e))return e.map(function(n){return L(r,n)});if(S(e))return k(B(e),V(e),function(n,t){return L(r,e[n][t])})}else if(M(r)){if(I(e))return String(r)<e?1:0;if(M(e))return r<e?1:0;if(u(e))return e.re<r&&0===e.im?1:0;if(y(e))return e.map(function(n){return L(r,n)});if(S(e))return k(B(e),V(e),function(n,t){return L(r,e[n][t])})}else if(u(r)){if(I(e))return String(r)<e?1:0;if(M(e))return r.re<e&&0===r.im?1:0;if(u(e))return 0;if(y(e))return e.map(function(n){return L(r,n)});if(S(e))return k(B(e),V(e),function(n,t){return L(r,e[n][t])})}else if(y(r)){if(I(e)||v(e))return r.map(function(n){return L(n,e)});if(y(e)){if(r.length!==e.length)throw"lt: inputs have incompatible dimensions";return r.map(function(n,t){return L(n,e[t])})}if(S(e)){if(r.length!==V(e))throw"lt: inputs have incompatible dimensions";return k(B(e),V(e),function(n,t){return L(r[t],e[n][t])})}}else if(S(r)){if(I(e)||v(e))return k(B(r),V(r),function(n,t){return L(r[n][t],e)});if(y(e)){if(V(r)!==e.length)throw"lt: inputs have incompatible dimensions";return k(B(r),V(r),function(n,t){return L(r[n][t],e[t])})}if(S(e)){if(B(r)!==B(e)||V(r)!==V(e))throw"lt: inputs have incompatible dimensions";return k(B(r),V(r),function(n,t){return L(r[n][t],e[n][t])})}}return 0}function a(r,e){if(I(r)){if(I(e))return r<=e?1:0;if(v(e))return r<=String(e)?1:0;if(y(e))return e.map(function(n){return a(r,n)});if(S(e))return k(B(e),V(e),function(n,t){return a(r,e[n][t])})}else if(M(r)){if(I(e))return String(r)<=e?1:0;if(M(e))return r<=e?1:0;if(u(e))return e.re<=r&&0===e.im?1:0;if(y(e))return e.map(function(n){return a(r,n)});if(S(e))return k(B(e),V(e),function(n,t){return a(r,e[n][t])})}else if(u(r)){if(I(e))return String(r)<=e?1:0;if(M(e))return r.re<=e&&0===r.im?1:0;if(u(e))return C(r,e)?1:0;if(y(e))return e.map(function(n){return a(r,n)});if(S(e))return k(B(e),V(e),function(n,t){return a(r,e[n][t])})}else if(y(r)){if(I(e)||v(e))return r.map(function(n){return a(n,e)});if(y(e)){if(r.length!==e.length)throw"le: inputs have incompatible dimensions";return r.map(function(n,t){return a(n,e[t])})}if(S(e)){if(r.length!==V(e))throw"le: inputs have incompatible dimensions";return k(B(e),V(e),function(n,t){return a(r[t],e[n][t])})}}else if(S(r)){if(I(e)||v(e))return k(B(r),V(r),function(n,t){return a(r[n][t],e)});if(y(e)){if(V(r)!==e.length)throw"le: inputs have incompatible dimensions";return k(B(r),V(r),function(n,t){return a(r[n][t],e[t])})}if(S(e)){if(B(r)!==B(e)||V(r)!==V(e))throw"le: inputs have incompatible dimensions";return k(B(r),V(r),function(n,t){return a(r[n][t],e[n][t])})}}return 0}function Z(n,t){return M(n)&&M(t)?n+t:u(n)&&v(t)?n.add(t):u(t)&&v(n)?t.add(n):f}function W(n,t){return M(n)&&M(t)?n-t:u(n)&&v(t)?n.sub(t):u(t)&&v(n)?t.neg().add(n):f}function F(n,t){return M(n)&&M(t)?n*t:u(n)&&v(t)?n.mul(t):u(t)&&v(n)?t.mul(n):f}function Q(n,t){return M(n)&&M(t)?n/t:u(n)&&v(t)?n.div(t):u(t)&&v(n)?t.inv().mul(n):f}function sn(n,t){return M(n)&&M(t)?O.pow(n,t):u(n)&&v(t)?n.pow(t):u(t)&&v(n)?new P(n,0).pow(t):f}function hn(n){return M(n)?-n:u(n)?n.neg():f}function D(n){return M(n)?n:u(n)?n.conj():f}function pn(n){return M(n)?0===n?s:1/n:u(n)?0===n.abs()?new P(s,n.im<0?s:-s):n.inv():f}function U(n){return M(n)?O.abs(n):u(n)?n.abs():f}function mn(t,e){if(I(t)&&I(e))return t+e;if(v(t)&&v(e))return Z(t,e);if(S(t)&&S(e)){if(B(t)===B(e)&&V(t)===V(e))return t.map(function(n,r){return n.map(function(n,t){return mn(n,e[r][t])})});throw"add: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return mn(n,e[t])});throw"add: vector dimensions do not match"}return b(t)?t.map(function(n){return mn(n,e)}):b(e)?e.map(function(n){return mn(t,n)}):t}function gn(t,e){if(v(t)&&v(e))return W(t,e);if(S(t)&&S(e)){if(B(t)===B(e)&&V(t)===V(e))return t.map(function(n,r){return n.map(function(n,t){return gn(n,e[r][t])})});throw"sub: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return gn(n,e[t])});throw"sub: vector dimensions do not match"}return b(t)?t.map(function(n){return gn(n,e)}):b(e)?e.map(function(n){return gn(t,n)}):t}function dn(t,e){if(v(t)&&v(e))return F(t,e);if(S(t)&&S(e)){if(B(t)===B(e)&&V(t)===V(e))return t.map(function(n,r){return n.map(function(n,t){return dn(n,e[r][t])})});throw"dotmul: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return dn(n,e[t])});throw"dotmul: vector dimensions do not match"}return b(t)?t.map(function(n){return dn(n,e)}):b(e)?e.map(function(n){return dn(t,n)}):t}function vn(t,e){if(v(t)&&v(e))return Q(t,e);if(S(t)&&S(e)){if(B(t)===B(e)&&V(t)===V(e))return t.map(function(n,r){return n.map(function(n,t){return vn(n,e[r][t])})});throw"dotdiv: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return vn(n,e[t])});throw"dotdiv: vector dimensions do not match"}return b(t)?t.map(function(n){return vn(n,e)}):b(e)?e.map(function(n){return vn(t,n)}):t}function l(i,u){if(v(i)&&v(u))return F(i,u);if(S(i)&&S(u)){if(V(i)===B(u))return n=B(i),t=V(u),o=B(u),k(n,t,function(n,t){for(var r=0,e=0;e<o;++e)r=Z(r,F(i[n][e],u[e][t]));return r});throw"mul: matrix-matrix dimensions do not match"}if(y(i)&&S(u)){if(i.length===B(u))return t=V(u),o=i.length,k(n=1,t,function(n,t){for(var r=0,e=0;e<o;++e)r=Z(r,F(i[e],u[e][t]));return r});throw"mul: vector-matrix dimensions do not match"}if(S(i)&&y(u)){var n,t,o;if(V(i)===u.length)return n=B(i),o=u.length,k(n,t=1,function(n,t){for(var r=0,e=0;e<o;++e)r=Z(r,F(i[n][e],u[e]));return r});throw"mul: matrix-vector dimensions do not match"}return b(i)?i.map(function(n){return l(n,u)}):b(u)?u.map(function(n){return l(i,n)}):i}function yn(n,t){if(v(n)&&v(t))return sn(n,t);if(S(n)&&B(n)===V(n)&&w(t)){if(t<0&&(t=-t,!(n=Bn(n))||!n.length))throw"pow: no inverse";if(0===t)return Cn(B(n));if(1===t)return n;if(2===t)return l(n,n);for(var r=Cn(B(n));0!==t;)1&t&&(r=l(r,n)),0<(t>>=1)&&(n=l(n,n));return r}return n}function wn(n){return nn(function(n){return u(n)?n.re:n},n,!0)}function xn(n){return nn(function(n){return u(n)?n.im:0},n,!0)}function bn(n){return nn(D,n,!0)}function Sn(n){return nn(U,n,!0)}function kn(e,n=":",r=null){if(J(e)){if(y(n)&&n.length===e.length&&Zn(n,function(n){return 0===n||1===n}))return o=1===(o=n.reduce(function(n,t,r){return 1===t&&n.push(e[r]),n},[])).length?o[0]:o;if(":"===(n=v(n)?H(n,!0):n)||w(n)||y(n))return t=e.length,1===(o=(n=w(n=":"===n?Nn(1,t):n)?[n]:n).map(function(n){if(n<1&&(n+=t),n<1||t<n)throw"get: index out of bounds";return e[n-1]})).length?o[0]:o;throw"get: invalid range"}if(c(e)){var i=B(e),u=V(e),t=i*u;if(null==r&&S(n)&&B(n)===i&&V(n)===u&&Zn(n,function(n){return 0===n||1===n})){for(var o=[],f=0;f<u;++f)for(var a=0;a<i;++a)1===n[a][f]&&o.push(e[a][f]);return o=1===o.length?o[0]:o}if(v(n)&&(n=H(n,!0)),v(r)&&(r=H(r,!0)),":"===n||w(n)||y(n)){if(w(n=":"===n?Nn(1,i):n)&&(n=[n]),null==r)return o=1===(o=n.map(function(n){if(n<1&&(n+=t),n<1||t<n)throw"get: index out of bounds";return e[(n-1)%i][O.floor((n-1)/i)]})).length?o[0]:o;if(":"===r||w(r)||y(r))return w(r=":"===r?Nn(1,u):r)&&(r=[r]),o=1===(o=n.map(function(t){if(t<1&&(t+=i),t<1||i<t)throw"get: index out of bounds";return r.map(function(n){if(n<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[t-1][n-1]})})).length&&1===o[0].length?o[0][0]:o}throw"get: invalid range"}return e}function An(i,n=":",u=null,o=null){if(J(i)){if(y(n)&&n.length===i.length&&Zn(n,function(n){return 0===n||1===n})){if(Y(o))return n.forEach(function(n,t){1===n&&(i[t]=o)}),i;if(b(o))return e=0,n.forEach(function(n,t){if(1===n){if(e>=o.length)throw"set: index out of bounds";i[t]=o[e++]}}),i}if(":"===(n=v(n)?H(n,!0):n)||w(n)||y(n)){var r=i.length;if(w(n=":"===n?Nn(1,r):n)&&(n=[n]),Y(o))return n.forEach(function(n){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[n-1]=o}),i;if(b(o)&&o.length>=n.length)return n.forEach(function(n,t){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[n-1]=o[t]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(c(i)){var f=B(i),a=V(i),r=f*a;if(S(n)&&B(n)===f&&V(n)===a&&Zn(n,function(n){return 0===n||1===n})){if(Y(o))return n.forEach(function(n,r){n.forEach(function(n,t){1===n&&(i[r][t]=o)})}),i;if(b(o)){for(var e=0,t=0;t<a;++t)for(var l=0;l<f;++l)if(1===n[l][t]){if(e>=o.length)throw"set: index out of bounds";i[l][t]=o[e++]}return i}}if(v(n)&&(n=H(n,!0)),v(u)&&(u=H(u,!0)),":"===n||w(n)||y(n)){if(null==u){if(w(n=":"===n?Nn(1,r):n)&&(n=[n]),Y(o))return n.forEach(function(n){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[(n-1)%f][O.floor((n-1)/f)]=o}),i;if(J(o)&&o.length>=n.length)return n.forEach(function(n,t){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[(n-1)%f][O.floor((n-1)/f)]=o[t]}),i}else if(":"===u||w(u)||y(u)){if(w(n=":"===n?Nn(1,f):n)&&(n=[n]),w(u=":"===u?Nn(1,a):u)&&(u=[u]),Y(o))return n.forEach(function(t){if(t<1&&(t+=f),t<1||f<t)throw"set: index out of bounds";u.forEach(function(n){if(n<1&&(n+=a),n<1||a<n)throw"set: index out of bounds";i[t-1][n-1]=o})}),i;if(c(o)&&o.length>=n.length&&o[0].length>=u.length)return n.forEach(function(r,e){if(r<1&&(r+=f),r<1||f<r)throw"set: index out of bounds";u.forEach(function(n,t){if(n<1&&(n+=a),n<1||a<n)throw"set: index out of bounds";i[r-1][n-1]=o[e][t]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function Tn(n,t,r){return"horz"===n&&c(t)&&c(r)&&B(t)===B(r)?t.map(function(n,t){return n.concat(r[t])}):"vert"===n&&c(t)&&c(r)&&V(t)===V(r)?t.concat(r):void g(!0)}function En(r,n){if(Y(r))return r;if(J(r))return r.slice().reverse();var e,i;if(c(r))return e=B(r),i=V(r),1===(n=null==n?1:n)?k(e,i,function(n,t){return r[e-1-n][t]}):2===n?k(e,i,function(n,t){return r[n][i-1-t]}):r;throw"flip: input not supported"}function _n(t){var n=[].slice.call(arguments,1);return b(n[0])&&(n=n[0]),Y(t)?n.length?n.map(function(n){return[1,1][n-1]}):[1,1]:J(t)?n.length?n.map(function(n){return[1,t.length][n-1]}):[1,t.length]:c(t)?n.length?n.map(function(n){return[B(t),V(t)][n-1]}):[B(t),V(t)]:[]}function In(n){return b(n)?O.max.apply(O,_n(n)):null==n?0:1}function Pn(n=1,t=null){return y(n)&&(t=n[1],n=n[0]),k(n,t=t||n,0)}function Cn(n){return k(n=H(n=null==n?1:n,!0),n,function(n,t){return n===t?1:0})}function Ln(r,i){return i=i||0,Y(r)?[[r]]:J(r)?k(r.length,r.length,function(n,t){return i===n-t?r[n]:0}):c(r)?r.reduce(function(n,t,e){return t.reduce(function(n,t,r){return i===e-r&&n.push(t),n},n)},[]):[]}function Rn(r){return c(r)?k(V(r),B(r),function(n,t){return r[t][n]}):r}function jn(r){return c(r)?k(V(r),B(r),function(n,t){return v(r[t][n])?D(r[t][n]):r[t][n]}):v(r)?D(r):r}function Nn(n,t,r){if(1===arguments.length){if(c(n)){for(var e,i=B(n),u=V(n),o=new Array(u*i),f=0,a=0;a<u;++a)for(e=0;e<i;++e)o[f++]=n[e][a];return o}return n}if(null!=r&&null!=t||(null!=t?(r=t,t=1):(r=n,n=t=1)),n=H(n,!0),t=H(t,!0),r=H(r,!0),o=[],0<t)for(;n<=r;n+=t)o.push(n);else if(t<0)for(;r<=n;n+=t)o.push(n);return o}function qn(t){return v(t)?t:y(t)?t.reduce(Z,0):S(t)?X(V(t),function(n){return qn(R(t,n))}):0}function zn(t){return v(t)?t:y(t)?t.reduce(F,1):S(t)?X(V(t),function(n){return zn(R(t,n))}):0}function On(t){return v(t)?t:y(t)?O.min.apply(null,t):S(t)?X(V(t),function(n){return On(R(t,n))}):0}function $n(t){return v(t)?t:y(t)?O.max.apply(null,t):S(t)?X(V(t),function(n){return $n(R(t,n))}):0}function Mn(t){return v(t)?t:y(t)?Q(qn(t),t.length):S(t)?X(V(t),function(n){return Mn(R(t,n))}):0}function Xn(t,n){return n=n||0,v(t)?0:y(t)?0===t.length?f:1===t.length?0:O.sqrt(Q(qn(yn(Sn(gn(t,Mn(t))),2)),1===n?t.length:t.length-1)):S(t)?X(V(t),function(n){return Xn(R(t,n))}):0}function Zn(n,t){if(v(n))return t(n,1,1)?1:0;if(y(n)){for(var r=0,e=n.length;r<e;++r)if(!t(n[r],r+1,1))return 0;return 1}if(S(n)){for(var r=0,i=B(n),u=V(n);r<i;++r)for(var o=0;o<u;++o)if(!t(n[r][o],r+1,o+1))return 0;return 1}return 0}function B(n){return n.length}function V(n){return n[0].length}function R(t,r){return X(t.length,function(n){return t[n][r]})}function Wn(n,t,r){var e;t!==r&&(e=n[t],n[t]=n[r],n[r]=e)}function Fn(n,t,r,e,i,u){var o,f=n[0].length;for(null==e&&(e=1),null==i&&(i=1),o=u||0;o<f;++o)n[t][o]=Z(F(i,n[t][o]),F(e,n[r][o]))}function Qn(r,e,i,n,t){var u=B(r),o=V(r);return u&&o?b(e)&&b(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<o}),k(e.length,i.length,function(n,t){return r[e[n]][i[t]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=o),(n=null==n?u-1:n)<0&&(n+=u),(t=null==t?o-1:t)<0&&(t+=o),e=O.max(0,O.min(u-1,e)),n=O.max(0,O.min(u-1,n)),i=O.max(0,O.min(o-1,i)),t=O.max(0,O.min(o-1,t)),e<=n&&i<=t?k(n-e+1,t-i+1,function(n,t){return r[e+n][i+t]}):[]):[]}function Dn(r,e,n){var i=B(r),u=V(r),o=B(e),f=V(e);return"vert"===(n=n||"horz")?k(i+o,O.max(u,f),function(n,t){return u<=t?n<i?0:e[n-i][t]:f<=t?n<i?r[n][t]:0:(n<i?r[n]:e[n-i])[t]}):k(O.max(i,o),u+f,function(n,t){return i<=n?t<u?0:e[n][t-u]:o<=n?t<u?r[n][t]:0:t<u?r[n][t]:e[n][t-u]})}function Un(n,t){return M(t)&&0<t?v(n)?a(U(n),t)?0:n:b(n)?n.map(function(n){return Un(n,t)}):n:n}function Bn(n){var t,r,e;return v(n)?pn(n):S(n)&&B(n)===V(n)?1===(r=t=B(n))?[[pn(n[0][0])]]:C((e=Jn(n,!0))[0][t-1][r-1],0)?[]:e[3].map(function(n,t){return n.map(function(n){return Q(n,e[0][t][t])})}):[]}function Vn(r){var n,e,t,i,u,o;return v(r)?pn(r):S(r)?(n=B(r),t=V(r),tn(r,0)?Rn(r):1===n&&1===t?[[pn(r[0][0])]]:1===n||1===t?(u=r.reduce(function(n,t){return Z(n,F(t,D(t)))},0),k(t,n,function(n,t){return Q(D(r[t][n]),u)})):(o=(e=Jn(r,!0))[1].length)===t?n===t?e[3].map(function(n,t){return n.map(function(n){return Q(n,e[0][t][t])})}):l(Bn(l(i=jn(r),r)),i):o===n?l(i=jn(r),Bn(l(r,i))):(t=function(n,e){var t,r,i=B(n),u=V(n);e=e||Jn(n,!0);return t=e[1],r=t.length,n=Qn(n,X(i,function(n){return n}),X(r,function(n){return t[n][1]})),i=Qn(e[0],0,0,r-1,u-1).map(function(n,r){return n.map(function(n,t){for(t=r;t+1<u&&C(e[0][r][t],0);)++t;return Q(n,e[0][r][t])})}),[n,i]}(r,e),u=l(Bn(l(i=jn(u=t[0]),u)),i),o=l(i=jn(o=t[1]),Bn(l(o,i))),l(o,u))):[]}function Yn(n,t,r){var e,i,u,o,f,a,l,c,s,h,p,m,g,d,v=B(n),y=V(n),w=y,x=0;for(b(r)&&(w=O.min(w,r[1])),g=Dn(n,Cn(v)),e=new Array(w),i=1,d=function(n,t){t=t||0;for(var r=x-1;0<=r;--r)if(n===e[r][t])return r;return-1},u=l=0;u<v&&!(w<=l);++u){for(o=u;C(U(g[o][l]),0);)if(v<=++o&&(o=u,w<=++l)){l=-1;break}if(-1===l)break;for(c=-1,h=null,m=0,o=f=o;o<v;++o)C(p=U(g[o][l]),0)?++m:null!=h&&!L(p,h)||(h=p,c=o);for(;;){if(-1===c)break;if(v-f===m+1){for(u!==c&&(Wn(g,u,c),i=hn(i)),L(g[u][l],0)&&(Fn(g,u,u,0,-1,l),i=hn(i)),o=c,f=u;0<=o&&-1!==(a=d(o));)o=f-=x-a;e[x++]=[o,l],i=u<w?F(i,g[u][u]):0;break}for(m=0,s=c,o=f;o<v;++o)o!==s&&(Fn(g,o,s,hn(Q(g[o][l],g[s][l])),1,l),C(p=U(g[o][l]),0)?++m:L(p,h)&&(h=p,c=o))}++l}return x<w&&(i=0),r=Qn(g,0,y,v-1,v+y-1),g=Qn(g,0,0,v-1,y-1),e.length>x&&(e.length=x),t?[g,e,i,r]:g}function Jn(n,t,r){var e,i,u,o,f,a,l=B(n),c=V(n),s=c;for(b(r)&&O.min(s,r[1]),a=Dn((s=Yn(n,!0,r))[0],s[3]),e=s[1],n=s[2],i=e.length,o=0;o<i;++o)for(u=e[o][1],f=0;f<o;++f)C(a[f][u],0)||(Fn(a,f,o,hn(a[f][u]),a[o][u]),C(a[f][e[f][1]],1))||Fn(a,f,f,0,pn(a[f][e[f][1]]),e[f][1]);return C(a[i-1][e[i-1][1]],1)||Fn(a,i-1,i-1,0,pn(a[i-1][e[i-1][1]]),e[i-1][1]),r=Qn(a,0,c,l-1,l+c-1),a=Qn(a,0,0,l-1,c-1),t?[a,e,n,r]:a}function Gn(n,t,r){var e,i,u,o=B(n),f=V(n);if(!1===r||o===f){for(e=O.min(o,f),i=0;i<e;++i){if("lower"===t||"diagonal"===t)for(u=i+1;u<e;++u)if(!C(n[i][u],0))return;if("upper"===t||"diagonal"===t)for(u=0;u<i;++u)if(!C(n[i][u],0))return}if(f<o){for(i=e;i<o;++i)for(u=0;u<f;++u)if(!C(n[i][u],0))return}else if(o<f)for(u=e;u<f;++u)for(i=0;i<o;++i)if(!C(n[i][u],0))return;return 1}}function Hn(e,n){var t;if(S(e=v(e)?[[e]]:e))return(t=B(e))!==V(e)?0:1===t?e[0][0]:Gn(e,"lower")||Gn(e,"upper")?e.reduce(function(n,t,r){return F(n,e[r][r])},1):!0===n?function n(t,r){var e,i,u,o,f,a,l,c,s,h,p,m,g,d;function v(r,n,e,i){return k(n-1,n-1,function(n,t){return e<=n&&++n,i<=t&&++t,r[n][t]})}if(1===r)f=t[0][0];else if(2===r)a=t[0][0],l=t[0][1],c=t[1][0],f=W(F(a,s=t[1][1]),F(l,c));else if(3===r)a=t[0][0],l=t[0][1],c=t[0][2],s=t[1][0],h=t[1][1],p=t[1][2],m=t[2][0],g=t[2][1],d=t[2][2],f=W(W(W(Z(Z(F(F(a,h),d),F(F(l,p),m)),F(F(c,s),g)),F(F(c,h),m)),F(F(l,s),d)),F(F(a,p),g));else{for(e=u=i=0;e<r;++e)C(t[0][e],0)&&++i,C(t[e][0],0)&&++u;if(o=1,f=0,i<u)for(e=0;e<r;++e)C(t[e][0],0)||(f=Z(f,F(t[e][0],F(o,n(v(t,r,e,0),r-1))))),o=1===o?-1:1;else for(e=0;e<r;++e)C(t[0][e],0)||(f=Z(f,F(t[0][e],F(o,n(v(t,r,0,e),r-1))))),o=1===o?-1:1}return f}(e,t):Yn(e,!0)[2];throw"det: input not supported"}function Kn(e){return v(e)?e:S(e)?e.reduce(function(n,t,r){return Z(n,r<t.length?e[r][r]:0)},0):0}function nt(n){if(!S(n))return[];var e,i,t,u,r=B(n);if(r!==V(n))return[];for(i=r,u=new Array(i+1),t=Pn(i,i),u[i]=1,e=1;e<=i;++e)t=l(n,t).map(function(n,r){return n.map(function(n,t){return r===t?Z(n,u[i-e+1]):n})}),u[i-e]=Q(Kn(l(n,t)),-e);return u.reverse()}function tt(n){for(var t,r,e,i,u,o,f=B(n),a=V(n),l=!1,c=K(n),s=Cn(f),h=X(f,0),p=Cn(f),m=1,g=0;g<f-1;++g){if(C(c[g][g],0)){for(e=g+1,i=!0;e<f&&i;)C(c[e][g],0)?++e:i=!1;if(f<=e){l=!0;break}Wn(c,g,e),Wn(p,g,e)}for(u=c[g][g],s[g][g]=u,h[g]=F(m,u),t=g+1;t<f;++t){for(o=c[t][g],s[t][g]=o,r=g+1;r<a;++r)c[t][r]=Q(W(F(u,c[t][r]),F(c[g][r],o)),m);c[t][g]=0}m=c[g][g]}return l?[]:(h[f-1]=m,[Ln(h),s,c,p])}function rt(n,t,r){if(v(n)&&v(t))return Q(t,n);if(!S(n))return[];if(!y(t)&&!S(t))return[];var e,i=V(n);if(B(n)!==i)return[];if(e=y(t)?(h=t.length,1):(h=B(t),V(t)),i!==h)return[];var u,o,f,a,l,c,s,h=Yn(Rn(n),!0);if(h[1].length!==i)return[];if(u=Rn(h[3]),o=Rn(h[0]),y(t)){for(f=X(i,0),a=0;a<i;++a){if(C(o[a][a],0))return[];for(l=s=0;l<a;++l)s=Z(s,F(o[a][l],f[l]));f[a]=Q(W(t[a],s),o[a][a])}return X(i,function(t){return X(i,function(n){return F(f[n],u[t][n])}).reduce(Z,0)})}for(f=Pn(i,e),a=0;a<i;++a){if(C(o[a][a],0))return[];for(c=0;c<e;++c){for(l=s=0;l<a;++l)s=Z(s,F(o[a][l],f[l][c]));f[a][c]=Q(W(t[a][c],s),o[a][a])}}return k(i,e,function(t,r){return X(i,function(n){return F(f[n][r],u[t][n])}).reduce(Z,0)})}function et(n,t){if(!n.length)return 0;t=t||0;for(var r=n.length,e=0,i=n[0];e+1<r;)++e,i=Z(F(i,t),n[e]);return i}function it(t){if(t.length<=1)return[];for(var n,r,e,i,u,o,f,a,l,c=t.length-1,s=1e-10,h=new P(s,0),p=new P(0,0),m=new P(1,0),g=function(n){return et(t,n)},d=function(n){return Q(W(g(Z(n,h)),g(n)),h)},v=t.map(function(n){return P(n).abs()}),y=v.length-1;0<y&&!v[y];)--y;for(r=(O.max.apply(null,v.slice(0,y))||0)/(v[y]||1)+1,n=v[0]/(v[0]+O.max.apply(null,v.slice(1))||1),e=X(c,function(){return new P(n+(r-n)*O.random(),O.random()*N/2,"polar")}),f=0;;){for(y=i=0;y<c;++y){if(u=e[y],a=g(u),0===(l=d(u)).re&&0===l.im){if(a.re<=s&&a.im<=s){++i;continue}o=new P(r,0)}else o=a.div(l);(a=o.div(m.sub(o.mul(e.reduce(function(n,t,r){return n=r===y||u.re===t.re&&u.im===t.im?n:n.add(u.sub(t).inv())},p))))).re<=s&&a.im<=s&&++i,e[y]=u.sub(a)}if(i===c)break;if(1e3<++f)break}return e}function ut(n,t){for(var r=n.length-1,e=t.length-1,i=[];0<=r&&0<=e;)i.unshift(Z(n[r--],t[e--]));for(;0<=r;)i.unshift(n[r--]);for(;0<=e;)i.unshift(t[e--]);return i}function ot(n,t){var r,e,i,u,o,f=n.length,a=t.length,l=f+a-1;if(!f||!a)return[];for(o=new Array(l),f<a&&(u=n,f=(n=t).length,a=(t=u).length),r=0;r<l;++r)for(e=o[r]=0;e<a;++e)0<=(i=r-e)&&i<f&&(o[r]=Z(o[r],F(n[i],t[e])));return o}E.complex=P,["sign","sqrt","exp","log","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(t){E[t]=un[t]?function(n){return nn(function(n){return(u(n)?un:O)[t](n)},n,!0)}:function(n){return nn(O[t],n,!1)}}),T.MAXPRINTSIZE=s,T.tex=function(n){return b(n)?n=n.length?A.call(n,"$mainRet$")?"\\["+n.map(fn).join("\\]\n\\[")+"\\]":b(n[0])?b(n[0][0])||!b(n[1])||n[0].length!==n[1].length?"\\["+n.map(fn).join("\\]\n\\[")+"\\]":"\\["+fn(n)+"\\]":"\\["+(n=n.length>T.MAXPRINTSIZE?n.slice(0,O.round(T.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-O.round(T.MAXPRINTSIZE/2))):n).map(fn).join("\\]\n\\[")+"\\]":"":(n=fn(n)).length&&(n="\\["+n+"\\]"),n},E.times=dn,E.real=wn,E.imag=xn,E.conj=bn,E.abs=Sn,E.angle=function(n){return nn(function(n){return u(n)?n.angle():n<0?N:0},n,!0)},E.ceil=function(n){return nn(function(n){return u(n)?new P(O.ceil(n.re),O.ceil(n.im)):O.ceil(n)},n,!0)},E.floor=function(n){return nn(function(n){return u(n)?new P(O.floor(n.re),O.floor(n.im)):O.floor(n)},n,!0)},E.round=function(n){return nn(function(n){return u(n)?new P(O.round(n.re),O.round(n.im)):O.round(n)},n,!0)},E.mod=function(n,r){return C(r=H(r||0),0)?n:nn(function(n){var t;return w(n)?((t=n%r)<0&&0<r&&(t+=r),t):n},n,!0)},E.bitshift=function(n,t){return nn(function(n){return w(n)?t<0?n>>-t:n<<t:n},n,!0)},E.bitand=function r(t,e){if(w(t)){if(w(e))return t&e;if(b(e))return e.map(function(n){return r(t,n)})}else if(b(t)){if(w(e))return t.map(function(n){return r(n,e)});if(b(e)&&t.length===e.length)return t.map(function(n,t){return r(n,e[t])})}return 0},E.bitor=function r(t,e){if(w(t)){if(w(e))return t|e;if(b(e))return e.map(function(n){return r(t,n)})}else if(b(t)){if(w(e))return t.map(function(n){return r(n,e)});if(b(e)&&t.length===e.length)return t.map(function(n,t){return r(n,e[t])})}return 0},E.bitxor=function r(t,e){if(w(t)){if(w(e))return t^e;if(b(e))return e.map(function(n){return r(t,n)})}else if(b(t)){if(w(e))return t.map(function(n){return r(n,e)});if(b(e)&&t.length===e.length)return t.map(function(n,t){return r(n,e[t])})}return 0},E.bin2dec=function n(t){return b(t)?t.map(n):I(t)?parseInt(t,2):t},E.dec2bin=function n(t){return b(t)?t.map(n):M(t)?t.toString(2):t},E.hex2dec=function n(t){return b(t)?t.map(n):I(t)?parseInt(t,16):t},E.dec2hex=function n(t){return b(t)?t.map(n):M(t)?t.toString(16):t},E.tolower=function n(t){return b(t)?t.map(n):I(t)?t.toLowerCase():t},E.toupper=function n(t){return b(t)?t.map(n):I(t)?t.toUpperCase():t},T.get=kn,T.set=An,E.sub2ind=function(n,t,r){return y(t)&&(r=t[1],t=t[0]),1===n.length?t:t-1+n[0]*(r-1)+1},E.ind2sub=function(n,t){return 1===n.length?[t,1]:[(t-1)%n[0]+1,O.floor((t-1)/n[0])+1]},E.cat=function(n,t,r){var e,i=[];if(1===n)for(i=t,e=2;e<arguments.length;++e)i=Tn("vert",i,arguments[e]);else if(2===n)for(i=t,e=2;e<arguments.length;++e)i=Tn("horz",i,arguments[e]);return i},E.horzcat=function(n,t){for(var r=n,e=1;e<arguments.length;++e)r=Tn("horz",r,arguments[e]);return r},E.vertcat=function(n,t){for(var r=n,e=1;e<arguments.length;++e)r=Tn("vert",r,arguments[e]);return r},E.flip=En,E.fliplr=function(n){return En(n,2)},E.flipud=function(n){return En(n,1)},E.reshape=function(r,e,n){y(e)&&(n=e[1],e=e[0]);var i,t=e*n;return Y(r)&&1===e&&1===n?[[r]]:J(r)&&r.length===t?k(e,n,function(n,t){return r[n+e*t]}):c(r)&&B(r)*V(r)==t?(i=B(r),k(e,n,function(n,t){n+=e*t;return r[n%i][O.floor(n/i)]})):r},E.squeeze=function(n){return n},E.repmat=function(r,e,i){return y(e)&&(i=e[1],e=e[0]),null==i&&(i=e),c(r=J(r=Y(r)?[[r]]:r)?[r]:r)?k(e*B(r),i*V(r),function(n,t){return r[n%e][t%i]}):r},E.repelem=function(t,r){var e,i;if(y(t))if(y(r)){if(r.length===t.length)return e=0,i=-1,X(qn(r),function(n){return n===e&&(e+=r[++i]),t[i]})}else if(w(r))return i=-1,X(r*t.length,function(n){return 0==n%r&&++i,t[i]});return t},E.size=_n,E.length=In,E.numel=function(n){return zn(_n(n))},E.ndims=function(n){return In(_n(n))},E.rows=function(n){return _n(n,1)},E.columns=function(n){return _n(n,2)},E.zeros=Pn,E.ones=function(n=1,t=null){return y(n)&&(t=n[1],n=n[0]),k(n,t=t||n,1)},E.meshgrid=function(r,e){if(1===arguments.length&&(e=r),y(r)&&y(e))return[k(e.length,r.length,function(n,t){return r[t]}),k(e.length,r.length,function(n,t){return e[n]})];throw"meshgrid: invalid inputs"},E.eye=Cn,E.diag=Ln,E.dot=function t(r,e){if(v(r)&&v(e))return F(r,D(e));if(y(r)&&y(e)){if(r.length===e.length)return r.reduce(function(n,t,r){return Z(n,F(t,D(e[r])))},0)}else if(S(r)&&S(e)&&B(r)===B(e)&&V(r)===V(e))return X(V(r),function(n){return t(R(r,n),R(e,n))});return 0},E.cross=function(n,t){if(!y(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(y(t)&&3===t.length)return[W(F(n[1],t[2]),F(n[2],t[1])),W(F(n[2],t[0]),F(n[0],t[2])),W(F(n[0],t[1]),F(n[1],t[0]))];throw"cross: input 2 not vector of length 3"},E.kron=function(r,e){var n,t,i,u;if(S(r)){if(S(e))return n=B(r),t=V(r),i=B(e),u=V(e),k(n*i,t*u,function(n,t){return l(r[O.floor(n/i)][O.floor(t/u)],e[n%i][t%u])});if(y(e))return n=B(r),t=V(r),i=1,u=e.length,k(n*i,t*u,function(n,t){return l(r[n][O.floor(t/u)],e[t%u])})}else if(y(r)){if(y(e))return k(r.length,e.length,function(n,t){return l(r[n],e[t])});if(S(e))return n=r.length,i=B(e),u=V(e),k(n*i,(t=1)*u,function(n,t){return l(r[O.floor(n/i)],e[n%i][t%u])})}return l(r,e)},E.transpose=Rn,E.ctranspose=jn,E.rand=function(n,t){return n?(y(n)&&(t=n[1],n=n[0]),k(n,t=t||n,function(){return O.random()})):O.random()},E.randi=function(n,t,r){return t||r?(y(t)&&(r=t[1],t=t[0]),k(t,r=r||t,function(){return O.ceil(O.random()*n)})):O.ceil(O.random()*n)},E.randn=function(n,t){return n?(y(n)&&(t=n[1],n=n[0]),k(n,t=t||n,cn)):cn()},E.linspace=function(n,t,r=100){for(var e=(t-n)/(r-1),i=new Array(r),u=0,o=n;u<r;++u,o+=e)i[u]=o;return i},E.logspace=function(n,t,r=100){for(var e=O.pow(t/n,1/(r-1)),i=new Array(r),u=0,o=n;u<r;++u,o*=e)i[u]=o;return i},E.colon=Nn,E.sum=qn,E.prod=zn,E.min=On,E.max=$n,E.norm=function(n,t){if(z(t=null==t?2:t)){if(v(n))return U(n);if(y(n))return(t<0?On:$n)(Sn(n));if(S(n)&&0<t)return $n(qn(Sn(Rn(n))))}else if(M(t)){if(1===t){if(v(n))return U(n);if(y(n))return qn(Sn(n));if(S(n))return $n(qn(Sn(n)))}else if(2===t){if(v(n))return U(n);if(y(n))return O.sqrt(qn(n.map(function(n){return F(n,D(n))})))}else if(0<t){if(v(n))return U(n);if(y(n))return O.pow(qn(n.map(function(n){return sn(U(n),t)})),1/t)}}else if("fro"===t&&S(n))return O.sqrt(Kn(l(jn(n),n)));g(!0)},E.mean=Mn,E.std=Xn,E.cov=function e(i,n,u){if(u=u||0,2!==arguments.length||0!==n&&1!==n||(u=n,n=null),null==n){if(v(i))return 0;if(y(i))return i.length<=1?i.length?0:f:(t=i.length,o=Mn(i),Q(qn(dn(bn(r=gn(i,o)),r)),1===u?t:t-1));if(S(i))return k(V(i),V(i),function(n,t,r){return n===t?e(R(i,n),u):t<n?r[t][n]:e(R(i,n),R(i,t),u)})}else{if(v(i)&&v(n))return Pn(2,2);if(S(i)&&S(n)&&(i=Nn(i),n=Nn(n)),y(i)&&y(n)){if(i.length!==n.length)throw"cov: inputs not of same dimension";var t,r,o;return i.length<=1?i.length?0:f:(t=i.length,o=Mn(i),n=Mn(n),r=gn(i,o),o=gn(i,n),Q(qn(dn(bn(r),o)),1===u?t:t-1))}}throw"cov: input not supported"},E.corrcoef=function e(i,t){if(null==t){if(v(i)||y(i))return 1;if(S(i))return k(V(i),V(i),function(n,t,r){return n===t?1:t<n?r[t][n]:e(R(i,n),R(i,t))})}else{if(v(i)&&v(t))return 1;if(y(i)&&y(t)){if(i.length!==t.length)throw"corrcoef: inputs not of same dimension";var n=i.length;return 1<n?Q(qn(dn(vn(gn(i,Mn(i)),Xn(i)),vn(gn(t,Mn(t)),Xn(t)))),n-1):1}if(S(i)&&S(t)){if(B(i)!==B(t)||V(i)!==V(t))throw"corrcoef: inputs not of same dimension";return X(V(i),function(n){return e(R(i,n),R(t,n))})}}throw"corrcoef: input not supported"},E.find=function(n){return i=function(n){return!C(n,0)},y(n=n)?n.reduce(function(n,t,r){return i(t,r+1,1)&&n.push(r+1),n},[]):S(n)?(u=B(n),n.reduce(function(n,t,e){return t.reduce(function(n,t,r){return i(t,e+1,r+1)&&n.push(e+u*r+1),n},n)},[])):[];var i,u},E.any=function(n){var t=n,r=function(n){return!C(n,0)};if(v(t))return r(t,1,1)?1:0;if(y(t)){for(var e=0,i=t.length;e<i;++e)if(r(t[e],e+1,1))return 1}else if(S(t))for(var e=0,u=B(t),o=V(t);e<u;++e)for(var f=0;f<o;++f)if(r(t[e][f],e+1,f+1))return 1;return 0},E.all=function(n){return Zn(n,function(n){return!C(n,0)})},E.isreal=function(n){return Zn(n,G)},E.isempty=function(n){return b(n)?b(n[0])?n[0].length?0:1:n.length?0:1:0},E.magic=function n(r){if(!w(r=H(r,!0))||r<=2)return 1===r?[[1]]:[];var e,i,u,o,f,t,a,l,c,s,h,p,m,g=1&r,d=0==(3&r),v=r*r,y=r-g>>1;if(g)return e=r+y,i=y+g,k(r,r,function(n,t){return(e+n-(t=r-1-t))%r*r+(i+t+n)%r+1});if(d)return c=0,k(r,r,function(n,t){return++c,(n+1&3)>>1==(t+1&3)>>1?v-(c-1):c});for(p=n(y),f=(o=(u=g=y*y)<<1)+g,m=k(r,r,function(n,t){return n<y&&t<y?p[n][t]:n<y?p[n][t-y]+f:t<y?p[n-y][t]+o:p[n-y][t-y]+u}),a=t=y>>>1,h=0;h<y;++h)for(s=0;s<r;++s)!(s<t||r-a<s||s===t&&h===t)||0===s&&h===t||(l=m[s][h],m[s][h]=m[s][h+y],m[s][h+y]=l);return m},E.inv=function(n){if(S(n=v(n)?[[n]]:n))return Bn(n);throw"inv: input not supported"},E.pinv=function(n,t){if(S(n=v(n)?[[n]]:n))return Vn(Un(n,t));throw"pinv: input not supported"},E.ref=function(n,t){if(S(n=v(n)?[[n]]:n))return kt([(n=Yn(Un(n,t),!0))[0],n[1].map(function(n){return n[1]+1})],n[0]);throw"ref: input not supported"},E.rref=function(n,t){if(S(n=v(n)?[[n]]:n))return kt([(n=Jn(Un(n,t),!0))[0],n[1].map(function(n){return n[1]+1})],n[0]);throw"rref: input not supported"},E.rank=function(n){if(S(n=v(n)?[[n]]:n))return Yn(n,!0)[1].length;throw"rank: input not supported"},E.det=Hn,E.trace=Kn,E.charpoly=nt,E.eig=function(t){return S(t)?r((Gn(t,"upper")||Gn(t,"lower")?X(O.min(B(t),V(t)),function(n){return t[n][n]}):it(nt(t))).sort(function(n,t){return U(n)-U(t)})):[]},E.rowspace=function(n,t){return Yn(r=Un(n,t),!0)[1].map(function(n){return r[n[0]]});var r},E.colspace=function(n,t){return Yn(r=Un(n,t),!0)[1].map(function(t){return X(r.length,function(n){return r[n][t[1]]})});var r},E.null=function(n,t){return n=Un(n,t),i=V(n),u=(n=Jn(n,!0))[0],o=n[1],f=o.length,n=o.reduce(function(n,t){for(var r=0;r<n.length&&t[1]>n[r];)++r;return r<n.length&&t[1]===n[r]&&n.splice(r,1),n},X(i,function(n){return n})),a=f?o.reduce(function(n,t,r){return F(n,u[r][t[1]])},1):1,n.map(function(t){for(var n,r=X(i,function(n){return n===t?a:0}),e=0;e<f;++e)(n=o[e][1])<=t&&(r[n]=W(r[n],F(Q(a,u[e][n]),u[e][t])));return r});var i,u,o,f,a},E.svd=function(n,t){if(S(n=v(n)?[[n]]:n))return kt([(n=function z(n,t){M(t)||(t=$);var r,e=V(n),i=B(n);if(i<e)return r=z(Rn(n),t),[Rn(r[2]),r[1],Rn(r[0])];var u,o,f,a,l,c,s,h,p,m,g,d,v,y,w,x,b,S,k,A,T,E=i,_=e,I=K(n),P=Pn(i,E),C=X(e,0),L=Pn(e,_),R=Number.MIN_VALUE/t,j=new Array(e),N=new Array(e),q=new Array(e);for(N[0]=0,y=1;y<=e;++y){for(b=y+1,f=0,d=y;d<=i;++d)f+=O.pow(wn(I[d-1][y-1]),2)+O.pow(xn(I[d-1][y-1]),2);if(j[y-1]=0,R<f&&(f=O.sqrt(f),j[y-1]=f,l=0===(a=U(I[y-1][y-1]))?1:Q(I[y-1][y-1],a),I[y-1][y-1]=F(l,f+a),y!==e+0)){for(v=b;v<=e+0;++v){for(l=0,d=y;d<=i;++d)l=Z(l,F(D(I[d-1][y-1]),I[d-1][v-1]));for(l=Q(l,f*(f+a)),d=y;d<=i;++d)I[d-1][v-1]=W(I[d-1][v-1],F(l,I[d-1][y-1]))}for(l=hn(rn(D(I[y-1][y-1]))),v=b;v<=e+0;++v)I[y-1][v-1]=F(l,I[y-1][v-1])}if(y===e)break;for(f=0,v=b;v<=e;++v)f+=O.pow(wn(I[y-1][v-1]),2)+O.pow(xn(I[y-1][v-1]),2);if(N[b-1]=0,R<f){for(f=O.sqrt(f),N[b-1]=f,l=0===(a=U(I[y-1][b-1]))?1:Q(I[y-1][b-1],a),I[y-1][b-1]=F(l,f+a),d=b;d<=i;++d){for(l=0,v=b;v<=e;++v)l=Z(l,F(D(I[y-1][v-1]),I[d-1][v-1]));for(l=Q(l,f*(f+a)),v=b;v<=e;++v)I[d-1][v-1]=W(I[d-1][v-1],F(l,I[y-1][v-1]))}for(l=hn(rn(D(I[y-1][b-1]))),d=b;d<=i;++d)I[d-1][b-1]=F(I[d-1][b-1],l)}}for(c=0,y=1;y<=e;++y)C[y-1]=j[y-1],q[y-1]=N[y-1],c=O.max(c,C[y-1]+q[y-1]);if(c*=t,0<E)for(v=1;v<=E;++v)P[v-1][v-1]=1;if(0<_)for(v=1;v<=_;++v)L[v-1][v-1]=1;for(x=1;x<=e;++x){for(y=e+1-x,A=1;A<=50;++A){for(T=!0,k=1;k<=y;++k){if(O.abs(q[(w=y+1-k)-1])<=c){T=!1;break}if(O.abs(C[w-1-1])<=c){T=!0;break}}if(T)for(g=0,S=w-(m=1),d=w;d<=y&&(h=m*q[d-1],q[d-1]=g*q[d-1],!(O.abs(h)<=c));++y)if(a=ln(h,p=C[d-1]),g=p/(C[d-1]=a),m=-h/a,0<E)for(v=1;v<=e;++v)u=wn(P[v-1][S-1]),o=wn(P[v-1][d-1]),P[v-1][S-1]=u*g+o*m,P[v-1][d-1]=o*g-u*m;if(a=C[y-1],w===y)break;for(u=C[w-1],s=ln(h=(((o=C[y-1-1])-a)*(o+a)+((s=q[y-1-1])-(p=q[y-1]))*(s+p))/(2*p*o),1),h=((u-a)*(u+a)+(o/(h+(s=h<0?-s:s))-p)*p)/u,d=S=w+(m=g=1);S<=y;++S){if(s=q[d-1],o=C[d-1],p=m*s,s*=g,a=ln(p,h),h=u*(g=h/(q[d-1-1]=a))+s*(m=p/a),s=s*g-u*m,p=o*m,o*=g,0<_)for(v=1;v<=e;++v)u=wn(L[v-1][d-1-1]),a=wn(L[v-1][d-1]),L[v-1][d-1-1]=u*g+a*m,L[v-1][d-1]=a*g-u*m;if(a=ln(p,h),h=(g=h/(C[d-1-1]=a))*s+(m=p/a)*o,u=g*o-m*s,0<E)for(v=1;v<=e;++v)o=wn(P[v-1][d-1-1]),a=wn(P[v-1][d-1]),P[v-1][d-1-1]=o*g+a*m,P[v-1][d-1]=a*g-o*m}q[w-1]=0,q[y-1]=h,C[y-1]=u}if(a<0&&(C[y-1]=-a,0<_))for(v=1;v<=e;++v)L[v-1][y-1]=hn(L[v-1][y-1])}for(y=1;y<=e;++y){for(s=-1,d=v=y;d<=e;++d)s<C[d-1]&&(s=C[d-1],v=d);if(v!==y){if(C[v-1]=C[y-1],C[y-1]=s,0<_)for(d=1;d<=e;++d)l=L[d-1][v-1],L[d-1][v-1]=L[d-1][y-1],L[d-1][y-1]=l;if(0<E)for(d=1;d<=e;++d)l=P[d-1][v-1],P[d-1][v-1]=P[d-1][y-1],P[d-1][y-1]=l}}if(0<E)for(x=1;x<=e;++x)if(0!==j[(y=e+1-x)-1]){for(l=hn(rn(I[y-1][y-1])),v=1;v<=E;++v)P[y-1][v-1]=F(l,P[y-1][v-1]);for(v=1;v<=E;++v){for(l=0,d=y;d<=i;++d)l=Z(l,F(D(I[d-1][y-1]),P[d-1][v-1]));for(l=Q(l,F(U(I[y-1][y-1]),j[y-1])),d=y;d<=i;++d)P[d-1][v-1]=W(P[d-1][v-1],F(l,I[d-1][y-1]))}}if(0<_&&2<=e)for(x=2;x<=e;++x)if(0!==N[(b=1+(y=e+1-x))-1]){for(l=hn(rn(D(I[y-1][b-1]))),v=1;v<=_;++v)L[b-1][v-1]=F(l,L[b-1][v-1]);for(v=1;v<=_;++v){for(l=0,d=b;d<=e;++d)l=Z(l,F(I[y-1][d-1],L[d-1][v-1]));for(l=Q(l,F(U(I[y-1][b-1]),N[b-1])),d=b;d<=e;++d)L[d-1][v-1]=W(L[d-1][v-1],F(l,D(I[y-1][d-1])))}}return[P,C,L]}(n,t))[0],Ln(n[1]),n[2]],n[1]);throw"svd: input not supported"},E.lu=function(n){if(S(n=v(n)?[[n]]:n))return kt(n=tt(n),n[0]);throw"lu: input not supported"},E.qr=function(n){var t,r;if(S(n=v(n)?[[n]]:n))return B(n=n),t=V(n),r=Rn(n),kt(r=(n=tt(Dn(l(r,n),r)))?[Rn(Qn(n[2],0,t,-1,-1)),n[0],Rn(n[1])]:[],r[0]);throw"qr: input not supported"},E.ldl=function(n){if(S(n=v(n)?[[n]]:n))return kt(n=function(n){var t,r,e,i,u,o,f=B(n);if(f===V(n)&&tn(n,jn(n))){for(u=Pn(f,f),o=Cn(f),t=0;t<f;++t){for(r=0;r<t;++r){for(i=e=0;e<r;++e)i=Z(i,F(F(o[t][e],D(o[r][e])),u[e][e]));o[t][r]=Q(W(n[t][r],i),u[r][r])}for(i=e=0;e<t;++e)i=Z(i,F(F(o[t][e],D(o[t][e])),u[e][e]));if(u[t][t]=W(n[t][t],i),a(u[t][t],0))return[]}return[o,u]}return[]}(n),n[0]);throw"ldl: input not supported"},E.linsolve=rt,E.polyval=function(t,n){if(v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),!y(t))throw"polyval: input 1 not supported";if(v(n))return r(et(t,n));if(y(n))return n.map(function(n){return r(et(t,n))});throw"polyval: input 2 not supported"},E.polyvalm=function(t,n){if(v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),!y(t))throw"polyval: input 1 not supported";if(S(n)&&B(n)===V(n))return r(function(r,n){if(!r.length)return 0;for(var t=r.length,e=0,i=B(n),u=k(i,i,function(n,t){return n===t?r[0]:0});e+1<t;)++e,u=mn(l(u,n),k(i,i,function(n,t){return n===t?r[e]:0}));return u}(t,n));if(v(x))return r(et(t,x));if(y(x))return x.map(function(n){return r(et(t,n))});throw"polyvalm: input 2 not supported"},E.polyfit=function(n,t,i){if(v(n)?n=[n]:S(n)&&1===B(n)&&(n=n[0]),v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),!y(n))throw"polyfit: input 1 not supported";if(!y(t))throw"polyfit: input 2 not supported";if(n.length!==t.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return r(function(e,i){var n,u,o,t,r,f,a,l;if(!(y(e)&&e.length&&y(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),o=O.min(e.length,i.length),e.length=o,i.length=o,a={},l=[],u=0;u<o;++u)if(f=String(e[u]),A.call(a,f)){if(!C(i[a[f]],i[u]))return[];l.push(u)}else a[f]=u;for(;l.length;)u=l.pop(),e.splice(u,1),i.splice(u,1);for(l=a=null,t=X(o=e.length,function(n){for(var t=1,r=0;r<o;++r)r!==n&&(t=F(t,W(e[n],e[r])));return t=Q(i[n],t)}),r=X(o,function(n){return[1,hn(e[n])]}),n=[],u=0;u<o;++u)n=ut(n,r.reduce(function(n,t,r){return n=r!==u?ft(n,t):n},[t[u]]));return n}(n,t));if(!w(i)||i<0)throw"polyfit: input 3 not positive int";return r(l(Vn(n.reduce(function(n,t){for(var r=1,e=[1];r<=i;++r)e.unshift(F(t,e[0]));return n.push(e),n},[])),t))},E.roots=function(n){if(v(n)?n=[n]:S(n)&&1===B(n)&&(n=n[0]),y(n))return r(it(n).sort(function(n,t){return wn(n)-wn(t)}));throw"roots: input not supported"},E.poly=function(n){if(v(n)?n=[n]:S(n)&&1===B(n)&&(n=n[0]),y(n))return r(n.reduce(function(n,t){return ft(n,[1,hn(t)])},[1]));throw"poly: input not supported"};var ft=ot;function at(n,t,r){var e,i=[],u=n.slice(),o=u.length-t.length,f=t;if(0<=o)for(i=X(o+1,0);0<=o;){for(e=o,t=f.concat(X(o,0)),i[i.length-1-o]=Q(u[0],t[0]),u=ut(u,ft(t,[-i[i.length-1-o]]));u.length&&C(u[0],0);)u.shift();if((o=u.length-f.length)===e)break}return[i,r?X(n.length-u.length,0).concat(u):u]}E.conv=function(n,t){if(v(n)||v(t))return dn(n,t);if(S(n)&&1===B(n)&&(n=n[0]),S(t)&&1===B(t)&&(t=t[0]),!y(n))throw"conv: input 1 not supported";if(y(t))return ot(n,t);throw"conv: input 2 not supported"};var lt=at;E.deconv=function(n,t){var r;if(v(n)||v(t))r=[vn(n,t),0];else{if(S(n)&&1===B(n)&&(n=n[0]),S(t)&&1===B(t)&&(t=t[0]),!y(n))throw"deconv: input 1 not supported";if(!y(t))throw"deconv: input 2 not supported";if(!t.length||1===t.length&&C(t[0],0))throw"deconv: divisor is zero";r=at(n,t,!0)}return kt(r,r[0])},E.polydiv=function(n,t){var r;if(v(n)||v(t))r=[vn(n,t),0];else{if(S(n)&&1===B(n)&&(n=n[0]),S(t)&&1===B(t)&&(t=t[0]),!y(n))throw"polydiv: input 1 not supported";if(!y(t))throw"polydiv: input 2 not supported";if(!t.length||1===t.length&&C(t[0],0))throw"polydiv: divisor is zero";r=lt(n,t,!1)}return kt(r,r[0])},E.conv2=function(t,r){if(v(t)||v(r))return dn(t,r);if(y(t)){if(y(r))return ot(t,r);if(S(r))return X(V(r),function(n){return ot(t,R(r,n))})}else{if(y(r)){if(y(t))return ot(t,r);if(S(t))return X(t[0].length,function(n){return ot(R(t,n),r)});throw"conv2: input 1 not supported"}if(!S(t))throw"conv2: input 1 not supported";if(S(r)){var n,e,i,u,o,f,a,l,c,s,h,p,m,g=t,d=r;for(B(g)<B(d)&&(m=g,g=d,d=m),n=B(g),e=V(g),o=Pn(f=n+(i=B(d))-1,a=e+(u=V(d))-1),c=0;c<f;++c)for(s=0;s<a;++s){for(h=l=0;h<=c&&!(n<=h);++h)if(!(i<=c-h))for(p=0;p<=s&&!(e<=p);++p)u<=s-p||(l=Z(l,F(g[h][p],d[c-h][s-p])));o[c][s]=l}return o}}throw"conv2: input 2 not supported"},E.filter=function(n,t,r,e,i){if(v(n)?n=[n]:S(n)&&1===B(n)&&(n=n[0]),v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),v(r)?r=[r]:S(r)&&1===B(r)&&(r=r[0]),y(n)&&y(t)&&y(r)){var u,o,f,a,l=n,c=t,s=r,h=s.length,p=c.length,m=l.length,g=new Array(h),d=c[0];for(c=c.map(function(n){return Q(n,d)}),l=l.map(function(n){return Q(n,d)}),u=0;u<h;++u){for(f=u,o=a=0;0<=f&&o<m;++o,--f)a=Z(a,F(l[o],s[f]));for(f=u-1,o=1;0<=f&&o<p;++o,--f)a=W(a,F(c[o],g[f]));g[u]=a}return g}throw"filter: inputs not supported"};var ct={},st={};function ht(n,t){for(var r,e,i=n.length,u={},o=0;o<i;++o)1!==u[o]&&(e=n[r=function(n,t){for(var r=0;1<t;)r=(r<<1)+(1&n),n>>=1,t>>=1;return r}(o,i)],t[r]=n[o],t[o]=e,u[r]=1)}function pt(n,t,r){var e,i=n.length;if(1===i)r[0]=n[0];else{for(e=0;e<i;++e)r[e]=new P(0,0);for(var u,o,f,a,l,c,s=function(n){for(var t=O.sqrt(n),r=3;r<=t;){if(0==n%r)return r;r+=2}return n}(i),h=i/s,p=1/O.sqrt(s),m=new Array(h),g=new Array(h),d=0;d<s;++d){for(e=0;e<h;++e)m[e]=n[e*s+d];for(1<h&&(gt(m,t,g),m=g,g=recursive_resulte),u=O.cos(2*N*d/i),o=(t?-1:1)*O.sin(2*N*d/i),f=1,e=a=0;e<i;++e)l=p*m[e%h].re,c=p*m[e%h].im,r[e]=r[e].add(new P(f*l-a*c,f*c+a*l)),l=f*u-a*o,a=f*o+a*u,f=l,a=a}}}function mt(n,t,r){var e,i,u,o,f,a,l,c,s,h,p,m,g,d,v,y=n.length,w=1;for(ht(n,r);w<y;){for(v=void 0,null==(v=st[d=w])&&(st[d]=v=O.cos(N/d)),e=v,i=(t?-1:1)*(d=void 0,null==(d=ct[v=w])&&(ct[v]=d=O.sin(N/v)),d),o=y/(2*w),u=0;u<o;++u)for(l=1,f=c=0;f<w;++f)h=r[m=2*u*w+f].re,p=r[m].im,g=r[s=m+w].re,a=r[s].im,r[m]=new P(O.SQRT1_2*(h+(m=l*g-c*a)),O.SQRT1_2*(p+(g=c*g+l*a))),r[s]=new P(O.SQRT1_2*(h-m),O.SQRT1_2*(p-g)),a=l*i+c*e,l=l*e-c*i,c=a;w<<=1}}function gt(n,t,r){var e,i=n.length;if(!(i<=0))return e=!1,null==r&&(r=new Array(i),e=!0),(i&i-1?pt:mt)(n,t,r),e?r:void 0}function dt(n,t,r){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,o,f=!1,a=new Array(e),l=new Array(i),c=new Array(e),s=new Array(i);if(null==r){for(r=new Array(e),u=0;u<e;++u)r[u]=new Array(i);f=!0}for(o=0;o<i;++o,0){for(u=0;u<e;++u)a[u]=n[u][o];for(gt(a,t,c),u=0;u<e;++u)r[u][o]=c[u]}for(u=0;u<e;++u){for(o=0;o<i;++o,0)l[o]=r[u][o];for(gt(l,t,s),o=0;o<i;++o,0)r[u][o]=s[o]}return f?r:void 0}}function e(){if(!_(this,e))return new e;this.data=[]}E.fft=function(t){if(v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),S(t))return X(V(t),function(n){return r(gt(an(R(t,n)),!1))});if(y(t))return r(gt(an(t),!1));throw"fft: input not supported"},E.ifft=function(t){if(v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),S(t))return X(V(t),function(n){return r(gt(an(R(t,n)),!0))});if(y(t))return r(gt(an(t),!0));throw"ifft: input not supported"},E.fft2=function(n){if(S(n))return r(dt(an(n),!1));throw"fft2: input not supported"},E.ifft2=function(n){if(S(n))return r(dt(an(n),!0));throw"ifft2: input not supported"},T.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],e.prototype={constructor:e,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,render:function(n,t){var r=this;return t&&(r.canvas=t,r.type=n,-1<["plot","scatter","bar","barh","pie"].indexOf(n)&&r.data&&r.data.length&&r.renderData(),"xlabel"===n&&r.xlabel&&r.xlabel.length&&r.renderXLabel(),"ylabel"===n&&r.ylabel&&r.ylabel.length&&r.renderYLabel(),"title"===n&&r.title&&r.title.length&&r.renderTitle(),r.canvas=null),t},renderData:function(){var m,g,d,v=this,y=v.canvas.getContext("2d"),w=v.type,x=v.canvas.width,b=v.canvas.height,S=0,k=v.data.length;-1===["pie"].indexOf(w)&&(v.renderAxes(),m=v.no),"bar"===w?S=O.max(1,O.floor((x-v.pl-v.pr)/(m*k))):"barh"===w?S=O.max(1,O.floor((b-v.pt-v.pb)/(m*k))):"pie"===w&&(1<k&&1&k&&(k+=1),g=O.floor(O.sqrt(k)),d=k/g,S=O.min((x-v.pl-v.pr)/d,(b-v.pt-v.pb)/g)),v.data.forEach(function(n,t){var r=n.x,e=n.y,i=n.style;if("plot"===w){for(y.beginPath(),y.lineWidth=i.LineWidth,y.setLineDash(i.LineStyle),y.strokeStyle="rgb("+i.Color.map(function(n){return O.round(255*n)}).join(",")+")",y.lineJoin="bevel",y.moveTo(v.x(r[0]),v.y(e[0])),p=1;p<m;++p)y.lineTo(v.x(r[p]),v.y(e[p]));y.stroke()}else if("scatter"===w)for(y.fillStyle="rgb("+i.Color.map(function(n){return O.round(255*n)}).join(",")+")",p=0;p<m;++p)y.beginPath(),y.arc(v.x(r[p]),v.y(e[p]),2*i.LineWidth,0,2*N),y.closePath(),y.fill();else if("bar"===w)for(y.fillStyle="rgb("+i.Color.map(function(n){return O.round(255*n)}).join(",")+")",p=0;p<m;++p)y.fillRect(v.pl+t*S*.8+p*k*S,v.y(0)>v.y(e[p])?v.y(e[p]):v.y(0),.8*S,O.abs(v.y(e[p])-v.y(0)));else if("barh"===w)for(y.fillStyle="rgb("+i.Color.map(function(n){return O.round(255*n)}).join(",")+")",p=0;p<m;++p)y.fillRect(v.y(0)>v.y(e[p])?v.y(e[p]):v.y(0),v.pt+t*S*.8+p*k*S,O.abs(v.y(e[p])-v.y(0)),.8*S);else if("pie"===w){var u,o,f=qn(Sn(e)),a=.4*S,l=-N/2,n=t%d,c=O.floor(t/d),s=(x-d*S)/2+n*S+S/2,h=(b-g*S)/2+c*S+S/2,p=0;for(m=e.length;p<m;++p)o=e[p]/f,u=l+2*N*o,y.beginPath(),y.moveTo(s,h),y.arc(s,h,a,l,u,!1),y.closePath(),y.fillStyle=T.PALETTE[p%T.PALETTE.length],y.fill(),y.font="10 px sans-serif",y.textAlign="center",y.fillStyle="#000",y.strokeStyle="#000",y.fillText((100*o).toFixed(2)+"%",s+(22+a)*O.cos((l+u)/2),h+(22+a)*O.sin((l+u)/2)),l=u}})},renderXLabel:function(){var n=this,t=n.canvas.getContext("2d"),r=n.canvas.width,e=n.canvas.height;t.font=String(15)+"px sans-serif",t.fillStyle="#000",t.textAlign="center",t.strokeStyle="#000",t.fillText(n.xlabel,r/2,e-1-n.pb/4)},renderYLabel:function(){var n=this.canvas.getContext("2d"),t=(this.canvas.width,this.canvas.height);n.font=String(15)+"px sans-serif",n.fillStyle="#000",n.textAlign="center",n.strokeStyle="#000",n.save(),n.translate(19.5,t/2),n.rotate(-O.PI/2),n.fillText(this.ylabel,0,0),n.restore()},renderTitle:function(){var n=this,t=n.canvas.getContext("2d"),r=n.canvas.width;n.canvas.height;t.font=String(18)+"px sans-serif",t.fillStyle="#000",t.textAlign="center",t.strokeStyle="#000",t.fillText(n.title,r/2,n.pt/2)},renderAxes:function(){var n,t,r,e,i,u,o,f,a,l,c,s=this,h=s.canvas.getContext("2d"),p=s.canvas.width,m=s.canvas.height;s.type;function g(n,t){return!1===t||n<1?parseFloat(n.toFixed(4)):O.ceil(n)}function d(n){return n.toFixed(3).replace(/0+$/,"").replace(/\.$/,"")}if(s.updateAxes(),n=s.xmin,s.xmax,t=s.ymin,s.ymax,"barh"===s.type){for(l=O.max(60,g((p-s.pl-s.pr)/16)),r=[],a=s.pl;f=s.y(a,!0),!(a>p-1-s.pr);a+=l)r.push({t:f,p:a});c=O.max(1,O.floor((m-s.pt-s.pb)/(s.no*s.data.length))),e=X(s.no,function(n){return{t:n+1,p:s.pt+n*s.data.length*c+s.data.length*c*.8/2}})}else{if("bar"===s.type)c=O.max(1,O.floor((p-s.pl-s.pr)/(s.no*s.data.length))),r=X(s.no,function(n){return{t:n+1,p:s.pl+n*s.data.length*c+s.data.length*c*.8/2}});else if(r=[],"log"===s.xscale)for(f=O.pow(10,O.floor(O.log10(n)));!((a=s.x(f))>p-1-s.pr);f*=10)for(r.push({t:f,p:a}),o=1;o<=8&&!((a=s.x(o*f))>p-1-s.pr);++o)r.push({t:o*f,p:a});else for(l=O.max(60,g((p-s.pl-s.pr)/16)),a=s.pl;f=s.x(a,!0),!(a>p-1-s.pr);a+=l)r.push({t:f,p:a});if(e=[],"log"===s.yscale)for(f=O.pow(10,O.floor(O.log10(t)));!((a=s.y(f))<s.pt);f*=10)for(e.push({t:f,p:a}),o=1;o<=8&&!((a=s.y(o*f))<s.pt);++o)e.push({t:o*f,p:a});else for(l=O.max(40,g((m-s.pt-s.pb)/16)),a=m-1-s.pb;f=s.y(a,!0),!(a<s.pt);a-=l)e.push({t:f,p:a})}h.font=String(10)+"px sans-serif",h.fillStyle="#000",h.textAlign="center",h.strokeStyle="#000",h.lineWidth=1,h.beginPath(),h.moveTo(s.pl,s.pt),h.lineTo(p-1-s.pr,s.pt),h.lineTo(p-1-s.pr,m-1-s.pb),h.lineTo(s.pl,m-1-s.pb),h.lineTo(s.pl,s.pt),h.stroke(),i=O.max(8,.001*m),r.forEach(function(n){h.lineWidth=.5,h.beginPath(),h.moveTo(n.p,m-1-s.pb),h.lineTo(n.p,m-1-s.pb-i),h.stroke(),h.beginPath(),h.moveTo(n.p,s.pt),h.lineTo(n.p,s.pt+i),h.stroke(),"log"===s.xscale?w(O.log10(n.t))&&h.fillText("10^"+String(O.floor(O.log10(n.t))),n.p,m-1-s.pb+5+10):h.fillText(d(n.t),n.p,m-1-s.pb+5+10)}),u=O.max(8,.001*p),e.forEach(function(n,t){h.lineWidth=.5,h.beginPath(),h.moveTo(s.pl,n.p),h.lineTo(s.pl+u,n.p),h.stroke(),h.beginPath(),h.moveTo(p-1-s.pr,n.p),h.lineTo(p-1-s.pr-u,n.p),h.stroke(),"log"===s.yscale?w(O.log10(n.t))&&h.fillText("10^"+String(O.floor(O.log10(n.t))),s.pl-21,n.p):h.fillText(d(n.t),s.pl-21,n.p)})},updateAxes:function(){var r=this,n=r.canvas.width,t=r.canvas.height,e=s,i=-s,u=s,o=-s,f=s;r.data.forEach(function(n,t){"barh"===r.type||"bar"===r.type?f=O.min(f,n.y.length):(f=O.min(f,n.x.length,n.y.length),e=O.min(e,On(n.x)),i=O.max(i,$n(n.x))),u=O.min(u,On(n.y)),o=O.max(o,$n(n.y))}),"barh"!==r.type&&"bar"!==r.type||(e=1,i=f,0<u&&(u=0),o<0&&(o=0)),e===i&&(e-=$,i+=$),u===o&&(u-=$,o+=$),r.no=f,r.xmin=e,r.xmax=i,r.ymin=u,r.ymax=o,"log"===r.xscale?(r.xmin=O.pow(10,O.floor(O.log10(r.xmin||$))),r.xmax=O.pow(10,O.ceil(O.log10(r.xmax||$))),r.scx=(n-1-r.pl-r.pr)/(O.log10(r.xmax)-O.log10(r.xmin))):r.scx=(n-1-r.pl-r.pr)/(r.xmax-r.xmin),"log"===r.yscale?(r.ymin=O.pow(10,O.floor(O.log10(r.ymin||$))),r.ymax=O.pow(10,O.ceil(O.log10(r.ymax||$))),r.scy=("barh"===r.type?n-1-r.pl-r.pr:t-1-r.pt-r.pb)/(O.log10(r.ymax)-O.log10(r.ymin))):r.scy=("barh"===r.type?n-1-r.pl-r.pr:t-1-r.pt-r.pb)/(r.ymax-r.ymin),r.sc=O.min(r.scx,r.scy)},x:function(n,t){var r=this,e=r.xmin,i=r.yscale===r.xscale?r.sc:r.scx;return!0===t?(n-r.pl)/i+e:("log"===r.xscale&&(e=O.log10(e),n=O.log10(n||$)),(n-e)*i+r.pl)},y:function(n,t){var r=this,e=r.ymin,i=r.yscale===r.xscale?r.sc:r.scy,u=r.canvas.height;return!0===t?"barh"===r.type?(n-r.pl)/i+e:(u-1-n-r.pb)/i+e:("log"===r.yscale&&(e=O.log10(e),n=O.log10(n||$)),"barh"===r.type?(n-e)*i+r.pl:u-1-((n-e)*i+r.pb))},option:function(n,t,r,e){var i,u,o,f={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},a={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},l={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},c=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:l[c[(e||0)%c.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=l[c[(e||0)%c.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=f["-"]),n._LineStyle||(n._LineStyle="-"),r=r||0;r<t.length;){if("Color"===t[r])I(i=t[r+1])?A.call(a,i)?n.Color=l[a[i]]:A.call(l,i)&&(n.Color=l[i]):y(i)&&3===i.length&&(n.Color=i);else if("LineWidth"===t[r])M(i=t[r+1])&&(n.LineWidth=2*i);else{if("LineStyle"!==t[r]){if(I(t[r])){for(u in o=!1,i=t[r],l)-1<i.indexOf(u)&&(n.Color=l[u],o=!0);for(u in f)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=f[u],o=!0);if(o){r+=1;continue}}break}I(i=t[r+1])&&A.call(f,i)&&(n._LineStyle=i,n.LineStyle=f[i])}r+=2}return r},parse:function(n,t,r){var e,i,u,o,f,a,l=this,c=0,s=0;if("pie"===t)for(;c<n.length;)y(n[c])?l.data.push({y:n[c++]}):c+=1;else if("plot3"===t)for(;c<n.length;)f=o=u=null,y(n[c])&&(u=n[c]),y(n[c+1])&&(o=n[c+1]),y(n[c+2])&&(f=n[c+2],c+=3),u&&o&&f?(c=l.option(a={},n,c,s),l.data.push({x:u,y:o,z:f,style:a}),++s):c+=1;else for(;c<n.length;)if(o=u=null,y(n[c])&&(u=n[c]),y(n[c+1])||S(n[c+1])?(o=n[c+1],c+=2):u&&(u=Nn(1,(o=u).length),c+=1),u&&o)if(c=l.option(a={},n,c,s),S(o))for(e=0,i=V(o);e<i;++e)l.data.push({x:u,y:R(o,e),style:a}),a=l.option(a,n,c,++s);else l.data.push({x:u,y:o,style:a}),++s;else c+=1;return l}},T.figure=e,E.plot=function(){var n=e().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("plot",T.createCanvas(700,525)):null},E.loglog=function(){var n=e().parse(arguments);return n.xscale="log",n.yscale="log",n.data.length?n.render("plot",T.createCanvas(700,525)):null},E.semilogx=function(){var n=e().parse(arguments);return n.xscale="log",n.yscale="linear",n.data.length?n.render("plot",T.createCanvas(700,525)):null},E.semilogy=function(){var n=e().parse(arguments);return n.xscale="linear",n.yscale="log",n.data.length?n.render("plot",T.createCanvas(700,525)):null},E.scatter=function(){var n=e().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("scatter",T.createCanvas(700,525)):null},E.bar=function(){var n=e().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("bar",T.createCanvas(700,525)):null},E.barh=function(){var n=e().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("barh",T.createCanvas(700,525)):null},E.piechart=function(){var n=e().parse(arguments,"pie");return n.data.length?n.render("pie",T.createCanvas(700,525)):null},E.donutchart=function(){return E.piechart.apply([].slice.call(arguments))},E.xlabel=function(n){var t=e();return t.xlabel=String(n),t.render("xlabel",T.currentCanvas())},E.ylabel=function(n){var t=e();return t.ylabel=String(n),t.render("ylabel",T.currentCanvas())},E.title=function(n){var t=e();return t.title=String(n),t.render("title",T.currentCanvas())};var vt={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var t=[],r=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?r.length&&(b(r[0])?t=t.length?Tn("vert",t,r):r:t.push(r),r=[]):!_(n,St)&&b(n)?r=r.length?Tn("horz",r,n):n:r.push(n))}),r.length&&(b(r[0])?t=t.length?Tn("vert",t,r):r:t.length?t.push(r):t=r),t}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return Nn(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,t){return Nn(n,t)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,t,r){return Nn(n,t,r)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:jn},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:Rn},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:yn},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:function e(t,i){if(v(t)&&v(i))return sn(t,i);if(S(t)&&S(i)){if(B(t)===B(i)&&V(t)===V(i))return t.map(function(n,r){return n.map(function(n,t){return e(n,i[r][t])})});throw"dotpow: matrix dimensions do not match"}if(y(t)&&y(i)){if(t.length===i.length)return t.map(function(n,t){return e(n,i[t])});throw"dotpow: vector dimensions do not match"}return b(t)?t.map(function(n){return e(n,i)}):b(i)?i.map(function(n){return e(t,n)}):t}},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,t){return rt(n,t)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:vn},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:vn},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:l},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:dn},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:mn},"-":{name:"sub",arity:2,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:gn},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:function r(e,i){if(I(e)){if(I(i))return i<=e?1:0;if(v(i))return e>=String(i)?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),V(i),function(n,t){return r(e,i[n][t])})}else if(M(e)){if(I(i))return String(e)>=i?1:0;if(M(i))return i<=e?1:0;if(u(i))return i.re>=e&&0===i.im?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),V(i),function(n,t){return r(e,i[n][t])})}else if(u(e)){if(I(i))return String(e)>=i?1:0;if(M(i))return e.re>=i&&0===e.im?1:0;if(u(i))return C(e,i)?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),V(i),function(n,t){return r(e,i[n][t])})}else if(y(e)){if(I(i)||v(i))return e.map(function(n){return r(n,i)});if(y(i)){if(e.length!==i.length)throw"ge: inputs have incompatible dimensions";return e.map(function(n,t){return r(n,i[t])})}if(S(i)){if(e.length!==V(i))throw"ge: inputs have incompatible dimensions";return k(B(i),V(i),function(n,t){return r(e[t],i[n][t])})}}else if(S(e)){if(I(i)||v(i))return k(B(e),V(e),function(n,t){return r(e[n][t],i)});if(y(i)){if(V(e)!==i.length)throw"ge: inputs have incompatible dimensions";return k(B(e),V(e),function(n,t){return r(e[n][t],i[t])})}if(S(i)){if(B(e)!==B(i)||V(e)!==V(i))throw"ge: inputs have incompatible dimensions";return k(B(e),V(e),function(n,t){return r(e[n][t],i[n][t])})}}return 0}},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:a},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:function r(e,i){if(I(e)){if(I(i))return i<e?1:0;if(v(i))return e>String(i)?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),V(i),function(n,t){return r(e,i[n][t])})}else if(M(e)){if(I(i))return String(e)>i?1:0;if(M(i))return i<e?1:0;if(u(i))return i.re>e&&0===i.im?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),V(i),function(n,t){return r(e,i[n][t])})}else if(u(e)){if(I(i))return String(e)>i?1:0;if(M(i))return e.re>i&&0===e.im?1:0;if(u(i))return 0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),V(i),function(n,t){return r(e,i[n][t])})}else if(y(e)){if(I(i)||v(i))return e.map(function(n){return r(n,i)});if(y(i)){if(e.length!==i.length)throw"gt: inputs have incompatible dimensions";return e.map(function(n,t){return r(n,i[t])})}if(S(i)){if(e.length!==V(i))throw"gt: inputs have incompatible dimensions";return k(B(i),V(i),function(n,t){return r(e[t],i[n][t])})}}else if(S(e)){if(I(i)||v(i))return k(B(e),V(e),function(n,t){return r(e[n][t],i)});if(y(i)){if(V(e)!==i.length)throw"gt: inputs have incompatible dimensions";return k(B(e),V(e),function(n,t){return r(e[n][t],i[t])})}if(S(i)){if(B(e)!==B(i)||V(e)!==V(i))throw"gt: inputs have incompatible dimensions";return k(B(e),V(e),function(n,t){return r(e[n][t],i[n][t])})}}return 0}},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:L},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:function r(e,i){if(I(e)){if(I(i))return e===i?0:1;if(v(i))return e===String(i)?0:1;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),V(i),function(n,t){return r(e,i[n][t])})}else if(M(e)){if(I(i))return String(e)===i?0:1;if(M(i))return e===i?0:1;if(u(i))return i.re===e&&0===i.im?0:1;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),V(i),function(n,t){return r(e,i[n][t])})}else if(u(e)){if(I(i))return String(e)===i?0:1;if(M(i))return e.re===i&&0===e.im?0:1;if(u(i))return e.re===i.re&&e.im===i.im?0:1;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),V(i),function(n,t){return r(e,i[n][t])})}else if(y(e)){if(I(i)||v(i))return e.map(function(n){return r(n,i)});if(y(i)){if(e.length!==i.length)throw"ne: inputs have incompatible dimensions";return e.map(function(n,t){return r(n,i[t])})}if(S(i)){if(e.length!==V(i))throw"ne: inputs have incompatible dimensions";return k(B(i),V(i),function(n,t){return r(e[t],i[n][t])})}}else if(S(e)){if(I(i)||v(i))return k(B(e),V(e),function(n,t){return r(e[n][t],i)});if(y(i)){if(V(e)!==i.length)throw"ne: inputs have incompatible dimensions";return k(B(e),V(e),function(n,t){return r(e[n][t],i[t])})}if(S(i)){if(B(e)!==B(i)||V(e)!==V(i))throw"ne: inputs have incompatible dimensions";return k(B(e),V(e),function(n,t){return r(e[n][t],i[n][t])})}}return 0}},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:C},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,t){return h(n)&&h(t)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,t){return h(n)||h(t)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,t){return h(n)&&!h(t)||h(t)&&!h(n)?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return h(n)?0:1}},"=":{name:"set",breakpoint:"end",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,t){var r,e;return b(n)&&_(n[0],St)?(e=n,b(r=t)?await Promise.all(e.map(function(n,t){return yt(n,t<r.length?r[t]:null)})):await Promise.all(e.map(function(n,t){return yt(n,0===t?r:null)}))):yt(n,A.call(t,"$mainRet$")?t.$mainRet$:t)}}};async function yt(n,t){if(_(n,St)&&I(n.v))return await n.set(t),n.get(!0);throw"setting non-variable"}async function wt(n,t,r){var e,i,u,o,f,a,l=null;if(h(await Tt(n.if.cond,t,r))){for(e=0,o=(f=n.if.statements).length;e<o;++e)null!=(a=await Tt(f[e],t,r))&&(l=a);return l}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(h(await Tt(n.elseif[i].cond,t,r))){for(e=0,o=(f=n.elseif[i].statements).length;e<o;++e)null!=(a=await Tt(f[e],t,r))&&(l=a);return l}if(n.else.statements.length){for(e=0,o=(f=n.else.statements).length;e<o;++e)null!=(a=await Tt(f[e],t,r))&&(l=a);return l}}async function xt(n,t,r){var e,i,u,o,f,a,l,c=null,s=!1,h=!1,p=await Tt(n.val,t,r),m=n.statements;if(b(p)){for(a=(r=r||{}).brk,l=r.cont,r.brk=function(){s=!0},r.cont=function(){h=!0},u=0,o=p.length;u<o;++u){for(h=s=!1,await n.ind.set(p[u]),e=0,i=m.length;e<i&&(f=await Tt(m[e],t,r),!s&&!h);++e)null!=f&&(c=f);if(s)break}r.brk=a,r.cont=l}return c}async function bt(n,t,r){var e,i,u,o=null,f=!1,a=!1,l=n.statements,c=(r=r||{}).brk,s=r.cont;for(r.brk=function(){f=!0},r.cont=function(){a=!0};h(await Tt(n.cond,t,r));){for(a=f=!1,e=0,i=l.length;e<i&&(u=await Tt(l[e],t,r),!f&&!a);++e)null!=u&&(o=u);if(f)break}return r.brk=c,r.cont=s,o}function St(n,t,r){if(!_(this,St))return new St(n,t,r);this.ctx=n,this.v=t,this.i=r}function j(n,t){if(!_(this,j))return new j(n,t);null==t&&(t=n,n=""),this.op=n,this.arg=t}function kt(n,t){return 2===arguments.length&&b(n)&&(n.$mainRet$=t),n}async function At(n){return _(n,St)?await n.get():n}async function Tt(n,t,r){if(_(n,j))return _t(n,t,r);if(b(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await Tt(n[e],t,r);return u}return n}function Et(v,y,w,i){var x,b=0,S=0,u=v;function k(n,t,r){null==r&&(r=S),null==t&&(t=b);var e=u.split("\n")[r];return(n=String(n)+" at line "+String((w||0)+r)+" position "+String((i||0)+t)+":")+"\n"+e+"\n"+new Array(t+1).join(" ")+"^\n"}return function i(n){var t,r,e,u,o,f,a,l=[],c=[],s=[];function h(n){var t,r,e,i,u,o,f,a;if(c.length)if(n)for(;0<c.length;){if(u=(i=c.shift())[0],n===(o=vt[u]).breakpoint){c.unshift(i);break}if("-"===u&&1===l.length)l[0]=j(vt["*"].fn,[l[0],j(-1)]);else{if(o.arity>l.length)throw k('invalid or missing argument for "'+u+'"',i[1],i[2]);a=l.splice(0,o.arity).reverse(),f=j(o.fn,a),l.unshift(f)}}else if(r=(t=c.shift())[0],1===(e=vt[r]).fixity){if(e.arity>l.length)throw k('invalid or missing argument for "'+r+'"',t[1],t[2]);a=l.splice(0,e.arity).reverse(),f=j(e.fn,a),l.unshift(f)}else{if(-1!==e.fixity)for(;0<c.length&&(u=(i=c[0])[0],(o=vt[u]).priority<e.priority||o.priority===e.priority&&(o.associativity<e.associativity||o.associativity===e.associativity&&-1===o.associativity));){if("-"===u&&1===l.length)l[0]=j(vt["*"].fn,[l[0],j(-1)]);else{if(o.arity>l.length)throw k('invalid or missing argument for "'+u+'"',i[1],i[2]);a=l.splice(0,o.arity).reverse(),f=j(o.fn,a),l.unshift(f)}c.shift()}c.unshift(t)}}function p(n){if(h(!0),1<l.length||0<c.length)throw k("mismatched terms and operators",c.length?c[0][1]:b,c.length?c[0][2]:S);!0===n&&(_(l[0],j)&&s.push(l[0]),l=[],c=[])}function m(n,t){var r,e=n.test?v.match(n):n===v.slice(0,n.length);return!!e&&(!1===t?n.test?e:[n,n]:n.test?(r=e[t||0].length,v=v.slice(r),b+=r,e):(r=n.length,v=v.slice(r),b+=r,[n,n]))}function g(n,t,r){for(var e,i=r||0,u="";i<v.length;)if(n===(e=v.charAt(i))){if(!(i+1<v.length&&n===v.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return t&&(v=v.slice(i+1),b+=i+1),[u,i+1]}function d(){var n,t,r,e=function(n,t,r){for(var e,i=0,u=0;i<v.length;)if(e=v.charAt(i),!r||'"'!==e&&"'"!==e){if(t===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=g(e,!1,i+1)[1];return u||i>=v.length?-1:i}("]","[",!0);if(-1===e)throw k("mismatched brackets");if(n=v.slice(0,e),/[\[\]]/.test(n)){for(t=[];r=i(",;]");)if(t.push(r),m(","))t.push(j(","));else{if(!m(";"))break;t.push(j(";"))}m(/^\s+/),m("]")}else t=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,t){var r=n.length,e=0;return t.trim().split(-1<t.indexOf(",")?",":/\s+/g).reduce(function(n,t){return(t=Et(t.trim(),y,S+w,b))&&(e?n.push(j(",")):r&&n.push(j(";")),n.push(t),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,t){return(t=Et(t.trim(),y,S+w,b))&&(n.length&&n.push(j(",")),n.push(t)),n},[]),v=v.slice(e+1),b+=e+1,1<(n=n.split("\n")).length&&(S+=n.length-1,n.slice(0,-1).forEach(function(n){b-=n.length+1}));return j(vt["[]"].fn,t)}for(;0<v.length;)if(m(/^if\b/)){if(p(!0),!(a=i("\n")))throw k('missing or invalid condition in "if"');for(m("\n")&&(++S,b=0),o=(f={if:{cond:a,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((a=i(["elseif","else","end"]))&&(o.statements=o.statements.concat(a)),m("elseif")){if(!(a=i("\n")))throw k('missing or invalid condition in "elseif"');m("\n")&&(++S,b=0),f.elseif.push({cond:a,statements:[]}),o=f.elseif[f.elseif.length-1]}else if(m("else"))m(/^[ \t\v\f]+/),m("\n")&&(++S,b=0),o=f.else;else if(m("end")||!a)break;s.push(j(wt,f))}else if(m(/^for\b/)){if(p(!0),!(t=m(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw k('missing or invalid declaration in "for"');if(!(a=i("\n")))throw k('missing or invalid declaration in "for"');for(m("\n")&&(++S,b=0),f={ind:St(y,t[1]),val:a,statements:[]};(a=i(["end"]))&&(f.statements=f.statements.concat(a)),!m("end")&&a;);s.push(j(xt,f))}else if(m(/^while\b/)){if(p(!0),!(a=i("\n")))throw k('missing or invalid condition in "while"');for(m("\n")&&(++S,b=0),f={cond:a,statements:[]};(a=i(["end"]))&&(f.statements=f.statements.concat(a)),!m("end")&&a;);s.push(j(bt,f))}else if(t=m(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(t[1]))break;if("continue"===t[1])m("continue"),s.push(j("continue",""));else if("break"===t[1])m("break"),s.push(j("break",""));else{if("end"!==t[1])throw k('unexpected "'+t[1]+'"');m("end"),l.unshift(j("v",St(y,"end")))}}else if(m("..."))m(/^[ \t\v\f]+/);else if(m(";",!1)){if(n&&-1<n.indexOf(";"))break;m(";"),p(!0)}else if(m("\n",!1)){if(n&&-1<n.indexOf("\n"))break;m("\n"),++S,p(!(b=0))}else if(m(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(t=m("%"))x=v.indexOf("\n"),v=v.slice(-1<x?x+1:v.length),++S,p(!(b=0));else if(t=(t=m("'"))||m('"'))o=g(t[0],!0)[0],l.unshift(j("'"===t[0]?o.split(""):o));else if(t=m(/^(&&|\|\|)[^&\|]/,1))u=t[1],c.unshift([u,b,S]),h();else if(t=m(/^(xor)[^a-zA-Z]/,1))u=t[1],c.unshift([u,b,S]),h();else if(t=m(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=t[1],c.unshift([u,b,S]),h();else if(t=m("~"))c.unshift(["~",b,S]),h();else if(t=m("="))c.unshift(["=",b,S]),h();else if(t=m(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=t[0],c.unshift([u,b,S]),h();else if(t=m(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(r=t[1],m(/^\s*\:\s*\)/))o=j("v",St(y,r)),l.unshift(o),c.unshift(["(:)",b,S]),h();else{for(f=[];(a=i(",)"))&&f.push(a),m(","););if(!m(")"))throw k("mismatched parentheses");o=A.call(E,r)?j(E[r],f):j("v",St(y,r,f.length?f:null)),l.unshift(o)}m(/^[ \t\v\f]+/),(t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h())}else if(t=m(/^[_a-z][_a-z0-9]*/i))r=t[0],o=A.call(E,r)&&0===E[r].length?j(E[r],[]):j("v",St(y,r)),l.unshift(o),m(/^[ \t\v\f]+/),(t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h());else if(t=m(/^(-?\s*\d+(\.\d+)?([eE]-?\d+)?)([ij])?/))f=parseFloat(t[1].split(/\s+/).join(""),10),o=j(t[4]?new P(0,f):f),l.unshift(o);else if("["===(e=v.charAt(0)))v=v.slice(1),b+=1,(o=d())&&(l.unshift(o),m(/^[ \t\v\f]+/),t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw k("mismatched brackets")}if("("===e)if(v=v.slice(1),b+=1,m(/^\s*\:\s*\)/))c.unshift(["(:)",b,S]),h();else{if(l.length&&c.reduce(function(n,t){return n+("-"===t[0]&&1===l.length?1:vt[t[0]].arity)},0)<=l.length){for(h("end"),o=l.shift(),f=[];(a=i(",)"))&&f.push(a),m(","););if(!m(")"))throw k("mismatched parentheses");f.length&&(o=j("v",St(y,o,f)))}else if(o=i(")"),!m(")"))throw k("mismatched parentheses");o&&(l.unshift(o),m(/^[ \t\v\f]+/),t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw k("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw k(n?'missing expected "'+(I(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(v=v.slice(1),a=[b+=1,S],h("end"),l.length?f=1:(f=0,l.unshift(j(":")));o=i(":,)\n"),m(/^[ \t\v\f]+/),o?(l.unshift(o),++f):m(":",!1)&&l.unshift(j(":")),m(":"););1<f&&(c.unshift([3===f?"::":":",a[0],a[1]]),h())}}return p(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function _t(n,t,r){if(_(n,j)){if(""===n.op)return n.arg;if("v"===n.op)return!1===t?n.arg:_(n.arg.v,j)?At(n.arg):q(t)&&A.call(t,n.arg.v)?t[n.arg.v]:await At(n.arg);if(wt===n.op)return wt(n.arg,t,r);if(xt===n.op)return xt(n.arg,t,r);if(bt===n.op)return bt(n.arg,t,r);if("break"===n.op)return void(r&&d(r.brk)&&r.brk());if("continue"===n.op)return void(r&&d(r.cont)&&r.cont());if(vt["="].fn===n.op)return 2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[await _t(n.arg[0],!1),n.arg[1].arg.isByRef()?K(await _t(n.arg[1],t,r)):await _t(n.arg[1],t,r)]):n.op.apply(null,[await _t(n.arg[0],!1)].concat(await Promise.all(n.arg.slice(1).map(function(n){return _t(n,t,r)}))));if(d(n.op))return n.op.apply(null,await Promise.all(n.arg.map(function(n){return _t(n,t,r)})))}throw"invalid expr"}return T.op=vt,St.prototype={constructor:St,ctx:null,v:null,i:null,get:async function(n){var t,r,e=this;if(_(e.v,j))t=await Tt(e.v);else{if(!A.call(e.ctx,e.v)&&!A.call(m,e.v))throw'undefined variable "'+e.v+'"';t=(A.call(e.ctx,e.v)?e.ctx:m)[e.v]}return!0!==n&&null!=e.i?(r=_n(t),n=await Promise.all(e.i.map(function(n,t){return Tt(n,{end:1===e.i.length?r[0]*r[1]:r[t]})})),kn.apply(null,[t].concat(n))):t},set:async function(n){var t,r,e,i=this;if(null!=i.i){if(_(i.v,j))t=await Tt(i.v);else{if(!A.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';t=i.ctx[i.v]}r=_n(t),1===(e=await Promise.all(i.i.map(function(n,t){return Tt(n,{end:1===i.i.length?r[0]*r[1]:r[t]})}))).length&&(e=e.concat(null)),An.apply(null,[t].concat(e).concat([n]))}else _(i.v,j)||(i.ctx[i.v]=n);return i},isset:function(){return I(this.v)&&A.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},j.prototype={constructor:j,op:null,arg:null},T.ret=kt,T.createCanvas=function(n,t){},T.currentCanvas=function(){},T.createContext=function(){return{ans:null}},T.eval=async function(n,t,r){t=t||T.createContext();var e=Et(String(n),t,null==r?1:r,1),i=null,u=!1;if(b(e))for(var o=0,f=e.length;o<f;++o)e[o]&&(i=await _t(e[o]),u=!0);else e&&(i=await _t(e),u=!0);return u&&(b(i)||p(i)||v(i)||I(i))&&(t.ans=i),u?i:null},T});