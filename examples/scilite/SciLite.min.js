/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.0
* https://github.com/foo123/SciLite
*
**/
!function(t,n,r){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=r.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return r.moduleUri=n.uri,r.call(t)}):n in t||(t[n]=r.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function t(){}var M=Math,q=M.PI,e=M.E,l=1/0,o=NaN,Y=1e-15,i=Number.MAX_VALUE,J=Number.MIN_VALUE,f=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,z=Object.prototype.hasOwnProperty,m=Object.prototype.toString,g=Number.isNaN,b=Array.isArray||function(n){return"[object Array]"===m.call(n)},A={VERSION:"0.9.0",fn:{},op:null,constant:{pi:q,e:e,eps:Y,realmax:i,realmin:J,intmax:f,intmin:c,inf:l,Inf:l,nan:o,NaN:o}},d=A.constant,T=A.fn;function s(n){throw String(n)+": input(s) not supported"}function _(n,t){return n instanceof t}function O(n){return"function"==typeof n}function H(n){return"[object Object]"===m.call(n)}function E(n){return"string"==typeof n}function K(n){return"number"==typeof n&&!isFinite(n)}function X(n){return"number"==typeof n}function w(n){return Number.isInteger(n)}function u(n){return n instanceof I}function v(n,t){if(X(n)||u(n))return!0;if(!1===t){if(y(n)&&1===n.length)return!0;if(S(n)&&1===n.length&&1===n[0].length)return!0}return!1}function y(n){return b(n)&&v(n[0])}function S(n){return b(n)&&b(n[0])&&v(n[0][0])}function nn(n){return!b(n)}function tn(n){return b(n)&&!b(n[0])}function h(n){return b(n)&&b(n[0])}function rn(n){return!u(n)||0===n.im}function en(n,t){return X(n)?n:u(n)?t?0===n.im&&n.re:n:y(n)?1===n.length&&en(n[0],t):!!S(n)&&1===n.length&&1===n[0].length&&en(n[0][0],t)}function Z(n,t){for(var r=new Array(n),e=0;e<n;++e)r[e]=O(t)?t(e,r):t;return r}function k(n,t,r){for(var e,i,u=new Array(n),o=0;o<n;++o)for(u[o]=i=new Array(t),e=0;e<t;++e)i[e]=O(r)?r(o,e,u):r;return u}function un(n){if(h(n)){if(1===B(n))return n[0];if(1===G(n))return n.map(function(n){return n[0]})}return n}function on(n){return n=b(n)?n.map(on):n}function fn(t,n,r){return!0===t?n:X(n)||r&&u(n)?t(n):b(n)?n.map(function(n){return fn(t,n,r)}):n}function p(n){return E(n)?0<n.length:g(n)?0:X(n)?0!==n:u(n)?p(n.re)||p(n.im):b(n)?0<n.length&&n.length===n.filter(p).length:!0===n}function ln(n,r){return v(r)?v(n)?P(n,r):n.filter(function(n){return ln(n,r)}).length===n.length:!!b(r)&&(v(n)?ln(r,n):n.length===r.length&&n.filter(function(n,t){return ln(n,r[t])}).length===r.length)}function I(n,t,r){var e=this;if(!_(e,I))return new I(n,t,r);u(n)?(e.re=n.re,e.im=n.im):(t=t||0,"polar"===r?(e._rho=M.abs(n),e._theta=t,e.re=e._rho*M.cos(e._theta),e.im=e._rho*M.sin(e._theta)):(e.re=n,e.im=t))}function an(n){return u(n)?n.sign():M.sign(n)}T.clc=t,T.disp=t,T.clear=t,T.help=t,T.who=t,T.whos=t,T.exist=t,T.rowvec=function(n){return tn(n)?[n]:n},T.colvec=function(n){return tn(n)?n.map(function(n){return[n]}):n},A.exist=function(n,t){return H(t)&&E(n)&&z.call(t,n)?1:0},I.prototype={constructor:I,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var t=this;return null==t._rho&&(t._rho=gn(t.re,t.im)),t._rho},norm2:function(){return null==this._rho2&&(this._rho2=M.pow(this.abs(),2)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=0===n.re?(n.im<0?-1:1)*q/2:M.atan(n.im/n.re)),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=n.im?n.div(n.abs()):M.sign(n.re),u(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return X(n)?new I(this.re+n,this.im):new I(this.re+n.re,this.im+n.im)},sub:function(n){return X(n)?new I(this.re-n,this.im):new I(this.re-n.re,this.im-n.im)},mul:function(n){var t,r,e,i=this;return X(n)?new I(i.re?i.re*n:0,i.im?i.im*n:0):(t=i.re,r=n.re,i=i.im,new I((e=t*(r+(n=n.im)))-n*(t+i),e+r*(i-t)))},div:function(n){var t,r,e,i=this;return X(n)?new I(i.re?i.re/n:0,i.im?i.im/n:0):(e=n.norm2(),t=i.re,r=n.re/e,i=i.im,new I((e=t*(r+(n=-n.im/e)))-n*(t+i),e+r*(i-t)))},pow:function(n){var t,r;return X(n)?new I(M.pow(this.abs(),n),this.angle()*n,"polar"):u(n)?(t=this.abs(),r=this.angle(),new I(M.pow(t,n.re),n.im*M.log(t),"polar").mul(new I(M.exp(-n.im*r),r*n.re,"polar"))):void 0},neg:function(){return new I(-this.re,-this.im)},conj:function(){return new I(this.re,-this.im)},inv:function(){var n=this.norm2();return new I(this.re/n,-this.im/n)},toString:function(){var n=this;return null==n._str&&(n._str=hn(n.re)+(n.im<0?" - ":" + ")+hn(M.abs(n.im))+"i"),n._str},valueOf:function(){return this.re}};new I(0,1);var cn=new I(e,0),sn={sign:an,sqrt:function(n){return n.pow(new I(.5))},exp:function(n){return cn.pow(n)},log:function(n){return new I(M.log(n.abs()),n.angle())},sin:function(n){return new I(M.sin(n.re)*M.cosh(n.im),M.cos(n.re)*M.sinh(n.im))},cos:function(n){return new I(M.cos(n.re)*M.cosh(n.im),-M.sin(n.re)*M.sinh(n.im))},tan:function(n){return sn.sin(n).div(sn.cos(n))},sinh:function(n){return new I(M.sinh(n.re)*M.cos(n.im),M.cosh(n.re)*M.sin(n.im))},cosh:function(n){return new I(M.cosh(n.re)*M.cos(n.im),M.sinh(n.re)*M.sin(n.im))},tanh:function(n){return sn.sinh(n).div(sn.cosh(n))},asin:null,acos:null,atan:null,asinh:null,acosh:null,atanh:null};function hn(n){return g(n)?n="nan":K(n)?n=(n<0?"-":"")+"inf":X(n)?n=w(n)?String(n):n.toFixed(4).replace(/\.0{4}$/,""):u(n)&&(n=String(n)),n}function pn(n){var t;return null==n?n="":E(n)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(n)&&(n="\\text{"+n+"}"):n=g(n)?"\\text{nan}":X(n)?-1<[Y,i,J,f,c].indexOf(n)?String(n):hn(n).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):u(n)?String(n).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):S(n)?(t=!1,G(n)>A.MAXPRINTSIZE&&(n=n.map(function(n){return n.slice(0,M.round(A.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-M.round(A.MAXPRINTSIZE/2)))}),t=!0),"\\begin{bmatrix}"+(n=B(n)>A.MAXPRINTSIZE?n.slice(0,M.round(A.MAXPRINTSIZE/2)).concat([Z(A.MAXPRINTSIZE,function(n){return M.round(A.MAXPRINTSIZE/2)===n&&t?"\\ddots":"\\vdots"})]).concat(n.slice(1-M.round(A.MAXPRINTSIZE/2))):n).map(function(n){return n.map(pn).join(" & ")}).join(" \\\\ ")+"\\end{bmatrix}"):b(n)?(n=n.length>A.MAXPRINTSIZE?n.slice(0,M.round(A.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(n.slice(1-M.round(A.MAXPRINTSIZE/2))):n).map(pn).join(" \\hskip 1em "):"object"==typeof n||"function"==typeof n?"":String(n),n}function W(n){return b(n)?n.map(W):!u(n)||n.im?n:n.re}function mn(n){return b(n)?n.map(mn):X(n)?new I(n,0):n}function gn(n,t){n=M.abs(n),t=M.abs(t);var r=0;return 0===n?t:0===t?n:t<n?n*M.sqrt(1+(r=t/n)*r):n<t?t*M.sqrt(1+(r=n/t)*r):n*M.SQRT2}function dn(){var n,t,r,e=0,i=0;if(X(dn.z1))return r=dn.z1,dn.z1=null,r;for(;0===e||1===e;)e=M.random();for(;0===i||1===i;)i=M.random();return t=(n=M.sqrt(-2*M.log(e)))*M.cos(2*q*i),r=n*M.sin(2*q*i),dn.z1=r,t}function P(r,e){if(E(r)){if(E(e))return r===e?1:0;if(v(e))return r===String(e)?1:0;if(y(e))return e.map(function(n){return P(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return P(r,e[n][t])})}else if(X(r)){if(E(e))return String(r)===e?1:0;if(X(e))return r===e?1:0;if(u(e))return e.re===r&&0===e.im?1:0;if(y(e))return e.map(function(n){return P(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return P(r,e[n][t])})}else if(u(r)){if(E(e))return String(r)===e?1:0;if(X(e))return r.re===e&&0===r.im?1:0;if(u(e))return r.re===e.re&&r.im===e.im?1:0;if(y(e))return e.map(function(n){return P(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return P(r,e[n][t])})}else if(y(r)){if(E(e)||v(e))return r.map(function(n){return P(n,e)});if(y(e)){if(r.length!==e.length)throw"eq: inputs have incompatible dimensions";return r.map(function(n,t){return P(n,e[t])})}if(S(e)){if(r.length!==G(e))throw"eq: inputs have incompatible dimensions";return k(B(e),G(e),function(n,t){return P(r[t],e[n][t])})}}else if(S(r)){if(E(e)||v(e))return k(B(r),G(r),function(n,t){return P(r[n][t],e)});if(y(e)){if(G(r)!==e.length)throw"eq: inputs have incompatible dimensions";return k(B(r),G(r),function(n,t){return P(r[n][t],e[t])})}if(S(e)){if(B(r)!==B(e)||G(r)!==G(e))throw"eq: inputs have incompatible dimensions";return k(B(r),G(r),function(n,t){return P(r[n][t],e[n][t])})}}return 0}function C(r,e){if(E(r)){if(E(e))return r<e?1:0;if(v(e))return r<String(e)?1:0;if(y(e))return e.map(function(n){return C(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return C(r,e[n][t])})}else if(X(r)){if(E(e))return String(r)<e?1:0;if(X(e))return r<e?1:0;if(u(e))return e.re<r&&0===e.im?1:0;if(y(e))return e.map(function(n){return C(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return C(r,e[n][t])})}else if(u(r)){if(E(e))return String(r)<e?1:0;if(X(e))return r.re<e&&0===r.im?1:0;if(u(e))return 0;if(y(e))return e.map(function(n){return C(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return C(r,e[n][t])})}else if(y(r)){if(E(e)||v(e))return r.map(function(n){return C(n,e)});if(y(e)){if(r.length!==e.length)throw"lt: inputs have incompatible dimensions";return r.map(function(n,t){return C(n,e[t])})}if(S(e)){if(r.length!==G(e))throw"lt: inputs have incompatible dimensions";return k(B(e),G(e),function(n,t){return C(r[t],e[n][t])})}}else if(S(r)){if(E(e)||v(e))return k(B(r),G(r),function(n,t){return C(r[n][t],e)});if(y(e)){if(G(r)!==e.length)throw"lt: inputs have incompatible dimensions";return k(B(r),G(r),function(n,t){return C(r[n][t],e[t])})}if(S(e)){if(B(r)!==B(e)||G(r)!==G(e))throw"lt: inputs have incompatible dimensions";return k(B(r),G(r),function(n,t){return C(r[n][t],e[n][t])})}}return 0}function vn(r,e){if(E(r)){if(E(e))return e<r?1:0;if(v(e))return r>String(e)?1:0;if(y(e))return e.map(function(n){return vn(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return vn(r,e[n][t])})}else if(X(r)){if(E(e))return String(r)>e?1:0;if(X(e))return e<r?1:0;if(u(e))return e.re>r&&0===e.im?1:0;if(y(e))return e.map(function(n){return vn(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return vn(r,e[n][t])})}else if(u(r)){if(E(e))return String(r)>e?1:0;if(X(e))return r.re>e&&0===r.im?1:0;if(u(e))return 0;if(y(e))return e.map(function(n){return vn(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return vn(r,e[n][t])})}else if(y(r)){if(E(e)||v(e))return r.map(function(n){return vn(n,e)});if(y(e)){if(r.length!==e.length)throw"gt: inputs have incompatible dimensions";return r.map(function(n,t){return vn(n,e[t])})}if(S(e)){if(r.length!==G(e))throw"gt: inputs have incompatible dimensions";return k(B(e),G(e),function(n,t){return vn(r[t],e[n][t])})}}else if(S(r)){if(E(e)||v(e))return k(B(r),G(r),function(n,t){return vn(r[n][t],e)});if(y(e)){if(G(r)!==e.length)throw"gt: inputs have incompatible dimensions";return k(B(r),G(r),function(n,t){return vn(r[n][t],e[t])})}if(S(e)){if(B(r)!==B(e)||G(r)!==G(e))throw"gt: inputs have incompatible dimensions";return k(B(r),G(r),function(n,t){return vn(r[n][t],e[n][t])})}}return 0}function yn(r,e){if(E(r)){if(E(e))return r<=e?1:0;if(v(e))return r<=String(e)?1:0;if(y(e))return e.map(function(n){return yn(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return yn(r,e[n][t])})}else if(X(r)){if(E(e))return String(r)<=e?1:0;if(X(e))return r<=e?1:0;if(u(e))return e.re<=r&&0===e.im?1:0;if(y(e))return e.map(function(n){return yn(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return yn(r,e[n][t])})}else if(u(r)){if(E(e))return String(r)<=e?1:0;if(X(e))return r.re<=e&&0===r.im?1:0;if(u(e))return P(r,e)?1:0;if(y(e))return e.map(function(n){return yn(r,n)});if(S(e))return k(B(e),G(e),function(n,t){return yn(r,e[n][t])})}else if(y(r)){if(E(e)||v(e))return r.map(function(n){return yn(n,e)});if(y(e)){if(r.length!==e.length)throw"le: inputs have incompatible dimensions";return r.map(function(n,t){return yn(n,e[t])})}if(S(e)){if(r.length!==G(e))throw"le: inputs have incompatible dimensions";return k(B(e),G(e),function(n,t){return yn(r[t],e[n][t])})}}else if(S(r)){if(E(e)||v(e))return k(B(r),G(r),function(n,t){return yn(r[n][t],e)});if(y(e)){if(G(r)!==e.length)throw"le: inputs have incompatible dimensions";return k(B(r),G(r),function(n,t){return yn(r[n][t],e[t])})}if(S(e)){if(B(r)!==B(e)||G(r)!==G(e))throw"le: inputs have incompatible dimensions";return k(B(r),G(r),function(n,t){return yn(r[n][t],e[n][t])})}}return 0}function $(n,t){return X(n)&&X(t)?n+t:u(n)&&v(t)?n.add(t):u(t)&&v(n)?t.add(n):o}function F(n,t){return X(n)&&X(t)?n-t:u(n)&&v(t)?n.sub(t):u(t)&&v(n)?t.neg().add(n):o}function Q(n,t){return X(n)&&X(t)?n*t:u(n)&&v(t)?n.mul(t):u(t)&&v(n)?t.mul(n):o}function U(n,t){return X(n)&&X(t)?n/t:u(n)&&v(t)?n.div(t):u(t)&&v(n)?t.inv().mul(n):o}function wn(n,t){return X(n)&&X(t)?M.pow(n,t):u(n)&&v(t)?n.pow(t):u(t)&&v(n)?new I(n,0).pow(t):o}function xn(n){return X(n)?-n:u(n)?n.neg():o}function D(n){return X(n)?n:u(n)?n.conj():o}function bn(n){return X(n)?0===n?l:1/n:u(n)?0===n.abs()?new I(l,n.im<0?l:-l):n.inv():o}function V(n){return X(n)?M.abs(n):u(n)?n.abs():o}function Sn(n){return X(n)?n<0?q:0:u(n)?n.angle():o}function kn(t,e){if(E(t)&&E(e))return t+e;if(v(t)&&v(e))return $(t,e);if(S(t)&&S(e)){if(B(t)===B(e)&&G(t)===G(e))return t.map(function(n,r){return n.map(function(n,t){return kn(n,e[r][t])})});throw"add: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return kn(n,e[t])});throw"add: vector dimensions do not match"}return b(t)?t.map(function(n){return kn(n,e)}):b(e)?e.map(function(n){return kn(t,n)}):t}function An(t,e){if(v(t)&&v(e))return F(t,e);if(S(t)&&S(e)){if(B(t)===B(e)&&G(t)===G(e))return t.map(function(n,r){return n.map(function(n,t){return An(n,e[r][t])})});throw"sub: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return An(n,e[t])});throw"sub: vector dimensions do not match"}return b(t)?t.map(function(n){return An(n,e)}):b(e)?e.map(function(n){return An(t,n)}):t}function Tn(t,e){if(v(t)&&v(e))return Q(t,e);if(S(t)&&S(e)){if(B(t)===B(e)&&G(t)===G(e))return t.map(function(n,r){return n.map(function(n,t){return Tn(n,e[r][t])})});throw"dotmul: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return Tn(n,e[t])});throw"dotmul: vector dimensions do not match"}return b(t)?t.map(function(n){return Tn(n,e)}):b(e)?e.map(function(n){return Tn(t,n)}):t}function a(t,e){if(v(t)&&v(e))return U(t,e);if(S(t)&&S(e)){if(B(t)===B(e)&&G(t)===G(e))return t.map(function(n,r){return n.map(function(n,t){return a(n,e[r][t])})});throw"dotdiv: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return a(n,e[t])});throw"dotdiv: vector dimensions do not match"}return b(t)?t.map(function(n){return a(n,e)}):b(e)?e.map(function(n){return a(t,n)}):t}function _n(t,e){if(v(t)&&v(e))return wn(t,e);if(S(t)&&S(e)){if(B(t)===B(e)&&G(t)===G(e))return t.map(function(n,r){return n.map(function(n,t){return _n(n,e[r][t])})});throw"dotpow: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return _n(n,e[t])});throw"dotpow: vector dimensions do not match"}return b(t)?t.map(function(n){return _n(n,e)}):b(e)?e.map(function(n){return _n(t,n)}):t}function L(i,u){if(v(i)&&v(u))return Q(i,u);if(S(i)&&S(u)){if(G(i)===B(u))return n=B(i),t=G(u),o=B(u),k(n,t,function(n,t){for(var r=0,e=0;e<o;++e)r=$(r,Q(i[n][e],u[e][t]));return r});throw"mul: matrix-matrix dimensions do not match"}if(y(i)&&S(u)){if(i.length===B(u))return t=G(u),o=i.length,k(n=1,t,function(n,t){for(var r=0,e=0;e<o;++e)r=$(r,Q(i[e],u[e][t]));return r});throw"mul: vector-matrix dimensions do not match"}if(S(i)&&y(u)){var o;if(G(i)===u.length)return n=B(i),o=u.length,k(n,t=1,function(n,t){for(var r=0,e=0;e<o;++e)r=$(r,Q(i[n][e],u[e]));return r});throw"mul: matrix-vector dimensions do not match"}var n,t;return y(i)&&y(u)?k(n=i.length,t=u.length,function(n,t){return Q(i[n],u[t])}):b(i)?i.map(function(n){return L(n,u)}):b(u)?u.map(function(n){return L(i,n)}):i}function En(n,t){if(v(n)&&v(t))return wn(n,t);if(S(n)&&B(n)===G(n)&&w(t)){if(t<0&&(t=-t,!(n=lt(n))||!n.length))throw"pow: no inverse";if(0===t)return $n(B(n));if(1===t)return n;if(2===t)return L(n,n);for(var r=$n(B(n));0!==t;)1&t&&(r=L(r,n)),0<(t>>=1)&&(n=L(n,n));return r}return n}function In(n){return fn(function(n){return u(n)?n.re:n},n,!0)}function Pn(n){return fn(function(n){return u(n)?n.im:0},n,!0)}function Cn(n){return fn(D,n,!0)}function Ln(n){return fn(V,n,!0)}function jn(e,n=":",r=null){if(tn(e)){if(y(n)&&n.length===e.length&&rt(n,function(n){return 0===n||1===n}))return o=1===(o=n.reduce(function(n,t,r){return 1===t&&n.push(e[r]),n},[])).length?o[0]:o;if(":"===(n=v(n)?en(n,!0):n)||w(n)||y(n))return t=e.length,1===(o=(n=w(n=":"===n?Vn(1,t):n)?[n]:n).map(function(n){if(n<1&&(n+=t),n<1||t<n)throw"get: index out of bounds";return e[n-1]})).length?o[0]:o;throw"get: invalid range"}if(h(e)){var i=B(e),u=G(e),t=i*u;if(null==r&&S(n)&&B(n)===i&&G(n)===u&&rt(n,function(n){return 0===n||1===n})){for(var o=[],f=0;f<u;++f)for(var l=0;l<i;++l)1===n[l][f]&&o.push(e[l][f]);return o=1===o.length?o[0]:o}if(v(n)&&(n=en(n,!0)),v(r)&&(r=en(r,!0)),":"===n||w(n)||y(n)){if(w(n=":"===n?Vn(1,i):n)&&(n=[n]),null==r)return o=1===(o=n.map(function(n){if(n<1&&(n+=t),n<1||t<n)throw"get: index out of bounds";return e[(n-1)%i][M.floor((n-1)/i)]})).length?o[0]:o;if(":"===r||w(r)||y(r))return w(r=":"===r?Vn(1,u):r)&&(r=[r]),o=1===(o=n.map(function(t){if(t<1&&(t+=i),t<1||i<t)throw"get: index out of bounds";return r.map(function(n){if(n<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[t-1][n-1]})})).length&&1===o[0].length?o[0][0]:o}throw"get: invalid range"}return e}function Nn(i,n=":",u=null,o=null){if(tn(i)){if(y(n)&&n.length===i.length&&rt(n,function(n){return 0===n||1===n})){if(nn(o))return n.forEach(function(n,t){1===n&&(i[t]=o)}),i;if(b(o))return e=0,n.forEach(function(n,t){if(1===n){if(e>=o.length)throw"set: index out of bounds";i[t]=o[e++]}}),i}if(":"===(n=v(n)?en(n,!0):n)||w(n)||y(n)){var r=i.length;if(w(n=":"===n?Vn(1,r):n)&&(n=[n]),nn(o))return n.forEach(function(n){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[n-1]=o}),i;if(b(o)&&o.length>=n.length)return n.forEach(function(n,t){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[n-1]=o[t]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(h(i)){var f=B(i),l=G(i),r=f*l;if(S(n)&&B(n)===f&&G(n)===l&&rt(n,function(n){return 0===n||1===n})){if(nn(o))return n.forEach(function(n,r){n.forEach(function(n,t){1===n&&(i[r][t]=o)})}),i;if(b(o)){for(var e=0,t=0;t<l;++t)for(var a=0;a<f;++a)if(1===n[a][t]){if(e>=o.length)throw"set: index out of bounds";i[a][t]=o[e++]}return i}}if(v(n)&&(n=en(n,!0)),v(u)&&(u=en(u,!0)),":"===n||w(n)||y(n)){if(null==u){if(w(n=":"===n?Vn(1,r):n)&&(n=[n]),nn(o))return n.forEach(function(n){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[(n-1)%f][M.floor((n-1)/f)]=o}),i;if(tn(o)&&o.length>=n.length)return n.forEach(function(n,t){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[(n-1)%f][M.floor((n-1)/f)]=o[t]}),i}else if(":"===u||w(u)||y(u)){if(w(n=":"===n?Vn(1,f):n)&&(n=[n]),w(u=":"===u?Vn(1,l):u)&&(u=[u]),nn(o))return n.forEach(function(t){if(t<1&&(t+=f),t<1||f<t)throw"set: index out of bounds";u.forEach(function(n){if(n<1&&(n+=l),n<1||l<n)throw"set: index out of bounds";i[t-1][n-1]=o})}),i;if(h(o)&&o.length>=n.length&&o[0].length>=u.length)return n.forEach(function(r,e){if(r<1&&(r+=f),r<1||f<r)throw"set: index out of bounds";u.forEach(function(n,t){if(n<1&&(n+=l),n<1||l<n)throw"set: index out of bounds";i[r-1][n-1]=o[e][t]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function Rn(n,t,r){return"horz"===n&&h(t)&&h(r)&&B(t)===B(r)?t.map(function(n,t){return n.concat(r[t])}):"vert"===n&&h(t)&&h(r)&&G(t)===G(r)?t.concat(r):void s("cat")}function qn(r,n){var e,i;return nn(r)?r:tn(r)?r.slice().reverse():h(r)?(e=B(r),i=G(r),1===(n=null==n?1:n)?k(e,i,function(n,t){return r[e-1-n][t]}):2===n?k(e,i,function(n,t){return r[n][i-1-t]}):r):void s("flip")}function zn(n,t){return In(n)-In(t)||Pn(n)-Pn(t)}function On(n,t){return V(n)-V(t)||Sn(n)-Sn(t)}function Mn(t,r,e,i,n){var u;if(nn(t))return t;if(y(t))return null==i&&(i=rn(t)?zn:On),u=t.map(function(n,t){return{v:n,i:t}}).sort("descend"===e?function(n,t){return i(t.v,n.v)||n.i-t.i}:function(n,t){return i(n.v,t.v)||n.i-t.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(S(t)){if(1===r)return n?(u=Z(G(t),function(n){n=N(t,n);return Mn(n,r,e,null==i?rn(n)?zn:On:i,!0)}),[k(B(t),G(t),function(n,t){return u[t][0][n]}),k(B(t),G(t),function(n,t){return u[t][1][n]})]):(u=Z(G(t),function(n){n=N(t,n);return Mn(n,r,e,null==i?rn(n)?zn:On:i,!1)}),k(B(t),G(t),function(n,t){return u[t][n]}));if(2===r)return n?(u=Z(B(t),function(n){n=t[n];return Mn(n,r,e,null==i?rn(n)?zn:On:i,!0)}),[k(B(t),G(t),function(n,t){return u[n][0][t]}),k(B(t),G(t),function(n,t){return u[n][1][t]})]):(u=Z(B(t),function(n){n=t[n];return Mn(n,r,e,null==i?rn(n)?zn:On:i,!1)}),k(B(t),G(t),function(n,t){return u[n][t]}))}s("sort")}function Xn(t){var n=[].slice.call(arguments,1);return b(n[0])&&(n=n[0]),nn(t)?n.length?n.map(function(n){return[1,1][n-1]}):[1,1]:tn(t)?n.length?n.map(function(n){return[1,t.length][n-1]}):[1,t.length]:h(t)?n.length?n.map(function(n){return[B(t),G(t)][n-1]}):[B(t),G(t)]:[]}function Zn(n){return b(n)?M.max.apply(M,Xn(n)):null==n?0:1}function Wn(n,t){return y(n=null==n?1:n)&&(t=n[1],n=n[0]),k(n,t=null==t?n:t,0)}function $n(n){return k(n=en(n=null==n?1:n,!0),n,function(n,t){return n===t?1:0})}function Fn(r,i){return i=i||0,nn(r)?[[r]]:tn(r)?k(r.length,r.length,function(n,t){return i===n-t?r[n]:0}):h(r)?r.reduce(function(n,t,e){return t.reduce(function(n,t,r){return i===e-r&&n.push(t),n},n)},[]):void s("diag")}function Qn(t,e,i){if(i=!0===i,v(t)&&v(e))return Q(t,i?e:D(e));if(y(t)&&y(e)){if(t.length===e.length)return t.reduce(function(n,t,r){return $(n,Q(t,i?e[r]:D(e[r])))},0)}else if(S(t)&&S(e)&&B(t)===B(e)&&G(t)===G(e))return Z(G(t),function(n){return Qn(N(t,n),N(e,n),i)});return 0}function Un(r){return h(r)?k(G(r),B(r),function(n,t){return r[t][n]}):r}function Dn(r){return h(r)?k(G(r),B(r),function(n,t){return v(r[t][n])?D(r[t][n]):r[t][n]}):tn(r)?r.map(function(n){return v(n)?D(n):n}):v(r)?D(r):r}function Vn(n,t,r){if(1===arguments.length){if(h(n)){for(var e,i=B(n),u=G(n),o=new Array(u*i),f=0,l=0;l<u;++l)for(e=0;e<i;++e)o[f++]=n[e][l];return o}return n}if(null!=r&&null!=t||(null!=t?(r=t,t=1):(r=n,n=t=1)),n=en(n,!0),t=en(t,!0),r=en(r,!0),o=[],0<t)for(;n<=r;n+=t)o.push(n);else if(t<0)for(;r<=n;n+=t)o.push(n);return o}function j(t){return v(t)?t:y(t)?t.reduce($,0):S(t)?Z(G(t),function(n){return j(N(t,n))}):0}function Bn(t){return v(t)?t:y(t)?t.reduce(Q,1):S(t)?Z(G(t),function(n){return Bn(N(t,n))}):0}function Gn(t){return v(t)?t:y(t)?M.min.apply(null,t):S(t)?Z(G(t),function(n){return Gn(N(t,n))}):0}function Yn(t){return v(t)?t:y(t)?M.max.apply(null,t):S(t)?Z(G(t),function(n){return Yn(N(t,n))}):0}function Jn(n,t){if(K(t=null==t?2:t)){if(v(n))return V(n);if(y(n))return(t<0?Gn:Yn)(Ln(n));if(S(n)&&0<t)return Yn(j(Ln(Un(n))))}else if(X(t)){if(1===t){if(v(n))return V(n);if(y(n))return j(Ln(n));if(S(n))return Yn(j(Ln(n)))}else if(2===t){if(v(n))return V(n);if(y(n))return M.sqrt(j(n.map(function(n){return Q(n,D(n))})))}else if(0<t){if(v(n))return V(n);if(y(n))return M.pow(j(n.map(function(n){return wn(V(n),t)})),1/t)}}else if("fro"===t&&S(n))return M.sqrt(gt(L(Dn(n),n)));s("norm")}function Hn(t,n){if(v(t))return t;if(y(t))return t.length?U(j(t),t.length):o;if(S(t)){if(1===(n=null==n?1:n))return Z(G(t),function(n){return Hn(N(t,n))});if(2===n)return Z(B(t),function(n){return Hn(t[n])})}s("mean")}function Kn(t,n,r){if(n=n||0,v(t))return 0;if(y(t))return 0===t.length?o:1===t.length?0:M.sqrt(U(j(En(Ln(An(t,Hn(t))),2)),1===n?t.length:t.length-1));if(S(t)){if(1===(r=null==r?1:r))return Z(G(t),function(n){return Kn(N(t,n))});if(2===r)return Z(B(t),function(n){return Kn(t[n])})}s("std")}function nt(t,r,e,i){var u;if(v(t))return t;if(y(t)){if("reverse"===(e=null==e?"forward":e))return t.slice().reverse().map(function(n,t){return u=0===t?n:r(u,n),acc}).reverse();if("forward"===e)return t.map(function(n,t){return u=0===t?n:r(u,n)})}else if(S(t)){if(1===(i=null==i?1:i))return Z(G(t),function(n){return nt(N(t,n),r,e,i)});if(2===i)return Z(B(t),function(n){return nt(t[n],r,e,i)})}return!1}function tt(t,r,e,i,u){var o;if(y(t))return Z(o=t.length,function(n){return r(t.slice(M.max(0,n-e),M.min(o-1,n+i)+1))});if(S(t)){if(1===(u=null==u?1:u))return Z(G(t),function(n){return tt(N(t,n),r,e,i,u)});if(2===u)return Z(B(t),function(n){return tt(t[n],r,e,i,u)})}return!1}function rt(n,t){if(v(n))return t(n,1,1)?1:0;if(y(n)){for(var r=0,e=n.length;r<e;++r)if(!t(n[r],r+1,1))return 0;return 1}if(S(n)){for(var r=0,i=B(n),u=G(n);r<i;++r)for(var o=0;o<u;++o)if(!t(n[r][o],r+1,o+1))return 0;return 1}return 0}function B(n){return n.length}function G(n){return n[0].length}function N(t,r){return Z(t.length,function(n){return t[n][r]})}function et(n,t,r){var e;t!==r&&(e=n[t],n[t]=n[r],n[r]=e)}function it(n,t,r,e,i,u){var o,f=n[0].length;for(null==e&&(e=1),null==i&&(i=1),o=u||0;o<f;++o)n[t][o]=$(Q(i,n[t][o]),Q(e,n[r][o]))}function ut(r,e,i,n,t){var u=B(r),o=G(r);return u&&o?b(e)&&b(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<o}),k(e.length,i.length,function(n,t){return r[e[n]][i[t]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=o),(n=null==n?u-1:n)<0&&(n+=u),(t=null==t?o-1:t)<0&&(t+=o),e=M.max(0,M.min(u-1,e)),n=M.max(0,M.min(u-1,n)),i=M.max(0,M.min(o-1,i)),t=M.max(0,M.min(o-1,t)),e<=n&&i<=t?k(n-e+1,t-i+1,function(n,t){return r[e+n][i+t]}):[]):[]}function ot(r,e,n){var i=B(r),u=G(r),o=B(e),f=G(e);return"vert"===(n=n||"horz")?k(i+o,M.max(u,f),function(n,t){return u<=t?n<i?0:e[n-i][t]:f<=t?n<i?r[n][t]:0:(n<i?r[n]:e[n-i])[t]}):k(M.max(i,o),u+f,function(n,t){return i<=n?t<u?0:e[n][t-u]:o<=n?t<u?r[n][t]:0:t<u?r[n][t]:e[n][t-u]})}function ft(n,t){return X(t)&&0<t?v(n)?yn(V(n),t)?0:n:b(n)?n.map(function(n){return ft(n,t)}):n:n}function lt(n){var t,r,e;return v(n)?bn(n):S(n)&&B(n)===G(n)?1===(r=t=B(n))?[[bn(n[0][0])]]:P((e=st(n,!0))[0][t-1][r-1],0)?[]:e[3].map(function(n,t){return n.map(function(n){return U(n,e[0][t][t])})}):[]}function at(r){var n,e,t,i,u,o;return v(r)?bn(r):S(r)?(n=B(r),t=G(r),ln(r,0)?Un(r):1===n&&1===t?[[bn(r[0][0])]]:1===n||1===t?(u=r.reduce(function(n,t){return $(n,Q(t,D(t)))},0),k(t,n,function(n,t){return U(D(r[t][n]),u)})):(o=(e=st(r,!0))[1].length)===t?n===t?e[3].map(function(n,t){return n.map(function(n){return U(n,e[0][t][t])})}):L(lt(L(i=Dn(r),r)),i):o===n?L(i=Dn(r),lt(L(r,i))):(t=function(n,e){var t,r,i=B(n),u=G(n);e=e||st(n,!0);return t=e[1],r=t.length,n=ut(n,Z(i,function(n){return n}),Z(r,function(n){return t[n][1]})),i=ut(e[0],0,0,r-1,u-1).map(function(n,r){return n.map(function(n,t){for(t=r;t+1<u&&P(e[0][r][t],0);)++t;return U(n,e[0][r][t])})}),[n,i]}(r,e),u=L(lt(L(i=Dn(u=t[0]),u)),i),o=L(i=Dn(o=t[1]),lt(L(o,i))),L(o,u))):[]}function ct(n,t,r){var e,i,u,o,f,l,a,c,s,h,p,m,g,d,v=B(n),y=G(n),w=y,x=0;for(b(r)&&(w=M.min(w,r[1])),g=ot(n,$n(v)),e=new Array(w),i=1,d=function(n,t){t=t||0;for(var r=x-1;0<=r;--r)if(n===e[r][t])return r;return-1},u=a=0;u<v&&!(w<=a);++u){for(o=u;P(V(g[o][a]),0);)if(v<=++o&&(o=u,w<=++a)){a=-1;break}if(-1===a)break;for(c=-1,h=null,m=0,o=f=o;o<v;++o)P(p=V(g[o][a]),0)?++m:null!=h&&!C(p,h)||(h=p,c=o);for(;;){if(-1===c)break;if(v-f===m+1){for(u!==c&&(et(g,u,c),i=xn(i)),C(g[u][a],0)&&(it(g,u,u,0,-1,a),i=xn(i)),o=c,f=u;0<=o&&-1!==(l=d(o));)o=f-=x-l;e[x++]=[o,a],i=u<w?Q(i,g[u][u]):0;break}for(m=0,s=c,o=f;o<v;++o)o!==s&&(it(g,o,s,xn(U(g[o][a],g[s][a])),1,a),P(p=V(g[o][a]),0)?++m:C(p,h)&&(h=p,c=o))}++a}return x<w&&(i=0),r=ut(g,0,y,v-1,v+y-1),g=ut(g,0,0,v-1,y-1),e.length>x&&(e.length=x),t?[g,e,i,r]:g}function st(n,t,r){var e,i,u,o,f,l,a=B(n),c=G(n),s=c;for(b(r)&&M.min(s,r[1]),l=ot((s=ct(n,!0,r))[0],s[3]),e=s[1],n=s[2],i=e.length,o=0;o<i;++o)for(u=e[o][1],f=0;f<o;++f)P(l[f][u],0)||(it(l,f,o,xn(l[f][u]),l[o][u]),P(l[f][e[f][1]],1))||it(l,f,f,0,bn(l[f][e[f][1]]),e[f][1]);return P(l[i-1][e[i-1][1]],1)||it(l,i-1,i-1,0,bn(l[i-1][e[i-1][1]]),e[i-1][1]),r=ut(l,0,c,a-1,a+c-1),l=ut(l,0,0,a-1,c-1),t?[l,e,n,r]:l}function ht(o){return k(G(o),B(o),function(n,t){return e=t,i=n,t=!0,n=B(r=o),u=G(r),n!==u?null:n<=1?0:(i=+(i||0),(e=+(e||0))<0||n<=e||i<0||u<=i?null:(n=mt(k(n-1,u-1,function(n,t){return e<=n&&++n,i<=t&&++t,r[n][t]})),!0===t&&e+i&1?xn(n):n));var r,e,i,u})}function pt(n,t,r){var e,i,u,o=B(n),f=G(n);if(!1===r||o===f){for(e=M.min(o,f),i=0;i<e;++i){if("lower"===t||"diagonal"===t)for(u=i+1;u<e;++u)if(!P(n[i][u],0))return;if("upper"===t||"diagonal"===t)for(u=0;u<i;++u)if(!P(n[i][u],0))return}if(f<o){for(i=e;i<o;++i)for(u=0;u<f;++u)if(!P(n[i][u],0))return}else if(o<f)for(u=e;u<f;++u)for(i=0;i<o;++i)if(!P(n[i][u],0))return;return 1}}function mt(e,n){S(e=v(e)?[[e]]:e)||s("det");var t=B(e);return t!==G(e)?0:1===t?e[0][0]:pt(e,"lower")||pt(e,"upper")?e.reduce(function(n,t,r){return Q(n,e[r][r])},1):!0===n?function n(t,r){var e,i,u,o,f,l,a,c,s,h,p,m,g,d;function v(r,n,e,i){return k(n-1,n-1,function(n,t){return e<=n&&++n,i<=t&&++t,r[n][t]})}if(1===r)f=t[0][0];else if(2===r)l=t[0][0],a=t[0][1],c=t[1][0],f=F(Q(l,s=t[1][1]),Q(a,c));else if(3===r)l=t[0][0],a=t[0][1],c=t[0][2],s=t[1][0],h=t[1][1],p=t[1][2],m=t[2][0],g=t[2][1],d=t[2][2],f=F(F(F($($(Q(Q(l,h),d),Q(Q(a,p),m)),Q(Q(c,s),g)),Q(Q(c,h),m)),Q(Q(a,s),d)),Q(Q(l,p),g));else{for(e=u=i=0;e<r;++e)P(t[0][e],0)&&++i,P(t[e][0],0)&&++u;if(o=1,f=0,i<u)for(e=0;e<r;++e)P(t[e][0],0)||(f=$(f,Q(t[e][0],Q(o,n(v(t,r,e,0),r-1))))),o=1===o?-1:1;else for(e=0;e<r;++e)P(t[0][e],0)||(f=$(f,Q(t[0][e],Q(o,n(v(t,r,0,e),r-1))))),o=1===o?-1:1}return f}(e,t):ct(e,!0)[2]}function gt(e){return v(e)?e:S(e)?e.reduce(function(n,t,r){return $(n,r<t.length?e[r][r]:0)},0):void s("trace")}function dt(n){S(n)&&B(n)===G(n)||s("charpoly");var e,t=B(n),i=(G(n),t),u=new Array(i+1),r=Wn(i,i);for(u[i]=1,e=1;e<=i;++e)r=L(n,r).map(function(n,r){return n.map(function(n,t){return r===t?$(n,u[i-e+1]):n})}),u[i-e]=U(gt(L(n,r)),-e);return u.reverse()}function vt(n){var t,r,e,i,u=B(n),o=new Array(u),f=new Array(u),l=Z(u,0);for(n=on(n),i=0;i<u;++i)t=(e=function(n,t){var r,e,i,u,o=Dn(n),f=0,l=Z(t,function(){return new I(M.random()||.1,0)});for(l=a(l,Jn(l)),u=a(u=Z(t,function(){return new I(M.random()||.1,0)}),Jn(u)),r=1;r<=100&&(e=f,l=un(L(n,i=l)),u=un(L(o,u)),f=Qn(l,i),l=a(l,l[0].sign()),u=a(u,u[0].sign()),l=a(l,Jn(l)),u=a(u,Jn(u)),!(M.abs(In(f)-In(e))<1e-10&&M.abs(Pn(f)-Pn(e))<1e-10));++r);return[f,l,u]}(n,u))[0],r=e[1],e=e[2],n=An(n,L(L(U(l[i]=t,Qn(o[i]=r,f[i]=e,!0)),r),e));return[W(Un(o)),W(l),W(Un(f))]}function yt(n,t,r,e){X(t)||(t=Y);var i,u=G(n),o=B(n);if(o<u)return i=yt(Un(n),t,e,r),r&&e?[Un(i[2]),i[1],Un(i[0])]:r||e?[Un(i[0]),i[1]]:i;var f,l,a,c,s,h,p,m,g,d,v,y,w,x,b,S,k,A,T,z,_,E=r?o:0,I=e?u:0,P=on(n),C=E?Wn(o,E):null,L=Z(u,0),j=I?Wn(u,I):null,O=J/t,N=new Array(u),R=new Array(u),q=new Array(u);for(R[0]=0,x=1;x<=u;++x){for(k=x+1,a=0,y=x;y<=o;++y)a+=M.pow(In(P[y-1][x-1]),2)+M.pow(Pn(P[y-1][x-1]),2);if(N[x-1]=0,O<a&&(a=M.sqrt(a),N[x-1]=a,s=0===(c=V(P[x-1][x-1]))?1:U(P[x-1][x-1],c),P[x-1][x-1]=Q(s,a+c),x!==u+0)){for(w=k;w<=u+0;++w){for(s=0,y=x;y<=o;++y)s=$(s,Q(D(P[y-1][x-1]),P[y-1][w-1]));for(s=U(s,a*(a+c)),y=x;y<=o;++y)P[y-1][w-1]=F(P[y-1][w-1],Q(s,P[y-1][x-1]))}for(s=xn(an(D(P[x-1][x-1]))),w=k;w<=u+0;++w)P[x-1][w-1]=Q(s,P[x-1][w-1])}if(x===u)break;for(a=0,w=k;w<=u;++w)a+=M.pow(In(P[x-1][w-1]),2)+M.pow(Pn(P[x-1][w-1]),2);if(R[k-1]=0,O<a){for(a=M.sqrt(a),R[k-1]=a,s=0===(c=V(P[x-1][k-1]))?1:U(P[x-1][k-1],c),P[x-1][k-1]=Q(s,a+c),y=k;y<=o;++y){for(s=0,w=k;w<=u;++w)s=$(s,Q(D(P[x-1][w-1]),P[y-1][w-1]));for(s=U(s,a*(a+c)),w=k;w<=u;++w)P[y-1][w-1]=F(P[y-1][w-1],Q(s,P[x-1][w-1]))}for(s=xn(an(D(P[x-1][k-1]))),y=k;y<=o;++y)P[y-1][k-1]=Q(P[y-1][k-1],s)}}for(h=0,x=1;x<=u;++x)L[x-1]=N[x-1],q[x-1]=R[x-1],h=M.max(h,L[x-1]+q[x-1]);if(h*=t,0<E)for(w=1;w<=E;++w)C[w-1][w-1]=1;if(0<I)for(w=1;w<=I;++w)j[w-1][w-1]=1;for(S=1;S<=u;++S){for(x=u+1-S,z=1;z<=50;++z){for(_=!0,T=1;T<=x;++T){if(M.abs(q[(b=x+1-T)-1])<=h){_=!1;break}if(M.abs(L[b-1-1])<=h){_=!0;break}}if(_)for(v=0,A=b-(d=1),y=b;y<=x&&(m=d*q[y-1],q[y-1]=v*q[y-1],!(M.abs(m)<=h));++x)if(c=gn(m,g=L[y-1]),v=g/(L[y-1]=c),d=-m/c,0<E)for(w=1;w<=u;++w)f=In(C[w-1][A-1]),l=In(C[w-1][y-1]),C[w-1][A-1]=f*v+l*d,C[w-1][y-1]=l*v-f*d;if(c=L[x-1],b===x)break;for(f=L[b-1],p=gn(m=(((l=L[x-1-1])-c)*(l+c)+((p=q[x-1-1])-(g=q[x-1]))*(p+g))/(2*g*l),1),m=((f-c)*(f+c)+(l/(m+(p=m<0?-p:p))-g)*g)/f,y=A=b+(d=v=1);A<=x;++A){if(p=q[y-1],l=L[y-1],g=d*p,p*=v,c=gn(g,m),m=f*(v=m/(q[y-1-1]=c))+p*(d=g/c),p=p*v-f*d,g=l*d,l*=v,0<I)for(w=1;w<=u;++w)f=In(j[w-1][y-1-1]),c=In(j[w-1][y-1]),j[w-1][y-1-1]=f*v+c*d,j[w-1][y-1]=c*v-f*d;if(c=gn(g,m),m=(v=m/(L[y-1-1]=c))*p+(d=g/c)*l,f=v*l-d*p,0<E)for(w=1;w<=u;++w)l=In(C[w-1][y-1-1]),c=In(C[w-1][y-1]),C[w-1][y-1-1]=l*v+c*d,C[w-1][y-1]=c*v-l*d}q[b-1]=0,q[x-1]=m,L[x-1]=f}if(c<0&&(L[x-1]=-c,0<I))for(w=1;w<=u;++w)j[w-1][x-1]=xn(j[w-1][x-1])}for(x=1;x<=u;++x){for(p=-1,y=w=x;y<=u;++y)p<L[y-1]&&(p=L[y-1],w=y);if(w!==x){if(L[w-1]=L[x-1],L[x-1]=p,0<I)for(y=1;y<=u;++y)s=j[y-1][w-1],j[y-1][w-1]=j[y-1][x-1],j[y-1][x-1]=s;if(0<E)for(y=1;y<=u;++y)s=C[y-1][w-1],C[y-1][w-1]=C[y-1][x-1],C[y-1][x-1]=s}}if(0<E)for(S=1;S<=u;++S)if(0!==N[(x=u+1-S)-1]){for(s=xn(an(P[x-1][x-1])),w=1;w<=E;++w)C[x-1][w-1]=Q(s,C[x-1][w-1]);for(w=1;w<=E;++w){for(s=0,y=x;y<=o;++y)s=$(s,Q(D(P[y-1][x-1]),C[y-1][w-1]));for(s=U(s,Q(V(P[x-1][x-1]),N[x-1])),y=x;y<=o;++y)C[y-1][w-1]=F(C[y-1][w-1],Q(s,P[y-1][x-1]))}}if(0<I&&2<=u)for(S=2;S<=u;++S)if(0!==R[(k=(x=u+1-S)+1)-1]){for(s=xn(an(D(P[x-1][k-1]))),w=1;w<=I;++w)j[k-1][w-1]=Q(s,j[k-1][w-1]);for(w=1;w<=I;++w){for(s=0,y=k;y<=u;++y)s=$(s,Q(P[x-1][y-1],j[y-1][w-1]));for(s=U(s,Q(V(P[x-1][k-1]),R[k-1])),y=k;y<=u;++y)j[y-1][w-1]=F(j[y-1][w-1],Q(s,D(P[x-1][y-1])))}}return r&&e?[W(C),L,W(j)]:r||e?[W(C||j),L]:L}function wt(n,t){for(var r,e,i,u,o,f,l=B(n),a=G(n),c=!1,s=on(n),h=$n(l),p=Z(l,0),m=$n(l),g=1,d=0;d<l-1;++d){if(P(s[d][d],0)){for(i=d+1,u=!0;i<l&&u;)P(s[i][d],0)?++i:u=!1;if(l<=i){c=!0;break}et(s,d,i),et(m,d,i)}for(o=s[d][d],h[d][d]=o,p[d]=Q(g,o),r=d+1;r<l;++r){for(f=s[r][d],h[r][d]=f,e=d+1;e<a;++e)s[r][e]=U(F(Q(o,s[r][e]),Q(s[d][e],f)),g);s[r][d]=0}g=s[d][d]}if(c)throw"lu: defficient matrix";return p[l-1]=g,t?[L(h,Fn(p.map(bn))),s,m]:[p,h,s,m]}function xt(n,r,e,t,i){t=t,o=P(i=i,0)?(u=1,0):P(t,0)?(u=0,an(D(i))||1):(o=an(t)||1,u=U(t=V(t),t=gn(t,V(i))),U(Q(o,D(i)),t));var u,o,i=[u,o],f=i[0],l=i[1];return k(n,n,function(n,t){return n===t?r===n||e===t?f:1:r===n&&e===t||r===t&&e===n?n<t?xn(l):l:0})}function bt(n,t,r,e,i){var u,o=B(t),f=on(i);if("right"===n)for(u=0;u<o;++u)f[u][r]=$(Q(t[r][r],i[u][r]),Q(t[e][r],i[u][e])),f[u][e]=$(Q(t[r][e],i[u][r]),Q(t[e][e],i[u][e]));else for(u=0;u<o;++u)f[r][u]=$(Q(t[r][r],i[r][u]),Q(t[r][e],i[e][u])),f[e][u]=$(Q(t[e][r],i[r][u]),Q(t[e][e],i[e][u]));return f}function St(n,t){for(var r,e,i=B(n),u=G(n),o=t?$n(i):null,f=n,l=0;l<u;++l)for(r=i-1;l+1<=r;--r)f=bt("left",Dn(e=xt(i,r-1,r,f[r-1][l],f[r][l])),r-1,r,f),t&&(o=bt("right",e,r-1,r,o));return t?[o,f]:f}function kt(n,t,r){var e=B(n);if(null==t){var i,u=r?$n(e):null,o=n;for(f=1;f<=e-2;++f)for(l=e;f+2<=l;--l)i=xt(e,l-1-1,l-1,o[l-1-1][f-1],o[l-1][f-1]),r&&(u=bt("right",i,l-1-1,l-1,u)),o=bt("left",Dn(i),l-1-1,l-1,bt("right",i,l-1-1,l-1,o));return r?[u,o]:o}var f,l,a,c,s=Dn(u=St(t,!0)[0]),h=$n(e),p=L(s,n),m=L(s,t);for(f=1;f<=e-2;++f)for(l=e;f+2<=l;--l)a=Dn(c=xt(e,l-1-1,l-1,p[l-1-1][f-1],p[l-1][f-1])),u=bt("right",c,l-1-1,l-1,u),p=bt("left",a,l-1-1,l-1,p),m=bt("left",a,l-1-1,l-1,m),h=bt("right",c=xt(e,l-1-1,l-1,xn(m[l-1][l-1]),m[l-1][l-1-1]),l-1-1,l-1,h),p=bt("right",c,l-1-1,l-1,p),m=bt("right",c,l-1-1,l-1,m);return[p,m,u,h]}function At(n,t,r){if(v(n)&&v(t))return U(t,n);if(!S(n))return[];if(!y(t)&&!S(t))return[];var e,i=G(n);if(B(n)!==i)return[];if(e=y(t)?(h=t.length,1):(h=B(t),G(t)),i!==h)return[];var u,o,f,l,a,c,s,h=ct(Un(n),!0);if(h[1].length!==i)return[];if(u=Un(h[3]),o=Un(h[0]),y(t)){for(f=Z(i,0),l=0;l<i;++l){if(P(o[l][l],0))return[];for(a=s=0;a<l;++a)s=$(s,Q(o[l][a],f[a]));f[l]=U(F(t[l],s),o[l][l])}return Z(i,function(t){return Z(i,function(n){return Q(f[n],u[t][n])}).reduce($,0)})}for(f=Wn(i,e),l=0;l<i;++l){if(P(o[l][l],0))return[];for(c=0;c<e;++c){for(a=s=0;a<l;++a)s=$(s,Q(o[l][a],f[a][c]));f[l][c]=U(F(t[l][c],s),o[l][l])}}return k(i,e,function(t,r){return Z(i,function(n){return Q(f[n][r],u[t][n])}).reduce($,0)})}function Tt(n,t){if(!n.length)return 0;t=t||0;for(var r=n.length,e=0,i=n[0];e+1<r;)++e,i=$(Q(i,t),n[e]);return i}function _t(t){if(t.length<=1)return[];for(var n,r,e,i,u,o,f,l,a,c=t.length-1,s=1e-10,h=new I(s,0),p=new I(0,0),m=new I(1,0),g=function(n){return Tt(t,n)},d=function(n){return U(F(g($(n,h)),g(n)),h)},v=t.map(function(n){return I(n).abs()}),y=v.length-1;0<y&&!v[y];)--y;for(r=(M.max.apply(null,v.slice(0,y))||0)/(v[y]||1)+1,n=v[0]/(v[0]+M.max.apply(null,v.slice(1))||1),e=Z(c,function(){return new I(n+(r-n)*M.random(),M.random()*q/2,"polar")}),f=0;;){for(y=i=0;y<c;++y){if(u=e[y],l=g(u),0===(a=d(u)).re&&0===a.im){if(l.re<=s&&l.im<=s){++i;continue}o=new I(r,0)}else o=l.div(a);(l=o.div(m.sub(o.mul(e.reduce(function(n,t,r){return n=r===y||u.re===t.re&&u.im===t.im?n:n.add(u.sub(t).inv())},p))))).re<=s&&l.im<=s&&++i,e[y]=u.sub(l)}if(i===c)break;if(1e3<++f)break}return e}function Et(n,t){for(var r=n.length-1,e=t.length-1,i=[];0<=r&&0<=e;)i.unshift($(n[r--],t[e--]));for(;0<=r;)i.unshift(n[r--]);for(;0<=e;)i.unshift(t[e--]);return i}function It(n,t){var r,e,i,u,o,f=n.length,l=t.length,a=f+l-1;if(!f||!l)return[];for(o=new Array(a),f<l&&(u=n,f=(n=t).length,l=(t=u).length),r=0;r<a;++r)for(e=o[r]=0;e<l;++e)0<=(i=r-e)&&i<f&&(o[r]=$(o[r],Q(n[i],t[e])));return o}T.complex=I,["sign","sqrt","exp","log","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(t){T[t]=sn[t]?function(n){return fn(function(n){return(u(n)?sn:M)[t](n)},n,!0)}:function(n){return fn(M[t],n,!1)}}),A.MAXPRINTSIZE=l,A.tex=function(n){return b(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(pn).join("\\]\n\\[")+"\\]":b(n[0])?b(n[0][0])||!b(n[1])||n[0].length!==n[1].length?"\\["+n.map(pn).join("\\]\n\\[")+"\\]":"\\["+pn(n)+"\\]":"\\["+(n=n.length>A.MAXPRINTSIZE?n.slice(0,M.round(A.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-M.round(A.MAXPRINTSIZE/2))):n).map(pn).join("\\]\n\\[")+"\\]":"":(n=pn(n)).length&&(n="\\["+n+"\\]"),n},T.times=Tn,T.real=In,T.imag=Pn,T.conj=Cn,T.abs=Ln,T.angle=function(n){return fn(Sn,n,!0)},T.ceil=function(n){return fn(function(n){return u(n)?new I(M.ceil(n.re),M.ceil(n.im)):M.ceil(n)},n,!0)},T.floor=function(n){return fn(function(n){return u(n)?new I(M.floor(n.re),M.floor(n.im)):M.floor(n)},n,!0)},T.round=function(n){return fn(function(n){return u(n)?new I(M.round(n.re),M.round(n.im)):M.round(n)},n,!0)},T.mod=function(n,r){return P(r=en(r||0),0)?n:fn(function(n){var t;return w(n)?((t=n%r)<0&&0<r&&(t+=r),t):n},n,!0)},T.bitshift=function(n,t){return fn(function(n){return w(n)?t<0?n>>-t:n<<t:n},n,!0)},T.bitand=function r(t,e){if(w(t)){if(w(e))return t&e;if(b(e))return e.map(function(n){return r(t,n)})}else if(b(t)){if(w(e))return t.map(function(n){return r(n,e)});if(b(e)&&t.length===e.length)return t.map(function(n,t){return r(n,e[t])})}return 0},T.bitor=function r(t,e){if(w(t)){if(w(e))return t|e;if(b(e))return e.map(function(n){return r(t,n)})}else if(b(t)){if(w(e))return t.map(function(n){return r(n,e)});if(b(e)&&t.length===e.length)return t.map(function(n,t){return r(n,e[t])})}return 0},T.bitxor=function r(t,e){if(w(t)){if(w(e))return t^e;if(b(e))return e.map(function(n){return r(t,n)})}else if(b(t)){if(w(e))return t.map(function(n){return r(n,e)});if(b(e)&&t.length===e.length)return t.map(function(n,t){return r(n,e[t])})}return 0},T.bin2dec=function n(t){return b(t)?t.map(n):E(t)?parseInt(t,2):t},T.dec2bin=function n(t){return b(t)?t.map(n):X(t)?t.toString(2):t},T.hex2dec=function n(t){return b(t)?t.map(n):E(t)?parseInt(t,16):t},T.dec2hex=function n(t){return b(t)?t.map(n):X(t)?t.toString(16):t},T.tolower=function n(t){return b(t)?t.map(n):E(t)?t.toLowerCase():t},T.toupper=function n(t){return b(t)?t.map(n):E(t)?t.toUpperCase():t},A.get=jn,A.set=Nn,T.sub2ind=function(n,t,r){return y(t)&&(r=t[1],t=t[0]),1===n.length?t:t-1+n[0]*(r-1)+1},T.ind2sub=function(n,t){return 1===n.length?[t,1]:[(t-1)%n[0]+1,M.floor((t-1)/n[0])+1]},T.cat=function(n,t,r){var e,i=[];if(1===n)for(i=t,e=2;e<arguments.length;++e)i=Rn("vert",i,arguments[e]);else if(2===n)for(i=t,e=2;e<arguments.length;++e)i=Rn("horz",i,arguments[e]);return i},T.horzcat=function(n,t){for(var r=n,e=1;e<arguments.length;++e)r=Rn("horz",r,arguments[e]);return r},T.vertcat=function(n,t){for(var r=n,e=1;e<arguments.length;++e)r=Rn("vert",r,arguments[e]);return r},T.flip=qn,T.fliplr=function(n){return qn(n,2)},T.flipud=function(n){return qn(n,1)},T.reshape=function(r,e,n){y(e)&&(n=e[1],e=e[0]);var i,t=e*n;return nn(r)&&1===e&&1===n?[[r]]:tn(r)&&r.length===t?k(e,n,function(n,t){return r[n+e*t]}):h(r)&&B(r)*G(r)==t?(i=B(r),k(e,n,function(n,t){n+=e*t;return r[n%i][M.floor(n/i)]})):r},T.squeeze=function(n){return n},T.repmat=function(r,e,i){return y(e)&&(i=e[1],e=e[0]),null==i&&(i=e),h(r=tn(r=nn(r)?[[r]]:r)?[r]:r)?k(e*B(r),i*G(r),function(n,t){return r[n%e][t%i]}):r},T.repelem=function(t,r){var e,i;if(y(t))if(y(r)){if(r.length===t.length)return e=0,i=-1,Z(j(r),function(n){return n===e&&(e+=r[++i]),t[i]})}else if(w(r))return i=-1,Z(r*t.length,function(n){return 0==n%r&&++i,t[i]});return t},T.sort=Ut(function(n,t,r,e){for(var i=2,u=null;i<arguments.length;){if("ComparisonMethod"===arguments[i]){"real"===arguments[i+1]?u=zn:"abs"===arguments[i+1]&&(u=On),1===i?(r=1,e="ascend"):2===i&&(e="ascend");break}i+=1}return Mn(t,r=null==r?1:r,e=null==e?"ascend":e,u,1<n)}),T.size=Xn,T.length=Zn,T.numel=function(n){return Bn(Xn(n))},T.ndims=function(n){return Zn(Xn(n))},T.rows=function(n){return Xn(n,1)},T.columns=function(n){return Xn(n,2)},T.zeros=Wn,T.ones=function(n,t){return y(n=null==n?1:n)&&(t=n[1],n=n[0]),k(n,t=null==t?n:t,1)},T.meshgrid=function(r,e){if(1===arguments.length&&(e=r),y(r)&&y(e))return[k(e.length,r.length,function(n,t){return r[t]}),k(e.length,r.length,function(n,t){return e[n]})];throw"meshgrid: invalid inputs"},T.eye=$n,T.diag=Fn,T.blkdiag=function(){return r=[].slice.call(arguments),c=a=l=f=o=0,r.forEach(function(n,t){nn(n)&&(r[t]=n=[[n]]),tn(n)&&(r[t]=n=Fn(n)),h(n)||s("blkdiag"),o+=B(n),f+=G(n)}),e=r[l],i=B(e),u=G(e),k(o,f,function(n,t){return a+i<=n&&(a+=i,c+=u,e=r[++l],i=B(e),u=G(e)),t<c||c+u<=t?0:e[n-a][t-c]});var r,e,i,u,o,f,l,a,c},T.dot=Qn,T.cross=function(n,t){if(n=un(n),t=un(t),!y(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(y(t)&&3===t.length)return[F(Q(n[1],t[2]),Q(n[2],t[1])),F(Q(n[2],t[0]),Q(n[0],t[2])),F(Q(n[0],t[1]),Q(n[1],t[0]))];throw"cross: input 2 not vector of length 3"},T.kron=function(r,e){var n,t,i,u;if(S(r)){if(S(e))return n=B(r),t=G(r),i=B(e),u=G(e),k(n*i,t*u,function(n,t){return L(r[M.floor(n/i)][M.floor(t/u)],e[n%i][t%u])});if(y(e))return n=B(r),t=G(r),i=1,u=e.length,k(n*i,t*u,function(n,t){return L(r[n][M.floor(t/u)],e[t%u])})}else if(y(r)){if(y(e))return k(r.length,e.length,function(n,t){return L(r[n],e[t])});if(S(e))return n=r.length,i=B(e),u=G(e),k(n*i,(t=1)*u,function(n,t){return L(r[M.floor(n/i)],e[n%i][t%u])})}return L(r,e)},T.transpose=Un,T.ctranspose=Dn,T.rand=function(n,t){return null==n?M.random():(y(n)&&(t=n[1],n=n[0]),k(n,t=null==t?n:t,function(){return M.random()}))},T.randi=function(n,t,r){return null==t&&null==r?M.ceil(M.random()*n):(y(t)&&(r=t[1],t=t[0]),k(t,r=null==r?t:r,function(){return M.ceil(M.random()*n)}))},T.randn=function(n,t){return null==n?dn():(y(n)&&(t=n[1],n=n[0]),k(n,t=null==t?n:t,dn))},T.linspace=function(n,t,r=100){for(var e=(t-n)/(r-1),i=new Array(r),u=0,o=n;u<r;++u,o+=e)i[u]=o;return i},T.logspace=function(n,t,r=100){for(var e=M.pow(t/n,1/(r-1)),i=new Array(r),u=0,o=n;u<r;++u,o*=e)i[u]=o;return i},T.colon=Vn,T.sum=j,T.prod=Bn,T.min=Gn,T.max=Yn,T.norm=Jn,T.mean=Hn,T.median=function t(r,n){if(v(r))return r;if(y(r))return r.length?1&(r=Mn(r)).length?r[r.length>>1]:U($(r[r.length>>1],r[(r.length>>1)-1]),2):o;if(S(r)){if(1===(n=null==n?1:n))return Z(G(r),function(n){return t(N(r,n))});if(2===n)return Z(B(r),function(n){return t(r[n])})}s("median")},T.mode=function t(r,n){if(v(r))return r;var e,i;if(y(r))return r.length?(e={},i=0,r.reduce(function(n,t){var r=t.toString(),r=z.call(e,r)?(e[r]+=1,e[r]):e[r]=1;return i<r?(i=r,n=t):r===i&&C(t,n)&&(n=t),n},{})):o;if(S(r)){if(1===(n=null==n?1:n))return Z(G(r),function(n){return t(N(r,n))});if(2===n)return Z(B(r),function(n){return t(r[n])})}s("mode")},T.std=Kn,T.var=function t(r,e,n){if(e=e||0,v(r))return 0;var i,u;if(y(r))return r.length<=1?r.length?0:o:(i=r.length,u=Hn(r),U(j(Tn(Cn(u=An(r,u)),u)),1===e?i:i-1));if(S(r)){if(1===(n=null==n?1:n))return Z(G(r),function(n){return t(N(r,n),e)});if(2===n)return Z(B(r),function(n){return t(r[n],e)})}s("var")},T.moment=function t(r,e,n){if(v(r))return 0;var i;if(y(r))return r.length<=1?r.length?0:o:(i=r.length,U(j(_n(An(r,Hn(r)),e)),i));if(S(r)){if(1===(n=null==n?1:n))return Z(G(r),function(n){return t(N(r,n),e)});if(2===n)return Z(B(r),function(n){return t(r[n],e)})}s("moment")},T.cov=function e(i,n,u){if(u=u||0,2!==arguments.length||0!==n&&1!==n||(u=n,n=null),null==n){if(v(i))return 0;var t;if(y(i))return i.length<=1?i.length?0:o:(r=i.length,t=Hn(i),U(j(Tn(Cn(t=An(i,t)),t)),1===u?r:r-1));if(S(i))return k(G(i),G(i),function(n,t,r){return n===t?e(N(i,n),u):t<n?r[t][n]:e(N(i,n),N(i,t),u)})}else{if(v(i)&&v(n))return Wn(2,2);if(S(i)&&S(n)&&(i=Vn(i),n=Vn(n)),y(i)&&y(n)){if(i.length!==n.length)throw"cov: inputs not of same dimension";var r;return i.length<=1?i.length?0:o:(r=i.length,U(j(Tn(Cn(An(i,Hn(i))),An(n,Hn(n)))),1===u?r:r-1))}}s("cov")},T.corrcoef=function e(i,t){if(null==t){if(v(i)||y(i))return 1;if(S(i))return k(G(i),G(i),function(n,t,r){return n===t?1:t<n?r[t][n]:e(N(i,n),N(i,t))})}else{if(v(i)&&v(t))return 1;if(y(i)&&y(t)){if(i.length!==t.length)throw"corrcoef: inputs not of same dimension";var n=i.length;return 1<n?U(j(Tn(a(An(i,Hn(i)),Kn(i)),a(An(t,Hn(t)),Kn(t)))),n-1):1}if(S(i)&&S(t)){if(B(i)!==B(t)||G(i)!==G(t))throw"corrcoef: inputs not of same dimension";return Z(G(i),function(n){return e(N(i,n),N(t,n))})}}s("corrcoef")},T.diff=function(n,t,r){for(null==r&&(r=1),w(t=null==t?1:t)||s("diff");t--;)n=function t(r,n){if(y(r))return 1<r.length?Z(r.length-1,function(n){return F(r[n+1],r[n])}):[];if(S(r)){if(1===(n=null==n?1:n))return Z(G(r),function(n){return t(N(r,n))});if(2===n)return Z(B(r),function(n){return t(r[n])})}s("diff")}(n,r);return n},T.cumsum=function(n,t,r){n=nt(n,$,r,t);return!1===n&&s("cumsum"),n},T.cumprod=function(n,t,r){n=nt(n,Q,r,t);return!1===n&&s("cumprod"),n},T.cummin=function(n,t,r){n=nt(n,function(n,t){return C(n,t)?n:t},r,t);return!1===n&&s("cummin"),n},T.cummax=function(n,t,r){n=nt(n,function(n,t){return vn(n,t)?n:t},r,t);return!1===n&&s("cummax"),n},T.movsum=function(n,t,r){var e,i;return y(t)?(e=t[0],i=t[1]):w(t)&&(i=1&t?e=t>>1:(e=t>>1,t-1>>1)),!1===(t=tt(n,j,e,i,r))&&s("movsum"),t},T.movprod=function(n,t,r){var e,i;return y(t)?(e=t[0],i=t[1]):w(t)&&(i=1&t?e=t>>1:(e=t>>1,t-1>>1)),!1===(t=tt(n,Bn,e,i,r))&&s("movprod"),t},T.movmean=function(n,t,r){var e,i;return y(t)?(e=t[0],i=t[1]):w(t)&&(i=1&t?e=t>>1:(e=t>>1,t-1>>1)),!1===(t=tt(n,Hn,e,i,r))&&s("movmean"),t},T.find=function(n){return i=function(n){return!P(n,0)},y(n=n)?n.reduce(function(n,t,r){return i(t,r+1,1)&&n.push(r+1),n},[]):S(n)?(u=B(n),n.reduce(function(n,t,e){return t.reduce(function(n,t,r){return i(t,e+1,r+1)&&n.push(e+u*r+1),n},n)},[])):[];var i,u},T.any=function(n){var t=n,r=function(n){return!P(n,0)};if(v(t))return r(t,1,1)?1:0;if(y(t)){for(var e=0,i=t.length;e<i;++e)if(r(t[e],e+1,1))return 1}else if(S(t))for(var e=0,u=B(t),o=G(t);e<u;++e)for(var f=0;f<o;++f)if(r(t[e][f],e+1,f+1))return 1;return 0},T.all=function(n){return rt(n,function(n){return!P(n,0)})},T.isreal=function(n){return rt(n,rn)},T.isempty=function(n){return b(n)?b(n[0])?n[0].length?0:1:n.length?0:1:0},T.magic=function n(r){if(!w(r=en(r,!0))||r<=2)return 1===r?[[1]]:[];var e,i,u,o,f,t,l,a,c,s,h,p,m,g=1&r,d=0==(3&r),v=r*r,y=r-g>>1;if(g)return e=r+y,i=y+g,k(r,r,function(n,t){return(e+n-(t=r-1-t))%r*r+(i+t+n)%r+1});if(d)return c=0,k(r,r,function(n,t){return++c,(n+1&3)>>1==(t+1&3)>>1?v-(c-1):c});for(p=n(y),f=(o=(u=g=y*y)<<1)+g,m=k(r,r,function(n,t){return n<y&&t<y?p[n][t]:n<y?p[n][t-y]+f:t<y?p[n-y][t]+o:p[n-y][t-y]+u}),l=t=y>>>1,h=0;h<y;++h)for(s=0;s<r;++s)!(s<t||r-l<s||s===t&&h===t)||0===s&&h===t||(a=m[s][h],m[s][h]=m[s][h+y],m[s][h+y]=a);return m},T.inv=function(n){return S(n=v(n)?[[n]]:n)||s("inv"),lt(n)},T.pinv=function(n,t){return S(n=v(n)?[[n]]:n)||s("pinv"),at(ft(n,t))},T.ref=Ut(function(n,t,r){S(t=v(t)?[[t]]:t)||s("ref");t=ct(ft(t,r),!0);return 1<n?[t[0],t[1].map(function(n){return n[1]+1})]:t[0]}),T.rref=Ut(function(n,t,r){S(t=v(t)?[[t]]:t)||s("rref");t=st(ft(t,r),!0);return 1<n?[t[0],t[1].map(function(n){return n[1]+1})]:t[0]}),T.rank=function(n){return S(n=v(n)?[[n]]:n)||s("rank"),ct(n,!0)[1].length},T.adjoint=function(n){return S(n)&&B(n)===G(n)||s("adjoint"),ht(n)},T.det=mt,T.trace=gt,T.charpoly=dt,T.eig=Ut(function(n,t){return S(t)&&B(t)===G(t)||s("eig"),2<arguments.length&&s("eig"),1<n?[(n=vt(t))[0],Fn(n[1]),n[2]]:W((pt(t,"upper")||pt(t,"lower")?Z(B(t),function(n){return t[n][n]}):_t(dt(t))).sort(function(n,t){return V(t)-V(n)}))}),T.rowspace=function(n,t){return ct(r=ft(n,t),!0)[1].map(function(n){return r[n[0]]});var r},T.colspace=function(n,t){return ct(r=ft(n,t),!0)[1].map(function(t){return Z(r.length,function(n){return r[n][t[1]]})});var r},T.null=function(n,t){return n=ft(n,t),i=G(n),u=(n=st(n,!0))[0],o=n[1],f=o.length,n=o.reduce(function(n,t){for(var r=0;r<n.length&&t[1]>n[r];)++r;return r<n.length&&t[1]===n[r]&&n.splice(r,1),n},Z(i,function(n){return n})),l=f?o.reduce(function(n,t,r){return Q(n,u[r][t[1]])},1):1,n.map(function(t){for(var n,r=Z(i,function(n){return n===t?l:0}),e=0;e<f;++e)(n=o[e][1])<=t&&(r[n]=F(r[n],Q(U(l,u[e][n]),u[e][t])));return r});var i,u,o,f,l},T.svd=Ut(function(n,t,r){return S(t=v(t)?[[t]]:t)||s("svd"),1<n?[(n=yt(t,r,1<n,2<n))[0],Fn(n[1]),n[2]]:yt(t,r,!1,!1)}),T.lu=function(n){return S(n=v(n)?[[n]]:n)||s("lu"),wt(n,!0)},T.qr=Ut(function(n,t){return S(t=v(t)?[[t]]:t)||s("qr"),St(t,1<n)}),T.hess=Ut(function(n,t,r){return S(t=v(t)?[[t]]:t)&&B(t)===G(t)||s("hess"),2<arguments.legnth?(S(r=v(r)?[[r]]:r)&&B(r)===G(r)||s("hess"),kt(t,r)):kt(t,null,1<n)}),T.ldl=function(n,t){S(n=v(n)?[[n]]:n)||s("ldl");var r,e,i,u,o,f,l=n,a=t,c=B(l);if(c===G(l)&&ln(l,Dn(l))){for(o=Wn(c,c),f=$n(c),r=0;r<c;++r){if("upper"===a){for(e=r+1;e<c;++e){for(i=r+1,u=0;i<e;++i)u=$(u,Q(Q(f[r][i],D(f[e][i])),o[i][i]));f[r][e]=U(F(l[r][e],u),o[e][e])}for(i=r+1,u=0;i<c;++i)u=$(u,Q(Q(f[r][i],D(f[r][i])),o[i][i]))}else{for(e=0;e<r;++e){for(u=i=0;i<e;++i)u=$(u,Q(Q(f[r][i],D(f[e][i])),o[i][i]));f[r][e]=U(F(l[r][e],u),o[e][e])}for(u=i=0;i<r;++i)u=$(u,Q(Q(f[r][i],D(f[r][i])),o[i][i]))}o[r][r]=F(l[r][r],u),yn(o[r][r],0)&&s("ldl")}return[f,o]}s("ldl")},T.linsolve=At,T.polyval=function(t,n){if(v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),!y(t))throw"polyval: input 1 not supported";if(v(n))return W(Tt(t,n));if(y(n))return n.map(function(n){return W(Tt(t,n))});throw"polyval: input 2 not supported"},T.polyvalm=function(t,n){if(v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),!y(t))throw"polyval: input 1 not supported";if(S(n)&&B(n)===G(n))return W(function(r,n){if(!r.length)return 0;for(var t=r.length,e=0,i=B(n),u=k(i,i,function(n,t){return n===t?r[0]:0});e+1<t;)++e,u=kn(L(u,n),k(i,i,function(n,t){return n===t?r[e]:0}));return u}(t,n));if(v(x))return W(Tt(t,x));if(y(x))return x.map(function(n){return W(Tt(t,n))});throw"polyvalm: input 2 not supported"},T.polyfit=function(n,t,i){if(v(n)?n=[n]:S(n)&&1===B(n)&&(n=n[0]),v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),!y(n))throw"polyfit: input 1 not supported";if(!y(t))throw"polyfit: input 2 not supported";if(n.length!==t.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return W(function(e,i){var n,u,o,t,r,f,l,a;if(!(y(e)&&e.length&&y(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),o=M.min(e.length,i.length),e.length=o,i.length=o,l={},a=[],u=0;u<o;++u)if(f=String(e[u]),z.call(l,f)){if(!P(i[l[f]],i[u]))return[];a.push(u)}else l[f]=u;for(;a.length;)u=a.pop(),e.splice(u,1),i.splice(u,1);for(a=l=null,t=Z(o=e.length,function(n){for(var t=1,r=0;r<o;++r)r!==n&&(t=Q(t,F(e[n],e[r])));return t=U(i[n],t)}),r=Z(o,function(n){return[1,xn(e[n])]}),n=[],u=0;u<o;++u)n=Et(n,r.reduce(function(n,t,r){return n=r!==u?Pt(n,t):n},[t[u]]));return n}(n,t));if(!w(i)||i<0)throw"polyfit: input 3 not positive int";return W(L(at(n.reduce(function(n,t){for(var r=1,e=[1];r<=i;++r)e.unshift(Q(t,e[0]));return n.push(e),n},[])),t))},T.roots=function(n){return v(n)?n=[n]:S(n)&&1===B(n)&&(n=n[0]),y(n)||s("roots"),W(_t(n).sort(function(n,t){return In(n)-In(t)}))},T.poly=function(n){return v(n)?n=[n]:S(n)&&1===B(n)&&(n=n[0]),y(n)||s("poly"),W(n.reduce(function(n,t){return Pt(n,[1,xn(t)])},[1]))};var Pt=It;function Ct(n,t,r){var e,i=[],u=n.slice(),o=u.length-t.length,f=t;if(0<=o)for(i=Z(o+1,0);0<=o;){for(e=o,t=f.concat(Z(o,0)),i[i.length-1-o]=U(u[0],t[0]),u=Et(u,Pt(t,[-i[i.length-1-o]]));u.length&&P(u[0],0);)u.shift();if((o=u.length-f.length)===e)break}return[i,r?Z(n.length-u.length,0).concat(u):u]}T.conv=function(n,t){if(v(n)||v(t))return Tn(n,t);if(S(n)&&1===B(n)&&(n=n[0]),S(t)&&1===B(t)&&(t=t[0]),!y(n))throw"conv: input 1 not supported";if(y(t))return It(n,t);throw"conv: input 2 not supported"};var Lt=Ct;T.deconv=Ut(function(n,t,r){var e;if(v(t)||v(r))e=1<n?[a(t,r),0]:a(t,r);else{if(S(t)&&1===B(t)&&(t=t[0]),S(r)&&1===B(r)&&(r=r[0]),!y(t))throw"deconv: input 1 not supported";if(!y(r))throw"deconv: input 2 not supported";if(!r.length||1===r.length&&P(r[0],0))throw"deconv: divisor is zero";e=Ct(t,r,!0)}return 1<n?e:e[0]}),T.polydiv=Ut(function(n,t,r){var e;if(v(t)||v(r))e=1<n?[a(t,r),0]:a(t,r);else{if(S(t)&&1===B(t)&&(t=t[0]),S(r)&&1===B(r)&&(r=r[0]),!y(t))throw"polydiv: input 1 not supported";if(!y(r))throw"polydiv: input 2 not supported";if(!r.length||1===r.length&&P(r[0],0))throw"polydiv: divisor is zero";e=Lt(t,r,!1)}return 1<n?e:e[0]}),T.conv2=function(t,r){if(v(t)||v(r))return Tn(t,r);if(y(t)){if(y(r))return It(t,r);if(S(r))return Z(G(r),function(n){return It(t,N(r,n))})}else{if(y(r)){if(y(t))return It(t,r);if(S(t))return Z(t[0].length,function(n){return It(N(t,n),r)});throw"conv2: input 1 not supported"}if(!S(t))throw"conv2: input 1 not supported";if(S(r)){var n,e,i,u,o,f,l,a,c,s,h,p,m,g=t,d=r;for(B(g)<B(d)&&(m=g,g=d,d=m),n=B(g),e=G(g),o=Wn(f=n+(i=B(d))-1,l=e+(u=G(d))-1),c=0;c<f;++c)for(s=0;s<l;++s){for(h=a=0;h<=c&&!(n<=h);++h)if(!(i<=c-h))for(p=0;p<=s&&!(e<=p);++p)u<=s-p||(a=$(a,Q(g[h][p],d[c-h][s-p])));o[c][s]=a}return o}}throw"conv2: input 2 not supported"},T.filter=function(n,t,r,e,i){if(v(n)?n=[n]:S(n)&&1===B(n)&&(n=n[0]),v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),v(r)?r=[r]:S(r)&&1===B(r)&&(r=r[0]),y(n)&&y(t)&&y(r)){var u,o,f,l,a=n,c=t,s=r,h=s.length,p=c.length,m=a.length,g=new Array(h),d=c[0];for(c=c.map(function(n){return U(n,d)}),a=a.map(function(n){return U(n,d)}),u=0;u<h;++u){for(f=u,o=l=0;0<=f&&o<m;++o,--f)l=$(l,Q(a[o],s[f]));for(f=u-1,o=1;0<=f&&o<p;++o,--f)l=F(l,Q(c[o],g[f]));g[u]=l}return g}throw"filter: inputs not supported"};var jt={},Nt={};function Rt(n,t){for(var r,e,i=n.length,u={},o=0;o<i;++o)1!==u[o]&&(e=n[r=function(n,t){for(var r=0;1<t;)r=(r<<1)+(1&n),n>>=1,t>>=1;return r}(o,i)],t[r]=n[o],t[o]=e,u[r]=1)}function qt(n,t,r){var e,i=n.length;if(1===i)r[0]=n[0];else{for(e=0;e<i;++e)r[e]=new I(0,0);for(var u,o,f,l,a,c,s=function(n){for(var t=M.sqrt(n),r=3;r<=t;){if(0==n%r)return r;r+=2}return n}(i),h=i/s,p=1/M.sqrt(s),m=new Array(h),g=new Array(h),d=0;d<s;++d){for(e=0;e<h;++e)m[e]=n[e*s+d];for(1<h&&(Ot(m,t,g),m=g,g=recursive_resulte),u=M.cos(2*q*d/i),o=(t?-1:1)*M.sin(2*q*d/i),f=1,e=l=0;e<i;++e)a=p*m[e%h].re,c=p*m[e%h].im,r[e]=r[e].add(new I(f*a-l*c,f*c+l*a)),a=f*u-l*o,l=f*o+l*u,f=a,l=l}}}function zt(n,t,r){var e,i,u,o,f,l,a,c,s,h,p,m,g,d,v,y=n.length,w=1;for(Rt(n,r);w<y;){for(v=void 0,null==(v=Nt[d=w])&&(Nt[d]=v=M.cos(q/d)),e=v,i=(t?-1:1)*(d=void 0,null==(d=jt[v=w])&&(jt[v]=d=M.sin(q/v)),d),o=y/(2*w),u=0;u<o;++u)for(a=1,f=c=0;f<w;++f)h=r[m=2*u*w+f].re,p=r[m].im,g=r[s=m+w].re,l=r[s].im,r[m]=new I(M.SQRT1_2*(h+(m=a*g-c*l)),M.SQRT1_2*(p+(g=c*g+a*l))),r[s]=new I(M.SQRT1_2*(h-m),M.SQRT1_2*(p-g)),l=a*i+c*e,a=a*e-c*i,c=l;w<<=1}}function Ot(n,t,r){var e,i=n.length;if(!(i<=0))return e=!1,null==r&&(r=new Array(i),e=!0),(i&i-1?qt:zt)(n,t,r),e?r:void 0}function Mt(n,t,r){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,o,f=!1,l=new Array(e),a=new Array(i),c=new Array(e),s=new Array(i);if(null==r){for(r=new Array(e),u=0;u<e;++u)r[u]=new Array(i);f=!0}for(o=0;o<i;++o,0){for(u=0;u<e;++u)l[u]=n[u][o];for(Ot(l,t,c),u=0;u<e;++u)r[u][o]=c[u]}for(u=0;u<e;++u){for(o=0;o<i;++o,0)a[o]=r[u][o];for(Ot(a,t,s),o=0;o<i;++o,0)r[u][o]=s[o]}return f?r:void 0}}function r(){if(!_(this,r))return new r;this.data=[]}T.fft=function(t){return v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),S(t)?Z(G(t),function(n){return W(Ot(mn(N(t,n)),!1))}):y(t)?W(Ot(mn(t),!1)):void s("fft")},T.ifft=function(t){return v(t)?t=[t]:S(t)&&1===B(t)&&(t=t[0]),S(t)?Z(G(t),function(n){return W(Ot(mn(N(t,n)),!0))}):y(t)?W(Ot(mn(t),!0)):void s("ifft")},T.fft2=function(n){return S(n)||s("fft2"),W(Mt(mn(n),!1))},T.ifft2=function(n){return S(n)||s("ifft2"),W(Mt(mn(n),!0))},A.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],r.prototype={constructor:r,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,render:function(n,t){var r=this;return t&&(r.canvas=t,r.type=n,-1<["plot","scatter","bar","barh","pie"].indexOf(n)&&r.data&&r.data.length&&r.renderData(),"xlabel"===n&&r.xlabel&&r.xlabel.length&&r.renderXLabel(),"ylabel"===n&&r.ylabel&&r.ylabel.length&&r.renderYLabel(),"title"===n&&r.title&&r.title.length&&r.renderTitle(),r.canvas=null),t},renderData:function(){var m,g,d,v=this,y=v.canvas.getContext("2d"),w=v.type,x=v.canvas.width,b=v.canvas.height,S=0,k=v.data.length;-1===["pie"].indexOf(w)&&(v.renderAxes(),m=v.no),"bar"===w?S=M.max(1,M.floor((x-v.pl-v.pr)/(m*k))):"barh"===w?S=M.max(1,M.floor((b-v.pt-v.pb)/(m*k))):"pie"===w&&(1<k&&1&k&&(k+=1),g=M.floor(M.sqrt(k)),d=k/g,S=M.min((x-v.pl-v.pr)/d,(b-v.pt-v.pb)/g)),v.data.forEach(function(n,t){var r=n.x,e=n.y,i=n.style;if("plot"===w){for(y.beginPath(),y.lineWidth=i.LineWidth,y.setLineDash(i.LineStyle),y.strokeStyle="rgb("+i.Color.map(function(n){return M.round(255*n)}).join(",")+")",y.lineJoin="bevel",y.moveTo(v.x(r[0]),v.y(e[0])),p=1;p<m;++p)y.lineTo(v.x(r[p]),v.y(e[p]));y.stroke()}else if("scatter"===w)for(y.fillStyle="rgb("+i.Color.map(function(n){return M.round(255*n)}).join(",")+")",p=0;p<m;++p)y.beginPath(),y.arc(v.x(r[p]),v.y(e[p]),2*i.LineWidth,0,2*q),y.closePath(),y.fill();else if("bar"===w)for(y.fillStyle="rgb("+i.Color.map(function(n){return M.round(255*n)}).join(",")+")",p=0;p<m;++p)y.fillRect(v.pl+t*S*.8+p*k*S,v.y(0)>v.y(e[p])?v.y(e[p]):v.y(0),.8*S,M.abs(v.y(e[p])-v.y(0)));else if("barh"===w)for(y.fillStyle="rgb("+i.Color.map(function(n){return M.round(255*n)}).join(",")+")",p=0;p<m;++p)y.fillRect(v.y(0)>v.y(e[p])?v.y(e[p]):v.y(0),v.pt+t*S*.8+p*k*S,M.abs(v.y(e[p])-v.y(0)),.8*S);else if("pie"===w){var u,o,f=j(Ln(e)),l=.4*S,a=-q/2,n=t%d,c=M.floor(t/d),s=(x-d*S)/2+n*S+S/2,h=(b-g*S)/2+c*S+S/2,p=0;for(m=e.length;p<m;++p)o=e[p]/f,u=a+2*q*o,y.beginPath(),y.moveTo(s,h),y.arc(s,h,l,a,u,!1),y.closePath(),y.fillStyle=A.PALETTE[p%A.PALETTE.length],y.fill(),y.font="10 px sans-serif",y.textAlign="center",y.fillStyle="#000",y.strokeStyle="#000",y.fillText((100*o).toFixed(2)+"%",s+(22+l)*M.cos((a+u)/2),h+(22+l)*M.sin((a+u)/2)),a=u}})},renderXLabel:function(){var n=this,t=n.canvas.getContext("2d"),r=n.canvas.width,e=n.canvas.height;t.font=String(15)+"px sans-serif",t.fillStyle="#000",t.textAlign="center",t.strokeStyle="#000",t.fillText(n.xlabel,r/2,e-1-n.pb/4)},renderYLabel:function(){var n=this.canvas.getContext("2d"),t=(this.canvas.width,this.canvas.height);n.font=String(15)+"px sans-serif",n.fillStyle="#000",n.textAlign="center",n.strokeStyle="#000",n.save(),n.translate(19.5,t/2),n.rotate(-M.PI/2),n.fillText(this.ylabel,0,0),n.restore()},renderTitle:function(){var n=this,t=n.canvas.getContext("2d"),r=n.canvas.width;n.canvas.height;t.font=String(18)+"px sans-serif",t.fillStyle="#000",t.textAlign="center",t.strokeStyle="#000",t.fillText(n.title,r/2,n.pt/2)},renderAxes:function(){var n,t,r,e,i,u,o,f,l,a,c,s=this,h=s.canvas.getContext("2d"),p=s.canvas.width,m=s.canvas.height;s.type;function g(n,t){return!1===t||n<1?parseFloat(n.toFixed(4)):M.ceil(n)}function d(n){return n.toFixed(3).replace(/0+$/,"").replace(/\.$/,"")}if(s.updateAxes(),n=s.xmin,s.xmax,t=s.ymin,s.ymax,"barh"===s.type){for(a=M.max(60,g((p-s.pl-s.pr)/16)),r=[],l=s.pl;f=s.y(l,!0),!(l>p-1-s.pr);l+=a)r.push({t:f,p:l});c=M.max(1,M.floor((m-s.pt-s.pb)/(s.no*s.data.length))),e=Z(s.no,function(n){return{t:n+1,p:s.pt+n*s.data.length*c+s.data.length*c*.8/2}})}else{if("bar"===s.type)c=M.max(1,M.floor((p-s.pl-s.pr)/(s.no*s.data.length))),r=Z(s.no,function(n){return{t:n+1,p:s.pl+n*s.data.length*c+s.data.length*c*.8/2}});else if(r=[],"log"===s.xscale)for(f=M.pow(10,M.floor(M.log10(n)));!((l=s.x(f))>p-1-s.pr);f*=10)for(r.push({t:f,p:l}),o=1;o<=8&&!((l=s.x(o*f))>p-1-s.pr);++o)r.push({t:o*f,p:l});else for(a=M.max(60,g((p-s.pl-s.pr)/16)),l=s.pl;f=s.x(l,!0),!(l>p-1-s.pr);l+=a)r.push({t:f,p:l});if(e=[],"log"===s.yscale)for(f=M.pow(10,M.floor(M.log10(t)));!((l=s.y(f))<s.pt);f*=10)for(e.push({t:f,p:l}),o=1;o<=8&&!((l=s.y(o*f))<s.pt);++o)e.push({t:o*f,p:l});else for(a=M.max(40,g((m-s.pt-s.pb)/16)),l=m-1-s.pb;f=s.y(l,!0),!(l<s.pt);l-=a)e.push({t:f,p:l})}h.font=String(10)+"px sans-serif",h.fillStyle="#000",h.textAlign="center",h.strokeStyle="#000",h.lineWidth=1,h.beginPath(),h.moveTo(s.pl,s.pt),h.lineTo(p-1-s.pr,s.pt),h.lineTo(p-1-s.pr,m-1-s.pb),h.lineTo(s.pl,m-1-s.pb),h.lineTo(s.pl,s.pt),h.stroke(),i=M.max(8,.001*m),r.forEach(function(n){h.lineWidth=.5,h.beginPath(),h.moveTo(n.p,m-1-s.pb),h.lineTo(n.p,m-1-s.pb-i),h.stroke(),h.beginPath(),h.moveTo(n.p,s.pt),h.lineTo(n.p,s.pt+i),h.stroke(),"log"===s.xscale?w(M.log10(n.t))&&h.fillText("10^"+String(M.floor(M.log10(n.t))),n.p,m-1-s.pb+5+10):h.fillText(d(n.t),n.p,m-1-s.pb+5+10)}),u=M.max(8,.001*p),e.forEach(function(n,t){h.lineWidth=.5,h.beginPath(),h.moveTo(s.pl,n.p),h.lineTo(s.pl+u,n.p),h.stroke(),h.beginPath(),h.moveTo(p-1-s.pr,n.p),h.lineTo(p-1-s.pr-u,n.p),h.stroke(),"log"===s.yscale?w(M.log10(n.t))&&h.fillText("10^"+String(M.floor(M.log10(n.t))),s.pl-21,n.p):h.fillText(d(n.t),s.pl-21,n.p)})},updateAxes:function(){var r=this,n=r.canvas.width,t=r.canvas.height,e=l,i=-l,u=l,o=-l,f=l;r.data.forEach(function(n,t){"barh"===r.type||"bar"===r.type?f=M.min(f,n.y.length):(f=M.min(f,n.x.length,n.y.length),e=M.min(e,Gn(n.x)),i=M.max(i,Yn(n.x))),u=M.min(u,Gn(n.y)),o=M.max(o,Yn(n.y))}),"barh"!==r.type&&"bar"!==r.type||(e=1,i=f,0<u&&(u=0),o<0&&(o=0)),e===i&&(e-=Y,i+=Y),u===o&&(u-=Y,o+=Y),r.no=f,r.xmin=e,r.xmax=i,r.ymin=u,r.ymax=o,"log"===r.xscale?(r.xmin=M.pow(10,M.floor(M.log10(r.xmin||Y))),r.xmax=M.pow(10,M.ceil(M.log10(r.xmax||Y))),r.scx=(n-1-r.pl-r.pr)/(M.log10(r.xmax)-M.log10(r.xmin))):r.scx=(n-1-r.pl-r.pr)/(r.xmax-r.xmin),"log"===r.yscale?(r.ymin=M.pow(10,M.floor(M.log10(r.ymin||Y))),r.ymax=M.pow(10,M.ceil(M.log10(r.ymax||Y))),r.scy=("barh"===r.type?n-1-r.pl-r.pr:t-1-r.pt-r.pb)/(M.log10(r.ymax)-M.log10(r.ymin))):r.scy=("barh"===r.type?n-1-r.pl-r.pr:t-1-r.pt-r.pb)/(r.ymax-r.ymin),r.sc=M.min(r.scx,r.scy)},x:function(n,t){var r=this,e=r.xmin,i=r.yscale===r.xscale?r.sc:r.scx;return!0===t?(n-r.pl)/i+e:("log"===r.xscale&&(e=M.log10(e),n=M.log10(n||Y)),(n-e)*i+r.pl)},y:function(n,t){var r=this,e=r.ymin,i=r.yscale===r.xscale?r.sc:r.scy,u=r.canvas.height;return!0===t?"barh"===r.type?(n-r.pl)/i+e:(u-1-n-r.pb)/i+e:("log"===r.yscale&&(e=M.log10(e),n=M.log10(n||Y)),"barh"===r.type?(n-e)*i+r.pl:u-1-((n-e)*i+r.pb))},option:function(n,t,r,e){var i,u,o,f={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},l={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},a={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},c=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:a[c[(e||0)%c.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=a[c[(e||0)%c.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=f["-"]),n._LineStyle||(n._LineStyle="-"),r=r||0;r<t.length;){if("Color"===t[r])E(i=t[r+1])?z.call(l,i)?n.Color=a[l[i]]:z.call(a,i)&&(n.Color=a[i]):y(i)&&3===i.length&&(n.Color=i);else if("LineWidth"===t[r])X(i=t[r+1])&&(n.LineWidth=2*i);else{if("LineStyle"!==t[r]){if(E(t[r])){for(u in o=!1,i=t[r],a)-1<i.indexOf(u)&&(n.Color=a[u],o=!0);for(u in f)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=f[u],o=!0);if(o){r+=1;continue}}break}E(i=t[r+1])&&z.call(f,i)&&(n._LineStyle=i,n.LineStyle=f[i])}r+=2}return r},parse:function(n,t,r){var e,i,u,o,f,l,a=this,c=0,s=0;if("pie"===t)for(;c<n.length;)y(n[c])?a.data.push({y:n[c++]}):c+=1;else if("plot3"===t)for(;c<n.length;)f=o=u=null,y(n[c])&&(u=n[c]),y(n[c+1])&&(o=n[c+1]),y(n[c+2])&&(f=n[c+2],c+=3),u&&o&&f?(c=a.option(l={},n,c,s),a.data.push({x:u,y:o,z:f,style:l}),++s):c+=1;else for(;c<n.length;)if(o=u=null,y(n[c])&&(u=n[c]),y(n[c+1])||S(n[c+1])?(o=n[c+1],c+=2):u&&(u=Vn(1,(o=u).length),c+=1),u&&o)if(c=a.option(l={},n,c,s),S(o))for(e=0,i=G(o);e<i;++e)a.data.push({x:u,y:N(o,e),style:l}),l=a.option(l,n,c,++s);else a.data.push({x:u,y:o,style:l}),++s;else c+=1;return a}},A.figure=r,T.plot=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("plot",A.createCanvas(700,525)):null},T.loglog=function(){var n=r().parse(arguments);return n.xscale="log",n.yscale="log",n.data.length?n.render("plot",A.createCanvas(700,525)):null},T.semilogx=function(){var n=r().parse(arguments);return n.xscale="log",n.yscale="linear",n.data.length?n.render("plot",A.createCanvas(700,525)):null},T.semilogy=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="log",n.data.length?n.render("plot",A.createCanvas(700,525)):null},T.scatter=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("scatter",A.createCanvas(700,525)):null},T.bar=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("bar",A.createCanvas(700,525)):null},T.barh=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("barh",A.createCanvas(700,525)):null},T.piechart=function(){var n=r().parse(arguments,"pie");return n.data.length?n.render("pie",A.createCanvas(700,525)):null},T.donutchart=function(){return T.piechart.apply([].slice.call(arguments))},T.xlabel=function(n){var t=r();return t.xlabel=String(n),t.render("xlabel",A.currentCanvas())},T.ylabel=function(n){var t=r();return t.ylabel=String(n),t.render("ylabel",A.currentCanvas())},T.title=function(n){var t=r();return t.title=String(n),t.render("title",A.currentCanvas())};var Xt={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var t=[],r=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?r.length&&(b(r[0])?t=t.length?Rn("vert",t,r):r:t.push(r),r=[]):!_(n,Qt)&&b(n)?r=r.length?Rn("horz",r,n):n:r.push(n))}),r.length&&(b(r[0])?t=t.length?Rn("vert",t,r):r:t.length?t.push(r):t=r),t}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return Vn(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,t){return Vn(n,t)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,t,r){return Vn(n,t,r)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:Dn},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:Un},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:En},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:_n},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,t){return At(n,t)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:a},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:a},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:L},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:Tn},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:kn},"-":{name:"sub",arity:2,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:An},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:function r(e,i){if(E(e)){if(E(i))return i<=e?1:0;if(v(i))return e>=String(i)?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),G(i),function(n,t){return r(e,i[n][t])})}else if(X(e)){if(E(i))return String(e)>=i?1:0;if(X(i))return i<=e?1:0;if(u(i))return i.re>=e&&0===i.im?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),G(i),function(n,t){return r(e,i[n][t])})}else if(u(e)){if(E(i))return String(e)>=i?1:0;if(X(i))return e.re>=i&&0===e.im?1:0;if(u(i))return P(e,i)?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),G(i),function(n,t){return r(e,i[n][t])})}else if(y(e)){if(E(i)||v(i))return e.map(function(n){return r(n,i)});if(y(i)){if(e.length!==i.length)throw"ge: inputs have incompatible dimensions";return e.map(function(n,t){return r(n,i[t])})}if(S(i)){if(e.length!==G(i))throw"ge: inputs have incompatible dimensions";return k(B(i),G(i),function(n,t){return r(e[t],i[n][t])})}}else if(S(e)){if(E(i)||v(i))return k(B(e),G(e),function(n,t){return r(e[n][t],i)});if(y(i)){if(G(e)!==i.length)throw"ge: inputs have incompatible dimensions";return k(B(e),G(e),function(n,t){return r(e[n][t],i[t])})}if(S(i)){if(B(e)!==B(i)||G(e)!==G(i))throw"ge: inputs have incompatible dimensions";return k(B(e),G(e),function(n,t){return r(e[n][t],i[n][t])})}}return 0}},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:yn},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:vn},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:C},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:function r(e,i){if(E(e)){if(E(i))return e===i?0:1;if(v(i))return e===String(i)?0:1;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),G(i),function(n,t){return r(e,i[n][t])})}else if(X(e)){if(E(i))return String(e)===i?0:1;if(X(i))return e===i?0:1;if(u(i))return i.re===e&&0===i.im?0:1;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),G(i),function(n,t){return r(e,i[n][t])})}else if(u(e)){if(E(i))return String(e)===i?0:1;if(X(i))return e.re===i&&0===e.im?0:1;if(u(i))return e.re===i.re&&e.im===i.im?0:1;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(B(i),G(i),function(n,t){return r(e,i[n][t])})}else if(y(e)){if(E(i)||v(i))return e.map(function(n){return r(n,i)});if(y(i)){if(e.length!==i.length)throw"ne: inputs have incompatible dimensions";return e.map(function(n,t){return r(n,i[t])})}if(S(i)){if(e.length!==G(i))throw"ne: inputs have incompatible dimensions";return k(B(i),G(i),function(n,t){return r(e[t],i[n][t])})}}else if(S(e)){if(E(i)||v(i))return k(B(e),G(e),function(n,t){return r(e[n][t],i)});if(y(i)){if(G(e)!==i.length)throw"ne: inputs have incompatible dimensions";return k(B(e),G(e),function(n,t){return r(e[n][t],i[t])})}if(S(i)){if(B(e)!==B(i)||G(e)!==G(i))throw"ne: inputs have incompatible dimensions";return k(B(e),G(e),function(n,t){return r(e[n][t],i[n][t])})}}return 0}},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:P},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,t){return p(n)&&p(t)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,t){return p(n)||p(t)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,t){return p(n)&&!p(t)||p(t)&&!p(n)?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return p(n)?0:1}},"=":{name:"set",breakpoint:"end",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,t){var r,e;return b(n)&&_(n[0],Qt)?(e=n,b(r=t)?await Promise.all(e.map(function(n,t){return Zt(n,t<r.length?r[t]:null)})):await Promise.all(e.map(function(n,t){return Zt(n,0===t?r:null)}))):Zt(n,t.$scilitevarargout$?t[0]:t)}}};async function Zt(n,t){if(_(n,Qt)&&E(n.v))return await n.set(t),n.get(!0);throw"setting non-variable"}async function Wt(n,t,r){var e,i,u,o,f,l,a=null;if(p(await Vt(n.if.cond,t,r))){for(e=0,o=(f=n.if.statements).length;e<o;++e)null!=(l=await Vt(f[e],t,r))&&(a=l);return a}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(p(await Vt(n.elseif[i].cond,t,r))){for(e=0,o=(f=n.elseif[i].statements).length;e<o;++e)null!=(l=await Vt(f[e],t,r))&&(a=l);return a}if(n.else.statements.length){for(e=0,o=(f=n.else.statements).length;e<o;++e)null!=(l=await Vt(f[e],t,r))&&(a=l);return a}}async function $t(n,t,r){var e,i,u,o,f,l,a,c=null,s=!1,h=!1,p=await Vt(n.val,t,r),m=n.statements;if(b(p)){for(l=(r=r||{}).brk,a=r.cont,r.brk=function(){s=!0},r.cont=function(){h=!0},u=0,o=p.length;u<o;++u){for(h=s=!1,await n.ind.set(p[u]),e=0,i=m.length;e<i&&(f=await Vt(m[e],t,r),!s&&!h);++e)null!=f&&(c=f);if(s)break}r.brk=l,r.cont=a}return c}async function Ft(n,t,r){var e,i,u,o=null,f=!1,l=!1,a=n.statements,c=(r=r||{}).brk,s=r.cont;for(r.brk=function(){f=!0},r.cont=function(){l=!0};p(await Vt(n.cond,t,r));){for(l=f=!1,e=0,i=a.length;e<i&&(u=await Vt(a[e],t,r),!f&&!l);++e)null!=u&&(o=u);if(f)break}return r.brk=c,r.cont=s,o}function Qt(n,t,r){if(!_(this,Qt))return new Qt(n,t,r);this.ctx=n,this.v=t,this.i=r}function R(n,t){if(!_(this,R))return new R(n,t);null==t&&(t=n,n=""),this.op=n,this.arg=t}function Ut(r){function n(){var n=[].slice.call(arguments);return n.unshift(1),r.apply(null,n)}return n.nargout=function(t){return function(){var n=[].slice.call(arguments);return n.unshift(t),n=r.apply(null,n),1<t&&b(n)&&(n.$scilitevarargout$=!0),n}},n}async function Dt(n){return _(n,Qt)?await n.get():n}async function Vt(n,t,r){if(_(n,R))return Gt(n,t,r);if(b(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await Vt(n[e],t,r);return u}return n}function Bt(v,y,w,i){var x,b=0,S=0,u=v;function k(n,t,r){null==r&&(r=S),null==t&&(t=b);var e=u.split("\n")[r];return(n=String(n)+" at line "+String((w||0)+r)+" position "+String((i||0)+t)+":")+"\n"+e+"\n"+new Array(t+1).join(" ")+"^\n"}return function i(n){var t,r,e,u,o,f,l,a=[],c=[],s=[];function h(n){var t,r,e,i,u,o,f,l;if(c.length)if(n)for(;0<c.length;){if(u=(i=c.shift())[0],n===(o=Xt[u]).breakpoint){c.unshift(i);break}if("-"===u&&1===a.length)a[0]=R(Xt["*"].fn,[a[0],R(-1)]);else{if(o.arity>a.length)throw k('invalid or missing argument for "'+u+'"',i[1],i[2]);l=a.splice(0,o.arity).reverse(),f=R(o.fn,l),a.unshift(f)}}else if(r=(t=c.shift())[0],1===(e=Xt[r]).fixity){if(e.arity>a.length)throw k('invalid or missing argument for "'+r+'"',t[1],t[2]);l=a.splice(0,e.arity).reverse(),f=R(e.fn,l),a.unshift(f)}else{if(-1!==e.fixity)for(;0<c.length&&(u=(i=c[0])[0],(o=Xt[u]).priority<e.priority||o.priority===e.priority&&(o.associativity<e.associativity||o.associativity===e.associativity&&-1===o.associativity));){if("-"===u&&1===a.length)a[0]=R(Xt["*"].fn,[a[0],R(-1)]);else{if(o.arity>a.length)throw k('invalid or missing argument for "'+u+'"',i[1],i[2]);l=a.splice(0,o.arity).reverse(),f=R(o.fn,l),a.unshift(f)}c.shift()}c.unshift(t)}}function p(n){if(h(!0),1<a.length||0<c.length)throw k("mismatched terms and operators",c.length?c[0][1]:b,c.length?c[0][2]:S);!0===n&&(_(a[0],R)&&s.push(a[0]),a=[],c=[])}function m(n,t){var r,e=n.test?v.match(n):n===v.slice(0,n.length);return!!e&&(!1===t?n.test?e:[n,n]:n.test?(r=e[t||0].length,v=v.slice(r),b+=r,e):(r=n.length,v=v.slice(r),b+=r,[n,n]))}function g(n,t,r){for(var e,i=r||0,u="";i<v.length;)if(n===(e=v.charAt(i))){if(!(i+1<v.length&&n===v.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return t&&(v=v.slice(i+1),b+=i+1),[u,i+1]}function d(){var n,t,r,e=function(n,t,r){for(var e,i=0,u=0;i<v.length;)if(e=v.charAt(i),!r||'"'!==e&&"'"!==e){if(t===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=g(e,!1,i+1)[1];return u||i>=v.length?-1:i}("]","[",!0);if(-1===e)throw k("mismatched brackets");if(n=v.slice(0,e),/[\[\]]/.test(n)){for(t=[];r=i(",;]");)if(t.push(r),m(","))t.push(R(","));else{if(!m(";"))break;t.push(R(";"))}m(/^\s+/),m("]")}else t=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,t){var r=n.length,e=0;return t.trim().split(-1<t.indexOf(",")?",":/\s+/g).reduce(function(n,t){return(t=Bt(t.trim(),y,S+w,b))&&(e?n.push(R(",")):r&&n.push(R(";")),n.push(t),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,t){return(t=Bt(t.trim(),y,S+w,b))&&(n.length&&n.push(R(",")),n.push(t)),n},[]),v=v.slice(e+1),b+=e+1,1<(n=n.split("\n")).length&&(S+=n.length-1,n.slice(0,-1).forEach(function(n){b-=n.length+1}));return R(Xt["[]"].fn,t)}for(;0<v.length;)if(m(/^if\b/)){if(p(!0),!(l=i("\n,")))throw k('missing or invalid condition in "if"');for(m("\n")?(++S,b=0):m(","),o=(f={if:{cond:l,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((l=i(["elseif","else","end"]))&&(o.statements=o.statements.concat(l)),m("elseif")){if(!(l=i("\n,")))throw k('missing or invalid condition in "elseif"');m("\n")?(++S,b=0):m(","),f.elseif.push({cond:l,statements:[]}),o=f.elseif[f.elseif.length-1]}else if(m("else"))m(/^[ \t\v\f]+/),m("\n")&&(++S,b=0),o=f.else;else if(m("end")||!l)break;s.push(R(Wt,f))}else if(m(/^for\b/)){if(p(!0),!(t=m(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw k('missing or invalid declaration in "for"');if(!(l=i("\n,")))throw k('missing or invalid declaration in "for"');for(m("\n")?(++S,b=0):m(","),f={ind:Qt(y,t[1]),val:l,statements:[]};(l=i(["end"]))&&(f.statements=f.statements.concat(l)),!m("end")&&l;);s.push(R($t,f))}else if(m(/^while\b/)){if(p(!0),!(l=i("\n,")))throw k('missing or invalid condition in "while"');for(m("\n")?(++S,b=0):m(","),f={cond:l,statements:[]};(l=i(["end"]))&&(f.statements=f.statements.concat(l)),!m("end")&&l;);s.push(R(Ft,f))}else if(t=m(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(t[1]))break;if("continue"===t[1])m("continue"),s.push(R("continue",""));else if("break"===t[1])m("break"),s.push(R("break",""));else{if("end"!==t[1])throw k('unexpected "'+t[1]+'"');m("end"),a.unshift(R("v",Qt(y,"end")))}}else if(m("..."))m(/^[ \t\v\f]+/),m("\n")&&(++S,b=0);else if(m(";",!1)){if(n&&-1<n.indexOf(";"))break;m(";"),p(!0)}else if(m("\n",!1)){if(n&&-1<n.indexOf("\n"))break;m("\n"),++S,p(!(b=0))}else if(m(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(t=m("%"))x=v.indexOf("\n"),v=v.slice(-1<x?x+1:v.length),++S,p(!(b=0));else if(t=(t=m("'"))||m('"'))o=g(t[0],!0)[0],a.unshift(R("'"===t[0]?o.split(""):o));else if(t=m(/^(&&|\|\|)[^&\|]/,1))u=t[1],c.unshift([u,b,S]),h();else if(t=m(/^(xor)[^a-zA-Z]/,1))u=t[1],c.unshift([u,b,S]),h();else if(t=m(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=t[1],c.unshift([u,b,S]),h();else if(t=m("~"))c.unshift(["~",b,S]),h();else if(t=m("="))c.unshift(["=",b,S]),h();else if(t=m(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=t[0],c.unshift([u,b,S]),h();else if(t=m(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(r=t[1],m(/^\s*\:\s*\)/))o=R("v",Qt(y,r)),a.unshift(o),c.unshift(["(:)",b,S]),h();else{for(f=[];(l=i(",)"))&&f.push(l),m(","););if(!m(")"))throw k("mismatched parentheses");o=z.call(T,r)?R(T[r],f):R("v",Qt(y,r,f.length?f:null)),a.unshift(o)}m(/^[ \t\v\f]+/),(t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h())}else if(t=m(/^[_a-z][_a-z0-9]*/i))r=t[0],o=z.call(T,r)&&0===T[r].length?R(T[r],[]):R("v",Qt(y,r)),a.unshift(o),m(/^[ \t\v\f]+/),(t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h());else if(t=m(/^(-?\s*\d+(\.\d+)?([eE]-?\d+)?)([ij])?/))f=parseFloat(t[1].split(/\s+/).join(""),10),o=R(t[4]?new I(0,f):f),a.unshift(o);else if("["===(e=v.charAt(0)))v=v.slice(1),b+=1,(o=d())&&(a.unshift(o),m(/^[ \t\v\f]+/),t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw k("mismatched brackets")}if("("===e)if(v=v.slice(1),b+=1,m(/^\s*\:\s*\)/))c.unshift(["(:)",b,S]),h();else{if(a.length&&c.reduce(function(n,t){return n+("-"===t[0]&&1===a.length?1:Xt[t[0]].arity)},0)<=a.length){for(h("end"),o=a.shift(),f=[];(l=i(",)"))&&f.push(l),m(","););if(!m(")"))throw k("mismatched parentheses");f.length&&(o=R("v",Qt(y,o,f)))}else if(o=i(")"),!m(")"))throw k("mismatched parentheses");o&&(a.unshift(o),m(/^[ \t\v\f]+/),t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw k("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw k(n?'missing expected "'+(E(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(v=v.slice(1),l=[b+=1,S],h("end"),a.length?f=1:(f=0,a.unshift(R(":")));o=i(":,)\n"),m(/^[ \t\v\f]+/),o?(a.unshift(o),++f):m(":",!1)&&a.unshift(R(":")),m(":"););1<f&&(c.unshift([3===f?"::":":",l[0],l[1]]),h())}}return p(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function Gt(n,t,r){var e;if(_(n,R)){if(""===n.op)return n.arg;if("v"===n.op)return!1===t?n.arg:_(n.arg.v,R)?Dt(n.arg):H(t)&&z.call(t,n.arg.v)?t[n.arg.v]:await Dt(n.arg);if(Wt===n.op)return Wt(n.arg,t,r);if($t===n.op)return $t(n.arg,t,r);if(Ft===n.op)return Ft(n.arg,t,r);if("break"===n.op)return void(r&&O(r.brk)&&r.brk());if("continue"===n.op)return void(r&&O(r.cont)&&r.cont());if(Xt["="].fn===n.op)return r=r||{},e=await Gt(n.arg[0],!1),b(e)&&_(e[0],Qt)&&(r.nargout=e.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[e,n.arg[1].arg.isByRef()?on(await Gt(n.arg[1],t,r)):await Gt(n.arg[1],t,r)]):n.op.apply(null,[e].concat(await Promise.all(n.arg.slice(1).map(function(n){return Gt(n,t,r)}))));if(O(n.op))return(r&&w(r.nargout)&&O(n.op.nargout)?n.op.nargout(r.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return Gt(n,t,r)})))}throw"invalid expr"}return A.op=Xt,Qt.prototype={constructor:Qt,ctx:null,v:null,i:null,get:async function(n){var t,r,e=this;if(_(e.v,R))t=await Vt(e.v);else{if(!z.call(e.ctx,e.v)&&!z.call(d,e.v))throw'undefined variable "'+e.v+'"';t=(z.call(e.ctx,e.v)?e.ctx:d)[e.v]}return!0!==n&&null!=e.i?(r=Xn(t),n=await Promise.all(e.i.map(function(n,t){return Vt(n,{end:1===e.i.length?r[0]*r[1]:r[t]})})),jn.apply(null,[t].concat(n))):t},set:async function(n){var t,r,e,i=this;if(null!=i.i){if(_(i.v,R))t=await Vt(i.v);else{if(!z.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';t=i.ctx[i.v]}r=Xn(t),1===(e=await Promise.all(i.i.map(function(n,t){return Vt(n,{end:1===i.i.length?r[0]*r[1]:r[t]})}))).length&&(e=e.concat(null)),Nn.apply(null,[t].concat(e).concat([n]))}else _(i.v,R)||(i.ctx[i.v]=n);return i},isset:function(){return E(this.v)&&z.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},R.prototype={constructor:R,op:null,arg:null},A.varargout=Ut,A.createCanvas=function(n,t){},A.currentCanvas=function(){},A.createContext=function(){return{ans:null}},A.eval=async function(n,t,r){t=t||A.createContext();var e=Bt(String(n),t,null==r?1:r,1),i=null,u=!1;if(b(e))for(var o=0,f=e.length;o<f;++o)e[o]&&(i=await Gt(e[o]),u=!0);else e&&(i=await Gt(e),u=!0);return u&&(b(i)||g(i)||v(i)||E(i))&&(t.ans=i),u?i:null},A});