/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.0
* https://github.com/foo123/SciLite
*
**/
!function(t,n,r){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=r.call(t)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return r.moduleUri=n.uri,r.call(t)}):n in t||(t[n]=r.call(t)||1)&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function t(){}var z=Math,$=z.PI,e=z.E,a=1/0,o=NaN,B=1e-15,i=Number.MAX_VALUE,G=Number.MIN_VALUE,f=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,A=Object.prototype.hasOwnProperty,m=Object.prototype.toString,g=Number.isNaN,b=Array.isArray||function(n){return"[object Array]"===m.call(n)},T={VERSION:"0.9.0",fn:{},op:null,constant:{pi:$,e:e,eps:B,realmax:i,realmin:G,intmax:f,intmin:p,inf:a,Inf:a,nan:o,NaN:o}},d=T.constant,_=T.fn;function s(n){throw String(n)+": input(s) not supported"}function E(n,t){return n instanceof t}function Y(n){return"function"==typeof n}function J(n){return"[object Object]"===m.call(n)}function I(n){return"string"==typeof n}function H(n){return"number"==typeof n&&!isFinite(n)}function O(n){return"number"==typeof n}function w(n){return Number.isInteger(n)}function u(n){return n instanceof R}function v(n,t){if(O(n)||u(n))return!0;if(!1===t){if(y(n)&&1===n.length)return!0;if(S(n)&&1===n.length&&1===n[0].length)return!0}return!1}function y(n){return b(n)&&v(n[0])}function S(n){return b(n)&&b(n[0])&&v(n[0][0])}function K(n){return!b(n)}function nn(n){return b(n)&&!b(n[0])}function h(n){return b(n)&&b(n[0])}function tn(n){return!u(n)||0===n.im}function rn(n,t){return O(n)?n:u(n)?t?0===n.im&&n.re:n:y(n)?1===n.length&&rn(n[0],t):!!S(n)&&1===n.length&&1===n[0].length&&rn(n[0][0],t)}function M(n,t){for(var r=new Array(n),e=0;e<n;++e)r[e]=Y(t)?t(e,r):t;return r}function k(n,t,r){for(var e,i,u=new Array(n),o=0;o<n;++o)for(u[o]=i=new Array(t),e=0;e<t;++e)i[e]=Y(r)?r(o,e,u):r;return u}function en(n){if(S(n)){if(1===D(n))return n[0];if(1===V(n))return n.map(function(n){return n[0]})}return n}function un(n){var t;return b(n)&&(A.call(n,"$mainRet$")?(t=n.$mainRet$,(n=n.map(un)).$mainRet$=un(t)):n=n.map(un)),n}function on(t,n,r){return!0===t?n:O(n)||r&&u(n)?t(n):b(n)?n.map(function(n){return on(t,n,r)}):n}function fn(n){return I(n)?0<n.length:g(n)?0:O(n)?0!==n:u(n)?fn(n.re)||fn(n.im):b(n)?0<n.length&&n.length===n.filter(fn).length:!0===n}function an(n,r){return v(r)?v(n)?P(n,r):n.filter(function(n){return an(n,r)}).length===n.length:!!b(r)&&(v(n)?an(r,n):n.length===r.length&&n.filter(function(n,t){return an(n,r[t])}).length===r.length)}function R(n,t,r){var e=this;if(!E(e,R))return new R(n,t,r);u(n)?(e.re=n.re,e.im=n.im):(t=t||0,"polar"===r?(e._rho=z.abs(n),e._theta=t,e.re=e._rho*z.cos(e._theta),e.im=e._rho*z.sin(e._theta)):(e.re=n,e.im=t))}function ln(n){return u(n)?n.sign():z.sign(n)}_.clc=t,_.disp=t,_.clear=t,_.help=t,_.who=t,_.whos=t,_.exist=t,_.rowvec=function(n){return nn(n)?[n]:n},_.colvec=function(n){return nn(n)?n.map(function(n){return[n]}):n},T.exist=function(n,t){return J(t)&&I(n)&&A.call(t,n)?1:0},R.prototype={constructor:R,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var t=this;return null==t._rho&&(t._rho=gn(t.re,t.im)),t._rho},norm2:function(){return null==this._rho2&&(this._rho2=z.pow(this.abs(),2)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=0===n.re?(n.im<0?-1:1)*$/2:z.atan(n.im/n.re)),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=n.im?n.div(n.abs()):z.sign(n.re),u(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return O(n)?new R(this.re+n,this.im):new R(this.re+n.re,this.im+n.im)},sub:function(n){return O(n)?new R(this.re-n,this.im):new R(this.re-n.re,this.im-n.im)},mul:function(n){var t,r,e,i=this;return O(n)?new R(i.re?i.re*n:0,i.im?i.im*n:0):(t=i.re,r=n.re,i=i.im,new R((e=t*(r+(n=n.im)))-n*(t+i),e+r*(i-t)))},div:function(n){var t,r,e,i=this;return O(n)?new R(i.re?i.re/n:0,i.im?i.im/n:0):(e=n.norm2(),t=i.re,r=n.re/e,i=i.im,new R((e=t*(r+(n=-n.im/e)))-n*(t+i),e+r*(i-t)))},pow:function(n){var t,r;return O(n)?new R(z.pow(this.abs(),n),this.angle()*n,"polar"):u(n)?(t=this.abs(),r=this.angle(),new R(z.pow(t,n.re),n.im*z.log(t),"polar").mul(new R(z.exp(-n.im*r),r*n.re,"polar"))):void 0},neg:function(){return new R(-this.re,-this.im)},conj:function(){return new R(this.re,-this.im)},inv:function(){var n=this.norm2();return new R(this.re/n,-this.im/n)},toString:function(){var n=this;return null==n._str&&(n._str=hn(n.re)+(n.im<0?" - ":" + ")+hn(z.abs(n.im))+"i"),n._str},valueOf:function(){return this.re}};new R(0,1);var cn=new R(e,0),sn={sign:ln,sqrt:function(n){return n.pow(new R(.5))},exp:function(n){return cn.pow(n)},log:function(n){return new R(z.log(n.abs()),n.angle())},sin:function(n){return new R(z.sin(n.re)*z.cosh(n.im),z.cos(n.re)*z.sinh(n.im))},cos:function(n){return new R(z.cos(n.re)*z.cosh(n.im),-z.sin(n.re)*z.sinh(n.im))},tan:function(n){return sn.sin(n).div(sn.cos(n))},sinh:function(n){return new R(z.sinh(n.re)*z.cos(n.im),z.cosh(n.re)*z.sin(n.im))},cosh:function(n){return new R(z.cosh(n.re)*z.cos(n.im),z.sinh(n.re)*z.sin(n.im))},tanh:function(n){return sn.sinh(n).div(sn.cosh(n))},asin:null,acos:null,atan:null,asinh:null,acosh:null,atanh:null};function hn(n){return g(n)?n="nan":H(n)?n=(n<0?"-":"")+"inf":O(n)?n=w(n)?String(n):n.toFixed(4).replace(/\.0{4}$/,""):u(n)&&(n=String(n)),n}function pn(n){var t;return null==n?n="":I(n)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(n)&&(n="\\text{"+n+"}"):n=g(n)?"\\text{nan}":O(n)?-1<[B,i,G,f,p].indexOf(n)?String(n):hn(n).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):u(n)?String(n).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):S(n)?(t=!1,V(n)>T.MAXPRINTSIZE&&(n=n.map(function(n){return n.slice(0,z.round(T.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-z.round(T.MAXPRINTSIZE/2)))}),t=!0),"\\begin{bmatrix}"+(n=D(n)>T.MAXPRINTSIZE?n.slice(0,z.round(T.MAXPRINTSIZE/2)).concat([M(T.MAXPRINTSIZE,function(n){return z.round(T.MAXPRINTSIZE/2)===n&&t?"\\ddots":"\\vdots"})]).concat(n.slice(1-z.round(T.MAXPRINTSIZE/2))):n).map(function(n){return n.map(pn).join(" & ")}).join(" \\\\ ")+"\\end{bmatrix}"):b(n)?(n=n.length>T.MAXPRINTSIZE?n.slice(0,z.round(T.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(n.slice(1-z.round(T.MAXPRINTSIZE/2))):n).map(pn).join(" \\hskip 1em "):"object"==typeof n||"function"==typeof n?"":String(n),n}function l(n){return b(n)?n.map(l):!u(n)||n.im?n:n.re}function mn(n){return b(n)?n.map(mn):O(n)?new R(n,0):n}function gn(n,t){n=z.abs(n),t=z.abs(t);var r=0;return 0===n?t:0===t?n:t<n?n*z.sqrt(1+(r=t/n)*r):n<t?t*z.sqrt(1+(r=n/t)*r):n*z.SQRT2}function dn(){var n,t,r,e=0,i=0;if(O(dn.z1))return r=dn.z1,dn.z1=null,r;for(;0===e||1===e;)e=z.random();for(;0===i||1===i;)i=z.random();return t=(n=z.sqrt(-2*z.log(e)))*z.cos(2*$*i),r=n*z.sin(2*$*i),dn.z1=r,t}function P(r,e){if(I(r)){if(I(e))return r===e?1:0;if(v(e))return r===String(e)?1:0;if(y(e))return e.map(function(n){return P(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return P(r,e[n][t])})}else if(O(r)){if(I(e))return String(r)===e?1:0;if(O(e))return r===e?1:0;if(u(e))return e.re===r&&0===e.im?1:0;if(y(e))return e.map(function(n){return P(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return P(r,e[n][t])})}else if(u(r)){if(I(e))return String(r)===e?1:0;if(O(e))return r.re===e&&0===r.im?1:0;if(u(e))return r.re===e.re&&r.im===e.im?1:0;if(y(e))return e.map(function(n){return P(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return P(r,e[n][t])})}else if(y(r)){if(I(e)||v(e))return r.map(function(n){return P(n,e)});if(y(e)){if(r.length!==e.length)throw"eq: inputs have incompatible dimensions";return r.map(function(n,t){return P(n,e[t])})}if(S(e)){if(r.length!==V(e))throw"eq: inputs have incompatible dimensions";return k(D(e),V(e),function(n,t){return P(r[t],e[n][t])})}}else if(S(r)){if(I(e)||v(e))return k(D(r),V(r),function(n,t){return P(r[n][t],e)});if(y(e)){if(V(r)!==e.length)throw"eq: inputs have incompatible dimensions";return k(D(r),V(r),function(n,t){return P(r[n][t],e[t])})}if(S(e)){if(D(r)!==D(e)||V(r)!==V(e))throw"eq: inputs have incompatible dimensions";return k(D(r),V(r),function(n,t){return P(r[n][t],e[n][t])})}}return 0}function C(r,e){if(I(r)){if(I(e))return r<e?1:0;if(v(e))return r<String(e)?1:0;if(y(e))return e.map(function(n){return C(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return C(r,e[n][t])})}else if(O(r)){if(I(e))return String(r)<e?1:0;if(O(e))return r<e?1:0;if(u(e))return e.re<r&&0===e.im?1:0;if(y(e))return e.map(function(n){return C(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return C(r,e[n][t])})}else if(u(r)){if(I(e))return String(r)<e?1:0;if(O(e))return r.re<e&&0===r.im?1:0;if(u(e))return 0;if(y(e))return e.map(function(n){return C(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return C(r,e[n][t])})}else if(y(r)){if(I(e)||v(e))return r.map(function(n){return C(n,e)});if(y(e)){if(r.length!==e.length)throw"lt: inputs have incompatible dimensions";return r.map(function(n,t){return C(n,e[t])})}if(S(e)){if(r.length!==V(e))throw"lt: inputs have incompatible dimensions";return k(D(e),V(e),function(n,t){return C(r[t],e[n][t])})}}else if(S(r)){if(I(e)||v(e))return k(D(r),V(r),function(n,t){return C(r[n][t],e)});if(y(e)){if(V(r)!==e.length)throw"lt: inputs have incompatible dimensions";return k(D(r),V(r),function(n,t){return C(r[n][t],e[t])})}if(S(e)){if(D(r)!==D(e)||V(r)!==V(e))throw"lt: inputs have incompatible dimensions";return k(D(r),V(r),function(n,t){return C(r[n][t],e[n][t])})}}return 0}function vn(r,e){if(I(r)){if(I(e))return e<r?1:0;if(v(e))return r>String(e)?1:0;if(y(e))return e.map(function(n){return vn(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return vn(r,e[n][t])})}else if(O(r)){if(I(e))return String(r)>e?1:0;if(O(e))return e<r?1:0;if(u(e))return e.re>r&&0===e.im?1:0;if(y(e))return e.map(function(n){return vn(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return vn(r,e[n][t])})}else if(u(r)){if(I(e))return String(r)>e?1:0;if(O(e))return r.re>e&&0===r.im?1:0;if(u(e))return 0;if(y(e))return e.map(function(n){return vn(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return vn(r,e[n][t])})}else if(y(r)){if(I(e)||v(e))return r.map(function(n){return vn(n,e)});if(y(e)){if(r.length!==e.length)throw"gt: inputs have incompatible dimensions";return r.map(function(n,t){return vn(n,e[t])})}if(S(e)){if(r.length!==V(e))throw"gt: inputs have incompatible dimensions";return k(D(e),V(e),function(n,t){return vn(r[t],e[n][t])})}}else if(S(r)){if(I(e)||v(e))return k(D(r),V(r),function(n,t){return vn(r[n][t],e)});if(y(e)){if(V(r)!==e.length)throw"gt: inputs have incompatible dimensions";return k(D(r),V(r),function(n,t){return vn(r[n][t],e[t])})}if(S(e)){if(D(r)!==D(e)||V(r)!==V(e))throw"gt: inputs have incompatible dimensions";return k(D(r),V(r),function(n,t){return vn(r[n][t],e[n][t])})}}return 0}function yn(r,e){if(I(r)){if(I(e))return r<=e?1:0;if(v(e))return r<=String(e)?1:0;if(y(e))return e.map(function(n){return yn(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return yn(r,e[n][t])})}else if(O(r)){if(I(e))return String(r)<=e?1:0;if(O(e))return r<=e?1:0;if(u(e))return e.re<=r&&0===e.im?1:0;if(y(e))return e.map(function(n){return yn(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return yn(r,e[n][t])})}else if(u(r)){if(I(e))return String(r)<=e?1:0;if(O(e))return r.re<=e&&0===r.im?1:0;if(u(e))return P(r,e)?1:0;if(y(e))return e.map(function(n){return yn(r,n)});if(S(e))return k(D(e),V(e),function(n,t){return yn(r,e[n][t])})}else if(y(r)){if(I(e)||v(e))return r.map(function(n){return yn(n,e)});if(y(e)){if(r.length!==e.length)throw"le: inputs have incompatible dimensions";return r.map(function(n,t){return yn(n,e[t])})}if(S(e)){if(r.length!==V(e))throw"le: inputs have incompatible dimensions";return k(D(e),V(e),function(n,t){return yn(r[t],e[n][t])})}}else if(S(r)){if(I(e)||v(e))return k(D(r),V(r),function(n,t){return yn(r[n][t],e)});if(y(e)){if(V(r)!==e.length)throw"le: inputs have incompatible dimensions";return k(D(r),V(r),function(n,t){return yn(r[n][t],e[t])})}if(S(e)){if(D(r)!==D(e)||V(r)!==V(e))throw"le: inputs have incompatible dimensions";return k(D(r),V(r),function(n,t){return yn(r[n][t],e[n][t])})}}return 0}function X(n,t){return O(n)&&O(t)?n+t:u(n)&&v(t)?n.add(t):u(t)&&v(n)?t.add(n):o}function Z(n,t){return O(n)&&O(t)?n-t:u(n)&&v(t)?n.sub(t):u(t)&&v(n)?t.neg().add(n):o}function W(n,t){return O(n)&&O(t)?n*t:u(n)&&v(t)?n.mul(t):u(t)&&v(n)?t.mul(n):o}function F(n,t){return O(n)&&O(t)?n/t:u(n)&&v(t)?n.div(t):u(t)&&v(n)?t.inv().mul(n):o}function wn(n,t){return O(n)&&O(t)?z.pow(n,t):u(n)&&v(t)?n.pow(t):u(t)&&v(n)?new R(n,0).pow(t):o}function xn(n){return O(n)?-n:u(n)?n.neg():o}function Q(n){return O(n)?n:u(n)?n.conj():o}function bn(n){return O(n)?0===n?a:1/n:u(n)?0===n.abs()?new R(a,n.im<0?a:-a):n.inv():o}function U(n){return O(n)?z.abs(n):u(n)?n.abs():o}function Sn(n){return O(n)?n<0?$:0:u(n)?n.angle():o}function kn(t,e){if(I(t)&&I(e))return t+e;if(v(t)&&v(e))return X(t,e);if(S(t)&&S(e)){if(D(t)===D(e)&&V(t)===V(e))return t.map(function(n,r){return n.map(function(n,t){return kn(n,e[r][t])})});throw"add: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return kn(n,e[t])});throw"add: vector dimensions do not match"}return b(t)?t.map(function(n){return kn(n,e)}):b(e)?e.map(function(n){return kn(t,n)}):t}function An(t,e){if(v(t)&&v(e))return Z(t,e);if(S(t)&&S(e)){if(D(t)===D(e)&&V(t)===V(e))return t.map(function(n,r){return n.map(function(n,t){return An(n,e[r][t])})});throw"sub: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return An(n,e[t])});throw"sub: vector dimensions do not match"}return b(t)?t.map(function(n){return An(n,e)}):b(e)?e.map(function(n){return An(t,n)}):t}function Tn(t,e){if(v(t)&&v(e))return W(t,e);if(S(t)&&S(e)){if(D(t)===D(e)&&V(t)===V(e))return t.map(function(n,r){return n.map(function(n,t){return Tn(n,e[r][t])})});throw"dotmul: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return Tn(n,e[t])});throw"dotmul: vector dimensions do not match"}return b(t)?t.map(function(n){return Tn(n,e)}):b(e)?e.map(function(n){return Tn(t,n)}):t}function c(t,e){if(v(t)&&v(e))return F(t,e);if(S(t)&&S(e)){if(D(t)===D(e)&&V(t)===V(e))return t.map(function(n,r){return n.map(function(n,t){return c(n,e[r][t])})});throw"dotdiv: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return c(n,e[t])});throw"dotdiv: vector dimensions do not match"}return b(t)?t.map(function(n){return c(n,e)}):b(e)?e.map(function(n){return c(t,n)}):t}function _n(t,e){if(v(t)&&v(e))return wn(t,e);if(S(t)&&S(e)){if(D(t)===D(e)&&V(t)===V(e))return t.map(function(n,r){return n.map(function(n,t){return _n(n,e[r][t])})});throw"dotpow: matrix dimensions do not match"}if(y(t)&&y(e)){if(t.length===e.length)return t.map(function(n,t){return _n(n,e[t])});throw"dotpow: vector dimensions do not match"}return b(t)?t.map(function(n){return _n(n,e)}):b(e)?e.map(function(n){return _n(t,n)}):t}function L(i,u){if(v(i)&&v(u))return W(i,u);if(S(i)&&S(u)){if(V(i)===D(u))return n=D(i),t=V(u),o=D(u),k(n,t,function(n,t){for(var r=0,e=0;e<o;++e)r=X(r,W(i[n][e],u[e][t]));return r});throw"mul: matrix-matrix dimensions do not match"}if(y(i)&&S(u)){if(i.length===D(u))return t=V(u),o=i.length,k(n=1,t,function(n,t){for(var r=0,e=0;e<o;++e)r=X(r,W(i[e],u[e][t]));return r});throw"mul: vector-matrix dimensions do not match"}if(S(i)&&y(u)){var o;if(V(i)===u.length)return n=D(i),o=u.length,k(n,t=1,function(n,t){for(var r=0,e=0;e<o;++e)r=X(r,W(i[n][e],u[e]));return r});throw"mul: matrix-vector dimensions do not match"}var n,t;return y(i)&&y(u)?k(n=i.length,t=u.length,function(n,t){return W(i[n],u[t])}):b(i)?i.map(function(n){return L(n,u)}):b(u)?u.map(function(n){return L(i,n)}):i}function En(n,t){if(v(n)&&v(t))return wn(n,t);if(S(n)&&D(n)===V(n)&&w(t)){if(t<0&&(t=-t,!(n=at(n))||!n.length))throw"pow: no inverse";if(0===t)return Wn(D(n));if(1===t)return n;if(2===t)return L(n,n);for(var r=Wn(D(n));0!==t;)1&t&&(r=L(r,n)),0<(t>>=1)&&(n=L(n,n));return r}return n}function In(n){return on(function(n){return u(n)?n.re:n},n,!0)}function Rn(n){return on(function(n){return u(n)?n.im:0},n,!0)}function Pn(n){return on(Q,n,!0)}function Cn(n){return on(U,n,!0)}function Ln(e,n=":",r=null){if(nn(e)){if(y(n)&&n.length===e.length&&rt(n,function(n){return 0===n||1===n}))return o=1===(o=n.reduce(function(n,t,r){return 1===t&&n.push(e[r]),n},[])).length?o[0]:o;if(":"===(n=v(n)?rn(n,!0):n)||w(n)||y(n))return t=e.length,1===(o=(n=w(n=":"===n?Vn(1,t):n)?[n]:n).map(function(n){if(n<1&&(n+=t),n<1||t<n)throw"get: index out of bounds";return e[n-1]})).length?o[0]:o;throw"get: invalid range"}if(h(e)){var i=D(e),u=V(e),t=i*u;if(null==r&&S(n)&&D(n)===i&&V(n)===u&&rt(n,function(n){return 0===n||1===n})){for(var o=[],f=0;f<u;++f)for(var a=0;a<i;++a)1===n[a][f]&&o.push(e[a][f]);return o=1===o.length?o[0]:o}if(v(n)&&(n=rn(n,!0)),v(r)&&(r=rn(r,!0)),":"===n||w(n)||y(n)){if(w(n=":"===n?Vn(1,i):n)&&(n=[n]),null==r)return o=1===(o=n.map(function(n){if(n<1&&(n+=t),n<1||t<n)throw"get: index out of bounds";return e[(n-1)%i][z.floor((n-1)/i)]})).length?o[0]:o;if(":"===r||w(r)||y(r))return w(r=":"===r?Vn(1,u):r)&&(r=[r]),o=1===(o=n.map(function(t){if(t<1&&(t+=i),t<1||i<t)throw"get: index out of bounds";return r.map(function(n){if(n<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[t-1][n-1]})})).length&&1===o[0].length?o[0][0]:o}throw"get: invalid range"}return e}function jn(i,n=":",u=null,o=null){if(nn(i)){if(y(n)&&n.length===i.length&&rt(n,function(n){return 0===n||1===n})){if(K(o))return n.forEach(function(n,t){1===n&&(i[t]=o)}),i;if(b(o))return e=0,n.forEach(function(n,t){if(1===n){if(e>=o.length)throw"set: index out of bounds";i[t]=o[e++]}}),i}if(":"===(n=v(n)?rn(n,!0):n)||w(n)||y(n)){var r=i.length;if(w(n=":"===n?Vn(1,r):n)&&(n=[n]),K(o))return n.forEach(function(n){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[n-1]=o}),i;if(b(o)&&o.length>=n.length)return n.forEach(function(n,t){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[n-1]=o[t]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(h(i)){var f=D(i),a=V(i),r=f*a;if(S(n)&&D(n)===f&&V(n)===a&&rt(n,function(n){return 0===n||1===n})){if(K(o))return n.forEach(function(n,r){n.forEach(function(n,t){1===n&&(i[r][t]=o)})}),i;if(b(o)){for(var e=0,t=0;t<a;++t)for(var l=0;l<f;++l)if(1===n[l][t]){if(e>=o.length)throw"set: index out of bounds";i[l][t]=o[e++]}return i}}if(v(n)&&(n=rn(n,!0)),v(u)&&(u=rn(u,!0)),":"===n||w(n)||y(n)){if(null==u){if(w(n=":"===n?Vn(1,r):n)&&(n=[n]),K(o))return n.forEach(function(n){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[(n-1)%f][z.floor((n-1)/f)]=o}),i;if(nn(o)&&o.length>=n.length)return n.forEach(function(n,t){if(n<1&&(n+=r),n<1||r<n)throw"set: index out of bounds";i[(n-1)%f][z.floor((n-1)/f)]=o[t]}),i}else if(":"===u||w(u)||y(u)){if(w(n=":"===n?Vn(1,f):n)&&(n=[n]),w(u=":"===u?Vn(1,a):u)&&(u=[u]),K(o))return n.forEach(function(t){if(t<1&&(t+=f),t<1||f<t)throw"set: index out of bounds";u.forEach(function(n){if(n<1&&(n+=a),n<1||a<n)throw"set: index out of bounds";i[t-1][n-1]=o})}),i;if(h(o)&&o.length>=n.length&&o[0].length>=u.length)return n.forEach(function(r,e){if(r<1&&(r+=f),r<1||f<r)throw"set: index out of bounds";u.forEach(function(n,t){if(n<1&&(n+=a),n<1||a<n)throw"set: index out of bounds";i[r-1][n-1]=o[e][t]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function Nn(n,t,r){return"horz"===n&&h(t)&&h(r)&&D(t)===D(r)?t.map(function(n,t){return n.concat(r[t])}):"vert"===n&&h(t)&&h(r)&&V(t)===V(r)?t.concat(r):void s("cat")}function qn(r,n){var e,i;return K(r)?r:nn(r)?r.slice().reverse():h(r)?(e=D(r),i=V(r),1===(n=null==n?1:n)?k(e,i,function(n,t){return r[e-1-n][t]}):2===n?k(e,i,function(n,t){return r[n][i-1-t]}):r):void s("flip")}function $n(n,t){return In(n)-In(t)||Rn(n)-Rn(t)}function zn(n,t){return U(n)-U(t)||Sn(n)-Sn(t)}function On(t,r,e,i,n){var u;if(K(t))return t;if(y(t))return null==i&&(i=tn(t)?$n:zn),u=t.map(function(n,t){return{v:n,i:t}}).sort("descend"===e?function(n,t){return i(t.v,n.v)||n.i-t.i}:function(n,t){return i(n.v,t.v)||n.i-t.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(S(t)){if(1===r)return n?(u=M(V(t),function(n){n=N(t,n);return On(n,r,e,null==i?tn(n)?$n:zn:i,!0)}),[k(D(t),V(t),function(n,t){return u[t][0][n]}),k(D(t),V(t),function(n,t){return u[t][1][n]})]):(u=M(V(t),function(n){n=N(t,n);return On(n,r,e,null==i?tn(n)?$n:zn:i,!1)}),k(D(t),V(t),function(n,t){return u[t][n]}));if(2===r)return n?(u=M(D(t),function(n){n=t[n];return On(n,r,e,null==i?tn(n)?$n:zn:i,!0)}),[k(D(t),V(t),function(n,t){return u[n][0][t]}),k(D(t),V(t),function(n,t){return u[n][1][t]})]):(u=M(D(t),function(n){n=t[n];return On(n,r,e,null==i?tn(n)?$n:zn:i,!1)}),k(D(t),V(t),function(n,t){return u[n][t]}))}s("sort")}function Mn(t){var n=[].slice.call(arguments,1);return b(n[0])&&(n=n[0]),K(t)?n.length?n.map(function(n){return[1,1][n-1]}):[1,1]:nn(t)?n.length?n.map(function(n){return[1,t.length][n-1]}):[1,t.length]:h(t)?n.length?n.map(function(n){return[D(t),V(t)][n-1]}):[D(t),V(t)]:[]}function Xn(n){return b(n)?z.max.apply(z,Mn(n)):null==n?0:1}function Zn(n,t){return y(n=null==n?1:n)&&(t=n[1],n=n[0]),k(n,t=null==t?n:t,0)}function Wn(n){return k(n=rn(n=null==n?1:n,!0),n,function(n,t){return n===t?1:0})}function Fn(r,i){return i=i||0,K(r)?[[r]]:nn(r)?k(r.length,r.length,function(n,t){return i===n-t?r[n]:0}):h(r)?r.reduce(function(n,t,e){return t.reduce(function(n,t,r){return i===e-r&&n.push(t),n},n)},[]):void s("diag")}function Qn(t,e,i){if(i=!0===i,v(t)&&v(e))return W(t,i?e:Q(e));if(y(t)&&y(e)){if(t.length===e.length)return t.reduce(function(n,t,r){return X(n,W(t,i?e[r]:Q(e[r])))},0)}else if(S(t)&&S(e)&&D(t)===D(e)&&V(t)===V(e))return M(V(t),function(n){return Qn(N(t,n),N(e,n),i)});return 0}function Un(r){return h(r)?k(V(r),D(r),function(n,t){return r[t][n]}):r}function Dn(r){return h(r)?k(V(r),D(r),function(n,t){return v(r[t][n])?Q(r[t][n]):r[t][n]}):nn(r)?r.map(function(n){return v(n)?Q(n):n}):v(r)?Q(r):r}function Vn(n,t,r){if(1===arguments.length){if(h(n)){for(var e,i=D(n),u=V(n),o=new Array(u*i),f=0,a=0;a<u;++a)for(e=0;e<i;++e)o[f++]=n[e][a];return o}return n}if(null!=r&&null!=t||(null!=t?(r=t,t=1):(r=n,n=t=1)),n=rn(n,!0),t=rn(t,!0),r=rn(r,!0),o=[],0<t)for(;n<=r;n+=t)o.push(n);else if(t<0)for(;r<=n;n+=t)o.push(n);return o}function j(t){return v(t)?t:y(t)?t.reduce(X,0):S(t)?M(V(t),function(n){return j(N(t,n))}):0}function Bn(t){return v(t)?t:y(t)?t.reduce(W,1):S(t)?M(V(t),function(n){return Bn(N(t,n))}):0}function Gn(t){return v(t)?t:y(t)?z.min.apply(null,t):S(t)?M(V(t),function(n){return Gn(N(t,n))}):0}function Yn(t){return v(t)?t:y(t)?z.max.apply(null,t):S(t)?M(V(t),function(n){return Yn(N(t,n))}):0}function Jn(n,t){if(H(t=null==t?2:t)){if(v(n))return U(n);if(y(n))return(t<0?Gn:Yn)(Cn(n));if(S(n)&&0<t)return Yn(j(Cn(Un(n))))}else if(O(t)){if(1===t){if(v(n))return U(n);if(y(n))return j(Cn(n));if(S(n))return Yn(j(Cn(n)))}else if(2===t){if(v(n))return U(n);if(y(n))return z.sqrt(j(n.map(function(n){return W(n,Q(n))})))}else if(0<t){if(v(n))return U(n);if(y(n))return z.pow(j(n.map(function(n){return wn(U(n),t)})),1/t)}}else if("fro"===t&&S(n))return z.sqrt(gt(L(Dn(n),n)));s("norm")}function Hn(t,n){if(v(t))return t;if(y(t))return t.length?F(j(t),t.length):o;if(S(t)){if(1===(n=null==n?1:n))return M(V(t),function(n){return Hn(N(t,n))});if(2===n)return M(D(t),function(n){return Hn(t[n])})}s("mean")}function Kn(t,n,r){if(n=n||0,v(t))return 0;if(y(t))return 0===t.length?o:1===t.length?0:z.sqrt(F(j(En(Cn(An(t,Hn(t))),2)),1===n?t.length:t.length-1));if(S(t)){if(1===(r=null==r?1:r))return M(V(t),function(n){return Kn(N(t,n))});if(2===r)return M(D(t),function(n){return Kn(t[n])})}s("std")}function nt(t,r,e,i){var u;if(v(t))return t;if(y(t)){if("reverse"===(e=null==e?"forward":e))return t.slice().reverse().map(function(n,t){return u=0===t?n:r(u,n),acc}).reverse();if("forward"===e)return t.map(function(n,t){return u=0===t?n:r(u,n)})}else if(S(t)){if(1===(i=null==i?1:i))return M(V(t),function(n){return nt(N(t,n),r,e,i)});if(2===i)return M(D(t),function(n){return nt(t[n],r,e,i)})}return!1}function tt(t,r,e,i,u){var o;if(y(t))return M(o=t.length,function(n){return r(t.slice(z.max(0,n-e),z.min(o-1,n+i)+1))});if(S(t)){if(1===(u=null==u?1:u))return M(V(t),function(n){return tt(N(t,n),r,e,i,u)});if(2===u)return M(D(t),function(n){return tt(t[n],r,e,i,u)})}return!1}function rt(n,t){if(v(n))return t(n,1,1)?1:0;if(y(n)){for(var r=0,e=n.length;r<e;++r)if(!t(n[r],r+1,1))return 0;return 1}if(S(n)){for(var r=0,i=D(n),u=V(n);r<i;++r)for(var o=0;o<u;++o)if(!t(n[r][o],r+1,o+1))return 0;return 1}return 0}function D(n){return n.length}function V(n){return n[0].length}function N(t,r){return M(t.length,function(n){return t[n][r]})}function et(n,t,r){var e;t!==r&&(e=n[t],n[t]=n[r],n[r]=e)}function it(n,t,r,e,i,u){var o,f=n[0].length;for(null==e&&(e=1),null==i&&(i=1),o=u||0;o<f;++o)n[t][o]=X(W(i,n[t][o]),W(e,n[r][o]))}function ut(r,e,i,n,t){var u=D(r),o=V(r);return u&&o?b(e)&&b(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<o}),k(e.length,i.length,function(n,t){return r[e[n]][i[t]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=o),(n=null==n?u-1:n)<0&&(n+=u),(t=null==t?o-1:t)<0&&(t+=o),e=z.max(0,z.min(u-1,e)),n=z.max(0,z.min(u-1,n)),i=z.max(0,z.min(o-1,i)),t=z.max(0,z.min(o-1,t)),e<=n&&i<=t?k(n-e+1,t-i+1,function(n,t){return r[e+n][i+t]}):[]):[]}function ot(r,e,n){var i=D(r),u=V(r),o=D(e),f=V(e);return"vert"===(n=n||"horz")?k(i+o,z.max(u,f),function(n,t){return u<=t?n<i?0:e[n-i][t]:f<=t?n<i?r[n][t]:0:(n<i?r[n]:e[n-i])[t]}):k(z.max(i,o),u+f,function(n,t){return i<=n?t<u?0:e[n][t-u]:o<=n?t<u?r[n][t]:0:t<u?r[n][t]:e[n][t-u]})}function ft(n,t){return O(t)&&0<t?v(n)?yn(U(n),t)?0:n:b(n)?n.map(function(n){return ft(n,t)}):n:n}function at(n){var t,r,e;return v(n)?bn(n):S(n)&&D(n)===V(n)?1===(r=t=D(n))?[[bn(n[0][0])]]:P((e=st(n,!0))[0][t-1][r-1],0)?[]:e[3].map(function(n,t){return n.map(function(n){return F(n,e[0][t][t])})}):[]}function lt(r){var n,e,t,i,u,o;return v(r)?bn(r):S(r)?(n=D(r),t=V(r),an(r,0)?Un(r):1===n&&1===t?[[bn(r[0][0])]]:1===n||1===t?(u=r.reduce(function(n,t){return X(n,W(t,Q(t)))},0),k(t,n,function(n,t){return F(Q(r[t][n]),u)})):(o=(e=st(r,!0))[1].length)===t?n===t?e[3].map(function(n,t){return n.map(function(n){return F(n,e[0][t][t])})}):L(at(L(i=Dn(r),r)),i):o===n?L(i=Dn(r),at(L(r,i))):(t=function(n,e){var t,r,i=D(n),u=V(n);e=e||st(n,!0);return t=e[1],r=t.length,n=ut(n,M(i,function(n){return n}),M(r,function(n){return t[n][1]})),i=ut(e[0],0,0,r-1,u-1).map(function(n,r){return n.map(function(n,t){for(t=r;t+1<u&&P(e[0][r][t],0);)++t;return F(n,e[0][r][t])})}),[n,i]}(r,e),u=L(at(L(i=Dn(u=t[0]),u)),i),o=L(i=Dn(o=t[1]),at(L(o,i))),L(o,u))):[]}function ct(n,t,r){var e,i,u,o,f,a,l,c,s,h,p,m,g,d,v=D(n),y=V(n),w=y,x=0;for(b(r)&&(w=z.min(w,r[1])),g=ot(n,Wn(v)),e=new Array(w),i=1,d=function(n,t){t=t||0;for(var r=x-1;0<=r;--r)if(n===e[r][t])return r;return-1},u=l=0;u<v&&!(w<=l);++u){for(o=u;P(U(g[o][l]),0);)if(v<=++o&&(o=u,w<=++l)){l=-1;break}if(-1===l)break;for(c=-1,h=null,m=0,o=f=o;o<v;++o)P(p=U(g[o][l]),0)?++m:null!=h&&!C(p,h)||(h=p,c=o);for(;;){if(-1===c)break;if(v-f===m+1){for(u!==c&&(et(g,u,c),i=xn(i)),C(g[u][l],0)&&(it(g,u,u,0,-1,l),i=xn(i)),o=c,f=u;0<=o&&-1!==(a=d(o));)o=f-=x-a;e[x++]=[o,l],i=u<w?W(i,g[u][u]):0;break}for(m=0,s=c,o=f;o<v;++o)o!==s&&(it(g,o,s,xn(F(g[o][l],g[s][l])),1,l),P(p=U(g[o][l]),0)?++m:C(p,h)&&(h=p,c=o))}++l}return x<w&&(i=0),r=ut(g,0,y,v-1,v+y-1),g=ut(g,0,0,v-1,y-1),e.length>x&&(e.length=x),t?[g,e,i,r]:g}function st(n,t,r){var e,i,u,o,f,a,l=D(n),c=V(n),s=c;for(b(r)&&z.min(s,r[1]),a=ot((s=ct(n,!0,r))[0],s[3]),e=s[1],n=s[2],i=e.length,o=0;o<i;++o)for(u=e[o][1],f=0;f<o;++f)P(a[f][u],0)||(it(a,f,o,xn(a[f][u]),a[o][u]),P(a[f][e[f][1]],1))||it(a,f,f,0,bn(a[f][e[f][1]]),e[f][1]);return P(a[i-1][e[i-1][1]],1)||it(a,i-1,i-1,0,bn(a[i-1][e[i-1][1]]),e[i-1][1]),r=ut(a,0,c,l-1,l+c-1),a=ut(a,0,0,l-1,c-1),t?[a,e,n,r]:a}function ht(o){return k(V(o),D(o),function(n,t){return e=t,i=n,t=!0,n=D(r=o),u=V(r),n!==u?null:n<=1?0:(i=+(i||0),(e=+(e||0))<0||n<=e||i<0||u<=i?null:(n=mt(k(n-1,u-1,function(n,t){return e<=n&&++n,i<=t&&++t,r[n][t]})),!0===t&&e+i&1?xn(n):n));var r,e,i,u})}function pt(n,t,r){var e,i,u,o=D(n),f=V(n);if(!1===r||o===f){for(e=z.min(o,f),i=0;i<e;++i){if("lower"===t||"diagonal"===t)for(u=i+1;u<e;++u)if(!P(n[i][u],0))return;if("upper"===t||"diagonal"===t)for(u=0;u<i;++u)if(!P(n[i][u],0))return}if(f<o){for(i=e;i<o;++i)for(u=0;u<f;++u)if(!P(n[i][u],0))return}else if(o<f)for(u=e;u<f;++u)for(i=0;i<o;++i)if(!P(n[i][u],0))return;return 1}}function mt(e,n){S(e=v(e)?[[e]]:e)||s("det");var t=D(e);return t!==V(e)?0:1===t?e[0][0]:pt(e,"lower")||pt(e,"upper")?e.reduce(function(n,t,r){return W(n,e[r][r])},1):!0===n?function n(t,r){var e,i,u,o,f,a,l,c,s,h,p,m,g,d;function v(r,n,e,i){return k(n-1,n-1,function(n,t){return e<=n&&++n,i<=t&&++t,r[n][t]})}if(1===r)f=t[0][0];else if(2===r)a=t[0][0],l=t[0][1],c=t[1][0],f=Z(W(a,s=t[1][1]),W(l,c));else if(3===r)a=t[0][0],l=t[0][1],c=t[0][2],s=t[1][0],h=t[1][1],p=t[1][2],m=t[2][0],g=t[2][1],d=t[2][2],f=Z(Z(Z(X(X(W(W(a,h),d),W(W(l,p),m)),W(W(c,s),g)),W(W(c,h),m)),W(W(l,s),d)),W(W(a,p),g));else{for(e=u=i=0;e<r;++e)P(t[0][e],0)&&++i,P(t[e][0],0)&&++u;if(o=1,f=0,i<u)for(e=0;e<r;++e)P(t[e][0],0)||(f=X(f,W(t[e][0],W(o,n(v(t,r,e,0),r-1))))),o=1===o?-1:1;else for(e=0;e<r;++e)P(t[0][e],0)||(f=X(f,W(t[0][e],W(o,n(v(t,r,0,e),r-1))))),o=1===o?-1:1}return f}(e,t):ct(e,!0)[2]}function gt(e){return v(e)?e:S(e)?e.reduce(function(n,t,r){return X(n,r<t.length?e[r][r]:0)},0):0}function dt(n){var t,r,e,i,u=D(n),o=new Array(u),f=new Array(u),a=M(u,0);for(n=un(n),i=0;i<u;++i)t=(e=function(n,t){var r,e,i,u,o=Dn(n),f=0,a=M(t,function(){return new R(z.random()||.1,0)});for(a=c(a,Jn(a)),u=c(u=M(t,function(){return new R(z.random()||.1,0)}),Jn(u)),r=1;r<=200&&(e=f,a=en(L(n,i=a)),u=en(L(o,u)),f=Qn(a,i),a=c(a,a[0].sign()),u=c(u,u[0].sign()),a=c(a,Jn(a)),u=c(u,Jn(u)),!(z.abs(In(f)-In(e))<1e-10&&z.abs(Rn(f)-Rn(e))<1e-10));++r);return[f,a,u]}(n,u))[0],r=e[1],e=e[2],n=An(n,L(L(F(a[i]=t,Qn(o[i]=r,f[i]=e,!0)),r),e));return[l(Un(o)),l(a),l(Un(f))]}function vt(n,t){for(var r,e,i,u,o,f,a=D(n),l=V(n),c=!1,s=un(n),h=Wn(a),p=M(a,0),m=Wn(a),g=1,d=0;d<a-1;++d){if(P(s[d][d],0)){for(i=d+1,u=!0;i<a&&u;)P(s[i][d],0)?++i:u=!1;if(a<=i){c=!0;break}et(s,d,i),et(m,d,i)}for(o=s[d][d],h[d][d]=o,p[d]=W(g,o),r=d+1;r<a;++r){for(f=s[r][d],h[r][d]=f,e=d+1;e<l;++e)s[r][e]=F(Z(W(o,s[r][e]),W(s[d][e],f)),g);s[r][d]=0}g=s[d][d]}if(!c)return p[a-1]=g,t?[L(h,Fn(p.map(bn))),s,m]:[p,h,s,m]}function yt(n,r,e,t,i){t=t,o=P(i=i,0)?(u=1,0):P(t,0)?(u=0,ln(Q(i))||1):(o=ln(t)||1,u=F(t=U(t),t=gn(t,U(i))),F(W(o,Q(i)),t));var u,o,i=[u,o],f=i[0],a=i[1];return k(n,n,function(n,t){return n===t?r===n||e===t?f:1:r===n&&e===t||r===t&&e===n?n<t?xn(a):a:0})}function wt(n){for(var t,r,e=D(n),i=V(n),u=Wn(e),o=n,f=0;f<i;++f)for(t=e-1;f+1<=t;--t)o=L(Dn(r=yt(e,t-1,t,o[t-1][f],o[t][f])),o),u=L(u,r);return[u,o]}function xt(n,t){var r=D(n);if(null==t){var e,i=Wn(r),u=n;for(o=1;o<=r-2;++o)for(f=r;o+2<=f;--f)i=L(i,e=yt(r,f-1-1,f-1,u[f-1-1][o-1],u[f-1][o-1])),u=L(Dn(e),L(u,e));return[i,u]}var o,f,a,l,c=Dn(i=wt(t)[0]),s=Wn(r),h=L(c,n),p=L(c,t);for(o=1;o<=r-2;++o)for(f=r;o+2<=f;--f)a=Dn(l=yt(r,f-1-1,f-1,h[f-1-1][o-1],h[f-1][o-1])),i=L(i,l),h=L(a,h),p=L(a,p),s=L(s,l=yt(r,f-1-1,f-1,xn(p[f-1][f-1]),p[f-1][f-1-1])),h=L(h,l),p=L(p,l);return[h,p,i,s]}function bt(n,t,r){if(v(n)&&v(t))return F(t,n);if(!S(n))return[];if(!y(t)&&!S(t))return[];var e,i=V(n);if(D(n)!==i)return[];if(e=y(t)?(h=t.length,1):(h=D(t),V(t)),i!==h)return[];var u,o,f,a,l,c,s,h=ct(Un(n),!0);if(h[1].length!==i)return[];if(u=Un(h[3]),o=Un(h[0]),y(t)){for(f=M(i,0),a=0;a<i;++a){if(P(o[a][a],0))return[];for(l=s=0;l<a;++l)s=X(s,W(o[a][l],f[l]));f[a]=F(Z(t[a],s),o[a][a])}return M(i,function(t){return M(i,function(n){return W(f[n],u[t][n])}).reduce(X,0)})}for(f=Zn(i,e),a=0;a<i;++a){if(P(o[a][a],0))return[];for(c=0;c<e;++c){for(l=s=0;l<a;++l)s=X(s,W(o[a][l],f[l][c]));f[a][c]=F(Z(t[a][c],s),o[a][a])}}return k(i,e,function(t,r){return M(i,function(n){return W(f[n][r],u[t][n])}).reduce(X,0)})}function St(n,t){if(!n.length)return 0;t=t||0;for(var r=n.length,e=0,i=n[0];e+1<r;)++e,i=X(W(i,t),n[e]);return i}function kt(n,t){for(var r=n.length-1,e=t.length-1,i=[];0<=r&&0<=e;)i.unshift(X(n[r--],t[e--]));for(;0<=r;)i.unshift(n[r--]);for(;0<=e;)i.unshift(t[e--]);return i}function At(n,t){var r,e,i,u,o,f=n.length,a=t.length,l=f+a-1;if(!f||!a)return[];for(o=new Array(l),f<a&&(u=n,f=(n=t).length,a=(t=u).length),r=0;r<l;++r)for(e=o[r]=0;e<a;++e)0<=(i=r-e)&&i<f&&(o[r]=X(o[r],W(n[i],t[e])));return o}_.complex=R,["sign","sqrt","exp","log","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(t){_[t]=sn[t]?function(n){return on(function(n){return(u(n)?sn:z)[t](n)},n,!0)}:function(n){return on(z[t],n,!1)}}),T.MAXPRINTSIZE=a,T.tex=function(n){return b(n)?n=n.length?A.call(n,"$mainRet$")?"\\["+n.map(pn).join("\\]\n\\[")+"\\]":b(n[0])?b(n[0][0])||!b(n[1])||n[0].length!==n[1].length?"\\["+n.map(pn).join("\\]\n\\[")+"\\]":"\\["+pn(n)+"\\]":"\\["+(n=n.length>T.MAXPRINTSIZE?n.slice(0,z.round(T.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-z.round(T.MAXPRINTSIZE/2))):n).map(pn).join("\\]\n\\[")+"\\]":"":(n=pn(n)).length&&(n="\\["+n+"\\]"),n},_.times=Tn,_.real=In,_.imag=Rn,_.conj=Pn,_.abs=Cn,_.angle=function(n){return on(Sn,n,!0)},_.ceil=function(n){return on(function(n){return u(n)?new R(z.ceil(n.re),z.ceil(n.im)):z.ceil(n)},n,!0)},_.floor=function(n){return on(function(n){return u(n)?new R(z.floor(n.re),z.floor(n.im)):z.floor(n)},n,!0)},_.round=function(n){return on(function(n){return u(n)?new R(z.round(n.re),z.round(n.im)):z.round(n)},n,!0)},_.mod=function(n,r){return P(r=rn(r||0),0)?n:on(function(n){var t;return w(n)?((t=n%r)<0&&0<r&&(t+=r),t):n},n,!0)},_.bitshift=function(n,t){return on(function(n){return w(n)?t<0?n>>-t:n<<t:n},n,!0)},_.bitand=function r(t,e){if(w(t)){if(w(e))return t&e;if(b(e))return e.map(function(n){return r(t,n)})}else if(b(t)){if(w(e))return t.map(function(n){return r(n,e)});if(b(e)&&t.length===e.length)return t.map(function(n,t){return r(n,e[t])})}return 0},_.bitor=function r(t,e){if(w(t)){if(w(e))return t|e;if(b(e))return e.map(function(n){return r(t,n)})}else if(b(t)){if(w(e))return t.map(function(n){return r(n,e)});if(b(e)&&t.length===e.length)return t.map(function(n,t){return r(n,e[t])})}return 0},_.bitxor=function r(t,e){if(w(t)){if(w(e))return t^e;if(b(e))return e.map(function(n){return r(t,n)})}else if(b(t)){if(w(e))return t.map(function(n){return r(n,e)});if(b(e)&&t.length===e.length)return t.map(function(n,t){return r(n,e[t])})}return 0},_.bin2dec=function n(t){return b(t)?t.map(n):I(t)?parseInt(t,2):t},_.dec2bin=function n(t){return b(t)?t.map(n):O(t)?t.toString(2):t},_.hex2dec=function n(t){return b(t)?t.map(n):I(t)?parseInt(t,16):t},_.dec2hex=function n(t){return b(t)?t.map(n):O(t)?t.toString(16):t},_.tolower=function n(t){return b(t)?t.map(n):I(t)?t.toLowerCase():t},_.toupper=function n(t){return b(t)?t.map(n):I(t)?t.toUpperCase():t},T.get=Ln,T.set=jn,_.sub2ind=function(n,t,r){return y(t)&&(r=t[1],t=t[0]),1===n.length?t:t-1+n[0]*(r-1)+1},_.ind2sub=function(n,t){return 1===n.length?[t,1]:[(t-1)%n[0]+1,z.floor((t-1)/n[0])+1]},_.cat=function(n,t,r){var e,i=[];if(1===n)for(i=t,e=2;e<arguments.length;++e)i=Nn("vert",i,arguments[e]);else if(2===n)for(i=t,e=2;e<arguments.length;++e)i=Nn("horz",i,arguments[e]);return i},_.horzcat=function(n,t){for(var r=n,e=1;e<arguments.length;++e)r=Nn("horz",r,arguments[e]);return r},_.vertcat=function(n,t){for(var r=n,e=1;e<arguments.length;++e)r=Nn("vert",r,arguments[e]);return r},_.flip=qn,_.fliplr=function(n){return qn(n,2)},_.flipud=function(n){return qn(n,1)},_.reshape=function(r,e,n){y(e)&&(n=e[1],e=e[0]);var i,t=e*n;return K(r)&&1===e&&1===n?[[r]]:nn(r)&&r.length===t?k(e,n,function(n,t){return r[n+e*t]}):h(r)&&D(r)*V(r)==t?(i=D(r),k(e,n,function(n,t){n+=e*t;return r[n%i][z.floor(n/i)]})):r},_.squeeze=function(n){return n},_.repmat=function(r,e,i){return y(e)&&(i=e[1],e=e[0]),null==i&&(i=e),h(r=nn(r=K(r)?[[r]]:r)?[r]:r)?k(e*D(r),i*V(r),function(n,t){return r[n%e][t%i]}):r},_.repelem=function(t,r){var e,i;if(y(t))if(y(r)){if(r.length===t.length)return e=0,i=-1,M(j(r),function(n){return n===e&&(e+=r[++i]),t[i]})}else if(w(r))return i=-1,M(r*t.length,function(n){return 0==n%r&&++i,t[i]});return t},_.sort=function(n,t,r){for(var e=1,i=null;e<arguments.length;){if("ComparisonMethod"===arguments[e]){"real"===arguments[e+1]?i=$n:"abs"===arguments[e+1]&&(i=zn),1===e?(t=1,r="ascend"):2===e&&(r="ascend");break}e+=1}return Zt(n=On(n,t=null==t?1:t,r=null==r?"ascend":r,i,!0),n[0])},_.size=Mn,_.length=Xn,_.numel=function(n){return Bn(Mn(n))},_.ndims=function(n){return Xn(Mn(n))},_.rows=function(n){return Mn(n,1)},_.columns=function(n){return Mn(n,2)},_.zeros=Zn,_.ones=function(n,t){return y(n=null==n?1:n)&&(t=n[1],n=n[0]),k(n,t=null==t?n:t,1)},_.meshgrid=function(r,e){if(1===arguments.length&&(e=r),y(r)&&y(e))return[k(e.length,r.length,function(n,t){return r[t]}),k(e.length,r.length,function(n,t){return e[n]})];throw"meshgrid: invalid inputs"},_.eye=Wn,_.diag=Fn,_.blkdiag=function(){return r=[].slice.call(arguments),c=l=a=f=o=0,r.forEach(function(n,t){K(n)&&(r[t]=n=[[n]]),nn(n)&&(r[t]=n=Fn(n)),h(n)||s("blkdiag"),o+=D(n),f+=V(n)}),e=r[a],i=D(e),u=V(e),k(o,f,function(n,t){return l+i<=n&&(l+=i,c+=u,e=r[++a],i=D(e),u=V(e)),t<c||c+u<=t?0:e[n-l][t-c]});var r,e,i,u,o,f,a,l,c},_.dot=Qn,_.cross=function(n,t){if(n=en(n),t=en(t),!y(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(y(t)&&3===t.length)return[Z(W(n[1],t[2]),W(n[2],t[1])),Z(W(n[2],t[0]),W(n[0],t[2])),Z(W(n[0],t[1]),W(n[1],t[0]))];throw"cross: input 2 not vector of length 3"},_.kron=function(r,e){var n,t,i,u;if(S(r)){if(S(e))return n=D(r),t=V(r),i=D(e),u=V(e),k(n*i,t*u,function(n,t){return L(r[z.floor(n/i)][z.floor(t/u)],e[n%i][t%u])});if(y(e))return n=D(r),t=V(r),i=1,u=e.length,k(n*i,t*u,function(n,t){return L(r[n][z.floor(t/u)],e[t%u])})}else if(y(r)){if(y(e))return k(r.length,e.length,function(n,t){return L(r[n],e[t])});if(S(e))return n=r.length,i=D(e),u=V(e),k(n*i,(t=1)*u,function(n,t){return L(r[z.floor(n/i)],e[n%i][t%u])})}return L(r,e)},_.transpose=Un,_.ctranspose=Dn,_.rand=function(n,t){return null==n?z.random():(y(n)&&(t=n[1],n=n[0]),k(n,t=null==t?n:t,function(){return z.random()}))},_.randi=function(n,t,r){return null==t&&null==r?z.ceil(z.random()*n):(y(t)&&(r=t[1],t=t[0]),k(t,r=null==r?t:r,function(){return z.ceil(z.random()*n)}))},_.randn=function(n,t){return null==n?dn():(y(n)&&(t=n[1],n=n[0]),k(n,t=null==t?n:t,dn))},_.linspace=function(n,t,r=100){for(var e=(t-n)/(r-1),i=new Array(r),u=0,o=n;u<r;++u,o+=e)i[u]=o;return i},_.logspace=function(n,t,r=100){for(var e=z.pow(t/n,1/(r-1)),i=new Array(r),u=0,o=n;u<r;++u,o*=e)i[u]=o;return i},_.colon=Vn,_.sum=j,_.prod=Bn,_.min=Gn,_.max=Yn,_.norm=Jn,_.mean=Hn,_.median=function t(r,n){if(v(r))return r;if(y(r))return r.length?1&(r=On(r)).length?r[r.length>>1]:F(X(r[r.length>>1],r[(r.length>>1)-1]),2):o;if(S(r)){if(1===(n=null==n?1:n))return M(V(r),function(n){return t(N(r,n))});if(2===n)return M(D(r),function(n){return t(r[n])})}s("median")},_.mode=function t(r,n){if(v(r))return r;var e,i;if(y(r))return r.length?(e={},i=0,r.reduce(function(n,t){var r=t.toString(),r=A.call(e,r)?(e[r]+=1,e[r]):e[r]=1;return i<r?(i=r,n=t):r===i&&C(t,n)&&(n=t),n},{})):o;if(S(r)){if(1===(n=null==n?1:n))return M(V(r),function(n){return t(N(r,n))});if(2===n)return M(D(r),function(n){return t(r[n])})}s("mode")},_.std=Kn,_.var=function t(r,e,n){if(e=e||0,v(r))return 0;var i,u;if(y(r))return r.length<=1?r.length?0:o:(i=r.length,u=Hn(r),F(j(Tn(Pn(u=An(r,u)),u)),1===e?i:i-1));if(S(r)){if(1===(n=null==n?1:n))return M(V(r),function(n){return t(N(r,n),e)});if(2===n)return M(D(r),function(n){return t(r[n],e)})}s("var")},_.moment=function t(r,e,n){if(v(r))return 0;var i;if(y(r))return r.length<=1?r.length?0:o:(i=r.length,F(j(_n(An(r,Hn(r)),e)),i));if(S(r)){if(1===(n=null==n?1:n))return M(V(r),function(n){return t(N(r,n),e)});if(2===n)return M(D(r),function(n){return t(r[n],e)})}s("moment")},_.cov=function e(i,n,u){if(u=u||0,2!==arguments.length||0!==n&&1!==n||(u=n,n=null),null==n){if(v(i))return 0;var t;if(y(i))return i.length<=1?i.length?0:o:(r=i.length,t=Hn(i),F(j(Tn(Pn(t=An(i,t)),t)),1===u?r:r-1));if(S(i))return k(V(i),V(i),function(n,t,r){return n===t?e(N(i,n),u):t<n?r[t][n]:e(N(i,n),N(i,t),u)})}else{if(v(i)&&v(n))return Zn(2,2);if(S(i)&&S(n)&&(i=Vn(i),n=Vn(n)),y(i)&&y(n)){if(i.length!==n.length)throw"cov: inputs not of same dimension";var r;return i.length<=1?i.length?0:o:(r=i.length,F(j(Tn(Pn(An(i,Hn(i))),An(n,Hn(n)))),1===u?r:r-1))}}s("cov")},_.corrcoef=function e(i,t){if(null==t){if(v(i)||y(i))return 1;if(S(i))return k(V(i),V(i),function(n,t,r){return n===t?1:t<n?r[t][n]:e(N(i,n),N(i,t))})}else{if(v(i)&&v(t))return 1;if(y(i)&&y(t)){if(i.length!==t.length)throw"corrcoef: inputs not of same dimension";var n=i.length;return 1<n?F(j(Tn(c(An(i,Hn(i)),Kn(i)),c(An(t,Hn(t)),Kn(t)))),n-1):1}if(S(i)&&S(t)){if(D(i)!==D(t)||V(i)!==V(t))throw"corrcoef: inputs not of same dimension";return M(V(i),function(n){return e(N(i,n),N(t,n))})}}s("corrcoef")},_.diff=function(n,t,r){for(null==r&&(r=1),w(t=null==t?1:t)||s("diff");t--;)n=function t(r,n){if(y(r))return 1<r.length?M(r.length-1,function(n){return Z(r[n+1],r[n])}):[];if(S(r)){if(1===(n=null==n?1:n))return M(V(r),function(n){return t(N(r,n))});if(2===n)return M(D(r),function(n){return t(r[n])})}s("diff")}(n,r);return n},_.cumsum=function(n,t,r){n=nt(n,X,r,t);return!1===n&&s("cumsum"),n},_.cumprod=function(n,t,r){n=nt(n,W,r,t);return!1===n&&s("cumprod"),n},_.cummin=function(n,t,r){n=nt(n,function(n,t){return C(n,t)?n:t},r,t);return!1===n&&s("cummin"),n},_.cummax=function(n,t,r){n=nt(n,function(n,t){return vn(n,t)?n:t},r,t);return!1===n&&s("cummax"),n},_.movsum=function(n,t,r){var e,i;return y(t)?(e=t[0],i=t[1]):w(t)&&(i=1&t?e=t>>1:(e=t>>1,t-1>>1)),!1===(t=tt(n,j,e,i,r))&&s("movsum"),t},_.movprod=function(n,t,r){var e,i;return y(t)?(e=t[0],i=t[1]):w(t)&&(i=1&t?e=t>>1:(e=t>>1,t-1>>1)),!1===(t=tt(n,Bn,e,i,r))&&s("movprod"),t},_.movmean=function(n,t,r){var e,i;return y(t)?(e=t[0],i=t[1]):w(t)&&(i=1&t?e=t>>1:(e=t>>1,t-1>>1)),!1===(t=tt(n,Hn,e,i,r))&&s("movmean"),t},_.find=function(n){return i=function(n){return!P(n,0)},y(n=n)?n.reduce(function(n,t,r){return i(t,r+1,1)&&n.push(r+1),n},[]):S(n)?(u=D(n),n.reduce(function(n,t,e){return t.reduce(function(n,t,r){return i(t,e+1,r+1)&&n.push(e+u*r+1),n},n)},[])):[];var i,u},_.any=function(n){var t=n,r=function(n){return!P(n,0)};if(v(t))return r(t,1,1)?1:0;if(y(t)){for(var e=0,i=t.length;e<i;++e)if(r(t[e],e+1,1))return 1}else if(S(t))for(var e=0,u=D(t),o=V(t);e<u;++e)for(var f=0;f<o;++f)if(r(t[e][f],e+1,f+1))return 1;return 0},_.all=function(n){return rt(n,function(n){return!P(n,0)})},_.isreal=function(n){return rt(n,tn)},_.isempty=function(n){return b(n)?b(n[0])?n[0].length?0:1:n.length?0:1:0},_.magic=function n(r){if(!w(r=rn(r,!0))||r<=2)return 1===r?[[1]]:[];var e,i,u,o,f,t,a,l,c,s,h,p,m,g=1&r,d=0==(3&r),v=r*r,y=r-g>>1;if(g)return e=r+y,i=y+g,k(r,r,function(n,t){return(e+n-(t=r-1-t))%r*r+(i+t+n)%r+1});if(d)return c=0,k(r,r,function(n,t){return++c,(n+1&3)>>1==(t+1&3)>>1?v-(c-1):c});for(p=n(y),f=(o=(u=g=y*y)<<1)+g,m=k(r,r,function(n,t){return n<y&&t<y?p[n][t]:n<y?p[n][t-y]+f:t<y?p[n-y][t]+o:p[n-y][t-y]+u}),a=t=y>>>1,h=0;h<y;++h)for(s=0;s<r;++s)!(s<t||r-a<s||s===t&&h===t)||0===s&&h===t||(l=m[s][h],m[s][h]=m[s][h+y],m[s][h+y]=l);return m},_.inv=function(n){return S(n=v(n)?[[n]]:n)||s("inv"),at(n)},_.pinv=function(n,t){return S(n=v(n)?[[n]]:n)||s("pinv"),lt(ft(n,t))},_.ref=function(n,t){S(n=v(n)?[[n]]:n)||s("ref");n=ct(ft(n,t),!0);return Zt([n[0],n[1].map(function(n){return n[1]+1})],n[0])},_.rref=function(n,t){S(n=v(n)?[[n]]:n)||s("rref");n=st(ft(n,t),!0);return Zt([n[0],n[1].map(function(n){return n[1]+1})],n[0])},_.rank=function(n){return S(n=v(n)?[[n]]:n)||s("rank"),ct(n,!0)[1].length},_.adjoint=function(n){return S(n)&&D(n)===V(n)||s("adjoint"),ht(n)},_.det=mt,_.trace=gt,_.charpoly=function(n){S(n)&&D(n)===V(n)||s("charpoly");var e,t=D(n),i=(V(n),t),u=new Array(i+1),r=Zn(i,i);for(u[i]=1,e=1;e<=i;++e)r=L(n,r).map(function(n,r){return n.map(function(n,t){return r===t?X(n,u[i-e+1]):n})}),u[i-e]=F(gt(L(n,r)),-e);return u.reverse()},_.eig=function(n){S(n)&&D(n)===V(n)||s("eig"),1<arguments.length&&s("eig");n=dt(n);return Zt([n[0],Fn(n[1]),n[2]],n[1])},_.rowspace=function(n,t){return ct(r=ft(n,t),!0)[1].map(function(n){return r[n[0]]});var r},_.colspace=function(n,t){return ct(r=ft(n,t),!0)[1].map(function(t){return M(r.length,function(n){return r[n][t[1]]})});var r},_.null=function(n,t){return n=ft(n,t),i=V(n),u=(n=st(n,!0))[0],o=n[1],f=o.length,n=o.reduce(function(n,t){for(var r=0;r<n.length&&t[1]>n[r];)++r;return r<n.length&&t[1]===n[r]&&n.splice(r,1),n},M(i,function(n){return n})),a=f?o.reduce(function(n,t,r){return W(n,u[r][t[1]])},1):1,n.map(function(t){for(var n,r=M(i,function(n){return n===t?a:0}),e=0;e<f;++e)(n=o[e][1])<=t&&(r[n]=Z(r[n],W(F(a,u[e][n]),u[e][t])));return r});var i,u,o,f,a},_.svd=function(n,t){S(n=v(n)?[[n]]:n)||s("svd");n=function $(n,t){O(t)||(t=B);var r,e=V(n),i=D(n);if(i<e)return r=$(Un(n),t),[Un(r[2]),r[1],Un(r[0])];var u,o,f,a,l,c,s,h,p,m,g,d,v,y,w,x,b,S,k,A,T,_=i,E=e,I=un(n),R=Zn(i,_),P=M(e,0),C=Zn(e,E),L=G/t,j=new Array(e),N=new Array(e),q=new Array(e);for(N[0]=0,y=1;y<=e;++y){for(b=y+1,f=0,d=y;d<=i;++d)f+=z.pow(In(I[d-1][y-1]),2)+z.pow(Rn(I[d-1][y-1]),2);if(j[y-1]=0,L<f&&(f=z.sqrt(f),j[y-1]=f,l=0===(a=U(I[y-1][y-1]))?1:F(I[y-1][y-1],a),I[y-1][y-1]=W(l,f+a),y!==e+0)){for(v=b;v<=e+0;++v){for(l=0,d=y;d<=i;++d)l=X(l,W(Q(I[d-1][y-1]),I[d-1][v-1]));for(l=F(l,f*(f+a)),d=y;d<=i;++d)I[d-1][v-1]=Z(I[d-1][v-1],W(l,I[d-1][y-1]))}for(l=xn(ln(Q(I[y-1][y-1]))),v=b;v<=e+0;++v)I[y-1][v-1]=W(l,I[y-1][v-1])}if(y===e)break;for(f=0,v=b;v<=e;++v)f+=z.pow(In(I[y-1][v-1]),2)+z.pow(Rn(I[y-1][v-1]),2);if(N[b-1]=0,L<f){for(f=z.sqrt(f),N[b-1]=f,l=0===(a=U(I[y-1][b-1]))?1:F(I[y-1][b-1],a),I[y-1][b-1]=W(l,f+a),d=b;d<=i;++d){for(l=0,v=b;v<=e;++v)l=X(l,W(Q(I[y-1][v-1]),I[d-1][v-1]));for(l=F(l,f*(f+a)),v=b;v<=e;++v)I[d-1][v-1]=Z(I[d-1][v-1],W(l,I[y-1][v-1]))}for(l=xn(ln(Q(I[y-1][b-1]))),d=b;d<=i;++d)I[d-1][b-1]=W(I[d-1][b-1],l)}}for(c=0,y=1;y<=e;++y)P[y-1]=j[y-1],q[y-1]=N[y-1],c=z.max(c,P[y-1]+q[y-1]);if(c*=t,0<_)for(v=1;v<=_;++v)R[v-1][v-1]=1;if(0<E)for(v=1;v<=E;++v)C[v-1][v-1]=1;for(x=1;x<=e;++x){for(y=e+1-x,A=1;A<=50;++A){for(T=!0,k=1;k<=y;++k){if(z.abs(q[(w=y+1-k)-1])<=c){T=!1;break}if(z.abs(P[w-1-1])<=c){T=!0;break}}if(T)for(g=0,S=w-(m=1),d=w;d<=y&&(h=m*q[d-1],q[d-1]=g*q[d-1],!(z.abs(h)<=c));++y)if(a=gn(h,p=P[d-1]),g=p/(P[d-1]=a),m=-h/a,0<_)for(v=1;v<=e;++v)u=In(R[v-1][S-1]),o=In(R[v-1][d-1]),R[v-1][S-1]=u*g+o*m,R[v-1][d-1]=o*g-u*m;if(a=P[y-1],w===y)break;for(u=P[w-1],s=gn(h=(((o=P[y-1-1])-a)*(o+a)+((s=q[y-1-1])-(p=q[y-1]))*(s+p))/(2*p*o),1),h=((u-a)*(u+a)+(o/(h+(s=h<0?-s:s))-p)*p)/u,d=S=w+(m=g=1);S<=y;++S){if(s=q[d-1],o=P[d-1],p=m*s,s*=g,a=gn(p,h),h=u*(g=h/(q[d-1-1]=a))+s*(m=p/a),s=s*g-u*m,p=o*m,o*=g,0<E)for(v=1;v<=e;++v)u=In(C[v-1][d-1-1]),a=In(C[v-1][d-1]),C[v-1][d-1-1]=u*g+a*m,C[v-1][d-1]=a*g-u*m;if(a=gn(p,h),h=(g=h/(P[d-1-1]=a))*s+(m=p/a)*o,u=g*o-m*s,0<_)for(v=1;v<=e;++v)o=In(R[v-1][d-1-1]),a=In(R[v-1][d-1]),R[v-1][d-1-1]=o*g+a*m,R[v-1][d-1]=a*g-o*m}q[w-1]=0,q[y-1]=h,P[y-1]=u}if(a<0&&(P[y-1]=-a,0<E))for(v=1;v<=e;++v)C[v-1][y-1]=xn(C[v-1][y-1])}for(y=1;y<=e;++y){for(s=-1,d=v=y;d<=e;++d)s<P[d-1]&&(s=P[d-1],v=d);if(v!==y){if(P[v-1]=P[y-1],P[y-1]=s,0<E)for(d=1;d<=e;++d)l=C[d-1][v-1],C[d-1][v-1]=C[d-1][y-1],C[d-1][y-1]=l;if(0<_)for(d=1;d<=e;++d)l=R[d-1][v-1],R[d-1][v-1]=R[d-1][y-1],R[d-1][y-1]=l}}if(0<_)for(x=1;x<=e;++x)if(0!==j[(y=e+1-x)-1]){for(l=xn(ln(I[y-1][y-1])),v=1;v<=_;++v)R[y-1][v-1]=W(l,R[y-1][v-1]);for(v=1;v<=_;++v){for(l=0,d=y;d<=i;++d)l=X(l,W(Q(I[d-1][y-1]),R[d-1][v-1]));for(l=F(l,W(U(I[y-1][y-1]),j[y-1])),d=y;d<=i;++d)R[d-1][v-1]=Z(R[d-1][v-1],W(l,I[d-1][y-1]))}}if(0<E&&2<=e)for(x=2;x<=e;++x)if(0!==N[(b=1+(y=e+1-x))-1]){for(l=xn(ln(Q(I[y-1][b-1]))),v=1;v<=E;++v)C[b-1][v-1]=W(l,C[b-1][v-1]);for(v=1;v<=E;++v){for(l=0,d=b;d<=e;++d)l=X(l,W(I[y-1][d-1],C[d-1][v-1]));for(l=F(l,W(U(I[y-1][b-1]),N[b-1])),d=b;d<=e;++d)C[d-1][v-1]=Z(C[d-1][v-1],W(l,Q(I[y-1][d-1])))}}return[R,P,C]}(n,t);return Zt([n[0],Fn(n[1]),n[2]],n[1])},_.lu=function(n){return S(n=v(n)?[[n]]:n)||s("lu"),vt(n,!0)},_.qr=function(n){S(n=v(n)?[[n]]:n)||s("qr");n=wt(n);return Zt(n,n[1])},_.hess=function(n,t){return S(n=v(n)?[[n]]:n)&&D(n)===V(n)||s("hess"),1<arguments.legnth?(S(t=v(t)?[[t]]:t)&&D(t)===V(t)||s("hess"),xt(n,t)):Zt(t=xt(n),t[1])},_.ldl=function(n,t){S(n=v(n)?[[n]]:n)||s("ldl");var r,e,i,u,o,f,a=n,l=t,c=D(a);if(c===V(a)&&an(a,Dn(a))){for(o=Zn(c,c),f=Wn(c),r=0;r<c;++r){if("upper"===l){for(e=r+1;e<c;++e){for(i=r+1,u=0;i<e;++i)u=X(u,W(W(f[r][i],Q(f[e][i])),o[i][i]));f[r][e]=F(Z(a[r][e],u),o[e][e])}for(i=r+1,u=0;i<c;++i)u=X(u,W(W(f[r][i],Q(f[r][i])),o[i][i]))}else{for(e=0;e<r;++e){for(u=i=0;i<e;++i)u=X(u,W(W(f[r][i],Q(f[e][i])),o[i][i]));f[r][e]=F(Z(a[r][e],u),o[e][e])}for(u=i=0;i<r;++i)u=X(u,W(W(f[r][i],Q(f[r][i])),o[i][i]))}o[r][r]=Z(a[r][r],u),yn(o[r][r],0)&&s("ldl")}return[f,o]}s("ldl")},_.linsolve=bt,_.polyval=function(t,n){if(v(t)?t=[t]:S(t)&&1===D(t)&&(t=t[0]),!y(t))throw"polyval: input 1 not supported";if(v(n))return l(St(t,n));if(y(n))return n.map(function(n){return l(St(t,n))});throw"polyval: input 2 not supported"},_.polyvalm=function(t,n){if(v(t)?t=[t]:S(t)&&1===D(t)&&(t=t[0]),!y(t))throw"polyval: input 1 not supported";if(S(n)&&D(n)===V(n))return l(function(r,n){if(!r.length)return 0;for(var t=r.length,e=0,i=D(n),u=k(i,i,function(n,t){return n===t?r[0]:0});e+1<t;)++e,u=kn(L(u,n),k(i,i,function(n,t){return n===t?r[e]:0}));return u}(t,n));if(v(x))return l(St(t,x));if(y(x))return x.map(function(n){return l(St(t,n))});throw"polyvalm: input 2 not supported"},_.polyfit=function(n,t,i){if(v(n)?n=[n]:S(n)&&1===D(n)&&(n=n[0]),v(t)?t=[t]:S(t)&&1===D(t)&&(t=t[0]),!y(n))throw"polyfit: input 1 not supported";if(!y(t))throw"polyfit: input 2 not supported";if(n.length!==t.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return l(function(e,i){var n,u,o,t,r,f,a,l;if(!(y(e)&&e.length&&y(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),o=z.min(e.length,i.length),e.length=o,i.length=o,a={},l=[],u=0;u<o;++u)if(f=String(e[u]),A.call(a,f)){if(!P(i[a[f]],i[u]))return[];l.push(u)}else a[f]=u;for(;l.length;)u=l.pop(),e.splice(u,1),i.splice(u,1);for(l=a=null,t=M(o=e.length,function(n){for(var t=1,r=0;r<o;++r)r!==n&&(t=W(t,Z(e[n],e[r])));return t=F(i[n],t)}),r=M(o,function(n){return[1,xn(e[n])]}),n=[],u=0;u<o;++u)n=kt(n,r.reduce(function(n,t,r){return n=r!==u?Tt(n,t):n},[t[u]]));return n}(n,t));if(!w(i)||i<0)throw"polyfit: input 3 not positive int";return l(L(lt(n.reduce(function(n,t){for(var r=1,e=[1];r<=i;++r)e.unshift(W(t,e[0]));return n.push(e),n},[])),t))},_.roots=function(n){return v(n)?n=[n]:S(n)&&1===D(n)&&(n=n[0]),y(n)||s("roots"),l(function(t){if(t.length<=1)return[];for(var n,r,e,i,u,o,f,a,l,c=t.length-1,s=1e-10,h=new R(s,0),p=new R(0,0),m=new R(1,0),g=function(n){return St(t,n)},d=function(n){return F(Z(g(X(n,h)),g(n)),h)},v=t.map(function(n){return R(n).abs()}),y=v.length-1;0<y&&!v[y];)--y;for(r=(z.max.apply(null,v.slice(0,y))||0)/(v[y]||1)+1,n=v[0]/(v[0]+z.max.apply(null,v.slice(1))||1),e=M(c,function(){return new R(n+(r-n)*z.random(),z.random()*$/2,"polar")}),f=0;;){for(y=i=0;y<c;++y){if(u=e[y],a=g(u),0===(l=d(u)).re&&0===l.im){if(a.re<=s&&a.im<=s){++i;continue}o=new R(r,0)}else o=a.div(l);(a=o.div(m.sub(o.mul(e.reduce(function(n,t,r){return n=r===y||u.re===t.re&&u.im===t.im?n:n.add(u.sub(t).inv())},p))))).re<=s&&a.im<=s&&++i,e[y]=u.sub(a)}if(i===c)break;if(1e3<++f)break}return e}(n).sort(function(n,t){return In(n)-In(t)}))},_.poly=function(n){return v(n)?n=[n]:S(n)&&1===D(n)&&(n=n[0]),y(n)||s("poly"),l(n.reduce(function(n,t){return Tt(n,[1,xn(t)])},[1]))};var Tt=At;function _t(n,t,r){var e,i=[],u=n.slice(),o=u.length-t.length,f=t;if(0<=o)for(i=M(o+1,0);0<=o;){for(e=o,t=f.concat(M(o,0)),i[i.length-1-o]=F(u[0],t[0]),u=kt(u,Tt(t,[-i[i.length-1-o]]));u.length&&P(u[0],0);)u.shift();if((o=u.length-f.length)===e)break}return[i,r?M(n.length-u.length,0).concat(u):u]}_.conv=function(n,t){if(v(n)||v(t))return Tn(n,t);if(S(n)&&1===D(n)&&(n=n[0]),S(t)&&1===D(t)&&(t=t[0]),!y(n))throw"conv: input 1 not supported";if(y(t))return At(n,t);throw"conv: input 2 not supported"};var Et=_t;_.deconv=function(n,t){var r;if(v(n)||v(t))r=[c(n,t),0];else{if(S(n)&&1===D(n)&&(n=n[0]),S(t)&&1===D(t)&&(t=t[0]),!y(n))throw"deconv: input 1 not supported";if(!y(t))throw"deconv: input 2 not supported";if(!t.length||1===t.length&&P(t[0],0))throw"deconv: divisor is zero";r=_t(n,t,!0)}return Zt(r,r[0])},_.polydiv=function(n,t){var r;if(v(n)||v(t))r=[c(n,t),0];else{if(S(n)&&1===D(n)&&(n=n[0]),S(t)&&1===D(t)&&(t=t[0]),!y(n))throw"polydiv: input 1 not supported";if(!y(t))throw"polydiv: input 2 not supported";if(!t.length||1===t.length&&P(t[0],0))throw"polydiv: divisor is zero";r=Et(n,t,!1)}return Zt(r,r[0])},_.conv2=function(t,r){if(v(t)||v(r))return Tn(t,r);if(y(t)){if(y(r))return At(t,r);if(S(r))return M(V(r),function(n){return At(t,N(r,n))})}else{if(y(r)){if(y(t))return At(t,r);if(S(t))return M(t[0].length,function(n){return At(N(t,n),r)});throw"conv2: input 1 not supported"}if(!S(t))throw"conv2: input 1 not supported";if(S(r)){var n,e,i,u,o,f,a,l,c,s,h,p,m,g=t,d=r;for(D(g)<D(d)&&(m=g,g=d,d=m),n=D(g),e=V(g),o=Zn(f=n+(i=D(d))-1,a=e+(u=V(d))-1),c=0;c<f;++c)for(s=0;s<a;++s){for(h=l=0;h<=c&&!(n<=h);++h)if(!(i<=c-h))for(p=0;p<=s&&!(e<=p);++p)u<=s-p||(l=X(l,W(g[h][p],d[c-h][s-p])));o[c][s]=l}return o}}throw"conv2: input 2 not supported"},_.filter=function(n,t,r,e,i){if(v(n)?n=[n]:S(n)&&1===D(n)&&(n=n[0]),v(t)?t=[t]:S(t)&&1===D(t)&&(t=t[0]),v(r)?r=[r]:S(r)&&1===D(r)&&(r=r[0]),y(n)&&y(t)&&y(r)){var u,o,f,a,l=n,c=t,s=r,h=s.length,p=c.length,m=l.length,g=new Array(h),d=c[0];for(c=c.map(function(n){return F(n,d)}),l=l.map(function(n){return F(n,d)}),u=0;u<h;++u){for(f=u,o=a=0;0<=f&&o<m;++o,--f)a=X(a,W(l[o],s[f]));for(f=u-1,o=1;0<=f&&o<p;++o,--f)a=Z(a,W(c[o],g[f]));g[u]=a}return g}throw"filter: inputs not supported"};var It={},Rt={};function Pt(n,t){for(var r,e,i=n.length,u={},o=0;o<i;++o)1!==u[o]&&(e=n[r=function(n,t){for(var r=0;1<t;)r=(r<<1)+(1&n),n>>=1,t>>=1;return r}(o,i)],t[r]=n[o],t[o]=e,u[r]=1)}function Ct(n,t,r){var e,i=n.length;if(1===i)r[0]=n[0];else{for(e=0;e<i;++e)r[e]=new R(0,0);for(var u,o,f,a,l,c,s=function(n){for(var t=z.sqrt(n),r=3;r<=t;){if(0==n%r)return r;r+=2}return n}(i),h=i/s,p=1/z.sqrt(s),m=new Array(h),g=new Array(h),d=0;d<s;++d){for(e=0;e<h;++e)m[e]=n[e*s+d];for(1<h&&(jt(m,t,g),m=g,g=recursive_resulte),u=z.cos(2*$*d/i),o=(t?-1:1)*z.sin(2*$*d/i),f=1,e=a=0;e<i;++e)l=p*m[e%h].re,c=p*m[e%h].im,r[e]=r[e].add(new R(f*l-a*c,f*c+a*l)),l=f*u-a*o,a=f*o+a*u,f=l,a=a}}}function Lt(n,t,r){var e,i,u,o,f,a,l,c,s,h,p,m,g,d,v,y=n.length,w=1;for(Pt(n,r);w<y;){for(v=void 0,null==(v=Rt[d=w])&&(Rt[d]=v=z.cos($/d)),e=v,i=(t?-1:1)*(d=void 0,null==(d=It[v=w])&&(It[v]=d=z.sin($/v)),d),o=y/(2*w),u=0;u<o;++u)for(l=1,f=c=0;f<w;++f)h=r[m=2*u*w+f].re,p=r[m].im,g=r[s=m+w].re,a=r[s].im,r[m]=new R(z.SQRT1_2*(h+(m=l*g-c*a)),z.SQRT1_2*(p+(g=c*g+l*a))),r[s]=new R(z.SQRT1_2*(h-m),z.SQRT1_2*(p-g)),a=l*i+c*e,l=l*e-c*i,c=a;w<<=1}}function jt(n,t,r){var e,i=n.length;if(!(i<=0))return e=!1,null==r&&(r=new Array(i),e=!0),(i&i-1?Ct:Lt)(n,t,r),e?r:void 0}function Nt(n,t,r){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,o,f=!1,a=new Array(e),l=new Array(i),c=new Array(e),s=new Array(i);if(null==r){for(r=new Array(e),u=0;u<e;++u)r[u]=new Array(i);f=!0}for(o=0;o<i;++o,0){for(u=0;u<e;++u)a[u]=n[u][o];for(jt(a,t,c),u=0;u<e;++u)r[u][o]=c[u]}for(u=0;u<e;++u){for(o=0;o<i;++o,0)l[o]=r[u][o];for(jt(l,t,s),o=0;o<i;++o,0)r[u][o]=s[o]}return f?r:void 0}}function r(){if(!E(this,r))return new r;this.data=[]}_.fft=function(t){return v(t)?t=[t]:S(t)&&1===D(t)&&(t=t[0]),S(t)?M(V(t),function(n){return l(jt(mn(N(t,n)),!1))}):y(t)?l(jt(mn(t),!1)):void s("fft")},_.ifft=function(t){return v(t)?t=[t]:S(t)&&1===D(t)&&(t=t[0]),S(t)?M(V(t),function(n){return l(jt(mn(N(t,n)),!0))}):y(t)?l(jt(mn(t),!0)):void s("ifft")},_.fft2=function(n){return S(n)||s("fft2"),l(Nt(mn(n),!1))},_.ifft2=function(n){return S(n)||s("ifft2"),l(Nt(mn(n),!0))},T.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],r.prototype={constructor:r,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,render:function(n,t){var r=this;return t&&(r.canvas=t,r.type=n,-1<["plot","scatter","bar","barh","pie"].indexOf(n)&&r.data&&r.data.length&&r.renderData(),"xlabel"===n&&r.xlabel&&r.xlabel.length&&r.renderXLabel(),"ylabel"===n&&r.ylabel&&r.ylabel.length&&r.renderYLabel(),"title"===n&&r.title&&r.title.length&&r.renderTitle(),r.canvas=null),t},renderData:function(){var m,g,d,v=this,y=v.canvas.getContext("2d"),w=v.type,x=v.canvas.width,b=v.canvas.height,S=0,k=v.data.length;-1===["pie"].indexOf(w)&&(v.renderAxes(),m=v.no),"bar"===w?S=z.max(1,z.floor((x-v.pl-v.pr)/(m*k))):"barh"===w?S=z.max(1,z.floor((b-v.pt-v.pb)/(m*k))):"pie"===w&&(1<k&&1&k&&(k+=1),g=z.floor(z.sqrt(k)),d=k/g,S=z.min((x-v.pl-v.pr)/d,(b-v.pt-v.pb)/g)),v.data.forEach(function(n,t){var r=n.x,e=n.y,i=n.style;if("plot"===w){for(y.beginPath(),y.lineWidth=i.LineWidth,y.setLineDash(i.LineStyle),y.strokeStyle="rgb("+i.Color.map(function(n){return z.round(255*n)}).join(",")+")",y.lineJoin="bevel",y.moveTo(v.x(r[0]),v.y(e[0])),p=1;p<m;++p)y.lineTo(v.x(r[p]),v.y(e[p]));y.stroke()}else if("scatter"===w)for(y.fillStyle="rgb("+i.Color.map(function(n){return z.round(255*n)}).join(",")+")",p=0;p<m;++p)y.beginPath(),y.arc(v.x(r[p]),v.y(e[p]),2*i.LineWidth,0,2*$),y.closePath(),y.fill();else if("bar"===w)for(y.fillStyle="rgb("+i.Color.map(function(n){return z.round(255*n)}).join(",")+")",p=0;p<m;++p)y.fillRect(v.pl+t*S*.8+p*k*S,v.y(0)>v.y(e[p])?v.y(e[p]):v.y(0),.8*S,z.abs(v.y(e[p])-v.y(0)));else if("barh"===w)for(y.fillStyle="rgb("+i.Color.map(function(n){return z.round(255*n)}).join(",")+")",p=0;p<m;++p)y.fillRect(v.y(0)>v.y(e[p])?v.y(e[p]):v.y(0),v.pt+t*S*.8+p*k*S,z.abs(v.y(e[p])-v.y(0)),.8*S);else if("pie"===w){var u,o,f=j(Cn(e)),a=.4*S,l=-$/2,n=t%d,c=z.floor(t/d),s=(x-d*S)/2+n*S+S/2,h=(b-g*S)/2+c*S+S/2,p=0;for(m=e.length;p<m;++p)o=e[p]/f,u=l+2*$*o,y.beginPath(),y.moveTo(s,h),y.arc(s,h,a,l,u,!1),y.closePath(),y.fillStyle=T.PALETTE[p%T.PALETTE.length],y.fill(),y.font="10 px sans-serif",y.textAlign="center",y.fillStyle="#000",y.strokeStyle="#000",y.fillText((100*o).toFixed(2)+"%",s+(22+a)*z.cos((l+u)/2),h+(22+a)*z.sin((l+u)/2)),l=u}})},renderXLabel:function(){var n=this,t=n.canvas.getContext("2d"),r=n.canvas.width,e=n.canvas.height;t.font=String(15)+"px sans-serif",t.fillStyle="#000",t.textAlign="center",t.strokeStyle="#000",t.fillText(n.xlabel,r/2,e-1-n.pb/4)},renderYLabel:function(){var n=this.canvas.getContext("2d"),t=(this.canvas.width,this.canvas.height);n.font=String(15)+"px sans-serif",n.fillStyle="#000",n.textAlign="center",n.strokeStyle="#000",n.save(),n.translate(19.5,t/2),n.rotate(-z.PI/2),n.fillText(this.ylabel,0,0),n.restore()},renderTitle:function(){var n=this,t=n.canvas.getContext("2d"),r=n.canvas.width;n.canvas.height;t.font=String(18)+"px sans-serif",t.fillStyle="#000",t.textAlign="center",t.strokeStyle="#000",t.fillText(n.title,r/2,n.pt/2)},renderAxes:function(){var n,t,r,e,i,u,o,f,a,l,c,s=this,h=s.canvas.getContext("2d"),p=s.canvas.width,m=s.canvas.height;s.type;function g(n,t){return!1===t||n<1?parseFloat(n.toFixed(4)):z.ceil(n)}function d(n){return n.toFixed(3).replace(/0+$/,"").replace(/\.$/,"")}if(s.updateAxes(),n=s.xmin,s.xmax,t=s.ymin,s.ymax,"barh"===s.type){for(l=z.max(60,g((p-s.pl-s.pr)/16)),r=[],a=s.pl;f=s.y(a,!0),!(a>p-1-s.pr);a+=l)r.push({t:f,p:a});c=z.max(1,z.floor((m-s.pt-s.pb)/(s.no*s.data.length))),e=M(s.no,function(n){return{t:n+1,p:s.pt+n*s.data.length*c+s.data.length*c*.8/2}})}else{if("bar"===s.type)c=z.max(1,z.floor((p-s.pl-s.pr)/(s.no*s.data.length))),r=M(s.no,function(n){return{t:n+1,p:s.pl+n*s.data.length*c+s.data.length*c*.8/2}});else if(r=[],"log"===s.xscale)for(f=z.pow(10,z.floor(z.log10(n)));!((a=s.x(f))>p-1-s.pr);f*=10)for(r.push({t:f,p:a}),o=1;o<=8&&!((a=s.x(o*f))>p-1-s.pr);++o)r.push({t:o*f,p:a});else for(l=z.max(60,g((p-s.pl-s.pr)/16)),a=s.pl;f=s.x(a,!0),!(a>p-1-s.pr);a+=l)r.push({t:f,p:a});if(e=[],"log"===s.yscale)for(f=z.pow(10,z.floor(z.log10(t)));!((a=s.y(f))<s.pt);f*=10)for(e.push({t:f,p:a}),o=1;o<=8&&!((a=s.y(o*f))<s.pt);++o)e.push({t:o*f,p:a});else for(l=z.max(40,g((m-s.pt-s.pb)/16)),a=m-1-s.pb;f=s.y(a,!0),!(a<s.pt);a-=l)e.push({t:f,p:a})}h.font=String(10)+"px sans-serif",h.fillStyle="#000",h.textAlign="center",h.strokeStyle="#000",h.lineWidth=1,h.beginPath(),h.moveTo(s.pl,s.pt),h.lineTo(p-1-s.pr,s.pt),h.lineTo(p-1-s.pr,m-1-s.pb),h.lineTo(s.pl,m-1-s.pb),h.lineTo(s.pl,s.pt),h.stroke(),i=z.max(8,.001*m),r.forEach(function(n){h.lineWidth=.5,h.beginPath(),h.moveTo(n.p,m-1-s.pb),h.lineTo(n.p,m-1-s.pb-i),h.stroke(),h.beginPath(),h.moveTo(n.p,s.pt),h.lineTo(n.p,s.pt+i),h.stroke(),"log"===s.xscale?w(z.log10(n.t))&&h.fillText("10^"+String(z.floor(z.log10(n.t))),n.p,m-1-s.pb+5+10):h.fillText(d(n.t),n.p,m-1-s.pb+5+10)}),u=z.max(8,.001*p),e.forEach(function(n,t){h.lineWidth=.5,h.beginPath(),h.moveTo(s.pl,n.p),h.lineTo(s.pl+u,n.p),h.stroke(),h.beginPath(),h.moveTo(p-1-s.pr,n.p),h.lineTo(p-1-s.pr-u,n.p),h.stroke(),"log"===s.yscale?w(z.log10(n.t))&&h.fillText("10^"+String(z.floor(z.log10(n.t))),s.pl-21,n.p):h.fillText(d(n.t),s.pl-21,n.p)})},updateAxes:function(){var r=this,n=r.canvas.width,t=r.canvas.height,e=a,i=-a,u=a,o=-a,f=a;r.data.forEach(function(n,t){"barh"===r.type||"bar"===r.type?f=z.min(f,n.y.length):(f=z.min(f,n.x.length,n.y.length),e=z.min(e,Gn(n.x)),i=z.max(i,Yn(n.x))),u=z.min(u,Gn(n.y)),o=z.max(o,Yn(n.y))}),"barh"!==r.type&&"bar"!==r.type||(e=1,i=f,0<u&&(u=0),o<0&&(o=0)),e===i&&(e-=B,i+=B),u===o&&(u-=B,o+=B),r.no=f,r.xmin=e,r.xmax=i,r.ymin=u,r.ymax=o,"log"===r.xscale?(r.xmin=z.pow(10,z.floor(z.log10(r.xmin||B))),r.xmax=z.pow(10,z.ceil(z.log10(r.xmax||B))),r.scx=(n-1-r.pl-r.pr)/(z.log10(r.xmax)-z.log10(r.xmin))):r.scx=(n-1-r.pl-r.pr)/(r.xmax-r.xmin),"log"===r.yscale?(r.ymin=z.pow(10,z.floor(z.log10(r.ymin||B))),r.ymax=z.pow(10,z.ceil(z.log10(r.ymax||B))),r.scy=("barh"===r.type?n-1-r.pl-r.pr:t-1-r.pt-r.pb)/(z.log10(r.ymax)-z.log10(r.ymin))):r.scy=("barh"===r.type?n-1-r.pl-r.pr:t-1-r.pt-r.pb)/(r.ymax-r.ymin),r.sc=z.min(r.scx,r.scy)},x:function(n,t){var r=this,e=r.xmin,i=r.yscale===r.xscale?r.sc:r.scx;return!0===t?(n-r.pl)/i+e:("log"===r.xscale&&(e=z.log10(e),n=z.log10(n||B)),(n-e)*i+r.pl)},y:function(n,t){var r=this,e=r.ymin,i=r.yscale===r.xscale?r.sc:r.scy,u=r.canvas.height;return!0===t?"barh"===r.type?(n-r.pl)/i+e:(u-1-n-r.pb)/i+e:("log"===r.yscale&&(e=z.log10(e),n=z.log10(n||B)),"barh"===r.type?(n-e)*i+r.pl:u-1-((n-e)*i+r.pb))},option:function(n,t,r,e){var i,u,o,f={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},a={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},l={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},c=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:l[c[(e||0)%c.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=l[c[(e||0)%c.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=f["-"]),n._LineStyle||(n._LineStyle="-"),r=r||0;r<t.length;){if("Color"===t[r])I(i=t[r+1])?A.call(a,i)?n.Color=l[a[i]]:A.call(l,i)&&(n.Color=l[i]):y(i)&&3===i.length&&(n.Color=i);else if("LineWidth"===t[r])O(i=t[r+1])&&(n.LineWidth=2*i);else{if("LineStyle"!==t[r]){if(I(t[r])){for(u in o=!1,i=t[r],l)-1<i.indexOf(u)&&(n.Color=l[u],o=!0);for(u in f)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=f[u],o=!0);if(o){r+=1;continue}}break}I(i=t[r+1])&&A.call(f,i)&&(n._LineStyle=i,n.LineStyle=f[i])}r+=2}return r},parse:function(n,t,r){var e,i,u,o,f,a,l=this,c=0,s=0;if("pie"===t)for(;c<n.length;)y(n[c])?l.data.push({y:n[c++]}):c+=1;else if("plot3"===t)for(;c<n.length;)f=o=u=null,y(n[c])&&(u=n[c]),y(n[c+1])&&(o=n[c+1]),y(n[c+2])&&(f=n[c+2],c+=3),u&&o&&f?(c=l.option(a={},n,c,s),l.data.push({x:u,y:o,z:f,style:a}),++s):c+=1;else for(;c<n.length;)if(o=u=null,y(n[c])&&(u=n[c]),y(n[c+1])||S(n[c+1])?(o=n[c+1],c+=2):u&&(u=Vn(1,(o=u).length),c+=1),u&&o)if(c=l.option(a={},n,c,s),S(o))for(e=0,i=V(o);e<i;++e)l.data.push({x:u,y:N(o,e),style:a}),a=l.option(a,n,c,++s);else l.data.push({x:u,y:o,style:a}),++s;else c+=1;return l}},T.figure=r,_.plot=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("plot",T.createCanvas(700,525)):null},_.loglog=function(){var n=r().parse(arguments);return n.xscale="log",n.yscale="log",n.data.length?n.render("plot",T.createCanvas(700,525)):null},_.semilogx=function(){var n=r().parse(arguments);return n.xscale="log",n.yscale="linear",n.data.length?n.render("plot",T.createCanvas(700,525)):null},_.semilogy=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="log",n.data.length?n.render("plot",T.createCanvas(700,525)):null},_.scatter=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("scatter",T.createCanvas(700,525)):null},_.bar=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("bar",T.createCanvas(700,525)):null},_.barh=function(){var n=r().parse(arguments);return n.xscale="linear",n.yscale="linear",n.data.length?n.render("barh",T.createCanvas(700,525)):null},_.piechart=function(){var n=r().parse(arguments,"pie");return n.data.length?n.render("pie",T.createCanvas(700,525)):null},_.donutchart=function(){return _.piechart.apply([].slice.call(arguments))},_.xlabel=function(n){var t=r();return t.xlabel=String(n),t.render("xlabel",T.currentCanvas())},_.ylabel=function(n){var t=r();return t.ylabel=String(n),t.render("ylabel",T.currentCanvas())},_.title=function(n){var t=r();return t.title=String(n),t.render("title",T.currentCanvas())};var qt={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var t=[],r=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?r.length&&(b(r[0])?t=t.length?Nn("vert",t,r):r:t.push(r),r=[]):!E(n,Xt)&&b(n)?r=r.length?Nn("horz",r,n):n:r.push(n))}),r.length&&(b(r[0])?t=t.length?Nn("vert",t,r):r:t.length?t.push(r):t=r),t}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return Vn(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,t){return Vn(n,t)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,t,r){return Vn(n,t,r)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:Dn},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:Un},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:En},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:_n},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,t){return bt(n,t)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:c},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:c},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:L},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:Tn},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:kn},"-":{name:"sub",arity:2,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:An},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:function r(e,i){if(I(e)){if(I(i))return i<=e?1:0;if(v(i))return e>=String(i)?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(D(i),V(i),function(n,t){return r(e,i[n][t])})}else if(O(e)){if(I(i))return String(e)>=i?1:0;if(O(i))return i<=e?1:0;if(u(i))return i.re>=e&&0===i.im?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(D(i),V(i),function(n,t){return r(e,i[n][t])})}else if(u(e)){if(I(i))return String(e)>=i?1:0;if(O(i))return e.re>=i&&0===e.im?1:0;if(u(i))return P(e,i)?1:0;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(D(i),V(i),function(n,t){return r(e,i[n][t])})}else if(y(e)){if(I(i)||v(i))return e.map(function(n){return r(n,i)});if(y(i)){if(e.length!==i.length)throw"ge: inputs have incompatible dimensions";return e.map(function(n,t){return r(n,i[t])})}if(S(i)){if(e.length!==V(i))throw"ge: inputs have incompatible dimensions";return k(D(i),V(i),function(n,t){return r(e[t],i[n][t])})}}else if(S(e)){if(I(i)||v(i))return k(D(e),V(e),function(n,t){return r(e[n][t],i)});if(y(i)){if(V(e)!==i.length)throw"ge: inputs have incompatible dimensions";return k(D(e),V(e),function(n,t){return r(e[n][t],i[t])})}if(S(i)){if(D(e)!==D(i)||V(e)!==V(i))throw"ge: inputs have incompatible dimensions";return k(D(e),V(e),function(n,t){return r(e[n][t],i[n][t])})}}return 0}},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:yn},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:vn},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:C},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:function r(e,i){if(I(e)){if(I(i))return e===i?0:1;if(v(i))return e===String(i)?0:1;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(D(i),V(i),function(n,t){return r(e,i[n][t])})}else if(O(e)){if(I(i))return String(e)===i?0:1;if(O(i))return e===i?0:1;if(u(i))return i.re===e&&0===i.im?0:1;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(D(i),V(i),function(n,t){return r(e,i[n][t])})}else if(u(e)){if(I(i))return String(e)===i?0:1;if(O(i))return e.re===i&&0===e.im?0:1;if(u(i))return e.re===i.re&&e.im===i.im?0:1;if(y(i))return i.map(function(n){return r(e,n)});if(S(i))return k(D(i),V(i),function(n,t){return r(e,i[n][t])})}else if(y(e)){if(I(i)||v(i))return e.map(function(n){return r(n,i)});if(y(i)){if(e.length!==i.length)throw"ne: inputs have incompatible dimensions";return e.map(function(n,t){return r(n,i[t])})}if(S(i)){if(e.length!==V(i))throw"ne: inputs have incompatible dimensions";return k(D(i),V(i),function(n,t){return r(e[t],i[n][t])})}}else if(S(e)){if(I(i)||v(i))return k(D(e),V(e),function(n,t){return r(e[n][t],i)});if(y(i)){if(V(e)!==i.length)throw"ne: inputs have incompatible dimensions";return k(D(e),V(e),function(n,t){return r(e[n][t],i[t])})}if(S(i)){if(D(e)!==D(i)||V(e)!==V(i))throw"ne: inputs have incompatible dimensions";return k(D(e),V(e),function(n,t){return r(e[n][t],i[n][t])})}}return 0}},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:P},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,t){return fn(n)&&fn(t)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,t){return fn(n)||fn(t)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,t){return fn(n)&&!fn(t)||fn(t)&&!fn(n)?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return fn(n)?0:1}},"=":{name:"set",breakpoint:"end",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,t){var r,e;return b(n)&&E(n[0],Xt)?(e=n,b(r=t)?await Promise.all(e.map(function(n,t){return $t(n,t<r.length?r[t]:null)})):await Promise.all(e.map(function(n,t){return $t(n,0===t?r:null)}))):$t(n,A.call(t,"$mainRet$")?t.$mainRet$:t)}}};async function $t(n,t){if(E(n,Xt)&&I(n.v))return await n.set(t),n.get(!0);throw"setting non-variable"}async function zt(n,t,r){var e,i,u,o,f,a,l=null;if(fn(await Ft(n.if.cond,t,r))){for(e=0,o=(f=n.if.statements).length;e<o;++e)null!=(a=await Ft(f[e],t,r))&&(l=a);return l}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(fn(await Ft(n.elseif[i].cond,t,r))){for(e=0,o=(f=n.elseif[i].statements).length;e<o;++e)null!=(a=await Ft(f[e],t,r))&&(l=a);return l}if(n.else.statements.length){for(e=0,o=(f=n.else.statements).length;e<o;++e)null!=(a=await Ft(f[e],t,r))&&(l=a);return l}}async function Ot(n,t,r){var e,i,u,o,f,a,l,c=null,s=!1,h=!1,p=await Ft(n.val,t,r),m=n.statements;if(b(p)){for(a=(r=r||{}).brk,l=r.cont,r.brk=function(){s=!0},r.cont=function(){h=!0},u=0,o=p.length;u<o;++u){for(h=s=!1,await n.ind.set(p[u]),e=0,i=m.length;e<i&&(f=await Ft(m[e],t,r),!s&&!h);++e)null!=f&&(c=f);if(s)break}r.brk=a,r.cont=l}return c}async function Mt(n,t,r){var e,i,u,o=null,f=!1,a=!1,l=n.statements,c=(r=r||{}).brk,s=r.cont;for(r.brk=function(){f=!0},r.cont=function(){a=!0};fn(await Ft(n.cond,t,r));){for(a=f=!1,e=0,i=l.length;e<i&&(u=await Ft(l[e],t,r),!f&&!a);++e)null!=u&&(o=u);if(f)break}return r.brk=c,r.cont=s,o}function Xt(n,t,r){if(!E(this,Xt))return new Xt(n,t,r);this.ctx=n,this.v=t,this.i=r}function q(n,t){if(!E(this,q))return new q(n,t);null==t&&(t=n,n=""),this.op=n,this.arg=t}function Zt(n,t){return 2===arguments.length&&b(n)&&(n.$mainRet$=t),n}async function Wt(n){return E(n,Xt)?await n.get():n}async function Ft(n,t,r){if(E(n,q))return Ut(n,t,r);if(b(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await Ft(n[e],t,r);return u}return n}function Qt(v,y,w,i){var x,b=0,S=0,u=v;function k(n,t,r){null==r&&(r=S),null==t&&(t=b);var e=u.split("\n")[r];return(n=String(n)+" at line "+String((w||0)+r)+" position "+String((i||0)+t)+":")+"\n"+e+"\n"+new Array(t+1).join(" ")+"^\n"}return function i(n){var t,r,e,u,o,f,a,l=[],c=[],s=[];function h(n){var t,r,e,i,u,o,f,a;if(c.length)if(n)for(;0<c.length;){if(u=(i=c.shift())[0],n===(o=qt[u]).breakpoint){c.unshift(i);break}if("-"===u&&1===l.length)l[0]=q(qt["*"].fn,[l[0],q(-1)]);else{if(o.arity>l.length)throw k('invalid or missing argument for "'+u+'"',i[1],i[2]);a=l.splice(0,o.arity).reverse(),f=q(o.fn,a),l.unshift(f)}}else if(r=(t=c.shift())[0],1===(e=qt[r]).fixity){if(e.arity>l.length)throw k('invalid or missing argument for "'+r+'"',t[1],t[2]);a=l.splice(0,e.arity).reverse(),f=q(e.fn,a),l.unshift(f)}else{if(-1!==e.fixity)for(;0<c.length&&(u=(i=c[0])[0],(o=qt[u]).priority<e.priority||o.priority===e.priority&&(o.associativity<e.associativity||o.associativity===e.associativity&&-1===o.associativity));){if("-"===u&&1===l.length)l[0]=q(qt["*"].fn,[l[0],q(-1)]);else{if(o.arity>l.length)throw k('invalid or missing argument for "'+u+'"',i[1],i[2]);a=l.splice(0,o.arity).reverse(),f=q(o.fn,a),l.unshift(f)}c.shift()}c.unshift(t)}}function p(n){if(h(!0),1<l.length||0<c.length)throw k("mismatched terms and operators",c.length?c[0][1]:b,c.length?c[0][2]:S);!0===n&&(E(l[0],q)&&s.push(l[0]),l=[],c=[])}function m(n,t){var r,e=n.test?v.match(n):n===v.slice(0,n.length);return!!e&&(!1===t?n.test?e:[n,n]:n.test?(r=e[t||0].length,v=v.slice(r),b+=r,e):(r=n.length,v=v.slice(r),b+=r,[n,n]))}function g(n,t,r){for(var e,i=r||0,u="";i<v.length;)if(n===(e=v.charAt(i))){if(!(i+1<v.length&&n===v.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return t&&(v=v.slice(i+1),b+=i+1),[u,i+1]}function d(){var n,t,r,e=function(n,t,r){for(var e,i=0,u=0;i<v.length;)if(e=v.charAt(i),!r||'"'!==e&&"'"!==e){if(t===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=g(e,!1,i+1)[1];return u||i>=v.length?-1:i}("]","[",!0);if(-1===e)throw k("mismatched brackets");if(n=v.slice(0,e),/[\[\]]/.test(n)){for(t=[];r=i(",;]");)if(t.push(r),m(","))t.push(q(","));else{if(!m(";"))break;t.push(q(";"))}m(/^\s+/),m("]")}else t=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,t){var r=n.length,e=0;return t.trim().split(-1<t.indexOf(",")?",":/\s+/g).reduce(function(n,t){return(t=Qt(t.trim(),y,S+w,b))&&(e?n.push(q(",")):r&&n.push(q(";")),n.push(t),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,t){return(t=Qt(t.trim(),y,S+w,b))&&(n.length&&n.push(q(",")),n.push(t)),n},[]),v=v.slice(e+1),b+=e+1,1<(n=n.split("\n")).length&&(S+=n.length-1,n.slice(0,-1).forEach(function(n){b-=n.length+1}));return q(qt["[]"].fn,t)}for(;0<v.length;)if(m(/^if\b/)){if(p(!0),!(a=i("\n,")))throw k('missing or invalid condition in "if"');for(m("\n")?(++S,b=0):m(","),o=(f={if:{cond:a,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((a=i(["elseif","else","end"]))&&(o.statements=o.statements.concat(a)),m("elseif")){if(!(a=i("\n,")))throw k('missing or invalid condition in "elseif"');m("\n")?(++S,b=0):m(","),f.elseif.push({cond:a,statements:[]}),o=f.elseif[f.elseif.length-1]}else if(m("else"))m(/^[ \t\v\f]+/),m("\n")&&(++S,b=0),o=f.else;else if(m("end")||!a)break;s.push(q(zt,f))}else if(m(/^for\b/)){if(p(!0),!(t=m(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw k('missing or invalid declaration in "for"');if(!(a=i("\n,")))throw k('missing or invalid declaration in "for"');for(m("\n")?(++S,b=0):m(","),f={ind:Xt(y,t[1]),val:a,statements:[]};(a=i(["end"]))&&(f.statements=f.statements.concat(a)),!m("end")&&a;);s.push(q(Ot,f))}else if(m(/^while\b/)){if(p(!0),!(a=i("\n,")))throw k('missing or invalid condition in "while"');for(m("\n")?(++S,b=0):m(","),f={cond:a,statements:[]};(a=i(["end"]))&&(f.statements=f.statements.concat(a)),!m("end")&&a;);s.push(q(Mt,f))}else if(t=m(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(t[1]))break;if("continue"===t[1])m("continue"),s.push(q("continue",""));else if("break"===t[1])m("break"),s.push(q("break",""));else{if("end"!==t[1])throw k('unexpected "'+t[1]+'"');m("end"),l.unshift(q("v",Xt(y,"end")))}}else if(m("..."))m(/^[ \t\v\f]+/),m("\n")&&(++S,b=0);else if(m(";",!1)){if(n&&-1<n.indexOf(";"))break;m(";"),p(!0)}else if(m("\n",!1)){if(n&&-1<n.indexOf("\n"))break;m("\n"),++S,p(!(b=0))}else if(m(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(t=m("%"))x=v.indexOf("\n"),v=v.slice(-1<x?x+1:v.length),++S,p(!(b=0));else if(t=(t=m("'"))||m('"'))o=g(t[0],!0)[0],l.unshift(q("'"===t[0]?o.split(""):o));else if(t=m(/^(&&|\|\|)[^&\|]/,1))u=t[1],c.unshift([u,b,S]),h();else if(t=m(/^(xor)[^a-zA-Z]/,1))u=t[1],c.unshift([u,b,S]),h();else if(t=m(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=t[1],c.unshift([u,b,S]),h();else if(t=m("~"))c.unshift(["~",b,S]),h();else if(t=m("="))c.unshift(["=",b,S]),h();else if(t=m(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=t[0],c.unshift([u,b,S]),h();else if(t=m(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(r=t[1],m(/^\s*\:\s*\)/))o=q("v",Xt(y,r)),l.unshift(o),c.unshift(["(:)",b,S]),h();else{for(f=[];(a=i(",)"))&&f.push(a),m(","););if(!m(")"))throw k("mismatched parentheses");o=A.call(_,r)?q(_[r],f):q("v",Xt(y,r,f.length?f:null)),l.unshift(o)}m(/^[ \t\v\f]+/),(t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h())}else if(t=m(/^[_a-z][_a-z0-9]*/i))r=t[0],o=A.call(_,r)&&0===_[r].length?q(_[r],[]):q("v",Xt(y,r)),l.unshift(o),m(/^[ \t\v\f]+/),(t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h());else if(t=m(/^(-?\s*\d+(\.\d+)?([eE]-?\d+)?)([ij])?/))f=parseFloat(t[1].split(/\s+/).join(""),10),o=q(t[4]?new R(0,f):f),l.unshift(o);else if("["===(e=v.charAt(0)))v=v.slice(1),b+=1,(o=d())&&(l.unshift(o),m(/^[ \t\v\f]+/),t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw k("mismatched brackets")}if("("===e)if(v=v.slice(1),b+=1,m(/^\s*\:\s*\)/))c.unshift(["(:)",b,S]),h();else{if(l.length&&c.reduce(function(n,t){return n+("-"===t[0]&&1===l.length?1:qt[t[0]].arity)},0)<=l.length){for(h("end"),o=l.shift(),f=[];(a=i(",)"))&&f.push(a),m(","););if(!m(")"))throw k("mismatched parentheses");f.length&&(o=q("v",Xt(y,o,f)))}else if(o=i(")"),!m(")"))throw k("mismatched parentheses");o&&(l.unshift(o),m(/^[ \t\v\f]+/),t=(t=m("'"))||m(".'"))&&(c.unshift([t[0],b,S]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw k("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw k(n?'missing expected "'+(I(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(v=v.slice(1),a=[b+=1,S],h("end"),l.length?f=1:(f=0,l.unshift(q(":")));o=i(":,)\n"),m(/^[ \t\v\f]+/),o?(l.unshift(o),++f):m(":",!1)&&l.unshift(q(":")),m(":"););1<f&&(c.unshift([3===f?"::":":",a[0],a[1]]),h())}}return p(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function Ut(n,t,r){if(E(n,q)){if(""===n.op)return n.arg;if("v"===n.op)return!1===t?n.arg:E(n.arg.v,q)?Wt(n.arg):J(t)&&A.call(t,n.arg.v)?t[n.arg.v]:await Wt(n.arg);if(zt===n.op)return zt(n.arg,t,r);if(Ot===n.op)return Ot(n.arg,t,r);if(Mt===n.op)return Mt(n.arg,t,r);if("break"===n.op)return void(r&&Y(r.brk)&&r.brk());if("continue"===n.op)return void(r&&Y(r.cont)&&r.cont());if(qt["="].fn===n.op)return r=r||{},r.mainRet=!1,2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[await Ut(n.arg[0],!1),n.arg[1].arg.isByRef()?un(await Ut(n.arg[1],t,r)):await Ut(n.arg[1],t,r)]):n.op.apply(null,[await Ut(n.arg[0],!1)].concat(await Promise.all(n.arg.slice(1).map(function(n){return Ut(n,t,r)}))));if(Y(n.op))return n=await n.op.apply(null,await Promise.all(n.arg.map(function(n){return Ut(n,t,r)}))),r&&!1===r.mainRet||!A.call(n,"$mainRet$")?n:n.$mainRet$}throw"invalid expr"}return T.op=qt,Xt.prototype={constructor:Xt,ctx:null,v:null,i:null,get:async function(n){var t,r,e=this;if(E(e.v,q))t=await Ft(e.v);else{if(!A.call(e.ctx,e.v)&&!A.call(d,e.v))throw'undefined variable "'+e.v+'"';t=(A.call(e.ctx,e.v)?e.ctx:d)[e.v]}return!0!==n&&null!=e.i?(r=Mn(t),n=await Promise.all(e.i.map(function(n,t){return Ft(n,{end:1===e.i.length?r[0]*r[1]:r[t]})})),Ln.apply(null,[t].concat(n))):t},set:async function(n){var t,r,e,i=this;if(null!=i.i){if(E(i.v,q))t=await Ft(i.v);else{if(!A.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';t=i.ctx[i.v]}r=Mn(t),1===(e=await Promise.all(i.i.map(function(n,t){return Ft(n,{end:1===i.i.length?r[0]*r[1]:r[t]})}))).length&&(e=e.concat(null)),jn.apply(null,[t].concat(e).concat([n]))}else E(i.v,q)||(i.ctx[i.v]=n);return i},isset:function(){return I(this.v)&&A.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},q.prototype={constructor:q,op:null,arg:null},T.ret=Zt,T.createCanvas=function(n,t){},T.currentCanvas=function(){},T.createContext=function(){return{ans:null}},T.eval=async function(n,t,r){t=t||T.createContext();var e=Qt(String(n),t,null==r?1:r,1),i=null,u=!1;if(b(e))for(var o=0,f=e.length;o<f;++o)e[o]&&(i=await Ut(e[o]),u=!0);else e&&(i=await Ut(e),u=!0);return u&&(b(i)||g(i)||v(i)||I(i))&&(t.ans=i),u?i:null},T});