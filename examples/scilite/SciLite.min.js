/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.5
* https://github.com/foo123/SciLite
*
**/
!function(r,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(r)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(r)}):n in r||(r[n]=t.call(r)||1)&&"function"==typeof define&&define.amd&&define(function(){return r[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function r(){}var t,_=Math,X={},i={},M=_.PI,f=_.E,o=1/0,l=NaN,Y=1e-15,a=Number.MAX_VALUE,nn=Number.MIN_VALUE,s=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,k=null,O=Object.prototype.hasOwnProperty,m=Object.prototype.toString,S=Array.isArray||function(n){return"[object Array]"===m.call(n)},g={VERSION:"0.9.5",_:{},fn:{},op:{},constant:{pi:M,e:f,eps:Y,realmax:a,realmin:nn,intmax:s,intmin:h,inf:o,Inf:o,nan:l,NaN:l}},c=g._,p=g.constant,A=g.fn;function y(n){throw String(n)+": input(s) not supported"}function rn(n,r){return n instanceof r}function d(n){return"function"==typeof n}function tn(n){return"[object Object]"===m.call(n)}function E(n){return"string"==typeof n}function en(n){return fn(n)&&n.isNaN()||Number.isNaN(n)}function un(n){return fn(n)&&!n.isFinite()||u(n)&&!isFinite(n)}function u(n){return"number"==typeof n}function fn(n){return null!=k&&n instanceof k}function C(n){return"number"==typeof n||null!=k&&n instanceof k}function w(n){return fn(n)&&n.isInt()||u(n)&&Number.isInteger(n)}function e(n){return n instanceof j}function b(n,r){if(u(n)||e(n)||fn(n))return!0;if(!1===r){if(v(n)&&1===n.length)return!0;if(I(n)&&1===n.length&&1===n[0].length)return!0}return!1}function v(n){return S(n)&&b(n[0])}function I(n){return S(n)&&S(n[0])&&b(n[0][0])}function on(n){return!S(n)}function cn(n){return S(n)&&!S(n[0])}function ln(n){return S(n)&&S(n[0])}function an(n){return!e(n)||$(n.im,0)}function sn(n,r){return u(n)||fn(n)?n:e(n)?r?!!$(n.im,0)&&n.re:n:v(n)?1===n.length&&sn(n[0],r):!!I(n)&&1===n.length&&1===n[0].length&&sn(n[0][0],r)}function Z(n,r){for(var t=new Array(n),i=0;i<n;++i)t[i]=d(r)?r(i,t):r;return t}function N(n,r,t){for(var i,e,u=new Array(n),f=0;f<n;++f)for(u[f]=e=new Array(r),i=0;i<r;++i)e[i]=d(t)?t(f,i,u):t;return u}function hn(n){if(ln(n)){if(1===J(n))return n[0];if(1===K(n))return n.map(function(n){return n[0]})}else if(on(n))return[n];return n}function q(n){return"number"==typeof n?n:fn(n)?n.$valueOf():n.valueOf()}function mn(n){return null!=k&&"number"==typeof n?k(n):n}function gn(n){return S(n)?n.map(gn):b(n)?q(n):n}function $(n,r){return u(n)?u(r)?n===r:r.eq(n):n.eq(r)}function pn(n,r){return u(n)?u(r)?n<r:r.gt(n):n.lt(r)}function dn(n,r){return u(n)?u(r)?r<n:r.lt(n):n.gt(r)}function vn(n,r){return u(n)?u(r)?n<=r:r.gte(n):n.lte(r)}function yn(n,r){return u(n)?u(r)?r<=n:r.lte(n):n.gte(r)}function F(n,r){return u(n)?u(r)?n+r:r.add(n):n.add(r)}function W(n,r){return u(n)?u(r)?n-r:r.neg().add(n):n.sub(r)}function Q(n,r){return u(n)?u(r)?n*r:r.mul(n):n.mul(r)}function wn(n,r){return u(n)?u(r)?n/r:k(n).div(r):n.div(r)}function bn(n,r){return u(n)?u(r)?_.pow(n,r):k(n).pow(r):n.pow(r)}function xn(n,r){return u(n)?u(r)?n%r:k(n).mod(r):n.mod(r)}function _n(n){return u(n)?-n:n.neg()}function Sn(n){return u(n)?1/n:k(1).div(n)}function kn(n){return n=S(n)?n.map(kn):n}function An(r,n,t){if(!0===r)return n;if(C(n))return r(n);if(e(n)){if(t)return r(n);if($(n.im,0))return r(n.re)}return S(n)?n.map(function(n){return An(r,n,t)}):n}function En(n){if(E(n))return 0<n.length;if(en(n))return!1;if(u(n))return 0!==n;if(fn(n))return!n.eq(0);if(e(n))return!$(n.re,0)||!$(n.im,0);if(S(n)){if(!n.length)return!1;for(var r=0,t=n.length;r<t;++r)if(!En(n[r]))return!1;return!0}return!0===n}function In(n,t){return b(t)?b(n)?R(n,t):n.filter(function(n){return In(n,t)}).length===n.length:!!S(t)&&(b(n)?In(t,n):n.length===t.length&&n.filter(function(n,r){return In(n,t[r])}).length===t.length)}function j(n,r,t){var i=this;if(!rn(i,j))return new j(n,r,t);e(n)?(i.re=n.re,i.im=n.im):(r=r||0,"polar"===t?(i._rho=X.abs(n),i._theta=r,i.re=Q(i._rho,X.cos(i._theta)),i.im=Q(i._rho,X.sin(i._theta))):(i.re=n,i.im=r))}function Nn(n){return en(n)?n="nan":un(n)?n=(pn(n,0)?"-":"")+"inf":w(n)?n=String(n):C(n)?n=n.toFixed(4).replace(/\.0{4}$/,""):e(n)&&(n=String(n)),n}function qn(t){var r;return null==t?t="":E(t)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(t)&&(t="\\text{"+t+"}"):t=en(t)?"\\text{nan}":C(t)?[Y,a,nn,s,h].reduce(function(n,r){return n||$(t,r)},!1)?String(t):Nn(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):e(t)?String(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):I(t)?(r=!1,K(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,_.round(c.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-_.round(c.MAXPRINTSIZE/2)))}),r=!0),"\\begin{bmatrix}"+(t=J(t)>c.MAXPRINTSIZE?t.slice(0,_.round(c.MAXPRINTSIZE/2)).concat([Z(c.MAXPRINTSIZE,function(n){return _.round(c.MAXPRINTSIZE/2)===n&&r?"\\ddots":"\\vdots"})]).concat(t.slice(1-_.round(c.MAXPRINTSIZE/2))):t).map(function(n){return n.map(qn).join(" & ")}).join(" \\\\ ")+"\\end{bmatrix}"):S(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,_.round(c.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(t.slice(1-_.round(c.MAXPRINTSIZE/2))):t).map(qn).join(" \\hskip 1em "):"object"==typeof t||"function"==typeof t?"":String(t),t}function jn(n){return S(n)?n.map(jn):e(n)&&$(n.im,0)?n.re:n}function Rn(n){return S(n)?n.map(Rn):C(n)?new j(n,0):n}function Ln(n,r){var t,i,e;return u(n)&&u(r)?(t=n,i=r,t=_.abs(t),i=_.abs(i),(e=0)===t?i:0===i?t:i<t?t*_.sqrt(1+(e=i/t)*e):t<i?i*_.sqrt(1+(e=t/i)*e):t*_.SQRT2):X.sqrt(F(Q(n,n),Q(r,r)))}function Pn(n,r){var t,n=1===arguments.length?n:Un(n,r);return n.reduce(function(n,r){return n&&(u(r)||e(r)&&u(r.re)&&u(r.im))},!0)?(t=0,r=(r=n).map(function(n){return n=D(n),t<n&&(t=n),n}),0===t?0:t*_.sqrt(r.reduce(function(n,r){return r===t?n+1:n+(n=r/t)*n},0))):X.sqrt(Dn(hr(n,n)))}function Tn(){var n,r,t,i=0,e=0;if(u(Tn.z1))return t=Tn.z1,Tn.z1=null,t;for(;0===i||1===i;)i=_.random();for(;0===e||1===e;)e=_.random();return r=(n=_.sqrt(-2*_.log(i)))*_.cos(2*M*e),t=n*_.sin(2*M*e),Tn.z1=t,r}function R(t,i){if(E(t)){if(E(i))return t===i?1:0;if(b(i))return t===String(i)?1:0;if(v(i))return i.map(function(n){return R(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return R(t,i[n][r])})}else if(C(t)){if(E(i))return String(t)===i?1:0;if(C(i))return $(t,i)?1:0;if(e(i))return $(i.re,t)&&$(i.im,0)?1:0;if(v(i))return i.map(function(n){return R(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return R(t,i[n][r])})}else if(e(t)){if(E(i))return String(t)===i?1:0;if(C(i))return $(t.re,i)&&$(t.im,0)?1:0;if(e(i))return $(t.re,i.re)&&$(t.im,i.im)?1:0;if(v(i))return i.map(function(n){return R(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return R(t,i[n][r])})}else if(v(t)){if(E(i)||b(i))return t.map(function(n){return R(n,i)});if(v(i)){if(t.length!==i.length)throw"eq: inputs have incompatible dimensions";return t.map(function(n,r){return R(n,i[r])})}if(I(i)){if(t.length!==K(i))throw"eq: inputs have incompatible dimensions";return N(J(i),K(i),function(n,r){return R(t[r],i[n][r])})}}else if(I(t)){if(E(i)||b(i))return N(J(t),K(t),function(n,r){return R(t[n][r],i)});if(v(i)){if(K(t)!==i.length)throw"eq: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return R(t[n][r],i[r])})}if(I(i)){if(J(t)!==J(i)||K(t)!==K(i))throw"eq: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return R(t[n][r],i[n][r])})}}return 0}function zn(t,i){if(E(t)){if(E(i))return t===i?0:1;if(b(i))return t===String(i)?0:1;if(v(i))return i.map(function(n){return zn(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return zn(t,i[n][r])})}else if(C(t)){if(E(i))return String(t)===i?0:1;if(C(i))return $(t,i)?0:1;if(e(i))return $(i.re,t)&&$(i.im,0)?0:1;if(v(i))return i.map(function(n){return zn(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return zn(t,i[n][r])})}else if(e(t)){if(E(i))return String(t)===i?0:1;if(C(i))return $(t.re,i)&&$(t.im,0)?0:1;if(e(i))return $(t.re,i.re)&&$(t.im,i.im)?0:1;if(v(i))return i.map(function(n){return zn(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return zn(t,i[n][r])})}else if(v(t)){if(E(i)||b(i))return t.map(function(n){return zn(n,i)});if(v(i)){if(t.length!==i.length)throw"ne: inputs have incompatible dimensions";return t.map(function(n,r){return zn(n,i[r])})}if(I(i)){if(t.length!==K(i))throw"ne: inputs have incompatible dimensions";return N(J(i),K(i),function(n,r){return zn(t[r],i[n][r])})}}else if(I(t)){if(E(i)||b(i))return N(J(t),K(t),function(n,r){return zn(t[n][r],i)});if(v(i)){if(K(t)!==i.length)throw"ne: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return zn(t[n][r],i[r])})}if(I(i)){if(J(t)!==J(i)||K(t)!==K(i))throw"ne: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return zn(t[n][r],i[n][r])})}}return 0}function Mn(t,i){if(E(t)){if(E(i))return t<i?1:0;if(b(i))return t<String(i)?1:0;if(v(i))return i.map(function(n){return Mn(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return Mn(t,i[n][r])})}else if(C(t)){if(E(i))return String(t)<i?1:0;if(C(i))return pn(t,i)?1:0;if(e(i))return pn(i.re,t)&&$(i.im,0)?1:0;if(v(i))return i.map(function(n){return Mn(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return Mn(t,i[n][r])})}else if(e(t)){if(E(i))return String(t)<i?1:0;if(C(i))return pn(t.re,i)&&$(t.im,0)?1:0;if(e(i))return pn(t.re,i.re)&&$(t.im,0)&&$(i.im,0)||pn(t.im,i.im)&&$(t.re,0)&&$(i.re,0)?1:0;if(v(i))return i.map(function(n){return Mn(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return Mn(t,i[n][r])})}else if(v(t)){if(E(i)||b(i))return t.map(function(n){return Mn(n,i)});if(v(i)){if(t.length!==i.length)throw"lt: inputs have incompatible dimensions";return t.map(function(n,r){return Mn(n,i[r])})}if(I(i)){if(t.length!==K(i))throw"lt: inputs have incompatible dimensions";return N(J(i),K(i),function(n,r){return Mn(t[r],i[n][r])})}}else if(I(t)){if(E(i)||b(i))return N(J(t),K(t),function(n,r){return Mn(t[n][r],i)});if(v(i)){if(K(t)!==i.length)throw"lt: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return Mn(t[n][r],i[r])})}if(I(i)){if(J(t)!==J(i)||K(t)!==K(i))throw"lt: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return Mn(t[n][r],i[n][r])})}}return 0}function On(t,i){if(E(t)){if(E(i))return i<t?1:0;if(b(i))return t>String(i)?1:0;if(v(i))return i.map(function(n){return On(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return On(t,i[n][r])})}else if(C(t)){if(E(i))return String(t)>i?1:0;if(C(i))return dn(t,i)?1:0;if(e(i))return dn(i.re,t)&&$(i.im,0)?1:0;if(v(i))return i.map(function(n){return On(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return On(t,i[n][r])})}else if(e(t)){if(E(i))return String(t)>i?1:0;if(C(i))return dn(t.re,i)&&$(t.im,0)?1:0;if(e(i))return dn(t.re,i.re)&&$(t.im,0)&&$(i.im,0)||dn(t.im,i.im)&&$(t.re,0)&&$(i.re,0)?1:0;if(v(i))return i.map(function(n){return On(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return On(t,i[n][r])})}else if(v(t)){if(E(i)||b(i))return t.map(function(n){return On(n,i)});if(v(i)){if(t.length!==i.length)throw"gt: inputs have incompatible dimensions";return t.map(function(n,r){return On(n,i[r])})}if(I(i)){if(t.length!==K(i))throw"gt: inputs have incompatible dimensions";return N(J(i),K(i),function(n,r){return On(t[r],i[n][r])})}}else if(I(t)){if(E(i)||b(i))return N(J(t),K(t),function(n,r){return On(t[n][r],i)});if(v(i)){if(K(t)!==i.length)throw"gt: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return On(t[n][r],i[r])})}if(I(i)){if(J(t)!==J(i)||K(t)!==K(i))throw"gt: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return On(t[n][r],i[n][r])})}}return 0}function L(t,i){if(E(t)){if(E(i))return t<=i?1:0;if(b(i))return t<=String(i)?1:0;if(v(i))return i.map(function(n){return L(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return L(t,i[n][r])})}else if(C(t)){if(E(i))return String(t)<=i?1:0;if(C(i))return vn(t,i)?1:0;if(e(i))return vn(i.re,t)&&$(i.im,0)?1:0;if(v(i))return i.map(function(n){return L(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return L(t,i[n][r])})}else if(e(t)){if(E(i))return String(t)<=i?1:0;if(C(i))return vn(t.re,i)&&$(t.im,0)?1:0;if(e(i))return vn(t.re,i.re)&&$(t.im,0)&&$(i.im,0)||vn(t.im,i.im)&&$(t.re,0)&&$(i.re,0)?1:0;if(v(i))return i.map(function(n){return L(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return L(t,i[n][r])})}else if(v(t)){if(E(i)||b(i))return t.map(function(n){return L(n,i)});if(v(i)){if(t.length!==i.length)throw"le: inputs have incompatible dimensions";return t.map(function(n,r){return L(n,i[r])})}if(I(i)){if(t.length!==K(i))throw"le: inputs have incompatible dimensions";return N(J(i),K(i),function(n,r){return L(t[r],i[n][r])})}}else if(I(t)){if(E(i)||b(i))return N(J(t),K(t),function(n,r){return L(t[n][r],i)});if(v(i)){if(K(t)!==i.length)throw"le: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return L(t[n][r],i[r])})}if(I(i)){if(J(t)!==J(i)||K(t)!==K(i))throw"le: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return L(t[n][r],i[n][r])})}}return 0}function Xn(t,i){if(E(t)){if(E(i))return i<=t?1:0;if(b(i))return t>=String(i)?1:0;if(v(i))return i.map(function(n){return Xn(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return Xn(t,i[n][r])})}else if(C(t)){if(E(i))return String(t)>=i?1:0;if(C(i))return yn(t,i)?1:0;if(e(i))return yn(i.re,t)&&$(i.im,0)?1:0;if(v(i))return i.map(function(n){return Xn(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return Xn(t,i[n][r])})}else if(e(t)){if(E(i))return String(t)>=i?1:0;if(C(i))return yn(t.re,i)&&$(t.im,0)?1:0;if(e(i))return yn(t.re,i.re)&&$(t.im,0)&&$(i.im,0)||yn(t.im,i.im)&&$(t.re,0)&&$(i.re,0)?1:0;if(v(i))return i.map(function(n){return Xn(t,n)});if(I(i))return N(J(i),K(i),function(n,r){return Xn(t,i[n][r])})}else if(v(t)){if(E(i)||b(i))return t.map(function(n){return Xn(n,i)});if(v(i)){if(t.length!==i.length)throw"ge: inputs have incompatible dimensions";return t.map(function(n,r){return Xn(n,i[r])})}if(I(i)){if(t.length!==K(i))throw"ge: inputs have incompatible dimensions";return N(J(i),K(i),function(n,r){return Xn(t[r],i[n][r])})}}else if(I(t)){if(E(i)||b(i))return N(J(t),K(t),function(n,r){return Xn(t[n][r],i)});if(v(i)){if(K(t)!==i.length)throw"ge: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return Xn(t[n][r],i[r])})}if(I(i)){if(J(t)!==J(i)||K(t)!==K(i))throw"ge: inputs have incompatible dimensions";return N(J(t),K(t),function(n,r){return Xn(t[n][r],i[n][r])})}}return 0}function Cn(n){return e(n)?n.sign():X.sign(n)}function U(n,r){return C(n)&&C(r)?F(n,r):e(n)&&b(r)?n.add(r):e(r)&&b(n)?r.add(n):l}function B(n,r){return C(n)&&C(r)?W(n,r):e(n)&&b(r)?n.sub(r):e(r)&&b(n)?r.neg().add(n):l}function V(n,r){return C(n)&&C(r)?Q(n,r):e(n)&&b(r)?n.mul(r):e(r)&&b(n)?r.mul(n):l}function G(n,r){return C(n)&&C(r)?wn(n,r):e(n)&&b(r)?n.div(r):e(r)&&b(n)?r.inv().mul(n):l}function Zn(n,r){return C(n)&&C(r)?bn(n,r):e(n)&&b(r)?n.pow(r):e(r)&&b(n)?new j(n,0).pow(r):l}function $n(n){return C(n)?_n(n):e(n)?n.neg():l}function H(n){return C(n)?n:e(n)?n.conj():l}function Fn(n){return C(n)?$(n,0)?o:Sn(n):e(n)?$(n.abs(),0)?new j(o,pn(n.im,0)?o:-o):n.inv():l}function D(n){return C(n)?X.abs(n):e(n)?n.abs():l}function Wn(n){return C(n)?pn(n,0)?M:0:e(n)?n.angle():l}function Qn(r,i){if(E(r)&&E(i))return r+i;if(b(r)&&b(i))return U(r,i);if(I(r)&&I(i)){if(J(r)===J(i)&&K(r)===K(i))return r.map(function(n,t){return n.map(function(n,r){return Qn(n,i[t][r])})});throw"add: matrix dimensions do not match"}if(v(r)&&v(i)){if(r.length===i.length)return r.map(function(n,r){return Qn(n,i[r])});throw"add: vector dimensions do not match"}return S(r)?r.map(function(n){return Qn(n,i)}):S(i)?i.map(function(n){return Qn(r,n)}):void y("add")}function Un(r,i){if(b(r)&&b(i))return B(r,i);if(I(r)&&I(i)){if(J(r)===J(i)&&K(r)===K(i))return r.map(function(n,t){return n.map(function(n,r){return Un(n,i[t][r])})});throw"sub: matrix dimensions do not match"}if(v(r)&&v(i)){if(r.length===i.length)return r.map(function(n,r){return Un(n,i[r])});throw"sub: vector dimensions do not match"}return S(r)?r.map(function(n){return Un(n,i)}):S(i)?i.map(function(n){return Un(r,n)}):void y("sub")}function Bn(r,i){if(b(r)&&b(i))return V(r,i);if(I(r)&&I(i)){if(J(r)===J(i)&&K(r)===K(i))return r.map(function(n,t){return n.map(function(n,r){return Bn(n,i[t][r])})});throw"dotmul: matrix dimensions do not match"}if(v(r)&&v(i)){if(r.length===i.length)return r.map(function(n,r){return Bn(n,i[r])});throw"dotmul: vector dimensions do not match"}return S(r)?r.map(function(n){return Bn(n,i)}):S(i)?i.map(function(n){return Bn(r,n)}):void y("dotmul")}function Vn(r,i){if(b(r)&&b(i))return G(r,i);if(I(r)&&I(i)){if(J(r)===J(i)&&K(r)===K(i))return r.map(function(n,t){return n.map(function(n,r){return Vn(n,i[t][r])})});throw"dotdiv: matrix dimensions do not match"}if(v(r)&&v(i)){if(r.length===i.length)return r.map(function(n,r){return Vn(n,i[r])});throw"dotdiv: vector dimensions do not match"}return S(r)?r.map(function(n){return Vn(n,i)}):S(i)?i.map(function(n){return Vn(r,n)}):void y("dotdiv")}function Gn(r,i){if(b(r)&&b(i))return Zn(r,i);if(I(r)&&I(i)){if(J(r)===J(i)&&K(r)===K(i))return r.map(function(n,t){return n.map(function(n,r){return Gn(n,i[t][r])})});throw"dotpow: matrix dimensions do not match"}if(v(r)&&v(i)){if(r.length===i.length)return r.map(function(n,r){return Gn(n,i[r])});throw"dotpow: vector dimensions do not match"}return S(r)?r.map(function(n){return Gn(n,i)}):S(i)?i.map(function(n){return Gn(r,n)}):void y("dotpow")}function P(e,u){if(b(e)&&b(u))return V(e,u);if(I(e)&&I(u)){if(K(e)===J(u))return n=J(e),r=K(u),f=J(u),N(n,r,function(n,r){for(var t=0,i=0;i<f;++i)t=U(t,V(e[n][i],u[i][r]));return t});throw"mul: matrix-matrix dimensions do not match"}if(v(e)&&I(u)){if(e.length===J(u))return r=K(u),f=e.length,N(n=1,r,function(n,r){for(var t=0,i=0;i<f;++i)t=U(t,V(e[i],u[i][r]));return t});throw"mul: vector-matrix dimensions do not match"}if(I(e)&&v(u)){var f;if(K(e)===u.length)return n=J(e),f=u.length,N(n,r=1,function(n,r){for(var t=0,i=0;i<f;++i)t=U(t,V(e[n][i],u[i]));return t});throw"mul: matrix-vector dimensions do not match"}var n,r;return v(e)&&v(u)?N(n=e.length,r=u.length,function(n,r){return V(e[n],u[r])}):S(e)?e.map(function(n){return P(n,u)}):S(u)?u.map(function(n){return P(e,n)}):void y("mul")}function Hn(n,r){if(b(n)&&b(r))return Zn(n,r);if(I(n)&&J(n)===K(n)&&w(r)){if((r=q(r))<0&&(r=-r,!(n=zr(n))||!n.length))throw"pow: no inverse";if(0===r)return ar(J(n));if(1===r)return n;if(2===r)return P(n,n);for(var t=ar(J(n));0!==r;)1&r&&(t=P(t,n)),0<(r>>=1)&&(n=P(n,n));return t}y("pow")}function Dn(n){return An(function(n){return e(n)?n.re:n},n,!0)}function Jn(n){return An(function(n){return e(n)?n.im:0},n,!0)}function Kn(n){return An(H,n,!0)}function Yn(n){return An(D,n,!0)}function nr(i,n=":",t=null){if(cn(i)){if(v(n)&&n.length===i.length&&Nr(n,function(n){return 0===q(n)||1===q(n)}))return f=1===(f=n.reduce(function(n,r,t){return 1===q(r)&&n.push(i[t]),n},[])).length?f[0]:f;if(":"===(n=b(n)?sn(n,!0):n)||w(n)||v(n))return r=i.length,1===(f=(n=w(n=":"===n?pr(1,r):n)?[n]:n).map(function(n){if((n=q(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return i[n-1]})).length?f[0]:f;throw"get: invalid range"}if(ln(i)){var e=J(i),u=K(i),r=e*u;if(null==t&&I(n)&&J(n)===e&&K(n)===u&&Nr(n,function(n){return 0===q(n)||1===q(n)})){for(var f=[],o=0;o<u;++o)for(var c=0;c<e;++c)1===q(n[c][o])&&f.push(i[c][o]);return f=1===f.length?f[0]:f}if(b(n)&&(n=sn(n,!0)),b(t)&&(t=sn(t,!0)),":"===n||w(n)||v(n)){if(w(n=":"===n?pr(1,e):n)&&(n=[n]),null==t)return f=1===(f=n.map(function(n){if((n=q(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return i[(n-1)%e][_.floor((n-1)/e)]})).length?f[0]:f;if(":"===t||w(t)||v(t))return w(t=":"===t?pr(1,u):t)&&(t=[t]),f=1===(f=n.map(function(r){if((r=q(r))<1&&(r+=e),r<1||e<r)throw"get: index out of bounds";return t.map(function(n){if((n=q(n))<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return i[r-1][n-1]})})).length&&1===f[0].length?f[0][0]:f}throw"get: invalid range"}return i}function rr(e,r=":",n=null,u=null){if(cn(e)){if(v(r)&&r.length===e.length&&Nr(r,function(n){return 0===q(n)||1===q(n)})){if(on(u))return r.forEach(function(n,r){1===q(n)&&(e[r]=u)}),e;if(S(u))return i=0,r.forEach(function(n,r){if(1===q(n)){if(i>=u.length)throw"set: index out of bounds";e[r]=u[i++]}}),e}if(":"===(r=b(r)?sn(r,!0):r)||w(r)||v(r)){var t=e.length;if(w(r=":"===r?pr(1,t):r)&&(r=[r]),on(u))return r.forEach(function(n){if((n=q(n))<1&&(n+=t),n<1||t<n)throw"set: index out of bounds";e[n-1]=u}),e;if(S(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=q(n))<1&&(n+=t),n<1||t<n)throw"set: index out of bounds";e[n-1]=u[r]}),e;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(ln(e)){var f=J(e),o=K(e),t=f*o;if(I(r)&&J(r)===f&&K(r)===o&&Nr(r,function(n){return 0===q(n)||1===q(n)})){if(on(u))return r.forEach(function(n,t){n.forEach(function(n,r){1===q(n)&&(e[t][r]=u)})}),e;if(S(u)){for(var i=0,c=0;c<o;++c)for(var l=0;l<f;++l)if(1===q(r[l][c])){if(i>=u.length)throw"set: index out of bounds";e[l][c]=u[i++]}return e}}if(b(r)&&(r=sn(r,!0)),b(n)&&(n=sn(n,!0)),":"===r||w(r)||v(r)){if(null==n){if(w(r=":"===r?pr(1,t):r)&&(r=[r]),on(u))return r.forEach(function(n){if((n=q(n))<1&&(n+=t),n<1||t<n)throw"set: index out of bounds";e[(n-1)%f][_.floor((n-1)/f)]=u}),e;if(cn(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=q(n))<1&&(n+=t),n<1||t<n)throw"set: index out of bounds";e[(n-1)%f][_.floor((n-1)/f)]=u[r]}),e}else if(":"===n||w(n)||v(n)){if(w(r=":"===r?pr(1,f):r)&&(r=[r]),w(n=":"===n?pr(1,o):n)&&(n=[n]),on(u))return r.forEach(function(r){if((r=q(r))<1&&(r+=f),r<1||f<r)throw"set: index out of bounds";n.forEach(function(n){if((n=q(n))<1&&(n+=o),n<1||o<n)throw"set: index out of bounds";e[r-1][n-1]=u})}),e;if(cn(u)&&u.length>=r.length*n.length)return i=0,n.forEach(function(t,n){if((t=q(t))<1&&(t+=o),t<1||o<t)throw"set: index out of bounds";r.forEach(function(n,r){if((n=q(n))<1&&(n+=f),n<1||f<n)throw"set: index out of bounds";e[n-1][t-1]=u[i++]})}),e;if(ln(u)&&u.length>=r.length&&u[0].length>=n.length)return r.forEach(function(t,i){if((t=q(t))<1&&(t+=f),t<1||f<t)throw"set: index out of bounds";n.forEach(function(n,r){if((n=q(n))<1&&(n+=o),n<1||o<n)throw"set: index out of bounds";e[t-1][n-1]=u[i][r]})}),e}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return e}function tr(n,r,t){return"horz"===n&&ln(r)&&ln(t)&&J(r)===J(t)?r.map(function(n,r){return n.concat(t[r])}):"vert"===n&&ln(r)&&ln(t)&&K(r)===K(t)?r.concat(t):void y("cat")}function ir(t,n){var i,e;return on(t)?t:cn(t)?t.slice().reverse():ln(t)?(i=J(t),e=K(t),1===(n=q(n=null==n?1:n))?N(i,e,function(n,r){return t[i-1-n][r]}):2===n?N(i,e,function(n,r){return t[n][e-1-r]}):t):void y("flip")}function er(n,r){var t=Dn(n),i=Dn(r),n=Jn(n),r=Jn(r),t=pn(t,i)?-1:dn(t,i)?1:0,i=pn(n,r)?-1:dn(n,r)?1:0;return t||i}function ur(n,r){var t=D(n),i=D(r),n=Wn(n),r=Wn(r),t=pn(t,i)?-1:dn(t,i)?1:0,i=pn(n,r)?-1:dn(n,r)?1:0;return t||i}function fr(r,t,i,e,n){var u;if(on(r))return r;if(v(r))return null==e&&(e=an(r)?er:ur),u=r.map(function(n,r){return{v:n,i:r}}).sort("descend"===i?function(n,r){return e(r.v,n.v)||n.i-r.i}:function(n,r){return e(n.v,r.v)||n.i-r.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(I(r)){if(1===t)return n?(u=Z(K(r),function(n){n=T(r,n);return fr(n,t,i,null==e?an(n)?er:ur:e,!0)}),[N(J(r),K(r),function(n,r){return u[r][0][n]}),N(J(r),K(r),function(n,r){return u[r][1][n]})]):(u=Z(K(r),function(n){n=T(r,n);return fr(n,t,i,null==e?an(n)?er:ur:e,!1)}),N(J(r),K(r),function(n,r){return u[r][n]}));if(2===t)return n?(u=Z(J(r),function(n){n=r[n];return fr(n,t,i,null==e?an(n)?er:ur:e,!0)}),[N(J(r),K(r),function(n,r){return u[n][0][r]}),N(J(r),K(r),function(n,r){return u[n][1][r]})]):(u=Z(J(r),function(n){n=r[n];return fr(n,t,i,null==e?an(n)?er:ur:e,!1)}),N(J(r),K(r),function(n,r){return u[n][r]}))}y("sort")}function or(r){var n=[].slice.call(arguments,1);return S(n[0])&&(n=n[0]),on(r)?n.length?n.map(function(n){return[1,1][q(n)-1]}):[1,1]:cn(r)?n.length?n.map(function(n){return[1,r.length][q(n)-1]}):[1,r.length]:ln(r)?n.length?n.map(function(n){return[J(r),K(r)][q(n)-1]}):[J(r),K(r)]:[]}function cr(n){return S(n)?_.max.apply(null,or(n)):null==n?0:1}function lr(n,r){return v(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),N(q(n),q(r),0)}function ar(n){return N(q(n=sn(n=null==n?1:n,!0)),q(n),function(n,r){return n===r?1:0})}function sr(t,e){return e=q(e||0),on(t)?[[t]]:cn(t)?N(t.length,t.length,function(n,r){return e===n-r?t[n]:0}):ln(t)?t.reduce(function(n,r,i){return r.reduce(function(n,r,t){return e===i-t&&n.push(r),n},n)},[]):void y("diag")}function hr(r,i,e){if(e=!0===e,b(r)&&b(i))return V(r,e?i:H(i));if(v(r)&&v(i)){if(r.length===i.length)return r.reduce(function(n,r,t){return U(n,V(r,e?i[t]:H(i[t])))},0)}else if(I(r)&&I(i)&&J(r)===J(i)&&K(r)===K(i))return Z(K(r),function(n){return hr(T(r,n),T(i,n),e)});return 0}function mr(t){return ln(t)?N(K(t),J(t),function(n,r){return t[r][n]}):t}function gr(t){return ln(t)?N(K(t),J(t),function(n,r){return b(t[r][n])?H(t[r][n]):t[r][n]}):cn(t)?t.map(function(n){return b(n)?H(n):n}):b(t)?H(t):t}function pr(n,r,t){if(1===arguments.length){if(ln(n)){for(var i,e=J(n),u=K(n),f=new Array(u*e),o=0,c=0;c<u;++c)for(i=0;i<e;++i)f[o++]=n[i][c];return f}return n}if(null!=t&&null!=r||(null!=r?(t=r,r=1):(t=n,n=r=1)),n=sn(n,!0),r=sn(r,!0),t=sn(t,!0),f=[],dn(r,0))for(;vn(n,t);n=F(n,r))f.push(n);else if(pn(r,0))for(;yn(n,t);n=F(n,r))f.push(n);return f}function dr(r){return b(r)?r:v(r)?r.reduce(U,0):I(r)?Z(K(r),function(n){return dr(T(r,n))}):0}function vr(r){return b(r)?r:v(r)?r.reduce(V,1):I(r)?Z(K(r),function(n){return vr(T(r,n))}):0}function yr(r){return b(r)?r:v(r)?r.reduce(function(n,r){return n=pn(r,n)?r:n},o):I(r)?Z(K(r),function(n){return yr(T(r,n))}):0}function wr(r){return b(r)?r:v(r)?r.reduce(function(n,r){return n=dn(r,n)?r:n},-o):I(r)?Z(K(r),function(n){return wr(T(r,n))}):0}function br(n,r){if(un(r=null==r?2:r)){if(b(n))return D(n);if(v(n))return(pn(r,0)?yr:wr)(Yn(n));if(I(n)&&dn(r,0))return wr(dr(Yn(mr(n))))}else if(C(r)){if($(r,1)){if(b(n))return D(n);if(v(n))return dr(Yn(n));if(I(n))return wr(dr(Yn(n)))}else if($(r,2)){if(b(n))return D(n);if(v(n))return Pn(n);if(I(n))return wr(Qr(n,null,!1,!1))}else if(dn(r,0)){if(b(n))return D(n);if(v(n))return function(n,r,t){return 2===arguments.length&&(t=r),bn(dr(Gn(Yn(2===arguments.length?n:Un(n,r)),t)),Sn(t))}(n,r)}}else if("fro"===r&&I(n))return X.sqrt(Zr(Dn(P(gr(n),n))));y("norm")}function xr(r,n){if(b(r))return r;if(v(r))return r.length?G(dr(r),r.length):l;if(I(r)){if(1===(n=q(n=null==n?1:n)))return Z(K(r),function(n){return xr(T(r,n))});if(2===n)return Z(J(r),function(n){return xr(r[n])})}y("mean")}function _r(r,n,t){if(n=q(n||0),b(r))return 0;if(v(r))return 0===r.length?l:1===r.length?0:X.sqrt(G(dr(Gn(Yn(Un(r,xr(r))),2)),1===n?r.length:r.length-1));if(I(r)){if(1===(t=q(t=null==t?1:t)))return Z(K(r),function(n){return _r(T(r,n))});if(2===t)return Z(J(r),function(n){return _r(r[n])})}y("std")}function Sr(n){n=Dn(n);var r=X.sign(n)||1,t=Sn(F(Q(.3275911,n=r<0?_n(n):n),1));return Q(r,W(1,Q(F(Q(F(Q(F(Q(F(Q(1.061405429,t),-1.453152027),t),1.421413741),t),-.284496736),t),.254829592),Q(t,X.exp(_n(Q(n,n)))))))}function kr(r,t,i,e){var u;if(b(r))return r;if(v(r)){if("reverse"===(i=null==i?"forward":i))return r.slice().reverse().map(function(n,r){return u=0===r?n:t(u,n),acc}).reverse();if("forward"===i)return r.map(function(n,r){return u=0===r?n:t(u,n)})}else if(I(r)){if(1===(e=q(e=null==e?1:e)))return Z(K(r),function(n){return kr(T(r,n),t,i,e)});if(2===e)return Z(J(r),function(n){return kr(r[n],t,i,e)})}return!1}function Ar(r,t,i,e,u){var f;if(v(r))return Z(f=r.length,function(n){return t(r.slice(_.max(0,n-i),_.min(f-1,n+e)+1))});if(I(r)){if(1===(u=q(u=null==u?1:u)))return Z(K(r),function(n){return Ar(T(r,n),t,i,e,u)});if(2===u)return Z(J(r),function(n){return Ar(r[n],t,i,e,u)})}return!1}function Er(n,e){var u;return v(n)?n.reduce(function(n,r,t){return e(r,t+1,1)&&n.push(t+1),n},[]):I(n)?(u=J(n),n.reduce(function(n,r,i){return r.reduce(function(n,r,t){return e(r,i+1,t+1)&&n.push(i+u*t+1),n},n)},[])):[]}function Ir(n,r){if(b(n))return r(n,1,1)?1:0;if(v(n)){for(var t=0,i=n.length;t<i;++t)if(r(n[t],t+1,1))return 1}else if(I(n))for(var t=0,e=J(n),u=K(n);t<e;++t)for(var f=0;f<u;++f)if(r(n[t][f],t+1,f+1))return 1;return 0}function Nr(n,r){if(b(n))return r(n,1,1)?1:0;if(v(n)){for(var t=0,i=n.length;t<i;++t)if(!r(n[t],t+1,1))return 0;return 1}if(I(n)){for(var t=0,e=J(n),u=K(n);t<e;++t)for(var f=0;f<u;++f)if(!r(n[t][f],t+1,f+1))return 0;return 1}return 0}function J(n){return n.length}function K(n){return n[0].length}function T(r,t){return Z(r.length,function(n){return r[n][t]})}function qr(n,r,t){var i;r!==t&&(i=n[r],n[r]=n[t],n[t]=i)}function jr(n,r,t,i,e,u){var f,o=n[0].length;for(null==i&&(i=1),null==e&&(e=1),f=u||0;f<o;++f)n[r][f]=U(V(e,n[r][f]),V(i,n[t][f]))}function Rr(t,i,e,n,r){var u=J(t),f=K(t);return u&&f?S(i)&&S(e)?(i=i.filter(function(n){return 0<=n&&n<u}),e=e.filter(function(n){return 0<=n&&n<f}),N(i.length,e.length,function(n,r){return t[i[n]][e[r]]})):((i=null==i?0:i)<0&&(i+=u),(e=null==e?0:e)<0&&(e+=f),(n=null==n?u-1:n)<0&&(n+=u),(r=null==r?f-1:r)<0&&(r+=f),i=_.max(0,_.min(u-1,i)),n=_.max(0,_.min(u-1,n)),e=_.max(0,_.min(f-1,e)),r=_.max(0,_.min(f-1,r)),i<=n&&e<=r?N(n-i+1,r-e+1,function(n,r){return t[i+n][e+r]}):[]):[]}function Lr(t,i,n){var e=J(t),u=K(t),f=J(i),o=K(i);return"vert"===(n=n||"horz")?N(e+f,_.max(u,o),function(n,r){return u<=r?n<e?0:i[n-e][r]:o<=r?n<e?t[n][r]:0:(n<e?t[n]:i[n-e])[r]}):N(_.max(e,f),u+o,function(n,r){return e<=n?r<u?0:i[n][r-u]:f<=n?r<u?t[n][r]:0:r<u?t[n][r]:i[n][r-u]})}function Pr(n,r,t,i){var e,u,f,o,c,l,a,s,h,m,g,p,d,v,y=J(n),w=K(n),b=w,x=0;for(i=mn(i||0),S(t)&&(b=_.min(b,t[1])),d=Lr(n,ar(y)),e=new Array(b),u=1,v=function(n,r){r=r||0;for(var t=x-1;0<=t;--t)if(n===e[t][r])return t;return-1},f=a=0;f<y&&!(b<=a);++f){for(o=f;L(D(d[o][a]),i);)if(y<=++o&&(o=f,b<=++a)){a=-1;break}if(-1===a)break;for(s=-1,m=null,p=0,o=c=o;o<y;++o)L(g=D(d[o][a]),i)?++p:null!=m&&!Mn(g,m)||(m=g,s=o);for(;;){if(-1===s)break;if(y-c===p+1){for(f!==s&&(qr(d,f,s),u=$n(u)),Mn(d[f][a],0)&&(jr(d,f,f,0,-1,a),u=$n(u)),o=s,c=f;0<=o&&-1!==(l=v(o));)o=c-=x-l;e[x++]=[o,a],u=f<b?V(u,d[f][f]):0;break}for(p=0,h=s,o=c;o<y;++o)o!==h&&(jr(d,o,h,$n(G(d[o][a],d[h][a])),1,a),L(g=D(d[o][a]),i)?++p:Mn(g,m)&&(m=g,s=o))}++a}return x<b&&(u=0),t=Rr(d,0,w,y-1,y+w-1),d=Rr(d,0,0,y-1,w-1),e.length>x&&(e.length=x),r?[d,e,u,t]:d}function Tr(n,r,t,i){var e,u,f,o,c,l,a=J(n),s=K(n),h=s;for(i=mn(i||0),S(t)&&_.min(h,t[1]),l=Lr((h=Pr(n,!0,t,i))[0],h[3]),e=h[1],n=h[2],u=e.length,o=0;o<u;++o)for(f=e[o][1],c=0;c<o;++c)L(D(l[c][f]),i)||(jr(l,c,o,$n(l[c][f]),l[o][f]),R(l[c][e[c][1]],1))||jr(l,c,c,0,Fn(l[c][e[c][1]]),e[c][1]);return R(l[u-1][e[u-1][1]],1)||jr(l,u-1,u-1,0,Fn(l[u-1][e[u-1][1]]),e[u-1][1]),t=Rr(l,0,s,a-1,a+s-1),l=Rr(l,0,0,a-1,s-1),r?[l,e,n,t]:l}function zr(n){var r,t,i;return b(n)?Fn(n):I(n)&&J(n)===K(n)?1===(t=r=J(n))?[[Fn(n[0][0])]]:R((i=Tr(n,!0))[0][r-1][t-1],0)?[]:i[3].map(function(n,r){return n.map(function(n){return G(n,i[0][r][r])})}):[]}function Mr(t,n){var r,i,e,u,f;return b(t)?Fn(t):I(t)?(r=J(t),e=K(t),In(t,0)?mr(t):1===r&&1===e?[[Fn(t[0][0])]]:1===r||1===e?(f=t.reduce(function(n,r){return U(n,V(r,H(r)))},0),N(e,r,function(n,r){return G(H(t[r][n]),f)})):(n=(i=Tr(t,!0,null,n||0))[1].length)===e?r===e?i[3].map(function(n,r){return n.map(function(n){return G(n,i[0][r][r])})}):P(zr(P(u=gr(t),t)),u):n===r?P(u=gr(t),zr(P(t,u))):(e=function(n,i){var r,t,e=J(n),u=K(n);i=i||Tr(n,!0);return r=i[1],t=r.length,n=Rr(n,Z(e,function(n){return n}),Z(t,function(n){return r[n][1]})),e=Rr(i[0],0,0,t-1,u-1).map(function(n,t){return n.map(function(n,r){for(r=t;r+1<u&&R(i[0][t][r],0);)++r;return G(n,i[0][t][r])})}),[n,e]}(t,i),f=P(zr(P(u=gr(f=e[0]),f)),u),n=P(u=gr(n=e[1]),zr(P(n,u))),P(n,f))):[]}function Or(f){return N(K(f),J(f),function(n,r){return i=r,e=n,r=!0,n=J(t=f),u=K(t),n!==u?null:n<=1?0:(e=+(e||0),(i=+(i||0))<0||n<=i||e<0||u<=e?null:(n=Cr(N(n-1,u-1,function(n,r){return i<=n&&++n,e<=r&&++r,t[n][r]})),!0===r&&i+e&1?$n(n):n));var t,i,e,u})}function Xr(n,r,t,i){var e,u,f,o=J(n),c=K(n);if(!1===t||o===c){for(i=mn(i||0),e=_.min(o,c),u=0;u<e;++u){if("lower"===r||"diagonal"===r)for(f=u+1;f<e;++f)if(!L(D(n[u][f]),i))return;if("upper"===r||"diagonal"===r)for(f=0;f<u;++f)if(!L(D(n[u][f]),i))return}if(c<o){for(u=e;u<o;++u)for(f=0;f<c;++f)if(!L(D(n[u][f]),i))return}else if(o<c)for(f=e;f<c;++f)for(u=0;u<o;++u)if(!L(D(n[u][f]),i))return;return 1}}function Cr(i,n,r){r=mn(r||0);var t=J(i);return t!==K(i)?0:1===t?i[0][0]:Xr(i,"lower",!0,r)||Xr(i,"upper",!0,r)?i.reduce(function(n,r,t){return V(n,i[t][t])},1):!0===n?function n(r,t){var i,e,u,f,o,c,l,a,s,h,m,g,p,d;function v(t,n,i,e){return N(n-1,n-1,function(n,r){return i<=n&&++n,e<=r&&++r,t[n][r]})}if(1===t)o=r[0][0];else if(2===t)c=r[0][0],l=r[0][1],a=r[1][0],o=B(V(c,s=r[1][1]),V(l,a));else if(3===t)c=r[0][0],l=r[0][1],a=r[0][2],s=r[1][0],h=r[1][1],m=r[1][2],g=r[2][0],p=r[2][1],d=r[2][2],o=B(B(B(U(U(V(V(c,h),d),V(V(l,m),g)),V(V(a,s),p)),V(V(a,h),g)),V(V(l,s),d)),V(V(c,m),p));else{for(i=u=e=0;i<t;++i)R(r[0][i],0)&&++e,R(r[i][0],0)&&++u;if(f=1,o=0,e<u)for(i=0;i<t;++i)R(r[i][0],0)||(o=U(o,V(r[i][0],V(f,n(v(r,t,i,0),t-1))))),f=1===f?-1:1;else for(i=0;i<t;++i)R(r[0][i],0)||(o=U(o,V(r[0][i],V(f,n(v(r,t,0,i),t-1))))),f=1===f?-1:1}return o}(i,t):Pr(i,!0,null,r)[2]}function Zr(i){return b(i)?i:I(i)?i.reduce(function(n,r,t){return U(n,t<r.length?i[t][t]:0)},0):void y("trace")}function $r(n){I(n)&&J(n)===K(n)||y("charpoly");var i,r=J(n),e=(K(n),r),u=new Array(e+1),t=lr(e,e);for(u[e]=1,i=1;i<=e;++i)t=P(n,t).map(function(n,t){return n.map(function(n,r){return t===r?U(n,u[e-i+1]):n})}),u[e-i]=G(Zr(P(n,t)),-i);return u.reverse()}function Fr(n,r,t){null==r&&(r=2);for(var i,e,u,f,o,c,l=J(n),a=kn(n),s=t?Z(l,1):null,h=mn(1e-10),m=mn(0),g=mn(1),p=1;p<=1e4;++p){for(i=c=0;i<l;++i)if((f=T(a,i)).splice(i,1),(o=a[i].slice()).splice(i,1),f=br(f,r),$(o=br(o,r),m)||$(f,m))++c;else{for(u=X.sqrt(wn(o,f)),vn(X.abs(W(u,g)),h)&&++c,t&&(s[i]=Q(u,s[i])),e=0;e<l;++e)a[e][i]=V(a[e][i],u);for(e=0;e<l;++e)a[i][e]=G(a[i][e],u)}if(l===c)break}return t?[s,a]:a}function Wr(n){var r,t,i,e,u=mn(1e-10),f=J(n),o=new Array(f),c=new Array(f),l=Z(f,0);for(n=kn(n),e=0;e<f;++e)r=(i=function(n,r,t){var i,e,u,f,o=gr(n),c=0,l=Z(r,function(){return new j(_.random()||.1,0)});for(l=Vn(l,br(l)),f=Vn(f=Z(r,function(){return new j(_.random()||.1,0)}),br(f)),i=1;i<=100&&(e=c,l=hn(P(n,u=l)),f=hn(P(o,f)),c=hr(l,u),l=Vn(l,l[0].sign()),f=Vn(f,f[0].sign()),l=Vn(l,br(l)),f=Vn(f,br(f)),!vn(X.abs(W(Dn(c),Dn(e))),t)||!vn(X.abs(W(Jn(c),Jn(e))),t));++i);return[c,l,f]}(n,f,u))[0],t=i[1],i=i[2],n=Un(n,P(P(G(l[e]=r,hr(o[e]=t,c[e]=i,!0)),t),i));return[jn(mr(o)),jn(l),jn(mr(c))]}function Qr(n,r,t,i){r=mn(r=C(r)?r:Y);var e,u=K(n),f=J(n);if(f<u)return e=Qr(mr(n),r,i,t),t&&i?[mr(e[2]),e[1],mr(e[0])]:t||i?[mr(e[0]),e[1]]:e;var o,c,l,a,s,h,m,g,p,d,v,y,w,b,x,_,S,k,A,M,E,I=t?f:0,N=i?u:0,q=kn(n),j=I?lr(f,I):null,R=Z(u,0),L=N?lr(u,N):null,O=wn(nn,r),P=new Array(u),T=new Array(u),z=new Array(u);for(T[0]=0,b=1;b<=u;++b){for(S=b+1,l=0,y=b;y<=f;++y)l=F(l,F(bn(Dn(q[y-1][b-1]),2),bn(Jn(q[y-1][b-1]),2)));if(P[b-1]=0,dn(l,O)&&(l=X.sqrt(l),P[b-1]=l,s=$(a=D(q[b-1][b-1]),0)?1:G(q[b-1][b-1],a),q[b-1][b-1]=V(s,F(l,a)),b!==u+0)){for(w=S;w<=u+0;++w){for(s=0,y=b;y<=f;++y)s=U(s,V(H(q[y-1][b-1]),q[y-1][w-1]));for(s=G(s,Q(l,F(l,a))),y=b;y<=f;++y)q[y-1][w-1]=B(q[y-1][w-1],V(s,q[y-1][b-1]))}for(s=$n(Cn(H(q[b-1][b-1]))),w=S;w<=u+0;++w)q[b-1][w-1]=V(s,q[b-1][w-1])}if(b===u)break;for(l=0,w=S;w<=u;++w)l=F(l,F(bn(Dn(q[b-1][w-1]),2),bn(Jn(q[b-1][w-1]),2)));if(T[S-1]=0,dn(l,O)){for(l=X.sqrt(l),T[S-1]=l,s=$(a=D(q[b-1][S-1]),0)?1:G(q[b-1][S-1],a),q[b-1][S-1]=V(s,F(l,a)),y=S;y<=f;++y){for(s=0,w=S;w<=u;++w)s=U(s,V(H(q[b-1][w-1]),q[y-1][w-1]));for(s=G(s,Q(l,F(l,a))),w=S;w<=u;++w)q[y-1][w-1]=B(q[y-1][w-1],V(s,q[b-1][w-1]))}for(s=$n(Cn(H(q[b-1][S-1]))),y=S;y<=f;++y)q[y-1][S-1]=V(q[y-1][S-1],s)}}for(h=0,b=1;b<=u;++b)R[b-1]=P[b-1],z[b-1]=T[b-1],h=wr([h,F(R[b-1],z[b-1])]);if(h=Q(r,h),0<I)for(w=1;w<=I;++w)j[w-1][w-1]=1;if(0<N)for(w=1;w<=N;++w)L[w-1][w-1]=1;for(_=1;_<=u;++_){for(b=u+1-_,M=1;M<=50;++M){for(E=!0,A=1;A<=b;++A){if(vn(X.abs(z[(x=b+1-A)-1]),h)){E=!1;break}if(vn(X.abs(R[x-1-1]),h)){E=!0;break}}if(E)for(v=0,k=x-(d=1),y=x;y<=b&&(g=Q(d,z[y-1]),z[y-1]=Q(v,z[y-1]),!vn(X.abs(g),h));++b)if(a=Ln(g,p=R[y-1]),v=wn(p,R[y-1]=a),d=_n(wn(g,a)),0<I)for(w=1;w<=u;++w)o=Dn(j[w-1][k-1]),c=Dn(j[w-1][y-1]),j[w-1][k-1]=F(Q(o,v),Q(c,d)),j[w-1][y-1]=W(Q(c,v),Q(o,d));if(a=R[b-1],x===b)break;for(o=R[x-1],c=R[b-1-1],m=z[b-1-1],p=z[b-1],m=Ln(g=wn(F(Q(W(c,a),F(c,a)),Q(W(m,p),F(m,p))),Q(2,Q(p,c))),1),pn(g,0)&&(m=_n(m)),g=wn(F(Q(W(o,a),F(o,a)),Q(W(wn(c,F(g,m)),p),p)),o),y=k=x+(d=v=1);k<=b;++k){if(m=z[y-1],c=R[y-1],p=Q(d,m),m=Q(v,m),a=Ln(p,g),v=wn(g,z[y-1-1]=a),d=wn(p,a),g=F(Q(o,v),Q(m,d)),m=W(Q(m,v),Q(o,d)),p=Q(c,d),c=Q(c,v),0<N)for(w=1;w<=u;++w)o=Dn(L[w-1][y-1-1]),a=Dn(L[w-1][y-1]),L[w-1][y-1-1]=F(Q(o,v),Q(a,d)),L[w-1][y-1]=W(Q(a,v),Q(o,d));if(a=Ln(p,g),v=wn(g,R[y-1-1]=a),d=wn(p,a),g=F(Q(v,m),Q(d,c)),o=W(Q(v,c),Q(d,m)),0<I)for(w=1;w<=u;++w)c=Dn(j[w-1][y-1-1]),a=Dn(j[w-1][y-1]),j[w-1][y-1-1]=F(Q(c,v),Q(a,d)),j[w-1][y-1]=W(Q(a,v),Q(c,d))}z[x-1]=0,z[b-1]=g,R[b-1]=o}if(pn(a,0)&&(R[b-1]=_n(a),0<N))for(w=1;w<=u;++w)L[w-1][b-1]=$n(L[w-1][b-1])}for(b=1;b<=u;++b){for(m=-1,y=w=b;y<=u;++y)dn(R[y-1],m)&&(m=R[y-1],w=y);if(w!==b){if(R[w-1]=R[b-1],R[b-1]=m,0<N)for(y=1;y<=u;++y)s=L[y-1][w-1],L[y-1][w-1]=L[y-1][b-1],L[y-1][b-1]=s;if(0<I)for(y=1;y<=u;++y)s=j[y-1][w-1],j[y-1][w-1]=j[y-1][b-1],j[y-1][b-1]=s}}if(0<I)for(_=1;_<=u;++_)if(!$(P[(b=u+1-_)-1],0)){for(s=$n(Cn(q[b-1][b-1])),w=1;w<=I;++w)j[b-1][w-1]=V(s,j[b-1][w-1]);for(w=1;w<=I;++w){for(s=0,y=b;y<=f;++y)s=U(s,V(H(q[y-1][b-1]),j[y-1][w-1]));for(s=G(s,V(D(q[b-1][b-1]),P[b-1])),y=b;y<=f;++y)j[y-1][w-1]=B(j[y-1][w-1],V(s,q[y-1][b-1]))}}if(0<N&&2<=u)for(_=2;_<=u;++_)if(!$(T[(S=(b=u+1-_)+1)-1],0)){for(s=$n(Cn(H(q[b-1][S-1]))),w=1;w<=N;++w)L[S-1][w-1]=V(s,L[S-1][w-1]);for(w=1;w<=N;++w){for(s=0,y=S;y<=u;++y)s=U(s,V(q[b-1][y-1],L[y-1][w-1]));for(s=G(s,V(D(q[b-1][S-1]),T[S-1])),y=S;y<=u;++y)L[y-1][w-1]=B(L[y-1][w-1],V(s,H(q[b-1][y-1])))}}return t&&i?[jn(j),R,jn(L)]:t||i?[jn(j||L),R]:R}function Ur(n,r){var t,i,e;return R(r,0)?(t=1,i=0):R(n,0)?(t=0,R(i=Cn(H(r)),0)&&(i=1)):(e=Cn(n),t=G(n=D(n),n=Ln(n,D(r))),i=G(V(e,H(r)),n)),[t,i]}function Br(n,r,t,i,e){var u,f,o,c,l,a=J(e),s=kn(e);if("right"===n)for(l=2===r.length&&b(r[0])?(f=r[0],o=$n(r[1]),c=r[1],r[0]):(f=r[t][t],o=r[t][i],c=r[i][t],r[i][i]),u=0;u<a;++u)s[u][t]=U(V(f,e[u][t]),V(c,e[u][i])),s[u][i]=U(V(o,e[u][t]),V(l,e[u][i]));else for(l=2===r.length&&b(r[0])?(f=r[0],o=$n(r[1]),c=r[1],r[0]):(f=r[t][t],o=r[t][i],c=r[i][t],r[i][i]),u=0;u<a;++u)s[t][u]=U(V(f,e[t][u]),V(o,e[i][u])),s[i][u]=U(V(c,e[t][u]),V(l,e[i][u]));return s}function Vr(n,r){for(var t,i,e=J(n),u=K(n),f=r?ar(e):null,o=n,c=0;c<u;++c)for(t=e-1;c+1<=t;--t)o=Br("left",[H((i=Ur(o[t-1][c],o[t][c]))[0]),$n(H(i[1]))],t-1,t,o),r&&(f=Br("right",i,t-1,t,f));return r?[f,o]:o}function Gr(n,r,t){var i=J(n);if(null==r){var e,u,f=t?ar(i):null,o=n;for(c=1;c<=i-2;++c)for(l=i;c+2<=l;--l)u=[H((e=Ur(o[l-1-1][c-1],o[l-1][c-1]))[0]),$n(H(e[1]))],t&&(f=Br("right",e,l-1-1,l-1,f)),o=Br("left",u,l-1-1,l-1,Br("right",e,l-1-1,l-1,o));return t?[f,o]:o}var c,l,a,s,h=gr(f=Vr(r,!0)[0]),m=ar(i),g=P(h,n),p=P(h,r);for(c=1;c<=i-2;++c)for(l=i;c+2<=l;--l)a=[H((s=Ur(g[l-1-1][c-1],g[l-1][c-1]))[0]),$n(H(s[1]))],f=Br("right",s,l-1-1,l-1,f),g=Br("left",a,l-1-1,l-1,g),p=Br("left",a,l-1-1,l-1,p),m=Br("right",s=Ur($n(p[l-1][l-1]),p[l-1][l-1-1]),l-1-1,l-1,m),g=Br("right",s,l-1-1,l-1,g),p=Br("right",s,l-1-1,l-1,p);return[g,p,f,m]}function Hr(n,r,t){if(b(n)&&b(r))return G(r,n);if(!I(n))return[];if(!v(r)&&!I(r))return[];var i,e=K(n);if(J(n)!==e)return[];if(i=v(r)?(h=r.length,1):(h=J(r),K(r)),e!==h)return[];var u,f,o,c,l,a,s,h=Pr(mr(n),!0);if(h[1].length!==e)return[];if(u=mr(h[3]),f=mr(h[0]),v(r)){for(o=Z(e,0),c=0;c<e;++c){if(R(f[c][c],0))return[];for(l=s=0;l<c;++l)s=U(s,V(f[c][l],o[l]));o[c]=G(B(r[c],s),f[c][c])}return Z(e,function(r){return Z(e,function(n){return V(o[n],u[r][n])}).reduce(U,0)})}for(o=lr(e,i),c=0;c<e;++c){if(R(f[c][c],0))return[];for(a=0;a<i;++a){for(l=s=0;l<c;++l)s=U(s,V(f[c][l],o[l][a]));o[c][a]=G(B(r[c][a],s),f[c][c])}}return N(e,i,function(r,t){return Z(e,function(n){return V(o[n][t],u[r][n])}).reduce(U,0)})}function Dr(n,r){if(!n.length)return 0;r=r||0;for(var t=n.length,i=0,e=n[0];i+1<t;)++i,e=U(V(e,r),n[i]);return e}function Jr(r){if(r.length<=1)return[];for(var n,t,i,e,u,f,o,c,l,a=r.length-1,s=mn(1e-10),h=new j(s,0),m=new j(0,0),g=new j(1,0),p=function(n){return Dr(r,n)},d=function(n){return G(B(p(U(n,h)),p(n)),h)},v=r.map(function(n){return j(n).abs()}),y=v.length-1;0<y&&$(v[y],0);)--y;for(t=F((_.max.apply(null,v.slice(0,y))||0)/(v[y]||1),1),n=wn(v[0],F(v[0],wr(v.slice(1)))||1),i=Z(a,function(){return new j(F(n,Q(W(t,n),_.random())),_.random()*M/2,"polar")}),o=1;o<=1e4;++o){for(y=e=0;y<a;++y){if(u=i[y],c=p(u),$((l=d(u)).re,0)&&$(l.im,0)){if(vn(X.abs(c.re),s)&&vn(X.abs(c.im),s)){++e;continue}f=new j(t,0)}else f=c.div(l);c=f.div(g.sub(f.mul(i.reduce(function(n,r,t){return n=t===y||$(u.re,r.re)&&$(u.im,r.im)?n:n.add(u.sub(r).inv())},m)))),vn(X.abs(c.re),s)&&vn(X.abs(c.im),s)&&++e,i[y]=u.sub(c)}if(e===a)break}return i}function Kr(n,r){for(var t=n.length-1,i=r.length-1,e=[];0<=t&&0<=i;)e.unshift(U(n[t--],r[i--]));for(;0<=t;)e.unshift(n[t--]);for(;0<=i;)e.unshift(r[i--]);return e}function Yr(n,r){var t,i,e,u,f,o=n.length,c=r.length,l=o+c-1;if(!o||!c)return[];for(f=new Array(l),o<c&&(u=n,o=(n=r).length,c=(r=u).length),t=0;t<l;++t)for(i=f[t]=0;i<c;++i)0<=(e=t-i)&&e<o&&(f[t]=U(f[t],V(n[e],r[i])));return f}c.decimal=function(n){t=("function"==typeof n?(k=n,O.call(k.prototype,"_valueof")||(k.prototype._valueof=null,k.prototype.$valueOf=function(){return null==this._valueof&&(this._valueof=parseFloat(this.toFixed(9))),this._valueof},k.prototype.sign=function(){return k.sign(this)}),p.pi=k(M),p.e=k(f),p.realmax=k(a),p.realmin=k(nn),p.intmax=k(s),p.intmin=k(h)):(k=null,p.pi=M,p.e=f,p.realmax=a,p.realmin=nn,p.intmax=s,p.intmin=h),new j(p.e,0))},A.clc=r,A.disp=r,A.clear=r,A.help=r,A.who=r,A.whos=r,A.exist=r,c.is_array=S,c.is_obj=tn,c.is_string=E,c.is_nan=en,c.is_inf=un,c.is_number=u,c.is_decimal=fn,c.is_int=w,c.is_complex=e,c.is_scalar=b,c.is_vector=v,c.is_matrix=I,c.is_real=an,c.array=Z,c.matrix=N,A.rowvec=function(n){return on(n)?[[n]]:cn(n)?[n]:n},A.colvec=function(n){return on(n)?[[n]]:cn(n)?n.map(function(n){return[n]}):n},c.vec=hn,c.tonumber=gn,c.neq=$,c.nlt=pn,c.ngt=dn,c.nle=vn,c.nge=yn,c.nadd=F,c.nsub=W,c.nmul=Q,c.ndiv=wn,c.npow=bn,c.nmod=xn,c.nneg=_n,c.ninv=Sn,c.copy=kn,c.apply=An,c.exist=function(n,r){return tn(r)&&E(n)&&O.call(r,n)?1:0},j.prototype={constructor:j,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var r=this;return null==r._rho&&(r._rho=Ln(r.re,r.im)),r._rho},norm2:function(){return null==this._rho2&&(this._rho2=bn(this.abs(),2)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=$(n.re,0)?(pn(n.im,0)?-1:1)*M/2:X.atan(wn(n.im,n.re))),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=$(n.im,0)?X.sign(n.re):n.div(n.abs()),e(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return C(n)?new j(F(this.re,n),this.im):new j(F(this.re,n.re),F(this.im,n.im))},sub:function(n){return C(n)?new j(W(this.re,n),this.im):new j(W(this.re,n.re),W(this.im,n.im))},mul:function(n){var r,t,i,e=this;return C(n)?new j($(e.re,0)?0:Q(e.re,n),$(e.im,0)?0:Q(e.im,n)):(r=e.re,i=n.re,e=e.im,t=Q(r,F(i,n=n.im)),n=Q(n,F(r,e)),i=Q(i,W(e,r)),new j(W(t,n),F(t,i)))},div:function(n){var r,t,i,e=this;return C(n)?new j($(e.re,0)?0:wn(e.re,n),$(e.im,0)?0:wn(e.im,n)):(t=n.norm2(),r=e.re,i=wn(n.re,t),e=e.im,t=Q(r,F(i,n=_n(wn(n.im,t)))),n=Q(n,F(r,e)),i=Q(i,W(e,r)),new j(W(t,n),F(t,i)))},pow:function(n){var r,t;return C(n)?new j(bn(this.abs(),n),Q(this.angle(),n),"polar"):e(n)?(r=this.abs(),t=this.angle(),new j(bn(r,n.re),Q(n.im,X.log(r)),"polar").mul(new j(X.exp(_n(Q(n.im,t))),Q(t,n.re),"polar"))):void 0},neg:function(){return new j(_n(this.re),_n(this.im))},conj:function(){return new j(this.re,_n(this.im))},inv:function(){var n=this.norm2();return new j(wn(this.re,n),_n(wn(this.im,n)))},toString:function(){var n=this;return null==n._str&&(n._str=Nn(n.re)+(pn(n.im,0)?" - ":" + ")+Nn(X.abs(n.im))+"i"),n._str},valueOf:function(){return q(this.re)}},new j(0,1),t=new j(f,0),["floor","ceil","round","sign","abs","exp","log","log10","sqrt","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){X[r]="log"===r?function(n){return u(n)?_.log(n):n.ln()}:"log10"===r?function(n){return u(n)?_.log10(n):n.log()}:function(n){return u(n)?_[r](n):n[r]()}}),i={floor:function(n){return new j(X.floor(n.re),X.floor(n.im))},ceil:function(n){return new j(X.ceil(n.re),X.ceil(n.im))},round:function(n){return new j(X.round(n.re),X.round(n.im))},sign:function(n){return n.sign()},sqrt:function(n){return n.pow(new j(.5,0))},exp:function(n){return t.pow(n)},log:function(n){return new j(X.log(n.abs()),n.angle())},log10:function(n){return new j(X.log10(n.abs()),n.angle())},sin:function(n){return new j(Q(X.sin(n.re),X.cosh(n.im)),Q(X.cos(n.re),X.sinh(n.im)))},cos:function(n){return new j(Q(X.cos(n.re),X.cosh(n.im)),_n(Q(X.sin(n.re),X.sinh(n.im))))},tan:function(n){return i.sin(n).div(i.cos(n))},sinh:function(n){return new j(Q(X.sinh(n.re),X.cos(n.im)),Q(X.cosh(n.re),X.sin(n.im)))},cosh:function(n){return new j(Q(X.cosh(n.re),X.cos(n.im)),Q(X.sinh(n.re),X.sin(n.im)))},tanh:function(n){return i.sinh(n).div(i.cosh(n))},asin:null,acos:null,atan:null,asinh:null,acosh:null,atanh:null},c.realMath=X,c.complexMath=i,A.complex=j,["floor","ceil","round","sign","sqrt","exp","log","log10","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){A[r]=i[r]?function(n){return An(function(n){return(e(n)?i:X)[r](n)},n,!0)}:function(n){return An(function(n){return X[r](n)},n,!1)}}),c.num2str=Nn,c.MAXPRINTSIZE=o,c.tex=function(n){return S(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(qn).join("\\]\n\\[")+"\\]":S(n[0])?S(n[0][0])||!S(n[1])||n[0].length!==n[1].length?"\\["+n.map(qn).join("\\]\n\\[")+"\\]":"\\["+qn(n)+"\\]":"\\["+(n=n.length>c.MAXPRINTSIZE?n.slice(0,_.round(c.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-_.round(c.MAXPRINTSIZE/2))):n).map(qn).join("\\]\n\\[")+"\\]":"":(n=qn(n)).length&&(n="\\["+n+"\\]"),n},c.eq=R,c.ne=zn,c.lt=Mn,c.gt=On,c.le=L,c.ge=Xn,c.ssign=Cn,c.sadd=U,c.ssub=B,c.smul=V,c.sdiv=G,c.spow=Zn,c.sneg=$n,c.sconj=H,c.sinv=Fn,c.sabs=D,c.sangle=Wn,c.add=Qn,c.sub=Un,c.dotmul=Bn,A.times=Bn,c.dotdiv=Vn,c.dotpow=Gn,c.mul=P,c.pow=Hn,A.real=Dn,A.imag=Jn,A.conj=Kn,A.abs=Yn,A.angle=function(n){return An(Wn,n,!0)},A.mod=function(n,t){return R(t=sn(t||0),0)?n:An(function(n){var r;return C(n)?pn(r=xn(n,t),0)&&dn(t,0)?F(r,t):r:n},n,!0)},A.bitshift=function(n,r){return An(function(n){return w(n)?pn(r,0)?q(n)>>-q(r):q(n)<<q(r):n},n,!0)},A.bitand=function t(r,i){if(w(r)){if(w(i))return q(r)&q(i);if(S(i))return i.map(function(n){return t(r,n)})}else if(S(r)){if(w(i))return r.map(function(n){return t(n,i)});if(S(i)&&r.length===i.length)return r.map(function(n,r){return t(n,i[r])})}return 0},A.bitor=function t(r,i){if(w(r)){if(w(i))return q(r)|q(i);if(S(i))return i.map(function(n){return t(r,n)})}else if(S(r)){if(w(i))return r.map(function(n){return t(n,i)});if(S(i)&&r.length===i.length)return r.map(function(n,r){return t(n,i[r])})}return 0},A.bitxor=function t(r,i){if(w(r)){if(w(i))return q(r)^q(i);if(S(i))return i.map(function(n){return t(r,n)})}else if(S(r)){if(w(i))return r.map(function(n){return t(n,i)});if(S(i)&&r.length===i.length)return r.map(function(n,r){return t(n,i[r])})}return 0},A.bin2dec=function n(r){return S(r)?r.map(n):E(r)?parseInt(r,2):r},A.dec2bin=function n(r){return S(r)?r.map(n):u(r)?r.toString(2):fn(r)?r.toBinary():r},A.hex2dec=function n(r){return S(r)?r.map(n):E(r)?parseInt(r,16):r},A.dec2hex=function n(r){return S(r)?r.map(n):u(r)?r.toString(16):fn(r)?r.toHexadecimal():r},A.tolower=function n(r){return S(r)?r.map(n):E(r)?r.toLowerCase():r},A.toupper=function n(r){return S(r)?r.map(n):E(r)?r.toUpperCase():r},c.get=nr,c.set=rr,A.sub2ind=function(n,r,t){return v(r)&&(t=r[1],r=r[0]),r=q(r),t=q(t),1===n.length?r:r-1+q(n[0])*(t-1)+1},A.ind2sub=function(n,r){return r=q(r),1===n.length?[r,1]:[(r-1)%q(n[0])+1,_.floor((r-1)/q(n[0]))+1]},A.cat=function(n,r,t){var i,e=[];if(1===(n=q(n)))for(e=r,i=2;i<arguments.length;++i)e=tr("vert",e,arguments[i]);else if(2===n)for(e=r,i=2;i<arguments.length;++i)e=tr("horz",e,arguments[i]);return e},A.horzcat=function(n,r){for(var t=n,i=1;i<arguments.length;++i)t=tr("horz",t,arguments[i]);return t},A.vertcat=function(n,r){for(var t=n,i=1;i<arguments.length;++i)t=tr("vert",t,arguments[i]);return t},A.flip=ir,A.fliplr=function(n){return ir(n,2)},A.flipud=function(n){return ir(n,1)},A.reshape=function(t,i,n){v(i)&&(n=i[1],i=i[0]),i=q(i),n=q(n);var e,r=i*n;return on(t)&&1===i&&1===n?[[t]]:cn(t)&&t.length===r?N(i,n,function(n,r){return t[n+i*r]}):ln(t)&&J(t)*K(t)==r?(e=J(t),N(i,n,function(n,r){n+=i*r;return t[n%e][_.floor(n/e)]})):t},A.squeeze=function(n){return n},A.repmat=function(t,i,e){return v(i)&&(e=i[1],i=i[0]),null==e&&(e=i),i=q(i),e=q(e),ln(t=cn(t=on(t)?[[t]]:t)?[t]:t)?N(i*J(t),e*K(t),function(n,r){return t[n%i][r%e]}):t},A.repelem=function(r,t){var i,e;if(v(r))if(v(t)){if(t.length===r.length)return i=0,e=-1,Z(q(dr(t)),function(n){return n===i&&(i+=q(t[++e])),r[e]})}else if(w(t))return t=q(t),e=-1,Z(t*r.length,function(n){return 0==n%t&&++e,r[e]});return r},A.sort=vt(function(n,r,t,i){for(var e=2,u=null;e<arguments.length;){if("ComparisonMethod"===arguments[e]){"real"===arguments[e+1]?u=er:"abs"===arguments[e+1]&&(u=ur),1===e?(t=1,i="ascend"):2===e&&(i="ascend");break}e+=1}return null==i&&(i="ascend"),fr(r,t=q(t=null==t?1:t),i,u,1<n)}),A.size=or,A.length=cr,A.numel=function(n){return vr(or(n))},A.ndims=function(n){return cr(or(n))},A.rows=function(n){return or(n,1)},A.columns=function(n){return or(n,2)},A.zeros=lr,A.ones=function(n,r){return v(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),N(q(n),q(r),1)},A.meshgrid=function(t,i){if(1===arguments.length&&(i=t),v(t)&&v(i))return[N(i.length,t.length,function(n,r){return t[r]}),N(i.length,t.length,function(n,r){return i[n]})];y("meshgrid")},A.eye=ar,A.diag=sr,A.blkdiag=function(){return t=[].slice.call(arguments),a=l=c=o=f=0,t.forEach(function(n,r){on(n)&&(t[r]=n=[[n]]),cn(n)&&(t[r]=n=sr(n)),ln(n)||y("blkdiag"),f+=J(n),o+=K(n)}),i=t[c],e=J(i),u=K(i),N(f,o,function(n,r){return l+e<=n&&(l+=e,a+=u,i=t[++c],e=J(i),u=K(i)),r<a||a+u<=r?0:i[n-l][r-a]});var t,i,e,u,f,o,c,l,a},A.dot=hr,A.cross=function(n,r){if(n=hn(n),r=hn(r),!v(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(v(r)&&3===r.length)return[B(V(n[1],r[2]),V(n[2],r[1])),B(V(n[2],r[0]),V(n[0],r[2])),B(V(n[0],r[1]),V(n[1],r[0]))];throw"cross: input 2 not vector of length 3"},A.kron=function(t,i){var n,r,e,u;if(I(t)){if(I(i))return n=J(t),r=K(t),e=J(i),u=K(i),N(n*e,r*u,function(n,r){return P(t[_.floor(n/e)][_.floor(r/u)],i[n%e][r%u])});if(v(i))return n=J(t),r=K(t),e=1,u=i.length,N(n*e,r*u,function(n,r){return P(t[n][_.floor(r/u)],i[r%u])})}else if(v(t)){if(v(i))return N(t.length,i.length,function(n,r){return P(t[n],i[r])});if(I(i))return n=t.length,e=J(i),u=K(i),N(n*e,(r=1)*u,function(n,r){return P(t[_.floor(n/e)],i[n%e][r%u])})}return P(t,i)},A.transpose=mr,A.ctranspose=gr,A.rand=function(n,r){return null==n?_.random():(v(n)&&(r=n[1],n=n[0]),null==r&&(r=n),N(q(n),q(r),function(){return _.random()}))},A.randi=function(n,r,t){return null==r&&null==t?_.ceil(_.random()*n):(v(r)&&(t=r[1],r=r[0]),null==t&&(t=r),N(q(r),q(t),function(){return _.ceil(_.random()*n)}))},A.randn=function(n,r){return null==n?Tn():(v(n)&&(r=n[1],n=n[0]),null==r&&(r=n),N(q(n),q(r),Tn))},A.linspace=function(n,r,t){t=q(t=null==t?100:t);for(var i=wn(W(r,n),t-1),e=new Array(t),u=0,f=n;u<t;++u,f=F(f,i))e[u]=f;return e},A.logspace=function(n,r,t){t=q(t=null==t?100:t);for(var i=X.pow(wn(r,n),1/(t-1)),e=new Array(t),u=0,f=n;u<t;++u,f=Q(f,i))e[u]=f;return e},A.colon=pr,A.sum=dr,A.prod=vr,A.min=yr,A.max=wr,A.norm=br,A.mean=xr,A.median=function r(t,n){if(b(t))return t;if(v(t))return t.length?1&(t=fr(t)).length?t[t.length>>1]:G(U(t[t.length>>1],t[(t.length>>1)-1]),2):l;if(I(t)){if(1===(n=q(n=null==n?1:n)))return Z(K(t),function(n){return r(T(t,n))});if(2===n)return Z(J(t),function(n){return r(t[n])})}y("median")},A.mode=function r(t,n){if(b(t))return t;var i,e;if(v(t))return t.length?(i={},e=0,t.reduce(function(n,r){var t=r.toString(),t=O.call(i,t)?(i[t]+=1,i[t]):i[t]=1;return e<t?(e=t,n=r):t===e&&Mn(r,n)&&(n=r),n},{})):l;if(I(t)){if(1===(n=q(n=null==n?1:n)))return Z(K(t),function(n){return r(T(t,n))});if(2===n)return Z(J(t),function(n){return r(t[n])})}y("mode")},A.std=_r,A.var=function r(t,i,n){if(i=q(i||0),b(t))return 0;var e,u;if(v(t))return t.length<=1?t.length?0:l:(e=t.length,u=xr(t),G(dr(Bn(Kn(u=Un(t,u)),u)),1===i?e:e-1));if(I(t)){if(1===(n=q(n=null==n?1:n)))return Z(K(t),function(n){return r(T(t,n),i)});if(2===n)return Z(J(t),function(n){return r(t[n],i)})}y("var")},A.moment=function r(t,i,n){if(b(t))return 0;var e;if(v(t))return t.length<=1?t.length?0:l:(e=t.length,G(dr(Gn(Un(t,xr(t)),i)),e));if(I(t)){if(1===(n=q(n=null==n?1:n)))return Z(K(t),function(n){return r(T(t,n),i)});if(2===n)return Z(J(t),function(n){return r(t[n],i)})}y("moment")},A.cov=function i(e,n,u){if(u=q(u||0),2!==arguments.length||0!==q(n)&&1!==q(n)||(u=q(n),n=null),null==n){if(b(e))return 0;var r;if(v(e))return e.length<=1?e.length?0:l:(t=e.length,r=xr(e),G(dr(Bn(Kn(r=Un(e,r)),r)),1===u?t:t-1));if(I(e))return N(K(e),K(e),function(n,r,t){return n===r?i(T(e,n),u):r<n?t[r][n]:i(T(e,n),T(e,r),u)})}else{if(b(e)&&b(n))return lr(2,2);if(I(e)&&I(n)&&(e=pr(e),n=pr(n)),v(e)&&v(n)){if(e.length!==n.length)throw"cov: inputs not of same dimension";var t;return e.length<=1?e.length?0:l:(t=e.length,G(dr(Bn(Kn(Un(e,xr(e))),Un(n,xr(n)))),1===u?t:t-1))}}y("cov")},A.corrcoef=function i(e,r){if(null==r){if(b(e)||v(e))return 1;if(I(e))return N(K(e),K(e),function(n,r,t){return n===r?1:r<n?t[r][n]:i(T(e,n),T(e,r))})}else{if(b(e)&&b(r))return 1;if(v(e)&&v(r)){if(e.length!==r.length)throw"corrcoef: inputs not of same dimension";var n=e.length;return 1<n?G(dr(Bn(Vn(Un(e,xr(e)),_r(e)),Vn(Un(r,xr(r)),_r(r)))),n-1):1}if(I(e)&&I(r)){if(J(e)!==J(r)||K(e)!==K(r))throw"corrcoef: inputs not of same dimension";return Z(K(e),function(n){return i(T(e,n),T(r,n))})}}y("corrcoef")},A.erf=function(n){return An(Sr,n,!0)},A.diff=function(n,r,t){for(null==t&&(t=1),w(r=null==r?1:r)||y("diff"),r=q(r);0<r--;)n=function r(t,n){if(v(t))return 1<t.length?Z(t.length-1,function(n){return B(t[n+1],t[n])}):[];if(I(t)){if(1===(n=q(n=null==n?1:n)))return Z(K(t),function(n){return r(T(t,n))});if(2===n)return Z(J(t),function(n){return r(t[n])})}y("diff")}(n,t);return n},A.cumsum=function(n,r,t){n=kr(n,U,t,r);return!1===n&&y("cumsum"),n},A.cumprod=function(n,r,t){n=kr(n,V,t,r);return!1===n&&y("cumprod"),n},A.cummin=function(n,r,t){n=kr(n,function(n,r){return Mn(n,r)?n:r},t,r);return!1===n&&y("cummin"),n},A.cummax=function(n,r,t){n=kr(n,function(n,r){return On(n,r)?n:r},t,r);return!1===n&&y("cummax"),n},A.movsum=function(n,r,t){var i,e;return v(r)?(i=q(r[0]),e=q(r[1])):w(r)&&(e=1&(r=q(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=Ar(n,dr,i,e,t))&&y("movsum"),r},A.movprod=function(n,r,t){var i,e;return v(r)?(i=q(r[0]),e=q(r[1])):w(r)&&(e=1&(r=q(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=Ar(n,vr,i,e,t))&&y("movprod"),r},A.movmean=function(n,r,t){var i,e;return v(r)?(i=q(r[0]),e=q(r[1])):w(r)&&(e=1&(r=q(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=Ar(n,xr,i,e,t))&&y("movmean"),r},A.movmin=function(n,r,t){var i,e;return v(r)?(i=q(r[0]),e=q(r[1])):w(r)&&(e=1&(r=q(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=Ar(n,yr,i,e,t))&&y("movmin"),r},A.movmax=function(n,r,t){var i,e;return v(r)?(i=q(r[0]),e=q(r[1])):w(r)&&(e=1&(r=q(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=Ar(n,wr,i,e,t))&&y("movmax"),r},c.find=Er,c.any=Ir,c.all=Nr,A.find=function(n){return Er(n,function(n){return!R(n,0)})},A.any=function(n){return Ir(n,function(n){return!R(n,0)})},A.all=function(n){return Nr(n,function(n){return!R(n,0)})},A.isreal=function(n){return Nr(n,an)},A.isempty=function(n){return S(n)?S(n[0])?n[0].length?0:1:n.length?0:1:0},A.magic=function n(t){if(t=w(t=sn(t,!0))?q(t):null,!w(t)||t<=2)return 1===t?[[1]]:[];var i,e,u,f,o,r,c,l,a,s,h,m,g,p=1&t,d=0==(3&t),v=t*t,y=t-p>>1;if(p)return i=t+y,e=y+p,N(t,t,function(n,r){return(i+n-(r=t-1-r))%t*t+(e+r+n)%t+1});if(d)return a=0,N(t,t,function(n,r){return++a,(n+1&3)>>1==(r+1&3)>>1?v-(a-1):a});for(m=n(y),o=(f=(u=p=y*y)<<1)+p,g=N(t,t,function(n,r){return n<y&&r<y?m[n][r]:n<y?m[n][r-y]+o:r<y?m[n-y][r]+f:m[n-y][r-y]+u}),c=r=y>>>1,h=0;h<y;++h)for(s=0;s<t;++s)!(s<r||t-c<s||s===r&&h===r)||0===s&&h===r||(l=g[s][h],g[s][h]=g[s][h+y],g[s][h+y]=l);return g},A.ref=vt(function(n,r,t){I(r=b(r)?[[r]]:r)||y("ref");r=Pr(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),A.rref=vt(function(n,r,t){I(r=b(r)?[[r]]:r)||y("rref");r=Tr(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),A.inv=function(n){return b(n)&&(x=[[n]]),I(n)||y("inv"),zr(n)},A.cond=function(n,r){I(n=b(n)?[[n]]:n)||y("cond");var t=zr(n);return t&&t.length?V(br(n,r=null==r?2:r),br(t,r)):o},A.pinv=function(n,r){return I(n=b(n)?[[n]]:n)||y("pinv"),Mr(n,r)},A.rank=function(n){return I(n=b(n)?[[n]]:n)||y("rank"),Pr(n,!0)[1].length},A.rowspace=function(n,r){return Pr(t=n,!0,null,r)[1].map(function(n){return t[n[0]]});var t},A.colspace=function(n,r){return Pr(t=n,!0,null,r)[1].map(function(r){return Z(t.length,function(n){return t[n][r[1]]})});var t},A.null=function(n,r){return r=r,e=K(t=n),u=(t=Tr(n,!0,null,r))[0],f=t[1],o=f.length,r=f.reduce(function(n,r){for(var t=0;t<n.length&&r[1]>n[t];)++t;return t<n.length&&r[1]===n[t]&&n.splice(t,1),n},Z(e,function(n){return n})),c=o?f.reduce(function(n,r,t){return V(n,u[t][r[1]])},1):1,r.map(function(r){for(var n,t=Z(e,function(n){return n===r?c:0}),i=0;i<o;++i)(n=f[i][1])<=r&&(t[n]=B(t[n],V(G(c,u[i][n]),u[i][r])));return t});var t,e,u,f,o,c},A.adjoint=function(n){return I(n)&&J(n)===K(n)||y("adjoint"),Or(n)},A.det=function(n){return I(n=b(n)?[[n]]:n)||y("det"),Cr(n,!1,1e-15)},A.trace=Zr,A.charpoly=$r,A.balance=vt(function(n,r,t){I(r=b(r)?[[r]]:r)&&J(r)===K(r)||y("balance");var i=Fr(r,2,1<n);return 2<n?[i[0],Z(J(r),function(n){return n+1}),i[1]]:1<n?[sr(i[0]),i[1]]:i}),A.eig=vt(function(n,r,t){I(r)&&J(r)===K(r)||y("eig"),I(t)&&y("eig");var i=null;return"nobalance"!==t&&(i=Fr(r,2,!0),r=i[1],i=i[0]),1<n?(t=Wr(r),[i?P(sr(i),t[0]):t[0],sr(t[1]),i?P(sr(i.map(Sn)),t[2]):t[2]]):jn((Xr(r,"upper",!0,1e-15)||Xr(r,"lower",!0,1e-15)?Z(J(r),function(n){return r[n][n]}):Jr($r(r))).sort(function(n,r){return D(r)-D(n)}))}),A.svd=vt(function(n,r,t){return I(r=b(r)?[[r]]:r)||y("svd"),1<n?[(n=Qr(r,t,1<n,2<n))[0],sr(n[1]),n[2]]:Qr(r,t,!1,!1)}),A.lu=function(n){b(n)&&(x=[[n]]),I(n)||y("lu");var r,t,i,e,u,f,o,c,l,a,s,h,m,g,p,d=!0,v=void 0;for(v=mn(v||0),r=J(n),t=K(n),p=!1,u=kn(n),e=ar(r),f=Z(r,0),i=ar(r),o=1,c=0;c<r-1;++c){if(L(D(u[c][c]),v)){for(s=c+1,h=!0;s<r&&h;)L(D(u[s][c]),v)?++s:h=!1;if(r<=s){p=!0;break}qr(u,c,s),qr(i,c,s)}for(m=u[c][c],e[c][c]=m,f[c]=V(o,m),l=c+1;l<r;++l){for(g=u[l][c],e[l][c]=g,a=c+1;a<t;++a)u[l][a]=G(B(V(m,u[l][a]),V(u[c][a],g)),o);u[l][c]=0}o=u[c][c]}if(p)throw"lu: defficient matrix";return f[r-1]=o,d?[P(e,sr(f.map(Fn))),u,i]:[f,e,u,i]},A.qr=vt(function(n,r){return I(r=b(r)?[[r]]:r)||y("qr"),Vr(r,1<n)}),A.hess=vt(function(n,r,t){return I(r=b(r)?[[r]]:r)&&J(r)===K(r)||y("hess"),2<arguments.legnth?(I(t=b(t)?[[t]]:t)&&J(t)===K(t)||y("hess"),Gr(r,t)):Gr(r,null,1<n)}),A.ldl=function(n,r){I(n=b(n)?[[n]]:n)||y("ldl");var t,i,e,u,f,o,c=n,l=r,a=J(c);if(a===K(c)&&In(c,gr(c))){for(f=lr(a,a),o=ar(a),t=0;t<a;++t){if("upper"===l){for(i=t+1;i<a;++i){for(e=t+1,u=0;e<i;++e)u=U(u,V(V(o[t][e],H(o[i][e])),f[e][e]));o[t][i]=G(B(c[t][i],u),f[i][i])}for(e=t+1,u=0;e<a;++e)u=U(u,V(V(o[t][e],H(o[t][e])),f[e][e]))}else{for(i=0;i<t;++i){for(u=e=0;e<i;++e)u=U(u,V(V(o[t][e],H(o[i][e])),f[e][e]));o[t][i]=G(B(c[t][i],u),f[i][i])}for(u=e=0;e<t;++e)u=U(u,V(V(o[t][e],H(o[t][e])),f[e][e]))}f[t][t]=B(c[t][t],u),L(f[t][t],0)&&y("ldl")}return[o,f]}y("ldl")},A.linsolve=Hr,A.polyval=function(r,n){return v(r=hn(r))||y("polyval"),b(n)?jn(Dr(r,n)):v(n)?n.map(function(n){return jn(Dr(r,n))}):void y("polyval")},A.polyvalm=function(r,n){return v(r=hn(r))||y("polyvalm"),I(n)&&J(n)===K(n)?jn(function(t,n){if(!t.length)return 0;for(var r=t.length,i=0,e=J(n),u=N(e,e,function(n,r){return n===r?t[0]:0});i+1<r;)++i,u=Qn(P(u,n),N(e,e,function(n,r){return n===r?t[i]:0}));return u}(r,n)):b(n)?jn(Dr(r,n)):v(n)?n.map(function(n){return jn(Dr(r,n))}):void y("polyvalm")},A.polyfit=function(n,r,e){if(n=hn(n),r=hn(r),v(n)&&v(r)||y("polyfit"),n.length!==r.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return jn(function(i,e){var n,u,f,r,t,o,c,l;if(!(v(i)&&i.length&&v(e)&&e.length))return[];for(i=i.slice(),e=e.slice(),f=_.min(i.length,e.length),i.length=f,e.length=f,c={},l=[],u=0;u<f;++u)if(o=String(i[u]),O.call(c,o)){if(!R(e[c[o]],e[u]))return[];l.push(u)}else c[o]=u;for(;l.length;)u=l.pop(),i.splice(u,1),e.splice(u,1);for(l=c=null,r=Z(f=i.length,function(n){for(var r=1,t=0;t<f;++t)t!==n&&(r=V(r,B(i[n],i[t])));return r=G(e[n],r)}),t=Z(f,function(n){return[1,$n(i[n])]}),n=[],u=0;u<f;++u)n=Kr(n,t.reduce(function(n,r,t){return n=t!==u?nt(n,r):n},[r[u]]));return n}(n,r));if(!w(e)||q(e)<0)throw"polyfit: input 3 not positive int";return e=q(e),jn(P(Mr(n.reduce(function(n,r){for(var t=1,i=[1];t<=e;++t)i.unshift(V(r,i[0]));return n.push(i),n},[])),r))},A.roots=function(n){return v(n=hn(n))||y("roots"),jn(Jr(n).sort(function(n,r){return pn(Dn(n),Dn(r))?-1:dn(Dn(n),Dn(r))?1:0}))},A.poly=function(n){return v(n=hn(n))||y("poly"),jn(n.reduce(function(n,r){return nt(n,[1,$n(r)])},[1]))};var nt=Yr;function rt(n,r,t){var i,e=[],u=n.slice(),f=u.length-r.length,o=r;if(0<=f)for(e=Z(f+1,0);0<=f;){for(i=f,r=o.concat(Z(f,0)),e[e.length-1-f]=G(u[0],r[0]),u=Kr(u,nt(r,[$n(e[e.length-1-f])]));u.length&&R(u[0],0);)u.shift();if((f=u.length-o.length)===i)break}return[e,t?Z(n.length-u.length,0).concat(u):u]}A.conv=function(n,r){return(b(n)||b(r)?Bn:(n=hn(n),r=hn(r),v(n)&&v(r)||y("conv"),Yr))(n,r)};var tt=rt;A.deconv=vt(function(n,r,t){var i;if(b(r)||b(t))i=1<n?[Vn(r,t),0]:Vn(r,t);else{if(r=hn(r),t=hn(t),v(r)&&v(t)||y("deconv"),!t.length||1===t.length&&R(t[0],0))throw"deconv: divisor is zero";i=rt(r,t,!0)}return 1<n?i:i[0]}),A.polydiv=vt(function(n,r,t){var i;if(b(r)||b(t))i=1<n?[Vn(r,t),0]:Vn(r,t);else{if(r=hn(r),t=hn(t),v(r)&&v(t)||y("polydiv"),!t.length||1===t.length&&R(t[0],0))throw"polydiv: divisor is zero";i=tt(r,t,!1)}return 1<n?i:i[0]}),A.conv2=function(r,t){if(b(r)||b(t))return Bn(r,t);if(v(r)){if(v(t))return Yr(r,t);if(I(t))return Z(K(t),function(n){return Yr(r,T(t,n))})}else{if(v(t)){if(v(r))return Yr(r,t);if(I(r))return Z(r[0].length,function(n){return Yr(T(r,n),t)});throw"conv2: input 1 not supported"}if(!I(r))throw"conv2: input 1 not supported";if(I(t)){var n,i,e,u,f,o,c,l,a,s,h,m,g,p=r,d=t;for(J(p)<J(d)&&(g=p,p=d,d=g),n=J(p),i=K(p),f=lr(o=n+(e=J(d))-1,c=i+(u=K(d))-1),a=0;a<o;++a)for(s=0;s<c;++s){for(h=l=0;h<=a&&!(n<=h);++h)if(!(e<=a-h))for(m=0;m<=s&&!(i<=m);++m)u<=s-m||(l=U(l,V(p[h][m],d[a-h][s-m])));f[a][s]=l}return f}}throw"conv2: input 2 not supported"},A.filter=function(n,r,t,i,e){n=hn(n),r=hn(r),t=hn(t),v(n)&&v(r)&&v(t)||y("filter");var u,f,o,c,l=n,a=r,s=t,h=s.length,m=a.length,g=l.length,p=new Array(h),d=a[0];for(a=a.map(function(n){return G(n,d)}),l=l.map(function(n){return G(n,d)}),u=0;u<h;++u){for(o=u,f=c=0;0<=o&&f<g;++f,--o)c=U(c,V(l[f],s[o]));for(o=u-1,f=1;0<=o&&f<m;++f,--o)c=B(c,V(a[f],p[o]));p[u]=c}return p};var it={},et={};function ut(n,r){for(var t,i,e=n.length,u={},f=0;f<e;++f)1!==u[f]&&(i=n[t=function(n,r){for(var t=0;1<r;)t=(t<<1)+(1&n),n>>=1,r>>=1;return t}(f,e)],r[t]=n[f],r[f]=i,u[t]=1)}function ft(n,r,t){var i,e,u=n.length;if(1===u)t[0]=n[0];else{for(i=0;i<u;++i)t[i]=new j(0,0);for(var f,o,c,l,a,s,h=function(n){for(var r=_.sqrt(n),t=3;t<=r;){if(0==n%t)return t;t+=2}return n}(u),m=u/h,g=1/_.sqrt(h),p=new Array(m),d=new Array(m),v=0;v<h;++v){for(i=0;i<m;++i)p[i]=n[i*h+v];for(1<m&&(ct(p,r,d),e=p,p=d,d=e),f=_.cos(2*M*v/u),o=(r?-1:1)*_.sin(2*M*v/u),c=1,i=l=0;i<u;++i)a=Q(p[i%m].re,g),s=Q(p[i%m].im,g),t[i]=t[i].add(new j(W(Q(a,c),Q(s,l)),F(Q(s,c),Q(a,l)))),a=W(Q(c,f),Q(l,o)),s=F(Q(c,o),Q(l,f)),c=a,l=s}}}function ot(n,r,t){var i,e,u,f,o,c,l,a,s,h,m,g,p,d,v,y,w,b=n.length,x=1;for(ut(n,t);x<b;){for(w=void 0,null==(w=et[y=x])&&(et[y]=w=_.cos(M/y)),i=w,e=(r?-1:1)*(y=void 0,null==(y=it[w=x])&&(it[w]=y=_.sin(M/w)),y),f=b/(2*x),u=0;u<f;++u)for(a=1,o=s=0;o<x;++o)g=t[h=2*u*x+o].re,p=t[h].im,c=t[m=h+x].re,l=t[m].im,d=W(Q(a,c),Q(s,l)),v=F(Q(s,c),Q(a,l)),t[h]=new j(Q(F(g,d),_.SQRT1_2),Q(F(p,v),_.SQRT1_2)),t[m]=new j(Q(W(g,d),_.SQRT1_2),Q(W(p,v),_.SQRT1_2)),c=W(Q(a,i),Q(s,e)),l=F(Q(a,e),Q(s,i)),a=c,s=l;x<<=1}}function ct(n,r,t){var i,e=n.length;if(!(e<=0))return i=!1,null==t&&(t=new Array(e),i=!0),(e&e-1?ft:ot)(n,r,t),i?t:void 0}function lt(n,r,t){var i=n.length,e=n[0].length;if(!(i<=0||e<=0)){var u,f,o=!1,c=new Array(i),l=new Array(e),a=new Array(i),s=new Array(e);if(null==t){for(t=new Array(i),u=0;u<i;++u)t[u]=new Array(e);o=!0}for(f=0;f<e;++f,0){for(u=0;u<i;++u)c[u]=n[u][f];for(ct(c,r,a),u=0;u<i;++u)t[u][f]=a[u]}for(u=0;u<i;++u){for(f=0;f<e;++f,0)l[f]=t[u][f];for(ct(l,r,s),f=0;f<e;++f,0)t[u][f]=s[f]}return o?t:void 0}}function at(){if(!rn(this,at))return new at;this.data=[]}A.fft=function(r){return I(r=hn(r))?Z(K(r),function(n){return jn(ct(Rn(T(r,n)),!1))}):v(r)?jn(ct(Rn(r),!1)):void y("fft")},A.ifft=function(r){return I(r=hn(r))?Z(K(r),function(n){return jn(ct(Rn(T(r,n)),!0))}):v(r)?jn(ct(Rn(r),!0)):void y("ifft")},A.fft2=function(n){return I(n)||y("fft2"),jn(lt(Rn(n),!1))},A.ifft2=function(n){return I(n)||y("ifft2"),jn(lt(Rn(n),!0))},c.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],at.prototype={constructor:at,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,option:function(n,r,t,i){var e,u,f,o={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},c={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},l={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},a=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:l[a[(i||0)%a.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=l[a[(i||0)%a.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=o["-"]),n._LineStyle||(n._LineStyle="-"),t=t||0;t<r.length;){if("Color"===r[t])E(e=r[t+1])?O.call(c,e)?n.Color=l[c[e]]:O.call(l,e)&&(n.Color=l[e]):v(e)&&3===e.length&&(n.Color=gn(e));else if("LineWidth"===r[t])C(e=r[t+1])&&(n.LineWidth=2*gn(e));else{if("LineStyle"!==r[t]){if(E(r[t])){for(u in f=!1,e=r[t],l)-1<e.indexOf(u)&&(n.Color=l[u],f=!0);for(u in o)"-"!==u&&-1<e.indexOf(u)&&(n._LineStyle=u,n.LineStyle=o[u],f=!0);if(f){t+=1;continue}}break}E(e=r[t+1])&&O.call(o,e)&&(n._LineStyle=e,n.LineStyle=o[e])}t+=2}return t},parse:function(n,r,t){var i,e,u,f,o,c,l=this,a=0,s=0;if("pie"===r)for(;a<n.length;)v(n[a])?l.data.push({y:gn(n[a++])}):a+=1;else if("plot3"===r)for(;a<n.length;)o=f=u=null,v(n[a])&&(u=n[a]),v(n[a+1])&&(f=n[a+1]),v(n[a+2])&&(o=n[a+2],a+=3),u&&f&&o?(a=l.option(c={},n,a,s),l.data.push({x:gn(u),y:gn(f),z:gn(o),style:c}),++s):a+=1;else for(;a<n.length;)if(f=u=null,v(n[a])&&(u=n[a]),v(n[a+1])||I(n[a+1])?(f=n[a+1],a+=2):u&&(u=pr(1,(f=u).length),a+=1),u&&f)if(a=l.option(c={},n,a,s),I(f))for(i=0,e=K(f);i<e;++i)l.data.push({x:gn(u),y:gn(T(f,i)),style:c}),c=l.option(c,n,a,++s);else l.data.push({x:gn(u),y:gn(f),style:c}),++s;else a+=1;return l}},c.figure=at;var st={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var r=[],t=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?t.length&&(S(t[0])?r=r.length?tr("vert",r,t):t:r.push(t),t=[]):!rn(n,dt)&&S(n)?t=t.length?tr("horz",t,n):n:t.push(n))}),t.length&&(S(t[0])?r=r.length?tr("vert",r,t):t:r.length?r.push(t):r=t),r}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return pr(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r){return pr(n,r)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r,t){return pr(n,r,t)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:gr},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:mr},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:Hn},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:Gn},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,r){return Hr(n,r)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:Vn},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:Vn},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:P},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:Bn},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:Qn},"-":{name:"sub",arity:2,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:Un},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Xn},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:L},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:On},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Mn},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:zn},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:R},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,r){return En(n)&&En(r)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){return En(n)||En(r)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){n=En(n),r=En(r);return n&&!r||r&&!n?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return En(n)?0:1}},"=":{name:"set",breakpoint:"end",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,r){var t,i;return S(n)&&rn(n[0],dt)?(i=n,S(t=r)?await Promise.all(i.map(function(n,r){return ht(n,r<t.length?t[r]:null)})):await Promise.all(i.map(function(n,r){return ht(n,0===r?t:null)}))):ht(n,r.$scilitevarargout$?r[0]:r)}}};async function ht(n,r){if(rn(n,dt)&&E(n.v))return await n.set(r),n.get(!0);throw"setting non-variable"}async function mt(n,r,t){var i,e,u,f,o,c,l=null;if(En(await wt(n.if.cond,r,t))){for(i=0,f=(o=n.if.statements).length;i<f;++i)null!=(c=await wt(o[i],r,t))&&(l=c);return l}if(n.elseif.length)for(e=0,u=n.elseif.length;e<u;++e)if(En(await wt(n.elseif[e].cond,r,t))){for(i=0,f=(o=n.elseif[e].statements).length;i<f;++i)null!=(c=await wt(o[i],r,t))&&(l=c);return l}if(n.else.statements.length){for(i=0,f=(o=n.else.statements).length;i<f;++i)null!=(c=await wt(o[i],r,t))&&(l=c);return l}}async function gt(n,r,t){var i,e,u,f,o,c,l,a=null,s=!1,h=!1,m=await wt(n.val,r,t),g=n.statements;if(S(m)){for(c=(t=t||{}).brk,l=t.cont,t.brk=function(){s=!0},t.cont=function(){h=!0},u=0,f=m.length;u<f;++u){for(h=s=!1,await n.ind.set(m[u]),i=0,e=g.length;i<e&&(o=await wt(g[i],r,t),!s&&!h);++i)null!=o&&(a=o);if(s)break}t.brk=c,t.cont=l}return a}async function pt(n,r,t){var i,e,u,f=null,o=!1,c=!1,l=n.statements,a=(t=t||{}).brk,s=t.cont;for(t.brk=function(){o=!0},t.cont=function(){c=!0};En(await wt(n.cond,r,t));){for(c=o=!1,i=0,e=l.length;i<e&&(u=await wt(l[i],r,t),!o&&!c);++i)null!=u&&(f=u);if(o)break}return t.brk=a,t.cont=s,f}function dt(n,r,t){if(!rn(this,dt))return new dt(n,r,t);this.ctx=n,this.v=r,this.i=t}function z(n,r){if(!rn(this,z))return new z(n,r);null==r&&(r=n,n=""),this.op=n,this.arg=r}function vt(t){function n(){var n=[].slice.call(arguments);return n.unshift(1),t.apply(null,n)}return n.nargout=function(r){return function(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),1<r&&S(n)&&(n.$scilitevarargout$=!0),n}},n}async function yt(n){return rn(n,dt)?await n.get():n}async function wt(n,r,t){if(rn(n,z))return xt(n,r,t);if(S(n)){for(var i=0,e=n.length,u=new Array(e);i<e;++i)u[i]=await wt(n[i],r,t);return u}return n}function bt(v,y,w,e){var b,x=0,_=0,u=v;function S(n,r,t){null==t&&(t=_),null==r&&(r=x);var i=u.split("\n")[t];return(n=String(n)+" at line "+String((w||0)+t)+" position "+String((e||0)+r)+":")+"\n"+i+"\n"+new Array(r+1).join(" ")+"^\n"}return function e(n){var r,t,i,u,f,o,c,l=[],a=[],s=[];function h(n){var r,t,i,e,u,f,o,c;if(a.length)if(n)for(;0<a.length;){if(u=(e=a.shift())[0],n===(f=st[u]).breakpoint){a.unshift(e);break}if("-"===u&&1===l.length)l[0]=z(st["*"].fn,[l[0],z(-1)]);else{if(f.arity>l.length)throw S('invalid or missing argument for "'+u+'"',e[1],e[2]);c=l.splice(0,f.arity).reverse(),o=z(f.fn,c),l.unshift(o)}}else if(t=(r=a.shift())[0],1===(i=st[t]).fixity){if(i.arity>l.length)throw S('invalid or missing argument for "'+t+'"',r[1],r[2]);c=l.splice(0,i.arity).reverse(),o=z(i.fn,c),l.unshift(o)}else{if(-1!==i.fixity)for(;0<a.length&&(u=(e=a[0])[0],(f=st[u]).priority<i.priority||f.priority===i.priority&&(f.associativity<i.associativity||f.associativity===i.associativity&&-1===f.associativity));){if("-"===u&&1===l.length)l[0]=z(st["*"].fn,[l[0],z(-1)]);else{if(f.arity>l.length)throw S('invalid or missing argument for "'+u+'"',e[1],e[2]);c=l.splice(0,f.arity).reverse(),o=z(f.fn,c),l.unshift(o)}a.shift()}a.unshift(r)}}function m(n){if(h(!0),1<l.length||0<a.length)throw S("mismatched terms and operators",a.length?a[0][1]:x,a.length?a[0][2]:_);!0===n&&(rn(l[0],z)&&s.push(l[0]),l=[],a=[])}function g(n,r){var t,i=n.test?v.match(n):n===v.slice(0,n.length);return!!i&&(!1===r?n.test?i:[n,n]:n.test?(t=i[r||0].length,v=v.slice(t),x+=t,i):(t=n.length,v=v.slice(t),x+=t,[n,n]))}function p(n,r,t){for(var i,e=t||0,u="";e<v.length;)if(n===(i=v.charAt(e))){if(!(e+1<v.length&&n===v.charAt(e+1)))break;u+=i,e+=2}else u+=i,e+=1;return r&&(v=v.slice(e+1),x+=e+1),[u,e+1]}function d(){var n,r,t,i=function(n,r,t){for(var i,e=0,u=0;e<v.length;)if(i=v.charAt(e),!t||'"'!==i&&"'"!==i){if(r===i)++u;else if(n===i){if(0===u)break;--u}++e}else e=p(i,!1,e+1)[1];return u||e>=v.length?-1:e}("]","[",!0);if(-1===i)throw S("mismatched brackets");if(n=v.slice(0,i),/[\[\]]/.test(n)){for(r=[];t=e(",;]");)if(r.push(t),g(","))r.push(z(","));else{if(!g(";"))break;r.push(z(";"))}g(/^\s+/),g("]")}else r=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,r){var t=n.length,i=0;return r.trim().split(-1<r.indexOf(",")?",":/\s+/g).reduce(function(n,r){return(r=bt(r.trim(),y,_+w,x))&&(i?n.push(z(",")):t&&n.push(z(";")),n.push(r),i=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,r){return(r=bt(r.trim(),y,_+w,x))&&(n.length&&n.push(z(",")),n.push(r)),n},[]),v=v.slice(i+1),x+=i+1,1<(n=n.split("\n")).length&&(_+=n.length-1,n.slice(0,-1).forEach(function(n){x-=n.length+1}));return z(st["[]"].fn,r)}for(;0<v.length;)if(g(/^if\b/)){if(m(!0),!(c=e("\n,")))throw S('missing or invalid condition in "if"');for(g("\n")?(++_,x=0):g(","),f=(o={if:{cond:c,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((c=e(["elseif","else","end"]))&&(f.statements=f.statements.concat(c)),g("elseif")){if(!(c=e("\n,")))throw S('missing or invalid condition in "elseif"');g("\n")?(++_,x=0):g(","),o.elseif.push({cond:c,statements:[]}),f=o.elseif[o.elseif.length-1]}else if(g("else"))g(/^[ \t\v\f]+/),g("\n")?(++_,x=0):g(","),f=o.else;else if(g("end")||!c)break;s.push(z(mt,o))}else if(g(/^for\b/)){if(m(!0),!(r=g(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw S('missing or invalid declaration in "for"');if(!(c=e("\n,")))throw S('missing or invalid declaration in "for"');for(g("\n")?(++_,x=0):g(","),o={ind:dt(y,r[1]),val:c,statements:[]};(c=e(["end"]))&&(o.statements=o.statements.concat(c)),!g("end")&&c;);s.push(z(gt,o))}else if(g(/^while\b/)){if(m(!0),!(c=e("\n,")))throw S('missing or invalid condition in "while"');for(g("\n")?(++_,x=0):g(","),o={cond:c,statements:[]};(c=e(["end"]))&&(o.statements=o.statements.concat(c)),!g("end")&&c;);s.push(z(pt,o))}else if(r=g(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(r[1]))break;if("continue"===r[1])g("continue"),s.push(z("continue",""));else if("break"===r[1])g("break"),s.push(z("break",""));else{if("end"!==r[1])throw S('unexpected "'+r[1]+'"');g("end"),l.unshift(z("v",dt(y,"end")))}}else if(g("..."))g(/^[ \t\v\f]+/),g("\n")&&(++_,x=0);else if(g(";",!1)){if(n&&-1<n.indexOf(";"))break;g(";"),m(!0)}else if(g("\n",!1)){if(n&&-1<n.indexOf("\n"))break;g("\n"),++_,m(!(x=0))}else if(g(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(r=g("%"))b=v.indexOf("\n"),v=v.slice(-1<b?b+1:v.length),++_,m(!(x=0));else if(r=(r=g("'"))||g('"'))f=p(r[0],!0)[0],l.unshift(z("'"===r[0]?f.split(""):f));else if(r=g(/^(&&|\|\|)[^&\|]/,1))u=r[1],a.unshift([u,x,_]),h();else if(r=g(/^(xor)[^a-zA-Z]/,1))u=r[1],a.unshift([u,x,_]),h();else if(r=g(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=r[1],a.unshift([u,x,_]),h();else if(r=g("~"))a.unshift(["~",x,_]),h();else if(r=g("="))a.unshift(["=",x,_]),h();else if(r=g(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=r[0],a.unshift([u,x,_]),h();else if(r=g(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(t=r[1],g(/^\s*\:\s*\)/))f=z("v",dt(y,t)),l.unshift(f),a.unshift(["(:)",x,_]),h();else{for(o=[];(c=e(",)"))&&o.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");f=O.call(A,t)?z(A[t],o):z("v",dt(y,t,o.length?o:null)),l.unshift(f)}g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,_]),h())}else if(r=g(/^[_a-z][_a-z0-9]*/i))t=r[0],f=O.call(A,t)&&0===A[t].length?z(A[t],[]):z("v",dt(y,t)),l.unshift(f),g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,_]),h());else if(r=g(/^(-?\s*\d+(\.\d+)?([eE][+-]?\d+)?)([ij])?/))o=r[1].split(/\s+/).join(""),o=k?k(o):parseFloat(o,10),f=z(r[4]?new j(0,o):o),l.unshift(f);else if("["===(i=v.charAt(0)))v=v.slice(1),x+=1,(f=d())&&(l.unshift(f),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,_]),h());else{if("]"===i){if(n&&-1<n.indexOf("]"))break;throw S("mismatched brackets")}if("("===i)if(v=v.slice(1),x+=1,g(/^\s*\:\s*\)/))a.unshift(["(:)",x,_]),h();else{if(l.length&&a.reduce(function(n,r){return n+("-"===r[0]&&1===l.length?1:st[r[0]].arity)},0)<=l.length){for(h("end"),f=l.shift(),o=[];(c=e(",)"))&&o.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");o.length&&(f=z("v",dt(y,f,o)))}else if(f=e(")"),!g(")"))throw S("mismatched parentheses");f&&(l.unshift(f),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,_]),h())}else{if(")"===i){if(n&&-1<n.indexOf(")"))break;throw S("mismatched parentheses")}if(","===i&&n&&-1<n.indexOf(","))break;if(":"!==i)throw S(n?'missing expected "'+(E(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+i+'"');if(n&&-1<n.indexOf(":"))break;for(v=v.slice(1),c=[x+=1,_],h("end"),l.length?o=1:(o=0,l.unshift(z(":")));f=e(":,)\n"),g(/^[ \t\v\f]+/),f?(l.unshift(f),++o):g(":",!1)&&l.unshift(z(":")),g(":"););1<o&&(a.unshift([3===o?"::":":",c[0],c[1]]),h())}}return m(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function xt(n,r,t){var i;if(rn(n,z)){if(""===n.op)return n.arg;if("v"===n.op)return!1===r?n.arg:rn(n.arg.v,z)?yt(n.arg):tn(r)&&O.call(r,n.arg.v)?r[n.arg.v]:await yt(n.arg);if(mt===n.op)return mt(n.arg,r,t);if(gt===n.op)return gt(n.arg,r,t);if(pt===n.op)return pt(n.arg,r,t);if("break"===n.op)return void(t&&d(t.brk)&&t.brk());if("continue"===n.op)return void(t&&d(t.cont)&&t.cont());if(st["="].fn===n.op)return t=t||{},i=await xt(n.arg[0],!1),S(i)&&rn(i[0],dt)&&(t.nargout=i.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[i,n.arg[1].arg.isByRef()?kn(await xt(n.arg[1],r,t)):await xt(n.arg[1],r,t)]):n.op.apply(null,[i].concat(await Promise.all(n.arg.slice(1).map(function(n){return xt(n,r,t)}))));if(d(n.op))return(t&&w(t.nargout)&&d(n.op.nargout)?n.op.nargout(t.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return xt(n,r,t)})))}throw"invalid expr"}return g.op=st,dt.prototype={constructor:dt,ctx:null,v:null,i:null,get:async function(n){var r,t,i=this;if(rn(i.v,z))r=await wt(i.v);else{if(!O.call(i.ctx,i.v)&&!O.call(p,i.v))throw'undefined variable "'+i.v+'"';r=(O.call(i.ctx,i.v)?i.ctx:p)[i.v]}return!0!==n&&null!=i.i?(t=or(r),n=await Promise.all(i.i.map(function(n,r){return wt(n,{end:1===i.i.length?t[0]*t[1]:t[r]})})),nr.apply(null,[r].concat(n))):r},set:async function(n){var r,t,i,e=this;if(null!=e.i){if(rn(e.v,z))r=await wt(e.v);else{if(!O.call(e.ctx,e.v))throw'undefined variable "'+e.v+'"';r=e.ctx[e.v]}t=or(r),1===(i=await Promise.all(e.i.map(function(n,r){return wt(n,{end:1===e.i.length?t[0]*t[1]:t[r]})}))).length&&(i=i.concat(null)),rr.apply(null,[r].concat(i).concat([n]))}else rn(e.v,z)||(e.ctx[e.v]=n);return e},isset:function(){return E(this.v)&&O.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},z.prototype={constructor:z,op:null,arg:null},c.varargout=vt,c.createCanvas=function(n,r){},c.currentCanvas=function(){},c.createContext=function(){return{ans:null}},c.eval=async function(n,r,t){r=r||c.createContext();var i=bt(String(n),r,null==t?1:t,1),e=null,u=!1;if(S(i))for(var f=0,o=i.length;f<o;++f)i[f]&&(e=await xt(i[f]),u=!0);else i&&(e=await xt(i),u=!0);return u&&(S(e)||en(e)||b(e)||E(e))&&(r.ans=e),u?e:null},g});