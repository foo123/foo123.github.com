var NEngine={version:{name:"alpha 0.1",number:0.1},env:{name:"",type:"",debug:1,interval:34}};NEngine.env.BROWSER="browser";NEngine.env.MOBILE="mobile";NEngine.env.CONSOLE="console";NEngine.utils={_next_ID:0};NEngine.utils.getUID=function(){return++this._next_ID};NEngine.utils.assertSame=function(d,a){return d==a?!0:!1};
NEngine.utils.log=function(){if(NEngine.env.debug)switch(NEngine.env.type){case NEngine.env.BROWSER:try{"undefined"!==typeof console&&console&&console.log&&console.log.apply(NEngine,arguments)}catch(d){console.log(Array.prototype.join.apply(arguments,[","]))}}};NEngine.utils.getTimestamp=function(){return Math.round((new Date).getTime()/1E3)};NEngine.utils.getTimestampInMS=function(){return Math.round((new Date).getTime())};NEngine.init=function(){NEngine.env.type=NEngine.env.BROWSER;NEngine.utils.log("NEngine.init - done")}();
Function.prototype.inheritsFrom=function(d){d.constructor==Function?(this.prototype=new d,this.prototype.constructor=this,this.prototype.parent=d.prototype):(this.prototype=d,this.prototype.constructor=this,this.prototype.parent=d);return this};(function(d){function a(){throw"Clock cannot be instantiated.";}a._intervalID=0;a._interval=0;a._startTime=0;a._lastTickTime=0;a._tick=0;a._paused=!1;a._listeners=[];a._diff=0;a.addListeners=function(c){a.pause();a._listeners.push(c);a.start()};a.removeListeners=function(c){for(var b=0;b<a._listeners.length;b++)if(a._listeners[b]==c)return a.pause(),c=a._listeners[b],a._listeners.splice(b,1),a.start(),c;return null};a.setInterval=function(c){a.pause();a._interval=c};a.getInterval=function(){return a._interval};
a.setPaused=function(c){a._paused=c};a.getPaused=function(){return a._paused};a.getFPS=function(){return 1E3/a._interval};a.toString=function(){var c=new Date;return"unixts:"+c.getTime()+","+c};a.start=function(){0<a._intervalID&&clearInterval(a._intervalID);if(!(0>=a._interval))a.setPaused(!1),a._intervalID=setInterval(a.tick,a._interval)};a.pause=function(){a.setPaused(!0);0<a._intervalID&&clearInterval(a._intervalID)};a.tick=function(){a._tick++;currentTime=a._getTime();a._diff=Math.abs(currentTime)-
Math.abs(a._lastTickTime);a._lastTickTime=currentTime;for(var c=0;c<a._listeners.length;c++)a._listeners[c].tick&&a._listeners[c].tick()};a.getTime=function(){return(new Date).getTime()};a._getTime=function(){return(new Date).getTime()};a._startTime=a._getTime();d.Clock=a})(NEngine);(function(d){function a(){throw"Keyboard cannot be instantiated.";}a.LEFT=37;a.RIGHT=39;a.UP=38;a.DOWN=40;d.Keyboard=a})(NEngine);(function(d){function a(){}a.prototype.degree2radian=function(c){return Math.PI/180*c};a.prototype.radian2degree=function(c){return c/(Math.PI/180)};d.Angle=a})(NEngine);(function(d){function a(c,a){this.name="Point";this.x=c;this.y=a}a.prototype.clone=function(){return new a(this.x,this.y)};a.prototype.toString=function(){return this.name+"(x:"+this.x+",y:"+this.y+")"};d.Point=a})(NEngine);(function(d){function a(){this.m11=1;this.m21=this.m12=0;this.m22=1;this.dy=this.dx=0}a.prototype.m11=1;a.prototype.m12=0;a.prototype.m21=1;a.prototype.m22=0;a.prototype.dx=0;a.prototype.dy=0;a.prototype.translate=function(c,a){c=parseFloat(c);a=parseFloat(a);this.dx+=c;this.dy+=a};a.prototype.scale=function(c,a){c=parseFloat(c);a=parseFloat(a);this.m11*=c;this.dx*=c;this.m22*=a;this.dy=this.dx*a};a.prototype.skew=function(c,a){c=parseFloat(c);a=parseFloat(a);c=c*Math.PI/180;a=a*Math.PI/180;this.append(Math.cos(a),
Math.sin(a),-Math.sin(c),Math.cos(c),0,0)};a.prototype.rotate=function(c){var c=parseFloat(c),a=Math.cos(c),c=Math.sin(c),e=this.m11,d=this.m12,g=this.m21,h=this.m22,i=this.dx,j=this.dy;this.m11=e*a-d*c;this.m12=e*c+d*a;this.m21=g*a-h*c;this.m22=g*c+h*a;this.dx=i*a-j*c;this.dy=i*c+j*a};a.prototype.invert=function(){var c=this.m11,a=this.m12,e=this.m21,d=this.m22,g=this.dx,h=this.dy,i=c*d-a*e;this.m11=d/i;this.m12=-a/i;this.m21=-e/i;this.m22=c/i;this.dx=(e*h-d*g)/i;this.dy=-(c*h-a*g)/i};a.prototype.identity=
function(){this.m11=1;this.m21=this.dx=this.m12=0;this.m22=1;this.dy=0};a.prototype.prepend=function(c,a,e,d,g,h){var c=parseFloat(c),a=parseFloat(a),e=parseFloat(e),d=parseFloat(d),g=parseFloat(g),h=parseFloat(h),i=this.m11,j=this.m12,k=this.m21,l=this.m22,m=this.dx,n=this.dy;this.m11=c*i+a*k+0*g;this.m12=c*j+a*l+0*g;this.m21=e*i+d*k+0*h;this.m22=e*j+d*l+0*h;this.dx=c*m+a*n+1*g;this.dy=e*m+d*n+1*h};a.prototype.prependMatrix2D=function(c){this.prepend(c.m11,c.m12,c.m21,c.m22,c.dx,c.dy)};a.prototype.append=
function(c,a,e,d,g,h){var c=parseFloat(c),a=parseFloat(a),e=parseFloat(e),d=parseFloat(d),g=parseFloat(g),h=parseFloat(h),i=this.m11,j=this.m12,k=this.m21,l=this.m22,m=this.dx,n=this.dy;this.m11=i*c+j*e+0*m;this.m12=i*a+j*d+0*m;this.m21=k*c+l*e+0*n;this.m22=k*a+l*d+0*n;this.dx=i*g+j*h+1*m;this.dy=k*g+l*h+1*n};a.prototype.appendMatrix2D=function(c){this.append(c.m11,c.m12,c.m21,c.m22,c.dx,c.dy)};a.prototype.clone=function(){var c=new a;c.m11=this.m11;c.m12=this.m12;c.m21=this.m21;c.m22=this.m22;c.dx=
this.dx;c.dy=this.dy;return c};a.prototype.transformPoint=function(c){var a=new d.Point(c.x,c.y);a.x=this.m11*c.x+this.m21*c.y+this.dx;a.y=this.m12*c.x+this.m22*c.y+this.dy;return a};a.prototype.concat=function(c,a,e,d,g,h){return this.prepend(c,a,e,d,g,h)};a.prototype.concatMatrix2D=function(c){this.concat(c.m11,c.m12,c.m21,c.m22,c.dx,c.dy)};a.prototype.toString=function(){return"(m11:"+this.m11+",m12:"+this.m12+",m21:"+this.m21+",m22:"+this.m22+",dx:"+this.dx+",dy:"+this.dy+")"};d.Matrix2D=a})(NEngine);(function(d){d.Event=function(){}})(NEngine);(function(d){function a(c){this._e=c;this.keycode=c.keyCode;this.charcode=c.charCode}a.prototype._e=null;a.prototype.keycode=0;a.prototype.charcode=0;d.KeyboardEvent=a})(NEngine);(function(d){function a(c){this._e=c;this.pageX=c.pageX;this.pageY=c.pageY}a.prototype._e=null;a.prototype.pageX=0;a.prototype.pageY=0;d.MouseEvent=a})(NEngine);(function(d){function a(){this.__displayobject_init()}a.prototype.constructor=a;a.suppressCrossDomainErrors=!1;a._hitTestCanvas=document.createElement("canvas");a._hitTestCanvas.width=a._hitTestCanvas.height=1;a._hitTestContext=a._hitTestCanvas.getContext("2d");a.prototype.id=null;a.prototype.name=null;a.prototype.x=0;a.prototype.y=0;a.prototype.width=0;a.prototype.height=0;a.prototype.scaleX=1;a.prototype.scaleY=1;a.prototype.skewX=0;a.prototype.skewY=0;a.prototype.regX=0;a.prototype.regY=0;a.prototype.rotation=
0;a.prototype._mtx=null;a.prototype.mouseX=0;a.prototype.mouseY=0;a.prototype.visible=!0;a.prototype.isFocus=!1;a.prototype.isBounds=!1;a.prototype.alpha=1;a.prototype.shadow=null;a.prototype.compositeOperation="";a.prototype.cursor=null;a.prototype.stage=null;a.prototype.parent=null;a.prototype.cacheCanvas=null;a.prototype.ignoreCache=!1;a.prototype.onClick=null;a.prototype.onMouseDown=null;a.prototype.onMouseUp=null;a.prototype.onMouseOver=null;a.prototype.onMouseMove=null;a.prototype.onMouseOut=
null;a.prototype.onKeyDown=null;a.prototype.onKeyUp=null;a.prototype.onKeyPress=null;a.prototype.__draw=function(c,a){if(a||!this.cacheCanvas)return!1;c.drawImage(this.cacheCanvas,this.x-this.regX,this.y-this.regY);return!0};a.prototype.clone=function(){var c=new a;c.name=this.name;c.x=this.x;c.y=this.y;c.width=this.width;c.height=this.height;c.scaleX=this.scaleX;c.scaleY=this.scaleY;c.skewX=this.skewX;c.skewY=this.skewY;c.regX=this.regX;c.regY=this.regY;c.rotation=this.rotation;c._mtx=this._mtx;
c.mouseX=this.mouseX;c.mouseY=this.mouseY;c.visible=this.visible;c.alpha=this.alpha;c.shadow=this.shadow;c.compositeOperation=this.compositeOperation;c.stage=this.stage;c.parent=this.parent;c.cacheCanvas=this.cacheCanvas;c.ignoreCache=this.ignoreCache;return c};a.prototype.toString=function(){return this.name+"(id:"+this.id+")"};a.prototype.debug=function(c){for(var a in c)d.utils.log(a+"="+c[a])};a.prototype.getConcatenatedMatrix=function(c){c?c.identity():c=new d.Matrix2D;for(var a=this;null!=a;)a=
a.parent;return c};a.prototype.applyShadow=function(){};a.prototype.applyStyle=function(c){if(null!=this.fillStyle)this.__fillStyle=c.fillStyle,c.fillStyle=this.fillStyle.toRGB();if(null!=this.strokeStyle)this.__strokeStyle=c.strokeStyle,c.strokeStyle=this.strokeStyle.toRGB()};a.prototype.resetStyle=function(c){if(null!=this.__fillStyle)c.fillStyle=this.__fillStyle;if(null!=this.__strokeStyle)c.strokeStyle=this.__strokeStyle};a.prototype.globalToLocal=function(c){return new Point(c-this.x,gloablY-
this.y)};a.prototype.localToGlobal=function(c,a){return new Point(c+this.x,a+this.y)};a.prototype.cache=function(){var c;if(null==this.cacheCanvas)this.cacheCanvas=document.createElement("canvas");c=this.cacheCanvas.getContext("2d");this.cacheCanvas.width=this.width;this.cacheCanvas.height=this.height;c.setTransform(1,0,0,1,-this.x,-this.y);c.clearRect(0,0,this.width+1,this.height+1);this.draw(c,!0)};a.prototype.updateCache=function(){this.cache()};a.prototype.clearCache=function(){this.cacheCanvas=
null};a.prototype.__displayobject_init=function(c){this._mtx=new d.Matrix2D;this._mtx.identity();this.id=d.utils.getUID();this.name=c};a.prototype.hitTest=function(c,b){var e=a._hitTestContext,d=a._hitTestCanvas;e.setTransform(1,0,0,1,-c,-b);this.draw(e,!0);e=this._testHit(e);d.width=0;d.width=1;return e};a.prototype._testHit=function(c){try{var b=1<c.getImageData(0,0,1,1).data[3]}catch(e){if(!a.suppressCrossDomainErrors)throw"An error has occured. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images.";
}return b};a.prototype.inBounds=function(c,a){return c>=this.x&&a>=this.y&&c<this.x+this.width&&a<this.y+this.height};d.DisplayObject=a})(NEngine);(function(d){function a(){}a.inheritsFrom(d.DisplayObject);a.prototype.mouseEnabled=!0;d.InteractiveObject=a})(NEngine);(function(d){function a(){this.__displayobject_init("DisplayObjectContainter")}a.inheritsFrom(d.InteractiveObject);a.prototype._children=[];a.prototype._isdirty=!1;a.prototype.numChildren=0;a.prototype.__displayobjectcont_init=function(){this._children=[]};a.prototype.addChild=function(c){this.numChildren++;this._children.push(c);this._isdirty=!0;c.parent=this;c.stage=this};a.prototype.addChildAt=function(){throw"Exception: DisplayObjectContainer.addChildAt(child, index) not implemented";};a.prototype.contains=
function(c){for(var a=0;a<this._children.length;a++)if(this._children[a].id==c.id)return!0;return!1};a.prototype.getChildAt=function(c){return void 0!=this._children[c]?this._children[c]:null};a.prototype.getChildByName=function(){throw"Exception: DisplayObjectContainer.getChildByName(name) not implemented";};a.prototype.getChildIndex=function(c){for(var a=0;a<this._children.length;a++)if(this._children[a].id==c.id)return a;return-1};a.prototype.removeChild=function(c){for(var a=0;a<this._children.length;a++)if(this._children[a].id==
c.id)return c=this._children[a],c.parent=null,c.stage=null,this._children.splice(a,1),this._isdirty=!0,this.numChildren--,c;return null};a.prototype.removeChildAt=function(c){var a=this._children[c];a.parent=null;a.stage=null;this._children.splice(c,1);this._isdirty=!0;this.numChildren--;return a};a.prototype.setChildIndex=function(){throw"Exception: DisplayObjectContainer.setChildIndex(child, index) not implemented";};a.prototype.swapChildren=function(c,a){for(var e=-1,d=-1,g=0;g<this._children.length;g++)this._children[g].id==
c.id&&(e=g),this._children[g].id==a.id&&(d=g);-1!=e&&-1!=d&&(g=this._children[e],this._children[e]=this._children[d],this._children[d]=g)};a.prototype.swapChildrenAt=function(c,a){if(void 0!=this._children[c]&&void 0!=this._children[a]){var e=this._children[c];this._children[c]=this._children[a];this._children[a]=e}};a.prototype.getObjectsUnderPoint=function(a,b){for(var e=[],d=0;d<this._children.length;d++)this._children[d]instanceof DisplayObjectContainter||this._children[d].inBounds(a,b)&&e.push(this._children[d]);
return e};d.DisplayObjectContainer=a})(NEngine);(function(d){function a(a){this.__displayobject_init("Sprite");this.__displayobjectcont_init();this.__stage_init(a)}a.inheritsFrom(d.DisplayObjectContainer);a.prototype.canvas=null;a.prototype.graphics=null;a.prototype.autoClear=!0;a.prototype.useHandCursor=!0;a.prototype.__stage_init=function(a){this.stage=this;this.canvas=a;this.graphics=new d.Graphics(this.canvas);var b=this;window.addEventListener?(window.addEventListener("mousemove",function(a){b._handleOnMouseMove(a)},!1),window.addEventListener("mouseup",
function(a){b._handleOnMouseUp(a)},!1),window.addEventListener("mousedown",function(a){b._handleOnMouseDown(a)},!1),window.addEventListener("mouseover",function(a){b._handleOnMouseOver(a)},!1),window.addEventListener("mouseout",function(a){b._handleOnMouseOut(a)},!1),window.addEventListener("click",function(a){b._handleOnClick(a)},!1),window.addEventListener("keydown",function(a){b._handleOnKeyDown(a)},!1),window.addEventListener("keyup",function(a){b._handleOnKeyUp(a)},!1),window.addEventListener("keypress",
function(a){b._handleOnKeyPress(a)},!1)):document.addEventListener?(document.addEventListener("mousemove",function(a){b._handleOnMouseMove(a)},!1),document.addEventListener("mouseup",function(a){b._handleOnMouseUp(a)},!1),document.addEventListener("mousedown",function(a){b._handleOnMouseDown(a)},!1),document.addEventListener("mouseover",function(a){b._handleOnMouseOver(a)},!1),document.addEventListener("mouseout",function(a){b._handleOnMouseOut(a)},!1),document.addEventListener("click",function(a){b._handleOnClick(a)},
!1),document.addEventListener("keydown",function(a){b._handleOnKeyDown(a)},!1),document.addEventListener("keyup",function(a){b._handleOnKeyUp(a)},!1),document.addEventListener("keypress",function(a){b._handleOnKeyPress(a)},!1)):window.attachEvent&&(window.attachEvent("mousemove",function(a){b._handleOnMouseMove(a)}),window.attachEvent("mouseup",function(a){b._handleOnMouseUp(a)}),window.attachEvent("mousedown",function(a){b._handleOnMouseDown(a)}),window.attachEvent("mouseover",function(a){b._handleOnMouseOver(a)}),
window.attachEvent("mouseout",function(a){b._handleOnMouseOut(a)}),window.attachEvent("click",function(a){b._handleOnClick(a)}),window.attachEvent("keydown",function(a){b._handleOnKeyDown(a)}),window.attachEvent("keyup",function(a){b._handleOnKeyUp(a)}),window.attachEvent("keypress",function(a){b._handleOnKeyPress(a)}));this.draw()};a.prototype._handleOnMouseMove=function(a){if(this.canvas){if(this.mouseX=a.pageX-this.canvas.offsetLeft,this.mouseY=a.pageY-this.canvas.offsetTop,0<=this.mouseX&&0<=
this.mouseY&&this.mouseX<this.canvas.width&&this.mouseY<this.canvas.height){if(this.onMouseMove)this.onMouseMove(a);for(var b=0;b<this._children.length;b++)if(this._children[b].mouseX=a.pageX-this.canvas.offsetLeft-this._children[b].x,this._children[b].mouseY=a.pageY-this.canvas.offsetTop-this._children[b].y,this._children[b].mouseEnabled&&this._children[b].onMouseMove&&this._children[b].onMouseMove instanceof Function)this._children[b].onMouseMove(a)}}else this.mouseX=this.mouseY=null};a.prototype._handleOnMouseUp=
function(a){if(this.canvas){this.mouseX=a.pageX-this.canvas.offsetLeft;this.mouseY=a.pageY-this.canvas.offsetTop;if(this.onMouseUp)this.onMouseUp(a);for(var b=0;b<this._children.length;b++)if(this._children[b].mouseX=a.pageX-this.canvas.offsetLeft-this._children[b].x,this._children[b].mouseY=a.pageY-this.canvas.offsetTop-this._children[b].y,this._children[b].mouseEnabled&&this._children[b].onMouseUp&&this._children[b].onMouseUp instanceof Function)this._children[b].onMouseUp(a)}else this.mouseX=this.mouseY=
null};a.prototype._handleOnMouseDown=function(a){if(this.canvas){this.mouseX=a.pageX-this.canvas.offsetLeft;this.mouseY=a.pageY-this.canvas.offsetTop;if(this.onMouseDown)this.onMouseDown(a);for(var b=0;b<this._children.length;b++)if(this._children[b].mouseX=a.pageX-this.canvas.offsetLeft-this._children[b].x,this._children[b].mouseY=a.pageY-this.canvas.offsetTop-this._children[b].y,this._children[b].mouseEnabled&&this._children[b].onMouseDown&&this._children[b].onMouseDown instanceof Function)this._children[b].onMouseDown(a)}else this.mouseX=
this.mouseY=null};a.prototype._handleOnMouseOver=function(a){if(this.canvas){this.mouseX=a.pageX-this.canvas.offsetLeft;this.mouseY=a.pageY-this.canvas.offsetTop;if(this.onMouseOver)this.onMouseOver(a);for(var b=0;b<this._children.length;b++)if(this._children[b].mouseX=a.pageX-this.canvas.offsetLeft-this._children[b].x,this._children[b].mouseY=a.pageY-this.canvas.offsetTop-this._children[b].y,this._children[b].mouseEnabled&&this._children[b].onMouseOver&&this._children[b].onMouseOver instanceof Function)this._children[b].onMouseOver(a)}else this.mouseX=
this.mouseY=null};a.prototype._handleOnMouseOut=function(a){if(this.canvas){this.mouseX=a.pageX-this.canvas.offsetLeft;this.mouseY=a.pageY-this.canvas.offsetTop;if(this.onMouseOut)this.onMouseOut(a);for(var b=0;b<this._children.length;b++)if(this._children[b].mouseX=a.pageX-this.canvas.offsetLeft-this._children[b].x,this._children[b].mouseY=a.pageY-this.canvas.offsetTop-this._children[b].y,this._children[b].mouseEnabled&&this._children[b].onMouseOut&&this._children[b].onMouseOut instanceof Function)this._children[b].onMouseOut(a)}else this.mouseX=
this.mouseY=null};a.prototype._handleOnClick=function(a){if(this.canvas){this.mouseX=a.pageX-this.canvas.offsetLeft;this.mouseY=a.pageY-this.canvas.offsetTop;if(this.onClick)this.onClick(a);for(var b=0;b<this._children.length;b++)if(this._children[b].mouseX=a.pageX-this.canvas.offsetLeft-this._children[b].x,this._children[b].mouseY=a.pageY-this.canvas.offsetTop-this._children[b].y,this._children[b].mouseEnabled&&this._children[b].inBounds(this.mouseX,this.mouseY)&&this._children[b].onClick&&this._children[b].onClick instanceof
Function)this._children[b].onClick(a)}else this.mouseX=this.mouseY=null};a.prototype._handleOnKeyDown=function(a){if(this.canvas){if(this.onKeyDown)this.onKeyDown(a);for(var b=0;b<this._children.length;b++)if(this._children[b].onKeyDown&&this._children[b].onKeyDown instanceof Function)this._children[b].onKeyDown(a)}};a.prototype._handleOnKeyUp=function(a){if(this.canvas){if(this.onKeyUp)this.onKeyUp(a);for(var b=0;b<this._children.length;b++)if(this._children[b].onKeyUp&&this._children[b].onKeyUp instanceof
Function)this._children[b].onKeyUp(a)}};a.prototype._handleOnKeyPress=function(a){if(this.canvas){if(this.onKeyPress)this.onKeyPress(a);for(var b=0;b<this._children.length;b++)if(this._children[b].onKeyPress&&this._children[b].onKeyPress instanceof Function)this._children[b].onKeyPress(a)}};a.prototype.tick=function(){this.draw()};a.prototype.clear=function(){null!=this.canvas&&this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)};a.prototype.draw=function(){if(null!=this.canvas){this.autoClear&&
this.clear();this.useHandCursor&&this.canvas.style.setProperty("cursor","pointer");this.animate&&this.animate();for(var a=0;a<this._children.length;a++)this._children[a].draw(this.graphics.ctx)}};a.prototype.toString=function(){return this.name+"(id:"+this.id+")"};d.Sprite=a})(NEngine);(function(d){function a(a){this.__displayobject_init("Stage");this.__displayobjectcont_init();this.__stage_init(a);d.Clock.setInterval(d.env.interval);d.Clock.addListeners(this);d.Clock.start()}a.inheritsFrom(d.DisplayObjectContainer);a.prototype.canvas=null;a.prototype.graphics=null;a.prototype.autoClear=!0;a.prototype.__stage_init=function(a){this.stage=this;this.canvas=a;this.graphics=new d.Graphics(this.canvas);this.canvas.globalOffsetLeft=this.canvas.offsetLeft;this.canvas.globalOffsetTop=this.canvas.offsetTop;
for(a=this.canvas;a=a.offsetParent;)this.canvas.globalOffsetLeft+=a.offsetLeft,this.canvas.globalOffsetTop+=a.offsetTop;var b=this;window.addEventListener?(window.addEventListener("mousemove",function(a){b._handleOnMouseMove(a)},!1),window.addEventListener("mouseup",function(a){b._handleOnMouseUp(a)},!1),window.addEventListener("mousedown",function(a){b._handleOnMouseDown(a)},!1),window.addEventListener("click",function(a){b._handleOnClick(a)},!1),window.addEventListener("keydown",function(a){b._handleOnKeyDown(a)},
!1),window.addEventListener("keyup",function(a){b._handleOnKeyUp(a)},!1),window.addEventListener("keypress",function(a){b._handleOnKeyPress(a)},!1)):document.addEventListener?(document.addEventListener("mousemove",function(a){b._handleOnMouseMove(a)},!1),document.addEventListener("mouseup",function(a){b._handleOnMouseUp(a)},!1),document.addEventListener("mousedown",function(a){b._handleOnMouseDown(a)},!1),document.addEventListener("click",function(a){b._handleOnClick(a)},!1),document.addEventListener("keydown",
function(a){b._handleOnKeyDown(a)},!1),document.addEventListener("keyup",function(a){b._handleOnKeyUp(a)},!1),document.addEventListener("keypress",function(a){b._handleOnKeyPress(a)},!1)):window.attachEvent&&(window.attachEvent("mousemove",function(a){b._handleOnMouseMove(a)}),window.attachEvent("mouseup",function(a){b._handleOnMouseUp(a)}),window.attachEvent("mousedown",function(a){b._handleOnMouseDown(a)}),window.attachEvent("click",function(a){b._handleOnClick(a)}),window.attachEvent("keydown",
function(a){b._handleOnKeyDown(a)}),window.attachEvent("keyup",function(a){b._handleOnKeyUp(a)}),window.attachEvent("keypress",function(a){b._handleOnKeyPress(a)}));this.draw()};a.prototype._handleOnMouseMove=function(a){if(this.canvas){this.mouseX=a.pageX-this.canvas.globalOffsetLeft;this.mouseY=a.pageY-this.canvas.globalOffsetTop;var b=0<=this.mouseX&&0<=this.mouseY&&this.mouseX<this.canvas.width&&this.mouseY<this.canvas.height;if(b){if(this.onMouseMove)this.onMouseMove(a);for(var d=0;d<this._children.length;d++)if(this._children[d].mouseX=
this.mouseX-this._children[d].x,this._children[d].mouseY=this.mouseY-this._children[d].y,this._children[d].mouseEnabled){if((b=this._children[d].inBounds(this.mouseX,this.mouseY))&&this._children[d].onMouseMove&&this._children[d].onMouseMove instanceof Function)this._children[d].onMouseMove(a);var f=this._children[d].isBounds;if(!1==f&&b&&this._children[d].onMouseOver&&this._children[d].onMouseOver instanceof Function&&(this._children[d].onMouseOver(a),this._children[d].isBounds=!0,this._children[d].cursor))this.canvas.style.cursor=
this._children[d].cursor;if(f&&!1==b&&this._children[d].onMouseOut&&this._children[d].onMouseOut instanceof Function&&(this._children[d].onMouseOut(a),this._children[d].isBounds=!1,this._children[d].cursor))this.canvas.style.cursor="auto"}}}else this.mouseX=this.mouseY=null};a.prototype._handleOnMouseUp=function(a){if(this.canvas){this.mouseX=a.pageX-this.canvas.globalOffsetLeft;this.mouseY=a.pageY-this.canvas.globalOffsetTop;if(this.onMouseUp)this.onMouseUp(a);for(var b=0;b<this._children.length;b++)if(this._children[b].mouseX=
this.mouseX-this._children[b].x,this._children[b].mouseY=this.mouseY-this._children[b].y,this._children[b].mouseEnabled&&this._children[b].inBounds(this.mouseX,this.mouseY)&&this._children[b].onMouseUp&&this._children[b].onMouseUp instanceof Function)this._children[b].onMouseUp(a)}else this.mouseX=this.mouseY=null};a.prototype._handleOnMouseDown=function(a){if(this.canvas){this.mouseX=a.pageX-this.canvas.globalOffsetLeft;this.mouseY=a.pageY-this.canvas.globalOffsetTop;if(this.onMouseDown)this.onMouseDown(a);
for(var b=0;b<this._children.length;b++)if(this._children[b].mouseX=this.mouseX-this._children[b].x,this._children[b].mouseY=this.mouseY-this._children[b].y,this._children[b].mouseEnabled&&this._children[b].inBounds(this.mouseX,this.mouseY)&&this._children[b].onMouseDown&&this._children[b].onMouseDown instanceof Function)this._children[b].onMouseDown(a)}else this.mouseX=this.mouseY=null};a.prototype._handleOnMouseOver=function(a){if(this.canvas){if(this.mouseX=a.pageX-this.canvas.globalOffsetLeft,
this.mouseY=a.pageY-this.canvas.globalOffsetTop,this.onMouseOver)this.onMouseOver(a)}else this.mouseX=this.mouseY=null};a.prototype._handleOnMouseOut=function(a){if(this.canvas){if(this.mouseX=a.pageX-this.canvas.globalOffsetLeft,this.mouseY=a.pageY-this.canvas.globalOffsetTop,this.onMouseOut)this.onMouseOut(a)}else this.mouseX=this.mouseY=null};a.prototype._handleOnClick=function(a){if(this.canvas){this.mouseX=a.pageX-this.canvas.globalOffsetLeft;this.mouseY=a.pageY-this.canvas.globalOffsetTop;if(this.onClick)this.onClick(a);
for(var b=0;b<this._children.length;b++)if(this._children[b].mouseX=this.mouseX-this._children[b].x,this._children[b].mouseY=this.mouseY-this._children[b].y,this._children[b].mouseEnabled&&this._children[b].inBounds(this.mouseX,this.mouseY)&&this._children[b].onClick&&this._children[b].onClick instanceof Function)this._children[b].onClick(a)}else this.mouseX=this.mouseY=null};a.prototype._handleOnKeyDown=function(a){if(this.canvas){if(this.onKeyDown)this.onKeyDown(a);for(var b=0;b<this._children.length;b++)if(this._children[b].onKeyDown&&
this._children[b].onKeyDown instanceof Function)this._children[b].onKeyDown(a)}};a.prototype._handleOnKeyUp=function(a){if(this.canvas){if(this.onKeyUp)this.onKeyUp(a);for(var b=0;b<this._children.length;b++)if(this._children[b].onKeyUp&&this._children[b].onKeyUp instanceof Function)this._children[b].onKeyUp(a)}};a.prototype._handleOnKeyPress=function(a){if(this.canvas){if(this.onKeyPress)this.onKeyPress(a);for(var b=0;b<this._children.length;b++)if(this._children[b].onKeyPress&&this._children[b].onKeyPress instanceof
Function)this._children[b].onKeyPress(a)}};a.prototype.tick=function(){this.draw()};a.prototype.clear=function(){null!=this.canvas&&this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)};a.prototype.draw=function(){if(null!=this.canvas){this.autoClear&&this.clear();for(var a=0;a<this._children.length;a++)if(this._children[a].animate&&this._children[a].animate(),this._children[a].visible){var b=this._children[a]._mtx.clone();this.graphics.ctx.setTransform(b.m11,b.m12,b.m21,
b.m22,b.dx,b.dy);0!=this._children[a].rotation&&(this.graphics.ctx.translate(this._children[a].x+this._children[a].regX,this._children[a].y+this._children[a].regY),this.graphics.ctx.rotate(this._children[a].rotation),this.graphics.ctx.translate(-(this._children[a].x+this._children[a].regX),-(this._children[a].y+this._children[a].regY)));this.graphics.ctx.globalAlpha=this._children[a].alpha;this.graphics.ctx.globalCompositeOperation=this._children[a].compositeOperation||"source-over";this._children[a].draw(this.graphics.ctx,
this.ignoreCache)}}};a.prototype.toString=function(){return this.name+"(id:"+this.id+")"};d.Stage=a})(NEngine);(function(d){function a(a,b,d,f){if(0>a||256<a||void 0==a)a=0;if(0>b||256<b||void 0==b)b=0;if(0>d||256<d||void 0==d)d=0;if(0>f||1<f||void 0==f)f=1;this.r=a;this.g=b;this.b=d;this.alpha=f}a.prototype.r=0;a.prototype.g=0;a.prototype.b=0;a.prototype.alpha=1;a.prototype.clone=function(){return new a(this.r,this.g,this.b,this.alpha)};a.prototype.toRGB=function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.alpha+")"};a.prototype.toCSS=function(){return"#"+dechex(this.r)+dechex(this.g)+dechex(this.b)};
d.Color=a})(NEngine);(function(d){function a(a){this.canvas=a;this.ctx=this.canvas.getContext("2d")}a.prototype.canvas=null;a.prototype.ctx=null;a.prototype.strokeStyle=function(a){if(null!=this.ctx)return this.ctx.strokeStyle=a.toRGB(),this};a.prototype.fillStyle=function(a){if(null!=this.ctx)return this.ctx.fillStyle=a.toRGB(),this};d.Graphics=a})(NEngine);(function(d){function a(){this.__displayobject_init("Shape")}a.inheritsFrom(d.InteractiveObject);a.prototype.filled=!1;a.prototype.fillStyle=null;a.prototype.strokeStyle=null;a.prototype.rotation=0;a.prototype.clone=function(){return new a};a.prototype.toString=function(){return this.name+"(id:"+this.id+")"};d.Shape=a})(NEngine);(function(d){function a(a,b,d,f,g,h,i,j,k){this.__displayobject_init("Bitmap");this.x=b;this.y=d;this.regX=f/2;this.regY=g/2;if("string"==typeof a){this.image=new Image;var l=this;this.image.onload=function(){l.ready=!0};this.image.src=a}else if(a instanceof Image)this.image=a;else throw"Exception: the first parameter is not String or Image object";if(void 0!=f)this.width=f;if(void 0!=g)this.height=g;if(void 0!=h)this.sx=h;if(void 0!=i)this.sy=i;if(void 0!=j)this.sw=j;if(void 0!=k)this.sh=k}a.inheritsFrom(d.Shape);
a.prototype.image=null;a.prototype.ready=!1;a.prototype.sx=null;a.prototype.sy=null;a.prototype.sw=null;a.prototype.sh=null;a.prototype.clone=function(){return new a(this.image.src)};a.prototype.toString=function(){return this.name+"(id:"+this.id+",imageurl:"+this.image.src+")"};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.ready&&(this.width&&this.height&&void 0!=this.sx&&void 0!=this.sy&&this.sw&&this.sh?a.drawImage(this.image,this.sx,this.sy,this.sw,this.sh,this.x,this.y,this.width,
this.height):this.width&&this.height?a.drawImage(this.image,this.x,this.y,this.width,this.height):a.drawImage(this.image,this.x,this.y))};a.prototype.inBounds=function(a,b){var d=a>=this.x&&b>=this.y&&a<this.x+this.width&&b<this.y+this.height;return this.stage&&d?this.stage.graphics.ctx.getImageData(a,b,1,1).data[3]/255:d};d.Bitmap=a})(NEngine);(function(d){function a(a,b,d,f,g){this.__displayobject_init("Rectangle");this.x=a;this.y=b;this.width=d;this.height=f;this.regX=d/2;this.regY=f/2;if("boolean"==typeof g)this.filled=g}a.inheritsFrom(d.Shape);a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.filled)};a.prototype.toString=function(){return this.name+"(id:"+this.id+",x:"+this.x+",y:"+this.y+",w:"+this.width+",h:"+this.height+")"};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.applyStyle(a);
this.filled?a.fillRect(this.x,this.y,this.width,this.height):a.strokeRect(this.x,this.y,this.width,this.height);this.resetStyle(a)};a.prototype.inBounds=function(a,b){return a>=this.x&&b>=this.y&&a<this.x+this.width&&b<this.y+this.height};d.Rectangle=a})(NEngine);(function(d){function a(a,b,d,f){this.__displayobject_init("Circle");this.x=a;this.y=b;this.radius=d;this.regY=this.regX=0;if("boolean"==typeof f)this.filled=f}a.inheritsFrom(d.Shape);a.prototype.radius=0;a.prototype.clone=function(){return new a(this.x,this.y,this.r,this.filled)};a.prototype.toString=function(){return this.name+"(id:"+this.id+",x:"+this.x+",y:"+this.y+",r:"+this.radius+")"};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.applyStyle(a);a.beginPath();a.arc(this.x,
this.y,this.radius,(new d.Angle).degree2radian(0),(new d.Angle).degree2radian(360),!0);this.filled?a.fill():a.stroke();this.resetStyle(a)};a.prototype.inBounds=function(){return!1};d.Circle=a})(NEngine);(function(d){function a(a,b,d,f){this.__displayobject_init("StaticText");this.x=a;this.y=b;this.regY=this.regX=0;this.text=d;if("boolean"==typeof f)this.filled=f}a.inheritsFrom(d.Shape);a.prototype.text=null;a.prototype.font="12pt Times New Roman";a.prototype.textAlign="left";a.prototype.textBaseline="bottom";a.prototype.maxWidth=0;a.prototype.clone=function(){var c=new a(this.x,this.y,this.text,this.filled);c.font=this.font;c.textAlign=this.textAlign;c.textBaseline=this.textBaseline;c.maxWidth=this.maxWidth;
return c};a.prototype.toString=function(){return this.name+"(id:"+this.id+",x:"+this.x+",y:"+this.y+",text:"+this.text+")"};a.prototype.applyTextStyle=function(a){if(this.font)a.font=this.font;if(this.textAlign)a.textAlign=this.textAlign;if(this.textBaseline)a.textBaseline=this.textBaseline};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.applyStyle(a);this.applyTextStyle(a);this.filled?a.fillText(this.text,this.x,this.y,this.maxWidth):a.strokeText(this.text,this.x,this.y,this.maxWidth);
this.resetStyle(a)};a.prototype.inBounds=function(){return!1};d.StaticText=a})(NEngine);(function(d){function a(a,b,e,f,g){this.__displayobject_init("Button");this.x=a;this.y=b;this.width=e;this.height=f;this.regX=e/2;this.regY=f/2;this.label=new d.StaticText(a+e/2,b+f/2,g,!0);this.label.textAlign="center";this.label.textBaseline="middle";this.cursor="pointer"}a.inheritsFrom(d.Rectangle);a.prototype.label=null;a.prototype._sizeDelta=3;a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.label)};a.prototype.toString=function(){return this.name+"(id:"+this.id+
",x:"+this.x+",y:"+this.y+",w:"+this.width+",h:"+this.height+")"};a.prototype.onMouseOver=function(){this._sizeDelta&&(this.x-=this._sizeDelta,this.y-=this._sizeDelta,this.width+=2*this._sizeDelta,this.height+=2*this._sizeDelta)};a.prototype.onMouseOut=function(){this._sizeDelta&&(this.x+=this._sizeDelta,this.y+=this._sizeDelta,this.width-=2*this._sizeDelta,this.height-=2*this._sizeDelta)};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.applyStyle(a);this.filled?a.fillRect(this.x,
this.y,this.width,this.height):a.strokeRect(this.x,this.y,this.width,this.height);this.label.draw(a,b);this.resetStyle(a)};d.Button=a})(NEngine);(function(d){function a(a,b,e,f,g,h){this.__displayobject_init("ImageButton");this.x=a;this.y=b;this.width=e;this.height=f;this.regX=e/2;this.regY=f/2;this.image=new d.Bitmap(g,a,b,e,f);this.imageMouseOver=new d.Bitmap(h,a,b,e,f);this.active_image=this.image;this.cursor="pointer"}a.inheritsFrom(d.Button);a.prototype.imageMouseOver=null;a.prototype.image=null;a.prototype.active_image=null;a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.image,this.imageMouseOver)};
a.prototype.toString=function(){return this.name+"(id:"+this.id+",x:"+this.x+",y:"+this.y+",w:"+this.width+",h:"+this.height+")"};a.prototype.onMouseOver=function(){if(this._sizeDelta)this.x-=this._sizeDelta,this.y-=this._sizeDelta,this.width+=2*this._sizeDelta,this.height+=2*this._sizeDelta,this.active_image=this.imageMouseOver,this.image.x-=this._sizeDelta,this.image.y-=this._sizeDelta,this.image.width+=2*this._sizeDelta,this.image.height+=2*this._sizeDelta,this.imageMouseOver.x-=this._sizeDelta,
this.imageMouseOver.y-=this._sizeDelta,this.imageMouseOver.width+=2*this._sizeDelta,this.imageMouseOver.height+=2*this._sizeDelta};a.prototype.onMouseOut=function(){if(this._sizeDelta)this.x+=this._sizeDelta,this.y+=this._sizeDelta,this.width-=2*this._sizeDelta,this.height-=2*this._sizeDelta,this.active_image=this.image,this.image.x+=this._sizeDelta,this.image.y+=this._sizeDelta,this.image.width-=2*this._sizeDelta,this.image.height-=2*this._sizeDelta,this.imageMouseOver.x+=this._sizeDelta,this.imageMouseOver.y+=
this._sizeDelta,this.imageMouseOver.width-=2*this._sizeDelta,this.imageMouseOver.height-=2*this._sizeDelta};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.active_image.draw(a,b)};d.ImageButton=a})(NEngine);(function(d){function a(a,b,e,f){this.__displayobject_init("Loader");this.x=a;this.y=b;this.width=e;this.height=f;this.regX=e/2;this.regY=f/2;this.label=new d.StaticText(a+e/2,b+f/2,"0%",!0);this.label.textAlign="center";this.label.textBaseline="middle";this.image=new d.Bitmap("images/big_loading.gif",a,b,e,f)}a.inheritsFrom(d.Shape);a.prototype.label=null;a.prototype.showPercentage=!1;a.prototype.ready=!1;a.prototype._children=[];a.prototype.numChildren=0;a.prototype.clone=function(){return new a(this.x,
this.y,this.width,this.height)};a.prototype.toString=function(){return this.name+"(id:"+this.id+",x:"+this.x+",y:"+this.y+",w:"+this.width+",h:"+this.height+")"};a.prototype.addChild=function(a){this.numChildren++;this._children.push(a)};a.prototype.removeChild=function(a){for(var b=0;b<this._children.length;b++)if(this._children[b].id==a.id)return a=this._children[b],this._children.splice(b,1),this.numChildren--,a;return null};a.prototype.isReady=function(){if(!0==this.ready)return!0;for(var a=0;a<
this._children.length;a++)if("boolean"==typeof this._children[a].ready&&!1==this._children[a].ready)return!1;return this.ready=!0};a.prototype.progress=function(){for(var a=0,b=0;b<this._children.length;b++)"boolean"==typeof this._children[b].ready&&!0==this._children[b].ready&&++a;return a};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.applyStyle(a);this.image.draw(a,b);if(this.showPercentage&&0<this._children.length){var d=this.progress()/this._children.length;this.label.text=
Math.floor(100*d)+"%";this.label.draw(a,b)}else if(this.showPercentage&&0==this._children.length)this.label.text="100%",this.label.draw(a,b);this.resetStyle(a)};d.Loader=a})(NEngine);(function(d){function a(a,b,e,f){this.__displayobject_init("TextField");this.x=a;this.y=b;this.width=e;this.height=f;this.regX=e/2;this.regY=f/2;this.label=new d.StaticText(a+5,b+f/2,"",!0);this.label.textAlign="left";this.label.textBaseline="middle"}a.inheritsFrom(d.Rectangle);a.prototype.label=null;a.prototype.isFlash=!1;a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.toString=function(){return this.name+"(id:"+this.id+",x:"+this.x+",y:"+this.y+",w:"+
this.width+",h:"+this.height+")"};a.prototype.onClick=function(){this.isFocus=!0;this.label.text="click"};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.applyStyle(a);a.strokeRect(this.x,this.y,this.width,this.height);this.label.draw(a,b);this.resetStyle(a)};d.TextField=a})(NEngine);(function(d){function a(a,b,e,f,g,h,i){this.obj=a;this.prop=b;this.animation=e;this.begin=f;this.end=g;this.duration=h;this.useSecond=i;d.Clock.addListeners(this)}a.prototype._start=!1;a.prototype.obj=null;a.prototype.prop=null;a.prototype.animation=null;a.prototype.begin=0;a.prototype.end=0;a.prototype.duration=0;a.prototype.useSecond=0;a.prototype._originXValue=null;a.prototype._originYValue=null;a.prototype.clone=function(){return new a(this.obj,this.prop,this.animation,this.begin,this.end,this.duration,
this.useSecond)};a.prototype.toString=function(){return"(obj:"+this.obj+",prop:"+this.prop+",animation:"+this.animation+",begin:"+this.begin+",end:"+this.end+",duration:"+this.duration+",useSecond:"+this.useSecond+")"};a.prototype.tick=function(){if(this._start){var a;a=this.useSecond?Math.floor((this.end-this.begin)/(this.duration*(1E3/d.env.interval))):Math.floor((this.end-this.begin)/this.duration);if("regular"==this.animation)if("x"==this.prop){if(0<a&&this.obj.x<this.end||0>a&&this.obj.x>this.end)this.obj.x+=
a}else if("y"==this.prop&&(0<a&&this.obj.y<this.end||0>a&&this.obj.y>this.end))this.obj.y+=a}};a.prototype.start=function(){this._start=!0;this.obj.visible=!0;if("regular"==this.animation)if("x"==this.prop)this.obj.x=this.begin,this._originXValue=this.obj.x;else if("y"==this.prop)this.obj.y=this.begin,this._originYValue=this.obj.y};a.prototype.stop=function(){this._start=!1};a.prototype.reset=function(){if("regular"==this.animation)if("x"==this.prop)this.obj.x=this._originXValue;else if("y"==this.prop)this.obj.y=
this._originYValue};d.Tween=a})(NEngine);(function(d){function a(a,b,e,f,g){this.__displayobject_init("NumberRectangle");this.x=a;this.y=b;this.width=e;this.height=f;this.regX=e/2;this.regY=f/2;this.number=new d.StaticText(a+e/2,b+f/2,this.id,!0);this.number.textAlign="center";this.number.textBaseline="middle";if("boolean"==typeof g)this.filled=g}a.inheritsFrom(d.Shape);a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.filled)};a.prototype.toString=function(){return this.name+"(id:"+this.id+",x:"+this.x+
",y:"+this.y+",w:"+this.width+",h:"+this.height+")"};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.applyStyle(a);this.filled?a.fillRect(this.x,this.y,this.width,this.height):a.strokeRect(this.x,this.y,this.width,this.height);this.number.draw(a);this.resetStyle(a)};a.prototype.inBounds=function(a,b){return a>=this.x&&b>=this.y&&a<this.x+this.width&&b<this.y+this.height};d.NumberRectangle=a})(NEngine);(function(d){function a(a,b,e,f,g){this.__displayobject_init("NumberBitmap");this.x=b;this.y=e;this.regX=f/2;this.regY=g/2;this.image=new Image;var h=this;this.image.onload=function(){h.ready=!0};if(f)this.width=f;if(g)this.height=g;this.image.src=a;this.number=new d.StaticText(b,e,this.id,!0)}a.inheritsFrom(d.Shape);a.prototype.image=null;a.prototype.ready=!1;a.prototype.number=null;a.prototype.clone=function(){return new a(this.image.src)};a.prototype.toString=function(){return this.name+"(id:"+
this.id+",imageurl:"+this.image.src+")"};a.prototype.draw=function(a,b){if(this.__draw(a,b))return!0;this.ready&&(this.width&&this.height?a.drawImage(this.image,this.x,this.y,this.width,this.height):a.drawImage(this.image,this.x,this.y));this.number.draw(a)};a.prototype.inBounds=function(a,b){var d=a>=this.x&&b>=this.y&&a<this.x+this.width&&b<this.y+this.height;return this.stage&&d?this.stage.graphics.ctx.getImageData(a,b,1,1).data[3]/255:d};d.NumberBitmap=a})(NEngine);
