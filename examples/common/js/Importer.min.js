/**
*  Importer
*  a simple loader manager for classes and assets with dependencies for PHP, Python, Node/JS
*
*  @version 0.2.0
*  https://github.com/foo123/Importer
**/
!function(e,t,n){"use strict";var r,i="object"==typeof module&&module.exports,s="function"==typeof define&&define.amd;i?module.exports=(module.$deps=module.$deps||{})[t]=module.$deps[t]||n.call(e,{NODE:module})||1:s&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["require","exports","module"],function(t,r,i){return n.call(e,{AMD:i})}):t in e||(e[t]=r=n.call(e,{})||1)&&s&&define(t,[],function(){return r})}(this,"Importer",function(){"use strict";function e(e){return"function"==typeof e}function t(e){return e instanceof String||"[object String]"===v.call(e)}function n(e){return e instanceof Array||"[object Array]"===v.call(e)}function r(e){if(!e)return!0;var t=v.call(e);return(e instanceof Array||e instanceof String||"[object Array]"===t||"[object String]"===t)&&!e.length}function i(e){return n(e)?e:[e]}function s(e){return document.getElementById(e)}function a(e){return document.createElement(e)}function l(e,t){var n=document.getElementsByTagName(e);return arguments.length>1?0>t?n[n.length+t]:n[t]:n}function c(e,t){var n,r,i,s,a,l=typeof t;if("object"===l){r=0;for(n in t)t[g](n)&&(i=t[n],s=i.selector,a=[].concat(i.rules).join("; "),"insertRule"in e.sheet?(e.sheet.insertRule(s+"{"+a+"}",r),i.css=e.sheet.cssRules[r]):"addRule"in e.sheet&&(e.sheet.addRule(s,a,r),i.css=e.sheet.rules[r]),r++)}else"string"===l&&(e.styleSheet?e.styleSheet.cssText=(e.styleSheet.cssText||"")+t:e.appendChild(document.createTextNode(t)));return t}function o(e,t,n){var r,i,s=null,o=null;switch(e){case"tpl-link":case"tpl":s=a("script"),s[y]("type","text/x-tpl"),s.appendChild(document.createTextNode(t)),document.head.appendChild(s);break;case"script-link":if(n)for(i=l("script"),r=i.length-1;r>=0;r--)if(i[r].src&&t===i[r].src){o=i[r];break}o?s=o:(s=a("script"),s[y]("type","text/javascript"),s[y]("language","javascript"),s[y]("src",t),document.head.appendChild(s));break;case"script":s=a("script"),s[y]("type","text/javascript"),s[y]("language","javascript"),s.appendChild(document.createTextNode(t)),document.head.appendChild(s);break;case"style-link":if(n)for(i=l("link"),r=i.length-1;r>=0;r--)if(t===i[r].href){o=i[r];break}o?s=o:(s=a("link"),s[y]("type","text/css"),s[y]("rel","stylesheet"),s[y]("media","all"),s[y]("href",t),document.head.appendChild(s));break;case"style":default:s=a("style"),s[y]("type","text/css"),s[y]("media","all"),s.appendChild(document.createTextNode("")),document.head.appendChild(s),t&&c(s,t)}return s}function u(e,t,n,r){var i,c,u,p,h,f,d=n.length,m=new Array(d);if(x){for(i=0;d>i;i++)m[i]=t[g](n[i].cache_id)?t[n[i].cache_id]:"class"!==n[i].type?t[n[i].cache_id]=R(n[i].path,"utf8"):n[i].name in e?e[n[i].name]:require(n[i].path)||null;return r.apply(e,m)}if(j){for(i=0;d>i;i++)t[g](n[i].cache_id)?m[i]=t[n[i].cache_id]:"class"!==n[i].type?m[i]=t[n[i].cache_id]=R(n[i].path,"utf8"):n[i].name in e?m[i]=e[n[i].name]:(importScripts(n[i].path),m[i]=e[n[i].name]||null);return r.apply(e,m)}p=l("head",0),c=0,i=0,h=function(e,n,r,i){var l,c;"style"===n||"script"===n?(c=s(e))&&n===c.tagName[_]()?i():M(r,"utf8",function(r){t[e]=r,o(n,r)[y]("id",e),i()}):"class"!==n?"template"===n&&(c=s(e))&&"script"===c.tagName[_]()?i():M(r,"utf8",function(r){t[e]=r,"template"!==n||s(e)||o("tpl",r)[y]("id",e),i()}):(c=s(e))&&"script"===c.tagName[_]()?i():(l=0,c=a("script"),c[y]("id",e),c[y]("type","text/javascript"),c[y]("language","javascript"),c.onload=c.onreadystatechange=function(){l||c.readyState&&"loaded"!=c.readyState&&"complete"!=c.readyState||(l=1,c.onload=c.onreadystatechange=null),i()},c[y]("src",r),p.appendChild(c))},f=function v(){var s;(s=t[g](n[i].cache_id))||n[i].name in e?(m[i]=(s?t[n[i].cache_id]:e[n[i].name])||null,++i>=d?r.apply(e,m):(s=t[g](n[i].cache_id))||n[i].name in e?(m[i]=(s?t[n[i].cache_id]:e[n[i].name])||null,v()):(e[n[i].name]=null,h(n[i].cache_id,n[i].type,n[i].path,v))):++c<4?setTimeout(v,20):(c=0,e[n[i++].name]=null,v())};for(;d>i&&((u=t[g](n[i].cache_id))||n[i].name in e);)m[i]=(u?t[n[i].cache_id]:e[n[i].name])||null,i++;d>i?h(n[i].cache_id,n[i].type,n[i].path,f):r.apply(e,m)}function p(e){return e.split(k).join(w)}function h(e){return e.split(w).join(k)}function f(){var e,t,n,r,i,s,a,l,c,o=arguments,u=o.length,f=S;if(!u)return".";if(e=b.call(o,p).join(f),t=e.length,!t)return".";for(n=e.charAt(0),r=e.charAt(t-1),i=e.split(C).filter(Boolean),s=[],a=0,l=i.length-1;l>=0;)c=i[l],".."===c?a++:"."!==c&&(a?a--:s.push(i[l])),l--;return e=s.reverse().join(f),e||n||(e="."),e&&r===f&&(e+=f),(n===f?f:"")+h(e)}var d,m="prototype",g="hasOwnProperty",y="setAttribute",_="toLowerCase",v=Object[m].toString,b=Array[m].map,x="undefined"!=typeof global&&"[object global]"===v.call(global),j=!x&&"undefined"!=typeof WorkerGlobalScope&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,T=!x&&!j&&"undefined"!=typeof navigator,A=x?global:j?this:window,S="/",C=/\/|\\/g,k="://",w="#PROTOCOL#",q=String[m].startsWith?function(e,t,n){return e.startsWith(t,n||0)}:function(e,t,n){return n=n||0,t===e.substr(n,t.length+n)},R=x?function(e,t){return require("fs").readFileSync(e,{encoding:t})}:function(e,t){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return n.open("GET",e,!1),n.setRequestHeader("Content-Type","text/plain; charset="+t),n.overrideMimeType("text/plain; charset="+t),n.send(null),200===n.status?n.responseText:""},M=x?function(e,t,n){return require("fs").readFile(e,{encoding:t},function(e,t){n&&n(e?"":t)}),""}:function(e,t,n){var r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return r.open("GET",e,!0),r.setRequestHeader("Content-Type","text/plain; charset="+t),r.overrideMimeType("text/plain; charset="+t),r.responseType="text",r.onload=function(){n&&n(200===r.status?r.responseText:"")},r.send(null),""};return d=function N(e,t){var n=this;return n instanceof N?(n.base="",n.base_url="",n.base_path(e,t),n._classes={},n._assets={},void(n._cache={})):new N(e,t)},d.VERSION="0.2.0",d.BASE="./",d.join_path=f,d[m]={constructor:d,base:null,base_url:null,_classes:null,_assets:null,_cache:null,dispose:function(){var e=this;return e._classes=null,e._assets=null,e._cache=null,e.base=null,e.base_url=null,e},base_path:function(e,n){var r=this;return t(e)&&e.length?r.base=e:!1===e&&(r.base=""),t(n)&&n.length?r.base_url=n:!1===n&&(r.base_url=""),r},get_path:function(e,t){return r(e)?t||"":!r(t)&&(q(e,"./")||q(e,"../")||q(e,".\\")||q(e,"..\\"))?f(t,e):e},path:function(e){var t=this;return t.get_path(e||"",x?t.base:t.base_url)},path_url:function(e){var t=this;return t.get_path(e||"",t.base_url)},register:function(e,s){var a,l,c,o,u,p,h,f,d,m=this,g=m._classes,y=m._assets;if(n(s)&&s.length)if(n(s[0])||(s=[s]),"classes"===e)for(a=0,l=s.length;l>a;a++)o=s[a],c=o[0],u=o[1],p=o[2],h=o[3]?o[3]:[],r(c)||r(u)||r(p)||(g[u]=[c,u,m.path(p),i(h),!1]);else if("assets"===e)for(a=0,l=s.length;l>a;a++)o=s[a],f=o[0],u=o[1],d=o[2],h=o[3]?o[3]:[],r(f)||r(u)||r(d)||(y[u]=[f[_](),u,t(d)?m.path_url(d):d,i(h),!1,!1]);return m},import_class:function(t,n){var i,s,a,l,c,o,p,h,f=this,d=f._classes,m="class-"+t,y=f._cache;if(y[g](m))e(n)&&n.call(f,y[m]);else{for(s=!1,h=[],i=[t];i.length;)if(t=i[0],d[g](t)&&!d[t][4])if(s=!0,A[g](d[t][0]))y["class-"+t]=A[d[t][0]];else{if(p=d[t][3],!r(p)){for(a=!1,l=p.length,c=l-1;c>=0;c--)o=p[c],d[g](o)&&!d[o][4]&&(a=!0,i.unshift(o));if(a)continue;i.shift()}d[t][4]=!0,h.push({id:t,type:"class",cache_id:"class-"+t,name:d[t][0],path:d[t][2]})}else d[g](t)?(s=!0,i.shift()):i.shift();s&&h.length?u(A,y,h,function(){var t,r,i=arguments;for(t=0,r=i.length;r>t;t++)y[h[t].cache_id]=i[t];e(n)&&n.call(f,y[m])}):e(n)&&n.call(f,null)}return f},import_asset:function(e){for(var t,r,i,a,l,c,u,p,h,f,d,m,_,v=this,b=[e],x=v._assets,j=[];b.length;)if(e=b[0],x[g](e)&&x[e][4]&&!x[e][5]){if(c=x[e],u=c[0],e=c[1],p=c[2],t=c[3],t&&t.length){for(r=!1,i=t.length,a=i-1;a>=0;a--)l=t[a],x[g](l)&&!x[l][5]&&(x[l][4]=!0,r=!0,b.unshift(l));if(r)continue;b.shift()}h="styles"===u,f="scripts"===u,d="templates"===u,m=n(p),h?T?(j.push(_=m?s("importer-inline-style-"+e)||o("style",p[0]):s("importer-style-"+e)||o("style-link",v.path_url(p),!0)),_[y]("id",m?"importer-inline-style-"+e:"importer-style-"+e)):j.push(m?'<style id="importer-inline-style-'+e+'" type="text/css" media="all">'+p[0]+"</style>":'<link id="importer-style-'+e+'" type="text/css" rel="stylesheet" href="'+v.path_url(p)+'" media="all" />'):f?T?(j.push(_=m?s("importer-inline-script-"+e)||o("script","/*<![CDATA[*/ "+p[0]+" /*]]>*/"):s("importer-script-"+e)||o("script-link",v.path_url(p),!0)),_[y]("id",m?"importer-inline-script-"+e:"importer-script-"+e)):j.push(m?'<script id="importer-inline-script-'+e+'" type="text/javascript">/*<![CDATA[*/ '+p[0]+" /*]]>*/</script>":'<script id="importer-script-'+e+'" type="text/javascript" src="'+v.path_url(p)+'"></script>'):d?T?(j.push(_=m?s("importer-inline-tpl-"+e)||o("tpl",p[0]):s("importer-inline-tpl-"+e)||o("tpl",v.getFile(p))),_[y]("id",m?"importer-inline-tpl-"+e:"importer-inline-tpl-"+e)):j.push(m?'<script id="importer-inline-tpl-'+e+'" type="text/x-tpl">'+p[0]+"</script>":'<script id="importer-inline-tpl-'+e+'" type="text/x-tpl">'+v.getFile(p)+"</script>"):j.push(m?p[0]:v.getFile(p)),c[5]=!0}else b.shift();return j},enqueue:function(e,t,n,i){var s=this,a=s._assets;return r(e)||r(t)||(a[g](t)?a[t][4]=!0:r(n)||(s.register("assets",[e,t,n,i]),s._assets[t][4]=!0)),s},assets:function(e){var t,n,r,i,s,a=this,l=a._assets,c=[];arguments.length||(e="scripts"),e=e[_]();for(n in l)l[g](n)&&(r=l[n],e===r[0]&&r[4]&&!r[5]&&c.push(r[1]));if(T){for(i=0,s=c.length;s>i;i++)a.import_asset(c[i]);t=""}else{for(t=[],i=0,s=c.length;s>i;i++)t=t.concat(a.import_asset(c[i]));t=t.join("\n")}return t},getFile:function(t,n,r){var i,s=this;return t=s.path(t),n=n||{},i=n.encoding||"utf8",r=r||n.complete||e(n)&&n,T?M(t,i,function(t){e(r)&&r(t)}):e(r)?M(t,i,r):R(t,i)},importClass:function(t,n,i,s){var a=this,l=arguments.length;return 4>l&&e(i)?(s=i,i=null):3>l&&e(n)&&(s=n,n=null,i=null),a._classes[g](t)||r(n)||a.register("classes",[t,t,a.path(n+".js"),i]),a._classes[g](t)&&!a._classes[t][4]?a.import_class(t,s):e(s)&&s.call(a,a._cache["class-"+t]||null),a},importAll:function(t,n){var r,s,a,l,c=this;return t=i(t),s=t.length,a=new Array(s),r=0,l=function o(i){arguments.length&&(a[r]=i||null,r++),s>r?c.import_class(t[r],o):e(n)&&setTimeout(function(){n.apply(c,a)},10)},l(),c}},d.BASE=x?__dirname:j?this.location.href.split("/").slice(0,-1).join("/"):(l("script",-1).src||"./").split("/").slice(0,-1).join("/"),d});