/**
*
*   ModelView.js
*   @version: 0.26.2
*   @dependencies: jQuery
*
*   A micro-MV* (MVVM) jQuery-based framework for complex (UI) screens
*   https://github.com/foo123/modelview.js
*
**/!function(e,t,n,i){"use strict";function r(e,t,n,i,r){var a;return e?{file:__filename,path:__dirname}:t?{file:a=self.location.href,path:a.split("/").slice(0,-1).join("/")}:n&&r&&r.uri?{file:a=r.uri,path:a.split("/").slice(0,-1).join("/")}:i&&(a=document.getElementsByTagName("script"))&&a.length?{file:a=a[a.length-1].src,path:a.split("/").slice(0,-1).join("/")}:{path:null,file:null}}function a(e,t,n,i,r,o){a.head=a.head||document.getElementsByTagName("head")[0],a.link=a.link||document.createElement("a");for(var l=0,u=n.length,s=/^\./,c=0,f=function(e,n){var i=a.head,r=a.link,o=0,l=document.createElement("script");l.type="text/javascript",l.language="javascript",l.onload=l.onreadystatechange=function(){o||l.readyState&&"loaded"!=l.readyState&&"complete"!=l.readyState||(o=1,l.onload=l.onreadystatechange=null,n(),i.removeChild(l),l=null)},s.test(e)&&(r.href=t+e,e=r.protocol+"//"+r.host+r.pathname+r.search+r.hash),l.src=e,i.appendChild(l)},d=(function(){n[l]in e?(r[l]=e[n[l]],++l>=u?o():n[l]in e?d():f(i[l],d)):++c<30?setTimeout(d,30):(c=0,l++,d())});u>l&&n[l]in e;)r[l]=e[n[l++]];u>l?f(i[l],d):o()}n=n||[[],[]],t=t&&t.length?t:0;var o,l,u,s,c="undefined"!=typeof global&&"[object global]"==={}.toString.call(global),f=!c&&"undefined"!=typeof navigator,d=!c&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,h="function"==typeof define&&define.amd,p=c&&"object"==typeof module&&module.exports,m=[].concat(n[0]),v=[].concat(n[1]),g=m.length,$=new Array(g),b=r(c,d,h,f),y=/\.js$/i;if(p){for(module.$deps=module.$deps||{},u=0;g>u;u++)$[u]=module.$deps[m[u]]||require(v[u]);s=i.apply(e,[{NODE:module}].concat($))||1,t&&(module.exports=module.$deps[t]=s)}else if(h&&"function"==typeof require&&"function"==typeof require.specified&&t&&require.specified(t)){if(!require.defined(t)){for(l={},u=0;g>u;u++)require.specified(m[u])||(l[m[u]]=v[u].replace(y,""));require.config({paths:l}),o=function(t,n,r){for(u=0;g>u;u++)$[u]=arguments[u+3];return i.apply(e,[{AMD:r}].concat($))},m=["require","exports","module"].concat(m),t?define(t,m,o):define(m,o)}}else if(d){if(!(t in self)){for(u=0;g>u;u++)m[u]in self||importScripts(v[u]),$[u]=self[m[u]];s=i.apply(e,[{}].concat($))||1,t&&(self[t]=s)&&h&&define(t,["require"],function(){return s})}}else t in e||(g>0?a(e,b.path+"/",m,v,$,function(){s=i.apply(e,[{}].concat($))||1,t&&(e[t]=s)}):(s=i.call(e,{})||1)&&t&&(e[t]=s),t&&h&&define(t,["require"],function(){return s}))}(this,"ModelView",[["jQuery"],["./jquery.js"]],function(e,t){return!function(e,t,n){"use strict";var i=function(e,t){return e.bind(t)},r="prototype",a=Array,o=a[r],l=RegExp,u=Number,s=Object,c=s[r],f=s.create,d=s.keys,h=Function,p=h[r],m=String,v=m[r],g=p.call,$=(i(g,c.hasOwnProperty),i(g,c.toString)),b=i(g,o.slice),y=function(e,t){return e instanceof t},k=1/0,w=(Math.random,parseFloat),E=isNaN,_=isFinite,R=JSON.parse,x=JSON.stringify,S=t.Event,A=t.extend;v.trim||(v.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),v.startsWith||(v.startsWith=function(e,t){return t=t||0,e===this.substr(t,e.length+t)}),v.tR=v.trim,v.sW=v.startsWith;var D="*",C="modelview",N=2,T=3,j=4,O=8,M=9,V=16,I=32,P=64,z=128,B=256,F=512,L=1024,W=V|I,H=V|O,q=function(e){var t,i;return null===e?B:!0===e||!1===e?j:(t=typeof e,i=$(e),n===e||"undefined"===t?F:e instanceof u||"number"===t?E(e)?T:N:e instanceof m||"string"===t?1===e.length?M:O:e instanceof a||"[object Array]"===i?V:e instanceof l||"[object RegExp]"===i?z:e instanceof h||"function"===t&&"[object Function]"===i?P:"[object Object]"===i?I:L)},U=function(e,t){return!!(t&q(e))},J=function(e){return!E(w(e))&&_(e)},Q=function(e){return J(e)&&(e=+e,0===e%1&&e>=0)?!0:!1},X=function(){var e,t,n,i,r,a,o,l=b(arguments);for(t=l.shift()||{},e=l.length,a=0;e>a;a++)if(n=l[a],I===q(n))for(r in n)i=n[r],o=q(i),t[r]=N&o?0+i:H&o?i.slice(0):i;return t},Z=function(e,t){return new h(e,t)},G=function(e,t){return n!==e.attr(t)},Y=function(e,t){if(!e)return null;var n,i,r=[],a=e.length;for(n=0;a>n;n++)i=e[n],i&&(i[t]&&r.push(i[t].next),i[D]&&r.push(i[D].next));return r.length?r:null},K=function(e,t){if(!e)return null;var n,i,r=e.length;if(t){for(n=0;r>n;n++)if(i=e[n]){if(i[t]&&i[t].value)return i[t].value;if(i[D]&&i[D].value)return i[D].value}}else for(n=0;r>n;n++)if(i=e[n],i&&i.value)return i.value;return null},et=function(e,t,n,i){for(var r,a=n;t.length;)r=t.shift(),r in a||(a[r]={value:null,next:{}}),a=a[r],t.length?a=a.next:i?(D in a.next||(a.next[D]={value:null,next:{}}),a.next[D].value=e):a.value=e;return n},tt=function(e,t,n,i){for(var r,a,o=t,l=n?[n]:null;e.length;){if(r=e.shift(),a=q(o),!e.length)return l&&K(l,r)?!0:a&W&&r in o?!0:I===a&&"length"==r?!0:!1;if(a&W&&r in o){if(o=o[r],o instanceof i)return[i,o,e];l&&(l=Y(l,r))}else if(!l||!(l=Y(l,r)))return!1}return!1},nt=function(e,t,n,i){for(var r,a,o=t,l=n?[n]:null;e.length;){if(r=e.shift(),a=q(o),!e.length)return l&&(l=K(l,r))?[!1,l]:a&W&&r in o?[!0,o[r]]:I===a&&"length"==r?[!0,d(o).length]:!1;if(a&W&&r in o){if(o=o[r],o instanceof i)return[i,o,e];l&&(l=Y(l,r))}else if(!l||!(l=Y(l,r)))return!1}return!1},it=function(e,t,n,i,r,a,o){var l,u,s=t,c=null,f=null,d=null;for(o=!1!==o,o&&(c=[n],f=[i],d=[r]);e.length;)if(l=e.shift(),u=q(s),e.length){if(!(u&W&&l in s))return[!1,s,l,e,null,null,null];if(s=s[l],s instanceof a)return[a,s,e,0,null,null,null];o&&(c=Y(c,l),f=Y(f,l),d=Y(d,l))}else if(u&W)return s[l]instanceof a?[a,s[l],e,0,null,null,null]:l in s?[!0,s,l,e,c,f,d]:[!1,s,l,e,c,f,d];return[!1,s,l,e,null,null,null]},rt=function(){return(new Date).getTime()},at=0,ot=function(e){return[e||"UUID",++at,rt()].join("_")},lt=function(e,t){var n=[e||"",C];return t&&(n=n.concat(t)),n.join(".")},ut={$PB:null,namespace:null,initPubSub:function(){var e=this;return e.$PB=t({}),e},disposePubSub:function(){var e=this;return e.$PB.off(lt("")),e.$PB=null,e},trigger:function(e,t,n){var i=this;return i.namespace&&(n=n?[i.namespace].concat(n):[i.namespace]),i.$PB.trigger(lt(e,n),t),i},on:function(e,t,n){var i=this;return U(t,P)&&(i.namespace&&(n=n?[i.namespace].concat(n):[i.namespace]),i.$PB.on(lt(e,n),t)),i},onTo:function(e,t,n,r){var a=this;return U(n,P)&&(n=i(n,a)),e.on(t,n,r),a},off:function(e,t,n){var i=this;return i.namespace&&(n=n?[i.namespace].concat(n):[i.namespace]),U(t,P)?i.$PB.off(lt(e,n),t):i.$PB.off(lt(e,n)),i},offFrom:function(e,t,n,r){var a=this;return U(n,P)&&(n=i(n,a)),e.off(t,n,r),a}};ut.publish=ut.trigger;var st=function(e,t){var n=this,i=arguments.length;n.$store={},n.$size=k,n.$interval=k,i>0&&e>0&&(n.$size=e),i>1&&t>0&&(n.$interval=t)};st[r]={constructor:st,$store:null,$size:null,$interval:null,dispose:function(){var e=this;return e.$store=null,e.$size=null,e.$interval=null,e},reset:function(){return this.$store={},this},size:function(e){return arguments.length?(e>0&&(this.$size=e),this):this.$size},interval:function(e){return arguments.length?(e>0&&(this.$interval=e),this):this.$interval},has:function(e){var t=this,n=e?t.$store[e]:null;return!!(n&&rt()-n.time<=t.$interval)},get:function(e){if(e){var t=this,i=t.$store[e];if(i)return rt()-i.time>t.$interval?(delete t.$store[e],n):i.data}return n},set:function(e,t){var n,i,r,a=this;if(e){for(n=a.$store,i=a.$size,r=d(n);r.length>=i;)delete n[r.shift()];n[e]={data:t,time:rt()}}return a},del:function(e){return e&&this.$store[e]&&delete this.$store[e],this},toString:function(){return"[ModelView.Cache]"}};var ct=function(e){return e.replace(/\[([^\]]*)\]/g,".$1").replace(/^\.+/,"").replace(/\.+$/,"")},ft=function(e){return"["+e.split(".").join("][")+"]"},dt=function(e){var t=new l("^"+e+"([\\.|\\[])");return function(e,n){var i=e.replace(t,"$1");return n?ct(i):i}},ht=function(e){return y(this,ht)?void(this.f=e||null):new ht(e)},pt=function(e){return y(this,pt)?void(this.f=e||null):new pt(e)},mt=function(e,t){var n,r;for(n in t)r=t[n],y(r,pt)?(t[n]=i(r.f,e),t[n].fEach=!0):t[n]=i(r,e);return t},vt=function(e){return e.BEFORE=function(t){return vt(function(n,i){var r=this;return t.call(r,e.call(r,n,i),i)})},e.AFTER=function(t){return vt(function(n,i){var r=this;return e.call(r,t.call(r,n,i),i)})},e},gt=function(e){return e.NOT=function(){return gt(function(t,n){return!e.call(this,t,n)})},e.AND=function(t){return gt(function(n,i){var r=this;return e.call(r,n,i)&&t.call(r,n,i)})},e.OR=function(t){return gt(function(n,i){var r=this;return e.call(r,n,i)||t.call(r,n,i)})},e.XOR=function(t){return gt(function(n,i){var r=this,a=e.call(r,n,i),o=t.call(r,n,i);return a&&!o||o&&!a})},e},$t={TypeCaster:vt,Cast:{EACH:pt,FIELDS:function(e){var t=!0;return e=A({},e||{}),vt(function(n){var i,r,a,o,l;t&&(mt(this,e),t=!1);for(i in e)if(r=e[i],a=n[i],r.fEach&&U(a,V)){for(o=a.length,l=0;o>l;l++)a[l]=r(a[l]);n[i]=a}else n[i]=r(a);return n})},DEFAULT:function(e){return vt(function(t){var n=q(t);return(F&n||O&n&&!t.tR().length)&&(t=e),t})},BOOL:vt(function(e){return!!e}),INT:vt(function(e){return parseInt(e,10)}),FLOAT:vt(function(e){return parseFloat(e,10)}),MIN:function(e){return vt(function(t){return e>t?e:t})},MAX:function(e){return vt(function(t){return t>e?e:t})},CLAMP:function(e,t){if(e>t){var n=t;t=e,e=n}return vt(function(n){return e>n?e:n>t?t:n})},TRIM:vt(function(e){return m(e).tR()}),LCASE:vt(function(e){return m(e).toLowerCase()}),UCASE:vt(function(e){return m(e).toUpperCase()}),STR:vt(function(e){return""+e})},add:function(e,t){return U(e,O)&&U(t,P)&&($t.Cast[e]=vt(t)),$t},del:function(e){return U(e,O)&&$t.Cast[e]&&delete $t.Cast[e],$t},toString:function(){return"[ModelView.Type]"}},bt={Validator:gt,Validate:{EACH:pt,FIELDS:function(e){var t=!0;return e=A({},e||{}),gt(function(n){var i,r,a,o,l;t&&(mt(this,e),t=!1);for(i in e)if(r=e[i],a=n[i],r.fEach&&U(a,V)){for(o=a.length,l=0;o>l;l++)if(!r(a[l]))return!1}else if(!r(a))return!1;return!0})},NUMERIC:gt(function(e){return J(e)}),NOT_EMPTY:gt(function(e){return!!(e&&0<m(e).tR().length)}),MAXLEN:function(e){return gt(Z("v","return v.length <= "+e+";"))},MINLEN:function(e){return gt(Z("v","return v.length >= "+e+";"))},MATCH:function(e){return gt(function(t){return e.test(t)})},NOT_MATCH:function(e){return gt(function(t){return!e.test(t)})},EQUAL:function(e,t){return gt(y(e,ht)?Z("v","return this.$data."+e.f+" "+(!1!==t?"===":"==")+" v;"):!1!==t?function(t){return e===t}:function(t){return e==t})},NOT_EQUAL:function(e,t){return gt(y(e,ht)?Z("v","return this.$data."+e.f+" "+(!1!==t?"!==":"!=")+" v;"):!1!==t?function(t){return e!==t}:function(t){return e!=t})},GREATER_THAN:function(e,t){return y(e,ht)?e="this.$data."+e.f:U(e,O)&&(e='"'+e+'"'),gt(Z("v","return "+e+" "+(!1!==t?"<":"<=")+" v;"))},LESS_THAN:function(e,t){return y(e,ht)?e="this.$data."+e.f:U(e,O)&&(e='"'+e+'"'),gt(Z("v","return "+e+" "+(!1!==t?">":">=")+" v;"))},BETWEEN:function(e,t,n){U(e,V)&&(n=t,t=e[1],e=e[0]);var i,r=y(e,ht),a=y(t,ht);return!r&&!a&&e>t&&(i=t,t=e,e=i),e=r?"this.$data."+e.f:U(e,O)?'"'+e+'"':e,t=a?"this.$data."+t.f:U(t,O)?'"'+t+'"':t,gt(!1!==n?Z("v","return ( "+e+" < v ) && ( "+t+" > v );"):Z("v","return ( "+e+" <= v ) && ( "+t+" >= v );"))},NOT_BETWEEN:function(e,t,n){U(e,V)&&(n=t,t=e[1],e=e[0]);var i,r=y(e,ht),a=y(t,ht);return!r&&!a&&e>t&&(i=t,t=e,e=i),e=r?"this.$data."+e.f:U(e,O)?'"'+e+'"':e,t=a?"this.$data."+t.f:U(t,O)?'"'+t+'"':t,gt(!1!==n?Z("v","return ( "+e+" > v ) || ( "+t+" < v );"):Z("v","return ( "+e+" >= v ) || ( "+t+" <= v );"))},IN:function(){var e=b(arguments);return U(e[0],V)&&(e=e[0]),gt(function(t){return-1<e.indexOf(t)})},NOT_IN:function(){var e=b(arguments);return U(e[0],V)&&(e=e[0]),gt(function(t){return 0>e.indexOf(t)})}},add:function(e,t){return U(e,O)&&U(t,P)&&(bt.Validate[e]=gt(t)),bt},del:function(e){return U(e,O)&&bt.Validate[e]&&delete bt.Validate[e],bt},toString:function(){return"[ModelView.Validation]"}},yt=function(e,t,n,r){var a,o,l=!1;if(o=q(n),P&o)l=y(n,pt),n=l?i(n.f,e):i(n,e),et(n,-1<t.indexOf(".")?t.split("."):[t],r,l);else if(W&o)for(a in n)yt(e,t+"."+a,n[a],r)},kt=function(e,t,n,r){var a,o;if(o=q(n),P&o)et(i(n,e),-1<t.indexOf(".")?t.split("."):[t],r);else if(W&o)for(a in n)kt(e,t+"."+a,n[a],r)},wt=function(e,t,n){for(var i,r;t instanceof e;)t=t.data();if(r=n||q(t),t=I&r?A({},t):V&r?t.slice(0):t,W&r)for(i in t)t[i]instanceof e?t[i]=wt(e,A({},t[i].data())):W&(r=q(t[i]))&&(t[i]=wt(e,t[i],r));return t},Et=function(e,t,n,i,r,a){var o=this;return o instanceof Et?(o.namespace=o.id=e||ot("Model"),o.key=dt(o.id),o.$view=null,o.atomic=!1,o.$atom=null,o.$types={},o.$validators={},o.$getters={},o.$setters={},void o.data(t||{}).types(n).validators(i).getters(r).setters(a).initPubSub()):new Et(e,t,n,i,r,a)};Et[r]=X(f(s[r]),ut,{constructor:Et,id:null,$view:null,$data:null,$types:null,$validators:null,$getters:null,$setters:null,atomic:!1,$atom:null,dispose:function(){var e=this;return e.disposePubSub().$view=null,e.$data=null,e.$types=null,e.$validators=null,e.$getters=null,e.$setters=null,e.atomic=!1,e.$atom=null,e.key=null,e},isValid:function(){return!0},view:function(e){var t=this;return arguments.length?(t.$view=e,t):t.$view},data:function(e){var t=this;return arguments.length?(t.$data=e,t):t.$data},types:function(e){var t,n=this;if(U(e,I))for(t in e)yt(n,t,e[t],n.$types);return n},validators:function(e){var t,n=this;if(U(e,I))for(t in e)yt(n,t,e[t],n.$validators);return n},getters:function(e){var t,n=this;if(U(e,I))for(t in e)kt(n,t,e[t],n.$getters);return n},setters:function(e){var t,n=this;if(U(e,I))for(t in e)kt(n,t,e[t],n.$setters);return n},serialize:function(){return wt(Et,this.$data)},toJSON:function(e){var t,n,i,r=this;n=arguments.length?r.get(e):r.data();try{t=x(wt(Et,n))}catch(i){throw i}return t},fromJSON:function(e,t){var n,i,r=this;if(e){try{n=R(e)}catch(i){throw i}t?r.set(t,n):r.data(n)}return r},count:function(e,t){if(!arguments.length)return 0;var n=e?this.get(e):t,i=q(n);return I===i?d(n).length:V===i?n.length:F!==i?1:0},has:function(e,t){var n,i=this;return 0>e.indexOf(".")&&(e in i.$data||!t&&(n=i.$getters[e])&&n.value)?!0:(n=tt(e.split("."),i.$data,t?null:i.$getters,Et))?!0===n?!0:n[1].has(n[2].join(".")):!1},get:function(e,t){var i,r=this;return 0>e.indexOf(".")?!t&&(i=r.$getters[e])&&i.value?i.value(e):r.$data[e]:(i=nt(e.split("."),r.$data,t?null:r.$getters,Et))?Et===i[0]?i[1].get(i[2].join("."),t):!1===i[0]?i[1](e):i[1]:n},set:function(e,t,n,i){var r,a,o,l,u,s,c,f,d,h,p=this,m=!1;if(p.atomic&&e.sW(p.$atom))return p;if(a=p.$data,c=p.$types,f=p.$validators,d=p.$setters,0>e.indexOf("."))o=e,s=(r=d[o])?r.value:null,l=(r=c[o]||c[D])?r.value:null,u=(r=f[o]||f[D])?r.value:null,m=!0;else if(r=it(e.split("."),a,c,f,d,Et)){if(a=r[1],o=r[2],l=K(r[4],o),u=K(r[5],o),s=K(r[6],o),Et===r[0])return o.length?(o=o.join("."),h=a.get(o),h!==t?a.set(o,t,n,i):n=!1):(h=a.data(),h!==t?a.data(t):n=!1),n&&p.publish("change",{model:p,key:e,value:t,valuePrev:h,$callData:i}),p;if(!s&&!1===r[0]&&r[3].length)return p;m=!0}if(m){if(l&&(t=l(t,e)),u&&!u(t,e))return n&&(i&&(i.error=!0),p.publish("error",{model:p,key:e,value:a[o],$callData:i})),p;if(s)return s(e,t)&&(n&&p.publish("change",{model:p,key:e,value:t,$callData:i}),p.$atom&&e===p.$atom&&(p.atomic=!0)),p;h=a[o],h!==t&&(a[o]=t,n&&p.publish("change",{model:p,key:e,value:t,valuePrev:h,$callData:i}),p.$atom&&e===p.$atom&&(p.atomic=!0))}return p},append:function(e,t,i,r){var a,o,l,u,s,c,f=this,d=!1;if(f.atomic&&e.sW(f.$atom))return f;if(o=f.$data,types=f.$types,validators=f.$validators,setters=f.$setters,0>e.indexOf("."))l=e,c=(a=setters[l])&&a.next[D]?a.next[D].value:null,u=(a=types[l]||types[D])&&a.next[D]?a.next[D].value:null,s=(a=validators[l]||validators[D])&&a.next[D]?a.next[D].value:null,d=!0;else if(a=it(e.split("."),o,types,validators,setters,Et)){if(o=a[1],l=a[2],u=K(Y(a[4],l),D),s=K(Y(a[5],l),D),c=K(Y(a[6],l),D),Et===a[0])return l.length?(l=l.join("."),o.append(l,t,i,r)):o.data(t),i&&f.publish("change",{model:f,key:e,value:t,$callData:r}),f;if(!c&&!1===a[0]&&a[3].length)return f;d=!0}if(d){if(u&&(t=u(t,e)),s&&!s(t,e))return i&&(r&&(r.error=!0),f.publish("error",{model:f,key:e,value:n,$callData:r})),f;if(c)return c(e,t)&&(i&&f.publish("change",{model:f,key:e,value:t,$callData:r}),f.$atom&&e===f.$atom&&(f.atomic=!0)),f;V===q(o[l])?o[l].push(t):o[l]=t,i&&f.publish("change",{model:f,key:e,value:t,$callData:r}),f.$atom&&e===f.$atom&&(f.atomic=!0)}return f},del:function(e,t,n){var i,r,a,o,l=this,u=!1;if(l.atomic&&e.sW(l.$atom))return l;if(r=l.$data,0>e.indexOf("."))a=e,u=!0;else if(i=it(e.split("."),r,null,null,null,Et,!1)){if(r=i[1],a=i[2],Et===i[0]&&a.length)return a=a.join("."),o=r.get(a),r.del(a,t,n),t&&l.publish("remove",{model:l,key:e,value:o,$callData:n}),l.$atom&&e===l.$atom&&(l.atomic=!0),l;if(i[3].length)return l;u=!0}return u&&(o=r[a],delete r[a],t&&l.publish("remove",{model:l,key:e,value:o,$callData:n}),l.$atom&&e===l.$atom&&(l.atomic=!0)),l},rem:function(e,t,i){var r,a,o,l,u,s=this,c=!1;if(s.atomic&&e.sW(s.$atom))return s;if(a=s.$data,0>e.indexOf("."))o=e,c=!0;else if(r=it(e.split("."),a,null,null,null,Et,!1)){if(a=r[1],o=r[2],Et===r[0]&&o.length)return o=o.join("."),l=a.get(o),a.rem(o,t,i),t&&s.publish("remove",{model:s,key:e,value:l,$callData:i}),s.$atom&&e===s.$atom&&(s.atomic=!0),s;if(r[3].length)return s;c=!0}return c&&(l=a[o],a[o]=n,u=q(a),V==u&&Q(o)?a.splice(+o,1):I==u&&delete a[o],t&&s.publish("remove",{model:s,key:e,value:l,$callData:i}),s.$atom&&e===s.$atom&&(s.atomic=!0)),s},notify:function(e,t,n){return e&&this.publish(t||"change",{model:this,key:e,$callData:n}),this},atom:function(e){var t=this;return n!==e&&(!1===e?(t.atomic=!1,t.$atom=null):(t.atomic=!1,t.$atom=e)),t},toString:function(){return"[ModelView.Model id: "+this.id+"]"}});var _t=function(e,t,n){return[e?"["+e+"]":null,t?n?'input[name="'+t+'"],textarea[name="'+t+'"],select[name="'+t+'"]':'input[name^="'+t+'"],textarea[name^="'+t+'"],select[name^="'+t+'"]':null]},Rt=function(e,t){return t&&t[e]?(U(t[e],O)&&(t[e]={action:t[e]}),t[e]):void 0},xt=function(e,n,i,r){var a=e.$model,o="sync"==i.type,l=o?"change":i.type;n.each(function(){var n,o,u,s,c=t(this);n=Rt(l,e.attr(c,"bind")),n&&n.action&&(o="do_"+n.action,U(e[o],P)&&(u=c.attr("name"),s=n.key||u&&a.key(u,1),r&&(!s||!s.sW(r.key)||a.atomic&&s.sW(a.$atom))||e[o](i,c,n)))})},St=function(e,n,i){{var r=e.$model,a={},o="sync"==i.type;o?"change":i.type}n.each(function(){var n,o=t(this),l=o.attr("name"),u=l?r.key(l,1):0;if(u){if(a[u])n=a[u][0];else{if(!r.has(u))return;a[u]=[n=r.get(u)]}e.do_bind(i,o,{name:l,key:u,value:n})}})},At=function(e,t,n,i,r){var a=this;return a instanceof At?(a.namespace=a.id=e||ot("View"),a.$atts=n||{bind:"data-bind"},i=i||At._CACHE_SIZE,r=r||At._REFRESH_INTERVAL,a.$memoize=new st(i,r),a.$selectors=new st(i,r),a.$bind=a.attribute("bind"),void a.model(t||new Et).initPubSub()):new At(e,t,n,i,r)};At._CACHE_SIZE=600,At._REFRESH_INTERVAL=k,At[r]=X(f(s[r]),ut,{constructor:At,id:null,$dom:null,$bind:null,$model:null,$bindbubble:!1,$autobind:!1,$template:null,$atts:null,$memoize:null,$selectors:null,dispose:function(){var e=this;return e.unbind().disposePubSub(),e.$model&&e.$model.dispose(),e.$model=null,e.$dom=null,e.$bind=null,e.$template=null,e.$atts=null,e.$memoize.dispose(),e.$memoize=null,e.$selectors.dispose(),e.$selectors=null,e},model:function(e){var t=this;return arguments.length?(t.$model&&t.$model.dispose(),t.$model=e.view(t),t):t.$model},attribute:function(e,t){var i=this;return arguments.length>1?(i.$atts[e]=t,i):e?i.$atts[e]||n:n},template:function(e){var t=this;return arguments.length?(U(e,P)&&(t.$template=e),t):t.$template},event:function(e,t){var i=this,r=e?"on_"+e.split(":").join("_"):null;return r&&n!==t?(i[r]=U(t,P)?t:null,i):r?i[r]:n},action:function(e,t){var n=this,i=e&&"do_"+e;return arguments.length>1?(n[i]=U(t,P)?t:null,n):i&&n[i]},bindbubble:function(e){var t=this;return arguments.length?(t.$bindbubble=!!e,t):t.$bindbubble},autobind:function(e){var t=this;return arguments.length?(t.$autobind=!!e,t):t.$autobind},get:function(e,n,i){var r,a=this,o=a.$selectors;return n=n?t(n):a.$dom,i?n.find(e):(r=o.get(e),r||o.set(e,r=n.find(e)),r)},attr:function(e,t){var i,r,a=this,o=a.$atts[t],l=a.$memoize;return o&&G(e,o)?(o=e.attr(o),i=l.get(o),n===i&&(i=R(o),i.set&&(i.click=i.set,i.click.action="set",i.set=n,delete i.set),i.show&&(i.change={action:"show",key:i.show},i.show=n,delete i.show),i.hide&&(i.change={action:"hide",key:i.hide},i.hide=n,delete i.hide),i.html?(i.change={action:"html",key:i.html},i.html=n,delete i.html,i.text=n,delete i.text):i.text&&(i.change={action:"html",key:i.text,text:1},i.text=n,delete i.text),i.css&&(i.change={action:"css",css:i.css},i.css=n,delete i.css),i.value&&(i.change&&"prop"==i.change.action?i.change.prop.value=i.value:i.change={action:"prop",prop:{value:i.value}},i.value=n,delete i.value),i.checked&&(i.change&&"prop"==i.change.action?i.change.prop.checked=i.checked:i.change={action:"prop",prop:{checked:i.checked}},i.checked=n,delete i.checked),i.disabled&&(i.change&&"prop"==i.change.action?i.change.prop.disabled=i.disabled:i.change={action:"prop",prop:{disabled:i.disabled}},i.disabled=n,delete i.disabled),i.options&&(i.change&&"prop"==i.change.action?i.change.prop.options=i.options:i.change={action:"prop",prop:{options:i.options}},i.options=n,delete i.options),i["class"]&&(i.change&&"prop"==i.change.action?i.change.prop["class"]=i["class"]:i.change={action:"prop",prop:{"class":i["class"]}},i["class"]=n,delete i["class"]),(r=i.change)&&(!r.domRef&&i.domRef&&(r.domRef=i.domRef),!r.key&&i.key&&(r.key=i.key)),l.set(o,i)),i):n},getDomRef:function(e,n){return n&&"$this::"==n.slice(0,7)?t(n.slice(7),e):t(n)},bind:function(e,n){var i,r,a,o=this,l=o.$model,u=_t(o.$bind,l.id+"["),s=u[0],c=u[1],f=/^on_model_/;e=e||["change","click"],o.$dom=t(n||window.document),o.on_view_change&&e.length&&(a=function(e){return lt(e,o.namespace)},o.$dom.on(e.map(a).join(" "),[c,s].join(","),function(e){var n=this,i=t(n),r=!1,a=!1,l=o.$bindbubble?o.attr(i,"bind"):null;return(e.target===n||l&&l.bubble)&&(a=o.$bindbubble?!!l:i.is(s),r=o.$autobind&&"change"==e.type&&i.is(c),(a||r)&&o.on_view_change(e,{$el:i,isBind:a,isAutoBind:r})),!0}));for(i in o)U(o[i],P)&&f.test(i)&&(r=i.replace(f,""),r.length&&o.onTo(l,r,o[i],o.namespace));return o},unbind:function(e,n){var i,r,a=this,o=a.$model,l=_t(a.$bind,o.id+"[");return e=e||null,r=n?t(n):a.$dom,a.on_view_change&&(i=function(e){return lt(e,a.namespace)},r.off(e&&e.length?e.map(i).join(" "):lt("",a.namespace),[l[1],l[0]].join(","))),a.offFrom(o,"",null,a.namespace),a},rebind:function(e,t){var n=this;return n.$memoize.reset(),n.$selectors.reset(),n.unbind().bind(e,t)},sync:function(e){var n=this,i=_t(n.$bind,n.$model.id+"["),r=S("sync");return e=e?t(e):n.$dom,xt(n,n.get(i[0],e,1),r),n.$autobind&&St(n,n.get(i[1],e,1),r),n},reset:function(){var e=this;return e.$memoize.reset(),e.$selectors.reset(),e},on_view_change:function(e,n){var i,r,a,o,l,u=this,s=u.$model,c=n.$el,f={};n.isAutoBind&&c.attr("name")&&(r=s.key(i=c.attr("name"),1),r&&s.has(r)&&(o=c.is(":checkbox"),o?(l=u.get('input[type="checkbox"][name="'+i+'"]'),l.length>1?(a=[],l.each(function(){var e=t(this);a.push(e.is(":checked")?e.val():"")})):a=l.is(":checked")?l.val():""):a=c.val(),f.$trigger=c,s.set(r,a,1,f))),!f.error&&n.isBind&&xt(u,c,e),u.publish("change",n)},on_model_change:function(e,t){var n,i,r=this,a=r.$model,o=_t(r.$bind,a.id+ft(t.key)),l=r.$autobind;n=r.get(o[0]),l&&(i=r.get(o[1])),t.$callData&&t.$callData.$trigger&&(n=n.not(t.$callData.$trigger),l&&(i=i.not(t.$callData.$trigger)),t.$callData=null),xt(r,n,e,t),l&&i.length&&St(r,i,e,t)},on_model_error:function(e,t){var n=this,i=n.$model,r=_t(n.$bind,i.id+ft(t.key));xt(n,n.get(r[0]),e,t),n.$autobind&&St(n,n.get(r[1]),e,t)},do_nop:null,do_prop:function(e,t,n){if(U(n.prop,I)){var i,r,a,o,l,u=this,s=u.$model,c=n.prop;if(n.domRef&&(t=u.getDomRef(t,n.domRef)),t.length){i={};for(r in c)if(a=c[r],s.has(a))switch(o=s.get(a),l=q(o),r){case"value":t.val(o);break;case"options":if(t.is("select")&&V===l){var f,d,h=o.length,p="",m=t.find("optgroup");for(f=t.val(),m.length||(m=t),m.find("option").remove(),d=0;h>d;d++)p+=o[d]&&o[d].label?'<option value="'+o[d].value+'">'+o[d].label+"</option>":'<option value="'+o[d]+'">'+o[d]+"</option>";m.append(p),t.val(f)}break;case"class":if(o&&o.length){var v,g=o.charAt(0);"-"==g?t.removeClass(o.slice(1)):"+"==g?t.addClass(o.slice(1)):(v=t.hasClass(o))?t.removeClass(o):v||t.addClass(o)}break;case"checked":j===l?t.prop(r,o):o==t.val()?t.prop(r,!0):t.prop(r,!1);break;case"disabled":j===l?t.prop(r,o):o==t.val()?t.prop(r,!0):t.prop(r,!1);break;default:i[r]=o}t.attr(i)}}},do_html:function(e,t,n){if(n.key){var i,r=this,a=r.$model,o=n.key;n.domRef&&(t=r.getDomRef(t,n.domRef)),t.length&&o&&a.has(o)&&(i=a.get(o),n.text?t.text(i):t.html(i))}},do_css:function(e,t,n){if(U(n.css,I)){var i,r,a,o,l=this,u=l.$model,s=n.css;if(n.domRef&&(t=l.getDomRef(t,n.domRef)),t.length){o={};for(r in s)i=s[r],a=u.get(i),a&&(o[r]=a);t.css(o)}}},do_set:function(e,t,n){var i,r=this,a=r.$model,o=n.key||a.key(t.attr(name),1);o&&("value"in n?i=n.value:(n.domRef&&(t=r.getDomRef(t,n.domRef)),i=t.is("input,select,textarea")?t.val():t.text()),a.set(o,i,1))},do_tpl:function(e,t,n){var i,r,a,o=this,l=n.key,u=n.tpl;o.$template&&l&&u&&(n.domRef&&(t=o.getDomRef(t,n.domRef)),t.length&&(i=o.$model,l&&i.has(l)&&(r=n.mode||"replace","replace"==r&&t.empty(),a=o.$template(u,i.get(l)),a&&t.append(a))))},do_show:function(e,t,n){var i=this,r=i.$model,a=n.key;n.domRef&&(t=i.getDomRef(t,n.domRef)),t.length&&a&&("value"in n?n.value===r.get(a)?t.show():t.hide():r.get(a)?t.show():t.hide())},do_hide:function(e,t,n){var i=this,r=i.$model,a=n.key;n.domRef&&(t=i.getDomRef(t,n.domRef)),t.length&&a&&("value"in n?n.value===r.get(a)?t.hide():t.show():r.get(a)?t.hide():t.show())},do_bind:function(e,n,i){var r,a,o,l=this,u=(l.$model,i.name),s=i.key;if(s)if(r=i.value,a=q(r),o=n.val(),n.is(":radio"))r==o&&(l.get('input[name="'+u+'"]').not(n).prop("checked",!1),n.prop("checked",!0));else if(n.is(":checkbox")){var c=l.get('input[type="checkbox"][name="'+u+'"]');c.length>1&&V===a?c.each(function(){var e=t(this);t.inArray(e.val(),r)>-1?e.prop("checked",!0):e.prop("checked",!1)}):j===a?n.prop("checked",r):r==o?n.prop("checked",!0):n.prop("checked",!1)}else n.val(r)},toString:function(){return"[ModelView.View id: "+this.id+"]"}}),e.ModelView={VERSION:"0.26.2",UUID:ot,Extend:X,Field:ht,Type:$t,Validation:bt,Cache:st,Model:Et,View:At}}(e,t),!function(e,t){"use strict";var n=Function.prototype.call.bind(Array.prototype.slice),i=t.extend,r=e.View,a=e.Model,o={id:"model",data:{},types:{},validators:{},getters:{},setters:{}},l={viewClass:r,modelClass:a,id:"view",autobind:!1,bindbubble:!1,bindAttribute:"data-bind",cacheSize:r._CACHE_SIZE,refreshInterval:r._REFRESH_INTERVAL,model:null,template:null,events:null,actions:{},handlers:{}};t.ModelView=e,t.fn.modelview=function(e){var r=n(arguments),u=r.length?r.shift():null,s=!0,c=!1,f=[];return this.each(function(){var n,d,h,p=t(this);if(p.data("modelview")){if(s=!1,d=p.data("modelview"),n=d.$model,"view"===u)f.push(d);else if("model"===u){if(r.length)return n.apply(d,r),this;f.push(n)}else if("data"===u){if(r.length)return n.data.apply(d.$model,r),this;f.push(n.data())}else"dispose"===u?(p.data("modelview",null),d.dispose()):"sync"===u?d.sync.apply(d,r):"refresh"===u&&d.refresh.apply(d,r);return this}if(c||(e=i({},l,e),!e.model||e.model instanceof a||(e.model=i({},o,e.model)),c=!0),!e.model)return this;if(n=e.model instanceof a?e.model:new e.modelClass(e.model.id,e.model.data,e.model.types,e.model.validators,e.model.getters,e.model.setters),d=new e.viewClass(e.id,n,{bind:e.bindAttribute||"data-bind"},e.cacheSize,e.refreshInterval),e.template&&d.template(e.template),e.handlers)for(var m in e.handlers)h=e.handlers[m],h&&d.event(m,h);if(e.actions)for(var v in e.actions)h=e.actions[v],h&&d.action(v,h);p.data("modelview",d),d.bindbubble(e.bindbubble).autobind(e.autobind).bind(e.events,p)}),!s&&f.length?1==this.length?f[0]:f:this}}(e.ModelView,t),e.ModelView});