/**
*
*   RegExAnalyzer
*   @version: 0.4
*
*   A simple Regular Expression Analyzer in JavaScript
*   https://github.com/foo123/regex-analyzer
*
**/!function(e,t,r){"use strict";var a,p="object"==typeof module&&module.exports,s="function"==typeof define&&define.amd;p?module.exports=(module.$deps=module.$deps||{})[t]=module.$deps[t]||r.call(e,{NODE:module})||1:s&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["require","exports","module"],function(t,a,p){return r.call(e,{AMD:p})}):t in e||(e[t]=a=r.call(e,{})||1)&&s&&define(t,[],function(){return a})}(this,"RegExAnalyzer",function(e){var t="\\",r=/^\{\s*(\d+)\s*,?\s*(\d+)?\s*\}/,a=/^u([0-9a-fA-F]{4})/,p=/^x([0-9a-fA-F]{2})/,s={".":"MatchAnyChar","|":"MatchEither","?":"MatchZeroOrOne","*":"MatchZeroOrMore","+":"MatchOneOrMore","^":"MatchStart",$:"MatchEnd","{":"StartRepeats","}":"EndRepeats","(":"StartGroup",")":"EndGroup","[":"StartCharGroup","]":"EndCharGroup"},n={"\\":"EscapeChar","/":"/",0:"NULChar",f:"FormFeed",n:"LineFeed",r:"CarriageReturn",t:"HorizontalTab",v:"VerticalTab",b:"MatchWordBoundary",B:"MatchNonWordBoundary",s:"MatchSpaceChar",S:"MatchNonSpaceChar",w:"MatchWordChar",W:"MatchNonWordChar",d:"MatchDigitChar",D:"MatchNonDigitChar"},h=Object,l=Array,g=h.prototype.toString,o=function(e,t){return Math.round((t-e)*Math.random()+e)},i=function(e,t){e&&(e instanceof l||"[object Array]"==g.call(e))&&(t=e[1],e=e[0]);var r,a,p=e.charCodeAt(0),s=t.charCodeAt(0);if(s==p)return[String.fromCharCode(p)];for(a=[],r=p;s>=r;++r)a.push(String.fromCharCode(r));return a},f=" \r\n	".split(""),u="~!@#$%^&*()-+=[]{}\\|;:,./<>?".split(""),c="0123456789".split(""),y=["_"].concat(i("a","z")).concat(i("A","Z")),d=f.concat(u).concat(c).concat(y),C=function(){return u[o(0,u.length-1)]},S=function(e){return!1!==e?f[o(0,f.length-1)]:[C(),x(),M()][o(0,2)]},x=function(e){return!1!==e?c[o(0,c.length-1)]:[C(),S(),M()][o(0,2)]},M=function(e){return!1!==e?y[o(0,y.length-1)]:[C(),S(),x()][o(0,2)]},A=function(e){return!1!==e?["_"].concat(y).concat(c)[o(0,y.length+c.length)]:[C(),S()][o(0,1)]},m=function(e,t){if(!1!==t)return e.length?e[o(0,e.length-1)]:"";var r=d.filter(function(t){return 0>e.indexOf(t)});return r.length?r[o(0,r.length-1)]:""},v=function(e,t){if(t&&(t instanceof l||"[object Array]"==g.call(t)))for(var r=0,a=t.length;a>r;r++)e[t[r]]=1;else for(var r in t)e[r]=1;return e},$=function(e,t){return t?(e.charAt&&(e=e.split("")),e=e.map(function(e){return o(0,1)?e.toLowerCase():e.toUpperCase()}),t||(e=e.join("")),e):o(0,1)?e.toLowerCase():e.toUpperCase()},G=function(e){var t,r,a,p,s,n,h,l,g={},o={};if(h=e.type,"Alternation"==h)for(a=0,p=e.part.length;p>a;a++)s=G(e.part[a]),g=v(g,s.peek),o=v(o,s.negativepeek);else if("Group"==h)s=G(e.part),g=v(g,s.peek),o=v(o,s.negativepeek);else if("Sequence"==h){for(a=0,p=e.part.length,r=e.part[a],n=a>=p||!r||"Quantifier"!=r.type||!r.flags.MatchZeroOrMore&&!r.flags.MatchZeroOrOne&&"0"!=r.flags.MatchMinimum;!n;)s=G(r.part),g=v(g,s.peek),o=v(o,s.negativepeek),a++,r=e.part[a],n=a>=p||!r||"Quantifier"!=r.type||!r.flags.MatchZeroOrMore&&!r.flags.MatchZeroOrOne&&"0"!=r.flags.MatchMinimum;p>a&&(r=e.part[a],"Special"!=r.type||"^"!=r.part&&"$"!=r.part||(r=e.part[a+1]||null),r&&"Quantifier"==r.type&&(r=r.part),r&&(s=G(r),g=v(g,s.peek),o=v(o,s.negativepeek)))}else if("CharGroup"==h)for(t=e.flags.NotMatch?o:g,a=0,p=e.part.length;p>a;a++)r=e.part[a],l=r.type,"Chars"==l?t=v(t,r.part):"CharRange"==l?t=v(t,i(r.part)):"UnicodeChar"==l||"HexChar"==l?t[r.flags.Char]=1:"Special"==l&&("D"==r.part?e.flags.NotMatch?g["\\d"]=1:o["\\d"]=1:"W"==r.part?e.flags.NotMatch?g["\\w"]=1:o["\\W"]=1:"S"==r.part?e.flags.NotMatch?g["\\s"]=1:o["\\s"]=1:t["\\"+r.part]=1);else"String"==h?g[e.part.charAt(0)]=1:"Special"!=h||e.flags.MatchStart||e.flags.MatchEnd?("UnicodeChar"==h||"HexChar"==h)&&(g[e.flags.Char]=1):"D"==e.part?o["\\d"]=1:"W"==e.part?o["\\W"]=1:"S"==e.part?o["\\s"]=1:g["\\"+e.part]=1;return{peek:g,negativepeek:o}},O=function(e,t){var r,a,p,s,n="";if(s=e.type,"Alternation"==s)n+=O(e.part[o(0,e.part.length-1)],t);else if("Group"==s)n+=O(e.part,t);else if("Sequence"==s){var h,l,g;for(p=e.part.length,r=e.part[a],a=0;p>a;a++)if(r=e.part[a])if(h=1,"Quantifier"==r.type)for(r.flags.MatchZeroOrMore?h=o(0,10):r.flags.MatchZeroOrOne?h=o(0,1):r.flags.MatchOneOrMore?h=o(1,11):(l=parseInt(r.flags.MatchMinimum,10),g=parseInt(r.flags.MatchMaximum,10),h=o(l,isNaN(g)?l+10:g));h>0;)h--,n+=O(r.part,t);else n+=O(r,t)}else if("CharGroup"==s){var f,u=[];for(a=0,p=e.part.length;p>a;a++)r=e.part[a],f=r.type,"Chars"==f?u=u.concat(t?$(r.part,!0):r.part):"CharRange"==f?u=u.concat(t?$(i(r.part),!0):i(r.part)):"UnicodeChar"==f||"HexChar"==f?u.push(t?$(r.flags.Char):r.flags.Char):"Special"==f&&u.push("D"==r.part?x(!1):"W"==r.part?A(!1):"S"==r.part?S(!1):"d"==r.part?x():"w"==r.part?A():"s"==r.part?S():"\\"+r.part);n+=m(u,!e.flags.NotMatch)}else"String"==s?n+=t?$(e.part):e.part:"Special"!=s||e.flags.MatchStart||e.flags.MatchEnd?("UnicodeChar"==s||"HexChar"==s)&&(n+=t?$(e.flags.Char):e.flags.Char):n+="D"==e.part?x(!1):"W"==e.part?A(!1):"S"==e.part?S(!1):"d"==e.part?x():"w"==e.part?A():"s"==e.part?S():"\\"+e.part;return n},b=function(e){var h,l,g,o="",i=[],f=[],u={},c=!1,y=e.regex.substr(e.pos,2);for("?:"==y?(u.NotCaptured=1,e.pos+=2):"?="==y?(u.LookAhead=1,e.pos+=2):"?!"==y&&(u.NegativeLookAhead=1,e.pos+=2),u.GroupIndex=++e.groupIndex;e.pos<e.regex.length;)if(h=e.regex.charAt(e.pos++),c=t==h?!0:!1,c&&(h=e.regex.charAt(e.pos++)),c)"u"==h?(o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),g=a.exec(e.regex.substr(e.pos-1)),e.pos+=g[0].length-1,f.push({part:g[0],flags:{Char:String.fromCharCode(parseInt(g[1],16)),Code:g[1]},type:"UnicodeChar"})):"x"==h?(o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),g=p.exec(e.regex.substr(e.pos-1)),e.pos+=g[0].length-1,f.push({part:g[0],flags:{Char:String.fromCharCode(parseInt(g[1],16)),Code:g[1]},type:"HexChar"})):n[h]&&"/"!=h?(o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),l={},l[n[h]]=1,f.push({part:h,flags:l,type:"Special"})):o+=h;else{if(")"==h)return o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),i.length?(i.push({part:f,flags:{},type:"Sequence"}),f=[],l={},l[s["|"]]=1,{part:{part:i,flags:l,type:"Alternation"},flags:u,type:"Group"}):{part:{part:f,flags:{},type:"Sequence"},flags:u,type:"Group"};if("|"==h)o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),i.push({part:f,flags:{},type:"Sequence"}),f=[];else if("["==h)o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),f.push(R(e));else if("("==h)o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),f.push(b(e));else if("{"==h){o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),g=r.exec(e.regex.substr(e.pos-1)),e.pos+=g[0].length-1,l={part:g[0],MatchMinimum:g[1],MatchMaximum:g[2]||"unlimited"},l[s[h]]=1,"?"==e.regex.charAt(e.pos)?(l.isGreedy=0,e.pos++):l.isGreedy=1;var d=f.pop();"String"==d.type&&d.part.length>1&&(f.push({part:d.part.slice(0,-1),flags:{},type:"String"}),d.part=d.part.slice(-1)),f.push({part:d,flags:l,type:"Quantifier"})}else if("*"==h||"+"==h||"?"==h){o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),l={},l[s[h]]=1,"?"==e.regex.charAt(e.pos)?(l.isGreedy=0,e.pos++):l.isGreedy=1;var d=f.pop();"String"==d.type&&d.part.length>1&&(f.push({part:d.part.slice(0,-1),flags:{},type:"String"}),d.part=d.part.slice(-1)),f.push({part:d,flags:l,type:"Quantifier"})}else s[h]?(o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),l={},l[s[h]]=1,f.push({part:h,flags:l,type:"Special"})):o+=h}return o.length&&(f.push({part:o,flags:{},type:"String"}),o=""),i.length?(i.push({part:f,flags:{},type:"Sequence"}),f=[],l={},l[s["|"]]=1,{part:{part:i,flags:l,type:"Alternation"},flags:u,type:"Group"}):{part:{part:f,flags:{},type:"Sequence"},flags:u,type:"Group"}},R=function(e){var r,s,h,l,g,o,i=[],f=[],u={},c=!1,y=!1;for("^"==e.regex.charAt(e.pos)&&(u.NotMatch=1,e.pos++);e.pos<e.regex.length;)if(o=!1,h=s,s=e.regex.charAt(e.pos++),y=t==s?!0:!1,y&&(s=e.regex.charAt(e.pos++)),y&&("u"==s?(g=a.exec(e.regex.substr(e.pos-1)),e.pos+=g[0].length-1,s=String.fromCharCode(parseInt(g[1],16)),o=!0):"x"==s&&(g=p.exec(e.regex.substr(e.pos-1)),e.pos+=g[0].length-1,s=String.fromCharCode(parseInt(g[1],16)),o=!0)),c)f.length&&(i.push({part:f,flags:{},type:"Chars"}),f=[]),l[1]=s,c=!1,i.push({part:l,flags:{},type:"CharRange"});else if(y)!o&&n[s]&&"/"!=s?(f.length&&(i.push({part:f,flags:{},type:"Chars"}),f=[]),r={},r[n[s]]=1,i.push({part:s,flags:r,type:"Special"})):f.push(s);else{if("]"==s)return f.length&&(i.push({part:f,flags:{},type:"Chars"}),f=[]),{part:i,flags:u,type:"CharGroup"};"-"==s?(l=[h,""],f.pop(),c=!0):f.push(s)}return f.length&&(i.push({part:f,flags:{},type:"Chars"}),f=[]),{part:i,flags:u,type:"CharGroup"}},N=function(e){for(var h,l,g,o={pos:0,groupIndex:0,regex:e},i="",f=[],u=[],c=!1;o.pos<o.regex.length;)if(h=o.regex.charAt(o.pos++),c=t==h?!0:!1,c&&(h=o.regex.charAt(o.pos++)),c)"u"==h?(i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),g=a.exec(o.regex.substr(o.pos-1)),o.pos+=g[0].length-1,u.push({part:g[0],flags:{Char:String.fromCharCode(parseInt(g[1],16)),Code:g[1]},type:"UnicodeChar"})):"x"==h?(i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),g=p.exec(o.regex.substr(o.pos-1)),o.pos+=g[0].length-1,u.push({part:g[0],flags:{Char:String.fromCharCode(parseInt(g[1],16)),Code:g[1]},type:"HexChar"})):n[h]&&"/"!=h?(i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),l={},l[n[h]]=1,u.push({part:h,flags:l,type:"Special"})):i+=h;else if("|"==h)i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),f.push({part:u,flags:{},type:"Sequence"}),u=[];else if("["==h)i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),u.push(R(o));else if("("==h)i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),u.push(b(o));else if("{"==h){i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),g=r.exec(o.regex.substr(o.pos-1)),o.pos+=g[0].length-1,l={part:g[0],MatchMinimum:g[1],MatchMaximum:g[2]||"unlimited"},l[s[h]]=1,"?"==o.regex.charAt(o.pos)?(l.isGreedy=0,o.pos++):l.isGreedy=1;var y=u.pop();"String"==y.type&&y.part.length>1&&(u.push({part:y.part.slice(0,-1),flags:{},type:"String"}),y.part=y.part.slice(-1)),u.push({part:y,flags:l,type:"Quantifier"})}else if("*"==h||"+"==h||"?"==h){i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),l={},l[s[h]]=1,"?"==o.regex.charAt(o.pos)?(l.isGreedy=0,o.pos++):l.isGreedy=1;var y=u.pop();"String"==y.type&&y.part.length>1&&(u.push({part:y.part.slice(0,-1),flags:{},type:"String"}),y.part=y.part.slice(-1)),u.push({part:y,flags:l,type:"Quantifier"})}else s[h]?(i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),l={},l[s[h]]=1,u.push({part:h,flags:l,type:"Special"})):i+=h;return i.length&&(u.push({part:i,flags:{},type:"String"}),i=""),f.length?(f.push({part:u,flags:{},type:"Sequence"}),u=[],l={},l[s["|"]]=1,parts={part:f,flags:l,type:"Alternation"}):parts={part:u,flags:{},type:"Sequence"},parts},q=function(e,t){e&&this.regex(e,t)};return q.VERSION="0.4",q.getCharRange=i,q.prototype={constructor:q,$regex:null,$flags:null,$parts:null,$needsRefresh:!0,dispose:function(){var e=this;return e.$regex=null,e.$flags=null,e.$parts=null,e},regex:function(e,t){var r=this;if(e){t=t||"/";for(var a={},p=e.toString(),s=p.length,n=p.charAt(s-1);t!==n;)a[n]=1,p=p.substr(0,s-1),s=p.length,n=p.charAt(s-1);t==p.charAt(0)&&t==p.charAt(s-1)&&(p=p.substr(1,s-2)),r.$regex!==p&&(r.$needsRefresh=!0),r.$regex=p,r.$flags=a}return r},analyze:function(){var e=this;return e.$needsRefresh&&(e.$parts=N(e.$regex),e.$needsRefresh=!1),e},getParts:function(){var e=this;return e.$needsRefresh&&e.analyze(),e.$parts},generateSample:function(){var e=this;return e.$needsRefresh&&e.analyze(),O(e.$parts,e.$flags&&e.$flags.i)},getPeekChars:function(){var e,t,r,a,p,n,h=this;h.$needsRefresh&&h.analyze(),t=G(h.$parts),e=h.$flags&&h.$flags.i;for(r in t){n={},p=t[r];for(a in p)"\\d"==a?(delete p[a],n=v(n,i("0","9"))):"\\s"==a?(delete p[a],n=v(n,["\f","\n","\r","	",""," ","\u2028","\u2029"])):"\\w"==a?(delete p[a],n=v(n,["_"].concat(i("0","9")).concat(i("a","z")).concat(i("A","Z")))):"\\."==a?(delete p[a],n[s["."]]=1):"\\"!=a.charAt(0)&&e?(n[a.toLowerCase()]=1,n[a.toUpperCase()]=1):"\\"==a.charAt(0)&&delete p[a];t[r]=v(p,n)}return t}},e.RegExAnalyzer=q,e.RegExAnalyzer});