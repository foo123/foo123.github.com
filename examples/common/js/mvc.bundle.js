/**
*  Contemplate
*  Light-weight Template Engine for PHP, Python, Node and client-side JavaScript
*
*  @version: 0.6.8
*  https://github.com/foo123/Contemplate
*
*  @inspired by : Simple JavaScript Templating, John Resig - http://ejohn.org/ - MIT Licensed
*  http://ejohn.org/blog/javascript-micro-templating/
*
**/
!function(e,t,n){"object"==typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):e[t]=n()}(this.self||this,"Contemplate",function(e){"use strict";function t(e,t){var n,r={},u={},i={},o={},l={},a={};if(i[0]="HTML_SPECIALCHARS",i[1]="HTML_ENTITIES",o[0]="ENT_NOQUOTES",o[2]="ENT_COMPAT",o[3]="ENT_QUOTES",l=isNaN(e)?e?e.toUpperCase():"HTML_SPECIALCHARS":i[e],a=isNaN(t)?t?t.toUpperCase():"ENT_COMPAT":o[t],"HTML_SPECIALCHARS"!==l&&"HTML_ENTITIES"!==l)throw new Error("Table: "+l+" not supported");r[38]="&amp;","HTML_ENTITIES"===l&&(r[160]="&nbsp;",r[161]="&iexcl;",r[162]="&cent;",r[163]="&pound;",r[164]="&curren;",r[165]="&yen;",r[166]="&brvbar;",r[167]="&sect;",r[168]="&uml;",r[169]="&copy;",r[170]="&ordf;",r[171]="&laquo;",r[172]="&not;",r[173]="&shy;",r[174]="&reg;",r[175]="&macr;",r[176]="&deg;",r[177]="&plusmn;",r[178]="&sup2;",r[179]="&sup3;",r[180]="&acute;",r[181]="&micro;",r[182]="&para;",r[183]="&middot;",r[184]="&cedil;",r[185]="&sup1;",r[186]="&ordm;",r[187]="&raquo;",r[188]="&frac14;",r[189]="&frac12;",r[190]="&frac34;",r[191]="&iquest;",r[192]="&Agrave;",r[193]="&Aacute;",r[194]="&Acirc;",r[195]="&Atilde;",r[196]="&Auml;",r[197]="&Aring;",r[198]="&AElig;",r[199]="&Ccedil;",r[200]="&Egrave;",r[201]="&Eacute;",r[202]="&Ecirc;",r[203]="&Euml;",r[204]="&Igrave;",r[205]="&Iacute;",r[206]="&Icirc;",r[207]="&Iuml;",r[208]="&ETH;",r[209]="&Ntilde;",r[210]="&Ograve;",r[211]="&Oacute;",r[212]="&Ocirc;",r[213]="&Otilde;",r[214]="&Ouml;",r[215]="&times;",r[216]="&Oslash;",r[217]="&Ugrave;",r[218]="&Uacute;",r[219]="&Ucirc;",r[220]="&Uuml;",r[221]="&Yacute;",r[222]="&THORN;",r[223]="&szlig;",r[224]="&agrave;",r[225]="&aacute;",r[226]="&acirc;",r[227]="&atilde;",r[228]="&auml;",r[229]="&aring;",r[230]="&aelig;",r[231]="&ccedil;",r[232]="&egrave;",r[233]="&eacute;",r[234]="&ecirc;",r[235]="&euml;",r[236]="&igrave;",r[237]="&iacute;",r[238]="&icirc;",r[239]="&iuml;",r[240]="&eth;",r[241]="&ntilde;",r[242]="&ograve;",r[243]="&oacute;",r[244]="&ocirc;",r[245]="&otilde;",r[246]="&ouml;",r[247]="&divide;",r[248]="&oslash;",r[249]="&ugrave;",r[250]="&uacute;",r[251]="&ucirc;",r[252]="&uuml;",r[253]="&yacute;",r[254]="&thorn;",r[255]="&yuml;"),"ENT_NOQUOTES"!==a&&(r[34]="&quot;"),"ENT_QUOTES"===a&&(r[39]="&#39;"),r[60]="&lt;",r[62]="&gt;";for(n in r)r.hasOwnProperty(n)&&(u[String.fromCharCode(n)]=r[n]);return u}function n(e,n,r,u){var i=t("HTML_ENTITIES",n),o="";if(e=null==e?"":e+"",!i)return!1;if(n&&"ENT_QUOTES"===n&&(i["'"]="&#039;"),u||null==u)for(o in i)i.hasOwnProperty(o)&&(e=e.split(o).join(i[o]));else e=e.replace(/([\s\S]*?)(&(?:#\d+|#x[\da-f]+|[a-zA-Z][\da-z]*);|$)/g,function(e,t,n){for(o in i)i.hasOwnProperty(o)&&(t=t.split(o).join(i[o]));return t+n});return e}function r(e){return e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function u(e,t){var n,r=0;if(null===e||"undefined"==typeof e)return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;"COUNT_RECURSIVE"===t&&(t=1),1!=t&&(t=0);for(n in e)e.hasOwnProperty(n)&&(r++,1!=t||!e[n]||e[n].constructor!==Array&&e[n].constructor!==Object||(r+=u(e[n],1)));return r}function i(e){var t,n=function(e){var t=/\W*function\s+([\w\$]+)\s*\(/.exec(e);return t?t[1]:"(Anonymous)"},r=function(e){if(!e||"object"!=typeof e||"number"!=typeof e.length)return!1;var t=e.length;return e[e.length]="bogus",t!==e.length?(e.length-=1,!0):(delete e[e.length],!1)};return e&&"object"==typeof e?(t=null,r(e)||(!t||0!==parseInt(t.local_value,10)&&(!t.local_value.toLowerCase||"off"!==t.local_value.toLowerCase()))&&"[object Object]"===Object.prototype.toString.call(e)&&"Object"===n(e.constructor)):!1}function o(e){var t,n={};if(e&&"object"==typeof e&&e.change_key_case)return e.flip();for(t in e)e.hasOwnProperty(t)&&(n[e[t]]=t);return n}function l(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,t=arguments,n=0,r=t[n++],u=function(e,t,n,r){n||(n=" ");var u=e.length>=t?"":Array(1+t-e.length>>>0).join(n);return r?e+u:u+e},i=function(e,t,n,r,i,o){var l=r-e.length;return l>0&&(e=n||!i?u(e,r,o,n):e.slice(0,t.length)+u("",l,"0",!0)+e.slice(t.length)),e},o=function(e,t,n,r,o,l,a){var s=e>>>0;return n=n&&s&&{2:"0b",8:"0",16:"0x"}[t]||"",e=n+u(s.toString(t),l||0,"0",!1),i(e,n,r,o,a)},l=function(e,t,n,r,u,o){return null!=r&&(e=e.slice(0,r)),i(e,"",t,n,u,o)},a=function(e,r,a,s,c,f,d){var p,_,g,h,m;if("%%"==e)return"%";for(var v=!1,O="",C=!1,E=!1,b=" ",T=a.length,A=0;a&&T>A;A++)switch(a.charAt(A)){case" ":O=" ";break;case"+":O="+";break;case"-":v=!0;break;case"'":b=a.charAt(A+1);break;case"0":C=!0;break;case"#":E=!0}if(s=s?"*"==s?+t[n++]:"*"==s.charAt(0)?+t[s.slice(1,-1)]:+s:0,0>s&&(s=-s,v=!0),!isFinite(s))throw new Error("sprintf: (minimum-)width must be finite");switch(f=f?"*"==f?+t[n++]:"*"==f.charAt(0)?+t[f.slice(1,-1)]:+f:"fFeE".indexOf(d)>-1?6:"d"==d?0:void 0,m=r?t[r.slice(0,-1)]:t[n++],d){case"s":return l(String(m),v,s,f,C,b);case"c":return l(String.fromCharCode(+m),v,s,f,C);case"b":return o(m,2,E,v,s,f,C);case"o":return o(m,8,E,v,s,f,C);case"x":return o(m,16,E,v,s,f,C);case"X":return o(m,16,E,v,s,f,C).toUpperCase();case"u":return o(m,10,E,v,s,f,C);case"i":case"d":return p=+m||0,p=Math.round(p-p%1),_=0>p?"-":O,m=_+u(String(Math.abs(p)),f,"0",!1),i(m,_,v,s,C);case"e":case"E":case"f":case"F":case"g":case"G":return p=+m,_=0>p?"-":O,g=["toExponential","toFixed","toPrecision"]["efg".indexOf(d.toLowerCase())],h=["toString","toUpperCase"]["eEfFgG".indexOf(d)%2],m=_+Math.abs(p)[g](f),i(m,_,v,s,C)[h]();default:return e}};return r.replace(e,a)}function a(e,t){t=t?(t+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1"):" \\s ";var n=new RegExp("^["+t+"]+","g");return(e+"").replace(n,"")}function s(e,t){t=t?(t+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"\\$1"):" \\s ";var n=new RegExp("["+t+"]+$","g");return(e+"").replace(n,"")}function c(e,t){var n,r=0,u=0;for(e+="",t?(t+="",n=t.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1")):n=" \n\r	\f            ​\u2028\u2029　",r=e.length,u=0;r>u;u++)if(-1===n.indexOf(e.charAt(u))){e=e.substring(u);break}for(r=e.length,u=r-1;u>=0;u--)if(-1===n.indexOf(e.charAt(u))){e=e.substring(0,u+1);break}return-1===n.indexOf(e.charAt(0))?e:""}function f(){return Math.floor((new Date).getTime()/1e3)}function d(e,t){var n,r,u,i=/\\?([a-z])/gi,o=function(e,t){return e=e.toString(),e.length<t?o("0"+e,t,"0"):e},l=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];u=function(e,t){return r[e]?r[e]():t},r={d:function(){return o(r.j(),2)},D:function(){return r.l().slice(0,3)},j:function(){return n.getDate()},l:function(){return l[r.w()]+"day"},N:function(){return r.w()||7},S:function(){var e=r.j();return 4>e|e>20&&(["st","nd","rd"][e%10-1]||"th")},w:function(){return n.getDay()},z:function(){var e=new Date(r.Y(),r.n()-1,r.j()),t=new Date(r.Y(),0,1);return Math.round((e-t)/864e5)},W:function(){var e=new Date(r.Y(),r.n()-1,r.j()-r.N()+3),t=new Date(e.getFullYear(),0,4);return o(1+Math.round((e-t)/864e5/7),2)},F:function(){return l[6+r.n()]},m:function(){return o(r.n(),2)},M:function(){return r.F().slice(0,3)},n:function(){return n.getMonth()+1},t:function(){return new Date(r.Y(),r.n(),0).getDate()},L:function(){var e=r.Y();return e%4===0&e%100!==0|e%400===0},o:function(){var e=r.n(),t=r.W(),n=r.Y();return n+(12===e&&9>t?1:1===e&&t>9?-1:0)},Y:function(){return n.getFullYear()},y:function(){return r.Y().toString().slice(-2)},a:function(){return n.getHours()>11?"pm":"am"},A:function(){return r.a().toUpperCase()},B:function(){var e=3600*n.getUTCHours(),t=60*n.getUTCMinutes(),r=n.getUTCSeconds();return o(Math.floor((e+t+r+3600)/86.4)%1e3,3)},g:function(){return r.G()%12||12},G:function(){return n.getHours()},h:function(){return o(r.g(),2)},H:function(){return o(r.G(),2)},i:function(){return o(n.getMinutes(),2)},s:function(){return o(n.getSeconds(),2)},u:function(){return o(1e3*n.getMilliseconds(),6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var e=new Date(r.Y(),0),t=Date.UTC(r.Y(),0),n=new Date(r.Y(),6),u=Date.UTC(r.Y(),6);return e-t!==n-u?1:0},O:function(){var e=n.getTimezoneOffset(),t=Math.abs(e);return(e>0?"-":"+")+o(100*Math.floor(t/60)+t%60,4)},P:function(){var e=r.O();return e.substr(0,3)+":"+e.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-n.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(i,u)},r:function(){return"D, d M Y H:i:s O".replace(i,u)},U:function(){return n/1e3|0}};var a=function(e,t){return n=void 0===t?new Date:new Date(t instanceof Date?t:1e3*t),e.replace(i,u)};return a(e,t)}function p(e,t,n){for(var r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u=d(t,n),i=0,o=r.length;o>i;i++)e[r[i]]&&(u=u.replace(r[i],e[r[i]]));return u}var _,g="0.6.8",h=Object,m=Array,v=String,O=Function,C=h.keys,E=parseInt,b=parseFloat,T=h.prototype,A=m.prototype,y=O.prototype,S=y.call.bind(T.toString),w=y.call.bind(T.hasOwnProperty),D=y.call.bind(A.slice),N="undefined"!=typeof global&&"[object global]"===S(global),j=function(e){return e instanceof m||"[object Array]"===S(e)},M=N?require("fs"):null,I=M?M.writeFileSync:null,x=M?M.readFileSync:null,L=M?M.existsSync:null,k=M?M.statSync:null,U=(M?M.realpathSync:null,M?M.writeFile:null),K=M?M.readFile:null,H=(M?M.exists:null,M?M.stat:null,M?M.realpath:null,function(e,t,n,r){var u;return u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r?(u.onload=function(){r(200===u.status?u.responseText:"")},u.open(e,t,!0),u.send(n),""):(u.open(e,t,!1),u.send(n),200===u.status?u.responseText:"")}),R=!1,F={},P={},B=!1,$=0,G="./",Y={},q={},z={},V={},J="<%",W="%>",X="",Z="",Q="",et="' + \"\\n\" + '",tt="",nt=N?require("os").EOL:"\n",rt=!0,ut=null,it=0,ot="    ",lt=0,at=0,st=0,ct=0,ft=2,dt=null,pt=null,_t=null,gt=null,ht=null,mt=-1,vt=null,Ot=0,Ct=/[ -]/g,Et=/\n\r|\r\n|\n|\r/g,bt=/^[a-zA-Z_]/,Tt=/^[0-9]/,At=/^[a-zA-Z0-9_]/i,yt=/^\s/,St={specials:null,replacements:null,functions:null,controls:null,controls2:null},wt=["include","template","extends","endblock","block","elsefor","endfor","for","set","unset","isset","elseif","else","endif","if"],Dt=["htmlselect","htmltable","plugin_([a-zA-Z0-9_]+)","haskey","lowercase","uppercase","camelcase","snakecase","pluralise","concat","ltrim","rtrim","trim","sprintf","addslashes","stripslashes","tpl","uuid","html","url","count","ldate","date","now","locale","dq","q","l","s","n","f"],Nt={},jt=function(){at=0,st=0,ct=0,ft=2,it=0,dt=[],pt={},_t=[[null,-1]],vt=null},Mt=function(){ut.push([at,st,ct,ft,it,dt,pt,_t,vt])},It=function(){var e=ut.pop();at=e[0],st=e[1],ct=e[2],ft=e[3],it=e[4],dt=e[5],pt=e[6],_t=e[7],vt=e[8]},xt=function(){return D(arguments).join(nt)},Lt=function(e,t){if(2>arguments.length&&(t=it),t>=0){t=0===t?t:t+1;var n,r,u=new m(t).join(ot);for(e=e.split(Et),r=e.length,n=0;r>n;n++)e[n]=u+e[n];return e.join(nt)}return e},kt=function(){var e=D(arguments);if(!(e.length<1)){var t,n,r,u=e.shift(),i=e.length;for(t=0;i>t;t++)if(r=e[t])for(n in r)w(r,n)&&(u[n]=r[n]);return u}},Ut=function(e,t){var n,r;if(t)r=c(t).split(" "),J=c(r[0]),W=c(r[1]);else{for(n=e.split("\n");n.length&&!c(n[0]).length;)n.shift();n.length&&(r=c(n.shift()).split(" "),J=c(r[0]),W=c(r[1])),e=n.join("\n")}return e},Kt=function(e,t){return V[e]?B&&t?(t(V[e]),""):V[e]:q[e]?N&&M?B&&t?(K(q[e],{encoding:_.ENCODING},function(e,n){t(e?"":n)}),""):x(q[e],{encoding:_.ENCODING}):"#"===q[e].charAt(0)?B&&t?(t(window.document.getElementById(q[e].substring(1)).innerHTML||""),""):window.document.getElementById(q[e].substring(1)).innerHTML||"":B&&t?(H("GET",q[e],null,t),""):H("GET",q[e]):""},Ht=function(e){return' ("undefined" !== typeof('+e+")) "},Rt=function(e){e=e.split(",");var t=c(e.shift()),n=c(e.join(","));return"';"+nt+Lt(t+" = ("+n+");")+nt},Ft=function(e){return e&&e.length?(e=c(e),"';"+nt+Lt('if ("undefined" !== typeof('+e+")) delete "+e+";")+nt):"'; "+nt},Pt=function(e){var t="';"+Lt(hn({IFCOND:e}));return st++,it++,t},Bt=function(e){it--;var t="';"+Lt(mn({ELIFCOND:e}));return it++,t},$t=function(){it--;var e="';"+Lt(vn());return it++,e},Gt=function(){st--,it--;var e="';"+Lt(On());return e},Yt=function(e){e=e.split(" as ");var t,n=c(e[0]),r="_O"+ ++lt,u=e[1].split("=>"),i=u.length>=2;if(i){var o=c(u[0])+"__RAW__",l=c(u[1])+"__RAW__",a="_OK"+ ++lt,s="_K"+ ++lt,f="_L"+ ++lt,d="_V"+ ++lt;t="';"+Lt(Cn({O:n,_O:r,_OK:a,K:o,_K:s,_L:f,V:l,_V:d,ASSIGN1:"data['"+o+"'] = "+a+"["+s+"]; data['"+l+"'] = "+d+" = "+r+"["+a+"["+s+"]];"},2)),ft=2,it+=2}else{var l=c(u[0])+"__RAW__",s="_K"+ ++lt,f="_L"+ ++lt,d="_V"+ ++lt;t="';"+Lt(Cn({O:n,_O:r,_K:s,_L:f,V:l,_V:d,ASSIGN1:"data['"+l+"'] = "+d+" = "+r+"["+s+"];"},1)),ft=1,it+=2}return at++,ct++,t},qt=function(){var e;return 2===ft?(ct--,it+=-2,e="';"+Lt(En(null,2)),it+=1):(ct--,it+=-2,e="';"+Lt(En(null,1)),it+=1),e},zt=function(){var e;return ct===at?2===ft?(at--,ct--,it+=-2,e="';"+Lt(bn(null,3))):(at--,ct--,it+=-2,e="';"+Lt(bn(null,2))):(at--,it+=-1,e="';"+Lt(bn(null,1))),e},Vt=function(e){return z[e]||(Mt(),jt(),z[e]=" "+on(Ut(Kt(e)),!1)+"'; "+nt,It()),Lt(z[e])},Jt=function(e){e=e.split(",");var t=c(e.shift()),n=e.join(",");return"' + %tpl( \""+t+'", '+n+" ); "+nt},Wt=function(e){return vt=c(e),"'; "+nt},Xt=function(e){return e=c(e),dt.push([e,-1,-1,0,_t[0][1]]),pt[e]=pt[e]?pt[e]+1:1,mt=dt.length,_t.unshift([e,mt-1]),gt=e,ht=null,"' +  __||"+e+"||__"},Zt=function(){if(1<_t.length){var e=_t.shift();return ht=e[0],mt=e[1]+1,gt=null,"__||/"+e[0]+"||__"}return""},Qt=function(e,t,n){var r,u,i,o,l;for(r=e.split(t),u=r.length,i=[],o=0;u>o;o++)l=r[o].split(n),i.push(l[0]),l.length>1&&i.push(l[1]);return i},en=function(e,t,n){if(t)switch(n=n||"",t){case"isset":return n=n.replace(St.controls2,en),Ht(n);case"set":return n=n.replace(St.controls2,en),Rt(n);case"unset":return n=n.replace(St.controls2,en),Ft(n);case"if":return n=n.replace(St.controls2,en),Pt(n);case"elseif":return n=n.replace(St.controls2,en),Bt(n);case"else":return $t(n);case"endif":return Gt(n);case"for":return n=n.replace(St.controls2,en),Yt(n);case"elsefor":return qt(n);case"endfor":return zt(n);case"extends":return Wt(n);case"block":return Xt(n);case"endblock":return Zt(n);case"template":return n=n.replace(St.controls2,en),Jt(n);case"include":return Vt(n)}return e},tn=function(e){for(var t,n,r,u,i,o,l,a,s,c,f=[],d=dt.length;d--;)n=dt[d],t=n[0],l=n[1],a=n[2],s=n[3],c=n[4],r="__||"+t+"||__",u="__i__.renderBlock( '"+t+"' ); ",i=r.length,o=u.length,c>-1&&(dt[c][3]+=o-(a-l+1)),a+=s,1===pt[t]&&f.push([t,gn({BLOCKCODE:e.slice(l+i,a-i-1)+"';"})]),e=e.slice(0,l)+u+e.slice(a+1),1<=pt[t]&&pt[t]--;return dt=null,pt=null,_t=null,[e,f]},nn=function(e,t,n,r){for(var u=t,i=!1,o="";r>n&&(o=e[n++],u+=o,t!==o||i);)i=!i&&"\\"===o;return u},rn=function(e,t,n,r){if(r=r||"VARSTR",bt.test(e[t])){var u,i,o,l,a,s,c,f,d,p,_,g=0,h={},m=[],v=0;for(i=e[t++];n>t&&At.test(e[t]);)i+=e[t++];for(l=i,i="data['"+i+"']",a=l.length,v=0;n>t&&yt.test(e[t]);)v++,t++;for(c=0;n>t&&("."===e[t]||"["===e[t]);){for(f=e[t++];n>t&&yt.test(e[t]);)v++,t++;if("."===f){for(o="";n>t&&At.test(e[t]);)o+=e[t++];if(s=o.length,!s)break;i+="['"+o+"']",a+=v+1+s,v=0}else if("["===f){if(c++,d=e[t],'"'===d||"'"===d)o=nn(e,d,t+1,n),g++,p="__##"+r+g+"##__",h[p]=o,i+=f+p,s=o.length,t+=s,a+=v+1+s,v=0;else if(Tt.test(d)){for(o=e[t++];n>t&&Tt.test(e[t]);)o+=e[t++];i+=f+o,s=o.length,a+=v+1+s,v=0}else if("$"===d)_=e.slice(t+1),u=rn(_,0,_.length,r+"_"+g+"_"),u&&(o=u[u.length-1],i+=f+o[0][0],s=o[1],t+=s+1,a+=v+2+s,v=0,m=m.concat(u));else{if("]"!==d)break;if(!(c>0))break;c--,i+=f+e[t++],a+=v+2,v=0}for(;n>t&&yt.test(e[t]);)v++,t++;if("]"===e[t]){if(!(c>0))break;c--,i+=e[t++],a+=v+1,v=0}}for(;n>t&&yt.test(e[t]);)v++,t++}return m.push([[i,l],a,h]),m}return null},un=function(e,t,n){return n&&Nt[n]?"Contemplate.plugin_"+n:"Contemplate."+t},on=function(e,t){var n,r,u,i,o,l,a,s,c,f,d,p,g,h,m,v,O,C;for(n=Qt(e,J,W),r=n.length,l=!1,u="",o=0;r>o;o++){if(i=n[o],l){for(a="	"+i.replace(St.specials," ")+"",d=a.length,c={},s={},p=0,g="",h="",m=0;d>p;)if(g=a[p++],'"'===g||"'"===g)v=nn(a,g,p,d),m++,f="__##STR"+m+"##__",s[f]=v,h+=f,p+=v.length-1;else if("$"===g)if(v=rn(a,p,d)){for(O=0;O<v.length;O++)C=v[O],m++,f="__##VAR"+m+"##__",c[f]=C[0],s=_.merge(s,C[2]);h+=f,p+=C[1]}else h+="$";else h+=g;a=h,gt=null,ht=null,mt=-1,a=a.replace(St.controls,en).replace(St.functions,un).replace(St.replacements,"' + ( $1 ) + '");for(f in c)a=a.split(f+"__RAW__").join(c[f][1]),a=a.split(f).join(c[f][0]);for(f in s)a=a.split(f).join(s[f]);i=a.split("	").join(X).split("").join(Lt(Z)),gt?(gt="__||"+gt+"||__",dt[mt-1][1]=u.length+a.indexOf(gt)):ht&&(ht="__||/"+ht+"||__",dt[mt-1][2]=u.length+a.indexOf(ht)+ht.length),l=!1}else rt&&(i=i.split("\\").join("\\\\")),i=i.split("'").join("\\'").split(/\n/).join(tt),l=!0;u+=i}return!1!==t?tn(u):u},ln=function(e){return G+e.replace(Ct,"_")+"_tpl.js"},an=function(e){return"Contemplate_"+e.replace(Ct,"_")+"_Cached"},sn=function(e,t){jt();var n,r,u,i,o=on(Ut(Kt(e),t)),l={};for(i=o[0],o=o[1],r=o.length,u=vt?Tn(null,1):Tn({FCODE:"__p__ += '"+i+"';"},2),n=0;r>n;n++)l[o[n][0]]=new O("Contemplate,__i__",o[n][1]);return[new O("Contemplate,__i__",u),l]},cn=function(e,t,n,r){jt();var u,i,o,l,a,s,c,f=on(Ut(Kt(e),r));for(c=f[0],f=f[1],a=f.length,s=[],l=0;a>l;l++)s.push(nt+_n({BLOCKNAME:f[l][0],BLOCKMETHODNAME:f[l][0],BLOCKMETHODCODE:Lt(f[l][1],1)}));s=s.length?nt+"_blocks = { "+nt+Lt(s.join(","+nt),1)+nt+"};"+nt:"",vt?(i="this.extend( '"+vt+"' );",o=An(null,1)):(i="",o=An({RCODE:"__p__ += '"+c+"';"},2)),u=Q?Q:"";var d=pn({CLASSNAME:n,TPLID:e,PREFIXCODE:u,EXTENDCODE:Lt(i,2),BLOCKS:Lt(s,2),RENDERCODE:Lt(o,4)});return dn(t,d)},fn=function(e,t){if(V[e]){var n,r;return t.parsed?r=yn(_,e,new O("Contemplate,__i__",t.parsed)):(n=sn(e,t.separators),r=yn(_,e,n[0]).setBlocks(n[1])),vt&&r.extend(_.tpl(vt)),r}if(N||($=_.CACHE_TO_DISK_NONE),!0!==t.autoUpdate&&_.CACHE_TO_DISK_NOUPDATE===$){var u=ln(e),i=an(e);if(L(u)||cn(e,u,i,t.separators),L(u)){var o=require(u)(_),r=(new o).setId(e);return r}return null}if(!0===t.autoUpdate||_.CACHE_TO_DISK_AUTOUPDATE===$){var u=ln(e),i=an(e);if(L(u)){var l=k(u),a=k(q[e]);l.mtime.getTime()<=a.mtime.getTime()&&cn(e,u,i,t.separators)}else cn(e,u,i,t.separators);if(L(u)){var o=require(u)(_),r=(new o).setId(e);return r}return null}var n=sn(e,t.separators),r=yn(_,e,n[0]).setBlocks(n[1]);return vt&&r.extend(_.tpl(vt)),r},dn=function(e,t,n){return n?void U(e,t,{encoding:_.ENCODING},function(e){n(!e)}):I(e,t,{encoding:_.ENCODING})},pn=function(e){var t=xt;return[e.PREFIXCODE,t("","!function (root, moduleName, moduleDefinition) {","","    //","    // export the module","","    // node, CommonJS, etc..","    if ( 'object' === typeof(module) && module.exports ) module.exports = moduleDefinition();","","    // AMD, etc..","    else if ( 'function' === typeof(define) && define.amd ) define( moduleDefinition );","","    // browser, etc..","    else root[ moduleName ] = moduleDefinition();","","","}(this, '"),e.CLASSNAME,t("', function( ) {",'    "use strict";',"    return function( Contemplate ) {","    /* Contemplate cached template '"),e.TPLID,t("' */","    /* quasi extends main Contemplate class */","    ","    var Contemplate_tpl = Contemplate.tpl;","    ","    /* constructor */","    function "),e.CLASSNAME,t("(id)","    {","        /* initialize internal vars */","        var _extends = null, _blocks = null;","        ","        this.id = id;","        this.d = null;","        ","        ","        /* tpl-defined blocks render code starts here */",""),e.BLOCKS,t("","        /* tpl-defined blocks render code ends here */","        ","        /* template methods */","        ","        this.setId = function(id) {","            if ( id ) this.id = id;","            return this;","        };","        ","        this.extend = function(tpl) {","            if ( tpl && tpl.substr )","                _extends = Contemplate_tpl( tpl );","            else","                _extends = tpl;","            return this;","        };","        ","        /* render a tpl block method */","        this.renderBlock = function(block, __i__) {","            if ( !__i__ ) __i__ = this;","            if ( _blocks && _blocks[block] ) return _blocks[block](__i__);","            else if ( _extends ) return _extends.renderBlock(block, __i__);","            return '';","        };","        ","        /* tpl render method */","        this.render = function(data, __i__) {","            if ( !__i__ ) __i__ = this;","            var __p__ = '';","            if ( _extends )","            {","                __p__ = _extends.render(data, __i__);","            }","            else","            {","                /* tpl main render code starts here */",""),e.RENDERCODE,t("","                /* tpl main render code ends here */","            }","            this.d = null;","            return __p__;","        };","        ","        /* extend tpl assign code starts here */",""),e.EXTENDCODE,t("","        /* extend tpl assign code ends here */","    };","    ","    ","    // export it","    return "),e.CLASSNAME,t(";","    };","});","")].join("")},_n=function(e){var t=xt;return[t("","/* tpl block render method for block '"),e.BLOCKNAME,t("' */","'"),e.BLOCKMETHODNAME,t("': function(__i__) {",""),e.BLOCKMETHODCODE,t("","}","")].join("")},gn=function(e){var t=xt;return[t("","var __p__ = '', data = __i__.d;",""),e.BLOCKCODE,t("","return __p__;","")].join("")},hn=function(e){var t=xt;return[t("","if ("),e.IFCOND,t(")","{","")].join("")},mn=function(e){var t=xt;return[t("","}","else if ("),e.ELIFCOND,t(")","{","")].join("")},vn=function(){var e=xt;return e("","}","else","{","")},On=function(){var e=xt;return e("","}","")},Cn=function(e,t){var n=xt;return 2===t?[n("","var "),e._O," = ",e.O,", ",e._OK," = Contemplate.keys(",e._O,n(");","if ("),e._OK," && ",e._OK,n(".length)","{","    var "),e._K,", ",e._V,", ",e._L," = ",e._OK,".length",n(";","    for ("),e._K,"=0; ",e._K,"<",e._L,"; ",e._K,n("++)","    {","        "),e.ASSIGN1,n("","        ","")].join(""):[n("","var "),e._O," = Contemplate.values(",e.O,n(");","if ("),e._O," && ",e._O,n(".length)","{","    var "),e._K,", ",e._V,", ",e._L," = ",e._O,".length",n(";","    for ("),e._K,"=0; ",e._K,"<",e._L,"; ",e._K,n("++)","    {","        "),e.ASSIGN1,n("","        ","")].join("")},En=function(e,t){var n=xt;return 2===t?n("","    }","}","else","{  ",""):n("","    }","}","else","{  ","")},bn=function(e,t){var n=xt;return 3===t?n("","    }","}",""):2===t?n("","    }","}",""):n("","}","")},Tn=function(e,t){var n=xt;return 1===t?"return '';":[n("","var __p__ = '', data = __i__.d;",""),e.FCODE,n("","return __p__;","")].join("")},An=function(e,t){var n=xt;return 1===t?"__p__ = '';":[n("","__i__.d = data;",""),e.RCODE,n("","")].join("")},yn=function(e,t,n){var r=e.tpl,u=e.merge,i=function(t,n){var i=null,o=null,l=null;this.id=null,this.d=null,t&&(this.id=t,i=n),this.setId=function(e){return e&&(this.id=e),this},this.extend=function(e){return o=e&&e.substr?r(e):e,this},this.setRenderFunction=function(e){return i=e,this},this.setBlocks=function(e){return l||(l={}),l=u(l,e),this},this.renderBlock=function(t,n){return n||(n=this),l&&l[t]?l[t](e,n):o?o.renderBlock(t,n):""},this.render=function(t,n){var r="";return n||(n=this),o?r=o.render(t,n):i&&(n.d=t,r=i(e,n)),this.d=null,r}};return new i(t,n)};return _={VERSION:g,CACHE_TO_DISK_NONE:0,CACHE_TO_DISK_AUTOUPDATE:2,CACHE_TO_DISK_NOUPDATE:4,ENCODING:"utf8",init:function(){R||(ut=[],St.specials=new RegExp("[\\n\\r\\v\\t]","g"),St.replacements=new RegExp("\\t[ ]*(.*?)[ ]*\\v","g"),St.controls=new RegExp("\\t[ ]*%("+wt.join("|")+")\\b[ ]*\\((.*)\\)","g"),St.controls2=new RegExp("%("+wt.join("|")+")\\b[ ]*\\((.*)\\)","g"),St.functions=new RegExp("%("+Dt.join("|")+")\\b","g"),tt=et,X="'; "+nt,Z=nt+"__p__ += '",R=!0)},addPlugin:function(e,t){e&&t&&(Nt[e]=!0,_["plugin_"+e]=t)},setPrefixCode:function(e){e&&(Q=""+e)},setLocaleStrings:function(e){F=_.merge(F,e)},clearLocaleStrings:function(){F={}},setPlurals:function(e){if(e){for(var t in e)null==e[t]&&(e[t]=t+"s");P=_.merge(P,e)}},clearPlurals:function(){P={}},setTemplateSeparators:function(e){e&&(e.left&&(J=""+e.left),e.right&&(W=""+e.right))},setPreserveLines:function(e){arguments.length<1&&(e=!0),tt=e?et:""},setCacheDir:function(e){G=s(e,"/")+"/"},setCacheMode:function(e){$=N?e:_.CACHE_TO_DISK_NONE},setSyncMode:function(e){B=!e},clearCache:function(e){Y={},e&&(z={})},add:function(e,t){if("object"==typeof e){for(var n in e)j(e[n])&&(e[n][0]&&(V[n]=e[n][0]),delete e[n]);q=_.merge(q,e)}else e&&t&&(q[e]=t)},addInline:function(e,t){"object"==typeof e?V=_.merge(V,e):e&&t&&(V[e]=t)},parseTpl:function(e,t){var n,r,u=t&&t.separators?t.separators:null;return u&&(n=[J,W],J=u[0],W=u[1]),jt(),r=on(e),u&&(J=n[0],W=n[1]),r},tpl:function(e,t,n){n=kt({autoUpdate:!1,refresh:!1,escape:!0,separators:null},n),rt=!1!==n.escape,(n.refresh||!Y[e])&&(Y[e]=fn(e,n));var r=Y[e];return t&&"object"==typeof t?r.render(t):r},html:function(e){return n(e,"ENT_COMPAT","UTF-8")},url:r,count:u,haskey:function(t){var n=S(t);if(!t||"[object Array]"!=n&&"[object Object]"!=n)return!1;var r,u,i,o=D(arguments);for(o.shift(),r=o.length,i=t,u=0;r>u;u++){if(e===i[o[u]])return!1;i=i[o[u]]}return!0},q:function(e){return"'"+e+"'"},dq:function(e){return'"'+e+'"'},s:function(e){return v(e)},n:function(e){return E(e,10)},f:function(e){return b(e,10)},addslashes:function(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},stripslashes:function(e){return(e+"").replace(/\\(.?)/g,function(e,t){switch(t){case"\\":return"\\";case"0":return"\x00";case"":return"";default:return t}})},concat:function(){return D(arguments).join("")},trim:c,ltrim:a,rtrim:s,ucfirst:function(e){return e[0].toUpperCase()+e.substr(1)},lcfirst:function(e){return e[0].toLowerCase()+e.substr(1)},lowercase:function(e){return e.toLowerCase()},uppercase:function(e){return e.toUpperCase()},camelcase:function(e,t,n){return t=t||"_",n?e.split(t).map(_.ucfirst).join(""):_.lcfirst(e.split(t).map(_.ucfirst).join(""))},snakecase:function(e,t){return t=t||"_",e.replace(/([A-Z])/g,t+"$1").toLowerCase()},sprintf:l,time:f,date:function(e,t){return t||(t=f()),d(e,t)},ldate:function(e,t){return t||(t=f()),p(F,e,t)},locale:function(e){return w(F,e)?F[e]:e},pluralise:function(e,t){return P[e]&&1!==t?P[e]:e},uuid:function(e){return[e||"UUID",++Ot,f()].join("_")},htmltable:function(e,t){e=_.merge({},e),t=_.merge({},t||{});var n,r,u,o,l,a,s,c,f,d="",p="",g="",h="",v=[],O=!1;if(d="<table",t.id&&(d+=" id='"+t.id+"'"),t["class"]&&(d+=" class='"+t["class"]+"'"),t.style&&(d+=" style='"+t.style+"'"),t.data)for(n in t.data)_.hasOwn(t.data,n)&&(d+=" data-"+n+"='"+t.data[n]+"'");d+=">",p="",(t.header||t.footer)&&(p="<td>"+(_.keys(e)||[]).join("</td><td>")+"</td>"),g="",t.header&&(g="<thead><tr>"+p+"</tr></thead>"),h="",t.footer&&(h="<tfoot><tr>"+p+"</tr></tfoot>"),d+=g,v=[],l=_.values(e)||[];for(r in l)if(_.hasOwn(l,r))for(a=l[r],i(a)||(a=[a]),s=_.values(a)||[],u=0,o=s.length;o>u;u++)v[u]||(v[u]=new m(o)),v[u][r]=s[u];for(c=t.odd?t.odd:"odd",f=t.even?t.even:"even",O=!1,r=0,o=v.length;o>r;r++)d+=O?"<tr class='"+c+"'><td>"+v[r].join("</td><td>")+"</td></tr>":"<tr class='"+f+"'><td>"+v[r].join("</td><td>")+"</td></tr>",O=!O;return v=null,d+=h,d+="</table>"},htmlselect:function(e,t){e=_.merge({},e),t=_.merge({},t||{});var n,r,u,l,a="";if(a="<select",t.multiple&&(a+=" multiple"),t.disabled&&(a+=" disabled='disabled'"),t.name&&(a+=" name='"+t.name+"'"),t.id&&(a+=" id='"+t.id+"'"),t["class"]&&(a+=" class='"+t["class"]+"'"),t.style&&(a+=" style='"+t.style+"'"),t.data)for(n in t.data)_.hasOwn(t.data,n)&&(a+=" data-"+n+"='"+t.data[n]+"'");a+=">",t.selected?(i(t.selected)||(t.selected=[t.selected]),t.selected=o(t.selected)):t.selected={},t.optgroups&&(i(t.optgroups)||(t.optgroups=[t.optgroups]),t.optgroups=o(t.optgroups));for(n in e)if(_.hasOwn(e,n))if(u=e[n],t.optgroups&&t.optgroups[n]){a+="<optgroup label='"+n+"'>";for(r in u)_.hasOwn(u,r)&&(l=u[r],t.use_key?l=r:t.use_value&&(r=l),a+=_.hasOwn(t.selected,r)?"<option value='"+r+"' selected='selected'>"+l+"</option>":"<option value='"+r+"'>"+l+"</option>");a+="</optgroup>"}else t.use_key?u=n:t.use_value&&(n=u),a+=t.selected[n]?"<option value='"+n+"' selected='selected'>"+u+"</option>":"<option value='"+n+"'>"+u+"</option>";return a+="</select>"},getTemplateContents:Kt,hasOwn:function(e,t){return e&&w(e,t)},keys:function(e){return e?C(e):null},values:function(e){if(e){if(e instanceof m)return e;var t,n=[];for(t in e)w(e,t)&&n.push(e[t]);return n}return null},items:function(e){return e?e:null},merge:kt,data:function(e){if(j(e))return e.slice();var t,n,r={};for(t in e)w(e,t)&&(n=t,r[n]=e[t]);return r}},_.now=_.time,_.l=_.locale,_.init(),_});

/**
*
*   Dromeo
*   Simple and Flexible Routing Framework for PHP, Python, Node/JS
*   @version: 0.5
*
*   https://github.com/foo123/Dromeo
*
**/
!function(e,t,n){"object"==typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):e[t]=n()}(this,"Dromeo",function(e){"use strict";function t(e,t,n){var r=this;r.handlers=[],r.route=e,r.pattern=t,r.captures=n,r.dispose=function(){return r.handlers=null,r.route=null,r.pattern=null,r.captures=null,r}}var n="0.5",r={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",419:"Authentication Timeout",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",440:"Login Timeout",444:"No Response",449:"Retry With",450:"Blocked by Windows Parental Controls",451:"Unavailable For Legal Reasons",494:"Request Header Too Large",495:"Cert Error",496:"No Cert",497:"HTTP to HTTPS",498:"Token expired/invalid",499:"Client Closed Request",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required",520:"Origin Error",521:"Web server is down",522:"Connection timed out",523:"Proxy Declined Request",524:"A timeout occurred",598:"Network read timeout error",599:"Network connect timeout error"},o=/^([a-zA-Z0-9-_]+\|[a-zA-Z0-9-_|]+)$/,i=/\((\d+)\)$/,l=Object.prototype,a=Array.prototype,s=Function.prototype,u=s.call.bind(l.hasOwnProperty),c=s.call.bind(l.toString),h=s.call.bind(a.slice),d="undefined"!=typeof global&&"[object global]"==c(global),f=function(e){return"[object Function]"===c(e)||e instanceof Function},p=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},g=function(e){return e.length>0},m=function(e){return e.replace(/([*+\[\]\(\)?^$\/\\:])/g,"\\$1")},_={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},y=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],R=function(e,t,n){for(var r=_[n||"php"].exec(e),o={},i=14;i--;)r[i]&&(o[y[i]]=r[i]);return"port"in o&&(o.port=parseInt(o.port,10)),t?o[t.replace("PHP_URL_","").toLowerCase()]||null:(o.source&&delete o.source,o)},b=function(e){return decodeURIComponent(""+e)},v=function(e){return encodeURIComponent(""+e).split("!").join("%21").split("'").join("%27").split("(").join("%28").split(")").join("%29").split("*").join("%2A")},A=function(e){return v(e).split("%20").join("+")},P=function(t){var n,r,o,i,l,a,s,c,h,d,f,g,m,_=t.replace(/^&/,"").replace(/&$/,"").split("&"),y=_.length,R={};for(n=0;y>n;n++)if(c=_[n].split("="),h=b(p(c[0])),d=c.length<2?"":b(p(c[1])),r=h.indexOf("\x00"),r>-1&&(h=h.slice(0,r)),h&&"["!==h.charAt(0)){for(g=[],f=0,r=0;r<h.length;r++)if("["!==h.charAt(r)||f){if("]"===h.charAt(r)&&f&&(g.length||g.push(h.slice(0,f-1)),g.push(h.substr(f,r-f)),f=0,"["!==h.charAt(r+1)))break}else f=r+1;for(g.length||(g=[h]),r=0;r<g[0].length&&(s=g[0].charAt(r),(" "===s||"."===s||"["===s)&&(g[0]=g[0].substr(0,r)+"_"+g[0].substr(r+1)),"["!==s);r++);for(a=R,r=0,m=g.length;m>r;r++)if(h=g[r].replace(/^['"]/,"").replace(/['"]$/,""),l=a,""!==h&&" "!==h||0===r)e===a[h]&&(a[h]={}),a=a[h];else{o=-1;for(i in a)u(a,i)&&+i>o&&i.match(/^\d+$/g)&&(o=+i);h=o+1}l[h]=d}return R},q=function(e,t,n,r){var o,i,l=r?v:A;if(!0===t?t="1":!1===t&&(t="0"),null!=t){if("object"==typeof t){i=[];for(o in t)null!=t[o]&&i.push(q(e+"["+o+"]",t[o],n,r));return i.join(n)}return l(e)+"="+l(t)}return""},N=function(e,t,n){var r,o,i,l=[];arguments.length<2&&(t="&"),arguments.length<3&&(n=!1);for(o in e)r=e[o],i=q(o,r,t,n),""!=i&&l.push(i);return l.join(t)},L=function(e,t,n){if(n){var r,o,i=[];for(e=e.split(t),o=0;o<e.length;o++)r=e[o],r=r.split(n),i.push(r[0]),r.length>1&&i.push(r[1]);return i}return e.split(t)},T=function(e,t,n){var r,i,l,a,s,u=0;for(n=L(n,e[3]),a=[],i=n.length,l=!1,r=0;i>r;r++)l?(n[r].length&&(t[n[r]]?(a.push("("+t[n[r]]+")"),u++):(s=n[r].match(o))?(a.push("("+s[1].split("|").filter(g).map(m).join("|")+")"),u++):a.push(m(n[r]))),l=!1):(n[r].length&&a.push(m(n[r])),l=!0);return 1===a.length&&1===u?[a.join(""),u]:["("+a.join("")+")",u+1]},w=function(e,n,r){var o,l,a,s,u,c,h,d,f,g,_,y,R,b,v;for(o=L(r,e[0],e[1]),s=o.length,h=!1,d="",_=0,y={},a=0;s>a;a++)l=o[a],h?(u=!1,c=!1,f=l.split(e[2]),b=T(e,n,f[0]),f.length>1&&(R=p(f[1]),u=R.length&&"?"===R.charAt(0),u&&(R=R.slice(1)),(g=R.match(i))?(R=R.slice(0,-g[0].length),v=parseInt(g[1],10),v>=0&&v<b[1]?v+=_+1:v=_+1):v=_+1,c=R.length>0),d+=b[0],_+=b[1],u&&(d+="?"),c&&(y[R]=v),h=!1):(d+=m(l),h=!0);return new t(r,new RegExp("^"+d+"$"),y)},j=function(e,t,n){delete e[n];var r,o=t.length;for(r=o-1;r>=0;r--)if(n===t[r].route){t.splice(r,1);break}},k=function(e,t,n,r,o,i,l,a){o&&o.length&&i&&"function"==typeof i&&(a=!0===a,l=l||{},o in e?e[o].handlers.push([i,l,a]):(e[o]=w(n,r,o),e[o].handlers.push([i,l,a]),t.push(e[o])))},C=function(){var e=this;e._delims=["{","}",":","%"],e._patterns={},e.definePattern("ALPHA","[a-zA-Z\\-_]+"),e.definePattern("NUMBR","[0-9]+"),e.definePattern("ALNUM","[a-zA-Z0-9\\-_]+"),e.definePattern("QUERY","\\?[^?#]+"),e.definePattern("FRAGM","#[^?#]+"),e.definePattern("ALL",".+"),e._handlers=[],e._routes=[],e._fallback=!1};return C.VERSION=n,C.Route=t,C.prototype={constructor:C,_delims:null,_patterns:null,_handlers:null,_routes:null,_fallback:!1,dispose:function(){var e,t=this;t._delims=null,t._patterns=null,t._routes=null,t._fallback=null;for(e in t._handlers)t._handlers[e].dispose();return t._handlers=null,t},reset:function(){return this._handlers={},this._routes=[],this._fallback=!1,this},defineDelimiters:function(e){var t,n=this;return e&&(t=e.length,t>0&&e[0]&&(n._delims[0]=e[0]),t>1&&e[1]&&(n._delims[1]=e[1]),t>2&&e[2]&&(n._delims[2]=e[2]),t>3&&e[3]&&(n._delims[3]=e[3])),n},definePattern:function(e,t){return this._patterns[e]=t,this},dropPattern:function(e){return e in this._patterns&&delete this._patterns[e],this},parse:function(e,t,n){var r={};return e&&(arguments.length<3&&(n="fragment_params"),arguments.length<2&&(t="query_params"),r=R(e),t&&(r[t]=r.query?this.unglue(r.query):{}),n&&(r[n]=r.fragment?this.unglue(r.fragment):{})),r},unglue:function(e){var t;return t=e?P(e):{}},build:function(e,t,n,r,o){var i=""+e;return arguments.length<5&&(o="#"),arguments.length<4&&(r="?"),t&&(i+=r+this.glue(t)),n&&(i+=o+this.glue(n)),i},glue:function(e){var t="";return e&&(t+=N(e,"&",!0)),t},redirect:function(e,t,n,o){return e&&(d?t&&(arguments.length<3&&(n=302),arguments.length<4&&(o=!0),o?(!0===o&&(o=r[n]||""),t.writeHead(n,o,{Location:e})):t.writeHead(n,{Location:e}),t.end()):document.location.href=e),this},on:function(){var e,t,n,r=this,o=h(arguments),i=o.length;if(i>=2)e=o,n=e[2]||null,k(r._handlers,r._routes,r._delims,r._patterns,e[0],e[1],n);else if(1===i&&o[0]instanceof Array)for(o=o[0],i=o.length,t=0;i>t;t++)e=o[t],e.length>=2&&(n=e[2]||null,k(r._handlers,r._routes,r._delims,r._patterns,e[0],e[1],n));return r},one:function(){var e,t,n,r=this,o=h(arguments),i=o.length;if(i>=2)e=o,n=e[2]||null,k(r._handlers,r._routes,r._delims,r._patterns,e[0],e[1],n,!0);else if(1===i&&o[0]instanceof Array)for(o=o[0],i=o.length,t=0;i>t;t++)e=o[t],e.length>=2&&(n=e[2]||null,k(r._handlers,r._routes,r._delims,r._patterns,e[0],e[1],n,!0));return r},off:function(e,t){var n,r,o,i=this,l=i._routes,a=i._handlers;if(e&&e in a)if(t&&f(t)){for(r=a[e],o=r.handlers.length,n=o-1;n>=0;n--)t===r.handlers[n][0]&&r.handlers.splice(n,1);r.handlers.length||j(a,l,e)}else j(a,l,e);return i},fallback:function(e){return 1>arguments.length&&(e=!1),(!1===e||null===e||f(e))&&(this._fallback=e),this},route:function(e){var t,n,r,o,i,l,a,s,u,c,h,d,f=this,p=f._routes;if(e)for(o=p.length,r=0;o>r;r++)if(t=p[r],a=e.match(t.pattern)){for(c=t.handlers.slice(0),d=[],i=c.length,l=0;i>l;l++)c[l][2]&&d.push(l);for(i=d.length;--i>=0;)t.handlers.splice(d.pop(),1);for(i=c.length,l=0;i>l;l++){h=c[l],n={};for(s in t.captures)u=t.captures[s],n[s]=a[u]?a[u]:s in h[1]?h[1][s]:null;h[0](e,n)}return!0}return f._fallback?(f._fallback(e,!1),!1):!1}},C});

/**
*
*   ModelView.js
*   @version: 0.26.1
*   @dependencies: jQuery
*
*   A micro-MV* (MVVM) jQuery-based framework for complex (UI) screens
*   https://github.com/foo123/modelview.js
*
**/!function(e,t,n,r,i){"use strict";n=n?[].concat(n):[];var a,l,o=Array,u=o.prototype,s=n.length,c=new o(s);if("object"==typeof module&&module.exports){if(i===module.exports[t]){for(a=0;s>a;a++)c[a]=module.exports[n[a][0]]||require(n[a][1])[n[a][0]];l=r.apply(e,c),module.exports[t]=l||1}}else if("function"==typeof define&&define.amd)define(["exports"].concat(n.map(function(e){return e[1]})),function(a){if(i===a[t]){var o,s=u.slice.call(arguments,1),f=s.length;for(o=0;f>o;o++)c[o]=a[n[o][0]]||s[o];l=r.apply(e,c),a[t]=l||1}});else if(i===e[t]){for(a=0;s>a;a++)c[a]=e[n[a][0]];l=r.apply(e,c),e[t]=l||1}}(this.self||this,"ModelView",[["jQuery","jquery"]],function(e){var t={};return!function(e,t,n){"use strict";var r=function(e,t){return e.bind(t)},i="prototype",a=Array,l=a[i],o=RegExp,u=Number,s=Object,c=s[i],f=s.create,d=s.keys,h=Function,m=h[i],v=String,p=v[i],$=m.call,g=(r($,c.hasOwnProperty),r($,c.toString)),b=r($,l.slice),y=function(e,t){return e instanceof t},k=1/0,w=(Math.random,parseFloat),x=isNaN,R=isFinite,E=JSON.parse,_=JSON.stringify,A=t.Event,D=t.extend;p.trim||(p.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),p.startsWith||(p.startsWith=function(e,t){return t=t||0,e===this.substr(t,e.length+t)}),p.tR=p.trim,p.sW=p.startsWith;var S="*",C="modelview",N=2,O=3,T=4,V=8,M=9,j=16,I=32,P=64,z=128,F=256,B=512,L=1024,H=j|I,W=j|V,U=function(e){var t,r;return null===e?F:!0===e||!1===e?T:(t=typeof e,r=g(e),n===e||"undefined"===t?B:e instanceof u||"number"===t?x(e)?O:N:e instanceof v||"string"===t?1===e.length?M:V:e instanceof a||"[object Array]"===r?j:e instanceof o||"[object RegExp]"===r?z:e instanceof h||"function"===t&&"[object Function]"===r?P:"[object Object]"===r?I:L)},J=function(e,t){return!!(t&U(e))},Q=function(e){return!x(w(e))&&R(e)},X=function(e){return Q(e)&&(e=+e,0===e%1&&e>=0)?!0:!1},Z=function(){var e,t,n,r,i,a,l,o=b(arguments);for(t=o.shift()||{},e=o.length,a=0;e>a;a++)if(n=o[a],I===U(n))for(i in n)r=n[i],l=U(r),t[i]=N&l?0+r:W&l?r.slice(0):r;return t},q=function(e,t){return new h(e,t)},G=function(e,t){return n!==e.attr(t)},Y=function(e,t){if(!e)return null;var n,r,i=[],a=e.length;for(n=0;a>n;n++)r=e[n],r&&(r[t]&&i.push(r[t].next),r[S]&&i.push(r[S].next));return i.length?i:null},K=function(e,t){if(!e)return null;var n,r,i=e.length;if(t){for(n=0;i>n;n++)if(r=e[n]){if(r[t]&&r[t].value)return r[t].value;if(r[S]&&r[S].value)return r[S].value}}else for(n=0;i>n;n++)if(r=e[n],r&&r.value)return r.value;return null},et=function(e,t,n,r){for(var i,a=n;t.length;)i=t.shift(),i in a||(a[i]={value:null,next:{}}),a=a[i],t.length?a=a.next:r?(S in a.next||(a.next[S]={value:null,next:{}}),a.next[S].value=e):a.value=e;return n},tt=function(e,t,n,r){for(var i,a,l=t,o=n?[n]:null;e.length;){if(i=e.shift(),a=U(l),!e.length)return o&&K(o,i)?!0:a&H&&i in l?!0:I===a&&"length"==i?!0:!1;if(a&H&&i in l){if(l=l[i],l instanceof r)return[r,l,e];o&&(o=Y(o,i))}else if(!o||!(o=Y(o,i)))return!1}return!1},nt=function(e,t,n,r){for(var i,a,l=t,o=n?[n]:null;e.length;){if(i=e.shift(),a=U(l),!e.length)return o&&(o=K(o,i))?[!1,o]:a&H&&i in l?[!0,l[i]]:I===a&&"length"==i?[!0,d(l).length]:!1;if(a&H&&i in l){if(l=l[i],l instanceof r)return[r,l,e];o&&(o=Y(o,i))}else if(!o||!(o=Y(o,i)))return!1}return!1},rt=function(e,t,n,r,i,a,l){var o,u,s=t,c=null,f=null,d=null;for(l=!1!==l,l&&(c=[n],f=[r],d=[i]);e.length;)if(o=e.shift(),u=U(s),e.length){if(!(u&H&&o in s))return[!1,s,o,e,null,null,null];if(s=s[o],s instanceof a)return[a,s,e,0,null,null,null];l&&(c=Y(c,o),f=Y(f,o),d=Y(d,o))}else if(u&H)return s[o]instanceof a?[a,s[o],e,0,null,null,null]:o in s?[!0,s,o,e,c,f,d]:[!1,s,o,e,c,f,d];return[!1,s,o,e,null,null,null]},it=function(){return(new Date).getTime()},at=0,lt=function(e){return[e||"UUID",++at,it()].join("_")},ot=function(e,t){var n=[e||"",C];return t&&(n=n.concat(t)),n.join(".")},ut={$PB:null,namespace:null,initPubSub:function(){var e=this;return e.$PB=t({}),e},disposePubSub:function(){var e=this;return e.$PB.off(ot("")),e.$PB=null,e},trigger:function(e,t,n){var r=this;return r.namespace&&(n=n?[r.namespace].concat(n):[r.namespace]),r.$PB.trigger(ot(e,n),t),r},on:function(e,t,n){var r=this;return J(t,P)&&(r.namespace&&(n=n?[r.namespace].concat(n):[r.namespace]),r.$PB.on(ot(e,n),t)),r},onTo:function(e,t,n,i){var a=this;return J(n,P)&&(n=r(n,a)),e.on(t,n,i),a},off:function(e,t,n){var r=this;return r.namespace&&(n=n?[r.namespace].concat(n):[r.namespace]),J(t,P)?r.$PB.off(ot(e,n),t):r.$PB.off(ot(e,n)),r},offFrom:function(e,t,n,i){var a=this;return J(n,P)&&(n=r(n,a)),e.off(t,n,i),a}};ut.publish=ut.trigger;var st=function(e,t){var n=this,r=arguments.length;n.$store={},n.$size=k,n.$interval=k,r>0&&e>0&&(n.$size=e),r>1&&t>0&&(n.$interval=t)};st[i]={constructor:st,$store:null,$size:null,$interval:null,dispose:function(){var e=this;return e.$store=null,e.$size=null,e.$interval=null,e},reset:function(){return this.$store={},this},size:function(e){return arguments.length?(e>0&&(this.$size=e),this):this.$size},interval:function(e){return arguments.length?(e>0&&(this.$interval=e),this):this.$interval},has:function(e){var t=this,n=e?t.$store[e]:null;return!!(n&&it()-n.time<=t.$interval)},get:function(e){if(e){var t=this,r=t.$store[e];if(r)return it()-r.time>t.$interval?(delete t.$store[e],n):r.data}return n},set:function(e,t){var n,r,i,a=this;if(e){for(n=a.$store,r=a.$size,i=d(n);i.length>=r;)delete n[i.shift()];n[e]={data:t,time:it()}}return a},del:function(e){return e&&this.$store[e]&&delete this.$store[e],this},toString:function(){return"[ModelView.Cache]"}};var ct=function(e){return e.replace(/\[([^\]]*)\]/g,".$1").replace(/^\.+/,"").replace(/\.+$/,"")},ft=function(e){return"["+e.split(".").join("][")+"]"},dt=function(e){var t=new o("^"+e+"([\\.|\\[])");return function(e,n){var r=e.replace(t,"$1");return n?ct(r):r}},ht=function(e){return y(this,ht)?void(this.f=e||null):new ht(e)},mt=function(e){return y(this,mt)?void(this.f=e||null):new mt(e)},vt=function(e,t){var n,i;for(n in t)i=t[n],y(i,mt)?(t[n]=r(i.f,e),t[n].fEach=!0):t[n]=r(i,e);return t},pt=function(e){return e.BEFORE=function(t){return pt(function(n,r){var i=this;return t.call(i,e.call(i,n,r),r)})},e.AFTER=function(t){return pt(function(n,r){var i=this;return e.call(i,t.call(i,n,r),r)})},e},$t=function(e){return e.NOT=function(){return $t(function(t,n){return!e.call(this,t,n)})},e.AND=function(t){return $t(function(n,r){var i=this;return e.call(i,n,r)&&t.call(i,n,r)})},e.OR=function(t){return $t(function(n,r){var i=this;return e.call(i,n,r)||t.call(i,n,r)})},e.XOR=function(t){return $t(function(n,r){var i=this,a=e.call(i,n,r),l=t.call(i,n,r);return a&&!l||l&&!a})},e},gt={TypeCaster:pt,Cast:{EACH:mt,FIELDS:function(e){var t=!0;return e=D({},e||{}),pt(function(n){var r,i,a,l,o;t&&(vt(this,e),t=!1);for(r in e)if(i=e[r],a=n[r],i.fEach&&J(a,j)){for(l=a.length,o=0;l>o;o++)a[o]=i(a[o]);n[r]=a}else n[r]=i(a);return n})},DEFAULT:function(e){return pt(function(t){var n=U(t);return(B&n||V&n&&!t.tR().length)&&(t=e),t})},BOOL:pt(function(e){return!!e}),INT:pt(function(e){return parseInt(e,10)}),FLOAT:pt(function(e){return parseFloat(e,10)}),MIN:function(e){return pt(function(t){return e>t?e:t})},MAX:function(e){return pt(function(t){return t>e?e:t})},CLAMP:function(e,t){if(e>t){var n=t;t=e,e=n}return pt(function(n){return e>n?e:n>t?t:n})},TRIM:pt(function(e){return v(e).tR()}),LCASE:pt(function(e){return v(e).toLowerCase()}),UCASE:pt(function(e){return v(e).toUpperCase()}),STR:pt(function(e){return""+e})},add:function(e,t){return J(e,V)&&J(t,P)&&(gt.Cast[e]=pt(t)),gt},del:function(e){return J(e,V)&&gt.Cast[e]&&delete gt.Cast[e],gt},toString:function(){return"[ModelView.Type]"}},bt={Validator:$t,Validate:{EACH:mt,FIELDS:function(e){var t=!0;return e=D({},e||{}),$t(function(n){var r,i,a,l,o;t&&(vt(this,e),t=!1);for(r in e)if(i=e[r],a=n[r],i.fEach&&J(a,j)){for(l=a.length,o=0;l>o;o++)if(!i(a[o]))return!1}else if(!i(a))return!1;return!0})},NUMERIC:$t(function(e){return Q(e)}),NOT_EMPTY:$t(function(e){return!!(e&&0<v(e).tR().length)}),MAXLEN:function(e){return $t(q("v","return v.length <= "+e+";"))},MINLEN:function(e){return $t(q("v","return v.length >= "+e+";"))},MATCH:function(e){return $t(function(t){return e.test(t)})},NOT_MATCH:function(e){return $t(function(t){return!e.test(t)})},EQUAL:function(e,t){return $t(y(e,ht)?q("v","return this.$data."+e.f+" "+(!1!==t?"===":"==")+" v;"):!1!==t?function(t){return e===t}:function(t){return e==t})},NOT_EQUAL:function(e,t){return $t(y(e,ht)?q("v","return this.$data."+e.f+" "+(!1!==t?"!==":"!=")+" v;"):!1!==t?function(t){return e!==t}:function(t){return e!=t})},GREATER_THAN:function(e,t){return y(e,ht)?e="this.$data."+e.f:J(e,V)&&(e='"'+e+'"'),$t(q("v","return "+e+" "+(!1!==t?"<":"<=")+" v;"))},LESS_THAN:function(e,t){return y(e,ht)?e="this.$data."+e.f:J(e,V)&&(e='"'+e+'"'),$t(q("v","return "+e+" "+(!1!==t?">":">=")+" v;"))},BETWEEN:function(e,t,n){J(e,j)&&(n=t,t=e[1],e=e[0]);var r,i=y(e,ht),a=y(t,ht);return!i&&!a&&e>t&&(r=t,t=e,e=r),e=i?"this.$data."+e.f:J(e,V)?'"'+e+'"':e,t=a?"this.$data."+t.f:J(t,V)?'"'+t+'"':t,$t(!1!==n?q("v","return ( "+e+" < v ) && ( "+t+" > v );"):q("v","return ( "+e+" <= v ) && ( "+t+" >= v );"))},NOT_BETWEEN:function(e,t,n){J(e,j)&&(n=t,t=e[1],e=e[0]);var r,i=y(e,ht),a=y(t,ht);return!i&&!a&&e>t&&(r=t,t=e,e=r),e=i?"this.$data."+e.f:J(e,V)?'"'+e+'"':e,t=a?"this.$data."+t.f:J(t,V)?'"'+t+'"':t,$t(!1!==n?q("v","return ( "+e+" > v ) || ( "+t+" < v );"):q("v","return ( "+e+" >= v ) || ( "+t+" <= v );"))},IN:function(){var e=b(arguments);return J(e[0],j)&&(e=e[0]),$t(function(t){return-1<e.indexOf(t)})},NOT_IN:function(){var e=b(arguments);return J(e[0],j)&&(e=e[0]),$t(function(t){return 0>e.indexOf(t)})}},add:function(e,t){return J(e,V)&&J(t,P)&&(bt.Validate[e]=$t(t)),bt},del:function(e){return J(e,V)&&bt.Validate[e]&&delete bt.Validate[e],bt},toString:function(){return"[ModelView.Validation]"}},yt=function(e,t,n,i){var a,l,o=!1;if(l=U(n),P&l)o=y(n,mt),n=o?r(n.f,e):r(n,e),et(n,-1<t.indexOf(".")?t.split("."):[t],i,o);else if(H&l)for(a in n)yt(e,t+"."+a,n[a],i)},kt=function(e,t,n,i){var a,l;if(l=U(n),P&l)et(r(n,e),-1<t.indexOf(".")?t.split("."):[t],i);else if(H&l)for(a in n)kt(e,t+"."+a,n[a],i)},wt=function(e,t,n){for(var r,i;t instanceof e;)t=t.data();if(i=n||U(t),t=I&i?D({},t):j&i?t.slice(0):t,H&i)for(r in t)t[r]instanceof e?t[r]=wt(e,D({},t[r].data())):H&(i=U(t[r]))&&(t[r]=wt(e,t[r],i));return t},xt=function(e,t,n,r,i,a){var l=this;return l instanceof xt?(l.namespace=l.id=e||lt("Model"),l.key=dt(l.id),l.$view=null,l.atomic=!1,l.$atom=null,l.$types={},l.$validators={},l.$getters={},l.$setters={},void l.data(t||{}).types(n).validators(r).getters(i).setters(a).initPubSub()):new xt(e,t,n,r,i,a)};xt[i]=Z(f(s[i]),ut,{constructor:xt,id:null,$view:null,$data:null,$types:null,$validators:null,$getters:null,$setters:null,atomic:!1,$atom:null,dispose:function(){var e=this;return e.disposePubSub().$view=null,e.$data=null,e.$types=null,e.$validators=null,e.$getters=null,e.$setters=null,e.atomic=!1,e.$atom=null,e.key=null,e},isValid:function(){return!0},view:function(e){var t=this;return arguments.length?(t.$view=e,t):t.$view},data:function(e){var t=this;return arguments.length?(t.$data=e,t):t.$data},types:function(e){var t,n=this;if(J(e,I))for(t in e)yt(n,t,e[t],n.$types);return n},validators:function(e){var t,n=this;if(J(e,I))for(t in e)yt(n,t,e[t],n.$validators);return n},getters:function(e){var t,n=this;if(J(e,I))for(t in e)kt(n,t,e[t],n.$getters);return n},setters:function(e){var t,n=this;if(J(e,I))for(t in e)kt(n,t,e[t],n.$setters);return n},serialize:function(){return wt(xt,this.$data)},toJSON:function(e){var t,n,r,i=this;n=arguments.length?i.get(e):i.data();try{t=_(wt(xt,n))}catch(r){throw r}return t},fromJSON:function(e,t){var n,r,i=this;if(e){try{n=E(e)}catch(r){throw r}t?i.set(t,n):i.data(n)}return i},count:function(e,t){if(!arguments.length)return 0;var n=e?this.get(e):t,r=U(n);return I===r?d(n).length:j===r?n.length:B!==r?1:0},has:function(e,t){var n,r=this;return 0>e.indexOf(".")&&(e in r.$data||!t&&(n=r.$getters[e])&&n.value)?!0:(n=tt(e.split("."),r.$data,t?null:r.$getters,xt))?!0===n?!0:n[1].has(n[2].join(".")):!1},get:function(e,t){var r,i=this;return 0>e.indexOf(".")?!t&&(r=i.$getters[e])&&r.value?r.value(e):i.$data[e]:(r=nt(e.split("."),i.$data,t?null:i.$getters,xt))?xt===r[0]?r[1].get(r[2].join("."),t):!1===r[0]?r[1](e):r[1]:n},set:function(e,t,n,r){var i,a,l,o,u,s,c,f,d,h,m=this,v=!1;if(m.atomic&&e.sW(m.$atom))return m;if(a=m.$data,c=m.$types,f=m.$validators,d=m.$setters,0>e.indexOf("."))l=e,s=(i=d[l])?i.value:null,o=(i=c[l]||c[S])?i.value:null,u=(i=f[l]||f[S])?i.value:null,v=!0;else if(i=rt(e.split("."),a,c,f,d,xt)){if(a=i[1],l=i[2],o=K(i[4],l),u=K(i[5],l),s=K(i[6],l),xt===i[0])return l.length?(l=l.join("."),h=a.get(l),h!==t?a.set(l,t,n,r):n=!1):(h=a.data(),h!==t?a.data(t):n=!1),n&&m.publish("change",{model:m,key:e,value:t,valuePrev:h,$callData:r}),m;if(!s&&!1===i[0]&&i[3].length)return m;v=!0}if(v){if(o&&(t=o(t,e)),u&&!u(t,e))return n&&(r&&(r.error=!0),m.publish("error",{model:m,key:e,value:a[l],$callData:r})),m;if(s)return s(e,t)&&(n&&m.publish("change",{model:m,key:e,value:t,$callData:r}),m.$atom&&e===m.$atom&&(m.atomic=!0)),m;h=a[l],h!==t&&(a[l]=t,n&&m.publish("change",{model:m,key:e,value:t,valuePrev:h,$callData:r}),m.$atom&&e===m.$atom&&(m.atomic=!0))}return m},append:function(e,t,r,i){var a,l,o,u,s,c,f=this,d=!1;if(f.atomic&&e.sW(f.$atom))return f;if(l=f.$data,types=f.$types,validators=f.$validators,setters=f.$setters,0>e.indexOf("."))o=e,c=(a=setters[o])&&a.next[S]?a.next[S].value:null,u=(a=types[o]||types[S])&&a.next[S]?a.next[S].value:null,s=(a=validators[o]||validators[S])&&a.next[S]?a.next[S].value:null,d=!0;else if(a=rt(e.split("."),l,types,validators,setters,xt)){if(l=a[1],o=a[2],u=K(Y(a[4],o),S),s=K(Y(a[5],o),S),c=K(Y(a[6],o),S),xt===a[0])return o.length?(o=o.join("."),l.append(o,t,r,i)):l.data(t),r&&f.publish("change",{model:f,key:e,value:t,$callData:i}),f;if(!c&&!1===a[0]&&a[3].length)return f;d=!0}if(d){if(u&&(t=u(t,e)),s&&!s(t,e))return r&&(i&&(i.error=!0),f.publish("error",{model:f,key:e,value:n,$callData:i})),f;if(c)return c(e,t)&&(r&&f.publish("change",{model:f,key:e,value:t,$callData:i}),f.$atom&&e===f.$atom&&(f.atomic=!0)),f;j===U(l[o])?l[o].push(t):l[o]=t,r&&f.publish("change",{model:f,key:e,value:t,$callData:i}),f.$atom&&e===f.$atom&&(f.atomic=!0)}return f},del:function(e,t,n){var r,i,a,l,o=this,u=!1;if(o.atomic&&e.sW(o.$atom))return o;if(i=o.$data,0>e.indexOf("."))a=e,u=!0;else if(r=rt(e.split("."),i,null,null,null,xt,!1)){if(i=r[1],a=r[2],xt===r[0]&&a.length)return a=a.join("."),l=i.get(a),i.del(a,t,n),t&&o.publish("remove",{model:o,key:e,value:l,$callData:n}),o.$atom&&e===o.$atom&&(o.atomic=!0),o;if(r[3].length)return o;u=!0}return u&&(l=i[a],delete i[a],t&&o.publish("remove",{model:o,key:e,value:l,$callData:n}),o.$atom&&e===o.$atom&&(o.atomic=!0)),o},rem:function(e,t,r){var i,a,l,o,u,s=this,c=!1;if(s.atomic&&e.sW(s.$atom))return s;if(a=s.$data,0>e.indexOf("."))l=e,c=!0;else if(i=rt(e.split("."),a,null,null,null,xt,!1)){if(a=i[1],l=i[2],xt===i[0]&&l.length)return l=l.join("."),o=a.get(l),a.rem(l,t,r),t&&s.publish("remove",{model:s,key:e,value:o,$callData:r}),s.$atom&&e===s.$atom&&(s.atomic=!0),s;if(i[3].length)return s;c=!0}return c&&(o=a[l],a[l]=n,u=U(a),j==u&&X(l)?a.splice(+l,1):I==u&&delete a[l],t&&s.publish("remove",{model:s,key:e,value:o,$callData:r}),s.$atom&&e===s.$atom&&(s.atomic=!0)),s},notify:function(e,t,n){return e&&this.publish(t||"change",{model:this,key:e,$callData:n}),this},atom:function(e){var t=this;return n!==e&&(!1===e?(t.atomic=!1,t.$atom=null):(t.atomic=!1,t.$atom=e)),t},toString:function(){return"[ModelView.Model id: "+this.id+"]"}});var Rt=function(e,t,n){return[e?"["+e+"]":null,t?n?'input[name="'+t+'"],textarea[name="'+t+'"],select[name="'+t+'"]':'input[name^="'+t+'"],textarea[name^="'+t+'"],select[name^="'+t+'"]':null]},Et=function(e,t){return t&&t[e]?(J(t[e],V)&&(t[e]={action:t[e]}),t[e]):void 0},_t=function(e,n,r,i){var a=e.$model,l="sync"==r.type,o=l?"change":r.type;n.each(function(){var n,l,u,s,c=t(this);n=Et(o,e.attr(c,"bind")),n&&n.action&&(l="do_"+n.action,J(e[l],P)&&(u=c.attr("name"),s=n.key||u&&a.key(u,1),i&&(!s||!s.sW(i.key)||a.atomic&&s.sW(a.$atom))||e[l](r,c,n)))})},At=function(e,n,r){{var i=e.$model,a={},l="sync"==r.type;l?"change":r.type}n.each(function(){var n,l=t(this),o=l.attr("name"),u=o?i.key(o,1):0;if(u){if(a[u])n=a[u][0];else{if(!i.has(u))return;a[u]=[n=i.get(u)]}e.do_bind(r,l,{name:o,key:u,value:n})}})},Dt=function(e,t,n,r,i){var a=this;return a instanceof Dt?(a.namespace=a.id=e||lt("View"),a.$atts=n||{bind:"data-bind"},r=r||Dt._CACHE_SIZE,i=i||Dt._REFRESH_INTERVAL,a.$memoize=new st(r,i),a.$selectors=new st(r,i),a.$bind=a.attribute("bind"),void a.model(t||new xt).initPubSub()):new Dt(e,t,n,r,i)};Dt._CACHE_SIZE=600,Dt._REFRESH_INTERVAL=k,Dt[i]=Z(f(s[i]),ut,{constructor:Dt,id:null,$dom:null,$bind:null,$model:null,$bindbubble:!1,$autobind:!1,$template:null,$atts:null,$memoize:null,$selectors:null,dispose:function(){var e=this;return e.unbind().disposePubSub(),e.$model&&e.$model.dispose(),e.$model=null,e.$dom=null,e.$bind=null,e.$template=null,e.$atts=null,e.$memoize.dispose(),e.$memoize=null,e.$selectors.dispose(),e.$selectors=null,e},model:function(e){var t=this;return arguments.length?(t.$model&&t.$model.dispose(),t.$model=e.view(t),t):t.$model},attribute:function(e,t){var r=this;return arguments.length>1?(r.$atts[e]=t,r):e?r.$atts[e]||n:n},template:function(e){var t=this;return arguments.length?(J(e,P)&&(t.$template=e),t):t.$template},event:function(e,t){var r=this,i=e?"on_"+e.split(":").join("_"):null;return i&&n!==t?(r[i]=J(t,P)?t:null,r):i?r[i]:n},action:function(e,t){var n=this,r=e&&"do_"+e;return arguments.length>1?(n[r]=J(t,P)?t:null,n):r&&n[r]},bindbubble:function(e){var t=this;return arguments.length?(t.$bindbubble=!!e,t):t.$bindbubble},autobind:function(e){var t=this;return arguments.length?(t.$autobind=!!e,t):t.$autobind},get:function(e,n,r){var i,a=this,l=a.$selectors;return n=n?t(n):a.$dom,r?n.find(e):(i=l.get(e),i||l.set(e,i=n.find(e)),i)},attr:function(e,t){var r,i,a=this,l=a.$atts[t],o=a.$memoize;return l&&G(e,l)?(l=e.attr(l),r=o.get(l),n===r&&(r=E(l),r.set&&(r.click=r.set,r.click.action="set",r.set=n,delete r.set),r.show&&(r.change={action:"show",key:r.show},r.show=n,delete r.show),r.hide&&(r.change={action:"hide",key:r.hide},r.hide=n,delete r.hide),r.html?(r.change={action:"html",key:r.html},r.html=n,delete r.html,r.text=n,delete r.text):r.text&&(r.change={action:"html",key:r.text,text:1},r.text=n,delete r.text),r.css&&(r.change={action:"css",css:r.css},r.css=n,delete r.css),r.value&&(r.change&&"prop"==r.change.action?r.change.prop.value=r.value:r.change={action:"prop",prop:{value:r.value}},r.value=n,delete r.value),r.checked&&(r.change&&"prop"==r.change.action?r.change.prop.checked=r.checked:r.change={action:"prop",prop:{checked:r.checked}},r.checked=n,delete r.checked),r.disabled&&(r.change&&"prop"==r.change.action?r.change.prop.disabled=r.disabled:r.change={action:"prop",prop:{disabled:r.disabled}},r.disabled=n,delete r.disabled),r.options&&(r.change&&"prop"==r.change.action?r.change.prop.options=r.options:r.change={action:"prop",prop:{options:r.options}},r.options=n,delete r.options),r["class"]&&(r.change&&"prop"==r.change.action?r.change.prop["class"]=r["class"]:r.change={action:"prop",prop:{"class":r["class"]}},r["class"]=n,delete r["class"]),(i=r.change)&&(!i.domRef&&r.domRef&&(i.domRef=r.domRef),!i.key&&r.key&&(i.key=r.key)),o.set(l,r)),r):n},getDomRef:function(e,n){return n&&"$this::"==n.slice(0,7)?t(n.slice(7),e):t(n)},bind:function(e,n){var r,i,a,l=this,o=l.$model,u=Rt(l.$bind,o.id+"["),s=u[0],c=u[1],f=/^on_model_/;e=e||["change","click"],l.$dom=t(n||window.document),l.on_view_change&&e.length&&(a=function(e){return ot(e,l.namespace)},l.$dom.on(e.map(a).join(" "),[c,s].join(","),function(e){var n=this,r=t(n),i=!1,a=!1,o=l.$bindbubble?l.attr(r,"bind"):null;return(e.target===n||o&&o.bubble)&&(a=l.$bindbubble?!!o:r.is(s),i=l.$autobind&&"change"==e.type&&r.is(c),(a||i)&&l.on_view_change(e,{$el:r,isBind:a,isAutoBind:i})),!0}));for(r in l)J(l[r],P)&&f.test(r)&&(i=r.replace(f,""),i.length&&l.onTo(o,i,l[r],l.namespace));return l},unbind:function(e,n){var r,i,a=this,l=a.$model,o=Rt(a.$bind,l.id+"[");return e=e||null,i=n?t(n):a.$dom,a.on_view_change&&(r=function(e){return ot(e,a.namespace)},i.off(e&&e.length?e.map(r).join(" "):ot("",a.namespace),[o[1],o[0]].join(","))),a.offFrom(l,"",null,a.namespace),a},rebind:function(e,t){var n=this;return n.$memoize.reset(),n.$selectors.reset(),n.unbind().bind(e,t)},sync:function(e){var n=this,r=Rt(n.$bind,n.$model.id+"["),i=A("sync");return e=e?t(e):n.$dom,_t(n,n.get(r[0],e,1),i),n.$autobind&&At(n,n.get(r[1],e,1),i),n},reset:function(){var e=this;return e.$memoize.reset(),e.$selectors.reset(),e},on_view_change:function(e,n){var r,i,a,l,o,u=this,s=u.$model,c=n.$el,f={};n.isAutoBind&&c.attr("name")&&(i=s.key(r=c.attr("name"),1),i&&s.has(i)&&(l=c.is(":checkbox"),l?(o=u.get('input[type="checkbox"][name="'+r+'"]'),o.length>1?(a=[],o.each(function(){var e=t(this);a.push(e.is(":checked")?e.val():"")})):a=o.is(":checked")?o.val():""):a=c.val(),f.$trigger=c,s.set(i,a,1,f))),!f.error&&n.isBind&&_t(u,c,e),u.publish("change",n)},on_model_change:function(e,t){var n,r,i=this,a=i.$model,l=Rt(i.$bind,a.id+ft(t.key)),o=i.$autobind;n=i.get(l[0]),o&&(r=i.get(l[1])),t.$callData&&t.$callData.$trigger&&(n=n.not(t.$callData.$trigger),o&&(r=r.not(t.$callData.$trigger)),t.$callData=null),_t(i,n,e,t),o&&r.length&&At(i,r,e,t)},on_model_error:function(e,t){var n=this,r=n.$model,i=Rt(n.$bind,r.id+ft(t.key));_t(n,n.get(i[0]),e,t),n.$autobind&&At(n,n.get(i[1]),e,t)},do_nop:null,do_prop:function(e,t,n){if(J(n.prop,I)){var r,i,a,l,o,u=this,s=u.$model,c=n.prop;if(n.domRef&&(t=u.getDomRef(t,n.domRef)),t.length){r={};for(i in c)if(a=c[i],s.has(a))switch(l=s.get(a),o=U(l),i){case"value":t.val(l);break;case"options":if(t.is("select")&&j===o){var f,d,h=l.length,m="",v=t.find("optgroup");for(f=t.val(),v.length||(v=t),v.find("option").remove(),d=0;h>d;d++)m+=l[d]&&l[d].label?'<option value="'+l[d].value+'">'+l[d].label+"</option>":'<option value="'+l[d]+'">'+l[d]+"</option>";v.append(m),t.val(f)}break;case"class":if(l&&l.length){var p,$=l.charAt(0);"-"==$?t.removeClass(l.slice(1)):"+"==$?t.addClass(l.slice(1)):(p=t.hasClass(l))?t.removeClass(l):p||t.addClass(l)}break;case"checked":T===o?t.prop(i,l):l==t.val()?t.prop(i,!0):t.prop(i,!1);break;case"disabled":T===o?t.prop(i,l):l==t.val()?t.prop(i,!0):t.prop(i,!1);break;default:r[i]=l}t.attr(r)}}},do_html:function(e,t,n){if(n.key){var r,i=this,a=i.$model,l=n.key;n.domRef&&(t=i.getDomRef(t,n.domRef)),t.length&&l&&a.has(l)&&(r=a.get(l),n.text?t.text(r):t.html(r))}},do_css:function(e,t,n){if(J(n.css,I)){var r,i,a,l,o=this,u=o.$model,s=n.css;if(n.domRef&&(t=o.getDomRef(t,n.domRef)),t.length){l={};for(i in s)r=s[i],a=u.get(r),a&&(l[i]=a);t.css(l)}}},do_set:function(e,t,n){var r,i=this,a=i.$model,l=n.key||a.key(t.attr(name),1);l&&("value"in n?r=n.value:(n.domRef&&(t=i.getDomRef(t,n.domRef)),r=t.is("input,select,textarea")?t.val():t.text()),a.set(l,r,1))},do_tpl:function(e,t,n){var r,i,a,l=this,o=n.key,u=n.tpl;l.$template&&o&&u&&(n.domRef&&(t=l.getDomRef(t,n.domRef)),t.length&&(r=l.$model,o&&r.has(o)&&(i=n.mode||"replace","replace"==i&&t.empty(),a=l.$template(u,r.get(o)),a&&t.append(a))))},do_show:function(e,t,n){var r=this,i=r.$model,a=n.key;n.domRef&&(t=r.getDomRef(t,n.domRef)),t.length&&a&&("value"in n?n.value===i.get(a)?t.show():t.hide():i.get(a)?t.show():t.hide())},do_hide:function(e,t,n){var r=this,i=r.$model,a=n.key;n.domRef&&(t=r.getDomRef(t,n.domRef)),t.length&&a&&("value"in n?n.value===i.get(a)?t.hide():t.show():i.get(a)?t.hide():t.show())},do_bind:function(e,n,r){var i,a,l,o=this,u=(o.$model,r.name),s=r.key;if(s)if(i=r.value,a=U(i),l=n.val(),n.is(":radio"))i==l&&(o.get('input[name="'+u+'"]').not(n).prop("checked",!1),n.prop("checked",!0));else if(n.is(":checkbox")){var c=o.get('input[type="checkbox"][name="'+u+'"]');c.length>1&&j===a?c.each(function(){var e=t(this);t.inArray(e.val(),i)>-1?e.prop("checked",!0):e.prop("checked",!1)}):T===a?n.prop("checked",i):i==l?n.prop("checked",!0):n.prop("checked",!1)}else n.val(i)},toString:function(){return"[ModelView.View id: "+this.id+"]"}}),e.ModelView={VERSION:"0.26.1",UUID:lt,Extend:Z,Field:ht,Type:gt,Validation:bt,Cache:st,Model:xt,View:Dt}}(t,e),!function(e,t){"use strict";var n=Function.prototype.call.bind(Array.prototype.slice),r=t.extend,i=e.View,a=e.Model,l={id:"model",data:{},types:{},validators:{},getters:{},setters:{}},o={viewClass:i,modelClass:a,id:"view",autobind:!1,bindbubble:!1,bindAttribute:"data-bind",cacheSize:i._CACHE_SIZE,refreshInterval:i._REFRESH_INTERVAL,model:null,template:null,events:null,actions:{},handlers:{}};t.ModelView=e,t.fn.modelview=function(e){var i=n(arguments),u=i.length?i.shift():null,s=!0,c=!1,f=[];return this.each(function(){var n,d,h,m=t(this);if(m.data("modelview")){if(s=!1,d=m.data("modelview"),n=d.$model,"view"===u)f.push(d);else if("model"===u){if(i.length)return n.apply(d,i),this;f.push(n)}else if("data"===u){if(i.length)return n.data.apply(d.$model,i),this;f.push(n.data())}else"dispose"===u?(m.data("modelview",null),d.dispose()):"sync"===u?d.sync.apply(d,i):"refresh"===u&&d.refresh.apply(d,i);return this}if(c||(e=r({},o,e),!e.model||e.model instanceof a||(e.model=r({},l,e.model)),c=!0),!e.model)return this;if(n=e.model instanceof a?e.model:new e.modelClass(e.model.id,e.model.data,e.model.types,e.model.validators,e.model.getters,e.model.setters),d=new e.viewClass(e.id,n,{bind:e.bindAttribute||"data-bind"},e.cacheSize,e.refreshInterval),e.template&&d.template(e.template),e.handlers)for(var v in e.handlers)h=e.handlers[v],h&&d.event(v,h);if(e.actions)for(var p in e.actions)h=e.actions[p],h&&d.action(p,h);m.data("modelview",d),d.bindbubble(e.bindbubble).autobind(e.autobind).bind(e.events,m)}),!s&&f.length?1==this.length?f[0]:f:this}}(t.ModelView,e),t.ModelView});
