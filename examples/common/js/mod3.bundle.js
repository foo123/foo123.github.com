/**
*
*   Classy.js
*   @version: 0.9.3
*   @built on 2016-07-19 17:09:27
*
*   Object-Oriented micro-framework for JavaScript
*   https://github.com/foo123/classy.js
*
**/!function(e,n,i){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=i.call(e)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return i.moduleUri=n.uri,i.call(e)}):n in e||(e[n]=i.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[n]})}(this,"Classy",function(){"use strict";var e=void 0,n="constructor",i="prototype",t="__proto__",r="__static__",l="__private__",u="$super",a="$static",o="$latestatic",f="$class",c=2,s=4,b=8,d=256,m=Object,p=m[i],v=Function,g=v[i],h=String,y=Number,x=RegExp,w=Array,j=p.toString,E=(g.call.bind(g.toString),"hasOwnProperty"),_="propertyIsEnumerable",q=m.keys,I=m.defineProperty,$=function(e){return typeof e},A=function(e){throw new TypeError(e)},P=2,S=3,T=4,C=8,M=9,N=16,O=32,R=64,F=128,L=256,U=512,V=1024,k={"[object Array]":N,"[object RegExp]":F,"[object Number]":P,"[object String]":C,"[object Function]":R,"[object Object]":O},B=function(n){var i;return null===n?L:!0===n||!1===n?T:e===n?U:(i=j.call(n),i=k[i]||V,P===i||n instanceof y?isNaN(n)?S:P:C===i||n instanceof h?1===n.length?M:C:N===i||n instanceof w?N:F===i||n instanceof x?F:R===i||n instanceof v?R:O===i?O:V)},D=function(e,n){var i,t=n.length,r=[].concat(e);for(i=0;t>i;i++)-1<r.indexOf(n[i])||r.push(n[i]);return r},z=function(e,n){O!==B(e)&&A("bad desc");var i={};if(e[E]("enumerable")&&(i.enumerable=!!n.enumerable),e[E]("configurable")&&(i.configurable=!!n.configurable),e[E]("value")&&(i.value=n.value),e[E]("writable")&&(i.writable=!!e.writable),e[E]("get")){var t=e.get;R!==B(t)&&"undefined"!==t&&A("bad get"),i.get=t}if(e[E]("set")){var r=e.set;R!==B(r)&&"undefined"!==r&&A("bad set"),i.set=r}return("get"in i||"set"in i)&&("value"in i||"writable"in i)&&A("identity-confused descriptor"),i},G=m.defineProperties||function(e,n){"object"===$(e)&&null!==e||A("bad obj"),n=m(n);for(var i=q(n),t=[],r=0;r<i.length;r++)t.push([i[r],z(n[i[r]],e)]);for(var r=0;r<t.length;r++)I(e,t[r][0],t[r][1]);return e},H=function(){},J=m.create||function(e,n){var r,l=function(){};return l[i]=e,r=new l,r[t]=e,"object"===$(n)&&G(r,n),r},K=function(){var e,n,i,t,r,l,u,a=arguments;for(n=a[0]||{},e=a.length,l=1;e>l;l++)if(i=a[l],O===B(i))for(r in i)i[E](r)&&i[_](r)&&(t=i[r],u=B(t),P&u?n[r]=0+t:(C|N)&u?n[r]=t.slice(0):n[r]=t);return n},Q=function(e,i,t){var r,l,u=!!i;if(u||t)if(r={},i=u?i+"$":i,t&&R===B(t))for(l in e)e[E](l)&&(n!==l?(u&&R===B(e[l])&&(r[i+l]=e[l]),r[t(l,e[l])]=e[l]):r[l]=e[l]);else for(l in e)e[E](l)&&(n!==l?(u&&R===B(e[l])&&(r[i+l]=e[l]),t&&l in t?r[t[l]]=e[l]:r[l]=e[l]):r[l]=e[l]);else r=e;return r},W=function(e){var n=e[u]||H,i=e[u+"v"]||H,t=null;return[function(i,r,l,u,a,o,f,c,s,b,d){var m,p;return t===i?m=n.call(this,i,r,l,u,a,o,f,c,s,b,d):(p=e[i])&&(t=i,m=p.call(this,r,l,u,a,o,f,c,s,b,d),t=null),m},function(n,r){var l,u;return t===n?l=i.call(this,n,r):(u=e[n])&&(t=n,l=r&&r.length?u.apply(this,r):u.call(this),t=null),l}]},X=function(e,n){return this instanceof X?(this.factory=e,void(this.qualifier=(P===B(n)?n:0)|c)):new X(e,n)},Y=function(e,n){return this instanceof Y?(this.prop=e,void(this.qualifier=(P===B(n)?n:0)|c)):new Y(e,n)},Z=function(t,c,p,v){t=t||m,c=c||{};var g,h,y,x,w,j,_,I,$,A,S=t[a]||null,T=t[o]||{},M=t[i],F=null,L=K({},T),U=null,V={};c[E](n)||(c[n]=function(){}),g=c[n],c[E](l)&&(V=c[l]||{},delete c[l]),c[E](r)&&(F=c[r],U=q(F),delete c[r]);for($ in c)if(c[E]($)){if(A=c[$],A instanceof X){if(b&A.qualifier){d&A.qualifier?L[$]=A:((F=F||{})[$]=A.factory(t,V,g),(U=U||[]).push($)),delete c[$];continue}if(s&A.qualifier){V[$]=A,delete c[$];continue}A=c[$]=A.factory(M,V,g)}R===B(A)&&(A[u]=M[$]||H)}for($ in V)V[E]($)&&(A=V[$],A instanceof X&&(A=V[$]=A.factory(M,V,g)),R!==B(A)&&delete V[$]);if(g[i]=Q(J(M),p,v),g[i]=K(g[i],c),h=W(M),w={},w[f]=w[n]={value:g,enumerable:!1,writable:!0,configurable:!0},w[u]={value:h[0],enumerable:!1,writable:!0,configurable:!0},w[u+"v"]={value:h[1],enumerable:!1,writable:!0,configurable:!0},G(g[i],w),w={},S||U)for(S=D(S||[],U||[]),x=S.length,y=0;x>y;y++){if(j=S[y],_=null,F&&e!==F[j]){if((A=F[j])instanceof X){if((b|d)&A.qualifier){L[j]=A;continue}_=A.factory(t,V,g)}else{if(L[E](j))continue;_=F[j]}R===B(_)&&(_[u]=t[j]||H)}else e!==t[j]&&(I=B(t[j]),_=O===I?K(null,t[j]):(C|N)&I?t[j].slice(0):P&I?0+t[j]:t[j]);w[j]={value:_,enumerable:!1,writable:!0,configurable:!0}}for(j in L)L[E](j)&&(_=L[j].factory(t,V,g),w[j]={value:_,enumerable:!1,writable:!0,configurable:!0});return w[a]={value:S,enumerable:!1,writable:!0,configurable:!0},w[o]={value:L,enumerable:!1,writable:!0,configurable:!0},w[u]={value:t,enumerable:!1,writable:!0,configurable:!0},G(g,w),g},ee=K,ne=K,ie=function(n){var t,r,l,c;if(R===B(n)){if(u in n&&(n[u]=e),f in n&&(n[f]=e),o in n&&(n[o]=e),a in n){for(l=n[a],t=0,r=l.length;r>t;t++)c=l[t],c in n&&(R===B(n[c])&&n[c][u]&&(n[c][u]=e),n[c]=e);n[a]=e}l=n[i];for(c in l)R===B(l[c])&&(l[c][u]&&(l[c][u]=e),l[c]=e);l[u]=e,l[u+"v"]=e}},te=function(){var e=arguments,n=e.length,t=null;if(b===e[0])return e[1]||{};if(n>=2){var r=B(e[0]);r=R===r?{Extends:e[0]}:O===r?e[0]:{Extends:m};var l,u,a=e[1]||{},o={},f=r[E]("Extends")?r.Extends:r[E]("extends")?r["extends"]:m,c=r[E]("Implements")?r.Implements:r[E]("implements")?r["implements"]:null,s=r[E]("Mixin")?r.Mixin:r[E]("mixin")?r.mixin:null,d=null;if(c=c?[].concat(c):null,s=s?[].concat(s):null)for(l=0,u=s.length;u>l;l++)O===B(s[l])?s[l][E]("mixin")&&s[l].mixin&&s[l].mixin[i]&&(d=Q(s[l].mixin[i],s[l].namespace||null,s[l].as||null),o=ne(o,d)):s[l][i]&&(d=s[l][i],o=ne(o,d));if(c)for(l=0,u=c.length;u>l;l++)O===B(c[l])?c[l][E]("implements")&&c[l]["implements"]&&c[l]["implements"][i]&&(d=Q(c[l]["implements"][i],c[l].namespace||null,c[l].as||null),o=ee(o,d)):c[l][i]&&(d=c[l][i],o=ee(o,d));t=O===B(f)?Z(f["extends"]||m,K(o,a),f.namespace||null,f.as||null):Z(f,K(o,a))}else t=Z(m,e[0]);return t},re={VERSION:"0.9.3",PUBLIC:c,STATIC:b,LATE:d,PRIVATE:s,Type:B,Create:J,Merge:K,Alias:Q,Implements:ee,Mixin:ne,Extends:Z,Dispose:ie,Method:X,Prop:Y,Class:te};return re});
/**
*
*   MOD3.js
*   @version: 0.6.0
*   @dependencies: Classy.js
*
*   MOD3 3D Modifier Library for JavaScript 
*   port of AS3DMod ActionScript3 library (http://code.google.com/p/as3dmod/)
*   https://github.com/foo123/MOD3
*
**/!function(t,n,e){"use strict";function r(t,n,e,r){return t?n.map(function(n,i){return(e?t[i]:t[n])||(r?r(n):null)}):[]}var i="Classy".split(/\s*,\s*/);"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=e.apply(t,r(module.$deps,i,!1,function(t){return require("./"+t.toLowerCase())}))):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"].concat(i),function(n){return e.moduleUri=n.uri,e.apply(t,r(Array.prototype.slice.call(arguments,1),i,!0))}):n in t||(t[n]=e.apply(t,r(t,i)))&&"function"==typeof define&&define.amd&&define(function(){return t[n]})}(this,"MOD3",function(t){"use strict";var n={VERSION:"0.6.0",Class:t.Class,StaticClass:function(n){return t.Class(t.STATIC,n)}};return!function(t,n){t.Constants={PI:Math.PI,invPI:1/Math.PI,halfPI:.5*Math.PI,doublePI:2*Math.PI,toRad:Math.PI/180,toDeg:180/Math.PI},t.ModConstant={NONE:0,LEFT:-1,RIGHT:1,X:1,Y:2,Z:4,Xi:0,Yi:1,Zi:2},t.XYZi=[null,0,1,null,2],t.iXYZ=[1,2,4],t.xyz=["x","y","z"],t.XYZ=["X","Y","Z"],t.Array32F="undefined"!=typeof Float32Array?Float32Array:Array,t.Array64F="undefined"!=typeof Float64Array?Float64Array:Array,t.Array8I="undefined"!=typeof Int8Array?Int8Array:Array,t.Array16I="undefined"!=typeof Int16Array?Int16Array:Array,t.Array32I="undefined"!=typeof Int32Array?Int32Array:Array,t.Array8U="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Array16U="undefined"!=typeof Uint16Array?Uint16Array:Array,t.Array32U="undefined"!=typeof Uint32Array?Uint32Array:Array,t.VecArray=t.Array32F}(n),!function(t,n){var e,r=t.Constants.toRad,i=t.Constants.toDeg,o=(Math.min,Math.max,Math.pow),s=Math.round,a=Math.floor,u=Math.ceil,l=t.XMath=t.StaticClass({normalize:function(t,n,r){var i=n-t;return 0===i?1:e(0,1,(r-t)/n)},toRange:function(t,n,e){var r=n-t;return 0===r?0:t+r*e},inRange:function(t,n,e,r){return!1!==r?e>=t&&n>=e:e>t&&n>e},sign:function(t,n){return 0==t?n||0:t>0?1:-1},trim:function(t,n,e){return t>e?t:e>n?n:e},wrap:function(t,n,e){var r=n-t;return t>e?e+r:e>=n?e-r:e},degToRad:function(t){return t*r},radToDeg:function(t){return t*i},presicion:function(t,n){var e=o(10,n);return s(t*e)/e},uceil:function(t){return 0>t?a(t):u(t)}});e=l.clamp=l.trim}(n),!function(t,n){var e=t.XMath.normalize,r=t.XMath.toRange,i=t.XMath.trim;t.Range=t.Class({constructor:function o(t,n){var e=this;return e instanceof o?(e.start=null!=t?t:0,void(e.end=null!=n?n:1)):new o(t,n)},name:"Range",start:0,end:1,dispose:function(){var t=this;return t.start=null,t.end=null,t},getSize:function(){return this.end-this.start},move:function(t){this.start+=t,this.end+=t},isIn:function(t){return t>=this.start&&t<=this.end},normalize:function(t){return e(this.start,this.end,t)},toRange:function(t){return r(this.start,this.end,t)},trim:function(t){return i(this.start,this.end,t)},interpolate:function(t,n){return r(this.start,this.end,n.normalize(t))},toString:function(){return"["+this.start+" - "+this.end+"]"}})}(n),!function(t,n){var e=Math.sin,r=Math.abs;t.Phase=t.Class({constructor:function i(t){var n=this;return n instanceof i?void(n.value=t||0):new i(t)},name:"Phase",value:0,dispose:function(){return this.value=null,this},getPhasedValue:function(){return e(this.value)},getAbsPhasedValue:function(){return r(e(this.value))},getNormValue:function(){return.5*(e(this.value)+1)}})}(n),!function(t,n){var e=t.Point=t.Class({constructor:function r(t,n){var e=this;return e instanceof r?(e.x=null==t?0:t,void(e.y=null==n?0:n)):new r(t,n)},name:"Point",x:0,y:0,dispose:function(){var t=this;return t.x=null,t.y=null,t},clone:function(){return new e(this.x,this.y)}})}(n),!function(t,n){var e=Math.sin,r=Math.cos,i=t.Point,o=t.VecArray,s=t.Matrix=t.Class({__static__:{transform:function(t,n){var e=t.m,r=n[0],i=n[1];return n[0]=e[0]*r+e[1]*i,n[1]=e[2]*r+e[3]*i,n},mult:function(t,n){var e=t.m,r=n.m,i=e[0],o=e[1],s=e[2],a=e[3];return e[0]=i*r[0]+o*r[2],e[1]=i*r[1]+o*r[3],e[2]=s*r[0]+a*r[2],e[3]=s*r[1]+a*r[3],t}},constructor:function a(t,e,r,i){var s=this;return s instanceof a?void(s.m=new o([t===n?1:t,e===n?0:e,r===n?0:r,i===n?1:i])):new a(t,e,r,i)},name:"Matrix",m:null,dispose:function(){return this.m=null,this},reset:function(){var t=this.m;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,this},rotate:function(t){var n=this.m,i=r(t),o=e(t);return n[0]=i,n[1]=-o,n[2]=o,n[3]=i,this},scale:function(t,e){var r=this.m;return r[0]=1,r[1]=0,r[2]=0,r[3]=1,t!==n&&(r[0]=t,r[3]=t),e!==n&&(r[3]=e),this},multiply:function(t){return s.mult(this,t)},transformPoint:function(t){var n=s.transform(this,[t.x,t.y]);return new i(n[0],n[1])},transformPointSelf:function(t){var n=s.transform(this,[t.x,t.y]);return t.x=n[0],t.y=n[1],t},clone:function(){var t=this.m;return new s(t[0],t[1],t[2],t[3])}})}(n),!function(t,n){var e=Math.sqrt,r=t.VecArray,i=t.Vector3=t.Class({__static__:{ZERO:function(){return new i(0,0,0)},X:function(t){return!1===t?new i(0,1,1):new i(1,0,0)},Y:function(t){return!1===t?new i(1,0,1):new i(0,1,0)},Z:function(t){return!1===t?new i(1,1,0):new i(0,0,1)},dot:function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},equals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]},cross:function(t,n){var e=new r(3);return e[0]=t[1]*n[2]-t[2]*n[1],e[1]=t[2]*n[0]-t[0]*n[2],e[2]=t[0]*n[1]-t[1]*n[0],e},mod:function(t){var n=t[0],r=t[1],i=t[2];return e(n*n+r*r+i*i)},dist:function(t,n){var r=t[0]-n[0],i=t[1]-n[1],o=t[2]-n[2];return e(r*r+i*i+o*o)},add:function(t,n){return t[0]+=n[0],t[1]+=n[1],t[2]+=n[2],t},sub:function(t,n){return t[0]-=n[0],t[1]-=n[1],t[2]-=n[2],t},mul:function(t,n){return t[0]*=n[0],t[1]*=n[1],t[2]*=n[2],t},muls:function(t,n){return t[0]*=n,t[1]*=n,t[2]*=n,t},norm:function(t){var n,r=t[0],i=t[1],o=t[2],s=r*r+i*i+o*o;return s>0&&(n=e(s),r/=n,i/=n,o/=n),t[0]=r,t[1]=i,t[2]=o,t}},constructor:function o(t,n,e){var i=this;if(!(i instanceof o))return new o(t,n,e);var s=new r(3);t&&3===t.length?(s[0]=t[0]||0,s[1]=t[1]||0,s[2]=t[2]||0):(s[0]=t||0,s[1]=n||0,s[2]=e||0),i.xyz=s},name:"Vector3",xyz:null,dispose:function(){return this.xyz=null,this},getXYZ:function(){return new r(this.xyz)},getXYZRef:function(){return this.xyz},setXYZ:function(t){var n=this.xyz;return n[0]=t[0],n[1]=t[1],n[2]=t[2],this},setXYZRef:function(t){return this.xyz=t,this},clone:function(){return new i(this.xyz)},equalsSelf:function(t){var n=this.xyz,e=t.xyz;return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},zeroSelf:function(){var t=this.xyz;return t[0]=0,t[1]=0,t[2]=0,this},negate:function(){var t=this.xyz;return new i(-t[0],-t[1],-t[2])},negateSelf:function(){var t=this.xyz;return t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],this},add:function(t){var n=this.xyz,e=t.xyz;return new i(n[0]+e[0],n[1]+e[1],n[2]+e[2])},addSelf:function(t){var n=this.xyz,e=t.xyz;return n[0]+=e[0],n[1]+=e[1],n[2]+=e[2],this},subtract:function(t){var n=this.xyz,e=t.xyz;return new i(n[0]-e[0],n[1]-e[1],n[2]-e[2])},subtractSelf:function(t){var n=this.xyz,e=t.xyz;return n[0]-=e[0],n[1]-=e[1],n[2]-=e[2],this},multiplyScalar:function(t){var n=this.xyz;return new i(n[0]*t,n[1]*t,n[2]*t)},multiplyScalarSelf:function(t){var n=this.xyz;return n[0]*=t,n[1]*=t,n[2]*=t,this},multiply:function(t){var n=this.xyz,e=t.xyz;return new i(n[0]*e[0],n[1]*e[1],n[2]*e[2])},multiplySelf:function(t){var n=this.xyz,e=t.xyz;return n[0]*=e[0],n[1]*=e[1],n[2]*=e[2],this},divide:function(t){var n=this.xyz;return new i(n[0]/t,n[1]/t,n[2]/t)},divideSelf:function(t){var n=this.xyz;return n[0]/=t,n[1]/=t,n[2]/=t,this},normalize:function(){var t,n=this.xyz,r=n[0],o=n[1],s=n[2],a=r*r+o*o+s*s;return a>0&&(t=e(a),r/=t,o/=t,s/=t),new i(r,o,s)},normalizeSelf:function(){var t,n=this.xyz,r=n[0],i=n[1],o=n[2],s=r*r+i*i+o*o;return s>0&&(t=e(s),r/=t,i/=t,o/=t),n[0]=r,n[1]=i,n[2]=o,this},getMagnitude:function(){var t=this.xyz,n=t[0],r=t[1],i=t[2];return e(n*n+r*r+i*i)},setMagnitude:function(t){this.normalizeSelf();var n=this.xyz;return n[0]*=t,n[1]*=t,n[2]*=t,this},dot:function(t){var n=this.xyz,e=t.xyz;return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]},cross:function(t){var n=this.xyz,e=t.xyz,r=n[0],o=n[1],s=n[2],a=e[0],u=e[1],l=e[2];return new i(o*l-s*u,s*a-r*l,r*u-o*a)},crossSelf:function(t){var t=this.xyz,n=b.xyz,e=t[0],r=t[1],i=t[2],o=n[0],s=n[1],a=n[2];return t[0]=r*a-i*s,t[1]=i*o-e*a,t[2]=e*s-r*o,this},distance:function(t){var n=this.xyz,r=t.xyz,i=n[0]-r[0],o=n[1]-r[1],s=n[2]-r[2];return e(i*i+o*o+s*s)},toString:function(){var t=this.xyz;return"["+t[0]+" , "+t[1]+" , "+t[2]+"]"}});i.modulo=i.mod,i.distance=i.dist,i.prototype.dotSelf=i.prototype.dot,i.prototype.distanceSelf=i.prototype.distance}(n),!function(t,n){var e=Math.sin,r=Math.cos,i=t.VecArray,o=t.Matrix4=t.Class({__static__:{multXYZ:function(t,n){var e=t.m,r=n[0],i=n[1],o=n[2];return n[0]=r*e[0]+i*e[1]+o*e[2]+e[3],n[1]=r*e[4]+i*e[5]+o*e[6]+e[7],n[2]=r*e[8]+i*e[9]+o*e[10]+e[11],n},mult:function(t,n){var e=t.m,r=n.m,i=e[0],o=r[0],s=e[4],a=r[4],u=e[8],l=r[8],c=e[1],f=r[1],h=e[5],d=r[5],p=e[9],v=r[9],m=e[2],y=r[2],x=e[6],g=r[6],M=e[10],w=r[10],A=e[3],z=r[3],Y=e[7],X=r[7],Z=e[11],V=r[11];return e[0]=i*o+c*a+m*l,e[1]=i*f+c*d+m*v,e[2]=i*y+c*g+m*w,e[3]=i*z+c*X+m*V+A,e[4]=s*o+h*a+x*l,e[5]=s*f+h*d+x*v,e[6]=s*y+h*g+x*w,e[7]=s*z+h*X+x*V+Y,e[8]=u*o+p*a+M*l,e[9]=u*f+p*d+M*v,e[10]=u*y+p*g+M*w,e[11]=u*z+p*X+M*V+Z,t}},constructor:function s(t,e,r,o,a,u,l,c,f,h,d,p,v,m,y,x){var g=this;return g instanceof s?void(g.m=new i([t===n?1:t,e===n?0:e,r===n?0:r,o===n?0:o,a===n?0:a,u===n?1:u,l===n?0:l,c===n?0:c,f===n?0:f,h===n?0:h,d===n?1:d,p===n?0:p,v===n?0:v,m===n?0:m,y===n?0:y,x===n?1:x])):new s(t,e,r,o,a,u,l,c,f,h,d,p,v,m,y,x)},name:"Matrix4",m:null,dispose:function(){return this.m=null,this},reset:function(){var t=this.m;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},translate:function(t,n,e,r){var i=this.m;return!0===r&&(i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1),i[3]=t,i[7]=n,i[11]=e,this},scale:function(t,n,e,r){var i=this.m;return!0===r&&(i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1),i[0]=t,i[5]=n,i[10]=e,this},rotate:function(t,n,i,o,s){var a=this.m,u=r(o),l=e(o),c=1-u,f=t*n*c,h=n*i*c,d=t*i*c,p=l*i,v=l*n,m=l*t;return!0===s&&(a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1),a[0]=u+t*t*c,a[1]=-p+f,a[2]=v+d,a[3]=0,a[4]=p+f,a[5]=u+n*n*c,a[6]=-m+h,a[7]=0,a[8]=-v+d,a[9]=m+h,a[10]=u+i*i*c,a[11]=0,this},translateFromVector:function(t,n){return this.translate(t.xyz[0],t.xyz[1],t.xyz[2],n)},scaleFromVector:function(t,n){return this.scale(t.xyz[0],t.xyz[1],t.xyz[2],n)},rotateFromVector:function(t,n,e){return this.rotate(t.xyz[0],t.xyz[1],t.xyz[2],n,e)},multiply:function(t){return o.mult(this,t)},multiplyVector:function(t){return o.multXYZ(this,t.xyz),t}});o.prototype.translationMatrix=o.prototype.translate,o.prototype.scaleMatrix=o.prototype.scale,o.prototype.rotationMatrix=o.prototype.rotate,o.prototype.translationMatrixFromVector=o.prototype.translateFromVector,o.prototype.scaleMatrixFromVector=o.prototype.scaleFromVector,o.prototype.rotationMatrixFromVector=o.prototype.rotateFromVector}(n),!function(t,n){t.List={operate:function(t,n,e,r,i,o){var s=t.length;if(arguments.length<5&&(i=s-1),0>i&&(i+=s),arguments.length<4&&(r=0),r>i)return e;if(!0===o){var a,u,l=i-r+1,c=l-1,f=15&l,h=1&f,d=c-f,p=h?n(e,t[i],i):e;for(a=c-h;a>d;a-=2)u=r+a,p=n(n(p,t[u],u),t[u-1],u-1);for(a=d;a>=0;a-=16)u=r+a,p=n(n(n(n(n(n(n(n(n(n(n(n(n(n(n(n(p,t[u],u),t[u-1],u-1),t[u-2],u-2),t[u-3],u-3),t[u-4],u-4),t[u-5],u-5),t[u-6],u-6),t[u-7],u-7),t[u-8],u-8),t[u-9],u-9),t[u-10],u-10),t[u-11],u-11),t[u-12],u-12),t[u-13],u-13),t[u-14],u-14),t[u-15],u-15)}else{var a,u,l=i-r+1,f=15&l,h=1&f,p=h?n(e,t[r],r):e;for(a=h;f>a;a+=2)u=r+a,p=n(n(p,t[u],u),t[u+1],u+1);for(a=f;l>a;a+=16)u=r+a,p=n(n(n(n(n(n(n(n(n(n(n(n(n(n(n(n(p,t[u],u),t[u+1],u+1),t[u+2],u+2),t[u+3],u+3),t[u+4],u+4),t[u+5],u+5),t[u+6],u+6),t[u+7],u+7),t[u+8],u+8),t[u+9],u+9),t[u+10],u+10),t[u+11],u+11),t[u+12],u+12),t[u+13],u+13),t[u+14],u+14),t[u+15],u+15)}return p},each:function(t,n,e,r,i){if(null==t||!t.length)return t;var o=t.length;if(arguments.length<4&&(r=o-1),0>r&&(r+=o),arguments.length<3&&(e=0),e>r)return t;var s,a,u,l,c,f,h=r-e+1;if(!0===i){for(u=h-1,c=15&h,f=1&c,l=u-c,f&&n(t[r]),s=u-f;s>l;s-=2)a=e+s,n(t[a]),n(t[a-1]);for(s=l;s>=0;s-=16)a=e+s,n(t[a]),n(t[a-1]),n(t[a-2]),n(t[a-3]),n(t[a-4]),n(t[a-5]),n(t[a-6]),n(t[a-7]),n(t[a-8]),n(t[a-9]),n(t[a-10]),n(t[a-11]),n(t[a-12]),n(t[a-13]),n(t[a-14]),n(t[a-15])}else{for(c=15&h,f=1&c,f&&n(t[e]),s=f;c>s;s+=2)a=e+s,n(t[a]),n(t[a+1]);for(s=c;h>s;s+=16)a=e+s,n(t[a]),n(t[a+1]),n(t[a+2]),n(t[a+3]),n(t[a+4]),n(t[a+5]),n(t[a+6]),n(t[a+7]),n(t[a+8]),n(t[a+9]),n(t[a+10]),n(t[a+11]),n(t[a+12]),n(t[a+13]),n(t[a+14]),n(t[a+15])}return t}}}(n),!function(t,n){var e,r,i,o,s=t.ModConstant,a=s.X,u=s.Y,l=s.Z,c=t.XYZi,f=(t.Vector3,t.VecArray),h=Math.min,d=Math.max,p=t.List.each,v=function(t){t.dispose()},m=function(t){t.reset()},y=function(t){t.collapse()};e=t.FaceProxy=t.Class({constructor:function(){this.vertices=[]},name:"FaceProxy",vertices:null,dispose:function(){var t=this;return t.vertices=null,t},addVertex:function(t){this.vertices.push(t)},getVertices:function(){return this.vertices}}),r=t.VertexProxy=t.Class({constructor:function(t,n){var e=this;e.mesh=n||null,e.original=new f([0,0,0]),e.ratio=new f([0,0,0]),null!=t&&e.setVertex(t)},name:"VertexProxy",mesh:null,vertex:null,original:null,ratio:null,dispose:function(){var t=this;return t.mesh=null,t.vertex=null,t.original=null,t.ratio=null,t},setVertex:function(t){var n=this;return n.vertex=t,n},getRatioVector:function(){var t=this.ratio,n=new f(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},getRatio:function(t){return this.ratio[c[t]]||0},setRatios:function(t,e,r){var i=this.ratio;return i[0]=t===n?0:t,i[1]=e===n?0:e,i[2]=r===n?0:r,this},getOriginalValue:function(t){return this.original[c[t]]||0},setOriginalPosition:function(t,e,r){var i=this.original;return i[0]=t===n?0:t,i[1]=e===n?0:e,i[2]=r===n?0:r,this},getXYZ:function(){return new f([0,0,0])},getX:function(){return 0},getY:function(){return 0},getZ:function(){return 0},getValue:function(t){var n=this;return a===t?n.getX():u===t?n.getY():l===t?n.getZ():0},setXYZ:function(t){return this},setX:function(t){return this},setY:function(t){return this},setZ:function(t){return this},setValue:function(t,n){var e=this;return a===t?e.setX(n):u===t?e.setY(n):l===t&&e.setZ(n),e},reset:function(){var t=this;return t.setXYZ(t.original),t},collapse:function(){var t=this,n=t.getXYZ(),e=t.original;return e[0]=n[0],e[1]=n[1],e[2]=n[2],t}}),i=t.MeshProxy=t.Class({constructor:function(t){var n=this;n.maxX=0,n.maxY=0,n.maxZ=0,n.minX=0,n.minY=0,n.minZ=0,n.maxAxis=0,n.midAxis=0,n.minAxis=0,n.width=0,n.height=0,n.depth=0,n.vertices=null,n.faces=null,n.mesh=null,null!=t&&n.setMesh(t)},name:"MeshProxy",maxX:0,maxY:0,maxZ:0,minX:0,minY:0,minZ:0,maxAxis:0,midAxis:0,minAxis:0,width:0,height:0,depth:0,vertices:null,faces:null,mesh:null,v:null,dispose:function(){var t=this;return t.maxX=null,t.maxY=null,t.maxZ=null,t.minX=null,t.minY=null,t.minZ=null,t.maxAxis=null,t.midAxis=null,t.minAxis=null,t.width=null,t.height=null,t.depth=null,t.disposeFaces(),t.disposeVertices(),t.mesh=null,t.v=null,t},disposeVertices:function(){var t=this;return p(t.vertices,v),t.vertices=null,t},disposeFaces:function(){var t=this;return p(t.faces,v),t.faces=null,t},init:function(t){var n=this;return n.mesh=t,n},setMesh:function(t){return this.init(t).preApply().analyzeGeometry().postApply()},getVertices:function(){return this.vertices},getFaces:function(){return this.faces},applyModifiers:function(t){var n,e,r=this;for(e=0,n=t.length;n>e;e++)t[e].enabled&&t[e].apply(r);return r},analyzeGeometry:function(){var t,n,e,r=this,i=r.vertices,o=0,s=0,c=0,f=0,v=0,m=0,y=0,x=0,g=0;return i&&i.length?(e=i[0].getXYZ(),o=e[0],s=e[1],c=e[2],f=e[0],v=e[1],m=e[2],p(i,function(t){var n=t.getXYZ(),e=n[0],r=n[1],i=n[2];o=h(o,e),s=h(s,r),c=h(c,i),f=d(f,e),v=d(v,r),m=d(m,i),t.setOriginalPosition(e,r,i)}),y=f-o,x=v-s,g=m-c,r.width=y,r.height=x,r.depth=g,r.minX=o,r.maxX=f,r.minY=s,r.maxY=v,r.minZ=c,r.maxZ=m,t=d(y,x,g),n=h(y,x,g),t===y&&n===x?(r.minAxis=u,r.midAxis=l,r.maxAxis=a):t===y&&n===g?(r.minAxis=l,r.midAxis=u,r.maxAxis=a):t===x&&n===y?(r.minAxis=a,r.midAxis=l,r.maxAxis=u):t===x&&n===g?(r.minAxis=l,r.midAxis=a,r.maxAxis=u):t===g&&n===y?(r.minAxis=a,r.midAxis=u,r.maxAxis=l):t===g&&n===x&&(r.minAxis=u,r.midAxis=a,r.maxAxis=l),p(i,function(t){var n=t.getXYZ();t.setRatios(y>0?(n[0]-o)/y:0,x>0?(n[1]-s)/x:0,g>0?(n[2]-c)/g:0)}),r):r},resetGeometry:function(){var t=this;return p(t.vertices,m),t},collapseGeometry:function(){var t=this;return p(t.vertices,y),t.analyzeGeometry()},getMin:function(t){var n=this;return a===t?n.minX:u===t?n.minY:l===t?n.minZ:-1},getMax:function(t){var n=this;return a===t?n.maxX:u===t?n.maxY:l===t?n.maxZ:-1},getSize:function(t){var n=this;return a===t?n.width:u===t?n.height:l===t?n.depth:-1},update:function(){return this},preApply:function(){return this},postApply:function(){return this},updateMeshPosition:function(t){return this}}),t.Library3d={id:"Library3d",Mesh:i,Vertex:r},o=t.Factory=t.StaticClass({getLibrary:function(n){return n&&n.library&&t[n.library]?t[n.library]:t.Library3d},getMeshProxy:function(t){return arguments.length&&t.Mesh?new t.Mesh:null},getModifier:function(n){return n&&n.modifier&&t[n.modifier]?new t[n.modifier]:null}})}(n),!function(t,n){var e,r,i=0,o=t.ModConstant.NONE,s=t.Factory.getMeshProxy;e=t.Modifier=t.Class({constructor:function(){var t=this;t.id=++i,t.name="Modifier",t.axes=o,t.constraint=o,t.enabled=!0},id:null,name:"Modifier",axes:null,constraint:null,enabled:!0,dispose:function(){var t=this;return t.name=null,t.axes=null,t.constraint=null,t},enable:function(t){return arguments.length?(this.enabled=!!t,this):this.enabled},constraintAxes:function(t){return this.axes=t||o,this},setConstraint:function(t){return this.constraint=t||o,this},apply:function(t){return this},toString:function(){return"[Modifier "+this.name+"]"}}),r=t.ModifierStack=t.Class({constructor:function a(t,n){var e=this;return e instanceof a?(e.stack=[],void e.setModifiable(s(t),n)):new a(t,n)},name:"ModifierStack",modifiable:null,stack:null,dispose:function(t){var n=this;if(t&&n.stack)for(;n.stack.length;)n.stack.pop().dispose();return n.modifiable&&n.modifiable.dispose(),n.stack=null,n.modifiable=null,n},getModifiable:function(){return this.modifiable},setModifiable:function(t,n){var e=this;return e.modifiable=t,n&&e.modifiable.setMesh(n),e},add:function(t){var n=this;return t&&n.stack.push(t),n},apply:function(){var t=this,n=t.modifiable,e=t.stack;return n&&e&&e.length&&n.preApply().resetGeometry().applyModifiers(e).postApply().update(),t},collapse:function(){var t=this,n=t.modifiable;return n&&t.stack&&t.stack.length&&(n.preApply().resetGeometry().applyModifiers(t.stack).collapseGeometry().postApply().update(),t.stack.length=0),t},clear:function(){var t=this;return t.stack&&(t.stack.length=0),t}}),r.prototype.getMeshInfo=r.prototype.getModifiable,r.prototype.addModifier=r.prototype.add}(n),!function(t,n){var e=t.Vector3,r=t.List.each,i=e.add;t.Pivot=t.Class(t.Modifier,{constructor:function o(t,n,r){var i=this;return i instanceof o?(i.$super("constructor"),i.name="Pivot",void(i.vector=new e(t||0,n||0,r||0))):new o(t,n,r)},vector:null,dispose:function(){var t=this;return t.vector.dispose(),t.vector=null,t.$super("dispose"),t},setMeshCenter:function(t){var n=this;return n.vector=new e(-(t.minX+.5*t.width),-(t.minY+.5*t.height),-(t.minZ+.5*t.depth)),n},apply:function(t){var n=this,e=n.vector,o=e.xyz;return r(t.vertices,function(t){t.setXYZ(i(t.getXYZ(),o))}),t.updateMeshPosition(e.negate()),n}})}(n),!function(t,n){var e=t.ModConstant.NONE,r=t.ModConstant.LEFT,i=t.ModConstant.RIGHT,o=t.XYZi,s=t.Matrix,a=(Math.atan,Math.atan2,Math.sin),u=Math.cos,l=t.Constants.PI,c=t.Constants.halfPI,f=t.Constants.doublePI,h=Math.max,d=Math.min,p=t.List.each,v=s.transform;t.Bend=t.Class(t.Modifier,{constructor:function m(t,n,r){var i=this;return i instanceof m?(i.$super("constructor"),i.name="Bend",i.constraint=e,i.switchAxes=!1,i.force=t||0,i.offset=n||0,void(i.angle=r||0)):new m(t,n,r)},force:0,offset:0,angle:0,switchAxes:!1,dispose:function(){var t=this;return t.force=null,t.offset=null,t.angle=null,t.switchAxes=null,t.$super("dispose"),t},apply:function(t){var n=this;if(0==n.force)return n;var e=n.constraint,m=n.switchAxes,y=n.force,x=d(1,h(0,n.offset)),g=n.angle,M=m?t.midAxis:t.maxAxis,w=t.minAxis,A=m?t.maxAxis:t.midAxis,z=t.getSize(M),Y=(t.getSize(A),t.getMin(M)),X=(new s).rotate(g),Z=(new s).rotate(-g),V=Y+z*x,C=z/l/y,b=f*(z/(C*f));return p(t.vertices,function(t){var n,s,l,f,h,d=t.getXYZ(),p=d[o[M]],m=d[o[A]],y=d[o[w]],g=v(X,[p,m]);p=g[0],m=g[1],n=(p-Y)/z,r===e&&x>=n||i===e&&n>=x||(s=c-b*x+b*n,l=a(s)*(C+y),f=u(s)*(C+y),y=l-C,p=V-f),h=v(Z,[p,m]),p=h[0],m=h[1],d[o[M]]=p,d[o[A]]=m,d[o[w]]=y,t.setXYZ(d)}),n}})}(n),!function(t,n){var e=t.Vector3,r=Math.max,i=Math.exp,o=t.List.each,s=e.add,a=e.sub,u=e.muls,l=e.mod,c=e.norm;t.Bloat=t.Class(t.Modifier,{constructor:function f(t,n,r){var i=this;return i instanceof f?(i.$super("constructor"),i.name="Bloat",i.radius=t||0,i.a=null==n?.01:n,void(i.center=r||e.ZERO())):new f(t,n,r)},radius:0,a:.01,center:null,dispose:function(){var t=this;return t.center.dispose(),t.center=null,t.radius=null,t.a=null,t.$super("dispose"),t},apply:function(t){var n=this,e=n.center.xyz,f=r(0,n.radius),h=r(0,n.a);return o(t.vertices,function(t){var n=a(t.getXYZ(),e),r=l(n);u(c(n),r+f*i(-r*h)),t.setXYZ(s(n,e))}),n}})}(n),!function(t,n){var e=t.Vector3,r=(Math.sqrt,t.Matrix4),i=t.List.each,o=r.mult,s=e.dot,a=e.mod;t.Twist=t.Class(t.Modifier,{constructor:function u(t,n,r){var i=this;return i instanceof u?(i.$super("constructor"),i.name="Twist",i.angle=t||0,i.vector=n||e.Y(),void(i.center=r||e.ZERO())):new u(t,n,r)},angle:0,vector:null,center:null,dispose:function(){var t=this;return t.vector.dispose(),t.vector=null,t.angle=null,t.center.dispose(),t.center=null,t.$super("dispose"),t},apply:function(t){var n=this,e=n.vector.normalizeSelf().xyz,u=n.angle,l=n.center.xyz,c=a([.5*t.maxX,.5*t.maxY,.5*t.maxZ]),f=-s(e,l),h=new r,d=new r;return i(t.vertices,function(t){var n=t.getXYZ(),r=(s(n,e)+f)*u/c,i=o(d.rotate(e[0],e[1],e[2],r,!0),h.translate(n[0],n[1],n[2],!0));t.setXYZ([i.m[3],i.m[7],i.m[11]])}),n}})}(n),!function(t,n){var e=Math.abs,r=Math.pow,i=Math.max,o=Math.min,s=t.ModConstant,a=s.NONE,u=s.LEFT,l=s.RIGHT,c=s.X,f=s.Y,h=s.Z,d=t.List.each;t.Skew=t.Class(t.Modifier,{constructor:function p(t,e,r,i){var o=this;return o instanceof p?(o.$super("constructor"),o.name="Skew",o.constraint=a,o.force=t!==n?t:0,o.offset=e!==n?e:.5,o.power=r!==n?r:1,o.falloff=i!==n?i:1,o.inverseFalloff=!1,o.oneSide=!1,o.swapAxes=!1,void(o.skewAxis=0)):new p(t,e,r,i)},force:0,skewAxis:0,offset:.5,power:1,falloff:1,inverseFalloff:!1,oneSide:!1,swapAxes:!1,dispose:function(){var t=this;return t.force=null,t.skewAxis=null,t.offset=null,t.power=null,t.falloff=null,t.inverseFalloff=null,t.oneSide=null,t.swapAxes=null,t.$super("dispose"),t},apply:function(t){var n=this,s=n.constraint,a=n.skewAxis||t.maxAxis,p=n.swapAxes,v=o(1,i(0,n.offset)),m=n.oneSide,y=!!n.inverseFalloff,x=o(1,i(0,n.falloff)),g=1-x,M=n.power,w=n.force,A=c===a?p?h:f:f===a?p?h:c:h===a?p?f:c:0;return d(t.vertices,function(t){var n,i,o,c,f;f=t.getRatio(a),u===s&&v>=f||l===s&&f>v||(n=f-v,m&&0>n&&(n=-n),i=t.getRatio(A),y&&(i=1-i),o=x+i*g,c=(0>n?-1:1)*r(e(n),M),t.setValue(A,t.getValue(A)+w*c*o))}),n}})}(n),!function(t,n){var e=t.Vector3,r=t.Matrix4,i=Math.pow,o=e.mul,s=e.mod,a=t.List.each,u=r.multXYZ;t.Taper=t.Class(t.Modifier,{constructor:function l(t,r,i,o){var s=this;return s instanceof l?(s.$super("constructor"),s.name="Taper",s.force=t!==n?t:0,s.power=r!==n?r:1,s.vector=i||e.Y(!1),void(s.vector2=o||e.Y())):new l(t,r,i,o)},force:0,power:1,vector:null,vector2:null,dispose:function(){var t=this;return t.vector.dispose(),t.vector2.dispose(),t.vector=null,t.vector2=null,t.force=null,t.power=null,t.$super("dispose"),t},apply:function(t){var n=this,e=n.vector.xyz,l=n.vector2.xyz,c=n.force,f=n.power,h=new r;return a(t.vertices,1!=f?function(t){var n=s(o(t.getRatioVector(),l)),r=c*i(n,f);t.setXYZ(u(h.scale(1+r*e[0],1+r*e[1],1+r*e[2]),t.getXYZ()))}:function(t){var n=s(o(t.getRatioVector(),l)),r=c*n;t.setXYZ(u(h.scale(1+r*e[0],1+r*e[1],1+r*e[2]),t.getXYZ()))}),n}})}(n),!function(t,n){var e=(t.Constants.invPI,t.Constants.doublePI,t.Vector3),r=t.Matrix4,i=t.List.each,o=r.multXYZ;t.Wheel=t.Class(t.Modifier,{constructor:function s(t,n,r,i,o){var a=this;return a instanceof s?(a.$super("constructor"),a.name="Wheel",a.speed=t||0,a.turn=n||0,a.roll=r||0,a.steerVector=i||e.Y(),void(a.rollVector=o||e.Z())):new s(t,n,r,i,o)},speed:0,turn:0,roll:0,steerVector:null,rollVector:null,dispose:function(){var t=this;return t.speed=null,t.turn=null,t.roll=null,t.steerVector.dispose(),t.rollVector.dispose(),t.steerVector=null,t.rollVector=null,t.$super("dispose"),t},apply:function(t){var n=this,e=n.steerVector.normalizeSelf(),s=n.rollVector.normalizeSelf(),a=n.turn,u=n.roll,l=null,c=null;return n.roll+=n.speed,a?(c=(new r).rotateFromVector(e,a),l=(new r).rotateFromVector(c.multiplyVector(s.clone()),u)):l=(new r).rotateFromVector(s,u),i(t.vertices,c?function(t){t.setXYZ(o(l,o(c,t.getXYZ())))}:function(t){t.setXYZ(o(l,t.getXYZ()))}),n}})}(n),!function(t,n){var e=t.Vector3,r=t.Range,i=t.Matrix4,o=Math.max,s=Math.min,a=t.List.each,u=i.multXYZ;t.Break=t.Class(t.Modifier,{constructor:function l(t,n,i){var o=this;return o instanceof l?(o.$super("constructor"),o.name="Break",o.offset=t||0,o.angle=n||0,o.vector=i||e.Y(),void(o.range=new r(0,1))):new l(t,n,i)},offset:0,angle:0,vector:null,range:null,dispose:function(){var t=this;return t.vector.dispose(),t.range.dispose(),t.vector=null,t.range=null,t.offset=null,t.angle=null,t.$super("dispose"),t},apply:function(t){var n,e,r=this,l=s(1,o(0,r.offset)),c=r.range,f=r.angle,h=r.vector.normalizeSelf().xyz;return n=t.minZ+t.depth*l,e=(new i).rotate(h[0],h[1],h[2],f),a(t.vertices,function(t){var r=t.getXYZ();r[2]-=n,0<=r[2]&&c.isIn(t.ratio[1])&&u(e,r),r[2]+=n,t.setXYZ(r)}),r}})}(n),!function(t,n){var e=(t.ModConstant.NONE,t.ModConstant.X),r=t.ModConstant.Y,i=t.ModConstant.Z,o=Math.random,s=t.List.each;t.Noise=t.Class(t.Modifier,{constructor:function a(t){var n=this;return n instanceof a?(n.$super("constructor"),n.name="Noise",n.force=t||0,n.start=0,n.end=1,void(n.axes=e|r|i)):new a(t)},force:0,start:0,end:1,dispose:function(){var t=this;return t.force=null,t.start=null,t.end=null,t.$super("dispose"),t},setFalloff:function(t,e){var r=this;return r.start=t!==n?t:0,r.end=e!==n?e:1,r},apply:function(t){var n=this,a=n.axes,u=n.start,l=n.end,c=n.force,f=.5*c,h=t.maxAxis;return 0==a||0==c?n:(s(t.vertices,function(t){var n,s,d=o()*c-f,p=t.getRatio(h);l>u?u>p?p=0:p>l&&(p=1):u>l?(p=1-p,p>u?p=0:l>p&&(p=1)):p=1,n=d*p,s=t.getXYZ(),t.setXYZ([s[0]+(a&e?n:0),s[1]+(a&r?n:0),s[2]+(a&i?n:0)])}),n)}})}(n),!function(t,n){var e=t.ModConstant,r=(e.NONE,e.X),i=e.Y,o=e.Z,s=t.List.each;t.DisplaceMap=t.Class(t.Modifier,{constructor:function a(t,n,e){var s=this;return s instanceof a?(s.$super("constructor"),s.name="DisplaceMap",+t==t?(s.force=t||1,s.offset=null==n?127:n):(s.setBitmap(t),s.force=n||1,s.offset=null==e?127:e),void(s.axes=r|i|o)):new a(t,n,e)},width:null,height:null,bmpData:null,force:1,offset:127,dispose:function(){var t=this;return t.bmpData=null,t.width=null,t.height=null,t.force=null,t.offset=null,t.$super("dispose"),t},setBitmap:function(t){var n=this;return n.bmpData=t?t.data:null,n.width=t?t.width:0,n.height=t?t.height:0,n},apply:function(t){var n=this,e=n.axes,a=n.width,u=n.height,l=n.bmpData,c=n.force,f=n.offset;return e&&l?(s(t.vertices,function(t){var n,s,h,d=t.getXYZ();s=~~((a-1)*t.ratio[0]),h=~~((u-1)*t.ratio[2]),n=h*a+s<<2,t.setXYZ([d[0]+(e&r?((255&l[n])-f)*c:0),d[1]+(e&i?((255&l[n+1])-f)*c:0),d[2]+(e&o?((255&l[n+2])-f)*c:0)])}),n):n}})}(n),!function(t,n){function e(t,n,e,i,o){var s,a,u,l,c,f=n*e,h=new r(f);for(0>i&&(i+=n),0>o&&(o+=e),i=~~i,o=~~o,s=0,a=0,c=0;f>c;c++,s++)s>=n&&(s=0,a++),u=(s+i)%n,l=(a+o)%e,h[c]=t[u+l*n];return h}var r=(t.Vector3,Math.round,t.VecArray),i=t.ModConstant,o=(i.NONE,i.X),s=i.Y,a=i.Z,u=t.List.each;t.Perlin=t.Class(t.Modifier,{constructor:function l(t,e,r){var i=this;return i instanceof l?(i.$super("constructor"),i.name="Perlin",i.force=n!==t?t:1,i.perlin=e,i.autoRun=n!==r?!!r:!0,void(i.axes=o|s|a)):new l(t,e,r)},speedX:1,speedY:1,perlin:null,force:1,offset:0,autoRun:!0,dispose:function(){var t=this;return t.perlin=null,t.speedX=null,t.speedY=null,t.force=null,t.offset=null,t.autoRun=null,t.$super("dispose"),t},setSpeed:function(t,n){var e=this;return e.speedX=t,e.speedY=n,e},apply:function(t){var n=this,r=n.axes,i=n.force,l=n.offset,c=n.perlin,f=c.width,h=c.height;return r&&c?(n.autoRun&&(c=n.perlin=e(c,f,h,n.speedX,n.speedY),c.width=f,c.height=h),u(t.vertices,function(t){var n=t.getXYZ(),e=~~((f-1)*t.ratio[0]),u=~~((h-1)*t.ratio[2]),d=e+u*f;t.setXYZ([n[0]+(r&o?(c[d]-l)*i:0),n[1]+(r&s?(c[d]-l)*i:0),n[2]+(r&a?(c[d]-l)*i:0)])}),n):n}})}(n),n});
