/**
*
*   Classy.js
*   @version: 0.9.3
*   @built on 2015-04-26 17:56:03
*
*   Object-Oriented micro-framework for JavaScript
*   https://github.com/foo123/classy.js
*
**/!function(e,n,t){"use strict";var i,r="object"==typeof module&&module.exports,l="function"==typeof define&&define.amd;r?module.exports=(module.$deps=module.$deps||{})[n]=module.$deps[n]||t.call(e,{NODE:module})||1:l&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["require","exports","module"],function(n,i,r){return t.call(e,{AMD:r})}):n in e||(e[n]=i=t.call(e,{})||1)&&l&&define(n,[],function(){return i})}(this,"Classy",function(e){return!function(e,n){"use strict";var t="constructor",i="prototype",r="__proto__",l="__static__",u="__private__",a="$super",o="$static",f="$latestatic",c="$class",s=2,b=4,m=8,d=256,p=Object,v=p[i],g=Function,h=g[i],y=String,x=Number,w=RegExp,E=Array,j=v.toString,_=(h.call.bind(h.toString),"hasOwnProperty"),q="propertyIsEnumerable",I=p.keys,$=p.defineProperty,A=function(e){return typeof e},C=function(e){throw new TypeError(e)},M=2,N=3,O=4,P=8,S=9,T=16,R=32,D=64,F=128,L=256,V=512,k=1024,B={"[object Array]":T,"[object RegExp]":F,"[object Number]":M,"[object String]":P,"[object Function]":D,"[object Object]":R},U=function(e){var t;return null===e?L:!0===e||!1===e?O:n===e?V:(t=j.call(e),t=B[t]||k,M===t||e instanceof x?isNaN(e)?N:M:P===t||e instanceof y?1===e.length?S:P:T===t||e instanceof E?T:F===t||e instanceof w?F:D===t||e instanceof g?D:R===t?R:k)},z=function(e,n){var t,i=n.length,r=[].concat(e);for(t=0;i>t;t++)-1<r.indexOf(n[t])||r.push(n[t]);return r},G=function(e,n){R!==U(e)&&C("bad desc");var t={};if(e[_]("enumerable")&&(t.enumerable=!!n.enumerable),e[_]("configurable")&&(t.configurable=!!n.configurable),e[_]("value")&&(t.value=n.value),e[_]("writable")&&(t.writable=!!e.writable),e[_]("get")){var i=e.get;D!==U(i)&&"undefined"!==i&&C("bad get"),t.get=i}if(e[_]("set")){var r=e.set;D!==U(r)&&"undefined"!==r&&C("bad set"),t.set=r}return("get"in t||"set"in t)&&("value"in t||"writable"in t)&&C("identity-confused descriptor"),t},H=p.defineProperties||function(e,n){("object"!==A(e)||null===e)&&C("bad obj"),n=p(n);for(var t=I(n),i=[],r=0;r<t.length;r++)i.push([t[r],G(n[t[r]],e)]);for(var r=0;r<i.length;r++)$(e,i[r][0],i[r][1]);return e},J=function(){},K=p.create||function(e,n){var t,l=function(){};return l[i]=e,t=new l,t[r]=e,"object"===A(n)&&H(t,n),t},Q=function(){var e,n,t,i,r,l,u,a=arguments;for(n=a[0]||{},e=a.length,l=1;e>l;l++)if(t=a[l],R===U(t))for(r in t)t[_](r)&&t[q](r)&&(i=t[r],u=U(i),n[r]=M&u?0+i:(P|T)&u?i.slice(0):i);return n},W=function(e,n,i){var r,l,u=!!n;if(u||i)if(r={},n=u?n+"$":n,i&&D===U(i))for(l in e)e[_](l)&&(t!==l?(u&&D===U(e[l])&&(r[n+l]=e[l]),r[i(l,e[l])]=e[l]):r[l]=e[l]);else for(l in e)e[_](l)&&(t!==l?(u&&D===U(e[l])&&(r[n+l]=e[l]),i&&l in i?r[i[l]]=e[l]:r[l]=e[l]):r[l]=e[l]);else r=e;return r},X=function(e){var n=e[a]||J,t=e[a+"v"]||J,i=null;return[function(t,r,l,u,a,o,f,c,s,b,m){var d,p;return i===t?d=n.call(this,t,r,l,u,a,o,f,c,s,b,m):(p=e[t])&&(i=t,d=p.call(this,r,l,u,a,o,f,c,s,b,m),i=null),d},function(n,r){var l,u;return i===n?l=t.call(this,n,r):(u=e[n])&&(i=n,l=r&&r.length?u.apply(this,r):u.call(this),i=null),l}]},Y=function(e,n){return this instanceof Y?(this.factory=e,void(this.qualifier=(M===U(n)?n:0)|s)):new Y(e,n)},Z=function(e,n){return this instanceof Z?(this.prop=e,void(this.qualifier=(M===U(n)?n:0)|s)):new Z(e,n)},en=function(e,r,s,v){e=e||p,r=r||{};var g,h,y,x,w,E,j,q,$,A,C=e[o]||null,N=e[f]||{},O=e[i],S=null,F=Q({},N),L=null,V={};r[_](t)||(r[t]=function(){}),g=r[t],r[_](u)&&(V=r[u]||{},delete r[u]),r[_](l)&&(S=r[l],L=I(S),delete r[l]);for($ in r)if(r[_]($)){if(A=r[$],A instanceof Y){if(m&A.qualifier){d&A.qualifier?F[$]=A:((S=S||{})[$]=A.factory(e,V,g),(L=L||[]).push($)),delete r[$];continue}if(b&A.qualifier){V[$]=A,delete r[$];continue}A=r[$]=A.factory(O,V,g)}D===U(A)&&(A[a]=O[$]||J)}for($ in V)V[_]($)&&(A=V[$],A instanceof Y&&(A=V[$]=A.factory(O,V,g)),D!==U(A)&&delete V[$]);if(g[i]=W(K(O),s,v),g[i]=Q(g[i],r),h=X(O),w={},w[c]=w[t]={value:g,enumerable:!1,writable:!0,configurable:!0},w[a]={value:h[0],enumerable:!1,writable:!0,configurable:!0},w[a+"v"]={value:h[1],enumerable:!1,writable:!0,configurable:!0},H(g[i],w),w={},C||L)for(C=z(C||[],L||[]),x=C.length,y=0;x>y;y++){if(E=C[y],j=null,S&&n!==S[E]){if((A=S[E])instanceof Y){if((m|d)&A.qualifier){F[E]=A;continue}j=A.factory(e,V,g)}else{if(F[_](E))continue;j=S[E]}D===U(j)&&(j[a]=e[E]||J)}else n!==e[E]&&(q=U(e[E]),j=R===q?Q(null,e[E]):(P|T)&q?e[E].slice(0):M&q?0+e[E]:e[E]);w[E]={value:j,enumerable:!1,writable:!0,configurable:!0}}for(E in F)F[_](E)&&(j=F[E].factory(e,V,g),w[E]={value:j,enumerable:!1,writable:!0,configurable:!0});return w[o]={value:C,enumerable:!1,writable:!0,configurable:!0},w[f]={value:F,enumerable:!1,writable:!0,configurable:!0},w[a]={value:e,enumerable:!1,writable:!0,configurable:!0},H(g,w),g},nn=Q,tn=Q,rn=function(e){var t,r,l,u;if(D===U(e)){if(a in e&&(e[a]=n),c in e&&(e[c]=n),f in e&&(e[f]=n),o in e){for(l=e[o],t=0,r=l.length;r>t;t++)u=l[t],u in e&&(D===U(e[u])&&e[u][a]&&(e[u][a]=n),e[u]=n);e[o]=n}l=e[i];for(u in l)D===U(l[u])&&(l[u][a]&&(l[u][a]=n),l[u]=n);l[a]=n,l[a+"v"]=n}},ln=function(){var e=arguments,n=e.length,t=null;if(m===e[0])return e[1]||{};if(n>=2){var r=U(e[0]);r=D===r?{Extends:e[0]}:R===r?e[0]:{Extends:p};var l,u,a=e[1]||{},o={},f=r[_]("Extends")?r.Extends:r[_]("extends")?r["extends"]:p,c=r[_]("Implements")?r.Implements:r[_]("implements")?r["implements"]:null,s=r[_]("Mixin")?r.Mixin:r[_]("mixin")?r.mixin:null,b=null;if(c=c?[].concat(c):null,s=s?[].concat(s):null)for(l=0,u=s.length;u>l;l++)R===U(s[l])?s[l][_]("mixin")&&s[l].mixin&&s[l].mixin[i]&&(b=W(s[l].mixin[i],s[l].namespace||null,s[l].as||null),o=tn(o,b)):s[l][i]&&(b=s[l][i],o=tn(o,b));if(c)for(l=0,u=c.length;u>l;l++)R===U(c[l])?c[l][_]("implements")&&c[l]["implements"]&&c[l]["implements"][i]&&(b=W(c[l].implements[i],c[l].namespace||null,c[l].as||null),o=nn(o,b)):c[l][i]&&(b=c[l][i],o=nn(o,b));t=R===U(f)?en(f.extends||p,Q(o,a),f.namespace||null,f.as||null):en(f,Q(o,a))}else t=en(p,e[0]);return t};e.Classy={VERSION:"0.9.3",PUBLIC:s,STATIC:m,LATE:d,PRIVATE:b,Type:U,Create:K,Merge:Q,Alias:W,Implements:nn,Mixin:tn,Extends:en,Dispose:rn,Method:Y,Prop:Z,Class:ln}}(e),e.Classy});
/**
*
*   MOD3.js
*   @version: 0.6.0
*   @dependencies: Classy.js
*
*   MOD3 3D Modifier Library for JavaScript 
*   port of AS3DMod ActionScript3 library (http://code.google.com/p/as3dmod/)
*   https://github.com/foo123/MOD3
*
**/!function(t,e,r){"use strict";var n;"object"==typeof module&&module.exports?module.exports=r.call(t,{}):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(e,[],function(n){n(e,r.call(t,{}))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["require","exports","module"],function(){return r.call(t,{})}):e in t||(t[e]=n=r.call(t,{}))&&"function"==typeof define&&define.amd&&define(function(){return n})}(this,"MOD3",function(t){"use strict";var e=t.MOD3={VERSION:"0.6.0",Class:Classy.Class,StaticClass:function(t){return Classy.Class(Classy.STATIC,t)}};return!function(t,e){t.Constants={PI:Math.PI,invPI:1/Math.PI,halfPI:.5*Math.PI,doublePI:2*Math.PI,toRad:Math.PI/180,toDeg:180/Math.PI},t.ModConstant={NONE:0,LEFT:-1,RIGHT:1,X:1,Y:2,Z:4,Xi:0,Yi:1,Zi:2},t.XYZi=[null,0,1,null,2],t.iXYZ=[1,2,4],t.xyz=["x","y","z"],t.XYZ=["X","Y","Z"],t.Array32F="undefined"!=typeof Float32Array?Float32Array:Array,t.Array64F="undefined"!=typeof Float64Array?Float64Array:Array,t.Array8I="undefined"!=typeof Int8Array?Int8Array:Array,t.Array16I="undefined"!=typeof Int16Array?Int16Array:Array,t.Array32I="undefined"!=typeof Int32Array?Int32Array:Array,t.Array8U="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Array16U="undefined"!=typeof Uint16Array?Uint16Array:Array,t.Array32U="undefined"!=typeof Uint32Array?Uint32Array:Array,t.VecArray=t.Array32F}(e),!function(t,e){var r,n=t.Constants.toRad,i=t.Constants.toDeg,s=(Math.min,Math.max,Math.pow),o=Math.round,u=Math.floor,a=Math.ceil,c=t.XMath=t.StaticClass({normalize:function(t,e,n){var i=e-t;return 0===i?1:r(0,1,(n-t)/e)},toRange:function(t,e,r){var n=e-t;return 0===n?0:t+n*r},inRange:function(t,e,r,n){return!1!==n?r>=t&&e>=r:r>t&&e>r},sign:function(t,e){return 0==t?e||0:t>0?1:-1},trim:function(t,e,r){return t>r?t:r>e?e:r},wrap:function(t,e,r){var n=e-t;return t>r?r+n:r>=e?r-n:r},degToRad:function(t){return t*n},radToDeg:function(t){return t*i},presicion:function(t,e){var r=s(10,e);return o(t*r)/r},uceil:function(t){return 0>t?u(t):a(t)}});r=c.clamp=c.trim}(e),!function(t,e){var r=t.XMath.normalize,n=t.XMath.toRange,i=t.XMath.trim;t.Range=t.Class({constructor:function(t,e){var r=this;r.start=null!=t?t:0,r.end=null!=e?e:1},name:"Range",start:0,end:1,dispose:function(){var t=this;return t.start=null,t.end=null,t},getSize:function(){return this.end-this.start},move:function(t){this.start+=t,this.end+=t},isIn:function(t){return t>=this.start&&t<=this.end},normalize:function(t){return r(this.start,this.end,t)},toRange:function(t){return n(this.start,this.end,t)},trim:function(t){return i(this.start,this.end,t)},interpolate:function(t,e){return n(this.start,this.end,e.normalize(t))},toString:function(){return"["+this.start+" - "+this.end+"]"}})}(e),!function(t,e){var r=Math.sin,n=Math.abs;t.Phase=t.Class({constructor:function(t){this.value=0,null!=t&&(this.value=t)},name:"Phase",value:0,dispose:function(){return this.value=null,this},getPhasedValue:function(){return r(this.value)},getAbsPhasedValue:function(){return n(r(this.value))},getNormValue:function(){return.5*(r(this.value)+1)}})}(e),!function(t,e){var r=t.Point=t.Class({constructor:function(t,e){var r=this;r.x=null==t?0:t,r.y=null==e?0:e},name:"Point",x:0,y:0,dispose:function(){var t=this;return t.x=null,t.y=null,t},clone:function(){return new r(this.x,this.y)}})}(e),!function(t,e){var r=Math.sin,n=Math.cos,i=t.Point,s=t.VecArray,o=t.Matrix=t.Class({__static__:{transform:function(t,e){var r=t.m,n=e[0],i=e[1];return e[0]=r[0]*n+r[1]*i,e[1]=r[2]*n+r[3]*i,e},mult:function(t,e){var r=t.m,n=e.m,i=r[0],s=r[1],o=r[2],u=r[3];return r[0]=i*n[0]+s*n[2],r[1]=i*n[1]+s*n[3],r[2]=o*n[0]+u*n[2],r[3]=o*n[1]+u*n[3],t}},constructor:function(t,r,n,i){this.m=new s([t===e?1:t,r===e?0:r,n===e?0:n,i===e?1:i])},name:"Matrix",m:null,dispose:function(){return this.m=null,this},reset:function(){var t=this.m;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,this},rotate:function(t){var e=this.m,i=n(t),s=r(t);return e[0]=i,e[1]=-s,e[2]=s,e[3]=i,this},scale:function(t,r){var n=this.m;return n[0]=1,n[1]=0,n[2]=0,n[3]=1,t!==e&&(n[0]=t,n[3]=t),r!==e&&(n[3]=r),this},multiply:function(t){return o.mult(this,t)},transformPoint:function(t){var e=o.transform(this,[t.x,t.y]);return new i(e[0],e[1])},transformPointSelf:function(t){var e=o.transform(this,[t.x,t.y]);return t.x=e[0],t.y=e[1],t},clone:function(){var t=this.m;return new o(t[0],t[1],t[2],t[3])}})}(e),!function(t,e){var r=Math.sqrt,n=t.VecArray,i=t.Vector3=t.Class({__static__:{ZERO:function(){return new i(0,0,0)},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},cross:function(t,e){var r=new n(3);return r[0]=t[1]*e[2]-t[2]*e[1],r[1]=t[2]*e[0]-t[0]*e[2],r[2]=t[0]*e[1]-t[1]*e[0],r},mod:function(t){var e=t[0],n=t[1],i=t[2];return r(e*e+n*n+i*i)},dist:function(t,e){var n=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2];return r(n*n+i*i+s*s)},add:function(t,e){return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t},sub:function(t,e){return t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t},mul:function(t,e){return t[0]*=e[0],t[1]*=e[1],t[2]*=e[2],t},muls:function(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t},norm:function(t){var e,n=t[0],i=t[1],s=t[2],o=n*n+i*i+s*s;return o>0&&(e=r(o),n/=e,i/=e,s/=e),t[0]=n,t[1]=i,t[2]=s,t}},constructor:function(t,e,r){var i=new n(3);t&&3===t.length?(i[0]=t[0]||0,i[1]=t[1]||0,i[2]=t[2]||0):(i[0]=t||0,i[1]=e||0,i[2]=r||0),this.xyz=i},name:"Vector3",xyz:null,dispose:function(){return this.xyz=null,this},getXYZ:function(){return new n(this.xyz)},getXYZRef:function(){return this.xyz},setXYZ:function(t){var e=this.xyz;return e[0]=t[0],e[1]=t[1],e[2]=t[2],this},setXYZRef:function(t){return this.xyz=t,this},clone:function(){return new i(this.xyz)},equalsSelf:function(t){var e=this.xyz,r=t.xyz;return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]},zeroSelf:function(){var t=this.xyz;return t[0]=0,t[1]=0,t[2]=0,this},negate:function(){var t=this.xyz;return new i(-t[0],-t[1],-t[2])},negateSelf:function(){var t=this.xyz;return t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],this},add:function(t){var e=this.xyz,r=t.xyz;return new i(e[0]+r[0],e[1]+r[1],e[2]+r[2])},addSelf:function(t){var e=this.xyz,r=t.xyz;return e[0]+=r[0],e[1]+=r[1],e[2]+=r[2],this},subtract:function(t){var e=this.xyz,r=t.xyz;return new i(e[0]-r[0],e[1]-r[1],e[2]-r[2])},subtractSelf:function(t){var e=this.xyz,r=t.xyz;return e[0]-=r[0],e[1]-=r[1],e[2]-=r[2],this},multiplyScalar:function(t){var e=this.xyz;return new i(e[0]*t,e[1]*t,e[2]*t)},multiplyScalarSelf:function(t){var e=this.xyz;return e[0]*=t,e[1]*=t,e[2]*=t,this},multiply:function(t){var e=this.xyz,r=t.xyz;return new i(e[0]*r[0],e[1]*r[1],e[2]*r[2])},multiplySelf:function(t){var e=this.xyz,r=t.xyz;return e[0]*=r[0],e[1]*=r[1],e[2]*=r[2],this},divide:function(t){var e=this.xyz;return new i(e[0]/t,e[1]/t,e[2]/t)},divideSelf:function(t){var e=this.xyz;return e[0]/=t,e[1]/=t,e[2]/=t,this},normalize:function(){var t,e=this.xyz,n=e[0],s=e[1],o=e[2],u=n*n+s*s+o*o;return u>0&&(t=r(u),n/=t,s/=t,o/=t),new i(n,s,o)},normalizeSelf:function(){var t,e=this.xyz,n=e[0],i=e[1],s=e[2],o=n*n+i*i+s*s;return o>0&&(t=r(o),n/=t,i/=t,s/=t),e[0]=n,e[1]=i,e[2]=s,this},getMagnitude:function(){var t=this.xyz,e=t[0],n=t[1],i=t[2];return r(e*e+n*n+i*i)},setMagnitude:function(t){this.normalizeSelf();var e=this.xyz;return e[0]*=t,e[1]*=t,e[2]*=t,this},dot:function(t){var e=this.xyz,r=t.xyz;return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]},cross:function(t){var e=this.xyz,r=t.xyz,n=e[0],s=e[1],o=e[2],u=r[0],a=r[1],c=r[2];return new i(s*c-o*a,o*u-n*c,n*a-s*u)},crossSelf:function(t){var t=this.xyz,e=b.xyz,r=t[0],n=t[1],i=t[2],s=e[0],o=e[1],u=e[2];return t[0]=n*u-i*o,t[1]=i*s-r*u,t[2]=r*o-n*s,this},distance:function(t){var e=this.xyz,n=t.xyz,i=e[0]-n[0],s=e[1]-n[1],o=e[2]-n[2];return r(i*i+s*s+o*o)},toString:function(){var t=this.xyz;return"["+t[0]+" , "+t[1]+" , "+t[2]+"]"}});i.modulo=i.mod,i.distance=i.dist,i.prototype.dotSelf=i.prototype.dot,i.prototype.distanceSelf=i.prototype.distance}(e),!function(t,e){var r=Math.sin,n=Math.cos,i=t.VecArray,s=t.Matrix4=t.Class({__static__:{multXYZ:function(t,e){var r=t.m,n=e[0],i=e[1],s=e[2];return e[0]=n*r[0]+i*r[1]+s*r[2]+r[3],e[1]=n*r[4]+i*r[5]+s*r[6]+r[7],e[2]=n*r[8]+i*r[9]+s*r[10]+r[11],e},mult:function(t,e){var r=t.m,n=e.m,i=r[0],s=n[0],o=r[4],u=n[4],a=r[8],c=n[8],l=r[1],h=n[1],f=r[5],v=n[5],p=r[9],x=n[9],d=r[2],m=n[2],y=r[6],g=n[6],M=r[10],V=n[10],X=r[3],Y=n[3],Z=r[7],A=n[7],w=r[11],z=n[11];return r[0]=i*s+l*u+d*c,r[1]=i*h+l*v+d*x,r[2]=i*m+l*g+d*V,r[3]=i*Y+l*A+d*z+X,r[4]=o*s+f*u+y*c,r[5]=o*h+f*v+y*x,r[6]=o*m+f*g+y*V,r[7]=o*Y+f*A+y*z+Z,r[8]=a*s+p*u+M*c,r[9]=a*h+p*v+M*x,r[10]=a*m+p*g+M*V,r[11]=a*Y+p*A+M*z+w,t}},constructor:function(t,r,n,s,o,u,a,c,l,h,f,v,p,x,d,m){this.m=new i([t===e?1:t,r===e?0:r,n===e?0:n,s===e?0:s,o===e?0:o,u===e?1:u,a===e?0:a,c===e?0:c,l===e?0:l,h===e?0:h,f===e?1:f,v===e?0:v,p===e?0:p,x===e?0:x,d===e?0:d,m===e?1:m])},name:"Matrix4",m:null,dispose:function(){return this.m=null,this},reset:function(){var t=this.m;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},translate:function(t,e,r,n){var i=this.m;return!0===n&&(i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1),i[3]=t,i[7]=e,i[11]=r,this},scale:function(t,e,r,n){var i=this.m;return!0===n&&(i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1),i[0]=t,i[5]=e,i[10]=r,this},rotate:function(t,e,i,s,o){var u=this.m,a=n(s),c=r(s),l=1-a,h=t*e*l,f=e*i*l,v=t*i*l,p=c*i,x=c*e,d=c*t;return!0===o&&(u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1),u[0]=a+t*t*l,u[1]=-p+h,u[2]=x+v,u[3]=0,u[4]=p+h,u[5]=a+e*e*l,u[6]=-d+f,u[7]=0,u[8]=-x+v,u[9]=d+f,u[10]=a+i*i*l,u[11]=0,this},translateFromVector:function(t,e){return this.translate(t.xyz[0],t.xyz[1],t.xyz[2],e)},scaleFromVector:function(t,e){return this.scale(t.xyz[0],t.xyz[1],t.xyz[2],e)},rotateFromVector:function(t,e,r){return this.rotate(t.xyz[0],t.xyz[1],t.xyz[2],e,r)},multiply:function(t){return s.mult(this,t)},multiplyVector:function(t){return s.multXYZ(this,t.xyz),t}});s.prototype.translationMatrix=s.prototype.translate,s.prototype.scaleMatrix=s.prototype.scale,s.prototype.rotationMatrix=s.prototype.rotate,s.prototype.translationMatrixFromVector=s.prototype.translateFromVector,s.prototype.scaleMatrixFromVector=s.prototype.scaleFromVector,s.prototype.rotationMatrixFromVector=s.prototype.rotateFromVector}(e),!function(t,e){t.List={operate:function(t,e,r,n,i,s){var o=t.length;if(arguments.length<5&&(i=o-1),0>i&&(i+=o),arguments.length<4&&(n=0),n>i)return r;if(!0===s){var u,a,c=i-n+1,l=c-1,h=15&c,f=1&h,v=l-h,p=f?e(r,t[i],i):r;for(u=l-f;u>v;u-=2)a=n+u,p=e(e(p,t[a],a),t[a-1],a-1);for(u=v;u>=0;u-=16)a=n+u,p=e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(p,t[a],a),t[a-1],a-1),t[a-2],a-2),t[a-3],a-3),t[a-4],a-4),t[a-5],a-5),t[a-6],a-6),t[a-7],a-7),t[a-8],a-8),t[a-9],a-9),t[a-10],a-10),t[a-11],a-11),t[a-12],a-12),t[a-13],a-13),t[a-14],a-14),t[a-15],a-15)}else{var u,a,c=i-n+1,h=15&c,f=1&h,p=f?e(r,t[n],n):r;for(u=f;h>u;u+=2)a=n+u,p=e(e(p,t[a],a),t[a+1],a+1);for(u=h;c>u;u+=16)a=n+u,p=e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(p,t[a],a),t[a+1],a+1),t[a+2],a+2),t[a+3],a+3),t[a+4],a+4),t[a+5],a+5),t[a+6],a+6),t[a+7],a+7),t[a+8],a+8),t[a+9],a+9),t[a+10],a+10),t[a+11],a+11),t[a+12],a+12),t[a+13],a+13),t[a+14],a+14),t[a+15],a+15)}return p},each:function(t,e,r,n,i){if(null==t||!t.length)return t;var s=t.length;if(arguments.length<4&&(n=s-1),0>n&&(n+=s),arguments.length<3&&(r=0),r>n)return t;var o,u,a,c,l,h,f=n-r+1;if(!0===i){for(a=f-1,l=15&f,h=1&l,c=a-l,h&&e(t[n]),o=a-h;o>c;o-=2)u=r+o,e(t[u]),e(t[u-1]);for(o=c;o>=0;o-=16)u=r+o,e(t[u]),e(t[u-1]),e(t[u-2]),e(t[u-3]),e(t[u-4]),e(t[u-5]),e(t[u-6]),e(t[u-7]),e(t[u-8]),e(t[u-9]),e(t[u-10]),e(t[u-11]),e(t[u-12]),e(t[u-13]),e(t[u-14]),e(t[u-15])}else{for(l=15&f,h=1&l,h&&e(t[r]),o=h;l>o;o+=2)u=r+o,e(t[u]),e(t[u+1]);for(o=l;f>o;o+=16)u=r+o,e(t[u]),e(t[u+1]),e(t[u+2]),e(t[u+3]),e(t[u+4]),e(t[u+5]),e(t[u+6]),e(t[u+7]),e(t[u+8]),e(t[u+9]),e(t[u+10]),e(t[u+11]),e(t[u+12]),e(t[u+13]),e(t[u+14]),e(t[u+15])}return t}}}(e),!function(t,e){var r,n,i,s,o=t.ModConstant,u=o.X,a=o.Y,c=o.Z,l=t.XYZi,h=(t.Vector3,t.VecArray),f=Math.min,v=Math.max,p=t.List.each,x=function(t){t.dispose()},d=function(t){t.reset()},m=function(t){t.collapse()};r=t.FaceProxy=t.Class({constructor:function(){this.vertices=[]},name:"FaceProxy",vertices:null,dispose:function(){var t=this;return t.vertices=null,t},addVertex:function(t){this.vertices.push(t)},getVertices:function(){return this.vertices}}),n=t.VertexProxy=t.Class({constructor:function(t,e){var r=this;r.mesh=e||null,r.original=new h([0,0,0]),r.ratio=new h([0,0,0]),null!=t&&r.setVertex(t)},name:"VertexProxy",mesh:null,vertex:null,original:null,ratio:null,dispose:function(){var t=this;return t.mesh=null,t.vertex=null,t.original=null,t.ratio=null,t},setVertex:function(t){var e=this;return e.vertex=t,e},getRatioVector:function(){var t=this.ratio,e=new h(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},getRatio:function(t){return this.ratio[l[t]]||0},setRatios:function(t,r,n){var i=this.ratio;return i[0]=t===e?0:t,i[1]=r===e?0:r,i[2]=n===e?0:n,this},getOriginalValue:function(t){return this.original[l[t]]||0},setOriginalPosition:function(t,r,n){var i=this.original;return i[0]=t===e?0:t,i[1]=r===e?0:r,i[2]=n===e?0:n,this},getXYZ:function(){return new h([0,0,0])},getX:function(){return 0},getY:function(){return 0},getZ:function(){return 0},getValue:function(t){var e=this;return u===t?e.getX():a===t?e.getY():c===t?e.getZ():0},setXYZ:function(t){return this},setX:function(t){return this},setY:function(t){return this},setZ:function(t){return this},setValue:function(t,e){var r=this;return u===t?r.setX(e):a===t?r.setY(e):c===t&&r.setZ(e),r},reset:function(){var t=this;return t.setXYZ(t.original),t},collapse:function(){var t=this,e=t.getXYZ(),r=t.original;return r[0]=e[0],r[1]=e[1],r[2]=e[2],t}}),i=t.MeshProxy=t.Class({constructor:function(t){var e=this;e.maxX=0,e.maxY=0,e.maxZ=0,e.minX=0,e.minY=0,e.minZ=0,e.maxAxis=0,e.midAxis=0,e.minAxis=0,e.width=0,e.height=0,e.depth=0,e.vertices=null,e.faces=null,e.mesh=null,null!=t&&e.setMesh(t)},name:"MeshProxy",maxX:0,maxY:0,maxZ:0,minX:0,minY:0,minZ:0,maxAxis:0,midAxis:0,minAxis:0,width:0,height:0,depth:0,vertices:null,faces:null,mesh:null,v:null,dispose:function(){var t=this;return t.maxX=null,t.maxY=null,t.maxZ=null,t.minX=null,t.minY=null,t.minZ=null,t.maxAxis=null,t.midAxis=null,t.minAxis=null,t.width=null,t.height=null,t.depth=null,t.disposeFaces(),t.disposeVertices(),t.mesh=null,t.v=null,t},disposeVertices:function(){var t=this;return p(t.vertices,x),t.vertices=null,t},disposeFaces:function(){var t=this;return p(t.faces,x),t.faces=null,t},init:function(t){var e=this;return e.mesh=t,e},setMesh:function(t){return this.init(t).preApply().analyzeGeometry().postApply()},getVertices:function(){return this.vertices},getFaces:function(){return this.faces},applyModifiers:function(t){var e,r,n=this;for(r=0,e=t.length;e>r;r++)t[r].enabled&&t[r].apply(n);return n},analyzeGeometry:function(){var t,e,r,n=this,i=n.vertices,s=0,o=0,l=0,h=0,x=0,d=0,m=0,y=0,g=0;return i&&i.length?(r=i[0].getXYZ(),s=r[0],o=r[1],l=r[2],h=r[0],x=r[1],d=r[2],p(i,function(t){var e=t.getXYZ(),r=e[0],n=e[1],i=e[2];s=f(s,r),o=f(o,n),l=f(l,i),h=v(h,r),x=v(x,n),d=v(d,i),t.setOriginalPosition(r,n,i)}),m=h-s,y=x-o,g=d-l,n.width=m,n.height=y,n.depth=g,n.minX=s,n.maxX=h,n.minY=o,n.maxY=x,n.minZ=l,n.maxZ=d,t=v(m,y,g),e=f(m,y,g),t===m&&e===y?(n.minAxis=a,n.midAxis=c,n.maxAxis=u):t===m&&e===g?(n.minAxis=c,n.midAxis=a,n.maxAxis=u):t===y&&e===m?(n.minAxis=u,n.midAxis=c,n.maxAxis=a):t===y&&e===g?(n.minAxis=c,n.midAxis=u,n.maxAxis=a):t===g&&e===m?(n.minAxis=u,n.midAxis=a,n.maxAxis=c):t===g&&e===y&&(n.minAxis=a,n.midAxis=u,n.maxAxis=c),p(i,function(t){var e=t.getXYZ();t.setRatios((e[0]-s)/m,(e[1]-o)/y,(e[2]-l)/g)}),n):n},resetGeometry:function(){var t=this;return p(t.vertices,d),t},collapseGeometry:function(){var t=this;return p(t.vertices,m),t.analyzeGeometry()},getMin:function(t){var e=this;return u===t?e.minX:a===t?e.minY:c===t?e.minZ:-1},getMax:function(t){var e=this;return u===t?e.maxX:a===t?e.maxY:c===t?e.maxZ:-1},getSize:function(t){var e=this;return u===t?e.width:a===t?e.height:c===t?e.depth:-1},update:function(){return this},preApply:function(){return this},postApply:function(){return this},updateMeshPosition:function(t){return this}}),t.Library3d={id:"Library3d",Mesh:i,Vertex:n},s=t.Factory=t.StaticClass({getLibrary:function(e){return e&&e.library&&t[e.library]?t[e.library]:t.Library3d},getMeshProxy:function(t){return arguments.length&&t.Mesh?new t.Mesh:null},getModifier:function(e){return e&&e.modifier&&t[e.modifier]?new t[e.modifier]:null}})}(e),!function(t,e){var r,n,i=0,s=t.ModConstant.NONE,o=t.Factory.getMeshProxy;r=t.Modifier=t.Class({constructor:function(){var t=this;t.id=++i,t.name="Modifier",t.axes=s,t.constraint=s,t.enabled=!0},id:null,name:"Modifier",axes:null,constraint:null,enabled:!0,dispose:function(){var t=this;return t.name=null,t.axes=null,t.constraint=null,t},enable:function(t){return arguments.length?(this.enabled=!!t,this):this.enabled},constraintAxes:function(t){return this.axes=t||s,this},setConstraint:function(t){return this.constraint=t||s,this},apply:function(t){return this},toString:function(){return"[Modifier "+this.name+"]"}}),n=t.ModifierStack=t.Class({constructor:function u(t,e){var r=this;return r instanceof u?(r.stack=[],void r.setModifiable(o(t),e)):new u(t,e)},name:"ModifierStack",modifiable:null,stack:null,dispose:function(t){var e=this;if(t&&e.stack)for(;e.stack.length;)e.stack.pop().dispose();return e.modifiable&&e.modifiable.dispose(),e.stack=null,e.modifiable=null,e},getModifiable:function(){return this.modifiable},setModifiable:function(t,e){var r=this;return r.modifiable=t,e&&r.modifiable.setMesh(e),r},add:function(t){var e=this;return t&&e.stack.push(t),e},apply:function(){var t=this,e=t.modifiable,r=t.stack;return e&&r&&r.length&&e.preApply().resetGeometry().applyModifiers(r).postApply().update(),t},collapse:function(){var t=this,e=t.modifiable;return e&&t.stack&&t.stack.length&&(e.preApply().resetGeometry().applyModifiers(t.stack).collapseGeometry().postApply().update(),t.stack.length=0),t},clear:function(){var t=this;return t.stack&&(t.stack.length=0),t}}),n.prototype.getMeshInfo=n.prototype.getModifiable,n.prototype.addModifier=n.prototype.add}(e),!function(t,e){var r=t.Vector3,n=t.List.each,i=r.add;t.Pivot=t.Class(t.Modifier,{constructor:function(t,e,n){var i=this;i.$super("constructor"),i.name="Pivot",i.pivot=new r(t||0,e||0,n||0)},pivot:null,dispose:function(){var t=this;return t.pivot.dispose(),t.pivot=null,t.$super("dispose"),t},setMeshCenter:function(t){var e=this;return e.pivot=new r(-(t.minX+.5*t.width),-(t.minY+.5*t.height),-(t.minZ+.5*t.depth)),e},apply:function(t){var e=this,r=e.pivot,s=r.xyz;return n(t.vertices,function(t){t.setXYZ(i(t.getXYZ(),s))}),t.updateMeshPosition(r.negate()),e}})}(e),!function(t,e){var r=t.ModConstant.NONE,n=t.ModConstant.LEFT,i=t.ModConstant.RIGHT,s=t.XYZi,o=t.Matrix,u=(Math.atan,Math.atan2,Math.sin),a=Math.cos,c=t.Constants.PI,l=t.Constants.halfPI,h=t.Constants.doublePI,f=Math.max,v=Math.min,p=t.List.each,x=o.transform;t.Bend=t.Class(t.Modifier,{constructor:function(t,n,i){var s=this;s.$super("constructor"),s.name="Bend",s.constraint=r,s.switchAxes=!1,s.force=t!==e?t:0,s.offset=n!==e?n:0,s.angle=i!==e?i:0},force:0,offset:0,angle:0,switchAxes:!1,dispose:function(){var t=this;return t.force=null,t.offset=null,t.angle=null,t.switchAxes=null,t.$super("dispose"),t},apply:function(t){var e=this;if(0==e.force)return e;var r=e.constraint,d=e.switchAxes,m=e.force,y=v(1,f(0,e.offset)),g=e.angle,M=d?t.midAxis:t.maxAxis,V=t.minAxis,X=d?t.maxAxis:t.midAxis,Y=t.getSize(M),Z=(t.getSize(X),t.getMin(M)),A=(new o).rotate(g),w=(new o).rotate(-g),z=Z+Y*y,C=Y/c/m,P=h*(Y/(C*h));return p(t.vertices,function(t){var e,o,c,h,f,v=t.getXYZ(),p=v[s[M]],d=v[s[X]],m=v[s[V]],g=x(A,[p,d]);p=g[0],d=g[1],e=(p-Z)/Y,n===r&&y>=e||i===r&&e>=y||(o=l-P*y+P*e,c=u(o)*(C+m),h=a(o)*(C+m),m=c-C,p=z-h),f=x(w,[p,d]),p=f[0],d=f[1],v[s[M]]=p,v[s[X]]=d,v[s[V]]=m,t.setXYZ(v)}),e}})}(e),!function(t,e){var r=t.Vector3,n=Math.max,i=Math.exp,s=t.List.each,o=r.add,u=r.sub,a=r.muls,c=r.mod,l=r.norm;t.Bloat=t.Class(t.Modifier,{constructor:function(){var t=this;t.$super("constructor"),t.name="Bloat",t.radius=0,t.a=.01,t.center=r.ZERO()},center:null,radius:0,a:.01,dispose:function(){var t=this;return t.center.dispose(),t.center=null,t.radius=null,t.a=null,t.$super("dispose"),t},apply:function(t){var e=this,r=e.center.xyz,h=n(0,e.radius),f=n(0,e.a);return s(t.vertices,function(t){var e=u(t.getXYZ(),r),n=c(e);a(l(e),n+h*i(-n*f)),t.setXYZ(o(e,r))}),e}})}(e),!function(t,e){var r=t.Vector3,n=(Math.sqrt,t.Matrix4),i=t.List.each,s=n.mult,o=r.dot,u=r.mod;t.Twist=t.Class(t.Modifier,{constructor:function(t){var n=this;n.$super("constructor"),n.name="Twist",n.vector=new r(0,1,0),n.angle=t!==e?t:0,n.center=r.ZERO()},vector:null,angle:0,center:null,dispose:function(){var t=this;return t.vector.dispose(),t.vector=null,t.angle=null,t.center.dispose(),t.center=null,t.$super("dispose"),t},apply:function(t){var e=this,r=e.vector.normalizeSelf(),a=e.angle,c=e.center,l=r.xyz,h=u([.5*t.maxX,.5*t.maxY,.5*t.maxZ]),f=-o(l,c.xyz),v=new n,p=new n;return i(t.vertices,function(t){var e=t.getXYZ(),r=(o(e,l)+f)*a/h,n=s(p.rotate(l[0],l[1],l[2],r,!0),v.translate(e[0],e[1],e[2],!0));t.setXYZ([n.m[3],n.m[7],n.m[11]])}),e}})}(e),!function(t,e){var r=Math.abs,n=Math.pow,i=Math.max,s=Math.min,o=t.ModConstant,u=o.NONE,a=o.LEFT,c=o.RIGHT,l=o.X,h=o.Y,f=o.Z,v=t.List.each;t.Skew=t.Class(t.Modifier,{constructor:function(t){var r=this;r.$super("constructor"),r.name="Skew",r.force=t!==e?t:0,r.offset=.5,r.constraint=u,r.power=1,r.falloff=1,r.inverseFalloff=!1,r.oneSide=!1,r.swapAxes=!1,r.skewAxis=0},force:0,skewAxis:0,offset:.5,power:1,falloff:1,inverseFalloff:!1,oneSide:!1,swapAxes:!1,dispose:function(){var t=this;return t.force=null,t.skewAxis=null,t.offset=null,t.power=null,t.falloff=null,t.inverseFalloff=null,t.oneSide=null,t.swapAxes=null,t.$super("dispose"),t},apply:function(t){var e=this,o=e.constraint,u=e.skewAxis||t.maxAxis,p=e.swapAxes,x=s(1,i(0,e.offset)),d=e.oneSide,m=e.inverseFalloff,y=s(1,i(0,e.falloff)),g=1-y,M=e.power,V=e.force,X=l===u?p?f:h:h===u?p?f:l:f===u?p?h:l:0;return v(t.vertices,function(t){var e,i,s,l,h;h=t.getRatio(u),a===o&&x>=h||c===o&&h>x||(e=h-x,d&&0>e&&(e=-e),i=t.getRatio(X),m&&(i=1-i),s=y+i*g,l=(0>e?-1:1)*n(r(e),M),t.setValue(X,t.getValue(X)+V*l*s))}),e}})}(e),!function(t,e){var r=t.Vector3,n=t.Matrix4,i=Math.pow,s=r.mul,o=r.mod,u=t.List.each,a=n.multXYZ;t.Taper=t.Class(t.Modifier,{constructor:function(t,n){var i=this;i.$super("constructor"),i.name="Taper",i.vector=new r(1,0,1),i.vector2=new r(0,1,0),i.force=t!==e?t:0,i.power=n!==e?n:1},force:0,power:1,vector:null,vector2:null,dispose:function(){var t=this;return t.vector.dispose(),t.vector2.dispose(),t.vector=null,t.vector2=null,t.force=null,t.power=null,t.$super("dispose"),t},apply:function(t){var e=this,r=e.vector.xyz,c=e.vector2.xyz,l=e.force,h=e.power,f=new n;return u(t.vertices,1!=h?function(t){var e=o(s(t.getRatioVector(),c)),n=l*i(e,h);t.setXYZ(a(f.scale(1+n*r[0],1+n*r[1],1+n*r[2]),t.getXYZ()))}:function(t){var e=o(s(t.getRatioVector(),c)),n=l*e;t.setXYZ(a(f.scale(1+n*r[0],1+n*r[1],1+n*r[2]),t.getXYZ()))}),e}})}(e),!function(t,e){var r=(t.Constants.invPI,t.Constants.doublePI,t.Vector3),n=t.Matrix4,i=t.List.each,s=n.multXYZ;t.Wheel=t.Class(t.Modifier,{constructor:function(){var t=this;t.$super("constructor"),t.name="Wheel",t.speed=0,t.turn=0,t.roll=0,t.steerVector=new r([0,1,0]),t.rollVector=new r([0,0,1])},speed:0,turn:0,roll:0,steerVector:null,rollVector:null,dispose:function(){var t=this;return t.speed=null,t.turn=null,t.roll=null,t.steerVector.dispose(),t.rollVector.dispose(),t.steerVector=null,t.rollVector=null,t.$super("dispose"),t},apply:function(t){var e=this,r=e.steerVector,o=e.turn,u=e.rollVector,a=e.roll,c=null,l=null;return e.roll+=e.speed,o?(l=(new n).rotateFromVector(r,o),c=(new n).rotateFromVector(l.multiplyVector(u.clone()),a)):c=(new n).rotateFromVector(u,a),i(t.vertices,l?function(t){t.setXYZ(s(c,s(l,t.getXYZ())))}:function(t){t.setXYZ(s(c,t.getXYZ()))}),e}})}(e),!function(t,e){var r=t.Vector3,n=t.Range,i=t.Matrix4,s=Math.max,o=Math.min,u=t.List.each,a=i.multXYZ;t.Break=t.Class(t.Modifier,{constructor:function(t,i){var s=this;s.$super("constructor"),s.name="Break",s.bv=new r([0,1,0]),s.range=new n(0,1),s.offset=t!==e?t:0,s.angle=i!==e?i:0},bv:null,range:null,offset:0,angle:0,dispose:function(){var t=this;return t.bv.dispose(),t.range.dispose(),t.bv=null,t.range=null,t.offset=null,t.angle=null,t.$super("dispose"),t},apply:function(t){var e,r,n=this,c=o(1,s(0,n.offset)),l=n.range,h=n.angle,f=n.bv.xyz;return e=t.minZ+t.depth*c,r=(new i).rotate(f[0],f[1],f[2],h),u(t.vertices,function(t){var n=t.getXYZ();n[2]-=e,0<=n[2]&&l.isIn(t.ratio[1])&&a(r,n),n[2]+=e,t.setXYZ(n)}),n}})}(e),!function(t,e){var r=(t.ModConstant.NONE,t.ModConstant.X),n=t.ModConstant.Y,i=t.ModConstant.Z,s=Math.random,o=t.List.each;t.Noise=t.Class(t.Modifier,{constructor:function(t){var s=this;s.$super("constructor"),s.name="Noise",s.axes=r|n|i,s.start=0,s.end=1,s.force=t!==e?t:0},force:0,start:0,end:1,dispose:function(){var t=this;return t.force=null,t.start=null,t.end=null,t.$super("dispose"),t},setFalloff:function(t,r){var n=this;return n.start=t!==e?t:0,n.end=r!==e?r:1,n},apply:function(t){var e=this,u=e.axes,a=e.start,c=e.end,l=e.force,h=.5*l,f=t.maxAxis;return 0==u||0==l?e:(o(t.vertices,function(t){var e,o,v=s()*l-h,p=t.getRatio(f);c>a?a>p?p=0:p>c&&(p=1):a>c?(p=1-p,p>a?p=0:c>p&&(p=1)):p=1,e=v*p,o=t.getXYZ(),t.setXYZ([o[0]+(u&r?e:0),o[1]+(u&n?e:0),o[2]+(u&i?e:0)])}),e)}})}(e),!function(t,e){var r=t.ModConstant,n=(r.NONE,r.X),i=r.Y,s=r.Z,o=t.List.each;t.DisplaceMap=t.Class(t.Modifier,{constructor:function(t,e){var r=this;r.$super("constructor"),r.name="DisplaceMap",+t==t?r.force=t||1:(r.setBitmap(t),r.force=e||1),r.offset=127,r.axes=n|i|s},width:null,height:null,bmpData:null,force:1,offset:127,dispose:function(){var t=this;return t.bmpData=null,t.width=null,t.height=null,t.force=null,t.offset=null,t.$super("dispose"),t},setBitmap:function(t){var e=this;return e.bmpData=t?t.data:null,e.width=t?t.width:0,e.height=t?t.height:0,e},apply:function(t){var e=this,r=e.axes,u=e.width,a=e.height,c=e.bmpData,l=e.force,h=e.offset;return r&&c?(o(t.vertices,function(t){var e,o,f,v=t.getXYZ();o=~~((u-1)*t.ratio[0]),f=~~((a-1)*t.ratio[2]),e=f*u+o<<2,t.setXYZ([v[0]+(r&n?((255&c[e])-h)*l:0),v[1]+(r&i?((255&c[e+1])-h)*l:0),v[2]+(r&s?((255&c[e+2])-h)*l:0)])}),e):e}})}(e),!function(t,e){function r(t,e,r,i,s){var o,u,a,c,l,h=e*r,f=new n(h);for(0>i&&(i+=e),0>s&&(s+=r),i=~~i,s=~~s,o=0,u=0,l=0;h>l;l++,o++)o>=e&&(o=0,u++),a=(o+i)%e,c=(u+s)%r,f[l]=t[a+c*e];return f}var n=(t.Vector3,Math.round,t.VecArray),i=t.ModConstant,s=(i.NONE,i.X),o=i.Y,u=i.Z,a=t.List.each;t.Perlin=t.Class(t.Modifier,{constructor:function(t,r,n){var i=this;i.$super("constructor"),i.name="Perlin",i.force=t||1,i.perlin=r,i.autoRun=e!==n?!!n:!0,i.axes=s|o|u},speedX:1,speedY:1,perlin:null,force:1,offset:0,autoRun:!0,dispose:function(){var t=this;return t.perlin=null,t.speedX=null,t.speedY=null,t.force=null,t.offset=null,t.autoRun=null,t.$super("dispose"),t},setSpeed:function(t,e){var r=this;return r.speedX=t,r.speedY=e,r},apply:function(t){var e=this,n=e.axes,i=e.force,c=e.offset,l=e.perlin,h=l.width,f=l.height;return n&&l?(e.autoRun&&(l=e.perlin=r(l,h,f,e.speedX,e.speedY),l.width=h,l.height=f),a(t.vertices,function(t){var e=t.getXYZ(),r=~~((h-1)*t.ratio[0]),a=~~((f-1)*t.ratio[2]),v=r+a*h;t.setXYZ([e[0]+(n&s?(l[v]-c)*i:0),e[1]+(n&o?(l[v]-c)*i:0),e[2]+(n&u?(l[v]-c)*i:0)])}),e):e}})}(e),!function(t,e){var r,n,i=t.ModConstant,s=(i.X,i.Y,i.Z,t.xyz),o=t.XYZi,u=t.VecArray;r=t.VertexThree=t.Class(t.VertexProxy,{constructor:function(t,e){var r=this;r.$super("constructor",t,e),r.name="VertexThree"},setVertex:function(t){var e=this;return e.vertex=t,e.original=new u([t.x,t.y,t.z]),e},getXYZ:function(){var t=this.vertex,e=new u(3);return e[0]=t.x,e[1]=t.y,e[2]=t.z,e},getX:function(){return this.vertex.x},getY:function(){return this.vertex.y},getZ:function(){return this.vertex.z},getValue:function(t){return this.vertex[s[o[t]]]||0},setXYZ:function(t){var e=this.vertex;return e.x=t[0],e.y=t[1],e.z=t[2],this},setX:function(t){return this.vertex.x=t,this},setY:function(t){return this.vertex.y=t,this},setZ:function(t){return this.vertex.z=t,this},setValue:function(t,e){return this.vertex[s[o[t]]]=e,this},reset:function(){var t=this,e=t.vertex,r=t.original;return e.x=r[0],e.y=r[1],e.z=r[2],t},collapse:function(){var t=this,e=t.vertex,r=t.original;return r[0]=e.x,r[1]=e.y,r[2]=e.z,t}}),n=t.MeshThree=t.Class(t.MeshProxy,{constructor:function(t){var e=this;e.$super("constructor",t),e.name="MeshThree"},init:function(t){var e=this;e.$super("init",t);var n,i,t=e.mesh,s=t.geometry.vertices,o=s.length;for(e.faces=null,e.vertices=n=new Array(o),i=0;o>i;i++)n[i]=new r(s[i],e);return e},update:function(){var t=this,e=t.mesh.geometry;return e.verticesNeedUpdate=!0,e.elementsNeedUpdate=!0,e.uvsNeedUpdate=!0,e.normalsNeedUpdate=!0,e.colorsNeedUpdate=!0,e.lineDistancesNeedUpdate=!0,e.groupsNeedUpdate=!0,e.buffersNeedUpdate=!0,e.dynamic=!0,t},updateMeshPosition:function(t){var e=this,r=e.mesh.position,n=t.xyz;return r.x+=n[0],r.y+=n[1],r.z+=n[2],e}}),t.LibraryThree={id:"Three",Mesh:n,Vertex:r}}(e),!function(t,e){var r,n,i=t.ModConstant,s=(i.X,i.Y,i.Z,t.XYZi),o=t.VecArray,u=Math.ceil;r=t.VertexOSG=t.Class(t.VertexProxy,{constructor:function(t,e){var r=this;r.$super("constructor",t,e),r.name="VertexOSG"},setVertex:function(t){var e=this,r=e.mesh.mesh.getVertexAttributeList().Vertex.getElements();return e.vertex=t,e.original=new o([r[t],r[t+1],r[t+2]]),e},getXYZ:function(){var t=this,e=t.vertex,r=t.mesh.v,n=new o(3);return n[0]=r[e],n[1]=r[e+1],n[2]=r[e+2],n},getX:function(){return this.mesh.v[this.vertex]},getY:function(){return this.mesh.v[this.vertex+1]},getZ:function(){return this.mesh.v[this.vertex+2]},getValue:function(t){return this.mesh.v[this.vertex+s[t]]||0},setXYZ:function(t){var e=this,r=e.vertex,n=e.mesh.v;return n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2],e},setX:function(t){return this.mesh.v[this.vertex]=t,this},setY:function(t){return this.mesh.v[this.vertex+1]=t,this},setZ:function(t){return this.mesh.v[this.vertex+2]=t,this},setValue:function(t,e){return this.mesh.v[this.vertex+s[t]]=e,this},reset:function(){var t=this,e=t.vertex,r=t.mesh.v,n=t.original;return r[e]=n[0],r[e+1]=n[1],r[e+2]=n[2],t},collapse:function(){var t=this,e=t.vertex,r=t.mesh.v,n=t.original;return n[0]=r[e],n[1]=r[e+1],n[2]=r[e+2],t}}),n=t.MeshOSG=t.Class(t.MeshProxy,{constructor:function(t){var e=this;e.$super("constructor",t),e.name="MeshOSG"},init:function(t){var e=this;e.$super("init",t);var n,i,s,t=e.mesh,o=t.getVertexAttributeList().Vertex,a=o?o.getElements()||[]:[],c=a.length,l=o?o.getItemSize():0;if(e.faces=null,c>0&&l>2)for(e.vertices=n=new Array(u(c/l)),s=0,i=0;c>i;i+=l)n[s++]=new r(i,e);else e.vertices=[];return e},update:function(){var t=this;return t.mesh.dirty(),t},preApply:function(){var t=this;return t.v=t.mesh.getVertexAttributeList().Vertex.getElements(),t},postApply:function(){var t=this;return t.v=null,t}}),t.LibraryOSG={id:"OSG",Mesh:n,Vertex:r}}(e),!function(t,e){var r,n,i=t.ModConstant,s=(i.X,i.Y,i.Z,t.XYZi),o=t.VecArray,u=Math.ceil;r=t.VertexJ3D=t.Class(t.VertexProxy,{constructor:function(t,e){var r=this;r.$super("constructor",t,e),r.name="VertexJ3D"},setVertex:function(t){var e=this,r=e.mesh.mesh.geometry.arraysByName[J3D.Mesh.VERTEX_POSITION].data;return e.vertex=t,e.original=new o([r[t],r[t+1],r[t+2]]),e},getXYZ:function(){var t=this,e=t.vertex,r=t.mesh.v,n=new o(3);return n[0]=r[e],
n[1]=r[e+1],n[2]=r[e+2],n},getX:function(){return this.mesh.v[this.vertex]},getY:function(){return this.mesh.v[this.vertex+1]},getZ:function(){return this.mesh.v[this.vertex+2]},getValue:function(t){return this.mesh.v[this.vertex+s[t]]||0},setXYZ:function(t){var e=this,r=e.vertex,n=e.mesh.v;return n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2],e},setX:function(t){return this.mesh.v[this.vertex]=t,this},setY:function(t){return this.mesh.v[this.vertex+1]=t,this},setZ:function(t){return this.mesh.v[this.vertex+2]=t,this},setValue:function(t,e){return this.mesh.v[this.vertex+s[t]]=e,this},reset:function(){var t=this,e=t.vertex,r=t.mesh.v,n=t.original;return r[e]=n[0],r[e+1]=n[1],r[e+2]=n[2],t},collapse:function(){var t=this,e=t.vertex,r=t.mesh.v,n=t.original;return n[0]=r[e],n[1]=r[e+1],n[2]=r[e+2],t}}),n=t.MeshJ3D=t.Class(t.MeshProxy,{constructor:function(t){var e=this;e.$super("constructor",t),e.name="MeshJ3D"},init:function(t){var e=this;e.$super("init",t);var n,i,s,o=t.geometry,a=o.arraysByName[J3D.Mesh.VERTEX_POSITION],c=a.data,l=c.length,h=a.itemSize;for(e.faces=null,e.vertices=s=new Array(u(l/h)),i=0,n=0;l>n;n+=h)s[i++]=new r(n,e);return e},update:function(){var t=this,e=t.mesh.geometry,r=e.arraysByName[J3D.Mesh.VERTEX_POSITION],n=r.data;return e.replaceArray(r,n),t},preApply:function(){var t=this;return t.v=t.mesh.geometry.arraysByName[J3D.Mesh.VERTEX_POSITION].data,t},postApply:function(){var t=this;return t.v=null,t}}),t.LibraryJ3D={id:"J3D",Mesh:n,Vertex:r}}(e),!function(t,e){var r,n,i=t.ModConstant,s=(i.X,i.Y,i.Z,t.XYZi),o=t.VecArray;r=t.VertexCubicVR=t.Class(t.VertexProxy,{constructor:function(t,e){var r=this;r.$super("constructor",t,e),r.name="VertexCubicVR"},setVertex:function(t){var e=this;return e.vertex=t,e.original=new o([t[0],t[1],t[2]]),e},getXYZ:function(){var t=this.vertex,e=new o(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},getX:function(){return this.vertex[0]},getY:function(){return this.vertex[1]},getZ:function(){return this.vertex[2]},getValue:function(t){return this.vertex[s[t]]||0},setXYZ:function(t){var e=this.vertex;return e[0]=t[0],e[1]=t[1],e[2]=t[2],this},setX:function(t){return this.vertex[0]=t,this},setY:function(t){return this.vertex[1]=t,this},setZ:function(t){return this.vertex[2]=t,this},setValue:function(t,e){return this.vertex[s[t]]=e,this},reset:function(){var t=this,e=t.vertex,r=t.original;return e[0]=r[0],e[1]=r[1],e[2]=r[2],t},collapse:function(){var t=this,e=t.vertex,r=t.original;return r[0]=e[0],r[1]=e[1],r[2]=e[2],t}}),n=t.MeshCubicVR=t.Class(t.MeshProxy,{constructor:function(t){var e=this;e.$super("constructor",t),e.name="MeshCubicVR"},init:function(t){var e=this;e.$super("init",t);var n,i,s=t.obj.points,o=s.length;for(e.faces=null,e.vertices=n=new Array(o),i=0;o>i;i++)n[i]=new r(s[i],e);return e},update:function(){var t=this;return t.mesh.dirty=!0,t},updateMeshPosition:function(t){var e=this,r=e.mesh.position,n=t.xyz;return r[0]+=n[0],r[1]+=n[1],r[2]+=n[2],e}}),t.LibraryCubicVR={id:"CubicVR",Mesh:n,Vertex:r}}(e),!function(t,e){var r,n,i=t.ModConstant,s=(i.X,i.Y,i.Z,t.XYZ),o=t.XYZi,u=t.VecArray,a=t.List.each;r=t.VertexCopperlicht=t.Class(t.VertexProxy,{constructor:function(t,e){var r=this;r.$super("constructor",t,e),r.name="VertexCopperlicht"},setVertex:function(t){var e=this;return e.vertex=t,e.original=new u([t.X,t.Y,t.Z]),e},getXYZ:function(){var t=this.vertex,e=new u(3);return e[0]=t.X,e[1]=t.Y,e[2]=t.Z,e},getX:function(){return this.vertex.X},getY:function(){return this.vertex.Y},getZ:function(){return this.vertex.Z},getValue:function(t){return this.vertex[s[o[t]]]||0},setXYZ:function(t){var e=this.vertex;return e.X=t[0],e.Y=t[1],e.Z=t[2],self},setX:function(t){return this.vertex.X=t,this},setY:function(t){return this.vertex.Y=t,this},setZ:function(t){return this.vertex.Z=t,this},setValue:function(t,e){return this.vertex[s[o[t]]]=e,this},reset:function(){var t=this,e=t.vertex,r=t.original;return e.X=r[0],e.Y=r[1],e.Z=r[2],t},collapse:function(){var t=this,e=t.vertex,r=t.original;return r[0]=e.X,r[1]=e.Y,r[2]=e.Z,t}}),n=t.MeshCopperlicht=t.Class(t.MeshProxy,{constructor:function(t){var e=this;e.$super("constructor",t),e.name="MeshCopperlicht"},init:function(t){var e=this;e.$super("init",t);var n,i,s,o,u,a,c=e.mesh.getMesh().GetMeshBuffers();for(e.faces=null,e.vertices=o=[],i=0,s=c.length;s>i;i++)for(n=0,u=c[i].Vertices,a=u.length;a>n;n++)o.push(new r(u[n].Pos,e));return e},update:function(){var t=this;return a(t.mesh.getMesh().GetMeshBuffers(),function(t){t.update(!0)}),t},updateMeshPosition:function(t){var e=this,r=e.mesh.Pos,n=t.xyz;return r.X+=n[0],r.Y+=n[1],r.Z+=n[2],e}}),t.LibraryCopperlicht={id:"Copperlicht",Mesh:n,Vertex:r}}(e),!function(t,e){var r,n,i=t.ModConstant,s=(i.X,i.Y,i.Z,t.xyz),o=t.XYZi,u=t.VecArray;r=t.VertexPre3D=t.Class(t.VertexProxy,{constructor:function(t,e){var r=this;r.$super("constructor",t,e),r.name="VertexPre3D"},setVertex:function(t){var e=this;return e.vertex=t,e.original=new u([t.x,t.y,t.z]),e},getXYZ:function(){var t=this.vertex,e=new u(3);return e[0]=t.x,e[1]=t.y,e[2]=t.z,e},getX:function(){return this.vertex.x},getY:function(){return this.vertex.y},getZ:function(){return this.vertex.z},getValue:function(t){return this.vertex[s[o[t]]]||0},setXYZ:function(t){var e=this.vertex;return e.x=t[0],e.y=t[1],e.z=t[2],this},setX:function(t){return this.vertex.x=t,this},setY:function(t){return this.vertex.y=t,this},setZ:function(t){return this.vertex.z=t,this},setValue:function(t,e){return this.vertex[s[o[t]]]=e,self},reset:function(){var t=this,e=t.vertex,r=t.original;return e.x=r[0],e.y=r[1],e.z=r[2],t},collapse:function(){var t=this,e=t.vertex,r=t.original;return r[0]=e.x,r[1]=e.y,r[2]=e.z,t}}),n=t.MeshPre3D=t.Class(t.MeshProxy,{constructor:function(t){var e=this;e.$super("constructor",t),e.name="MeshPre3D"},init:function(t){var e=this;e.$super("init",t);var n,i,s=e.mesh.vertices,o=s.length;for(e.faces=null,e.vertices=n=new Array(o),i=0;o>i;i++)n[i]=new r(s[i],e);return e}}),t.LibraryPre3D={id:"Pre3D",Mesh:n,Vertex:r}}(e),t.MOD3});
