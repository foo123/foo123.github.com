/**
 * dat.gui Javascript Controller Library
 * http://dataarts.github.com/dat.gui
 *
 * Copyright 2011 Data Arts Team, Google Creative Lab
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 **/
 var DAT=DAT||{};DAT.GUI=function(parameters){void 0==parameters&&(parameters={});var paramsExplicitHeight=!1;void 0==parameters.height?parameters.height=300:paramsExplicitHeight=!0;var MIN_WIDTH=240,MAX_WIDTH=500,controllers=[],listening=[],autoListen=!0,listenInterval,controllerHeight,_this=this,open=!0,width=280;void 0!=parameters.width&&(width=parameters.width);var explicitOpenHeight=!1,openHeight,closeString="Close Controls",openString="Open Controls",name,resizeTo=0,resizeTimeout;this.domElement=document.createElement("div"),this.domElement.setAttribute("class","guidat"),this.domElement.style.width=width+"px";var curControllerContainerHeight=parameters.height,controllerContainer=document.createElement("div");controllerContainer.setAttribute("class","guidat-controllers"),controllerContainer.style.height=curControllerContainerHeight+"px",controllerContainer.addEventListener("DOMMouseScroll",function(e){var t=this.scrollTop;e.wheelDelta?t+=e.wheelDelta:e.detail&&(t+=e.detail),e.preventDefault&&e.preventDefault(),e.returnValue=!1,controllerContainer.scrollTop=t},!1);var toggleButton=document.createElement("a");toggleButton.setAttribute("class","guidat-toggle"),toggleButton.setAttribute("href","#"),toggleButton.innerHTML=open?closeString:openString;var toggleDragged=!1,dragDisplacementY=0,dragDisplacementX=0,togglePressed=!1,my,pmy,mx,pmx,resize=function(e){pmy=my,pmx=mx,my=e.pageY,mx=e.pageX;var t=my-pmy;if(!open){if(!(t>0))return;open=!0,curControllerContainerHeight=openHeight=1,toggleButton.innerHTML=name||closeString}var n=pmx-mx;if(t>0&&curControllerContainerHeight>controllerHeight){var o=DAT.GUI.map(curControllerContainerHeight,controllerHeight,controllerHeight+100,1,0);t*=o}toggleDragged=!0,dragDisplacementY+=t,openHeight+=t,curControllerContainerHeight+=t,controllerContainer.style.height=openHeight+"px",dragDisplacementX+=n,width+=n,width=DAT.GUI.constrain(width,MIN_WIDTH,MAX_WIDTH),_this.domElement.style.width=width+"px",checkForOverflow()};toggleButton.addEventListener("mousedown",function(e){return pmy=my=e.pageY,pmx=mx=e.pageX,togglePressed=!0,e.preventDefault(),dragDisplacementX=0,dragDisplacementY=0,document.addEventListener("mousemove",resize,!1),!1},!1),toggleButton.addEventListener("click",function(e){return e.preventDefault(),!1},!1),document.addEventListener("mouseup",function(e){if(togglePressed&&!toggleDragged&&_this.toggle(),togglePressed&&toggleDragged)if(0==dragDisplacementX&&adaptToScrollbar(),openHeight>controllerHeight)clearTimeout(resizeTimeout),openHeight=resizeTo=controllerHeight,beginResize();else if(controllerContainer.children.length>=1){var t=controllerContainer.children[0].offsetHeight;clearTimeout(resizeTimeout);var n=Math.round(curControllerContainerHeight/t)*t-1;resizeTo=n,0>=resizeTo?(_this.close(),openHeight=2*t):(openHeight=resizeTo,beginResize())}return document.removeEventListener("mousemove",resize,!1),e.preventDefault(),toggleDragged=!1,togglePressed=!1,!1},!1),this.domElement.appendChild(controllerContainer),this.domElement.appendChild(toggleButton),parameters.domElement?parameters.domElement.appendChild(this.domElement):DAT.GUI.autoPlace&&(null==DAT.GUI.autoPlaceContainer&&(DAT.GUI.autoPlaceContainer=document.createElement("div"),DAT.GUI.autoPlaceContainer.setAttribute("id","guidat"),document.body.appendChild(DAT.GUI.autoPlaceContainer)),DAT.GUI.autoPlaceContainer.appendChild(this.domElement)),this.autoListenIntervalTime=1e3/60;var createListenInterval=function(){listenInterval=setInterval(function(){_this.listen()},this.autoListenIntervalTime)};this.__defineSetter__("autoListen",function(e){autoListen=e,autoListen?listening.length>0&&createListenInterval():clearInterval(listenInterval)}),this.__defineGetter__("autoListen",function(){return autoListen}),this.listenTo=function(e){0==listening.length&&createListenInterval(),listening.push(e)},this.unlistenTo=function(e){for(var t=0;t<listening.length;t++)listening[t]==e&&listening.splice(t,1);listening.length<=0&&clearInterval(listenInterval)},this.listen=function(e){var t=e||listening;for(var n in t)t[n].updateDisplay()},this.listenAll=function(){this.listen(controllers)},this.autoListen=!0;var alreadyControlled=function(e,t){for(var n in controllers)if(controllers[n].object==e&&controllers[n].propertyName==t)return!0;return!1},construct=function(e,t){function n(){return e.apply(this,t)}return n.prototype=e.prototype,new n};this.add=function(){if(1==arguments.length){var e=[];for(var t in arguments[0])e.push(_this.add(arguments[0],t));return e}var n=arguments[0],o=arguments[1];alreadyControlled(n,o);var r=n[o];if(void 0==r&&n.get&&(r=n.get(o)),void 0==r)return DAT.GUI.error(n+" either has no property '"+o+"', or the property is inaccessible."),void 0;var i=typeof r,l=handlerTypes[i];if(void 0==l)return DAT.GUI.error("Cannot create controller for data type '"+i+"'"),void 0;for(var a=[this],s=0;s<arguments.length;s++)a.push(arguments[s]);var u=construct(l,a);if(!u)return DAT.GUI.error("Error creating controller for '"+o+"'."),void 0;if(controllerContainer.appendChild(u.domElement),controllers.push(u),DAT.GUI.allControllers.push(u),"function"!=i&&DAT.GUI.saveIndex<DAT.GUI.savedValues.length&&(u.setValue(DAT.GUI.savedValues[DAT.GUI.saveIndex]),DAT.GUI.saveIndex++),checkForOverflow(),explicitOpenHeight||(openHeight=controllerHeight),!paramsExplicitHeight)try{var c=arguments.callee.caller;c==window.onload&&(curControllerContainerHeight=resizeTo=openHeight=controllerHeight,controllerContainer.style.height=curControllerContainerHeight+"px")}catch(h){}return u};var checkForOverflow=function(){controllerHeight=0;for(var e in controllers)controllerHeight+=controllers[e].domElement.offsetHeight;controllerContainer.style.overflowY=controllerHeight-1>openHeight?"auto":"hidden"},handlerTypes={number:DAT.GUI.ControllerNumber,string:DAT.GUI.ControllerString,"boolean":DAT.GUI.ControllerBoolean,"function":DAT.GUI.ControllerFunction};this.reset=function(){for(var e=0,t=DAT.GUI.allControllers.length;t>e;e++)DAT.GUI.allControllers[e].reset()},this.toggle=function(){open?this.close():this.open()},this.open=function(){toggleButton.innerHTML=name||closeString,resizeTo=openHeight,clearTimeout(resizeTimeout),beginResize(),adaptToScrollbar(),open=!0},this.close=function(){toggleButton.innerHTML=name||openString,resizeTo=0,clearTimeout(resizeTimeout),beginResize(),adaptToScrollbar(),open=!1},this.name=function(e){name=e,toggleButton.innerHTML=e},this.appearanceVars=function(){return[open,width,openHeight,controllerContainer.scrollTop]};var beginResize=function(){curControllerContainerHeight=controllerContainer.offsetHeight,curControllerContainerHeight+=.6*(resizeTo-curControllerContainerHeight),Math.abs(curControllerContainerHeight-resizeTo)<1?curControllerContainerHeight=resizeTo:resizeTimeout=setTimeout(beginResize,1e3/30),controllerContainer.style.height=Math.round(curControllerContainerHeight)+"px",checkForOverflow()},adaptToScrollbar=function(){_this.domElement.style.width=width-1+"px",setTimeout(function(){_this.domElement.style.width=width+"px"},1)};if(DAT.GUI.guiIndex<DAT.GUI.savedAppearanceVars.length){if(width=parseInt(DAT.GUI.savedAppearanceVars[DAT.GUI.guiIndex][1]),_this.domElement.style.width=width+"px",openHeight=parseInt(DAT.GUI.savedAppearanceVars[DAT.GUI.guiIndex][2]),explicitOpenHeight=!0,1==eval(DAT.GUI.savedAppearanceVars[DAT.GUI.guiIndex][0])){curControllerContainerHeight=openHeight;var t=DAT.GUI.savedAppearanceVars[DAT.GUI.guiIndex][3];setTimeout(function(){controllerContainer.scrollTop=t},0),DAT.GUI.scrollTop>-1&&(document.body.scrollTop=DAT.GUI.scrollTop),resizeTo=openHeight,this.open()}DAT.GUI.guiIndex++}if(DAT.GUI.allGuis.push(this),1==DAT.GUI.allGuis.length&&(window.addEventListener("keyup",function(e){DAT.GUI.supressHotKeys||72!=e.keyCode||DAT.GUI.toggleHide()},!1),DAT.GUI.inlineCSS)){var styleSheet=document.createElement("style");styleSheet.setAttribute("type","text/css"),styleSheet.innerHTML=DAT.GUI.inlineCSS,document.head.insertBefore(styleSheet,document.head.firstChild)}},DAT.GUI.hidden=!1,DAT.GUI.autoPlace=!0,DAT.GUI.autoPlaceContainer=null,DAT.GUI.allControllers=[],DAT.GUI.allGuis=[],DAT.GUI.supressHotKeys=!1,DAT.GUI.toggleHide=function(){DAT.GUI.hidden?DAT.GUI.open():DAT.GUI.close()},DAT.GUI.open=function(){DAT.GUI.hidden=!1;for(var e in DAT.GUI.allGuis)DAT.GUI.allGuis[e].domElement.style.display="block"},DAT.GUI.close=function(){DAT.GUI.hidden=!0;for(var e in DAT.GUI.allGuis)DAT.GUI.allGuis[e].domElement.style.display="none"},DAT.GUI.saveURL=function(){var e=DAT.GUI.replaceGetVar("saveString",DAT.GUI.getSaveString());window.location=e},DAT.GUI.scrollTop=-1,DAT.GUI.load=function(e){var t=e.split(","),n=parseInt(t[0]);DAT.GUI.scrollTop=parseInt(t[1]);for(var o=0;n>o;o++){var r=t.splice(2,4);DAT.GUI.savedAppearanceVars.push(r)}DAT.GUI.savedValues=t.splice(2,t.length)},DAT.GUI.savedValues=[],DAT.GUI.savedAppearanceVars=[],DAT.GUI.getSaveString=function(){var e,t=[];t.push(DAT.GUI.allGuis.length),t.push(document.body.scrollTop);for(e in DAT.GUI.allGuis)for(var n=DAT.GUI.allGuis[e].appearanceVars(),o=0;o<n.length;o++)t.push(n[o]);for(e in DAT.GUI.allControllers)if("function"!=DAT.GUI.allControllers[e].type){var r=DAT.GUI.allControllers[e].getValue();"number"==DAT.GUI.allControllers[e].type&&(r=DAT.GUI.roundToDecimal(r,4)),t.push(r)}return t.join(",")},DAT.GUI.getVarFromURL=function(e){for(var t,n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),o=0;o<n.length;o++)if(t=n[o].split("="),void 0!=t&&t[0]==e)return t[1];return null},DAT.GUI.replaceGetVar=function(e,t){for(var n,o=window.location.href,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++)if(n=r[i].split("="),void 0!=n&&n[0]==e)return o.replace(n[1],t);return-1!=window.location.href.indexOf("?")?o+"&"+e+"="+t:o+"?"+e+"="+t},DAT.GUI.saveIndex=0,DAT.GUI.guiIndex=0,DAT.GUI.showSaveString=function(){alert(DAT.GUI.getSaveString())},DAT.GUI.makeUnselectable=function(e){if(void 0!=e&&void 0!=e.style){e.onselectstart=function(){return!1},e.style.MozUserSelect="none",e.style.KhtmlUserSelect="none",e.unselectable="on";for(var t=e.childNodes,n=0;n<t.length;n++)DAT.GUI.makeUnselectable(t[n])}},DAT.GUI.makeSelectable=function(e){if(void 0!=e&&void 0!=e.style){e.onselectstart=function(){},e.style.MozUserSelect="auto",e.style.KhtmlUserSelect="auto",e.unselectable="off";for(var t=e.childNodes,n=0;n<t.length;n++)DAT.GUI.makeSelectable(t[n])}},DAT.GUI.map=function(e,t,n,o,r){return o+(r-o)*((e-t)/(n-t))},DAT.GUI.constrain=function(e,t,n){return t>e?e=t:e>n&&(e=n),e},DAT.GUI.error=function(e){"function"==typeof console.error&&console.error("[DAT.GUI ERROR] "+e)},DAT.GUI.roundToDecimal=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n},DAT.GUI.extendController=function(e){e.prototype=new DAT.GUI.Controller,e.prototype.constructor=e},DAT.GUI.addClass=function(e,t){DAT.GUI.hasClass(e,t)||(e.className+=" "+t)},DAT.GUI.hasClass=function(e,t){return-1!=e.className.indexOf(t)},DAT.GUI.removeClass=function(e,t){var n=new RegExp(" "+t,"g");e.className=e.className.replace(n,"")},null!=DAT.GUI.getVarFromURL("saveString")&&DAT.GUI.load(DAT.GUI.getVarFromURL("saveString")),DAT.GUI.Controller=function(){this.parent=arguments[0],this.object=arguments[1],this.propertyName=arguments[2],arguments.length>0&&(this.initialValue=this.object[this.propertyName]),this.domElement=document.createElement("div"),this.domElement.setAttribute("class","guidat-controller "+this.type),this.propertyNameElement=document.createElement("span"),this.propertyNameElement.setAttribute("class","guidat-propertyname"),this.name(this.propertyName),this.domElement.appendChild(this.propertyNameElement),DAT.GUI.makeUnselectable(this.domElement)},DAT.GUI.Controller.prototype.changeFunction=null,DAT.GUI.Controller.prototype.finishChangeFunction=null,DAT.GUI.Controller.prototype.name=function(e){return this.propertyNameElement.innerHTML=e,this},DAT.GUI.Controller.prototype.reset=function(){return this.setValue(this.initialValue),this},DAT.GUI.Controller.prototype.listen=function(){return this.parent.listenTo(this),this},DAT.GUI.Controller.prototype.unlisten=function(){return this.parent.unlistenTo(this),this},DAT.GUI.Controller.prototype.setValue=function(e){if(void 0!=this.object[this.propertyName])this.object[this.propertyName]=e;else{var t=new Object;t[this.propertyName]=e,this.object.set(t)}return null!=this.changeFunction&&this.changeFunction.call(this,e),this.updateDisplay(),this},DAT.GUI.Controller.prototype.getValue=function(){var e=this.object[this.propertyName];return void 0==e&&(e=this.object.get(this.propertyName)),e},DAT.GUI.Controller.prototype.updateDisplay=function(){},DAT.GUI.Controller.prototype.onChange=function(e){return this.changeFunction=e,this},DAT.GUI.Controller.prototype.onFinishChange=function(e){return this.finishChangeFunction=e,this},DAT.GUI.Controller.prototype.options=function(){var e=this,t=document.createElement("select");if(1==arguments.length){var n=arguments[0];for(var o in n){var r=document.createElement("option");r.innerHTML=o,r.setAttribute("value",n[o]),n[o]==this.getValue()&&(r.selected=!0),t.appendChild(r)}}else for(var o=0;o<arguments.length;o++){var r=document.createElement("option");r.innerHTML=arguments[o],r.setAttribute("value",arguments[o]),arguments[o]==this.getValue()&&(r.selected=!0),t.appendChild(r)}return t.addEventListener("change",function(){e.setValue(this.value),null!=e.finishChangeFunction&&e.finishChangeFunction.call(this,e.getValue())},!1),e.domElement.appendChild(t),this},DAT.GUI.ControllerBoolean=function(){this.type="boolean",DAT.GUI.Controller.apply(this,arguments);var _this=this,input=document.createElement("input");input.setAttribute("type","checkbox"),input.checked=this.getValue(),this.setValue(this.getValue()),this.domElement.addEventListener("click",function(e){input.checked=!input.checked,e.preventDefault(),_this.setValue(input.checked)},!1),input.addEventListener("mouseup",function(){input.checked=!input.checked},!1),this.domElement.style.cursor="pointer",this.propertyNameElement.style.cursor="pointer",this.domElement.appendChild(input),this.updateDisplay=function(){input.checked=_this.getValue()},this.setValue=function(val){if("boolean"!=typeof val)try{val=eval(val)}catch(e){}return DAT.GUI.Controller.prototype.setValue.call(this,val)}},DAT.GUI.extendController(DAT.GUI.ControllerBoolean),DAT.GUI.ControllerNumber=function(){this.type="number",DAT.GUI.Controller.apply(this,arguments);var e=this,t=!1,n=!1,o=!1,r=!1,i=0,l=0,a=arguments[3],s=arguments[4],u=arguments[5],c=function(){u=.01*(s-a)};this.min=function(){var t=!1;return void 0==a&&void 0!=s&&(t=!0),0==arguments.length?a:(a=arguments[0],t&&(p(),void 0==u&&c()),e)},this.max=function(){var t=!1;return void 0!=a&&void 0==s&&(t=!0),0==arguments.length?s:(s=arguments[0],t&&(p(),void 0==u&&c()),e)},this.step=function(){return 0==arguments.length?u:(u=arguments[0],e)},this.getMin=function(){return a},this.getMax=function(){return s},this.getStep=function(){return void 0==u?void 0!=s&&void 0!=a?(s-a)/100:1:u};var h=document.createElement("input");h.setAttribute("id",this.propertyName),h.setAttribute("type","text"),h.setAttribute("value",this.getValue()),u&&h.setAttribute("step",u),this.domElement.appendChild(h);var d,p=function(){d=new DAT.GUI.ControllerNumberSlider(e,a,s,u,e.getValue()),e.domElement.appendChild(d.domElement)};void 0!=a&&void 0!=s&&p(),h.addEventListener("blur",function(){var t=parseFloat(this.value);d&&DAT.GUI.removeClass(e.domElement,"active"),isNaN(t)||e.setValue(t)},!1),h.addEventListener("mousewheel",function(t){return t.preventDefault(),e.setValue(e.getValue()+Math.abs(t.wheelDeltaY)/t.wheelDeltaY*e.getStep()),!1},!1),h.addEventListener("mousedown",function(e){l=i=e.pageY,n=!0,DAT.GUI.makeSelectable(h),document.addEventListener("mousemove",g,!1),document.addEventListener("mouseup",m,!1)},!1),h.addEventListener("keydown",function(t){var n;switch(t.keyCode){case 13:n=parseFloat(this.value),e.setValue(n);break;case 38:n=e.getValue()+e.getStep(),e.setValue(n);break;case 40:n=e.getValue()-e.getStep(),e.setValue(n)}},!1);var m=function(){document.removeEventListener("mousemove",g,!1),DAT.GUI.makeSelectable(h),t=!1,n=!1,null!=e.finishChangeFunction&&e.finishChangeFunction.call(this,e.getValue()),o=!1,r=!1,document.removeEventListener("mouseup",m,!1)},g=function(n){l=i,i=n.pageY;var a=l-i;if(o||r||(0==a?o=!0:r=!0),o)return!0;DAT.GUI.addClass(e.domElement,"active"),DAT.GUI.makeUnselectable(e.parent.domElement),DAT.GUI.makeUnselectable(h),t=!0,n.preventDefault();var s=e.getValue()+a*e.getStep();return e.setValue(s),!1};this.options=function(){return e.noSlider(),e.domElement.removeChild(h),DAT.GUI.Controller.prototype.options.apply(this,arguments)},this.noSlider=function(){return d&&e.domElement.removeChild(d.domElement),this},this.setValue=function(e){return e=parseFloat(e),void 0!=a&&a>=e?e=a:void 0!=s&&e>=s&&(e=s),DAT.GUI.Controller.prototype.setValue.call(this,e)},this.updateDisplay=function(){h.value=DAT.GUI.roundToDecimal(e.getValue(),4),d&&(d.value=e.getValue())}},DAT.GUI.extendController(DAT.GUI.ControllerNumber),DAT.GUI.ControllerNumberSlider=function(e,t,n,o,r){var i,l,a=!1,s=this;this.domElement=document.createElement("div"),this.domElement.setAttribute("class","guidat-slider-bg"),this.fg=document.createElement("div"),this.fg.setAttribute("class","guidat-slider-fg"),this.domElement.appendChild(this.fg);var u=function(t){if(a){var n=h(s.domElement),o=DAT.GUI.map(t.pageX,n[0],n[0]+s.domElement.offsetWidth,e.getMin(),e.getMax());o=Math.round(o/e.getStep())*e.getStep(),e.setValue(o)}};this.domElement.addEventListener("mousedown",function(t){a=!0,i=l=t.pageX,DAT.GUI.addClass(e.domElement,"active"),u(t),document.addEventListener("mouseup",c,!1)},!1);var c=function(){DAT.GUI.removeClass(e.domElement,"active"),a=!1,null!=e.finishChangeFunction&&e.finishChangeFunction.call(this,e.getValue()),document.removeEventListener("mouseup",c,!1)},h=function(e){var t=0,n=0;if(e.offsetParent){do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return[t,n]}};this.__defineSetter__("value",function(t){this.fg.style.width=DAT.GUI.map(t,e.getMin(),e.getMax(),0,100)+"%"}),document.addEventListener("mousemove",u,!1),this.value=r},DAT.GUI.ControllerString=function(){this.type="string";var e=this;DAT.GUI.Controller.apply(this,arguments);var t=document.createElement("input"),n=this.getValue();t.setAttribute("value",n),t.setAttribute("spellcheck","false"),this.domElement.addEventListener("mouseup",function(){t.focus(),t.select()},!1),t.addEventListener("keyup",function(n){13==n.keyCode&&null!=e.finishChangeFunction&&(e.finishChangeFunction.call(this,e.getValue()),t.blur()),e.setValue(t.value)},!1),t.addEventListener("mousedown",function(){DAT.GUI.makeSelectable(t)},!1),t.addEventListener("blur",function(){DAT.GUI.supressHotKeys=!1,null!=e.finishChangeFunction&&e.finishChangeFunction.call(this,e.getValue())},!1),t.addEventListener("focus",function(){DAT.GUI.supressHotKeys=!0},!1),this.updateDisplay=function(){t.value=e.getValue()},this.options=function(){return e.domElement.removeChild(t),DAT.GUI.Controller.prototype.options.apply(this,arguments)},this.domElement.appendChild(t)},DAT.GUI.extendController(DAT.GUI.ControllerString),DAT.GUI.ControllerFunction=function(){this.type="function";var e=this;DAT.GUI.Controller.apply(this,arguments),this.domElement.addEventListener("click",function(){e.fire()},!1),this.domElement.style.cursor="pointer",this.propertyNameElement.style.cursor="pointer";var t=null;this.onFire=function(e){return t=e,this},this.fire=function(){null!=t&&t.call(this),e.object[e.propertyName].call(e.object)}},DAT.GUI.extendController(DAT.GUI.ControllerFunction);