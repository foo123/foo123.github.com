/**
*  InfoPopup.js
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.0
*
*  https://github.com/foo123/InfoPopup
*
**/
!function(e,t){"use strict";"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(function(e){return t()}):e.InfoPopup=t()}("undefined"!=typeof self?self:this,function(e){"use strict";var t=/^\s+|\s+$/g,v=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(t,"")},i=null;function s(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){t=!1}return t}function h(e,t){var n,o;e.classList?e.classList.add(t):(o=t,((n=e).classList?n.classList.contains(o):-1!==(" "+n.className+" ").indexOf(" "+o+" "))||(e.className=""===e.className?t:e.className+" "+t))}function g(e,t){e.classList?e.classList.remove(t):e.className=v((" "+e.className+" ").replace(" "+t+" "," "))}function y(e,t,n,o){null==i&&(i=s()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,i?o:"object"==typeof o?!!o.capture:!!o)}function b(e,t,n,o){null==i&&(i=s()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,i?o:"object"==typeof o?!!o.capture:!!o)}function w(e){return e.getBoundingClientRect()}function N(e,t){if(e.closest)return e.closest(t);for(;e;){if(e.matches(t))return e;e=e.parentNode}}function E(e){var a,s,t,n,c,r,o,i,u,l,p,d,f,m=this;if(!(m instanceof E))return new E(e);l=function(){n&&clearTimeout(n)},u=function(){c&&(g(c,"hovered"),"function"==typeof m.options.onBlur&&m.options.onBlur(c),c=null)},o=function(e){e&&e.preventDefault&&e.preventDefault(),u(),a&&a.parentNode&&a.parentNode.removeChild(a)},i=function(){l(),n=setTimeout(o,+(m.options.closeDelay||0))},d=function e(t){"mouseleave"===t.type&&(t.target&&N(t.target,m.options.item||".info-item"))!==c||(b(document.body,t.type,e,{capture:!0,passive:!0}),i())},p=function(e){var t=e.target&&N(e.target,m.options.item||".info-item");t&&"function"==typeof m.options.content&&(m.show(t,e),"click"!==m.options.trigger&&y(document.body,"touchstart"===e.type?"touchend":"mouseleave",d,{capture:!0,passive:!0}))},r=function(e){var t,n,o,i,s,c,r,u;a.style.position="absolute",g(a,"below"),g(a,"left"),g(a,"right"),t=w(document.body),n=w(e),o=w(a),s=window.innerWidth,c=window.innerHeight,r=document.body.scrollLeft||0,u=document.body.scrollTop||0,i=r+n.left-t.left+n.width/2-o.width/2,e=u+n.top-t.top-o.height,i<0?-i<=r?(document.body.scrollLeft+=i,r=document.body.scrollLeft,i=0):(i=r+n.left-t.left,h(a,"left")):i+o.width>s&&(i=r+n.left-t.left+n.width-o.width,h(a,"right")),n.top+n.height/2<c/2&&(e=u+n.top-t.top+n.height,h(a,"below")),a.style.left=String(i)+"px",a.style.top=String(e)+"px"},m.options=e||{},m.dispose=function(){l(),o(),"click"===m.options.trigger?(t&&b(t,"click",o,{capture:!0,passive:!1}),b(document.body,"click",p,{capture:!0,passive:!1})):(a&&b(a,"mouseenter",f,{capture:!0,passive:!0}),a&&b(a,"touchstart",l,{capture:!0,passive:!0}),b(document.body,"mouseenter",p,{capture:!0,passive:!1}),b(document.body,"touchstart",p,{capture:!0,passive:!1}))},m.show=function(n,e){var o,i=0,t=m.options.content(n);null!=t&&!1!==t&&(t instanceof window.Node?(s.textContent="",s.appendChild(t)):s.innerHTML=v(String(t)),e&&e.preventDefault&&e.preventDefault(),l(),u(),h(n,"hovered"),c=n,document.body.appendChild(a),(o=a.getElementsByTagName("img"))&&o.length&&[].forEach.call(o,function(t){var e;!t.complete&&(t.src&&t.src.length||t.currentSrc&&t.currentSrc.length)?(y(t,"error",e=function e(){b(t,"error",e),b(t,"load",e),++i,o.length===i&&a.parentNode&&a===function(e,t){for(;e;){if(e===t)return t;e=e.parentNode}}(t,a)&&r(n)}),y(t,"load",e)):++i}),r(n))},a||(h(a=document.createElement("div"),"info"),m.options.className&&h(a,m.options.className),"click"===m.options.trigger?(a.appendChild(document.createElement("div")),h(a.firstChild,"header"),a.firstChild.appendChild(t=document.createElement("button")),h(t,"close"),t.setAttribute("title",m.options.closeMsg||"Close Popup"),y(t,"click",o,{capture:!0,passive:!1})):t=null,a.appendChild(s=document.createElement("div")),h(s,"content"),"click"===m.options.trigger?y(document.body,"click",p,{capture:!0,passive:!1}):(y(a,"mouseenter",f=function(e){l(),y(a,"mouseleave",function e(t){b(a,"mouseleave",e,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),y(a,"touchstart",l,{capture:!0,passive:!0}),y(document.body,"mouseenter",p,{capture:!0,passive:!1}),y(document.body,"touchstart",p,{capture:!0,passive:!1})))}return E.prototype={constructor:E,options:null,dispose:null,show:null},E.VERSION="1.0.0",E});