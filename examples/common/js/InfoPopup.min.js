/**
*  InfoPopup
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.0
*
*  https://github.com/foo123/InfoPopup
*
**/
!function(e,t){"use strict";"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(function(e){return t()}):e.InfoPopup=t()}("undefined"!=typeof self?self:this,function(e){"use strict";var t=/^\s+|\s+$/g,f=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(t,"")},i=null;function s(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){t=!1}return t}function m(e,t){var n,o;e.classList?e.classList.add(t):(o=t,((n=e).classList?n.classList.contains(o):-1!==(" "+n.className+" ").indexOf(" "+o+" "))||(e.className=""===e.className?t:e.className+" "+t))}function h(e,t){e.classList?e.classList.remove(t):e.className=f((" "+e.className+" ").replace(" "+t+" "," "))}function v(e,t,n,o){null==i&&(i=s()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,i?o:"object"==typeof o?!!o.capture:!!o)}function y(e,t,n,o){null==i&&(i=s()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,i?o:"object"==typeof o?!!o.capture:!!o)}function g(e){return e.getBoundingClientRect()}function b(e){var a,s,t,n,c,r,o,i,u,l,p,d=this;if(!(d instanceof b))return new b(e);u=function(){n&&clearTimeout(n)},o=function(){c&&h(c,"hovered"),a&&a.parentNode&&a.parentNode.removeChild(a),c=null},i=function(){u(),n=setTimeout(o,+(d.options.closeDelay||0))},l=function(t){var e=t.target&&function(e,t){if(e.closest)return e.closest(t);for(;e;){if(e.matches(t))return e;e=e.parentNode}}(t.target,d.options.item||".info-item");e&&"function"==typeof d.options.content&&(d.show(e,t),"click"!==d.options.trigger&&v(document.body,"touchstart"===t.type?"touchend":"mouseleave",function e(){y(document.body,"touchstart"===t.type?"touchend":"mouseleave",e,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0}))},r=function(e){var t,n,o,i,s,c,r,u;a.style.position="absolute",h(a,"below"),h(a,"left"),h(a,"right"),t=g(document.body),n=g(e),o=g(a),s=window.innerWidth,c=window.innerHeight,r=document.body.scrollLeft||0,u=document.body.scrollTop||0,i=r+n.left-t.left+n.width/2-o.width/2,e=u+n.top-t.top-o.height,i<0?-i<=r?(document.body.scrollLeft+=i,r=document.body.scrollLeft,i=0):(i=r+n.left-t.left,m(a,"left")):i+o.width>s&&(i=r+n.left-t.left+n.width-o.width,m(a,"right")),n.top+n.height/2<c/2&&(e=u+n.top-t.top+n.height,m(a,"below")),a.style.left=String(i)+"px",a.style.top=String(e)+"px"},d.options=e||{},d.dispose=function(){u(),o(),t&&y(t,"click",o,{capture:!0,passive:!0}),"click"===d.options.trigger?y(document.body,"click",l,{capture:!0,passive:!1}):(a&&y(a,"mouseenter",p,{capture:!0,passive:!0}),a&&y(a,"touchstart",u,{capture:!0,passive:!0}),y(document.body,"mouseenter",l,{capture:!0,passive:!1}),y(document.body,"touchstart",l,{capture:!0,passive:!1}))},d.show=function(n,e){var o,i=0,t=d.options.content(n);null!=t&&!1!==t&&(t instanceof window.Node?(s.textContent="",s.appendChild(t)):s.innerHTML=f(String(t)),e&&e.preventDefault&&e.preventDefault(),u(),c&&h(c,"hovered"),m(c=n,"hovered"),document.body.appendChild(a),(o=a.querySelectorAll("img"))&&o.length&&[].forEach.call(o,function(t){t.complete?++i:v(t,"load",function e(){y(t,"load",e),++i,o.length===i&&a.parentNode&&a===function(e,t){for(;e;){if(e===t)return t;e=e.parentNode}}(t,a)&&r(n)})}),r(n))},a||(m(a=document.createElement("div"),"info"),d.options.className&&m(a,d.options.className),a.appendChild(document.createElement("div")),m(a.firstChild,"header"),a.firstChild.appendChild(t=document.createElement("button")),m(t,"close"),t.setAttribute("title",d.options.closeMsg||"Close Popup"),v(t,"click",o,{capture:!0,passive:!0}),a.appendChild(s=document.createElement("div")),m(s,"content"),"click"===d.options.trigger?v(document.body,"click",l,{capture:!0,passive:!1}):(v(a,"mouseenter",p=function(e){u(),v(a,"mouseleave",function e(t){y(a,"mouseleave",e,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),v(a,"touchstart",u,{capture:!0,passive:!0}),v(document.body,"mouseenter",l,{capture:!0,passive:!1}),v(document.body,"touchstart",l,{capture:!0,passive:!1})))}return b.prototype={constructor:b,options:null,dispose:null,show:null},b.VERSION="1.0.0",b});