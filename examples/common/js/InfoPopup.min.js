/**
*  InfoPopup.js
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.3
*
*  https://github.com/foo123/InfoPopup
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.InfoPopup=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var e=/^\s+|\s+$/g,f=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},i=null;function s(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function g(t,e){var o,n;t.classList?t.classList.add(e):(n=e,((o=t).classList?o.classList.contains(n):-1!==(" "+o.className+" ").indexOf(" "+n+" "))||(t.className=""===t.className?e:t.className+" "+e))}function v(t,e){t.classList?t.classList.remove(e):t.className=f((" "+t.className+" ").replace(" "+e+" "," "))}function w(t,e,o,n){null==i&&(i=s()),t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function y(t,e,o,n){null==i&&(i=s()),t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function b(t){return t.getBoundingClientRect()}function C(t,e){if(t.closest)return t.closest(e);for(;t;){if(t.matches(e))return t;t=t.parentNode}}function E(t){return"function"==typeof t}function L(t){var h,s,e,o,r,c,n,i,l,a,u,p,d,m=this;if(!(m instanceof L))return new L(t);a=function(){o&&clearTimeout(o)},l=function(){r&&(v(r,m.options.focusedClass||"focused"),"function"==typeof m.options.onBlur&&m.options.onBlur(r),r=null)},n=function(t){t&&t.preventDefault&&t.preventDefault(),l(),h&&h.parentNode&&h.parentNode.removeChild(h)},i=function(){a(),o=setTimeout(n,+(m.options.hideDelay||0))},p=function t(e){"mouseleave"===e.type&&(e.target&&C(e.target,m.options.item||".info-item"))!==r||(y(document.body,e.type,t,{capture:!0,passive:!0}),i())},u=function(t){var e=t.target&&C(t.target,m.options.item||".info-item");e&&E(m.options.content)&&(m.show(e,t),"click"!==m.options.trigger&&w(document.body,"touchstart"===t.type?"touchend":"mouseleave",p,{capture:!0,passive:!0}))},c=function(t,e,o){var n,i,s,r,c,l,a,u=0,p=0,d=0,f=0;switch(E(e)&&(e=e(t,m)),E(o)&&(o=o(t,m)),h.style.position="absolute",v(h,"below"),v(h,"left"),v(h,"right"),n=(c=document).scrollingElement||c.documentElement||c.body,l=document,i={width:window.innerWidth||l.documentElement.clientWidth,height:window.innerHeight||l.documentElement.clientHeight},a=document.body,c=("function"==typeof window.getComputedStyle?window.getComputedStyle(a,null):a.currentStyle)||{},l=b(document.body),a=b(t),t=b(h),"static"===c.position&&(d=parseInt(c.marginLeft||0)||0,f=parseInt(c.marginTop||0)||0),u=n.scrollLeft||0,p=n.scrollTop||0,(e||"center").toLowerCase()){case"left":s=a.left,g(h,"left"),s<0?a.right-t.width>s&&(s=a.right-t.width,v(h,"left"),g(h,"right")):s+t.width>i.width&&a.right<s+t.width&&(s=a.right-t.width,v(h,"left"),g(h,"right"));break;case"right":s=a.right-t.width,g(h,"right"),s<0?a.left>s&&(s=a.left,v(h,"right"),g(h,"left")):a.right>i.width&&a.left+t.width<a.right&&(s=a.left,v(h,"right"),g(h,"left"));break;case"center":default:(s=a.left+a.width/2-t.width/2)<0?-s<=u?(n.scrollLeft+=s,u=n.scrollLeft):(s=a.left,g(h,"left")):s+t.width>i.width&&(s=a.right-t.width,g(h,"right"))}switch((o||"top").toLowerCase()){case"center":(r=a.top+a.height/2-t.height)<0&&(-r<=p?(n.scrollTop+=r,p=n.scrollTop):(r=a.top+a.height/2,g(h,"below")));break;case"bottom":r=a.bottom,g(h,"below"),r+t.height>i.height&&t.height-a.top<r+t.height-i.height&&(r=a.top-t.height,v(h,"below"));break;case"top":default:(r=a.top-t.height)<0&&(-r<=p?(n.scrollTop+=r,p=n.scrollTop):i.height-a.bottom-t.height>r&&(r=a.bottom,g(h,"below")))}h.style.left=String(s-l.left+d)+"px",h.style.top=String(r-l.top+f)+"px"},m.options=t||{},m.dispose=function(){a(),n(),"click"===m.options.trigger?(e&&y(e,"click",n,{capture:!0,passive:!1}),y(document.body,"click",u,{capture:!0,passive:!1})):(h&&y(h,"mouseenter",d,{capture:!0,passive:!0}),h&&y(h,"touchstart",a,{capture:!0,passive:!0}),y(document.body,"mouseenter",u,{capture:!0,passive:!1}),y(document.body,"touchstart",u,{capture:!0,passive:!1}))},m.hide=function(){a(),n()},m.show=function(o,t){var n,i,e;o&&E(m.options.content)&&(i=0,null!=(e=m.options.content(o,m))&&!1!==e&&(e instanceof window.Node?(s.textContent="",s.appendChild(e)):s.innerHTML=f(String(e)),t&&t.preventDefault&&t.preventDefault(),a(),l(),g(r=o,m.options.focusedClass||"focused"),document.body.appendChild(h),(n=h.getElementsByTagName("img"))&&n.length&&[].forEach.call(n,function(e){var t;!e.complete&&(e.src&&e.src.length||e.currentSrc&&e.currentSrc.length)?(w(e,"error",t=function t(){y(e,"error",t),y(e,"load",t),++i,n.length===i&&o===r&&h.parentNode&&h===function(t,e){for(;t;){if(t===e)return e;t=t.parentNode}}(e,h)&&c(o,m.options.atItemX,m.options.atItemY)}),w(e,"load",t)):++i}),c(o,m.options.atItemX,m.options.atItemY)))},h||(g(h=document.createElement("div"),"info-popup"),m.options.infoClass&&g(h,m.options.infoClass),"click"===m.options.trigger?(h.appendChild(document.createElement("div")),g(h.firstChild,"header"),h.firstChild.appendChild(e=document.createElement("button")),g(e,"close"),e.setAttribute("title",m.options.closeMsg||"Close Popup"),w(e,"click",n,{capture:!0,passive:!1})):e=null,h.appendChild(s=document.createElement("div")),g(s,"content"),"click"===m.options.trigger?w(document.body,"click",u,{capture:!0,passive:!1}):(w(h,"mouseenter",d=function(t){a(),w(h,"mouseleave",function t(e){y(h,"mouseleave",t,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),w(h,"touchstart",a,{capture:!0,passive:!0}),w(document.body,"mouseenter",u,{capture:!0,passive:!1}),w(document.body,"touchstart",u,{capture:!0,passive:!1})))}return L.prototype={constructor:L,options:null,dispose:null,show:null,hide:null},L.VERSION="1.0.3",L});