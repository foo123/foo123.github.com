/**
*  InfoPopup.js
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.0
*
*  https://github.com/foo123/InfoPopup
*
**/!function(e,t){"use strict";"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(function(e){return t()}):e.InfoPopup=t()}("undefined"!=typeof self?self:this,function(e){"use strict";var t=/^\s+|\s+$/g,m=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(t,"")},i=null;function s(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return!(t=!0)}}),window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){t=!1}return t}function v(e,t){var n,o;e.classList?e.classList.add(t):(o=t,((n=e).classList?n.classList.contains(o):-1!==(" "+n.className+" ").indexOf(" "+o+" "))||(e.className=""===e.className?t:e.className+" "+t))}function h(e,t){e.classList?e.classList.remove(t):e.className=m((" "+e.className+" ").replace(" "+t+" "," "))}function y(e,t,n,o){null==i&&(i=s()),e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,i?o:"object"==typeof o?!!o.capture:!!o)}function g(e,t,n,o){null==i&&(i=s()),e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,i?o:"object"==typeof o?!!o.capture:!!o)}function b(e){return e.getBoundingClientRect()}function w(e,t){if(e.closest)return e.closest(t);for(;e;){if(e.matches(t))return e;e=e.parentNode}}function N(e){var u,s,t,n,c,r,o,i,a,l,p,d,f=this;if(!(f instanceof N))return new N(e);a=function(){n&&clearTimeout(n)},o=function(e){e&&e.preventDefault&&e.preventDefault(),c&&h(c,"hovered"),u&&u.parentNode&&u.parentNode.removeChild(u),c=null},i=function(){a(),n=setTimeout(o,+(f.options.closeDelay||0))},p=function e(t){"mouseleave"===t.type&&(t.target&&w(t.target,f.options.item||".info-item"))!==c||(g(document.body,t.type,e,{capture:!0,passive:!0}),i())},l=function(e){var t=e.target&&w(e.target,f.options.item||".info-item");t&&"function"==typeof f.options.content&&(f.show(t,e),"click"!==f.options.trigger&&y(document.body,"touchstart"===e.type?"touchend":"mouseleave",p,{capture:!0,passive:!0}))},r=function(e){var t,n,o,i,s,c,r,a;u.style.position="absolute",h(u,"below"),h(u,"left"),h(u,"right"),t=b(document.body),n=b(e),o=b(u),s=window.innerWidth,c=window.innerHeight,r=document.body.scrollLeft||0,a=document.body.scrollTop||0,i=r+n.left-t.left+n.width/2-o.width/2,e=a+n.top-t.top-o.height,i<0?-i<=r?(document.body.scrollLeft+=i,r=document.body.scrollLeft,i=0):(i=r+n.left-t.left,v(u,"left")):i+o.width>s&&(i=r+n.left-t.left+n.width-o.width,v(u,"right")),n.top+n.height/2<c/2&&(e=a+n.top-t.top+n.height,v(u,"below")),u.style.left=String(i)+"px",u.style.top=String(e)+"px"},f.options=e||{},f.dispose=function(){a(),o(),"click"===f.options.trigger?(t&&g(t,"click",o,{capture:!0,passive:!1}),g(document.body,"click",l,{capture:!0,passive:!1})):(u&&g(u,"mouseenter",d,{capture:!0,passive:!0}),u&&g(u,"touchstart",a,{capture:!0,passive:!0}),g(document.body,"mouseenter",l,{capture:!0,passive:!1}),g(document.body,"touchstart",l,{capture:!0,passive:!1}))},f.show=function(n,e){var o,i=0,t=f.options.content(n);null!=t&&!1!==t&&(t instanceof window.Node?(s.textContent="",s.appendChild(t)):s.innerHTML=m(String(t)),e&&e.preventDefault&&e.preventDefault(),a(),c&&h(c,"hovered"),v(c=n,"hovered"),document.body.appendChild(u),(o=u.querySelectorAll("img"))&&o.length&&[].forEach.call(o,function(t){t.complete?++i:y(t,"load",function e(){g(t,"load",e),++i,o.length===i&&u.parentNode&&u===function(e,t){for(;e;){if(e===t)return t;e=e.parentNode}}(t,u)&&r(n)})}),r(n))},u||(v(u=document.createElement("div"),"info"),f.options.className&&v(u,f.options.className),"click"===f.options.trigger?(u.appendChild(document.createElement("div")),v(u.firstChild,"header"),u.firstChild.appendChild(t=document.createElement("button")),v(t,"close"),t.setAttribute("title",f.options.closeMsg||"Close Popup"),y(t,"click",o,{capture:!0,passive:!1})):t=null,u.appendChild(s=document.createElement("div")),v(s,"content"),"click"===f.options.trigger?y(document.body,"click",l,{capture:!0,passive:!1}):(y(u,"mouseenter",d=function(e){a(),y(u,"mouseleave",function e(t){g(u,"mouseleave",e,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),y(u,"touchstart",a,{capture:!0,passive:!0}),y(document.body,"mouseenter",l,{capture:!0,passive:!1}),y(document.body,"touchstart",l,{capture:!0,passive:!1})))}return N.prototype={constructor:N,options:null,dispose:null,show:null},N.VERSION="1.0.0",N});