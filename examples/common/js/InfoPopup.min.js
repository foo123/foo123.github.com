/**
*  InfoPopup.js
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.1
*
*  https://github.com/foo123/InfoPopup
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.InfoPopup=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var e=/^\s+|\s+$/g,h=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},i=null;function s(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function v(t,e){var o,n;t.classList?t.classList.add(e):(n=e,((o=t).classList?o.classList.contains(n):-1!==(" "+o.className+" ").indexOf(" "+n+" "))||(t.className=""===t.className?e:t.className+" "+e))}function g(t,e){t.classList?t.classList.remove(e):t.className=h((" "+t.className+" ").replace(" "+e+" "," "))}function y(t,e,o,n){null==i&&(i=s()),t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function b(t,e,o,n){null==i&&(i=s()),t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function w(t){return t.getBoundingClientRect()}function C(t,e){if(t.closest)return t.closest(e);for(;t;){if(t.matches(e))return t;t=t.parentNode}}function E(t){return"function"==typeof t}function L(t){var p,s,e,o,c,r,n,i,u,a,l,d,f,m=this;if(!(m instanceof L))return new L(t);a=function(){o&&clearTimeout(o)},u=function(){c&&(g(c,m.options.focusedClass||"focused"),"function"==typeof m.options.onBlur&&m.options.onBlur(c),c=null)},n=function(t){t&&t.preventDefault&&t.preventDefault(),u(),p&&p.parentNode&&p.parentNode.removeChild(p)},i=function(){a(),o=setTimeout(n,+(m.options.closeDelay||0))},d=function t(e){"mouseleave"===e.type&&(e.target&&C(e.target,m.options.item||".info-item"))!==c||(b(document.body,e.type,t,{capture:!0,passive:!0}),i())},l=function(t){var e=t.target&&C(t.target,m.options.item||".info-item");e&&"function"==typeof m.options.content&&(m.show(e,t),"click"!==m.options.trigger&&y(document.body,"touchstart"===t.type?"touchend":"mouseleave",d,{capture:!0,passive:!0}))},r=function(t,e,o){var n,i,s,c,r,u,a,l;switch(E(e)&&(e=e(t,m)),E(o)&&(o=o(t,m)),p.style.position="absolute",g(p,"below"),g(p,"left"),g(p,"right"),n=w(document.body),i=w(t),s=w(p),u=window.innerWidth||document.documentElement.clientWidth,a=window.innerHeight||document.documentElement.clientHeight,l=document.body.scrollLeft||0,t=document.body.scrollTop||0,(e||"center").toLowerCase()){case"left":c=i.left,v(p,"left");break;case"right":c=i.right-s.width,v(p,"right");break;case"center":default:(c=i.left+i.width/2-s.width/2)<0?-c<=l?(document.body.scrollLeft+=c,l=document.body.scrollLeft,c=0):(c=i.left,v(p,"left")):c+s.width>u&&(c=i.right-s.width,v(p,"right"))}switch((o||"top").toLowerCase()){case"center":(r=i.top+i.height/2-s.height)<0&&(-r<=t?(document.body.scrollTop+=r,t=document.body.scrollTop,r=0):(r=i.top+i.height/2,v(p,"below")));break;case"bottom":(r=i.bottom)+s.height>a?r=i.top-s.height:v(p,"below");break;case"top":default:(r=i.top-s.height)<0&&(-r<=t?(document.body.scrollTop+=r,t=document.body.scrollTop,r=0):(r=i.bottom,v(p,"below")))}p.style.left=String(c+l-n.left)+"px",p.style.top=String(r+t-n.top)+"px"},m.options=t||{},m.dispose=function(){a(),n(),"click"===m.options.trigger?(e&&b(e,"click",n,{capture:!0,passive:!1}),b(document.body,"click",l,{capture:!0,passive:!1})):(p&&b(p,"mouseenter",f,{capture:!0,passive:!0}),p&&b(p,"touchstart",a,{capture:!0,passive:!0}),b(document.body,"mouseenter",l,{capture:!0,passive:!1}),b(document.body,"touchstart",l,{capture:!0,passive:!1}))},m.show=function(o,t){var n,i=0,e=m.options.content(o);null!=e&&!1!==e&&(e instanceof window.Node?(s.textContent="",s.appendChild(e)):s.innerHTML=h(String(e)),t&&t.preventDefault&&t.preventDefault(),a(),u(),v(o,m.options.focusedClass||"focused"),c=o,document.body.appendChild(p),(n=p.getElementsByTagName("img"))&&n.length&&[].forEach.call(n,function(e){var t;!e.complete&&(e.src&&e.src.length||e.currentSrc&&e.currentSrc.length)?(y(e,"error",t=function t(){b(e,"error",t),b(e,"load",t),++i,n.length===i&&p.parentNode&&p===function(t,e){for(;t;){if(t===e)return e;t=t.parentNode}}(e,p)&&r(o,m.options.atItemX,m.options.atItemY)}),y(e,"load",t)):++i}),r(o,m.options.atItemX,m.options.atItemY))},p||(v(p=document.createElement("div"),"info-popup"),m.options.infoClass&&v(p,m.options.infoClass),"click"===m.options.trigger?(p.appendChild(document.createElement("div")),v(p.firstChild,"header"),p.firstChild.appendChild(e=document.createElement("button")),v(e,"close"),e.setAttribute("title",m.options.closeMsg||"Close Popup"),y(e,"click",n,{capture:!0,passive:!1})):e=null,p.appendChild(s=document.createElement("div")),v(s,"content"),"click"===m.options.trigger?y(document.body,"click",l,{capture:!0,passive:!1}):(y(p,"mouseenter",f=function(t){a(),y(p,"mouseleave",function t(e){b(p,"mouseleave",t,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),y(p,"touchstart",a,{capture:!0,passive:!0}),y(document.body,"mouseenter",l,{capture:!0,passive:!1}),y(document.body,"touchstart",l,{capture:!0,passive:!1})))}return L.prototype={constructor:L,options:null,dispose:null,show:null},L.VERSION="1.0.1",L});