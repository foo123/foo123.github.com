/**
*  InfoPopup.js
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.6
*
*  https://github.com/foo123/InfoPopup
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.InfoPopup=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var m=Object.prototype.hasOwnProperty,e=/^\s+|\s+$/g,g=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},i=null;function y(t){return"function"==typeof t}function s(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function b(t,e,o,n){null==i&&(i=s()),t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function C(t,e,o,n){null==i&&(i=s()),t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function E(t,e){var o,n;t.classList?t.classList.add(e):(n=e,((o=t).classList?o.classList.contains(n):-1!==(" "+o.className+" ").indexOf(" "+n+" "))||(t.className=""===t.className?e:t.className+" "+e))}function L(t,e){t.classList?t.classList.remove(e):t.className=g((" "+t.className+" ").replace(" "+e+" "," "))}function N(t){return t.getBoundingClientRect()}function k(t,e){if(t&&t.closest)return t.closest(e);for(;t;){if(t.matches(e))return t;t=t.parentNode}}function S(t){var v,r,e,o,c,l,u,n,i,a,p,s,d,h,w=this,f=!0;if(!(w instanceof S))return new S(t);p=function(){o&&clearTimeout(o)},a=function(){c&&(L(c,w.options.focusedClass||"focused"),"function"==typeof w.options.onBlur&&w.options.onBlur(c,l),l=c=null)},n=function(t){t&&t.preventDefault&&t.preventDefault(),a(),v&&v.parentNode&&v.parentNode.removeChild(v)},i=function(){p(),o=setTimeout(n,+(w.options.hideDelay||0))},d=function t(e){"mouseleave"===e.type&&(e.target&&k(e.target,w.options.item||".info-item"))!==c||(C(document.body,e.type,t,{capture:!0,passive:!0}),i())},s=function(t){var e=t.target&&k(t.target,w.options.item||".info-item");e&&y(w.options.content)&&(w.show(e,t),"click"!==w.options.trigger)&&b(document.body,"touchstart"===t.type?"touchend":"mouseleave",d,{capture:!0,passive:!0})},u=function(t,e,o,n,i){var s,r,c,l,u,a,p,d,h,f=0,m=0,g=0;switch(y(o)&&(o=o(t,w,e)),y(n)&&(n=n(t,w,e)),v.style.position="absolute",L(v,"below"),L(v,"left"),L(v,"right"),l=(h=document).scrollingElement||h.documentElement||h.body,h=document,u={width:window.innerWidth||h.documentElement.clientWidth,height:window.innerHeight||h.documentElement.clientHeight},h=document.body,h=(y(window.getComputedStyle)?window.getComputedStyle(h,null):h.currentStyle)||{},s=N(document.body),c=N(v),r=e.rect&&!i?e.rect:N(t),"static"===h.position&&(m=parseInt(h.marginLeft||0)||0,g=parseInt(h.marginTop||0)||0),d=l.scrollLeft||0,f=l.scrollTop||0,(o||"center").toLowerCase()){case"left":a=r.left,E(v,"left"),a<0?r.right-c.width>a&&(a=r.right-c.width,L(v,"left"),E(v,"right")):a+c.width>u.width&&r.right<a+c.width&&(a=r.right-c.width,L(v,"left"),E(v,"right"));break;case"right":a=r.right-c.width,E(v,"right"),a<0?r.left>a&&(a=r.left,L(v,"right"),E(v,"left")):r.right>u.width&&r.left+c.width<r.right&&(a=r.left,L(v,"right"),E(v,"left"));break;default:(a=r.left+r.width/2-c.width/2)<0?-a<=d&&!1!==w.options.scrollXIfNeeded?(l.scrollLeft+=a,l.scrollLeft):(a=r.left,E(v,"left")):a+c.width>u.width&&(a=r.right-c.width,E(v,"right"))}switch((n||"top").toLowerCase()){case"center":(p=r.top+r.height/2-c.height)<0&&(-p<=f&&!1!==w.options.scrollYIfNeeded?(l.scrollTop+=p,f=l.scrollTop):(p=r.top+r.height/2,E(v,"below")));break;case"bottom":p=r.bottom,E(v,"below"),p+c.height>u.height&&c.height-r.top<p+c.height-u.height&&(p=r.top-c.height,L(v,"below"));break;default:(p=r.top-c.height)<0&&(-p<=f&&!1!==w.options.scrollYIfNeeded?(l.scrollTop+=p,f=l.scrollTop):u.height-r.bottom-c.height>p&&(p=r.bottom,E(v,"below")))}v.style.left=String(a-s.left+m)+"px",v.style.top=String(p-s.top+g)+"px"},w.options=t||{},m.call(w.options,"preventDefault")&&(f=!!w.options.preventDefault),w.dispose=function(){p(),n(),"click"===w.options.trigger?(e&&C(e,"click",n,{capture:!0,passive:!1}),C(document.body,"click",s,{capture:!0,passive:!1})):(v&&C(v,"mouseenter",h,{capture:!0,passive:!0}),v&&C(v,"touchstart",p,{capture:!0,passive:!0}),C(document.body,"mouseenter",s,{capture:!0,passive:!1}),C(document.body,"touchstart",s,{capture:!0,passive:!1}))},w.hide=function(){p(),n()},w.show=function(o,t){var n,i,s,e;o&&y(w.options.content)&&(i=0,s={coords:function(t,e){var o,n,i,s,r,c,l,u;if(t&&e)return e={x:(e.touches&&e.touches.length?e.touches[0]:e).clientX,y:(e.touches&&e.touches.length?e.touches[0]:e).clientY},(t=k(t,"svg"))&&y(t.getScreenCTM)?(t=t.getScreenCTM().inverse(),o=null,n=e,i=t.a,s=t.b,r=t.c,c=t.d,l=t.e,t=t.f,u=n.x,n=n.y,(o=o||{x:0,y:0}).x=i*u+r*n+l,o.y=s*u+c*n+t,{dom:e,svg:o}):{dom:e}}(o,t),rect:N(o)},null!=(e=w.options.content(o,w,s)))&&!1!==e&&(e instanceof window.Node?(r.textContent="",r.appendChild(e)):r.innerHTML=g(String(e)),t&&f&&t.preventDefault&&t.preventDefault(),p(),a(),l=s,E(c=o,w.options.focusedClass||"focused"),document.body.appendChild(v),(n=v.getElementsByTagName("img"))&&n.length&&[].forEach.call(n,function(e){var t;!e.complete&&(e.src&&e.src.length||e.currentSrc&&e.currentSrc.length)?(b(e,"error",t=function t(){C(e,"error",t),C(e,"load",t),++i,n.length===i&&(o===c&&v&&v.parentNode&&v===function(t,e){for(;t;){if(t===e)return e;t=t.parentNode}}(e,v)&&u(o,s,w.options.atItemX,w.options.atItemY,!0),s=o=null)}),b(e,"load",t)):++i}),u(o,s,w.options.atItemX,w.options.atItemY,!1))},v||(E(v=document.createElement("div"),"info-popup"),w.options.infoClass&&E(v,w.options.infoClass),"click"===w.options.trigger?(v.appendChild(document.createElement("div")),E(v.firstChild,"header"),v.firstChild.appendChild(e=document.createElement("button")),E(e,"close"),e.setAttribute("title",w.options.closeMsg||"Close Popup"),b(e,"click",n,{capture:!0,passive:!1})):e=null,v.appendChild(r=document.createElement("div")),E(r,"content"),"click"===w.options.trigger?b(document.body,"click",s,{capture:!0,passive:!1}):(b(v,"mouseenter",h=function(t){p(),b(v,"mouseleave",function t(e){C(v,"mouseleave",t,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),b(v,"touchstart",p,{capture:!0,passive:!0}),b(document.body,"mouseenter",s,{capture:!0,passive:!1}),b(document.body,"touchstart",s,{capture:!0,passive:!1})))}return S.prototype={constructor:S,options:null,dispose:null,show:null,hide:null},S.VERSION="1.0.6",S});