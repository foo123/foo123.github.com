/**
*  InfoPopup.js
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.4
*
*  https://github.com/foo123/InfoPopup
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.InfoPopup=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var e=/^\s+|\s+$/g,f=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},i=null;function w(t){return"function"==typeof t}function s(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function y(t,e){var o,n;t.classList?t.classList.add(e):(n=e,((o=t).classList?o.classList.contains(n):-1!==(" "+o.className+" ").indexOf(" "+n+" "))||(t.className=""===t.className?e:t.className+" "+e))}function b(t,e){t.classList?t.classList.remove(e):t.className=f((" "+t.className+" ").replace(" "+e+" "," "))}function m(t,e,o,n){null==i&&(i=s()),t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function C(t,e,o,n){null==i&&(i=s()),t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function E(t){return t.getBoundingClientRect()}function L(t,e){if(t&&e){e={x:(e.touches&&e.touches.length?e.touches[0]:e).clientX,y:(e.touches&&e.touches.length?e.touches[0]:e).clientY},t=N(t,"svg");if(t&&w(t.getScreenCTM)){t=t.getScreenCTM().inverse();return{dom:e,svg:function(t,e,o,n,i,s,c,r){t=t||{x:0,y:0};var l=e.x,e=e.y;return t.x=o*l+i*e+c,t.y=n*l+s*e+r,t}(null,e,t.a,t.b,t.c,t.d,t.e,t.f)}}return{dom:e}}}function N(t,e){if(t&&t.closest)return t.closest(e);for(;t;){if(t.matches(e))return t;t=t.parentNode}}function k(t){var g,c,e,o,r,l,u,n,i,a,p,s,d,h,v=this;if(!(v instanceof k))return new k(t);p=function(){o&&clearTimeout(o)},a=function(){r&&(b(r,v.options.focusedClass||"focused"),"function"==typeof v.options.onBlur&&v.options.onBlur(r,l),l=r=null)},n=function(t){t&&t.preventDefault&&t.preventDefault(),a(),g&&g.parentNode&&g.parentNode.removeChild(g)},i=function(){p(),o=setTimeout(n,+(v.options.hideDelay||0))},d=function t(e){"mouseleave"===e.type&&(e.target&&N(e.target,v.options.item||".info-item"))!==r||(C(document.body,e.type,t,{capture:!0,passive:!0}),i())},s=function(t){var e=t.target&&N(t.target,v.options.item||".info-item");e&&w(v.options.content)&&(v.show(e,t),"click"!==v.options.trigger&&m(document.body,"touchstart"===t.type?"touchend":"mouseleave",d,{capture:!0,passive:!0}))},u=function(t,e,o,n,i){var s,c,r,l,u,a,p,d=0,h=0,f=0,m=0;switch(w(o)&&(o=o(t,v,e)),w(n)&&(n=n(t,v,e)),g.style.position="absolute",b(g,"below"),b(g,"left"),b(g,"right"),s=(u=document).scrollingElement||u.documentElement||u.body,a=document,c={width:window.innerWidth||a.documentElement.clientWidth,height:window.innerHeight||a.documentElement.clientHeight},p=document.body,u=(w(window.getComputedStyle)?window.getComputedStyle(p,null):p.currentStyle)||{},a=E(document.body),p=E(g),t=e.rect&&!i?e.rect:E(t),"static"===u.position&&(f=parseInt(u.marginLeft||0)||0,m=parseInt(u.marginTop||0)||0),d=s.scrollLeft||0,h=s.scrollTop||0,(o||"center").toLowerCase()){case"left":r=t.left,y(g,"left"),r<0?t.right-p.width>r&&(r=t.right-p.width,b(g,"left"),y(g,"right")):r+p.width>c.width&&t.right<r+p.width&&(r=t.right-p.width,b(g,"left"),y(g,"right"));break;case"right":r=t.right-p.width,y(g,"right"),r<0?t.left>r&&(r=t.left,b(g,"right"),y(g,"left")):t.right>c.width&&t.left+p.width<t.right&&(r=t.left,b(g,"right"),y(g,"left"));break;case"center":default:(r=t.left+t.width/2-p.width/2)<0?-r<=d?(s.scrollLeft+=r,d=s.scrollLeft):(r=t.left,y(g,"left")):r+p.width>c.width&&(r=t.right-p.width,y(g,"right"))}switch((n||"top").toLowerCase()){case"center":(l=t.top+t.height/2-p.height)<0&&(-l<=h?(s.scrollTop+=l,h=s.scrollTop):(l=t.top+t.height/2,y(g,"below")));break;case"bottom":l=t.bottom,y(g,"below"),l+p.height>c.height&&p.height-t.top<l+p.height-c.height&&(l=t.top-p.height,b(g,"below"));break;case"top":default:(l=t.top-p.height)<0&&(-l<=h?(s.scrollTop+=l,h=s.scrollTop):c.height-t.bottom-p.height>l&&(l=t.bottom,y(g,"below")))}g.style.left=String(r-a.left+f)+"px",g.style.top=String(l-a.top+m)+"px"},v.options=t||{},v.dispose=function(){p(),n(),"click"===v.options.trigger?(e&&C(e,"click",n,{capture:!0,passive:!1}),C(document.body,"click",s,{capture:!0,passive:!1})):(g&&C(g,"mouseenter",h,{capture:!0,passive:!0}),g&&C(g,"touchstart",p,{capture:!0,passive:!0}),C(document.body,"mouseenter",s,{capture:!0,passive:!1}),C(document.body,"touchstart",s,{capture:!0,passive:!1}))},v.hide=function(){p(),n()},v.show=function(o,t){var n,i,s,e;o&&w(v.options.content)&&(i=0,s={coords:L(o,t),rect:E(o)},null!=(e=v.options.content(o,v,s))&&!1!==e&&(e instanceof window.Node?(c.textContent="",c.appendChild(e)):c.innerHTML=f(String(e)),t&&t.preventDefault&&t.preventDefault(),p(),a(),l=s,y(r=o,v.options.focusedClass||"focused"),document.body.appendChild(g),(n=g.getElementsByTagName("img"))&&n.length&&[].forEach.call(n,function(e){var t;!e.complete&&(e.src&&e.src.length||e.currentSrc&&e.currentSrc.length)?(m(e,"error",t=function t(){C(e,"error",t),C(e,"load",t),++i,n.length===i&&o===r&&g.parentNode&&g===function(t,e){for(;t;){if(t===e)return e;t=t.parentNode}}(e,g)&&u(o,s,v.options.atItemX,v.options.atItemY,!0)}),m(e,"load",t)):++i}),u(o,s,v.options.atItemX,v.options.atItemY,!1)))},g||(y(g=document.createElement("div"),"info-popup"),v.options.infoClass&&y(g,v.options.infoClass),"click"===v.options.trigger?(g.appendChild(document.createElement("div")),y(g.firstChild,"header"),g.firstChild.appendChild(e=document.createElement("button")),y(e,"close"),e.setAttribute("title",v.options.closeMsg||"Close Popup"),m(e,"click",n,{capture:!0,passive:!1})):e=null,g.appendChild(c=document.createElement("div")),y(c,"content"),"click"===v.options.trigger?m(document.body,"click",s,{capture:!0,passive:!1}):(m(g,"mouseenter",h=function(t){p(),m(g,"mouseleave",function t(e){C(g,"mouseleave",t,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),m(g,"touchstart",p,{capture:!0,passive:!0}),m(document.body,"mouseenter",s,{capture:!0,passive:!1}),m(document.body,"touchstart",s,{capture:!0,passive:!1})))}return k.prototype={constructor:k,options:null,dispose:null,show:null,hide:null},k.VERSION="1.0.4",k});