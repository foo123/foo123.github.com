/**
*  InfoPopup.js
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.0
*
*  https://github.com/foo123/InfoPopup
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.InfoPopup=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var e=/^\s+|\s+$/g,v=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},i=null;function s(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function h(t,e){var n,o;t.classList?t.classList.add(e):(o=e,((n=t).classList?n.classList.contains(o):-1!==(" "+n.className+" ").indexOf(" "+o+" "))||(t.className=""===t.className?e:t.className+" "+e))}function g(t,e){t.classList?t.classList.remove(e):t.className=v((" "+t.className+" ").replace(" "+e+" "," "))}function y(t,e,n,o){null==i&&(i=s()),t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,i?o:"object"==typeof o?!!o.capture:!!o)}function b(t,e,n,o){null==i&&(i=s()),t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener(e,n,i?o:"object"==typeof o?!!o.capture:!!o)}function w(t){return t.getBoundingClientRect()}function C(t,e){if(t.closest)return t.closest(e);for(;t;){if(t.matches(e))return t;t=t.parentNode}}function E(t){var a,s,e,n,c,r,o,i,u,l,p,d,f,m=this;if(!(m instanceof E))return new E(t);l=function(){n&&clearTimeout(n)},u=function(){c&&(g(c,m.options.focusedClass||"focused"),"function"==typeof m.options.onBlur&&m.options.onBlur(c),c=null)},o=function(t){t&&t.preventDefault&&t.preventDefault(),u(),a&&a.parentNode&&a.parentNode.removeChild(a)},i=function(){l(),n=setTimeout(o,+(m.options.closeDelay||0))},d=function t(e){"mouseleave"===e.type&&(e.target&&C(e.target,m.options.item||".info-item"))!==c||(b(document.body,e.type,t,{capture:!0,passive:!0}),i())},p=function(t){var e=t.target&&C(t.target,m.options.item||".info-item");e&&"function"==typeof m.options.content&&(m.show(e,t),"click"!==m.options.trigger&&y(document.body,"touchstart"===t.type?"touchend":"mouseleave",d,{capture:!0,passive:!0}))},r=function(t){var e,n,o,i,s,c,r,u;a.style.position="absolute",g(a,"below"),g(a,"left"),g(a,"right"),e=w(document.body),n=w(t),o=w(a),s=window.innerWidth,c=window.innerHeight,r=document.body.scrollLeft||0,u=document.body.scrollTop||0,i=r+n.left-e.left+n.width/2-o.width/2,t=u+n.top-e.top-o.height,i<0?-i<=r?(document.body.scrollLeft+=i,r=document.body.scrollLeft,i=0):(i=r+n.left-e.left,h(a,"left")):i+o.width>s&&(i=r+n.left-e.left+n.width-o.width,h(a,"right")),n.top+n.height/2<c/2&&(t=u+n.top-e.top+n.height,h(a,"below")),a.style.left=String(i)+"px",a.style.top=String(t)+"px"},m.options=t||{},m.dispose=function(){l(),o(),"click"===m.options.trigger?(e&&b(e,"click",o,{capture:!0,passive:!1}),b(document.body,"click",p,{capture:!0,passive:!1})):(a&&b(a,"mouseenter",f,{capture:!0,passive:!0}),a&&b(a,"touchstart",l,{capture:!0,passive:!0}),b(document.body,"mouseenter",p,{capture:!0,passive:!1}),b(document.body,"touchstart",p,{capture:!0,passive:!1}))},m.show=function(n,t){var o,i=0,e=m.options.content(n);null!=e&&!1!==e&&(e instanceof window.Node?(s.textContent="",s.appendChild(e)):s.innerHTML=v(String(e)),t&&t.preventDefault&&t.preventDefault(),l(),u(),h(n,m.options.focusedClass||"focused"),c=n,document.body.appendChild(a),(o=a.getElementsByTagName("img"))&&o.length&&[].forEach.call(o,function(e){var t;!e.complete&&(e.src&&e.src.length||e.currentSrc&&e.currentSrc.length)?(y(e,"error",t=function t(){b(e,"error",t),b(e,"load",t),++i,o.length===i&&a.parentNode&&a===function(t,e){for(;t;){if(t===e)return e;t=t.parentNode}}(e,a)&&r(n)}),y(e,"load",t)):++i}),r(n))},a||(h(a=document.createElement("div"),"info"),m.options.infoClass&&h(a,m.options.infoClass),"click"===m.options.trigger?(a.appendChild(document.createElement("div")),h(a.firstChild,"header"),a.firstChild.appendChild(e=document.createElement("button")),h(e,"close"),e.setAttribute("title",m.options.closeMsg||"Close Popup"),y(e,"click",o,{capture:!0,passive:!1})):e=null,a.appendChild(s=document.createElement("div")),h(s,"content"),"click"===m.options.trigger?y(document.body,"click",p,{capture:!0,passive:!1}):(y(a,"mouseenter",f=function(t){l(),y(a,"mouseleave",function t(e){b(a,"mouseleave",t,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),y(a,"touchstart",l,{capture:!0,passive:!0}),y(document.body,"mouseenter",p,{capture:!0,passive:!1}),y(document.body,"touchstart",p,{capture:!0,passive:!1})))}return E.prototype={constructor:E,options:null,dispose:null,show:null},E.VERSION="1.0.0",E});