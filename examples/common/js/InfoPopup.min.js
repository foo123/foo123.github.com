/**
*  InfoPopup.js
*  A simple js class to show info popups easily for various items and events (Desktop and Mobile)
*  @VERSION: 1.0.1
*
*  https://github.com/foo123/InfoPopup
*
**/
!function(t,e){"use strict";"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(function(t){return e()}):t.InfoPopup=e()}("undefined"!=typeof self?self:this,function(t){"use strict";var e=/^\s+|\s+$/g,m=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(e,"")},i=null;function s(){var e=!1,t={};try{Object.defineProperty(t,"passive",{get:function(){return!(e=!0)}}),window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}function g(t,e){var o,n;t.classList?t.classList.add(e):(n=e,((o=t).classList?o.classList.contains(n):-1!==(" "+o.className+" ").indexOf(" "+n+" "))||(t.className=""===t.className?e:t.className+" "+e))}function v(t,e){t.classList?t.classList.remove(e):t.className=m((" "+t.className+" ").replace(" "+e+" "," "))}function b(t,e,o,n){null==i&&(i=s()),t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function y(t,e,o,n){null==i&&(i=s()),t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener(e,o,i?n:"object"==typeof n?!!n.capture:!!n)}function w(t){return t.getBoundingClientRect()}function C(t,e){if(t.closest)return t.closest(e);for(;t;){if(t.matches(e))return t;t=t.parentNode}}function E(t){return"function"==typeof t}function L(t){var p,s,e,o,c,r,n,i,u,l,a,d,f,h=this;if(!(h instanceof L))return new L(t);l=function(){o&&clearTimeout(o)},u=function(){c&&(v(c,h.options.focusedClass||"focused"),"function"==typeof h.options.onBlur&&h.options.onBlur(c),c=null)},n=function(t){t&&t.preventDefault&&t.preventDefault(),u(),p&&p.parentNode&&p.parentNode.removeChild(p)},i=function(){l(),o=setTimeout(n,+(h.options.hideDelay||0))},d=function t(e){"mouseleave"===e.type&&(e.target&&C(e.target,h.options.item||".info-item"))!==c||(y(document.body,e.type,t,{capture:!0,passive:!0}),i())},a=function(t){var e=t.target&&C(t.target,h.options.item||".info-item");e&&E(h.options.content)&&(h.show(e,t),"click"!==h.options.trigger&&b(document.body,"touchstart"===t.type?"touchend":"mouseleave",d,{capture:!0,passive:!0}))},r=function(t,e,o){var n,i,s,c,r,u,l,a;switch(E(e)&&(e=e(t,h)),E(o)&&(o=o(t,h)),p.style.position="absolute",v(p,"below"),v(p,"left"),v(p,"right"),n=w(document.body),i=w(t),s=w(p),u=window.innerWidth||document.documentElement.clientWidth,l=window.innerHeight||document.documentElement.clientHeight,a=document.body.scrollLeft||0,t=document.body.scrollTop||0,(e||"center").toLowerCase()){case"left":c=i.left,g(p,"left"),c<0?i.right-s.width>c&&(c=i.right-s.width,v(p,"left"),g(p,"right")):c+s.width>u&&i.right<c+s.width&&(c=i.right-s.width,v(p,"left"),g(p,"right"));break;case"right":c=i.right-s.width,g(p,"right"),c<0?i.left>c&&(c=i.left,v(p,"right"),g(p,"left")):i.right>u&&i.left+s.width<i.right&&(c=i.left,v(p,"right"),g(p,"left"));break;case"center":default:(c=i.left+i.width/2-s.width/2)<0?-c<=a?(document.body.scrollLeft+=c,a=document.body.scrollLeft,c=0):(c=i.left,g(p,"left")):c+s.width>u&&(c=i.right-s.width,g(p,"right"))}switch((o||"top").toLowerCase()){case"center":(r=i.top+i.height/2-s.height)<0&&(-r<=t?(document.body.scrollTop+=r,t=document.body.scrollTop,r=0):(r=i.top+i.height/2,g(p,"below")));break;case"bottom":r=i.bottom,g(p,"below"),r+s.height>l&&s.height-i.top<r+s.height-l&&(r=i.top-s.height,v(p,"below"));break;case"top":default:(r=i.top-s.height)<0&&(-r<=t?(document.body.scrollTop+=r,t=document.body.scrollTop,r=0):l-i.bottom-s.height>r&&(r=i.bottom,g(p,"below")))}p.style.left=String(c+a-n.left)+"px",p.style.top=String(r+t-n.top)+"px"},h.options=t||{},h.dispose=function(){l(),n(),"click"===h.options.trigger?(e&&y(e,"click",n,{capture:!0,passive:!1}),y(document.body,"click",a,{capture:!0,passive:!1})):(p&&y(p,"mouseenter",f,{capture:!0,passive:!0}),p&&y(p,"touchstart",l,{capture:!0,passive:!0}),y(document.body,"mouseenter",a,{capture:!0,passive:!1}),y(document.body,"touchstart",a,{capture:!0,passive:!1}))},h.hide=function(){l(),n()},h.show=function(o,t){var n,i,e;o&&E(h.options.content)&&(i=0,null!=(e=h.options.content(o,h))&&!1!==e&&(e instanceof window.Node?(s.textContent="",s.appendChild(e)):s.innerHTML=m(String(e)),t&&t.preventDefault&&t.preventDefault(),l(),u(),g(c=o,h.options.focusedClass||"focused"),document.body.appendChild(p),(n=p.getElementsByTagName("img"))&&n.length&&[].forEach.call(n,function(e){var t;!e.complete&&(e.src&&e.src.length||e.currentSrc&&e.currentSrc.length)?(b(e,"error",t=function t(){y(e,"error",t),y(e,"load",t),++i,n.length===i&&o===c&&p.parentNode&&p===function(t,e){for(;t;){if(t===e)return e;t=t.parentNode}}(e,p)&&r(o,h.options.atItemX,h.options.atItemY)}),b(e,"load",t)):++i}),r(o,h.options.atItemX,h.options.atItemY)))},p||(g(p=document.createElement("div"),"info-popup"),h.options.infoClass&&g(p,h.options.infoClass),"click"===h.options.trigger?(p.appendChild(document.createElement("div")),g(p.firstChild,"header"),p.firstChild.appendChild(e=document.createElement("button")),g(e,"close"),e.setAttribute("title",h.options.closeMsg||"Close Popup"),b(e,"click",n,{capture:!0,passive:!1})):e=null,p.appendChild(s=document.createElement("div")),g(s,"content"),"click"===h.options.trigger?b(document.body,"click",a,{capture:!0,passive:!1}):(b(p,"mouseenter",f=function(t){l(),b(p,"mouseleave",function t(e){y(p,"mouseleave",t,{capture:!0,passive:!0}),i()},{capture:!0,passive:!0})},{capture:!0,passive:!0}),b(p,"touchstart",l,{capture:!0,passive:!0}),b(document.body,"mouseenter",a,{capture:!0,passive:!1}),b(document.body,"touchstart",a,{capture:!0,passive:!1})))}return L.prototype={constructor:L,options:null,dispose:null,show:null,hide:null},L.VERSION="1.0.1",L});