/**
* ColorPicker
* https://github.com/foo123/ColorPicker
* @version 2.2.0
*
* adapted from:
* http://www.eyecon.ro/colorpicker/
*      Color Picker by Stefan Petre www.eyecon.ro (MIT and GPL)
**/
!function(e,t){"use strict";"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(function(e){return t()}):e.ColorPicker=t()}("undefined"!=typeof self?self:this,function(e){"use strict";var o=Object.prototype.hasOwnProperty,z="getAttribute",t=Object.prototype.toString,H=Math.min,M=Math.max,Y=Math.round,a=Math.floor,c=/^\s+|\s+$/g,n=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(c,"")},r=/\s*,\s*/g,B=0;function u(e){return"[object Array]"===t.call(e)}function I(e){return document.getElementById(e)}function W(e,t){return e.classList?e.classList.contains(t):-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function X(e,t){W(e,t)||(e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t)}function R(e,t){e.classList?e.classList.remove(t):e.className=n((" "+e.className+" ").replace(" "+t+" "," "))}function $(e,t,c){e.attachEvent?e.attachEvent("on"+t,c):e.addEventListener(t,c,!1)}function F(e,t,c){e.detachEvent?e.detachEvent("on"+t,c):e.removeEventListener(t,c,!1)}function i(e,t){var c;document.createEvent?((c=document.createEvent("HTMLEvents")).initEvent(t,!0,!1),e.dispatchEvent(c)):document.createEventObject&&(c=document.createEventObject(),e.fireEvent("on"+t,c))}function V(o,e,n,t){function c(e){for(var t=!1,c=e.target||e.srcElement;c&&!(t=W(c,o));)c=c.parentElement;t&&n.call(c,e)}return $(t||document,e,c),c}function l(e){var t=0,c=0,o=e[0],n=e[1],r=e[2],i=H(o,n,r),e=M(o,n,r),i=e-i,l=e,t=0!=(c=0!=e?255*i/e:0)?o===e?(n-r)/i:n===e?2+(r-o)/i:4+(o-n)/i:-1;return(t*=60)<0&&(t+=360),c*=100/255,l*=100/255,[Y(t),Y(c),Y(l)]}function s(e){var t,c,o,n=Y(e[0]),r=Y(255*e[1]/100),i=Y(255*e[2]/100);return 0===r?t=c=o=i:(i=n%60*((e=i)-(r=(255-r)*i/255))/60,360==n&&(n=0),n<60?(t=e,c=(o=r)+i):n<120?(o=r,t=(c=e)-i):n<180?(c=e,o=(t=r)+i):n<240?(t=r,c=(o=e)-i):n<300?(o=e,t=(c=r)+i):o=n<360?(c=r,(t=e)-i):c=t=0),[Y(t),Y(c),Y(o)]}function d(e){e=[e[0].toString(16),e[1].toString(16),e[2].toString(16)];return 1===e[0].length&&(e[0]="0"+e[0]),1===e[1].length&&(e[1]="0"+e[1]),1===e[2].length&&(e[2]="0"+e[2]),e[0]+e[1]+e[2]}function q(e){var t=6-(e="#"===e.charAt(0)?e.slice(1):e).length;return 0<t&&(e=3==t?e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2):new Array(1+t).join("0")+e),e}function p(e,t){e.substr&&(e=e.slice(t?5:4,-1).split(r).map(n));t=t?K.opacity(e[3]):null;return[K.hsb[0](e[0]),K.hsb[1](e[1]),K.hsb[2](e[2]),t]}function h(e,t){e.substr&&(e=e.slice(t?5:4,-1).split(r).map(n));t=t?K.opacity(e[3]):null;return[K.rgb[0](e[0]),K.rgb[1](e[1]),K.rgb[2](e[2]),t]}function G(e){return parseInt(e,10)||0}function f(t,c,o){return"function"==typeof o?function(e){return e=o(e),c<e?c:e<t?t:e}:function(e){return c<e?c:e<t?t:e}}function J(e){var t=e.getBoundingClientRect(),c=document.body,o=window,n=c.clientTop||0,r=c.clientLeft||0,i=o.pageYOffset||c.scrollTop,c=o.pageXOffset||c.scrollLeft;return{top:t.top+i-n,left:t.left+c-r,width:e.offsetWidth,height:e.offsetHeight}}var v,K={opacity:function(e){return(e=a(100*(parseFloat(e,10)||0))/100)<0?0:1<e?1:e},hsb:[f(0,360,G),f(0,100,G),f(0,100,G)],rgb:[f(0,255,G),f(0,255,G),f(0,255,G)]},m={hex:(v=/^[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i,function(e){return v.test(e)})};function Q(e,t,c){var o,n,r,i,l=!0;if(K[t])if(u(o=K[t]))for(r=0,i=o.length;r<i;r++)c[r]=o[r](c[r]);else c=o(c);if(m[t]){if(u(n=m[t])){for(r=0,i=n.length;r<i;r++)if(!n[r](c[r])){l=!1;break}}else n(c)||(l=!1);l&&(e[t]=c)}return l}function U(e,t,c){var o,n=!1;return null!=c&&(e.opacity=K.opacity(c),n=!0),t&&(u(t)?(3<t.length&&(c=t[3],t=t.slice(0,3)),Q(e,"rgb",t)&&(null!=c&&(e.opacity=K.opacity(c)),ee(e,"rgb"),n=!0)):t.substr&&("rgba"===t.slice(0,4)?(o=h(t,!0),e.rgb=[o[0],o[1],o[2]],e.opacity=K.opacity(o[3]),ee(e,"rgb"),n=!0):"rgb"===t.slice(0,3)?(o=h(t),e.rgb=[o[0],o[1],o[2]],ee(e,"rgb"),n=!0):"hsla"===t.slice(0,4)?(o=p(t,!0),e.hsb=[o[0],o[1],o[2]],e.opacity=K.opacity(o[3]),ee(e,"hsb"),n=!0):"hsl"===t.slice(0,3)?(o=p(t),e.hsb=[o[0],o[1],o[2]],ee(e,"hsb"),n=!0):Q(e,"hex",q(t))&&(ee(e,"hex"),n=!0))),n}function Z(e,t){return"rgba"===t?"rgba("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+","+e.opacity+")":"rgb"===t?"rgb("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+")":"hsla"===t?"hsla("+e.hsb[0]+","+e.hsb[1]+"%,"+e.hsb[2]+"%,"+e.opacity+")":"hsl"===t?"hsl("+e.hsb[0]+","+e.hsb[1]+"%,"+e.hsb[2]+"%)":"#"+e.hex}function ee(e,t){"hsb"===t?(e.rgb=s(e.hsb),e.hex=d(e.rgb)):"rgb"===t?(e.hsb=l(e.rgb),e.hex=d(e.rgb)):"hex"===t&&(e.rgb=(t=e.hex,[(t=parseInt(t,16))>>16&255,t>>8&255,255&t]),e.hsb=l(e.rgb))}function te(e,t,c){var o=e.rgb,n=e.hsb,r=e.opacity,i=e.hex,l="rgba("+o[0]+","+o[1]+","+o[2]+","+r+")",e="rgb("+s([n[0],100,100]).join(",")+")";t.opacity.value=a(100*r),t.indic_opac.style.top=String(H(148,M(0,148-148*r)))+"px",t.hsb[0].value=n[0],t.hsb[1].value=n[1],t.hsb[2].value=n[2],t.rgb[0].value=o[0],t.rgb[1].value=o[1],t.rgb[2].value=o[2],t.hex.value=i,t.hue.style.backgroundColor=e,t.indic_sb.style.top=String(150*(100-n[2])/100)+"px",t.indic_sb.style.left=String(150*n[1]/100)+"px",t.indic_hue.style.top=String(148-148*n[0]/360)+"px",t.color_new.style.backgroundColor=l,c&&(t.color_current.style.backgroundColor=l)}function ce(e,t,c,o){var n=e===t;e&&(e.selectedColor=c,e.style.backgroundColor=c,n&&(t.value=c),o&&i(e,o),n&&"change"!==o&&i(t,"change")),t&&!n&&(t.value=c,i(t,"change"))}function _(){}function oe(e){return function(e,t){for(var c in t)o.call(t,c)&&(e[c]=t[c]);return e}({input:null,selector:null,format:"rgba",color:"ffffff",opacity:1,changeEvent:"colorchange",bindEvent:"click",onSelect:_,onBeforeShow:_,onShow:_,onHide:_,livePreview:!0},e||{})}function ne(c,n){var e,t,r,o,i,l,a,u,s,d,p,h,f,v,m,_,g,b,k,y,x,w,E,T,C=this,S=0,D=0,L=0,N=0,O=null,A=[];if(!(C instanceof ne))return new ne(c,n);b=function(e){if(27===e.keyCode)return g(!0)},g=function e(t){t=!0===t||(t.target||t.srcElement);W(r,"colorpicker-visible")&&(!0===t||t!==c&&!function(e,t,c){if(e===t)return 1;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return 16&e.compareDocumentPosition(t);for(var o=t.parentNode;o&&o!==c;){if(o===e)return 1;o=o.parentNode}}(r,t,r))&&(R(r,"colorpicker-visible"),F(document,"keyup",b),F(document,"mousedown",e),F(document,"touchstart",e),n.onHide(C))},_=function(e){var t,c,o;return W(r,"colorpicker-visible")||(n.onBeforeShow(C),t=J(e.target||e.srcElement),o="CSS1Compat"==document.compatMode,c={l:window.pageXOffset||(o?document.documentElement:document.body).scrollLeft||0,t:window.pageYOffset||(o?document.documentElement:document.body).scrollTop||0,w:window.innerWidth||(o?document.documentElement:document.body).clientWidth,h:window.innerHeight||(o?document.documentElement:document.body).clientHeight},e=t.top+t.height,o=t.left,c.t+c.h<e+185&&(e-=t.height+185),e<c.t&&(e=c.t),c.l+c.w<o+377&&(o-=377),o<c.l&&(o=c.l),r.style.left=o+"px",r.style.top=e+"px",X(r,"colorpicker-visible"),$(document,"keyup",b),$(document,"mousedown",g),$(document,"touchstart",g),n.onShow(C)),!1},o=function(e){var t,c,o,n;S||(e.preventDefault(),c=(t=(e.target||e.srcElement).parentNode).children[0],n="opacity"===(o=t[z]("data-field"))?o:o.slice(0,3),O={el:t,field:c,type:o,key:n,index:"opacity"===o?null:G(o.slice(-1)),max:"opacity"===o?100:"hsb.0"===o?360:"hsb"===n?100:255,val:G(c.value),y:(e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e).pageY},X(t,"colorpicker_slider"),c.focus(),S=1,$(document,"mouseup",l),$(document,"mousemove",i),$(document,"touchend",l),$(document,"touchcancel",l),$(document,"touchmove",i))},i=function(e){e.preventDefault();var t=O.key,c=O.index,e=(e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e).pageY;return"opacity"===t?k[t]=K[t](M(0,H(O.max,G(O.val+e-O.y)))/100):k[t][c]=M(0,H(O.max,G(O.val+e-O.y))),n.livePreview&&(ee(k,t),te(k,y)),!1},l=function(e){return e.preventDefault(),F(document,"mouseup",l),F(document,"mousemove",i),F(document,"touchend",l),F(document,"touchcancel",l),F(document,"touchmove",i),ee(k,O.key),te(k,y),R(O.el,"colorpicker_slider"),O.field.focus(),S=0,O=null,!1},a=function(e){D||(e.preventDefault(),e=e.target||e.srcElement,O={y:J(e).top},D=1,$(document,"mouseup",s),$(document,"mousemove",u),$(document,"touchend",s),$(document,"touchcancel",s),$(document,"touchmove",u))},u=function(e){e.preventDefault();e=(e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e).pageY;return k.hsb[0]=Y(360*(148-M(0,H(148,e-O.y)))/148),n.livePreview&&(ee(k,"hsb"),te(k,y)),!1},s=function(e){return e.preventDefault(),F(document,"mouseup",s),F(document,"mousemove",u),F(document,"touchend",s),F(document,"touchcancel",s),F(document,"touchmove",u),ee(k,"hsb"),te(k,y),D=0,O=null,!1},d=function(e){L||(e.preventDefault(),e=e.target||e.srcElement,O={y:J(e).top},L=1,$(document,"mouseup",h),$(document,"mousemove",p),$(document,"touchend",h),$(document,"touchcancel",h),$(document,"touchmove",p))},p=function(e){e.preventDefault();e=(e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e).pageY;return k.opacity=K.opacity((148-M(0,H(148,e-O.y)))/148),n.livePreview&&te(k,y),!1},h=function(e){return e.preventDefault(),F(document,"mouseup",h),F(document,"mousemove",p),F(document,"touchend",h),F(document,"touchcancel",h),F(document,"touchmove",p),ee(k,"opacity"),te(k,y),L=0,O=null,!1},f=function(e){N||(e.preventDefault(),e=e.target||e.srcElement,O=J(e),N=1,$(document,"mouseup",m),$(document,"mousemove",v),$(document,"touchend",m),$(document,"touchcancel",m),$(document,"touchmove",v))},v=function(e){e.preventDefault();var t=(e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e).pageX,e=(e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e).pageY;return k.hsb[1]=Y(100*M(0,H(150,t-O.left))/150),k.hsb[2]=Y(100*(150-M(0,H(150,e-O.top)))/150),n.livePreview&&(ee(k,"hsb"),te(k,y)),!1},m=function(e){return e.preventDefault(),F(document,"mouseup",m),F(document,"mousemove",v),F(document,"touchend",m),F(document,"touchcancel",m),F(document,"touchmove",v),ee(k,"hsb"),te(k,y),N=0,O=null,!1},C.dispose=function(){C.ui=null,W(r,"colorpicker-flat")||F(c,n.bindEvent,_);for(var e=0;e<A.length;e++)F(A[e].el,A[e].event,A[e].handler);A=[],r.parentNode&&r.parentNode.removeChild(r)},C.setColor=function(e,t){U(k,e,t)&&te(k,y,!0)},C.getColor=function(e){return Z(k,e||x)},C.value=function(e,t){if(!arguments.length)return Z(k,x);U(k,e,t)&&te(k,y,!0)},n=oe(n),x=c[z]("data-color-format")||n.format||"rgba",w=c[z]("data-color-change")||n.changeEvent,E=c[z]("data-color-selector")?I(c[z]("data-color-selector")):n.selector||(W(c,"colorpicker-selector")?c:null),T=c[z]("data-color-input")?I(c[z]("data-color-input")):n.input||("input"===(c.tagName||"").toLowerCase()?c:null),t=n.id||"colorpicker_ui_"+ ++B;var P,j=document.createElement("div");j.innerHTML='<div id="'+(P=t)+'" class="colorpicker">    <div id="'+P+'_satur_bright" class="colorpicker_satur_bright"><div id="'+P+'_satur_bright_indic"></div></div>    <div id="'+P+'_hue" class="colorpicker_hue"><div id="'+P+'_hue_indic" class="colorpicker_indic"></div></div>    <div id="'+P+'_opacitys" class="colorpicker_opacity"><div id="'+P+'_opacity_indic" class="colorpicker_indic"></div><div class="colorpicker_opacity_transparent"></div></div>    <div class="colorpicker_new_color colorpicker_transparent">    <button id="'+P+'_new_color" class="colorpicker_color colorpicker_save"></button>    </div>    <div class="colorpicker_current_color colorpicker_transparent">    <button id="'+P+'_current_color" class="colorpicker_color colorpicker_restore"></button>    </div>    <div class="colorpicker_field" data-field="opacity">    <input id="'+P+'_opacity" class="colorpicker_field_input" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="hex">    <input id="'+P+'_hex" class="colorpicker_field_input" type="text" maxlength="6" size="6" value=""/>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="rgb.0">    <input id="'+P+'_rgb_0" class="colorpicker_field_input" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="rgb.1">    <input id="'+P+'_rgb_1" class="colorpicker_field_input" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="rgb.2">    <input id="'+P+'_rgb_2" class="colorpicker_field_input" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="hsb.0">    <input id="'+P+'_hsb_0" class="colorpicker_field_input" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="hsb.1">    <input id="'+P+'_hsb_1" class="colorpicker_field_input" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="hsb.2">    <input id="'+P+'_hsb_2" class="colorpicker_field_input" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <button id="'+P+'_submit" class="colorpicker_submit colorpicker_save"></button>    </div>',j.style.display="none",document.body.appendChild(j),r=I(t),k={opacity:1,hsb:[0,0,0],rgb:[0,0,0],hex:"000000"},(y={opacity:I(t+"_opacity"),hsb:[I(t+"_hsb_0"),I(t+"_hsb_1"),I(t+"_hsb_2")],rgb:[I(t+"_rgb_0"),I(t+"_rgb_1"),I(t+"_rgb_2")],hex:I(t+"_hex"),hue:I(t+"_satur_bright"),indic_opac:I(t+"_opacity_indic"),indic_hue:I(t+"_hue_indic"),indic_sb:I(t+"_satur_bright_indic"),color_new:I(t+"_new_color"),color_current:I(t+"_current_color")}).indic_opac.style.top="0px",y.indic_hue.style.top="0px",y.indic_sb.style.left="0px",y.indic_sb.style.top="0px",A.push({el:r,event:"touchstart",handler:V("colorpicker_satur_bright","touchstart",f,r)}),A.push({el:r,event:"touchstart",handler:V("colorpicker_hue","touchstart",a,r)}),A.push({el:r,event:"touchstart",handler:V("colorpicker_opacity","touchstart",d,r)}),A.push({el:r,event:"touchstart",handler:V("colorpicker_increment","touchstart",o,r)}),A.push({el:r,event:"mousedown",handler:V("colorpicker_satur_bright","mousedown",f,r)}),A.push({el:r,event:"mousedown",handler:V("colorpicker_hue","mousedown",a,r)}),A.push({el:r,event:"mousedown",handler:V("colorpicker_opacity","mousedown",d,r)}),A.push({el:r,event:"mousedown",handler:V("colorpicker_increment","mousedown",o,r)}),A.push({el:r,event:"change",handler:V("colorpicker_field_input","change",function(){var e=this.parentNode[z]("data-field"),t="opacity"===e||"hex"===e?e:e.slice(0,3),e="opacity"===e||"hex"===e?null:G(e.slice(-1));"opacity"===t?k[t]=K[t](G(this.value)/100):"hex"===t?Q(k,"hex",q(this.value)):k[t][e]=K[t][e](this.value),n.livePreview&&(ee(k,t),te(k,y))},r)}),A.push({el:r,event:"click",handler:V("colorpicker_save","click",function(){e=k.rgb.slice(),te(k,y,!0),g&&g(!0),ce(E,T,Z(k,x),w)},r)}),A.push({el:r,event:"click",handler:V("colorpicker_restore","click",function(){k.rgb=e.slice(),ee(k,"rgb"),te(k,y)},r)}),C.ui=r,U(k,c[z]("data-color")||n.color,c[z]("data-opacity")||n.opacity),e=k.rgb.slice(),te(k,y,!0),W(c,"colorpicker-flat")?(X(r,"colorpicker-flat"),r.style.display="block",c.appendChild(r)):(document.body.appendChild(r),$(c,n.bindEvent,_),ce(E,T,Z(k,x))),document.body.removeChild(j),j=null,W(c,"colorpicker-light")&&X(r,"colorpicker-light"),W(c,"colorpicker-dark")&&X(r,"colorpicker-dark"),W(c,"colorpicker-transition-fade")&&X(r,"colorpicker-transition-fade"),W(c,"colorpicker-transition-slide")&&X(r,"colorpicker-transition-slide")}return ne.VERSION="2.2.0",ne});