/**
*
*   RegexAnalyzer
*   @version: 0.5.0
*
*   A simple Regular Expression Analyzer for PHP, Python, Node/XPCOM/JS, ActionScript
*   https://github.com/foo123/RegexAnalyzer
*
**/
!function(e,t,n){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(e.$deps=e.$deps||{})&&(e.EXPORTED_SYMBOLS=[t])&&(e[t]=e.$deps[t]=n.call(e)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=n.call(e)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(t,[],function(r){r(t,n.call(e))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return n.moduleUri=t.uri,n.call(e)}):t in e||(e[t]=n.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[t]})}(this,"RegexAnalyzer",function(e){"use strict";var t="0.5.0",n="prototype",r=Object,a=(Array,r.keys,r[n].toString,String.fromCharCode),l="charAt",s="charCodeAt",u=(JSON.stringify,1/0),i="hasOwnProperty",o="\\",f={".":"MatchAnyChar","|":"MatchEither","?":"MatchZeroOrOne","*":"MatchZeroOrMore","+":"MatchOneOrMore","^":"MatchStart",$:"MatchEnd","{":"StartRepeats","}":"EndRepeats","(":"StartGroup",")":"EndGroup","[":"StartCharGroup","]":"EndCharGroup"},p={"\\":"EscapeChar","/":"/",0:"NULChar",f:"FormFeed",n:"LineFeed",r:"CarriageReturn",t:"HorizontalTab",v:"VerticalTab",b:"MatchWordBoundary",B:"MatchNonWordBoundary",s:"MatchSpaceChar",S:"MatchNonSpaceChar",w:"MatchWordChar",W:"MatchNonWordChar",d:"MatchDigitChar",D:"MatchNonDigitChar"},c=1,h=2,g=3,v=4,d=5,m=6,y=7,M=8,C=9,O=10,N=11,b=function(e){var t=this;t.re=e,t.len=e.length,t.pos=0,t.groupIndex=0,t.inGroup=0},S=function oe(e,t,n){var r=this;if(!(r instanceof oe))return new oe(e,t,n);switch(r.type=e,r.val=t,r.flags=n||{},e){case c:r.typeName="Sequence";break;case h:r.typeName="Alternation";break;case g:r.typeName="Group";break;case M:r.typeName="CharacterGroup";break;case C:r.typeName="Characters";break;case O:r.typeName="CharacterRange";break;case N:r.typeName="String";break;case v:r.typeName="Quantifier";break;case d:r.typeName="UnicodeChar";break;case m:r.typeName="HexChar";break;case y:r.typeName="Special"}};S.toObjectStatic=function fe(e){return e instanceof S?{type:e.typeName,value:fe(e.val),flags:e.flags}:e instanceof Array?e.map(fe):e},S[n]={constructor:S,type:null,typeName:null,val:null,flags:null,dispose:function(){var e=this;return e.val=null,e.flags=null,e.type=null,e.typeName=null,e},toObject:function(){return S.toObjectStatic(this)}};var x=function(e,t){return Math.round((t-e)*Math.random()+e)},A=function(e){return e[s](0)},G=function(e){return[e[s](0),e[s](e.length-1)]},I=function(e,t){e&&"function"==typeof e.push&&(t=e[1],e=e[0]);var n,r,l=e[s](0),u=t[s](0);if(u==l)return[a(l)];for(r=[],n=l;u>=n;++n)r.push(a(n));return r},k=function(e,t){if(t){var n,r;if("function"==typeof t.push)for(n=0,r=t.length;r>n;n++)e[t[n]]=1;else for(n in t)t[i](n)&&(e[n]=1)}return e},w=" 	\x0B",E="~!@#$%^&*()-+=[]{}\\|;:,./<>?",L="0123456789",j=G(L),z=[j,[A("a"),A("f")],[A("A"),A("F")]],R="_"+I("a","z").join("")+I("A","Z").join(""),Z=w+E+L+R,$=Z.split(""),B=function(e,t,n,r,a){n=n||0,r=r||1,a=a||u;for(var s,i=n,o=0,f=t.length;f>i&&a>=o&&-1<e.indexOf(s=t[l](i));)i++,o++;return o>=r?o:!1},D=function(e,t,n,r,a){n=n||0,r=r||1,a=a||u;for(var l,i=n,o=0,f=t.length;f>i&&a>=o&&(l=t[s](i))>=e[0]&&l<=e[1];)i++,o++;return o>=r?o:!1},W=function(e,t,n,r,a){n=n||0,r=r||1,a=a||u;for(var l,i,o,f=n,p=0,c=t.length,h=e.length,g=!0;c>f&&a>=p&&g;)for(l=t[s](f),g=!1,i=0;h>i;i++)if(o=e[i],l>=o[0]&&l<=o[1]){f++,p++,g=!0;break}return p>=r?p:!1},U=function(){return E[l](x(0,E.length-1))},q=function(e){return!1!==e?w[l](x(0,w.length-1)):(U()+F()+T())[l](x(0,2))},F=function(e){return!1!==e?L[l](x(0,L.length-1)):(U()+q()+T())[l](x(0,2))},T=function(e){return!1!==e?R[l](x(0,R.length-1)):(U()+q()+F())[l](x(0,2))},_=function(e){return!1!==e?(R+L)[l](x(0,R.length+L.length-1)):(U()+q())[l](x(0,1))},H=function(){return Z[l](x(0,Z.length-1))},P=function(e,t){if(!1!==t)return e.length?e[x(0,e.length-1)]:"";var n=$.filter(function(t){return 0>e.indexOf(t)});return n.length?n[x(0,n.length-1)]:""},V=function(e){return x(0,1)?e.toLowerCase():e.toUpperCase()},J=function(e,t){return t?(e[l]&&(e=e.split("")),e=e.map(V)):V(e)},Q=function pe(e,t,n){if(!t||!n)return e;var r,a,l,s=t.type;if(h===s||c===s||M===s||g===s||v===s){if(l=n.map(e,t,n),null!=n.ret)e=n.reduce(e,t,n),n.ret=null;else if(null!=l)for(l instanceof Array||(l=[l]),r=0,a=l?l.length:0;a>r;r++)n.node=t,e=pe(e,l[r],n)}else C!==s&&O!==s&&d!==s&&m!==s&&y!==s&&N!==s||(e=n.reduce(e,t,n));return n.node=null,e},X=function(e,t,n){var r=t.type;if(h===r||M===r)return t.val.length?t.val[x(0,t.val.length-1)]:null;if(v===r){var a,l,s,u;if(e.length>=n.maxLength?a=t.flags.MatchZeroOrMore||t.flags.MatchZeroOrOne?0:t.flags.MatchOneOrMore?1:parseInt(t.flags.MatchMinimum,10):t.flags.MatchZeroOrMore?a=x(0,2*n.maxLength):t.flags.MatchZeroOrOne?a=x(0,1):t.flags.MatchOneOrMore?a=x(1,2*n.maxLength+1):(l=parseInt(t.flags.MatchMinimum,10),s=parseInt(t.flags.MatchMaximum,10),a=x(l,isNaN(s)?l+2*n.maxLength:s)),a){u=new Array(a);for(var i=0;a>i;i++)u[i]=t.val;return u}return null}return t.val},Y=function(e,t,n){var r=t.type;if(h===r){var a,l,s=t.val.length,u=s?0:-1,i=s?Q(0,t.val[0],n):0;for(a=1;s>a;a++)l=Q(0,t.val[a],n),i>l&&(i=l,u=a);return s&&(n.ret=i),null}if(M===r)return t.val.length?t.val[0]:null;if(v===r){if(t.flags.MatchMinimum&&"0"!==t.flags.MatchMinimum){var a,o=parseInt(t.flags.MatchMinimum,10),f=new Array(o);for(a=0;o>a;a++)f[a]=t.val;return f}return t.flags.MatchOneOrMore?t.val:null}return t.val},K=function(e,t,n){var r=t.type;if(c===r){var a,l=[],s=0,u=t.val.length;for(s=0;u>s&&(a=t.val[s],l.push(a),!(v!==a.type||a.flags.MatchOneOrMore||null!=a.flags.MatchMinimum&&"0"!==a.flags.MatchMinimum));s++);return l.length?l:null}return t.val},ee=function(e,t,n){if(null!=n.ret)return e+=n.ret;var r=t.type;return C===r||O===r||d===r||m===r||y===r&&!t.flags.MatchStart&&!t.flags.MatchEnd?e+=1:N===r&&(e+=t.val.length),e},te=function(e,t,n){if(null!=n.ret)return e+=n.ret;var r=t.type,a=null;if(C===r)a=t.val;else if(O===r)a=I(t.val);else if(d===r||m===r)a=[t.flags.Char];else if(y!==r||t.flags.MatchStart||t.flags.MatchEnd)N===r&&(a=t.val);else{var l=t.val;a="D"===l?[F(!1)]:"W"===l?[_(!1)]:"S"===l?[q(!1)]:"d"===l?[F()]:"w"===l?[_()]:"s"===l?[q()]:"."===l&&t.flags.MatchAnyChar?[H()]:["\\"+l]}return a&&(e+=N===r?n.isCaseInsensitive?J(a):a:P(n.isCaseInsensitive?J(a,!0):a,!n.node||!n.node.flags.NotMatch)),e},ne=function(e,t,n){if(null!=n.ret)return e.positive=k(e.positive,n.ret.positive),e.negative=k(e.negative,n.ret.negative),e;var r=t.type,a=n.node&&M===n.node.type,s=a&&n.node.flags.NotMatch,u=s?"negative":"positive";if(C===r)e[u]=k(e[u],t.val);else if(O===r)e[u]=k(e[u],I(t.val));else if(d===r||m===r)e[u][t.flags.Char]=1;else if(y!==r||t.flags.MatchStart||t.flags.MatchEnd)N===r&&(e.positive[t.val[l](0)]=1);else{var i=t.val;"D"===i?e[s?"positive":"negative"]["\\d"]=1:"W"===i?e[s?"positive":"negative"]["\\w"]=1:"S"===i?e[s?"positive":"negative"]["\\s"]=1:e[u]["\\"+i]=1}return e},re=function(e){var t=!1;return e.length>2&&"x"===e[l](0)&&W(z,e,1,2,2)?[t=e.slice(0,3),t.slice(1)]:!1},ae=function(e){var t=!1;return e.length>4&&"u"===e[l](0)&&W(z,e,1,4,4)?[t=e.slice(0,5),t.slice(1)]:!1},le=function(e){var t,n=e.length,r=0,a=!1,s=!1;return n>2&&"{"===e[l](r)?(a=["","",null],r++,(t=B(w,e,r))&&(r+=t),(t=D(j,e,r))?(a[1]=e.slice(r,r+t),r+=t,(t=B(w,e,r))&&(r+=t),n>r&&","===e[l](r)&&(r+=1,s=!0),(t=B(w,e,r))&&(r+=t),(t=D(j,e,r))&&(a[2]=e.slice(r,r+t),r+=t),(t=B(w,e,r))&&(r+=t),n>r&&"}"===e[l](r)?(r++,a[0]=e.slice(0,r),s||(a[2]=a[1]),a):!1):!1):!1},se=function(e){var t,n,r,s,u,f,c,h=[],g=[],v={},d=!1,m=!1;for("^"===e.re[l](e.pos)&&(v.NotMatch=1,e.pos++),r=e.len;e.pos<r;)if(c=!1,s=n,n=e.re[l](e.pos++),m=o==n,m&&(n=e.re[l](e.pos++)),m&&("u"===n?(f=ae(e.re.substr(e.pos-1)),e.pos+=f[0].length-1,n=a(parseInt(f[1],16)),c=!0):"x"===n&&(f=re(e.re.substr(e.pos-1)),e.pos+=f[0].length-1,n=a(parseInt(f[1],16)),c=!0)),d)g.length&&(h.push(S(C,g)),g=[]),u[1]=n,d=!1,h.push(S(O,u));else if(m)!c&&p[i](n)&&"/"!=n?(g.length&&(h.push(S(C,g)),g=[]),t={},t[p[n]]=1,h.push(S(y,n,t))):g.push(n);else{if("]"===n)return g.length&&(h.push(S(C,g)),g=[]),S(M,h,v);"-"===n?(u=[s,""],g.pop(),d=!0):g.push(n)}return g.length&&(h.push(S(C,g)),g=[]),S(M,h,v)},ue=function ce(e){var t,n,r,s,u,M="",C=0,O=[],b=[],x={},A=!1;for(e.inGroup>0&&(u=e.re.substr(e.pos,2),"?:"===u?(x.NotCaptured=1,e.pos+=2):"?="===u?(x.LookAhead=1,e.pos+=2):"?!"===u&&(x.NegativeLookAhead=1,e.pos+=2),x.GroupIndex=++e.groupIndex),t=e.len;e.pos<t;)if(n=e.re[l](e.pos++),A=o==n,A&&(n=e.re[l](e.pos++)),A)"u"===n?(C&&(b.push(S(N,M)),M="",C=0),r=ae(e.re.substr(e.pos-1)),e.pos+=r[0].length-1,b.push(S(d,r[0],{Char:a(parseInt(r[1],16)),Code:r[1]}))):"x"===n?(C&&(b.push(S(N,M)),M="",C=0),r=re(e.re.substr(e.pos-1)),e.pos+=r[0].length-1,b.push(S(m,r[0],{Char:a(parseInt(r[1],16)),Code:r[1]}))):p[i](n)&&"/"!=n?(C&&(b.push(S(N,M)),M="",C=0),s={},s[p[n]]=1,b.push(S(y,n,s))):(M+=n,C+=1);else{if(e.inGroup>0&&")"===n)return C&&(b.push(S(N,M)),M="",C=0),O.length?(O.push(S(c,b)),b=[],s={},s[f["|"]]=1,S(g,S(h,O,s),x)):S(g,S(c,b),x);if("|"===n)C&&(b.push(S(N,M)),M="",C=0),O.push(S(c,b)),b=[];else if("["===n)C&&(b.push(S(N,M)),M="",C=0),b.push(se(e));else if("("===n)C&&(b.push(S(N,M)),M="",C=0),e.inGroup+=1,b.push(ce(e)),e.inGroup-=1;else if("{"===n){C&&(b.push(S(N,M)),M="",C=0),r=le(e.re.substr(e.pos-1)),e.pos+=r[0].length-1,s={val:r[0],MatchMinimum:r[1],MatchMaximum:r[2]||"unlimited"},s[f[n]]=1,e.pos<t&&"?"==e.re[l](e.pos)?(s.isGreedy=0,e.pos++):s.isGreedy=1;var G=b.pop();N===G.type&&G.val.length>1&&(b.push(S(N,G.val.slice(0,-1))),G.val=G.val.slice(-1)),b.push(S(v,G,s))}else if("*"===n||"+"===n||"?"===n){C&&(b.push(S(N,M)),M="",C=0),s={},s[f[n]]=1,e.pos<t&&"?"==e.re[l](e.pos)?(s.isGreedy=0,e.pos++):s.isGreedy=1;var G=b.pop();N===G.type&&G.val.length>1&&(b.push(S(N,G.val.slice(0,-1))),G.val=G.val.slice(-1)),b.push(S(v,G,s))}else f[i](n)?(C&&(b.push(S(N,M)),M="",C=0),s={},s[f[n]]=1,b.push(S(y,n,s))):(M+=n,C+=1)}return C&&(b.push(S(N,M)),M="",C=0),O.length?(O.push(S(c,b)),b=[],s={},x[f["|"]]=1,S(h,O,s)):S(c,b)},ie=function he(e,t){return this instanceof he?void(e&&this.set(e,t)):new he(e,t)};return ie.VERSION=t,ie.Node=S,ie.getCharRange=I,ie[n]={constructor:ie,ast:null,re:null,fl:null,dispose:function(){var e=this;return e.ast=null,e.re=null,e.fl=null,e},set:function(e,t){var n=this;if(e){t=t||"/",e=e.toString();for(var r,a=e.length,s={};a>0&&(r=e[l](a-1),t!==r);)s[r]=1,a--;e=a>0?t===e[l](0)&&t===e[l](a-1)?e.slice(1,a-1):e.slice(0,a):"",n.re!==e&&(n.ast=null),n.re=e,n.fl=s}return n},analyze:function(){var e=this;return null!=e.re&&null===e.ast&&(e.ast=ue(new b(e.re))),e},compile:function(e){var t=this;return null==t.re?null:(e=e||t.fl||{},new RegExp(t.re,(e.g||e.G?"g":"")+(e.i||e.I?"i":"")+(e.m||e.M?"m":"")))},tree:function(e){var t=this;return null==t.re?null:(null===t.ast&&t.analyze(),!0===e?t.ast.toObject():t.ast)},sample:function(e,t){var n,r=this;if(null==r.re)return null;if(null===r.ast&&r.analyze(),n={map:X,reduce:te,maxLength:0|e||1,isCaseInsensitive:null!=r.fl.i},t=0|t||1,t>1){for(var a=new Array(t),l=0;t>l;l++)a[l]=Q("",r.ast,n);return a}return Q("",r.ast,n)},minimum:function(){var e,t=this;return null==t.re?0:(null===t.ast&&t.analyze(),e={map:Y,reduce:ee},0|Q(0,t.ast,e))},peek:function(){var e,t,n,r,a,s,u,i=this;if(null==i.re)return null;null===i.ast&&i.analyze(),e={map:K,reduce:ne},n=Q({positive:{},negative:{}},i.ast,e),t=null!=i.fl.i;for(r in n){u={},s=n[r];for(a in s)"\\d"===a?(delete s[a],u=k(u,I("0","9"))):"\\s"===a?(delete s[a],u=k(u,["\f","\n","\r","	","\x0B"," ","\u2028","\u2029"])):"\\w"===a?(delete s[a],u=k(u,["_"].concat(I("0","9")).concat(I("a","z")).concat(I("A","Z")))):"\\."===a?(delete s[a],u[f["."]]=1):"\\"!==a[l](0)&&t?(u[a.toLowerCase()]=1,u[a.toUpperCase()]=1):"\\"===a[l](0)&&delete s[a];n[r]=k(s,u)}return n}},ie});