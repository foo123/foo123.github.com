/**
*
*   RegexAnalyzer
*   @version: 0.5.1
*
*   A simple Regular Expression Analyzer for PHP, Python, Node/XPCOM/JS, ActionScript
*   https://github.com/foo123/RegexAnalyzer
*
**/
!function(e,t,n){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(e.$deps=e.$deps||{})&&(e.EXPORTED_SYMBOLS=[t])&&(e[t]=e.$deps[t]=n.call(e)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=n.call(e)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(t,[],function(r){r(t,n.call(e))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return n.moduleUri=t.uri,n.call(e)}):t in e||(e[t]=n.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[t]})}(this,"RegexAnalyzer",function(e){"use strict";function t(e,t){t=t||{};for(var n in e)e[o](n)&&(t[n]=e[n]);return t}var n="0.5.1",r="prototype",a=Object,l=(Array,a.keys,a[r].toString,String.fromCharCode),u="charAt",s="charCodeAt",i=(JSON.stringify,1/0),o="hasOwnProperty",f="\\",c={".":"MatchAnyChar","|":"MatchEither","?":"MatchZeroOrOne","*":"MatchZeroOrMore","+":"MatchOneOrMore","^":"MatchStart",$:"MatchEnd","{":"StartRepeats","}":"EndRepeats","(":"StartGroup",")":"EndGroup","[":"StartCharGroup","]":"EndCharGroup"},p={"\\":"EscapeChar","/":"/",0:"NULChar",f:"FormFeed",n:"LineFeed",r:"CarriageReturn",t:"HorizontalTab",v:"VerticalTab",b:"MatchWordBoundary",B:"MatchNonWordBoundary",s:"MatchSpaceChar",S:"MatchNonSpaceChar",w:"MatchWordChar",W:"MatchNonWordChar",d:"MatchDigitChar",D:"MatchNonDigitChar"},h=1,g=2,v=3,m=4,d=5,M=6,y=7,C=8,O=9,x=10,b=11,S=function(e){var t=this;t.re=e,t.len=e.length,t.pos=0,t.groupIndex=0,t.inGroup=0},N=function ce(e,t,n){var r=this;if(!(r instanceof ce))return new ce(e,t,n);switch(r.type=e,r.val=t,r.flags=n||{},e){case h:r.typeName="Sequence";break;case g:r.typeName="Alternation";break;case v:r.typeName="Group";break;case C:r.typeName="CharacterGroup";break;case O:r.typeName="Characters";break;case x:r.typeName="CharacterRange";break;case b:r.typeName="String";break;case m:r.typeName="Quantifier";break;case d:r.typeName="UnicodeChar";break;case M:r.typeName="HexChar";break;case y:r.typeName="Special"}};N.toObjectStatic=function pe(e){return e instanceof N?{type:e.typeName,value:pe(e.val),flags:e.flags}:e instanceof Array?e.map(pe):e},N[r]={constructor:N,type:null,typeName:null,val:null,flags:null,dispose:function(){var e=this;return e.val=null,e.flags=null,e.type=null,e.typeName=null,e},toObject:function(){return N.toObjectStatic(this)}};var I=function(e,t){return Math.round((t-e)*Math.random()+e)},A=function(e){return e[s](0)},E=function(e){return[e[s](0),e[s](e.length-1)]},G=function(e,t){e&&"function"==typeof e.push&&(t=e[1],e=e[0]);var n,r,a=e[s](0),u=t[s](0);if(u==a)return[l(a)];for(r=[],n=a;u>=n;++n)r.push(l(n));return r},k=function(e,t){if(t){var n,r;if("function"==typeof t.push)for(n=0,r=t.length;r>n;n++)e[t[n]]=1;else for(n in t)t[o](n)&&(e[n]=1)}return e},w=" 	\x0B",L="~!@#$%^&*()-+=[]{}\\|;:,./<>?",Z="0123456789",j=E(Z),z=[j,[A("a"),A("f")],[A("A"),A("F")]],R="_"+G("a","z").join("")+G("A","Z").join(""),$=w+L+Z+R,B=$.split(""),D=function(e,t,n,r,a){n=n||0,r=r||1,a=a||i;for(var l,s=n,o=0,f=t.length;f>s&&a>=o&&-1<e.indexOf(l=t[u](s));)s++,o++;return o>=r?o:!1},W=function(e,t,n,r,a){n=n||0,r=r||1,a=a||i;for(var l,u=n,o=0,f=t.length;f>u&&a>=o&&(l=t[s](u))>=e[0]&&l<=e[1];)u++,o++;return o>=r?o:!1},U=function(e,t,n,r,a){n=n||0,r=r||1,a=a||i;for(var l,u,o,f=n,c=0,p=t.length,h=e.length,g=!0;p>f&&a>=c&&g;)for(l=t[s](f),g=!1,u=0;h>u;u++)if(o=e[u],l>=o[0]&&l<=o[1]){f++,c++,g=!0;break}return c>=r?c:!1},q=function(){return L[u](I(0,L.length-1))},F=function(e){return!1!==e?w[u](I(0,w.length-1)):(q()+T()+_())[u](I(0,2))},T=function(e){return!1!==e?Z[u](I(0,Z.length-1)):(q()+F()+_())[u](I(0,2))},_=function(e){return!1!==e?R[u](I(0,R.length-1)):(q()+F()+T())[u](I(0,2))},H=function(e){return!1!==e?(R+Z)[u](I(0,R.length+Z.length-1)):(q()+F())[u](I(0,1))},P=function(){return $[u](I(0,$.length-1))},V=function(e,t){if(!1!==t)return e.length?e[I(0,e.length-1)]:"";var n=B.filter(function(t){return 0>e.indexOf(t)});return n.length?n[I(0,n.length-1)]:""},J=function(e){return I(0,1)?e.toLowerCase():e.toUpperCase()},Q=function(e,t){return t?(e[u]&&(e=e.split("")),e=e.map(J)):J(e)},X=function he(e,t,n){if(!t||!n)return e;var r,a,l,u=t.type;if(g===u||h===u||C===u||v===u||m===u){if(l=n.map(e,t,n),null!=n.ret)e=n.reduce(e,t,n),n.ret=null;else if(null!=l)for(l instanceof Array||(l=[l]),r=0,a=l?l.length:0;a>r;r++)if(n.node=t,e=he(e,l[r],n),n.stop)return n.stop=null,e}else O!==u&&x!==u&&d!==u&&M!==u&&y!==u&&b!==u||(e=n.reduce(e,t,n));return n.node=null,e},Y=function(e,t,n){var r=t.type;if(g===r||C===r)return t.val.length?t.val[I(0,t.val.length-1)]:null;if(m===r){var a,l,u,s;if(e.length>=n.maxLength?a=t.flags.MatchZeroOrMore||t.flags.MatchZeroOrOne?0:t.flags.MatchOneOrMore?1:parseInt(t.flags.MatchMinimum,10):t.flags.MatchZeroOrMore?a=I(0,1+2*n.maxLength):t.flags.MatchZeroOrOne?a=I(0,1):t.flags.MatchOneOrMore?a=I(1,1+2*n.maxLength):(l=parseInt(t.flags.MatchMinimum,10),u="unlimited"===t.flags.MatchMaximum?l+1+2*n.maxLength:parseInt(t.flags.MatchMaximum,10),a=I(l,u)),a){s=new Array(a);for(var i=0;a>i;i++)s[i]=t.val;return s}return null}return t.val},K=function(e,t,n){var r=t.type;if(g===r){var a,l,u=t.val.length,s=u?X(0,t.val[0],n):0;for(a=1;u>a;a++)l=X(0,t.val[a],n),s>l&&(s=l);return u&&(n.ret=s),null}if(C===r)return t.val.length?t.val[0]:null;if(m===r){if(t.flags.MatchMinimum){if("0"===t.flags.MatchMinimum)return null;var a,i=parseInt(t.flags.MatchMinimum,10),o=new Array(i);for(a=0;i>a;a++)o[a]=t.val;return o}return t.flags.MatchOneOrMore?t.val:null}return t.val},ee=function(e,t,n){var r=t.type;if(g===r){var a,l,u=t.val.length,s=u?X(0,t.val[0],n):0;if(-1!==s)for(a=1;u>a;a++){if(l=X(0,t.val[a],n),-1===l){s=-1;break}l>s&&(s=l)}return u&&(n.ret=s),null}return C===r?t.val.length?t.val[0]:null:m===r?(s=X(0,t.val,n),-1===s?n.ret=-1:s>0&&(t.flags.MatchZeroOrMore||t.flags.MatchOneOrMore||"unlimited"===t.flags.MatchMaximum?n.ret=-1:t.flags.MatchMaximum?n.ret=parseInt(t.flags.MatchMaximum,10)*s:n.ret=s),null):t.val},te=function(e,t,n){var r=t.type;if(h===r){var a,l=[],u=0,s=t.val.length;for(u=0;s>u&&(a=t.val[u],l.push(a),m===a.type&&(a.flags.MatchZeroOrOne||a.flags.MatchZeroOrMore||"0"===a.flags.MatchMinimum)||y===a.type&&(a.flags.MatchStart||a.flags.MatchEnd));u++);return l.length?l:null}return t.val},ne=function(e,t,n){if(null!=n.ret)return-1===n.ret?e=-1:e+=n.ret,e;if(-1===e)return e;if(y===t.type&&t.flags.MatchEnd)return n.stop=1,e;var r=t.type;return O===r||x===r||d===r||M===r||y===r&&!t.flags.MatchStart&&!t.flags.MatchEnd?e+=1:b===r&&(e+=t.val.length),e},re=function(e,t,n){if(null!=n.ret)return e+=n.ret;if(y===t.type&&t.flags.MatchEnd)return n.stop=1,e;var r=t.type,a=null;if(O===r)a=t.val;else if(x===r)a=G(t.val);else if(d===r||M===r)a=[t.flags.Char];else if(y!==r||t.flags.MatchStart||t.flags.MatchEnd)b===r&&(a=t.val);else{var l=t.val;a="D"===l?[T(!1)]:"W"===l?[H(!1)]:"S"===l?[F(!1)]:"d"===l?[T()]:"w"===l?[H()]:"s"===l?[F()]:"."===l&&t.flags.MatchAnyChar?[P()]:["\\"+l]}return a&&(e+=b===r?n.isCaseInsensitive?Q(a):a:V(n.isCaseInsensitive?Q(a,!0):a,!n.node||!n.node.flags.NotMatch)),e},ae=function(e,t,n){if(null!=n.ret)return e.positive=k(e.positive,n.ret.positive),e.negative=k(e.negative,n.ret.negative),e;if(y===t.type&&t.flags.MatchEnd)return n.stop=1,e;var r=t.type,a=n.node&&C===n.node.type,l=a&&n.node.flags.NotMatch,s=l?"negative":"positive";if(O===r)e[s]=k(e[s],t.val);else if(x===r)e[s]=k(e[s],G(t.val));else if(d===r||M===r)e[s][t.flags.Char]=1;else if(y!==r||t.flags.MatchStart||t.flags.MatchEnd)b===r&&(e.positive[t.val[u](0)]=1);else{var i=t.val;"D"===i?e[l?"positive":"negative"]["\\d"]=1:"W"===i?e[l?"positive":"negative"]["\\w"]=1:"S"===i?e[l?"positive":"negative"]["\\s"]=1:e[s]["\\"+i]=1}return e},le=function(e){var t=!1;return e.length>2&&"x"===e[u](0)&&U(z,e,1,2,2)?[t=e.slice(0,3),t.slice(1)]:!1},ue=function(e){var t=!1;return e.length>4&&"u"===e[u](0)&&U(z,e,1,4,4)?[t=e.slice(0,5),t.slice(1)]:!1},se=function(e){var t,n=e.length,r=0,a=!1,l=!1;return n>2&&"{"===e[u](r)?(a=["","",null],r++,(t=D(w,e,r))&&(r+=t),(t=W(j,e,r))?(a[1]=e.slice(r,r+t),r+=t,(t=D(w,e,r))&&(r+=t),n>r&&","===e[u](r)&&(r+=1,l=!0),(t=D(w,e,r))&&(r+=t),(t=W(j,e,r))&&(a[2]=e.slice(r,r+t),r+=t),(t=D(w,e,r))&&(r+=t),n>r&&"}"===e[u](r)?(r++,a[0]=e.slice(0,r),l||(a[2]=a[1]),a):!1):!1):!1},ie=function(e){var t,n,r,a,s,i,c,h=[],g=[],v={},m=!1,d=!1;for("^"===e.re[u](e.pos)&&(v.NotMatch=1,e.pos++),r=e.len;e.pos<r;)if(c=!1,a=n,n=e.re[u](e.pos++),d=f==n,d&&(n=e.re[u](e.pos++)),d&&("u"===n?(i=ue(e.re.substr(e.pos-1)),e.pos+=i[0].length-1,n=l(parseInt(i[1],16)),c=!0):"x"===n&&(i=le(e.re.substr(e.pos-1)),e.pos+=i[0].length-1,n=l(parseInt(i[1],16)),c=!0)),m)g.length&&(h.push(N(O,g)),g=[]),s[1]=n,m=!1,h.push(N(x,s));else if(d)!c&&p[o](n)&&"/"!=n?(g.length&&(h.push(N(O,g)),g=[]),t={},t[p[n]]=1,h.push(N(y,n,t))):g.push(n);else{if("]"===n)return g.length&&(h.push(N(O,g)),g=[]),N(C,h,v);"-"===n?(s=[a,""],g.pop(),m=!0):g.push(n)}return g.length&&(h.push(N(O,g)),g=[]),N(C,h,v)},oe=function ge(e){var t,n,r,a,s,i="",C=0,O=[],x=[],S={},I=!1;for(e.inGroup>0&&(s=e.re.substr(e.pos,2),"?:"===s?(S.NotCaptured=1,e.pos+=2):"?="===s?(S.LookAhead=1,e.pos+=2):"?!"===s&&(S.NegativeLookAhead=1,e.pos+=2),S.GroupIndex=++e.groupIndex),t=e.len;e.pos<t;)if(n=e.re[u](e.pos++),I=f==n,I&&(n=e.re[u](e.pos++)),I)"u"===n?(C&&(x.push(N(b,i)),i="",C=0),r=ue(e.re.substr(e.pos-1)),e.pos+=r[0].length-1,x.push(N(d,r[0],{Char:l(parseInt(r[1],16)),Code:r[1]}))):"x"===n?(C&&(x.push(N(b,i)),i="",C=0),r=le(e.re.substr(e.pos-1)),e.pos+=r[0].length-1,x.push(N(M,r[0],{Char:l(parseInt(r[1],16)),Code:r[1]}))):p[o](n)&&"/"!=n?(C&&(x.push(N(b,i)),i="",C=0),a={},a[p[n]]=1,x.push(N(y,n,a))):(i+=n,C+=1);else{if(e.inGroup>0&&")"===n)return C&&(x.push(N(b,i)),i="",C=0),O.length?(O.push(N(h,x)),x=[],a={},a[c["|"]]=1,N(v,N(g,O,a),S)):N(v,N(h,x),S);if("|"===n)C&&(x.push(N(b,i)),i="",C=0),O.push(N(h,x)),x=[];else if("["===n)C&&(x.push(N(b,i)),i="",C=0),x.push(ie(e));else if("("===n)C&&(x.push(N(b,i)),i="",C=0),e.inGroup+=1,x.push(ge(e)),e.inGroup-=1;else if("{"===n){C&&(x.push(N(b,i)),i="",C=0),r=se(e.re.substr(e.pos-1)),e.pos+=r[0].length-1,a={val:r[0],MatchMinimum:r[1],MatchMaximum:r[2]||"unlimited"},a[c[n]]=1,e.pos<t&&"?"==e.re[u](e.pos)?(a.isGreedy=0,e.pos++):a.isGreedy=1;var A=x.pop();b===A.type&&A.val.length>1&&(x.push(N(b,A.val.slice(0,-1))),A.val=A.val.slice(-1)),x.push(N(m,A,a))}else if("*"===n||"+"===n||"?"===n){C&&(x.push(N(b,i)),i="",C=0),a={},a[c[n]]=1,e.pos<t&&"?"==e.re[u](e.pos)?(a.isGreedy=0,e.pos++):a.isGreedy=1;var A=x.pop();b===A.type&&A.val.length>1&&(x.push(N(b,A.val.slice(0,-1))),A.val=A.val.slice(-1)),x.push(N(m,A,a))}else c[o](n)?(C&&(x.push(N(b,i)),i="",C=0),a={},a[c[n]]=1,x.push(N(y,n,a))):(i+=n,C+=1)}return C&&(x.push(N(b,i)),i="",C=0),O.length?(O.push(N(h,x)),x=[],a={},S[c["|"]]=1,N(g,O,a)):N(h,x)},fe=function ve(e,t){return this instanceof ve?void(e&&this.set(e,t)):new ve(e,t)};return fe.VERSION=n,fe.Node=N,fe.getCharRange=G,fe[r]={constructor:fe,ast:null,re:null,fl:null,min:null,max:null,ch:null,dispose:function(){var e=this;return e.ast=null,e.re=null,e.fl=null,e.min=null,e.max=null,e.ch=null,e},reset:function(){var e=this;return e.ast=null,e.min=null,e.max=null,e.ch=null,e},set:function(e,t){var n=this;if(e){t=t||"/",e=e.toString();for(var r,a=e.length,l={};a>0&&(r=e[u](a-1),t!==r);)l[r]=1,a--;e=a>0?t===e[u](0)&&t===e[u](a-1)?e.slice(1,a-1):e.slice(0,a):"",n.re!==e&&n.reset(),n.re=e,n.fl=l}return n},analyze:function(){var e=this;return null!=e.re&&null===e.ast&&(e.ast=oe(new S(e.re))),e},compile:function(e){var t=this;return null==t.re?null:(e=e||t.fl||{},new RegExp(t.re,(e.g||e.G?"g":"")+(e.i||e.I?"i":"")+(e.m||e.M?"m":"")))},tree:function(e){var t=this;return null==t.re?null:(null===t.ast&&t.analyze(),!0===e?t.ast.toObject():t.ast)},sample:function(e,t){var n,r=this;if(null==r.re)return null;if(null===r.ast&&r.analyze(),n={map:Y,reduce:re,maxLength:0|e||1,isCaseInsensitive:null!=r.fl.i},t=0|t||1,t>1){for(var a=new Array(t),l=0;t>l;l++)a[l]=X("",r.ast,n);return a}return X("",r.ast,n)},minimum:function(){var e,t=this;return null==t.re?0:(null===t.ast&&(t.analyze(),t.min=null),null===t.min&&(e={map:K,reduce:ne},t.min=0|X(0,t.ast,e)),t.min)},maximum:function(){var e,t=this;return null==t.re?0:(null===t.ast&&(t.analyze(),t.max=null),null===t.max&&(e={map:ee,reduce:ne},t.max=X(0,t.ast,e)),t.max)},peek:function(){var e,n,r,a,l,s,i,o=this;if(null==o.re)return null;null===o.ast&&(o.analyze(),o.ch=null),null===o.ch&&(e={map:te,reduce:ae},o.ch=X({positive:{},negative:{}},o.ast,e)),r={positive:t(o.ch.positive),negative:t(o.ch.negative)},n=null!=o.fl.i;for(a in r){i={},s=r[a];for(l in s)"\\d"===l?(delete s[l],i=k(i,G("0","9"))):"\\s"===l?(delete s[l],i=k(i,["\f","\n","\r","	","\x0B"," ","\u2028","\u2029"])):"\\w"===l?(delete s[l],i=k(i,["_"].concat(G("0","9")).concat(G("a","z")).concat(G("A","Z")))):"\\."===l?(delete s[l],i[c["."]]=1):"\\"!==l[u](0)&&n?(i[l.toLowerCase()]=1,i[l.toUpperCase()]=1):"\\"===l[u](0)&&delete s[l];r[a]=k(s,i)}return r}},fe});