/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python, Java, C/C++
*   @version: 0.8.6
*   https://github.com/foo123/Abacus
**/
!function(n,t,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[t])&&(n[t]=n.$deps[t]=e.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=e.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(t,[],function(r){r(t,e.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return e.moduleUri=t.uri,e.call(n)}):t in n||(n[t]=e.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[t]})}(this,"Abacus",function(n){"use strict";function t(){throw new Error("Method not implemented!")}function e(n){return n instanceof Array||"[object Array]"===qn.call(n)}function r(n){return n instanceof String||"[object String]"===qn.call(n)}function u(n){var t=n.toString(2),e=32-t.length;return e>0?new Array(e+1).join("0")+t:t}function i(n,t,r,u,i,l,o){var a,s,c,f,d,m,h,p,_=t,b=null,g=r&&e(r);if(g&&(null==u&&(u=0),null==i&&(i=r.length-1)),null==l&&(l=u>i?-1:1),0===l||g&&!r.length||0>=Un.floor((i-u)/l)+1)return _;if(0>l?(p=(u-i)%-l,p&&(b=i),i+=p,m=i,h=u,f=-1,c=-(-l<<4)):(p=(i-u)%l,p&&(b=i),i-=p,m=u,h=i,f=1,c=l<<4),d=u+l*(15&Un.floor((i-u)/l+1)),g){for(m=Un.max(0,m),h=Un.min(r.length-1,h),a=u;a>=m&&h>=a&&f*(d-a)>0;a+=l)_=n(_,r[a],a);for(s=d;s>=m&&h>=s;s+=c)a=s,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a),a+=l,_=n(_,r[a],a);!0===o&&null!==b&&b>=0&&b<r.length&&(_=n(_,r[b],b))}else{for(a=u;a>=m&&h>=a&&f*(d-a)>0;a+=l)_=n(_,a,a);for(s=d;s>=m&&h>=s;s+=c)a=s,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a),a+=l,_=n(_,a,a);!0===o&&null!==b&&(_=n(_,b,b))}return _}function l(n,t,r){var u=e(n)?n:(n=0|n)>0?new Array(n):[];if(n=u.length,n>0&&null!=t){r=r||0;var l=t;i("function"==typeof t?function(n,e,r){return n[r]=t(r),n}:t===+t?function(n,t,e){return n[e]=l,l+=r,n}:function(n,e,r){return n[r]=t,n},u,u)}return u}function o(n,t,e){return i(function(n,t,r){return n[r]=t[e],n},n,t)}function a(n,t,r,u,l){return null==t?n:i(e(r)?function(n,t,e){return n[e]=r[e]-1-t,n}:function(n,t,e){return n[e]=r-1-t,n},n,t,u,l)}function s(n,t,e,r,u){if(null==t)return n;if(null==r&&(r=0),null==u&&(u=t.length-1),u>=r)for(var i,l=r,o=u;o>=l;l++,o--)i=t[l],n[l]=t[o],n[o]=i;return n}function c(n,t){return null==t&&(t=0),e(n)?l(n,e(t)?function(e){return t[e]-1-n[n.length-1-e]}:function(e){return t-n[e]}):n===+n&&t===+t?t-n:Nn.Arithmetic.sub(Nn.Arithmetic.N(t),n)}function f(n,t,r,u,l){if(null==t)return null;var o=0;return i(e(r)?function(n,t,e){return n[e]=r[e]>0?(t+o)%r[e]:0,o+=r[e]-n[e],n}:function(n,t,e){return n[e]=(t+o)%r,o+=r-n[e],n},n,t,u,l)}function d(n,t,e,r,u,l,o,a){if(null==t)return null;null==e&&(e=1),null==r&&(r=0),null==u&&(u=0),null==l&&(l=t.length-1),null==o&&(o=u),null==a&&(a=l);var s=0,c=o>a?-1:1,f=o;return i(function(n,t,u){return t=r+e*t,n[f]=t-s,s=t,f+=c,n},n,t,u,l)}function m(n,t,e,r,u,l,o,a){if(null==t)return null;null==e&&(e=1),null==r&&(r=0),null==u&&(u=0),null==l&&(l=t.length-1),null==o&&(o=u),null==a&&(a=l);var s=0,c=o>a?-1:1,f=o;return i(function(n,t,u){return s+=t,n[f]=r+e*s,f+=c,n},n,t,u,l)}function h(n,t,e,r,u,i,l,o){r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=t.length-1),null==l&&(l=0),null==o&&(o=e.length-1);var a=u>i?-1:1,s=l>o?-1:1,c=a*(i-u)+1,f=s*(o-l)+1,d=u,m=l,h=0;if(null==n&&(n=new Array(Un.min(c,f))),0===n.length)return n;for(;a*(i-d)>=0&&s*(o-m)>=0;)1===r&&t[d]<e[m]||-1===r&&t[d]>e[m]?d+=a:1===r&&t[d]>e[m]||-1===r&&t[d]<e[m]?m+=s:(n[h++]=t[d],d+=a,m+=s);return h<n.length&&(n.length=h),n}function p(n,t,e,r,u,i,o,a,s){s=!0===s,r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=t===+t?t-1:t.length-1),null==o&&(o=0),null==a&&(a=e?e.length-1:-1);var c=u>i?-1:1,f=o>a?-1:1,d=c*(i-u)+1,m=u,h=o,p=0;if(!e||!e.length)return t===+t?l(t,u,c):t?t.slice():t;if(null==n&&(n=new Array(s?2*d:d)),t===+t){for(;c*(i-m)>=0&&f*(a-h)>=0;)m===e[h]?(s&&(n[p++]=m),m+=c,h+=f):1===r&&m>e[h]||-1===r&&m<e[h]?h+=f:(n[p++]=m,m+=c);for(;c*(i-m)>=0;)n[p++]=m,m+=c}else{for(;c*(i-m)>=0&&f*(a-h)>=0;)t[m]===e[h]?(s&&(n[p++]=t[m]),m+=c,h+=f):1===r&&t[m]>e[h]||-1===r&&t[m]<e[h]?h+=f:(n[p++]=t[m],m+=c);for(;c*(i-m)>=0;)n[p++]=t[m],m+=c}return p<n.length&&(n.length=p),n}function _(n,t,e,r,u,i,l,o,a,s,c){r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=t.length-1),null==l&&(l=0),null==o&&(o=e.length-1),!0===a?s=!1:(a=!1,s=!1!==s),c=!0===c;var f=u>i?-1:1,d=l>o?-1:1,m=f*(i-u)+1,h=d*(o-l)+1,p=m+h,_=u,b=l,g=0,v=null,y=!s;if(null==n&&(n=new Array(p)),0===n.length)return c?t:n;for(;f*(i-_)>=0&&d*(o-b)>=0;){if(s&&g){if(t[_]===v){_+=f;continue}if(e[b]===v){b+=d;continue}}a?1===r&&t[_][0]<e[b][0]||-1===r&&t[_][0]>e[b][0]?(n[g++]=v=t[_],_+=f):1===r&&t[_][0]>e[b][0]||-1===r&&t[_][0]<e[b][0]?(n[g++]=v=e[b],b+=d):(1===r&&t[_][1]<e[b][1]||-1===r&&t[_][1]>e[b][1]?(n[g++]=v=t[_],y&&(n[g++]=e[b])):(n[g++]=v=e[b],y&&(n[g++]=t[_])),_+=f,b+=d):1===r&&t[_]<e[b]||-1===r&&t[_]>e[b]?(n[g++]=v=t[_],_+=f):1===r&&t[_]>e[b]||-1===r&&t[_]<e[b]?(n[g++]=v=e[b],b+=d):(n[g++]=v=t[_],y&&(n[g++]=e[b]),_+=f,b+=d)}for(;f*(i-_)>=0;)(y||t[_]!==v)&&(n[g++]=v=t[_],_+=f);for(;d*(o-b)>=0;)(y||e[b]!==v)&&(n[g++]=v=e[b],b+=d);if(c){for(_=0>f?i:u,g=0;p>g;g++,_++)t[_]=n[g];return t}return g<n.length&&(n.length=g),n}function b(n,t,e,r,u){var i,l,o,a,s,c,f,d,m;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,r[5]=0,c=0,m=0,a=t,s=-1,i=u?n[a][0]:n[a],o=a+1;e>=o;o++){if(l=u?n[o][0]:n[o],l>i){if(-1===c){s=o-1;break}0===c&&(c=1)}else if(i>l){if(1===c){s=o-1;break}0===c&&(c=-1)}i=l}if(0===c&&(c=1),-1===s)s=e,r[0]=a,r[1]=s,r[2]=c;else{for(f=s+1,d=-1,i=u?n[f][0]:n[f],o=f+1;e>=o;o++){if(l=u?n[o][0]:n[o],l>i){if(-1===m){d=o-1;break}0===m&&(m=1)}else if(i>l){if(1===m){d=o-1;break}0===m&&(m=-1)}i=l}-1===d&&(d=e),0===m&&(m=1),r[0]=a,r[1]=s,r[2]=c,r[3]=f,r[4]=d,r[5]=m}}function g(n,t,e,r,u,l){null==u&&(u=0),null==l&&(l=n.length-1);var a=u>l?-1:1,c=a*(l-u)+1;if(r=!0===r,1>=c)return r?1===c?[u]:[]:n;t=-1===t?-1:1;var f,d,m,h,p,g=c,v=1,y=2,x=Un.min,A=new Array(c);if(r&&(n=i(function(n,t,e){return n[e-u]=[t,e],n},new Array(c),n,u,l,1),u=0,l=c-1),!0===e){h=u,p=-1,f=[-1,-1,0,-1,-1,0];do b(n,u,l,f,r),-1===f[3]?(t!==f[2]&&l>u&&s(n,n,u,l),d=u,m=l):(f[2]=t!==f[2]?1:0,f[5]=t!==f[5]?1:0,_(A,n,n,t,f[2]?f[1]:f[0],f[2]?f[0]:f[1],f[5]?f[4]:f[3],f[5]?f[3]:f[4],r,!1,!0),d=f[0],m=f[4]),-1!==p&&_(A,n,n,t,h,p,d,m,r,!1,!0),p=m,u=m+1;while(l>=u)}else for(;g>0;)i(function(e,i){_(A,n,n,t,u+a*i,u+a*(i+v-1),u+a*(i+v),u+a*x(i+y-1,c-1),r,!1,!0)},null,null,0,c-v-1,y),v<<=1,y<<=1,g>>=1;return r?o(n,n,1):n}function v(n,t,e,r){var u,i,l,o=n.length;if(null==e&&(e=0),null==r&&(r=o-1),null==t||0===t){for(t=0,i=n[e],u=e+1;r>=u;u++){if(l=n[u],l>i){if(-1===t)return 0;0===t&&(t=1)}else if(i>l){if(1===t)return 0;0===t&&(t=-1)}i=l}return 0===t?1:t}if(t=-1===t?-1:1,e>=r)return t;if(-1===t)for(i=n[e],u=e+1;r>=u;u++){if(l=n[u],l>i)return 0;i=l}else for(i=n[e],u=e+1;r>=u;u++){if(l=n[u],i>l)return 0;i=l}return t}function y(n,t,r,u){var l,o=Nn.Math.rndInt,a=!0===t?1:0;return e(r)?1<(l=r.length)&&i(function(n){if(a<l--){var t=o(0,l-a),e=n[r[l]];n[r[l]]=n[r[t]],n[r[t]]=e}return n},n,r,0,l-1):(null==r&&(r=0),null==u&&(u=n.length-1),1<(l=u-r+1)&&i(function(n){if(a<l--){var t=o(0,l-a),e=n[r+l];n[r+l]=n[r+t],n[r+t]=e}return n},n,n,0,l-1)),n}function x(n,t,e,r,u,i,l){null==i&&(i=0),null==l&&(l=n.length-1);var o,a,s,c,f=Nn.Math.rndInt,d=l-i+1;if(t=Un.min(t,d),e=!0===e,o=new Array(t),!0===r){for(d-=1,a=0;t>a;a++)o[a]=n[i+f(0,d)];return e&&g(o),o}for(a=0;t>a;a++)s=f(0,--d),c=n[i+s],n[i+s]=n[i+d],n[i+d]=c,o[a]=c,u&&(u[a]=s);if(u)for(a=t-1;a>=0;a--)s=u[a],c=n[i+d],n[i+d]=n[i+s],n[i+s]=c,d++;return e&&g(o),o}function A(n,t,e,r,u){e=-1===e?-1:1,null==r&&(r=0),null==u&&(u=t.length-1);var i,l,o=r,a=u;if(n===t[o])return o;if(n===t[a])return a;for(;a>o;){if(i=o+(a-o+1>>>1),l=t[i],n===l)return i;1===e&&l>n||-1===e&&n>l?a=i-1:o=i+1}return-1}function w(n,t){return n+t}function O(n,t){return n*t}function M(n,t,e,r){return i(Nn.Arithmetic.add,Nn.Arithmetic.O,n,t,e,r)}function I(n,t,e,r){return i(Nn.Arithmetic.mul,Nn.Arithmetic.I,n,t,e,r)}function S(n){var t=Nn.Arithmetic;return t.shl(t.I,t.N(n))}function C(n,t){var e=Nn.Arithmetic,r=e.N;return e.pow(r(n),r(t))}function L(n,t){var r,u=Nn.Arithmetic,l=u.O,o=u.I,a=u.J,s=u.N,c=u.add,f=(u.sub,u.div),d=u.mul;return null==t?10>=n?0>n?l:0===n?o:s([1,2,6,24,120,720,5040,40320,362880,3628800][n-1]):(r=String(n),null==L.mem1[r]&&(L.mem1[r]=d(L(n-1),n)),L.mem1[r]):!1===t?10>=n?2>n?l:s([1,2,9,44,265,1854,14833,133496,1334961][n-2]):(r="!"+String(n),null==L.mem2[r]&&(L.mem2[r]=c(1&n?a:o,d(L(n-1,!1),n))),L.mem2[r]):!0===t?10>=n?0>n?l:0===n?o:s([1,2,4,10,26,76,232,764,2620,9496][n-1]):(r="I"+String(n),null==L.mem2[r]&&(L.mem2[r]=c(L(n-1,!0),d(L(n-2,!0),n-1))),L.mem2[r]):e(t)?t.length?0>n?l:(r=String(n)+"@"+g(t.slice(),1,!0).join(","),null==L.mem3[r]&&(L.mem3[r]=f(L(n),i(function(n,t){return d(n,L(t))},L(t[t.length-1]),t,t.length-2,0))),L.mem3[r]):0>n?l:L(n):t===+t?0>t?-t>=n?-t===n?L(n):l:(r=String(n)+"@"+String(t),null==L.mem3[r]&&(L.mem3[r]=i(d,o,null,n+t+1,n)),L.mem3[r]):(t+t>n&&(t=n-t),0>t||1>n?l:0===t||1===n?o:1===t?s(n):(r=String(n)+"@"+String(t),null==L.mem3[r]&&(L.mem3[r]=u.isDefault()?Un.round(i(function(t,e){return t*(1+n/e)},(n-=t)+1,null,2,t)):c(L(n-1,t-1),L(n-1,t))),L.mem3[r])):l}function E(n,t,e){var r,u=Nn.Arithmetic,i=u.O,l=u.I,o=u.V,a=u.add,s=u.mul;return 0>n||0>t?i:2===e?n===t||1===t&&0>n?l:0===n||0===t?i:(r=String(n)+","+String(t),null==E.mem2[r]&&(E.mem2[r]=a(E(n-1,t-1,2),s(E(n-1,t,2),t))),E.mem2[r]):-1===e?t>n||0===t&&0>n?i:n===t?l:(r="-"+String(n)+","+String(t),null==E.mem1[r]&&(E.mem1[r]=a(E(n-1,t-1,-1),s(E(n-1,t,-1),-n+1))),E.mem1[r]):1&Un.abs(n-t)?o(E(n,t,-1)):E(n,t,-1)}function k(n,t,e,r){var u,l,o=Nn.Arithmetic,a=o.add,s=o.I,c=o.O;return 0>n||0>=t||e>r||e+t>n+1||n>t*r?c:r===n&&1===t||t===n&&1===r?s:(u=String(n)+","+String(t)+","+String(e)+","+String(r),null==k.mem[u]&&(n-=t*(e-1),r=r-e+1,l=String(n)+","+String(t)+","+String(e)+","+String(r),null==k.mem[l]&&(k.mem[l]=i(function(e,u){return a(e,k(n-r,t-1,1,u))},c,null,Un.max(1,Un.ceil((n-r)/(t-1))),Un.min(r,n-r-t+2),1)),k.mem[u]=k.mem[l]),k.mem[u])}function D(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,u=Nn.Arithmetic,l=u.add,o=e?e:0,a=e?e:1,s=t?t:1,c=t?t:n,f=u.O;return 0>n||t&&e&&(t+e>n+1||n>t*e)||e&&e>n||t&&t>n?f:(e&&!t&&(o=0,a=1,s=e,c=e,t=e,e=null),r=String(n)+"|"+String(t)+"|"+String(e),null==D.mem[r]&&(D.mem[r]=i(function(t,e){return i(function(t,r){return l(t,k(n,e,1,r))},t,null,a,o?o:n-e+1,1)},f,null,s,c,1)),D.mem[r])}function R(n,t,e,r){var u,l=Nn.Arithmetic,o=l.add,a=l.O,s=l.I;return 0>n||0>=t||e>r||e*t>n||n>t*r?a:1===t?n>=e&&r>=n?s:a:n===t?1>=e&&r>=1?s:a:e===r?t*e===n?s:a:n===r?L(n-t*e+t-1,t-1):(u=String(n)+","+String(t)+","+String(e)+","+String(r),null==R.mem[u]&&(R.mem[u]=i(function(n,u){return o(n,R(u,t-1,e,r))},a,null,Un.max(n-r,0),n-e,1)),R.mem[u])}function $(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,u=Nn.Arithmetic,l=u.O,o=u.I,a=u.add,s=(u.mul,u.div,l);return 0>n||t&&e&&(t+e>n+1||n>t*e)||e&&e>n||t&&t>n?s:(r=String(n)+"|"+String(t)+"|"+String(e),null==$.mem[r]&&(t&&e?$.mem[r]=t*e===n?o:R(n,t,1,e):t?$.mem[r]=R(n,t,1,n):e?$.mem[r]=n===e?o:i(function(t,r){return a(t,R(n,r,1,e))},s,null,Un.ceil(n/e),n-e+1,1):$.mem[r]=n>=1?S(n-1):o),$.mem[r])}function N(n){var t,e=Nn.Arithmetic,r=e.O,u=e.N,i=e.div,l=e.mul;return 14>=n?0>n?r:u([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900][n]):(t=String(n),null==N.mem[t]&&(N.mem[t]=i(l(N(n-1),4*n-2),n+1)),N.mem[t])}function U(n){var t,e=Nn.Arithmetic,r=e.O,u=e.N,l=e.add,o=e.mul;return 12>=n?0>n?r:u([1,1,2,5,15,52,203,877,4140,21147,115975,678570][n]):(t=String(n),null==U.mem[t]&&(U.mem[t]=i(function(t,e){return l(t,o(L(n-1,e),U(e)))},r,null,0,n-1,1)),U.mem[t])}function P(n){var t,e=Nn.Arithmetic,r=e.O,u=e.N,i=e.add;return 29>=n?0>n?r:u([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811][n]):(t=String(n),null==P.mem[t]&&(P.mem[t]=i(P(n-1),P(n-2))),P.mem[t])}function T(n){if(!arguments.length||null==n)return lt;var t=0;if(r(n)){n=n.toUpperCase().split(",");for(var e=0,u=n.length;u>e;e++)t|=Xn.call(T,n[e])?T[n[e]]:0;t>0&&!((ct|st)&t)&&(t|=lt),0>=t&&(t=lt)}else t=ft&n?ft&n:lt;return st&t&&ct&t&&(t&=~ct),at&t&&(ot|lt)&t&&(t&=~(ot|lt)),ot&t&&lt&t&&(t&=~lt),st&t&&(t&=~ut),t}function j(){var n,t,r,u,i,l,o,a,s,c,f,d=arguments.length;if(!d)return[];if(!0===arguments[0]){for(c=arguments[1].length,n=2;d>n;n++)c*=arguments[n].length;for(f=new Array(c),n=0;c>n;n++){for(a=0,l=1,r=n,t=1;d>t;t++)u=arguments[t].length,i=r%u,r=~~(r/u),o=arguments[t][i],a+=l*o,l*=u;f[n]=a}}else{for(c=arguments[0].length,n=1;d>n;n++)c*=arguments[n].length;for(f=new Array(c),n=0;c>n;n++){for(a=new Array(d),s=0,r=n,t=d-1;t>=0;t--)if(u=arguments[t].length,i=r%u,r=~~(r/u),o=arguments[t][i],e(o))for(l=o.length-1;l>=0;l--)a[d-++s]=o[l];else a[d-++s]=o;f[n]=a}}return f}function X(){var n,t,e=arguments,r=e.length,u=0;for(t=0;r>t;t++)u+=e[t].length;return n=0,t=0,l(u,function(r){return r>=n+e[t].length&&(n+=e[t++].length),n+e[t][r-n]})}function q(n,t,e){var r,u,i,l,o,a,s,c,f,d,m,h,p,_,b,g,v,y,x,A,w,O,M,I,S=n.length,C=null,L=null;if(!S)return[];for("function"==typeof e?(L=e,e=!0):e=!1,Qn!==t&&Zn!==t&&nt!==t&&tt!==t&&et!==t&&rt!==t&&(t=!1),v=new Array(S),g=[],y=0,u=1,r=0;S>r;r++)if("function"==typeof n[r][0])null==v[n[r][1]]?v[n[r][1]]=[[n[r][0],r]]:v[n[r][1]].push([n[r][0],r]);else if(g.push(r),u*=n[r].length,0>=u)return[];for(_=new Array(u),p=0,h=S-1,y=g.length-1,A=new Array(S),w=0,r=0;u>r;r++){for(d=new Array(S),l=r,i=y;i>=0;i--)if(b=g[i],o=n[b].length,a=l%o,l=~~(l/o),d[b]=n[b][a],null!=v[b])for(A[0]=b,w=1;w>0;)for(b=A[--w],O=v[b],s=d[b],M=0,I=O.length;I>M;M++)b=O[M][1],d[b]=O[M][0](s),null!=v[b]&&(A[w++]=b);if(x=!1,t||e)if(e&&!L(d,h,h))x=!0;else for(f=d[h],Zn===t&&(C={},C[f]=1),m=h-1;m>=0;m--){if(c=d[m],e&&!L(d,m,h)||Qn===t&&f!==c||Zn===t&&1===C[c]||nt===t&&c>=f||tt===t&&f>=c||et===t&&f>c||rt===t&&c>f){x=!0;break}Zn===t&&(C[c]=1),f=c}x||(_[p++]=d)}return _.length>p&&(_.length=p),_}function V(n,t,u,i,o,a){var c,f,d,m,h,_,b,y,x,A=t,w=A.length,O=!1,M=[],I=[],S={},C=function(t){return t>=0&&n>t};for(t=[],O=!1,h=0,d=0;w>d;d++,h++)if(f=A[d],r(f))if(c=f.match(Bn)){if(0<c[1].indexOf("..")?(c=c[1].split("..").map(Number),m=c[0]>c[1]?p(null,n,l(c[0]-c[1]+1,c[1],1).filter(C)).reverse():p(null,n,l(c[1]-c[0]+1,c[0],1).filter(C))):m=p(null,n,c[1].split(",").map(Number).filter(C)),!m.length){O=!0;break}t.push(m)}else if(c=f.match(Wn)){if(0<c[1].indexOf("..")?(c=c[1].split("..").map(Number),m=(c[0]>c[1]?l(c[0]-c[1]+1,c[0],-1):l(c[1]-c[0]+1,c[0],1)).filter(C)):m=c[1].split(",").map(Number).filter(C),!m.length){O=!0;break}t.push(m)}else{if(_=-1,b=null,y=null,f=f.replace(Fn,function(n,t){return null===b&&(_=parseInt(t,10),b="v"+String(_)),b}),!C(_)){u&&u.splice(h--,1);continue}try{y=new Function(b,"return Math.floor("+f+");")}catch(L){y=null}if("function"!=typeof y){u&&u.splice(h--,1);continue}S[_]?S[_].push(y):S[_]=[y],0>u.indexOf(_)&&I.push(_),M.push([y,null,null,_,u[h]]),t.push(M[M.length-1])}else if(e(f)){if(m=!1===f[0]?p(null,n,f.slice(1).filter(C)):f.slice(1).filter(C),!m.length){O=!0;break}t.push(m)}if(O&&(t=[]),I.length)for(d=0,w=I.length;w>d;d++)u.push(I[d]),O||t.push(l(n,0,1));if(d=v(u),-1===d?(s(u,u),O||s(t,t)):0===d&&(f=g(u,1,!1,!0),fn(u,f),O||fn(t,f)),O)return[];if(M.length)for(d=0,w=M.length;w>d;d++)if(c=M[d],c[1]=u.indexOf(c[3]),c[2]=u.indexOf(c[4]),y=S[c[3]],"function"!=typeof t[c[1]][0]){if(m=t[c[1]].filter(function(t){for(var e,r=0,u=y.length;u>r;r++)if(e=y[r](t),0>e||e>=n)return!1;return!0}),!m.length){O=!0;break}t[c[1]]=m}return O?[]:(i="="===i?Qn:"!="===i||"<>"===i?Zn:"<"===i?nt:"<="===i||"=<"===i?rt:">"===i?tt:">="===i||"=>"===i?et:null,x="function"==typeof o?function(t,e,r){return 0<=t[e]&&t[e]<n&&o(t,e,r)}:function(t,e,r){return 0<=t[e]&&t[e]<n},!0===a?t:q(t,i,x))}function J(n){n=String(n||"");var t,e,r,u,i,l,o,a=n.length,s=0,c=[],f=[];for(t=0,e=0;a>t;)if(r=n.charAt(t++),"("===r){for(o=1,u="";a>t;){if(r=n.charAt(t++),"("===r)o++;else if(")"===r&&(o--,0===o))break;u+=r}if(u=Gn(u),l=u.length?u.match(Bn)||u.match(Wn)||Hn.test(u):null)c.push(u),f.push(e++),s=e;else{if(i=1,"{"===n.charAt(t)){for(t+=1,u="";a>t&&(r=n.charAt(t++),"}"!==r);)u+=r;u=Gn(u),i=u.length?parseInt(u,10)||1:1}e+=i,s=e+1}}return{n:s,data:c,position:f}}function G(n,t,e,r){if(null==t||!t.length)return l(n,0,1);var u,i=t.length;return!0===e&&i>1&&(u=v(t),0===u?t=g(t.slice(),1,!0):-1===u&&(t=s(new Array(i),t))),p(null,n,t,1,null,null,null,null,r)}function F(n,t){if(0>t)return[];var e,r=l(t,0,0),u=n.length;for(t-=1,e=0;u>e;e++)r[t-n[e]]=1;return r}function H(n,t){t=Un.min(t||n.length,n.length);var e,r=[];for(t-=1,e=0;t>=e;e++)0<n[e]&&r.push(t-e);return r}function W(n,t,e){return null==n?null:(t=t||n.length,m(new Array(t),n,1,-1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function B(n,t,e){return null==n?null:(t=t||n.length,d(new Array(t),n,1,1,-1===e?t-1:0,-1===e?0:t-1,0,t-1))}function Y(n,t,r){if(null==t)return null;var u,o=null,a=t.length;if(r=-1===r?-1:1,n)u=i(w,0,t),1>=u?o=t.slice():(o=B(p(null,u-1,W(t,a-1,r))),0<(u-=i(w,0,o))&&o.push(u),0>r&&s(o,o));else{var c,f,d,m,h,_=1,b=0,g=0,v="push";if(0>r&&(_=-_,b=a-1-b,v="unshift"),e(t[b]))for(h=t[b],o=[[h[1],h[0]]],c=0,d=1,m=_+b;a>d;d++,m+=_)h=t[m],f=0>r?0:c,h[1]===o[f][0]?o[f][1]+=h[0]:(o[v]([h[1],h[0]]),c++);else for(u=t[b],o=l(u,1,0),0>r&&(g=u-1-g),d=1,m=_+b;a>d;d++,m+=_)for(c=0,f=g,h=t[m];u>c&&h>0;)o[f]++,h--,c++,f+=_}return o}function z(n,t){if(null==n)return null;var e,r,u,i,l=[],o=n.length,a=-1===t,s=1,c=0,f="push";for(a&&(s=-s,c=o-1-c,f="unshift"),u=n[c],i=[u,1],e=1;o>e;e++)r=s*e+c,u===n[r]?i[1]++:(l[f](i),u=n[r],i=[u,1]);return l[f](i),l}function K(n,t){if(null==n)return null;var e,r,u,i,l,o=[],a=n.length,s=-1===t,c=1,f=0,d="push";for(s&&(c=-c,f=a-1-f,d="unshift"),e=0;a>e;e++)if(l=n[c*e+f],1===l[1])o[d](l[0]);else for(u=l[1],i=l[0],r=0;u>r;r++)o[d](i);return o}function Q(n,t,e){var r,u,i=t.length,l=i*i;for(n=n||new Array(l),r=0,u=0;l>r;)n[r+u]=0,++u>=i&&(u=0,r+=i);if(!0===e)for(r=0;i>r;r++)n[i*t[r]+r]=1;else for(r=0,u=0;i>u;u++,r+=i)n[r+t[r]]=1;return n}function Z(n,t,e){var r,u,i=t.length,l=Un.floor(Un.sqrt(i));if(n=n||new Array(l),!0===e)for(r=0,u=0;l>r;)t[l*r+u]&&(n[u]=r),++u>=l&&(u=0,r++);else for(r=0,u=0;l>r;)t[r+u]&&(n[r]=u),++u>=l&&(u=0,r++);return n}function nn(n,t,e){var r=n?n.length:0,u=1,l=0,o=0,a=r>o?n[o]||1:1;return-1===e&&(u=-1,l=(r||t)-1),i(function(t,e){return 0>=a&&(o++,l+=u,a=r>o?n[o]||1:1),a--,t[e]=l,t},new Array(t),null,0,t-1)}function tn(n){return rn(null,g(n,1,!1,!0))}function en(n,t){return t&&t.length?i(function(n,e,r){return n[r]=e<t.length?t[e]:e,n},n,n):n}function rn(n,t){return i(function(n,t,e){return n[t]=e,n},n||new Array(t.length),t)}function un(n,t,e){var r=t.length,u=Un.ceil(Vn(e||r)),o=1<<u,a=(1<<1+u)-1,s=l(a,0,0);return i(function(n,t,e){for(var r=t+o,i=0;u>i;i++)1&r&&(t-=s[r>>>1<<1]),s[r]+=1,r>>>=1;return s[r]+=1,n[e]=t,n},n||new Array(r),t)}function ln(n,t,e){var r,u,l,o=t.length,a=Un.ceil(Vn(e||o)),s=1<<a,c=(1<<1+a)-1,f=new Array(c);for(r=0;a>=r;r++)for(l=1,u=1<<r;u>=l;l++)f[u-1+l]=1<<a-r;return i(function(n,t,e){for(var r=1,u=0;a>u;u++)f[r]-=1,r<<=1,t>=f[r]&&(t-=f[r],r++);return f[r]=0,n[e]=r-s,n},n||new Array(o),t)}function on(n,t,e){var r,u=n.length,i=null==t;if(u>1)for(i&&(t=new Array(u-1),e=0),r=u-1;r>=1;r--)t[e++]=[n[0],n[r]];else i&&(t=[]);return i?t:e}function an(n,t){var e,r,u,i,l=n.length,o=new Array(l),a=!0===t?1:0,s=new Array(l),c=0,f=0;for(e=0;l>e;e++)s[e]=0;for(u=new Array(l),i=0,r=c++,u[i++]=r,s[r]=1;l>c;){if(r=n[r],s[r])for(i>a&&(u.length=i,o[f++]=u),u=new Array(l),i=0;l>c&&s[r=c];)++c;s[r]||(u[i++]=r,s[r]=1)}return i>a&&(u.length=i,o[f++]=u),f<o.length&&(o.length=f),o}function sn(n){var t,e,r=n.length,u=new Array(r),i=0,l=an(n,!0);for(t=0,e=l.length;e>t;t++)i=on(l[t],u,i);return i<u.length&&(u.length=i),u}function cn(n,t){var e,r,u,i=n.length,l=new Array(t);for(e=0;t>e;e++)l[e]=e;for(e=0;i>e;e++)swap=r[e],u=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=u;return l}function fn(n,t,e){var r=n.length,u=t.length;if(!0===e)return i(u>r?function(e,u){return e[u]=t[u]<r?n[t[u]]:n[u],e}:r>u?function(e,r){return e[r]=u>r?n[t[r]]:n[r],e}:function(e,r){return e[r]=n[t[r]],e},new Array(r),null,0,r-1,1);for(var l=n.slice(),o=0;r>o;o++)n[o]=l[t[o]];return n}function dn(n){return i(function(n,t){return fn(n,t,!0)},n.length?n[0].slice():[],n,1,n.length-1,1)}function mn(n){var t,e,r,u=n.length,i=0;for(e=0;u>e;e++)i+=n[e].length;return t=0,e=0,r=u?n[e].length:0,l(i,function(u){return u>=t+r&&(t+=r,r=n[++e].length),t+n[e][u-t]})}function hn(n,t){if(t=t||n.length,t!==n.length)return!1;var e,r,u=l(t,0,0);for(e=0;t>e;e++){if(r=n[e],0>r||r>=t||0<u[r])return!1;u[r]++}for(e=0;t>e;e++)if(1!==u[e])return!1;return!0}function pn(n){for(var t=n.length,e=0;t>e;e++)if(n[e]!==e)return!1;return!0}function _n(n){for(var t=n.length,e=0,r=n[e];t>e;e++,r=n[e])if(0>r||r>=t||n[r]!==e)return!1;return!0}function bn(n,t){if(t=t||1,1>t)return!1;var e,r,u,i=n.length;for(e=0;i>e;e++){for(r=n[e],u=1;t>=u&&e!==r;)u++,r=n[r];if(e!==r||u!==t&&(u>=t||t%u>0))return!1}return!0}function gn(n,t,e){t=0|t;for(var r=0,u=n.length,i=0;u>i;i++)if(n[i]===i&&++r>t)return!1;return!0===e?r===t:!0}function vn(n){for(var t=n.length,e=1,r=n[0];t>e;e++)if(n[e]!==(r+e)%t)return!1;return!0}function yn(n){for(var t=n.length-1,e=-1,r=0,u=n[r];t>r;r++,u=n[r])if(u>e&&(e=u),r>=e)return!1;return!0}function xn(n,t,e,r,u,i){var l,o,a,s,c,f,d,m,h,p,_=t;if("tuple"===r?(l=_[0],_=_[1]):l=_.length,h=0,p=l-1,f=1,s=p,c=h,d=1,m=0,ot&u&&(f=-f,s=p-s,c=p-c,d=-d,m=p-m),it&u&&(f=-f,s=p-s,c=p-c,d=-d,m=p-m),ut&u&&(e=-e),0>e)if("tuple"===r){for(o=s;o>=h&&p>=o&&0===n[o];)o-=f;if(o>=h&&p>=o)for(_-=1,n[o]=n[o]-1,a=o+f;a>=h&&p>=a;a+=f)n[a]=_;else n=null}else{for(o=s;o>=h&&p>=o&&0===n[o];)o-=f;if(o>=h&&p>=o)for(n[o]=n[o]-1,a=o+f;a>=h&&p>=a;a+=f)n[a]=_[d*a+m]-1;else n=null}else if("tuple"===r){for(o=s;o>=h&&p>=o&&n[o]+1===_;)o-=f;if(o>=h&&p>=o)for(n[o]=n[o]+1,a=o+f;a>=h&&p>=a;a+=f)n[a]=0;else n=null}else{for(o=s;o>=h&&p>=o&&n[o]+1===_[d*o+m];)o-=f;if(o>=h&&p>=o)for(n[o]=n[o]+1,a=o+f;a>=h&&p>=a;a+=f)n[a]=0;else n=null}return n}function An(n,t,e,r){return null}function wn(n,t,e,r,u,i,l){var o,a,s,c,f,d,m,h,p,_,b,g,v,y,x=t,A=null==i?x:i;if(v=0,y=x-1,h=1,m=y,p=1,_=0,b=1,g=0,ot&u&&(h=-h,m=y-m,p=-p,_=A-1-_,e=-e),it&u&&(h=-h,m=y-m,b=-1,g=A-1),ut&u&&(e=-e),0>e)if("cyclic"===r)if(o=y-m,p*n[o]+_>0)for(b=x-1,h=x+h,s=0;x>s;s++)f=(p*n[o]+_+b)%x,n[o]=p*f+_,o=(o+h)%x;else n=null;else if("involution"===r)n=null;else if("connected"===r)n=null;else do{for(d=!1,o=m-h;o>=v&&y>=o&&p*n[o]<=p*n[o+h];)o-=h;if(o>=v&&y>=o){for(a=m;a>=v&&y>=a&&h*(a-o)>0&&p*n[o]<=p*n[a];)a-=h;for(f=n[o],n[o]=n[a],n[a]=f,s=o+h,c=m;s>=v&&y>=s&&c>=v&&y>=c&&h*(c-s)>0;)f=n[s],n[s]=n[c],n[c]=f,d=d||b*s+g===n[s]||b*c+g===n[c],s+=h,c-=h;if("derangement"===r)for(a>=v&&y>=a&&(d=d||b*a+g===n[a]),c>=v&&y>=c&&(d=d||b*c+g===n[c]),d=d||b*o+g===n[o],s=o-h;!d&&s>=v&&y>=s;s-=h)d=b*s+g===n[s];else d=!1}else n=null}while(n&&d);else if("cyclic"===r)if(o=y-m,p*n[o]+_<x-1)for(b=x+1,h=x+h,s=0;x>s;s++)f=(p*n[o]+_+b)%x,n[o]=p*f+_,o=(o+h)%x;else n=null;else if("involution"===r){for(o=x,d=!0;d&&o--;)for(a=n[o],n[o]=o,n[a]=a;a--;)if(n[a]===a){n[o]=a,n[a]=o,d=!1;break}d&&(n=null)}else if("connected"===r)n=null;else do{for(d=!1,o=m-h;o>=v&&y>=o&&p*n[o]>=p*n[o+h];)o-=h;if(o>=v&&y>=o){for(a=m;a>=v&&y>=a&&h*(a-o)>0&&p*n[o]>=p*n[a];)a-=h;for(f=n[o],n[o]=n[a],n[a]=f,s=o+h,c=m;s>=v&&y>=s&&c>=v&&y>=c&&h*(c-s)>0;)f=n[s],n[s]=n[c],n[c]=f,d=d||b*s+g===n[s]||b*c+g===n[c],s+=h,c-=h;if("derangement"===r)for(a>=v&&y>=a&&(d=d||b*a+g===n[a]),c>=v&&y>=c&&(d=d||b*c+g===n[c]),d=d||b*o+g===n[o],s=o-h;!d&&s>=v&&y>=s;s-=h)d=b*s+g===n[s];else d=!1}else n=null}while(n&&d);return n}function On(n,t,e,r,u){if(null==n)return null;var i,l=null;if("ordered"===u)for(l={},i=0;e>i;i++)l[n[i]]=1;return l}function Mn(n,t,e,r,u,i){var l,o,a,s,c,f,d,m,h,p,_,b,g,v,y=t[1],x=t[0];if(d=0,m=y-1,f=1,c=m,h=1,p=0,_=1,b=0,ot&u&&(h=-h,p=x-1-p,f=-f,c=m-c,_=-_,b=m-b),it&u&&(f=-f,c=m-c,_=-_,b=m-b),ut&u&&(e=-e),0>e)if("ordered+repeated"===r){for(l=c;l>=d&&m>=l&&0===n[l];)l-=f;if(l>=d&&m>=l)for(x-=1,n[l]=n[l]-1,o=l+f;o>=d&&m>=o;o+=f)n[o]=x;else n=null}else if("ordered"===r){for(null==i&&(i=On(n,x,y,u,r)),l=c,a=-1;-1===a&&l>=d&&m>=l;){if(h*n[l]+p-h>=0)for(o=h*n[l]+p-h;o>=0&&x>o;o-=h)if(s=h*o+p,null==i[s]){a=l,i[s]=1;break}i[n[l]]=null,l-=f}if(a>-1)for(n[a]=s,o=x-1-p,s=h*o+p,l=a+f;l>=d&&m>=l;l+=f){for(;o>=0&&x>o&&null!=i[s];)o-=h,s=h*o+p;n[l]=s,i[s]=1}else n=null}else if(v="repeated"===r,g=v?0:1,ot&u)if(f=-f,c=m-c,_=-_,b=m-b,l=m-c,o=0>f?d:m,!v&&n[o]+1>y||v&&n[o]>0){if(v)for(;l>=d&&m>=l&&0===n[l];)l+=f;else for(;l>=d&&m>=l&&_*l+b===n[l];)l+=f;for(n[l]-=1,l-=f;l>=d&&m>=l;)n[l]=n[l+f]-g,l-=f}else n=null;else{for(a=-1,l=c;l-f>=d&&m>=l-f;l-=f)if(n[l]>n[l-f]+g){a=l;break}if(!(a>=d&&m>=a)&&0<n[0>f?m:d]&&(a=0>f?m:d),a>=d&&m>=a){for(s=x-1+g,l=c;l>=d&&m>=l&&f*(l-a)>0;l-=f)s-=g,n[l]=s;n[a]--}else n=null}else if("ordered+repeated"===r){for(l=c;l>=d&&m>=l&&n[l]+1===x;)l-=f;if(l>=d&&m>=l)for(n[l]=n[l]+1,o=l+f;o>=d&&m>=o;o+=f)n[o]=0;else n=null}else if("ordered"===r){for(null==i&&(i=On(n,x,y,u,r)),l=c,a=-1;-1===a&&l>=d&&m>=l;){if(h*n[l]+p+h<x)for(o=h*n[l]+p+h;o>=0&&x>o;o+=h)if(s=h*o+p,null==i[s]){a=l,i[s]=1;break}i[n[l]]=null,l-=f}if(a>-1)for(n[a]=s,o=p,s=h*o+p,l=a+f;l>=d&&m>=l;l+=f){for(;o>=0&&x>o&&null!=i[s];)o+=h,s=h*o+p;n[l]=s,i[s]=1}else n=null}else if(v="repeated"===r,g=v?0:1,ot&u)if(f=-f,c=m-c,_=-_,b=m-b,l=m-c,!v&&n[l]+y<x||v&&n[l]+1<x){for(s=_*l+b;l+f>=d&&m>=l+f&&n[l]+g===n[l+f];)n[l]=s,l+=f,s+=g;n[l]+=1}else n=null;else{if(v){for(a=-1,o=x-1,l=c;l>=d&&m>=l;l-=f)if(n[l]<o){a=l;break}}else for(a=-1,o=x-y,l=c;l>=d&&m>=l;l-=f)if(n[l]<o+_*l+b){a=l;break}if(a>=d&&m>=a){if(s=n[a]+1,o=v?x-1:x-y+_*a+b,s===o)n[a]=s;else if(o>s)for(l=a;l>=d&&m>=l;l+=f)n[l]=s,s+=g}else n=null}return n}function In(n,t,e,r,u){return null}function Sn(n,t,e,r,u,i,o){var a,s,c,f,d,m,h,p,_,b,g=t;if(_=0,b=n.length-1,p=1,c=_,f=b,it&i&&(p=-p,c=b-c,f=b-f),ut&i&&(e=-e),0>e)if(r)n=null;else if(ot&i)n=null;else if(s=u?c+p:c,s>=_&&b>=s&&n[s]>1){for(a=f,h=0;a>=_&&b>=a&&p*(a-s)>=0&&1===n[a];)h+=n[a],a-=p;m=n[a]-1,h++,n[a]=m,n=0>p?n.slice(a):n.slice(0,a+1),h>m?(s=h%m,n=0>p?(s?[s]:[]).concat(l(Un.floor(h/m),m)).concat(n):n.concat(l(Un.floor(h/m),m)).concat(s?[s]:[])):h>0&&(n=0>p?[h].concat(n):n.concat([h]))}else n=null;else if(r)n=null;else if(ot&i)n=null;else if(u?(m=Un.min(u,g-u),d=Un.floor(g/u)+(g%u?1:0)-1,m=b>d||n[c+(d-1)*p]<m,s=c+p):(m=n[c]<g,s=c),s>=_&&b>=s&&m){for(b>0?(a=f-p,h=n[f]):(a=f,h=0);a>=_&&b>=a&&a-p>=_&&b>=a-p&&p*(a-s)>0&&n[a]===n[a-p];)h+=n[a],a-=p;n[a]++,h--,n=h>0?0>p?l(h,1).concat(n.slice(a)):n.slice(0,a+1).concat(l(h,1)):0>p?n.slice(a):n.slice(0,a+1)}else n=null;return n}function Cn(n,t,e,r,u,i,o){var a,s,c,f,d,m,h,p,_=t;if(h=0,p=n.length-1,m=1,s=h,c=p,it&i&&(m=-m,s=p-s,c=p-c),ut&i&&(e=-e),0>e)if(r)if(u)n=null;else if(ot&i)if(f=n[s],_-r+1>f){for(n[s]=1,a=s+m;a>=h&&p>=a&&1===n[a];)a+=m;n[a]--,a-m>=h&&p>=a-m&&(n[a-m]=1+f)}else n=null;else if(f=n[c],_-r+1>f){for(n[c]=1,a=c;a>=h&&p>=a&&1===n[a];)a-=m;n[a]--,a+m>=h&&p>=a+m&&(n[a+m]=1+f)}else n=null;else if(u)n=null;else if(ot&i)n=null;else if(_>n.length){for(a=c,d=0;a>=h&&p>=a&&1===n[a];)a-=m,d++;f=n[a]-1,n[a]=f,d++,d>0&&(a+m>=h&&p>=a+m?(a+=m,n[a]=d,d=0,n=0>m?n.slice(a):n.slice(0,a+1)):n=0>m?l(d,1,0).concat(n):n.concat(l(d,1,0)))}else n=null;else if(r)if(u)n=null;else if(ot&i)if(_-r+1>n[c]){for(a=s;a>=h&&p>=a&&1===n[a];)a+=m;f=n[a],n[a]=1,n[s]=f-1,a+m>=h&&p>=a+m&&n[a+m]++}else n=null;else if(_-r+1>n[s]){for(a=c;a>=h&&p>=a&&1===n[a];)a-=m;f=n[a],n[a]=1,n[c]=f-1,a-m>=h&&p>=a-m&&n[a-m]++}else n=null;else u?n=null:ot&i?n=null:_>n[s]?(d=n[c],n[c-m]++,0>m?(n.shift(),n.unshift.apply(n,l(d-1,1,0))):(n.pop(),n.push.apply(n,l(d-1,1,0)))):n=null;return n}var Ln,En,kn,Dn,Rn,$n,Nn={VERSION:"0.8.6"},Un=Math,Pn="prototype",Tn="constructor",jn=Array.prototype.slice,Xn=Object[Pn].hasOwnProperty,qn=Object[Pn].toString,Vn=Un.log2||function(n){return Un.log(n)/Un.LN2},Jn=/^\s+|\s+$/g,Gn=String.prototype.trim?function(n){return n.trim()}:function(n){return n.replace(Jn,"")},Fn=/\[(\d+)\]/g,Hn=/\[(\d+)\]/,Wn=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,Bn=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,Yn=Object.create,zn=function(n,t){for(var e in t)Xn.call(t,e)&&(n[e]=t[e]);return n},Kn=function(n,t){1===arguments.length&&(t=n,n=Object);var e=t[Tn];return Xn.call(t,"__static__")&&(e=zn(e,t.__static__),delete t.__static__),e[Pn]=zn(Yn(n[Pn]),t),e},Qn=1,Zn=-1,nt=3,tt=-3,et=-2,rt=2,ut=1,it=2,lt=4,ot=8,at=16,st=32,ct=lt|ot|at,ft=ct|st|ut|it;return L.mem1={},L.mem2={},L.mem3={},E.mem1={},E.mem2={},k.mem={},D.mem={},R.mem={},$.mem={},N.mem={},U.mem={},P.mem={},Nn.Class=Kn,Nn.Options={MAXMEM:1e6,RANDOM:"index"},T.LEX=T.LEXICOGRAPHIC=lt,T.COLEX=T.COLEXICOGRAPHIC=ot,T.MINIMAL=T.GRAY=at,T.RANDOM=st,T.REV=T.ANTI=T.REVERSE=T.REVERSED=ut,T.REF=T.REFLECT=T.REFLECTED=it,T.REVLEX=T.ANTILEX=T.REVERSELEXICOGRAPHIC=T.ANTILEXICOGRAPHIC=lt|ut,T.REFLEX=T.REFLECTEDLEXICOGRAPHIC=lt|it,T.REVCOLEX=T.ANTICOLEX=T.REVERSECOLEXICOGRAPHIC=T.ANTICOLEXICOGRAPHIC=ot|ut,T.REFCOLEX=T.REFLECTEDCOLEXICOGRAPHIC=ot|it,Nn.ORDER=T,Nn.Math={O:0,I:1,J:-1,N:function(n){return Nn.Arithmetic.add(Nn.Arithmetic.O,n)},V:function(n){return Nn.Arithmetic.sub(Nn.Arithmetic.O,n)},rnd:Un.random,rndInt:function(n,t){return Nn.Math.round((t-n)*Nn.Math.rnd()+n)},equ:function(n,t){return n===t},gte:function(n,t){return n>=t},lte:function(n,t){return t>=n},gt:function(n,t){return n>t},lt:function(n,t){return t>n},inside:function(n,t,e,r){return r?n>=t&&e>=n:n>t&&e>n},clamp:function(n,t,e){return t>n?t:n>e?e:n},wrap:function(n,t,e){return t>n?e:n>e?t:n},wrapR:function(n,t){return 0>n?n+t:n},add:w,sub:function(n,t){return n-t},mul:O,div:function(n,t){return Nn.Math.floor(n/t)},mod:function(n,t){return n%t},pow:Un.pow,shl:function(n,t){return n<<t},shr:function(n,t){return n>>t},bor:function(n,t){return n|t},band:function(n,t){return n&t},xor:function(n,t){return n^t},abs:Un.abs,min:Un.min,max:Un.max,floor:Un.floor,ceil:Un.ceil,round:Un.round,num:function(n){return"number"==typeof n?Nn.Math.floor(n):parseInt(n,10)},val:function(n){return Nn.Math.floor(n.valueOf())},sum:M,product:I,pow2:S,exp:C,factorial:L,stirling:E,partitions:D,compositions:$,bell:U,catalan:N,fibonacci:P},Nn.Arithmetic={isDefault:function(){return 0===Nn.Arithmetic.O&&Nn.Arithmetic.add===w},O:0,I:1,J:-1,N:Nn.Math.N,V:Nn.Math.V,equ:Nn.Math.equ,gte:Nn.Math.gte,lte:Nn.Math.lte,gt:Nn.Math.gt,lt:Nn.Math.lt,inside:Nn.Math.inside,clamp:Nn.Math.clamp,wrap:Nn.Math.wrap,wrapR:Nn.Math.wrapR,add:Nn.Math.add,sub:Nn.Math.sub,mul:Nn.Math.mul,div:Nn.Math.div,mod:Nn.Math.mod,pow:Nn.Math.pow,shl:Nn.Math.shl,shr:Nn.Math.shr,bor:Nn.Math.bor,band:Nn.Math.band,xor:Nn.Math.xor,abs:Nn.Math.abs,min:Nn.Math.min,max:Nn.Math.max,floor:Nn.Math.floor,ceil:Nn.Math.ceil,round:Nn.Math.round,rnd:Nn.Math.rndInt,num:Nn.Math.num,val:Nn.Math.val},Nn.Util={array:l,operate:i,intersection:h,difference:p,union:_,search:A,complementation:a,reflection:s,reversion:c,gray:f,finitedifference:d,partialsum:m,sort:g,shuffle:y,pick:x,pluck:o},Nn.BitArray=Kn({constructor:function dt(n){var t=this;return t instanceof dt?(t.length=n,void(t.bits=new Uint32Array(Un.ceil(n/32)))):new dt(n)},length:0,bits:null,dispose:function(){var n=this;return n.length=null,n.bits=null,n},clone:function(){var n=this,t=new Nn.BitArray(n.length);return t.bits=new Uint32Array(n.bits),t},fromArray:function(n){var t=this;return t.bits=new Uint32Array(n),t},toArray:function(){return jn.call(this.bits)},toString:function(){
var n,t,e=this.toArray();for(n=0,t=e.length;t>n;n++)e[n]=u(e[n]);return e.join("")},reset:function(){var n,t=this,e=t.bits,r=e.length;for(n=0;r>n;n++)e[n]=0;return t},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){var t=this;return t.bits[n>>>5]|=1<<(31&n),t},unset:function(n){var t=this;return t.bits[n>>>5]&=~(1<<(31&n)),t},toggle:function(n){var t=this;return t.bits[n>>>5]^=1<<(31&n),t}}),Ln=Nn.CombinatorialIterator=Kn({constructor:function mt(n,t,e,r){var u=this,i=u[Tn],l=Nn.Arithmetic;u.name=n||"CombinatorialIterator",u.n=t||0,u.$=e=e||{},e.sub=null,e.type=String(e.type||"default").toLowerCase(),e.order=e.order||lt,e.base=e.base||0,e.minbase=null!=e.minbase?e.minbase:e.base,e.maxbase=null!=e.maxbase?e.maxbase:e.base,e.dimension=e.dimension||0,e.mindimension=null!=e.mindimension?e.mindimension:e.dimension,e.maxdimension=null!=e.maxdimension?e.maxdimension:e.dimension,e.rand=e.rand||{},e.count=i.count(u.n,u.$),e.first=l.O,e.last=l.gt(e.count,l.O)?l.sub(e.count,l.I):l.J,e.instance=u,u.order(e.order),r&&r.iter instanceof mt&&u.fuse(r.method,r.iter,r.pos,r.cascade)},__static__:{Iterable:function ht(n,t){var e=this;return e instanceof ht?(t=-1===t?-1:1,void(e.next=function(){return n.hasNext(t)?{value:n.next(t)}:{done:!0}})):new ht(n,t)},C:function(n,t){return a(n,n,t)},P:function(n){return s(n,n)},T:function(n,t){return c(n,t)},DUAL:function(n,t,e){if(null==n)return null;var r=this,u=r.C,i=r.P,l=(r.T,e&&null!=e.base?e.base:t),o=e&&null!=e.order?e.order:lt;return n=st&o?it&o?i(n):n:at&o?it&o?i(n):n:ot&o?it&o?u(n,l,e):i(u(n,l,e)):it&o?i(n):n},count:t,initial:t,succ:function(n,t,e,r,u,i){if(null==e||null==n||null==t)return null;var l=this,o=Nn.Arithmetic;r&&null!=r.order?r.order:lt;return u=-1===u?-1:1,l.unrank(o.add(t,0>u?o.J:o.I),e,r)},rand:function(n,t){var e,r=this,u=Nn.Arithmetic,i=t&&null!=t.last?t.last:u.sub(r.count(n,t),u.I),l=u.O,o=u.rnd(l,i);return e=u.equ(l,o)?r.initial(n,t,1):u.equ(i,o)?r.initial(n,t,-1):r.unrank(o,n,t)},rank:t,unrank:t,cascade:function(n,t,e,r,u,i,o){if(-1===o){var a=e;e=r,r=a}if(null==e||null==r)return"project"!==u?e||r||null:null;if("multiply"===u)return j(!0,e,r);if("add"===u||"connect"===u||"concat"===u){var s=e.length?e[0]+1:0;return l(e.length+r.length,"add"===u?function(n){return n<e.length?e[n]:e.length+r[n-e.length]}:"connect"===u?function(n){return n<e.length?(e[n]+1>s&&(s=e[n]+1),e[n]):s+r[n-e.length]}:function(n){return n<e.length?e[n]:r[n-e.length]})}if("complete"===u||"interleave"===u||"combine"===u){var c=e.length,f=r.length,d=c+f,m=0,h=0,p=0,_=0,b=c>h?e[h]:-1,g=null!=i?h<i.length?i[h]:-1:b,v="complete"===u?G(t,e,!0):null;return l(d,"complete"===u?function(n){var t;return g===n?(t=b,h++,b=c>h?e[h]:-1,g=null!=i?h<i.length?i[h]:-1:b):t=v[r[m++]],t}:"interleave"===u?function(n){var t;return g===n?(t=b,h++,b=c>h?e[h]:-1,g=null!=i?h<i.length?i[h]:-1:b):t=r[m++],t}:function(n){var t;return g===n?(t=b,h++,b=c>h?e[h]:-1,g=null!=i?h<i.length?i[h]:-1:b,p=_,_=t):t=_+r[m++],t})}return l(e.length,function(n){return 0<=e[n]&&e[n]<r.length?r[e[n]]:null})},output:function(n,t,r,u){return null==n?null:u&&e(u.output)?l(n.length,function(t){return 0<=n[t]&&n[t]<u.output.length?u.output[n[t]]:n[t]}):n.slice()}},name:"CombinatorialIterator",n:0,$:null,__index:null,_index:null,__item:null,item__:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var t=this;return!0!==n&&t.$.sub&&(t.$.sub.dispose(),t.$.sub=null),t.name=null,t.n=null,t.$=null,t.__index=null,t._index=null,t.__item=null,t.item__=null,t._item=null,t.__subindex=null,t._subindex=null,t.__subitem=null,t._subitem=null,t._prev=null,t._next=null,t._traversed&&(t._traversed.dispose(),t._traversed=null),t},fuse:function(n,t,e,r){var u=this,i=u.$;return 1===arguments.length&&!1===n?i.sub&&(i.sub=null,i.submethod=null,i.subpos=null,i.subcascade=null,i.subcount=null,i.subdimension=null,i.subposition=null,u.rewind()):t instanceof Ln&&(n=String(n||"project").toLowerCase(),e=e||null,r=-1===r?-1:1,i.sub=t,i.submethod=n,i.subpos=e,i.subcascade=r,i.subcount=Nn.Arithmetic.mul(i.count,i.sub.total()),"multiply"===n?i.subdimension=i.dimension*i.sub.dimension():"add"===n||"connect"===n||"concat"===n||"complete"===n||"interleave"===n||"combine"===n?i.subdimension=i.dimension+i.sub.dimension():i.subdimension=i.dimension,u.rewind()),u},unfuse:function(){return this.fuse(!1)},multiplyWith:function(n,t){return this.fuse("multiply",n,null,t)},addWith:function(n,t){return this.fuse("add",n,null,t)},connectWith:function(n,t){return this.fuse("connect",n,null,t)},concatWith:function(n,t){return this.fuse("concat",n,null,t)},completeWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("complete",n,t||this.position(),e)},interleaveWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("interleave",n,t||this.position(),e)},combineWith:function(n,t,e){return-1!==t&&1!==t||(e=t,t=null),this.fuse("combine",n,t||this.position(),e)},projectOn:function(n,t){return this.fuse("project",n,null,t)},base:function(n){var t=this.$;return t.sub&&!0!==n?t.subbase||t.base||0:t.base||0},dimension:function(n){var t=this.$;return t.sub&&!0!==n?t.subdimension||t.dimension||0:t.dimension||0},position:function(n){var t=this.$;return t.sub&&!0!==n?t.subposition||t.position||null:t.position||null},total:function(n){var t=this.$;return t.sub&&!0!==n?t.subcount||t.count||0:t.count||0},_init:function(n){var t,e,r,u=this,i=u[Tn],l=u.$,o=u.n,a=Nn.Arithmetic,s=a.O,c=(a.I,l.order);return u.__index=u._index=s,u._item=u.__item=u.item__=null,u._prev=!1,u._next=!1,e=l.count,r=l.last,st&c?("gen"===Nn.Options.RANDOM||1===l.rand[l.type]||a.gt(e,Nn.Options.MAXMEM)||a.isDefault()&&0>e?(u.__item=i.rand(o,l),u.__index=s):(u._traversed&&u._traversed.dispose(),u._traversed=new Nn.BitArray(a.val(e)),t=u.random("index"),u._traversed.set(+t),u.__item=i.unrank(t,o,l),null!=u.__item&&(u.__index=t)),u._index=s):(u.__item=i.initial(o,l,n),null!=u.__item&&(u.__index=0>n?r:s,u._update()),u._index=u.__index),u._item=i.output(u.__item,u.__index,o,l),u._prev=st&c||n>0?!1:null!=u.__item,u._next=0>n&&!(st&c)?!1:null!=u.__item,u},_update:function(){return this.item__=null,this},order:function(n,t){if(!arguments.length)return this._order;var e,u,i,l,o,a=this,s=a[Tn],c=Nn.Arithmetic,f=(c.O,c.I,!0===n);return t=-1===t,i=a.n,l=a.$,a._traversed&&(a._traversed.dispose(),a._traversed=null),f?n=l.order:r(n)&&-1<(u=n.indexOf("|"))?(e=n.substr(u+1),n=T(n.substr(0,u))):e=n=T(n),o=t?-1:1,l.order=n,l.sub?(f?l.sub.rewind(o):l.sub.order(e,o),a.__subindex=l.sub.index(),a.__subitem=l.sub.next(o),a._subindex=null,a._subitem=null):(a.__subindex=null,a.__subitem=null,a._subindex=null,a._subitem=null),a._init(o),l.sub&&(a._prev=a._prev&&null!=a.__subitem,a._next=a._next&&null!=a.__subitem,a._subindex=c.add(c.mul(a.__subindex,l.count),a._index),a._subitem=s.cascade(a.dimension(),a.base(),a._item,a.__subitem,l.submethod,l.subpos||null,l.subcascade)),a},index:function(n,t){if(t=!0===t,!arguments.length)return this.$.sub?this._subindex:this._index;var e,r=this,u=r[Tn],i=Nn.Arithmetic,l=i.O,o=(i.I,i.J),a=r.n,s=r.$,c=s.sub&&!t?s.subcount:s.count,f=s.sub&&!t?r._subindex:r._index,d=s.order;return n=i.wrapR(i.N(n),c),!i.equ(n,f)&&i.inside(n,o,c)&&(c=s.count,e=s.last,s.sub&&!t&&(s.sub.index(i.div(n,c)),r.__subindex=s.sub.index(),r.__subitem=s.sub.item(),n=i.mod(n,c)),st&d||(r.__index=n,r._index=n,r.__item=i.equ(l,n)?u.initial(a,s,1):i.equ(e,n)?u.initial(a,s,-1):u.unrank(n,a,s),r._update(),r._item=u.output(r.__item,r.__index,a,s),r._prev=null!=r.__item,r._next=null!=r.__item),s.sub&&(r._prev=r._prev&&null!=r.__subitem,r._next=r._next&&null!=r.__subitem,r._subindex=i.add(i.mul(r.__subindex,c),r._index),r._subitem=u.cascade(r.dimension(),r.base(),r._item,r.__subitem,s.submethod,s.subpos||null,s.subcascade))),r},item:function(n,t){if(!arguments.length)return this.$.sub?this._subitem:this._item;var u,i,l,o,a,s,c=this,f=c[Tn],d=c.n,m=c.$,h=m.sub?m.subcount:m.count,p=m.sub?c._subindex:c._index,_=Nn.Arithmetic,b=_.O,g=(_.I,_.J),v=null;return r(t)?-1<(s=t.indexOf("|"))?(v=t.substr(s+1),t=T(t.substr(0,s))):v=t=T(t):null!=t?v=t=T(t):(t=m.order,v=null),m.sub||(v=null),e(n)?(h=m.count,u=m.last,l=m.order,m.order=t,c.__item=n.slice(),c._update(),c.__index=f.rank(c.__item,d,m),c._item=f.output(c.__item,c.__index,d,m),st&t?c._index=c.__index:c._index=c.__index,c._prev=null!=c.__item,c._next=null!=c.__item,c):(n=_.wrapR(_.N(n),h),t===m.order&&null===v&&_.equ(n,p)?m.sub?c._subitem:c._item:_.inside(n,g,h)?(a=null,h=m.count,u=m.last,m.sub&&(a=m.sub.item(_.div(n,h),v),n=_.mod(n,h)),st&t?(i=null,l=m.order,m.order=t,o=f.output(f.rand(d,m),i,d,m),m.order=l,m.sub&&(o=f.cascade(c.dimension(),c.base(),o,a,m.submethod,m.subpos||null,m.subcascade)),o):(i=n,l=m.order,m.order=t,o=f.output(_.equ(b,n)?f.initial(d,m,1):_.equ(u,n)?f.initial(d,m,-1):f.unrank(i,d,m),i,d,m),m.order=l,m.sub&&(o=f.cascade(c.dimension(),c.base(),o,a,m.submethod,m.subpos||null,m.subcascade)),o)):null)},random:function(n,t,e,r){var u,i=this,l=i[Tn],o=i.$,a=o.order;if(r=!0===r,"index"===n){var s,c,f=Nn.Arithmetic,d=f.N,m=f.O,h=f.I;return t===!!t&&(r=t,t=null,e=null),o.sub&&!r?(s=o.subcount,c=f.sub(s,h)):(s=o.count,c=o.last),null==t&&null==e?(t=m,e=c):null==e?(t=d(t||0),e=c):(t=d(t),e=d(e)),f.rnd(t,e)}return o.order|=st,u=l.rand(i.n,o),o.order=a,u=l.output(u,null,i.n,o),o.sub&&!r?l.cascade(i.dimension(),i.base(),u,o.sub.random(),o.submethod,o.subpos||null,o.subcascade):u},rewind:function(n){var t=this;return t.order(!0,-1===n?-1:1)},hasNext:function(n){var t=this;return-1===n?st&t.$.order?!1:t._prev:t._next},next:function(n){var t,e,r,u,i,l,o=this,a=o[Tn],s=Nn.Arithmetic,c=s.O,f=s.I,d=s.J,m=o.n,h=o.$,p=h.order,_=h.count,b=h.sub?o._subitem:o._item,g=null!=b;if(n=-1===n?-1:1,0>n&&st&p)return null;if(t=0>n?d:f,st&p)if(u=h.last,s.lt(o._index,u))if(e=o._traversed){for(r=o.random("index"),i=Nn.Math.rnd()>.5?d:f;e.isset(+r);)r=s.wrap(s.add(r,i),c,u);e.set(+r),o.__item=a.unrank(r,m,h),null!=o.__item&&(o.__index=r)}else o.__item=a.rand(m,h),o.__index=null;else o._item=o.__item=null,o._traversed&&(o._traversed.dispose(),o._traversed=null);else o.__item=a.succ(o.__item,o.__index,m,h,n,o.item__),null!=o.__item&&(o.__index=s.add(o.__index,t));return l=null!=o.__item,l?(o._index=s.add(o._index,t),null===o.__index&&(o.__index=o._index),0>n?(o._prev=l,o._next=g):(o._prev=g,o._next=l)):h.sub&&h.sub.hasNext(n)?(o.__subindex=h.sub.index(),o.__subitem=h.sub.next(n),o._init(n),l=null!=o.__item):(o.__subindex=null,o.__subitem=null,0>n?(o._prev=l,o._next=g):(o._prev=g,o._next=l)),o._item=a.output(o.__item,o.__index,m,h),h.sub&&(l=l&&null!=o.__subitem,o._subindex=l?s.add(s.mul(o.__subindex,_),o._index):null,o._subitem=l?a.cascade(o.dimension(),o.base(),o._item,o.__subitem,h.submethod,h.subpos||null,h.subcascade):null,0>n?o._prev=l:o._next=l),b},range:function(n,t){var e,r,u,l,o=this,a=Nn.Arithmetic,s=a.N,c=a.O,f=a.I,d=o.$,m=d.sub?d.subcount:d.count,h=d.sub?a.sub(m,f):d.last,p=1,_=arguments.length,b=!(st&d.order);return 1>_?(n=c,t=h):2>_?(n=s(n),t=h):(n=s(n),t=s(t)),n=a.wrapR(n,m),t=a.wrapR(t,m),a.gt(n,t)&&(e=n,n=t,t=e,p=-1),n=a.clamp(n,c,h),b&&(t=a.clamp(t,c,h)),a.lte(n,t)?(l=[o.$.order,o.__index,o._index,o.__item&&o.__item.slice(),o._item,o.__subindex,o._subindex,o.__subitem,o._subitem,o._prev,o._next],b&&o.index(n),u=a.val(a.sub(t,n)),r=i(function(n,t,e){return n[e]=o.next(),n},new Array(u+1),null,0>p?u:0,0>p?0:u,0>p?-1:1),o.$.order=l[0],o.__index=l[1],o._index=l[2],o.__item=l[3],o._item=l[4],o.__subindex=l[5],o._subindex=l[6],o.__subitem=l[7],o._subitem=l[8],o._prev=l[9],o._next=l[10],o._update()):r=[],r},__iter__:function(){return new Ln.Iterable(this)}}),"undefined"!=typeof Symbol&&"undefined"!=typeof Symbol.iterator&&(Ln[Pn][Symbol.iterator]=Ln[Pn].__iter__),En=Nn.Tensor=Kn(Ln,{constructor:function pt(){var n,t=this,u=null,o=jn.call(arguments);if(n=!o.length||o[o.length-1]instanceof Ln||e(o[o.length-1])||o[o.length-1]===+o[o.length-1]?{}:o.pop()||{},o.length&&e(o[0])&&(o=o[0]),o&&o.length||(o=[]),!(t instanceof pt))return new pt(o,n);if(n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||lt,n.rand=n.rand||{},"partial"===n.type){o=e(o)&&o.length?o[0]:o;var a=-1,s=n.data||[],c=n.ordering||null,f=n.position||null;o instanceof Ln?(u=o,o=u.base(),a=o):u=n.sub,o=+(o||0)||0,s.length&&(r(s[0])||s[0].length&&(!0===s[0][0]||!1===s[0][0]))&&(a===o&&(o+=s.length,a=-1),s=pt.generate(o,s,f,c)),a===o&&(o+=(s.length?s[0].length:0)||0,a=-1),n.data=s,n.position=f||l((s.length?s[0].length:0)||0,0,1),n.dimension=n.position.length,n.base=o,n.rand.partial=1,o=n.data.length}else if("tuple"===n.type)o[0]=o[0]||1,o[1]=o[1]||1,o[0]instanceof Ln?(u=o[0],o[0]=u.dimension()):o[1]instanceof Ln?(u=o[1],o[1]=u.base()):u=n.sub,n.base=o[1],n.dimension=o[0];else{var d=i(function(n,t){return t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t),n},[1/0,0],o);n.base=o,n.minbase=d[0],n.maxbase=d[1],n.dimension=o.length}Ln.call(t,"Tensor",o,n,u?{method:"partial"===n.type?n.submethod||"complete":n.submethod,iter:u,pos:"partial"===n.type?n.subpos||n.position:n.subpos,cascade:n.subcascade}:null)},__static__:{C:Ln.C,P:Ln.P,T:Ln.T,DUAL:Ln.DUAL,count:function(n,t){var e=Nn.Arithmetic.O,r=t&&t.type?t.type:"tensor";return"partial"===r?Nn.Arithmetic.N(n):"tuple"===r?!n||0>=n[0]?e:Nn.Math.exp(n[1],n[0]):n&&n.length?Nn.Math.product(n):e},initial:function(n,t,e){var r,u=this,i=t&&t.type?t.type:"tensor",o=t&&t.order?t.order:lt;return e=-1===e?-1:1,(lt&o&&ut&o||ot&o&&!(ut&o))&&(e=-e),"partial"===i?r=t.data&&t.data.length?0>e?t.data[t.data.length-1]:t.data[0]:null:(r="tuple"===i?n[0]?0>e?l(n[0],n[1]-1,0):l(n[0],0,0):[]:n.length?0>e?l(n.length,function(t){return n[t]-1}):l(n.length,0,0):[],r=u.DUAL(r,n,t)),r},succ:function(n,t,e,r,u,i){if(!e||null==n)return null;var l=r&&r.type?r.type:"tensor",o=r&&null!=r.order?r.order:lt;if(u=-1===u?-1:1,"partial"===l){if(!r.data||!r.data.length)return null;ut&o&&(u=-u);var a=null==t?r.data.indexOf(n):Nn.Arithmetic.val(t);return 0>u?a-1>=0?r.data[a-1]:null:a>=0&&a+1<r.data.length?r.data[a+1]:null}return!e[0]||0>=e[0]?null:xn(n,e,u,l,o,i)},rand:function(n,t){var e,r=Nn.Math.rndInt,u=this,i=t&&t.type?t.type:"tensor";return"partial"===i?e=t.data&&t.data.length?t.data[r(0,t.data.length-1)]:null:(e="tuple"===i?n[0]?l(n[0],function(t){return r(0,n[1]-1)}):[]:n.length?l(n.length,function(t){return r(0,n[t]-1)}):[],e=u.DUAL(e,n,t)),e},randu:Ln.rand,rank:function(n,t,e){var r,u,i,l=this,o=Nn.Arithmetic,a=e&&null!=e.order?e.order:lt,s=e&&e.type?e.type:"tensor",c=o.add,f=o.sub,d=o.mul,r=o.O,m=o.J;if("partial"===s)r=o.N(e.data&&e.data.length?e.data.indexOf(n):-1);else if(n=l.DUAL(n,t,e),"tuple"===s){if(u=t[0],!u)return m;for(t=t[1],i=0;u>i;i++)r=c(d(r,t),n[i])}else{if(u=t.length,!u)return m;for(i=0;u>i;i++)r=c(d(r,t[i]),n[i])}return(lt&a&&ut&a||ot&a&&!(ut&a))&&(r=f(e&&null!=e.last?e.last:f(l.count(t,e),o.I),r)),r},unrank:function(n,t,e){var r,u,i,l,o,a,s=this,c=Nn.Arithmetic,f=e&&null!=e.order?e.order:lt,d=e&&e.type?e.type:"tensor",m=c.sub,h=c.mod,p=c.div,_=c.val;if((lt&f&&ut&f||ot&f&&!(ut&f))&&(n=m(e&&null!=e.last?e.last:m(s.count(t,e),c.I),n)),"partial"===d){if(!e.data||!e.data.length)return null;n=_(n),o=n>=0&&n<e.data.length?e.data[n]:null}else{if("tuple"===d){if(a=t[0],!a)return[];for(o=new Array(a),u=t[1],r=n,i=a-1;i>=0;i--)l=h(r,u),r=p(r,u),o[i]=_(l)}else{if(a=t.length,!a)return[];for(o=new Array(a),r=n,i=a-1;i>=0;i--)u=t[i],l=h(r,u),r=p(r,u),o[i]=_(l)}o=s.DUAL(o,t,e)}return o},cascade:Ln.cascade,output:function(n,t,r,u){return null==n?null:u&&"tensor"===u.type&&e(u.output)?l(n.length,function(t){return t<u.output.length&&0<=n[t]&&n[t]<u.output[t].length?u.output[t][n[t]]:n[t]}):Ln.output.call(this,n,t,r,u)},gray:f,product:j,directsum:X,component:function(n,t){var e,r,u,i,l,o,a=[],s=t,c=s.length;for(e=0;c>e;e++)if(u=s[e],l=n[e],i=u[l],i instanceof Array)for(r=0,o=i.length;o>r;r++)a.push(i[r]);else a.push(i);return a},conditional:q,generate:V,parse:J}}),kn=Nn.Permutation=Kn(Ln,{constructor:function _t(n,t){var r=this,u=null;return r instanceof _t?(t=t||{},t.type=String(t.type||"permutation").toLowerCase(),n=n||1,n instanceof Ln?(u=n,n=u.dimension()):u=t.sub,t.base=t.dimension=n,t.rand=t.rand||{},t.rand.derangement=1,t.rand.involution=1,t.rand.connected=1,"multiset"===t.type&&(t.multiplicity=e(t.multiplicity)&&t.multiplicity.length?t.multiplicity.slice():l(n,1,0),t.multiplicity=t.multiplicity.concat(l(n-i(w,0,t.multiplicity),1,0)),t.base=t.multiplicity.length,t.multiset=nn(t.multiplicity,n)),void Ln.call(r,"Permutation",n,t,u?{method:t.submethod,iter:u,pos:t.subpos,cascade:t.subcascade}:null)):new _t(n,t)},__static__:{C:Ln.C,P:Ln.P,T:Ln.T,DUAL:Ln.DUAL,count:function(n,t){var e=Nn.Arithmetic.O,r=Nn.Math.factorial,u=t&&t.type?t.type:"permutation";return 0>=n?e:"cyclic"===u?Nn.Arithmetic.N(n):"multiset"===u?r(n,t.multiplicity):"derangement"===u?2>n?e:r(n,!1):"involution"===u?r(n,!0):r("connected"===u?n-1:n)},initial:function(n,t,e){var r,u=this,i=t&&t.type?t.type:"permutation",o=t&&null!=-t.order?t.order:lt;if(0>=n)return null;if(e=-1===e?-1:1,(lt&o&&ut&o||ot&o&&!(ut&o))&&(e=-e),"cyclic"===i)r=0>e?[n-1].concat(l(n-1,0,1)):l(n,0,1);else if("derangement"===i){if(2>n)return null;if(1&n){var a=Un.floor(n/2);r=0>e?l(n-a-1,n-1,-1).concat([a-1,a]).concat(l(a-1,a-2,-1)):l(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=0>e?l(n,n-1,-1):l(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===i?0>e?t.multiset.slice().reverse():t.multiset.slice():"connected"===i?null:"involution"===i?0>e?l(n,n-1,-1):l(n,0,1):0>e?l(n,n-1,-1):l(n,0,1);return r=u.DUAL(r,n,t)},succ:function(n,t,e,r,u,i){if(!e||0>=e||null==n)return null;var l=r&&r.type?r.type:"permutation";return u=-1===u?-1:1,wn(n,e,u,l,r&&null!=r.order?r.order:lt,r&&null!=r.base?r.base:null,i)},rand:function(n,t){var e,r=Nn.Math.rndInt,u=this,i=t&&t.type?t.type:"permutation";if("cyclic"===i){var o=r(0,n-1);e=o>0?l(n-o,o,1).concat(l(o,0,1)):l(n,0,1)}else if("derangement"===i){e=new Array(n);var a,s,c,f=!1;do{for(a=0;n>a;a++)e[a]=a;for(a=n-1,f=!1;a>=0;){if(c=r(0,a),e[c]===a){f=!0;break}s=e[a],e[a]=e[c],e[c]=s,a--}f=f||0===e[0]}while(f)}else if("involution"===i){e=l(n,0,1);for(var d,m,h,p,s,_,b=Nn.Math.rnd,g=.5,v=1,x=n,A=[1].concat(l(n-1,function(){var n=g;return v+=1,g=1/(1+v*g),n})),w=l(n,0,1);x>=2;)d=x-1,m=w[d],--x,g=A[x],s=b(),s>g&&(h=r(0,x-1),p=w[h],--x,_=w[h],w[h]=w[x],w[x]=_,_=e[p],e[p]=e[m],e[m]=_)}else e="multiset"===i?y(t.multiset.slice()):"connected"===i?y(l(n,0,1),!0):y(l(n,0,1));return e=u.DUAL(e,n,t)},randu:Ln.rand,rank:function(n,e,r){var u,i,l,o,a,s=this,c=Nn.Arithmetic,f=r&&r.type?r.type:"permutation",d=r&&null!=-r.order?r.order:lt,m=c.sub,h=c.add,p=c.mul,_=c.div,b=c.O,g=c.I;if(e=e||n.length,!e)return c.J;if(n=s.DUAL(n,e,r),"cyclic"===f)b=c.NUM(n[0]);else{if("derangement"===f||"involution"===f||"connected"===f)return t();if("multiset"===f)for(a=r.multiplicity.slice(),o=r&&null!=r.count?r.count:Nn.Math.factorial(e,a),l=e-1,u=0;l>u&&c.gt(o,g);u++)i=n[u],b=h(b,_(p(o,M(a,0,i-1,1)),e-u)),o=_(p(o,a[i]),e-u),a[i]--;else for(n=un(null,n),l=e-1,u=0;l>u;u++)b=h(p(b,e-u),n[u])}return(lt&d&&ut&d||ot&d&&!(ut&d))&&(b=m(r&&null!=r.last?r.last:m(s.count(e,r),g),b)),b},unrank:function(n,e,r){var u,i,o,a,s,c,f,d,m=this,h=Nn.Arithmetic,p=r&&r.type?r.type:"permutation",_=r&&null!=-r.order?r.order:lt,b=h.mod,g=h.div,v=h.mul,y=h.sub,x=h.val;if(!e)return[];if((lt&_&&ut&_||ot&_&&!(ut&_))&&(n=y(r&&null!=r.last?r.last:y(m.count(e,r),h.I),n)),"cyclic"===p)n=x(n),u=l(e,function(t){return(n+t)%e});else{if("derangement"===p||"involution"===p||"connected"===p)return t();if("multiset"===p)for(d=r.multiplicity.slice(),u=l(e),f=r&&null!=r.count?r.count:Nn.Math.factorial(e,d),o=0;e>o;o++){for(s=0,a=0,i=x(g(v(n,e-o),f));a<d.length&&s+d[a]<=i;)s+=d[a++];n=y(n,g(v(f,s),e-o)),f=g(v(f,d[a]),e-o),d[a]--,u[o]=a}else{for(u=l(e),u[e-1]=0,i=n,o=e-2;o>=0;o--)s=e-o,c=b(i,s),i=g(i,s),u[o]=x(c);ln(u,u)}}return u=m.DUAL(u,e,r)},cascade:Ln.cascade,output:Ln.output,permute:fn,shuffle:function(n,t){if("cyclic"===t){var e=n.length,r=Nn.Math.rndInt(0,e-1);return r>0&&n.push.apply(n,n.splice(0,r)),n}return"connected"===t?y(n,!0):y(n)},product:function(){return dn(jn.call(arguments))},directsum:function(){return mn(jn.call(arguments))},cycles:function(n,t){return-1===t?cycles2permutation(n):an(n)},swaps:function(n,t){return-1===t?cn(n):sn(n)},inversion:function(n,t){return-1===t?ln(null,n):un(null,n)},inverse:function(n){return rn(null,n)},multiset:function(n,t,e){return n===+n?nn(t,n,-1===e?-1:1):-1===e?tn(n):en(n,t)},matrix:function(n,t,e){return-1===e?Z(null,n,t):Q(null,n,t)},parity:t,is_permutation:hn,is_identity:pn,is_cyclic:vn,is_derangement:gn,is_involution:_n,is_kthroot:bn,is_connected:yn},_update:function(){var n=this;return n.item__=An(n.__item,n.n,n.$.order,n.$.type),n}}),Dn=Nn.Combination=Kn(Ln,{constructor:function bt(n,t,r){var u=this,i=null;if(!(u instanceof bt))return new bt(n,t,r);if(e(n)?(r=t||{},t=n[1]||1,n=n[0]||1):(r=r||{},n=n||1,t=t||1),r.type=String(r.type||"unordered").toLowerCase(),-1<r.type.indexOf("+")){var l=r.type.split("+");l.sort(),r.type=l.join("+")}t instanceof Ln?(i=t,t=i.dimension()):n instanceof Ln?(i=n,n=i.base()):i=r.sub,r.base=n,r.dimension=t,Ln.call(u,"Combination",[n,t],r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:Ln.C,P:Ln.P,T:Ln.T,DUAL:Ln.DUAL,count:function(n,t){var e=Nn.Math.factorial,r=t&&t.type?t.type:"unordered";return"ordered+repeated"===r?Nn.Math.exp(n[0],n[1]):"repeated"===r?e(n[0]+n[1]-1,n[1]):"ordered"===r?e(n[0],-n[1]):e(n[0],n[1])},initial:function(n,t,e){var r,u=this,i=t&&t.type?t.type:"unordered",o=t&&null!=t.order?t.order:lt;return e=-1===e?-1:1,(lt&o&&ut&o||ot&o&&!(ut&o))&&(e=-e),r="ordered+repeated"===i||"repeated"===i?0>e?l(n[1],n[0]-1,0):l(n[1],0,0):"ordered"===i?0>e?l(n[1],n[0]-1,-1):l(n[1],0,1):0>e?l(n[1],n[0]-n[1],1):l(n[1],0,1),r=u.DUAL(r,n,t)},succ:function(n,t,e,r,u,i){return!e||!e[0]||0>=e[0]||null==n?null:(u=-1===u?-1:1,Mn(n,e,u,r&&r.type?r.type:"unordered",r&&null!=r.order?r.order:lt,i))},rand:function(n,t){var e,r,u,i,o=this,a=t&&t.type?t.type:"unordered",s=n[1],c=Nn.Math.rndInt;return n=n[0],r=n-s,u=n-1,"repeated"===a||"ordered+repeated"===a?(e=1===s?[c(0,u)]:l(s,function(){return c(0,u)}),s>1&&"repeated"===a&&g(e,1,!0)):"ordered"===a?(i={},e=1===s?[c(0,u)]:n===s?y(l(s,0,1)):l(s,function(){for(var t=c(0,u);1===i[t];)t=(t+1)%n;return i[t]=1,t})):(i={},e=1===s?[c(0,u)]:n===s?l(s,0,1):s>r?p(null,n,g(l(r,function(){for(var t=c(0,u);1===i[t];)t=(t+1)%n;return i[t]=1,t})),1,!0):g(l(s,function(){for(var t=c(0,u);1===i[t];)t=(t+1)%n;return i[t]=1,t}),1,!0)),e=o.DUAL(e,n,t)},randu:Ln.rand,rank:function(n,t,e){var r,u,i,l,o,a=this,s=Nn.Arithmetic,c=s.add,f=s.sub,d=s.mul,m=s.O,h=s.I,p=m,_=t[1],b=e&&null!=e.order?e.order:lt,g=e&&e.type?e.type:"unordered",v=Nn.Math.factorial;if(n=a.DUAL(n,t,e),"ordered+repeated"===g)for(l=t[0],r=0;_>r;r++)p=c(d(p,l),n[r]);else if("repeated"===g){for(l=t[0]+_-1,o=e&&e.count?e.count:v(l,_),r=1;_>=r;r++)u=l-1-n[r-1]-r+1,i=_+1-r,u>=i&&(p=c(p,v(u,i)));p=f(f(o,h),p)}else if("ordered"===g)for(l=t[0],n=un(null,n,l),r=0;_>r;r++)p=c(d(p,l-r),n[r]);else{for(l=t[0],o=e&&e.count?e.count:v(l,_),r=1;_>=r;r++)u=l-1-n[r-1],i=_+1-r,u>=i&&(p=c(p,v(u,i)));p=f(f(o,h),p)}return(lt&b&&ut&b||ot&b&&!(ut&b))&&(p=f(e&&null!=e.last?e.last:f(a.count(t,e),h),p)),p},unrank:function(n,t,e){var r,u,i,o,a,s,c,f=this,d=Nn.Arithmetic,m=d.O,h=d.I,p=d.sub,_=d.div,b=d.mod,g=d.mul,v=d.lte,y=d.gt,x=d.val,A=t[1],w=e&&e.type?e.type:"unordered",O=e&&null!=e.order?e.order:lt;if(t=t[0],(lt&O&&ut&O||ot&O&&!(ut&O))&&(n=p(e&&null!=e.last?e.last:p(f.count(t,e),d.I),n)),r=l(A),"ordered+repeated"===w)for(o=n,s=A-1;s>=0;s--)a=b(o,t),o=_(o,t),r[s]=x(a);else if("ordered"===w){for(o=n,s=A-1;s>=0;s--)i=t-s,a=b(o,i),o=_(o,i),r[s]=x(a);ln(r,r,i)}else{c="repeated"===w,i=c?t+A-1:t,u=e&&e.count?e.count:Nn.Math.factorial(i,A),n=p(p(u,h),n),u=_(g(u,i-A),i),a=i-A+1,o=A,s=i-1;do v(u,n)?(r[A-o]=c?i-a-A+1:i-a-o+1,y(u,m)&&(n=p(n,u),u=_(g(u,o),s)),o--,s--):(u=_(g(u,s-o),s),a--,s--);while(o>0)}return r=f.DUAL(r,t,e)},cascade:Ln.cascade,output:function(n,t,e,r){return null==n?null:r&&"binary"===r.type?F(n,e[0]):Ln.output.call(this,n,t,e,r)},complement:function(n,t,e){return!0===e?y(G(t,n,!0)):G(t,n)},binary:function(n,t,e){return-1===e?H(n,t):F(n,t)},pick:function(n,t,e){return t>0&&n.length?x(n,t,"ordered+repeated"!==e&&"ordered"!==e,"ordered+repeated"===e||"repeated"===e,new Array(t)):[]},choose:function(n,t){return t&&t.length?l(t.length,function(e){return 0<=t[e]&&t[e]<n.length?n[t[e]]:null}):[]}},_update:function(){var n=this;return n.item__=On(n.__item,n.n[0],n.n[1],n.$.order,n.$.type),n}}),Dn.conjugate=Dn.complement,Dn.project=Dn.choose,Rn=Nn.Powerset=Nn.Subset=Kn(Ln,{constructor:function gt(n,t){var e=this,r=null;return e instanceof gt?(t=t||{},t.type=t.type||"subset",n=n||1,n instanceof Ln?(r=n,n=r.base()):r=t.sub,t.base=n,t.dimension=n,t.mindimension=0,t.maxdimension=n,void Ln.call(e,"Subset",n,t,r?{method:t.submethod,iter:r,pos:t.subpos,cascade:t.subcascade}:null)):new gt(n,t)},__static__:{C:function(n,t){return p(null,t,n)},P:Ln.P,T:Ln.T,DUAL:function(n,t,e){if(null==n)return null;var r=this,u=r.C,i=r.P,l=(r.T,e&&null!=e.order?e.order:lt);return n=st&l?it&l?n:i(n):at&l?it&l?n:i(n):ot&l?it&l?i(u(n,t)):u(n,t):it&l?n:i(n)},count:function(n,t){return Nn.Math.pow2(n)},initial:function(n,t,e){var r,u=this,i=t&&null!=t.order?t.order:lt;return e=-1===e?-1:1,(lt&i&&ut&i||ot&i&&!(ut&i))&&(e=-e),r=0>e?l(n,0,1):[],r=u.DUAL(r,n,t)},succ:Ln.succ,rand:function(n,t){for(var e,r=this,u=Nn.Math.rndInt,i=null,o=n-1;o>=0;o--)u(0,1)&&(i={len:i?i.len+1:1,k:o,next:i});return e=i?l(i.len,function(n){var t=i.k;return i=i.next,t}):[],e=r.DUAL(e,n,t)},randu:Ln.rand,rank:function(n,t,e){var r=this,u=Nn.Arithmetic,i=u.O,l=u.I,o=u.add,a=u.shl,s=u.sub,c=e&&null!=e.order?e.order:lt,f=i,d=0,m=n.length;for(n=r.DUAL(n,t,e);m>d;)f=o(f,a(l,n[d++]));return(lt&c&&ut&c||ot&c&&!(ut&c))&&(f=s(e&&null!=e.last?e.last:s(r.count(t,e),l),f)),f},unrank:function(n,t,e){var r=this,u=Nn.Arithmetic,i=u.O,l=u.J,o=u.band,a=u.shr,s=u.gt,c=u.sub,f=e&&null!=e.order?e.order:lt,d=[],m=0,h=e&&e.count?e.count:r.count(t,e);if(!u.inside(n,l,h))return null;for((lt&f&&ut&f||ot&f&&!(ut&f))&&(n=c(e&&null!=e.last?e.last:c(h,u.I),n));s(n,i);)s(o(n,1),i)&&d.push(m),s(o(n,2),i)&&d.push(m+1),s(o(n,4),i)&&d.push(m+2),s(o(n,8),i)&&d.push(m+3),s(o(n,16),i)&&d.push(m+4),s(o(n,32),i)&&d.push(m+5),s(o(n,64),i)&&d.push(m+6),s(o(n,128),i)&&d.push(m+7),m+=8,n=a(n,8);return d=r.DUAL(d,t,e)},cascade:Ln.cascade,output:function(n,t,e,r){return null==n?null:r&&"binary"===r.type?F(n,e):Ln.output.call(this,n,t,e,r)},binary:function(n,t,e){return-1===e?H(n,t):F(n,t)}}}),$n=Nn.Partition=Kn(Ln,{constructor:function vt(n,t){var e=this,r=null;if(!(e instanceof vt))return new vt(n,t);t=t||{},t.type=t.type||"partition",n=n||1,n instanceof Ln?(r=n,n=r.base()):r=t.sub;var u=t["max="]?0|t["max="]:null,i=t["parts="]?0|t["parts="]:null,l=i?i:u?n-u+1:n,o=i?i:u?Un.ceil(n/u):1;t.base=n,t.dimension=i||n,t.mindimension=Un.min(o,l),t.maxdimension=Un.max(o,l),t.rand=t.rand||{},t.rand.partition=1,t.rand.composition=1,t.rand.packed=1,Ln.call(e,"Partition",n,t,r?{method:t.submethod,iter:r,pos:t.subpos,cascade:t.subcascade}:null)},__static__:{C:function(n,t,e){var r=e&&e.type?e.type:"partition",u=e&&null!=e.order?e.order:lt,i=e&&e["max="]?0|e["max="]:null,l=e&&e["parts="]?0|e["parts="]:null;return"composition"!==r&&ot&u&&s(n,n),l||i?n:Y("composition"===r,n,1)},P:Ln.P,T:Ln.T,DUAL:Ln.DUAL,count:function(n,t){var e=t&&t["max="]?0|t["max="]:null,r=t&&t["parts="]?0|t["parts="]:null,u=t&&t.type?t.type:"partition";return"composition"===u?Nn.Math.compositions(n,r,e):Nn.Math.partitions(n,r,e)},initial:function(n,t,e){var r,u,i,o=this,a=t&&t.type?t.type:"partition",c=t&&t["max="]?0|t["max="]:null,f=t&&t["parts="]?0|t["parts="]:null,d=t&&null!=t.order?t.order:lt,m="composition"===a;return 0>=n||f&&c&&(f+c>n+1||n>f*c)||f&&f>n||c&&c>n?null:(e=-1===e?-1:1,(lt&d&&ut&d||ot&d&&ut&d)&&(e=-e),f&&c?(1===f&&(r=[c]),m?(i=Un.min(c,Un.ceil((n-c)/(f-1))),r=[(n-c)%i||i].concat(l(f-2,i,0)).concat([c]),0>e&&s(r,r)):0>e?(u=Un.min(f,Un.floor(n/c)||1),n-=u*c,f-=u,0===n&&f>0&&(u--,f++,n+=c),r=[c].concat(l(u-1,c,0)).concat(n>0&&f>0?[n-f+1].concat(l(f-1,1,0)):[])):(i=Un.min(c,Un.ceil((n-c)/(f-1))),r=[c].concat(l(f-2,i,0).concat([(n-c)%i||i])))):f?m?(r=l(f-1,1,0).concat([n-f+1]),0>e&&s(r,r)):(i=Un.ceil(n/f),u=n%i||i,r=0>e?[n-f+1].concat(l(f-1,1,0)):l(f-1,i,0).concat([u])):c?(u=Un.floor(n/c),i=n%c,r=m?0>e?l(u,c,0).concat(i?[i]:[]):l(n-c,1,0).concat([c]):0>e?l(u,c,0).concat(i?[i]:[]):[c].concat(l(n-c,1,0))):r=0>e?[n]:l(n,1,0),r=o.DUAL(r,n,t))},succ:function(n,t,e,r,u,i){if(null==e||null==n)return null;var l=r&&r.type?r.type:"partition",o=r&&r["max="]?0|r["max="]:null,a=r&&r["parts="]?0|r["parts="]:null;return 0>=e||a&&o&&(a+o>e+1||e>a*o)||a&&a>e||o&&o>e?null:(u=-1===u?-1:1,"composition"===l?Cn(n,e,u,a,o,r&&null!=r.order?r.order:lt,i):Sn(n,e,u,a,o,r&&null!=r.order?r.order:lt,i))},rand:function(n,t){var e,r,u,i,o,a=this,s=Nn.Math.rndInt,c=t&&t.type?t.type:"partition",f=(t&&null!=t.order?t.order:lt,t&&t["max="]?0|t["max="]:null),d=t&&t["parts="]?0|t["parts="]:null,m=0,h=0,p="composition"===c,_=!1;if(0>=n||d&&f&&(d+f>n+1||n>d*f)||d&&d>n||f&&f>n)return null;if(d&&f)return null;if(f&&!d&&(d=f,_=!0),d)1===d?(r=[n],h=n):n===d?(r=l(d,1,0),h=n):(e={},u=n-2,l(r=g(l(d-1,function(){for(o=s(0,u);1===e[o];)o=(o+1)%(u+1);return e[o]=1,o+1}),1,!0),function(n){return o=r[n],i=o-m,m=o,h+=i,i}));else{for(e=null,o=1;n>o;o++)s(0,1)&&(i=o-m,m=o,h+=i,e={len:e?e.len+1:1,x:i,next:e});r=e?l(e.len,function(){return i=e.x,e=e.next,i}):[]}return n>h&&(r.length?r.splice(s(0,r.length-1),0,n-h):r.push(n-h)),p?_&&(r=y(Y(0,g(r,-1)))):(r=g(r,-1),_&&(r=Y(0,r))),r=a.DUAL(r,n,t)},randu:Ln.rand,rank:t,unrank:t,cascade:Ln.cascade,output:function(n,t,e,r){if(null==n)return null;var u=n,i=r&&r.type?r.type:"partition",l=r&&null!=r.order?r.order:lt,o=it&l?-1:1;r&&r["max="]?0|r["max="]:null,r&&r["parts="]?0|r["parts="]:null;return"composition"===i||"packed"===i&&(n=z(n,o)),u===n?n.slice():n},conjugate:function(n,t){return Y("composition"===t,n)},subset:function(n,t){return-1===t?B(n):W(n)},pack:function(n,t){return-1===t?K(n):z(n)}},_update:function(){var n=this;return n.item__=In(n.__item,n.n,n.$.order,n.$.type,n.$),n}}),$n.transpose=$n.conjugate,Nn});