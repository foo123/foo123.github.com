/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python, Java, C/C++
*   @version: 0.8.7
*   https://github.com/foo123/Abacus
**/
!function(n,e,t){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[e])&&(n[e]=n.$deps[e]=t.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[e]=t.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(e,[],function(r){r(e,t.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["module"],function(e){return t.moduleUri=e.uri,t.call(n)}):e in n||(n[e]=t.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[e]})}(this,"Abacus",function(n){"use strict";function e(){throw new Error("Method not implemented!")}function t(n){return n instanceof Array||"[object Array]"===Fn.call(n)}function r(n){return n instanceof String||"[object String]"===Fn.call(n)}function u(n){var e=n.toString(2),t=32-e.length;return t>0?new Array(t+1).join("0")+e:e}function o(n,e,r,u,i,l,o){var s,a,c,f,d,m,h,p,_=e,g=null,b=r&&t(r);if(b&&(null==u&&(u=0),null==i&&(i=r.length-1)),null==l&&(l=u>i?-1:1),0===l||b&&!r.length||0>=jn.floor((i-u)/l)+1)return _;if(0>l?(p=(u-i)%-l,p&&(g=i),i+=p,m=i,h=u,f=-1,c=-(-l<<4)):(p=(i-u)%l,p&&(g=i),i-=p,m=u,h=i,f=1,c=l<<4),d=u+l*(15&jn.floor((i-u)/l+1)),b){for(m=jn.max(0,m),h=jn.min(r.length-1,h),s=u;s>=m&&h>=s&&f*(d-s)>0;s+=l)_=n(_,r[s],s);for(a=d;a>=m&&h>=a;a+=c)s=a,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s);!0===o&&null!==g&&g>=0&&g<r.length&&(_=n(_,r[g],g))}else{for(s=u;s>=m&&h>=s&&f*(d-s)>0;s+=l)_=n(_,s,s);for(a=d;a>=m&&h>=a;a+=c)s=a,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s);!0===o&&null!==g&&(_=n(_,g,g))}return _}function s(n,e,r){var u=t(n)?n:(n=0|n)>0?new Array(n):[];if(n=u.length,n>0&&null!=e){r=r||0;var i=e;o("function"==typeof e?function(n,t,r){return n[r]=e(r),n}:e===+e?function(n,e,t){return n[t]=i,i+=r,n}:function(n,t,r){return n[r]=e,n},u,u)}return u}function a(n,e,t){return o(function(n,e,r){return n[r]=e[t],n},n,e)}function c(n,e,r,u,i){return null==e?n:o(t(r)?function(n,e,t){return n[t]=r[t]-1-e,n}:function(n,e,t){return n[t]=r-1-e,n},n,e,u,i)}function f(n,e,t,r,u){if(null==e)return n;if(null==r&&(r=0),null==u&&(u=e.length-1),u>=r)for(var i,l=r,o=u;o>=l;l++,o--)i=e[l],n[l]=e[o],n[o]=i;return n}function d(n,e){return null==e&&(e=0),t(n)?s(n,t(e)?function(t){return e[t]-1-n[n.length-1-t]}:function(t){return e-n[t]}):n===+n&&e===+e?e-n:Tn.Arithmetic.sub(Tn.Arithmetic.N(e),n)}function m(n,e,r,u,i){if(null==e)return null;var l=0;return o(t(r)?function(n,e,t){return n[t]=r[t]>0?(e+l)%r[t]:0,l+=r[t]-n[t],n}:function(n,e,t){return n[t]=(e+l)%r,l+=r-n[t],n},n,e,u,i)}function h(n,e,t,r,u){return null==e?n:(null==u&&(u=e.length-1),null==r&&(r=0),o(function(n,e,r){return n[r+t]=e,n},n,e,0>t?r:u,0>t?u:r,0>t?1:-1))}function p(n,e,t,r,u,i,l,s){if(null==e)return null;null==t&&(t=1),null==r&&(r=0),null==u&&(u=0),null==i&&(i=e.length-1),null==l&&(l=u),null==s&&(s=i);var a=0,c=l>s?-1:1,f=l;return o(function(n,e,u){return e=r+t*e,n[f]=e-a,a=e,f+=c,n},n,e,u,i)}function _(n,e,t,r,u,i,l,s){if(null==e)return null;null==t&&(t=1),null==r&&(r=0),null==u&&(u=0),null==i&&(i=e.length-1),null==l&&(l=u),null==s&&(s=i);var a=0,c=l>s?-1:1,f=l;return o(function(n,e,u){return a+=e,n[f]=r+t*a,f+=c,n},n,e,u,i)}function g(n,e,t,r,u,i,l,o){r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=e.length-1),null==l&&(l=0),null==o&&(o=t.length-1);var s=u>i?-1:1,a=l>o?-1:1,c=s*(i-u)+1,f=a*(o-l)+1,d=u,m=l,h=0;if(null==n&&(n=new Array(jn.min(c,f))),0===n.length)return n;for(;s*(i-d)>=0&&a*(o-m)>=0;)1===r&&e[d]<t[m]||-1===r&&e[d]>t[m]?d+=s:1===r&&e[d]>t[m]||-1===r&&e[d]<t[m]?m+=a:(n[h++]=e[d],d+=s,m+=a);return h<n.length&&(n.length=h),n}function b(n,e,t,r,u,i,l,o,a){a=!0===a,r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=e===+e?e-1:e.length-1),null==l&&(l=0),null==o&&(o=t?t.length-1:-1);var c=u>i?-1:1,f=l>o?-1:1,d=c*(i-u)+1,m=u,h=l,p=0;if(!t||!t.length)return e===+e?s(e,u,c):e?e.slice():e;if(null==n&&(n=new Array(a?2*d:d)),e===+e){for(;c*(i-m)>=0&&f*(o-h)>=0;)m===t[h]?(a&&(n[p++]=m),m+=c,h+=f):1===r&&m>t[h]||-1===r&&m<t[h]?h+=f:(n[p++]=m,m+=c);for(;c*(i-m)>=0;)n[p++]=m,m+=c}else{for(;c*(i-m)>=0&&f*(o-h)>=0;)e[m]===t[h]?(a&&(n[p++]=e[m]),m+=c,h+=f):1===r&&e[m]>t[h]||-1===r&&e[m]<t[h]?h+=f:(n[p++]=e[m],m+=c);for(;c*(i-m)>=0;)n[p++]=e[m],m+=c}return p<n.length&&(n.length=p),n}function v(n,e,t,r,u,i,l,o,s,a,c){r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=e.length-1),null==l&&(l=0),null==o&&(o=t.length-1),!0===s?a=!1:(s=!1,a=!1!==a),c=!0===c;var f=u>i?-1:1,d=l>o?-1:1,m=f*(i-u)+1,h=d*(o-l)+1,p=m+h,_=u,g=l,b=0,v=null,y=!a;if(null==n&&(n=new Array(p)),0===n.length)return c?e:n;for(;f*(i-_)>=0&&d*(o-g)>=0;){if(a&&b){if(e[_]===v){_+=f;continue}if(t[g]===v){g+=d;continue}}s?1===r&&e[_][0]<t[g][0]||-1===r&&e[_][0]>t[g][0]?(n[b++]=v=e[_],_+=f):1===r&&e[_][0]>t[g][0]||-1===r&&e[_][0]<t[g][0]?(n[b++]=v=t[g],g+=d):(1===r&&e[_][1]<t[g][1]||-1===r&&e[_][1]>t[g][1]?(n[b++]=v=e[_],y&&(n[b++]=t[g])):(n[b++]=v=t[g],y&&(n[b++]=e[_])),_+=f,g+=d):1===r&&e[_]<t[g]||-1===r&&e[_]>t[g]?(n[b++]=v=e[_],_+=f):1===r&&e[_]>t[g]||-1===r&&e[_]<t[g]?(n[b++]=v=t[g],g+=d):(n[b++]=v=e[_],y&&(n[b++]=t[g]),_+=f,g+=d)}for(;f*(i-_)>=0;)(y||e[_]!==v)&&(n[b++]=v=e[_],_+=f);for(;d*(o-g)>=0;)(y||t[g]!==v)&&(n[b++]=v=t[g],g+=d);if(c){for(_=0>f?i:u,b=0;p>b;b++,_++)e[_]=n[b];return e}return b<n.length&&(n.length=b),n}function y(n,e,t,r,u){var i,l,o,s,a,c,f,d,m;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,r[5]=0,c=0,m=0,s=e,a=-1,i=u?n[s][0]:n[s],o=s+1;t>=o;o++){if(l=u?n[o][0]:n[o],l>i){if(-1===c){a=o-1;break}0===c&&(c=1)}else if(i>l){if(1===c){a=o-1;break}0===c&&(c=-1)}i=l}if(0===c&&(c=1),-1===a)a=t,r[0]=s,r[1]=a,r[2]=c;else{for(f=a+1,d=-1,i=u?n[f][0]:n[f],o=f+1;t>=o;o++){if(l=u?n[o][0]:n[o],l>i){if(-1===m){d=o-1;break}0===m&&(m=1)}else if(i>l){if(1===m){d=o-1;break}0===m&&(m=-1)}i=l}-1===d&&(d=t),0===m&&(m=1),r[0]=s,r[1]=a,r[2]=c,r[3]=f,r[4]=d,r[5]=m}}function x(n,e,t,r,u,i){null==u&&(u=0),null==i&&(i=n.length-1);var l=u>i?-1:1,s=l*(i-u)+1;if(r=!0===r,1>=s)return r?1===s?[u]:[]:n;e=-1===e?-1:1;var c,d,m,h,p,_=s,g=1,b=2,x=jn.min,A=new Array(s);if(r&&(n=o(function(n,e,t){return n[t-u]=[e,t],n},new Array(s),n,u,i,1),u=0,i=s-1),!0===t){h=u,p=-1,c=[-1,-1,0,-1,-1,0];do y(n,u,i,c,r),-1===c[3]?(e!==c[2]&&i>u&&f(n,n,u,i),d=u,m=i):(c[2]=e!==c[2]?1:0,c[5]=e!==c[5]?1:0,v(A,n,n,e,c[2]?c[1]:c[0],c[2]?c[0]:c[1],c[5]?c[4]:c[3],c[5]?c[3]:c[4],r,!1,!0),d=c[0],m=c[4]),-1!==p&&v(A,n,n,e,h,p,d,m,r,!1,!0),p=m,u=m+1;while(i>=u)}else for(;_>0;)o(function(t,i){v(A,n,n,e,u+l*i,u+l*(i+g-1),u+l*(i+g),u+l*x(i+b-1,s-1),r,!1,!0)},null,null,0,s-g-1,b),g<<=1,b<<=1,_>>=1;return r?a(n,n,1):n}function A(n,e,t,r){var u,i,l,o=n.length;if(null==t&&(t=0),null==r&&(r=o-1),null==e||0===e){for(e=0,i=n[t],u=t+1;r>=u;u++){if(l=n[u],l>i){if(-1===e)return 0;0===e&&(e=1)}else if(i>l){if(1===e)return 0;0===e&&(e=-1)}i=l}return 0===e?1:e}if(e=-1===e?-1:1,t>=r)return e;if(-1===e)for(i=n[t],u=t+1;r>=u;u++){if(l=n[u],l>i)return 0;i=l}else for(i=n[t],u=t+1;r>=u;u++){if(l=n[u],i>l)return 0;i=l}return e}function w(n,e,r,u){var i,l=Tn.Math.rndInt,s=!0===e?1:0;return t(r)?1<(i=r.length)&&o(function(n){if(s<i--){var e=l(0,i-s),t=n[r[i]];n[r[i]]=n[r[e]],n[r[e]]=t}return n},n,r,0,i-1):(null==r&&(r=0),null==u&&(u=n.length-1),1<(i=u-r+1)&&o(function(n){if(s<i--){var e=l(0,i-s),t=n[r+i];n[r+i]=n[r+e],n[r+e]=t}return n},n,n,0,i-1)),n}function M(n,e,t,r,u,i,l){null==i&&(i=0),null==l&&(l=n.length-1);var o,s,a,c,f=Tn.Math.rndInt,d=l-i+1;if(e=jn.min(e,d),t=!0===t,o=new Array(e),!0===r){for(d-=1,s=0;e>s;s++)o[s]=n[i+f(0,d)];return t&&x(o),o}for(s=0;e>s;s++)a=f(0,--d),c=n[i+a],n[i+a]=n[i+d],n[i+d]=c,o[s]=c,u&&(u[s]=a);if(u)for(s=e-1;s>=0;s--)a=u[s],c=n[i+d],n[i+d]=n[i+a],n[i+a]=c,d++;return t&&x(o),o}function O(n,e,t,r,u){t=-1===t?-1:1,null==r&&(r=0),null==u&&(u=e.length-1);var i,l,o=r,s=u;if(n===e[o])return o;if(n===e[s])return s;for(;s>o;){if(i=o+(s-o+1>>>1),l=e[i],n===l)return i;1===t&&l>n||-1===t&&n>l?s=i-1:o=i+1}return-1}function q(n,e){return n+e}function I(n,e){return n*e}function S(n,e,t,r){return o(Tn.Arithmetic.add,Tn.Arithmetic.O,n,e,t,r)}function C(n,e,t,r){return o(Tn.Arithmetic.mul,Tn.Arithmetic.I,n,e,t,r)}function L(n){var e=Tn.Arithmetic;return e.shl(e.I,e.N(n))}function E(n,e){var t=Tn.Arithmetic,r=t.N;return t.pow(r(n),r(e))}function $(n,e){var r,u=Tn.Arithmetic,i=u.O,l=u.I,s=u.J,a=u.N,c=u.add,f=(u.sub,u.div),d=u.mul;return null==e?10>=n?0>n?i:0===n?l:a([1,2,6,24,120,720,5040,40320,362880,3628800][n-1]):(r=String(n),null==$.mem1[r]&&($.mem1[r]=d($(n-1),n)),$.mem1[r]):!1===e?10>=n?2>n?i:a([1,2,9,44,265,1854,14833,133496,1334961][n-2]):(r="!"+String(n),null==$.mem2[r]&&($.mem2[r]=c(1&n?s:l,d($(n-1,!1),n))),$.mem2[r]):!0===e?10>=n?0>n?i:0===n?l:a([1,2,4,10,26,76,232,764,2620,9496][n-1]):(r="I"+String(n),null==$.mem2[r]&&($.mem2[r]=c($(n-1,!0),d($(n-2,!0),n-1))),$.mem2[r]):t(e)?e.length?0>n?i:(r=String(n)+"@"+x(e.slice(),1,!0).join(","),null==$.mem3[r]&&($.mem3[r]=f($(n),o(function(n,e){return d(n,$(e))},$(e[e.length-1]),e,e.length-2,0))),$.mem3[r]):0>n?i:$(n):e===+e?0>e?-e>=n?-e===n?$(n):i:(r=String(n)+"@"+String(e),null==$.mem3[r]&&($.mem3[r]=o(d,l,null,n+e+1,n)),$.mem3[r]):0>e||1>n||e>n?i:(e+e>n&&(e=n-e),0===e||1===n?l:1===e?a(n):(r=String(n)+"@"+String(e),null==$.mem3[r]&&($.mem3[r]=u.isDefault()?jn.round(o(function(e,t){return e*(1+n/t)},(n-=e)+1,null,2,e)):c($(n-1,e-1),$(n-1,e))),$.mem3[r])):i}function k(n,e,t){var r,u=Tn.Arithmetic,i=u.O,l=u.I,o=u.V,s=u.add,a=u.mul;return 0>n||0>e?i:2===t?n===e||1===e&&0>n?l:0===n||0===e?i:(r=String(n)+","+String(e),null==k.mem2[r]&&(k.mem2[r]=s(k(n-1,e-1,2),a(k(n-1,e,2),e))),k.mem2[r]):-1===t?e>n||0===e&&0>n?i:n===e?l:(r="-"+String(n)+","+String(e),null==k.mem1[r]&&(k.mem1[r]=s(k(n-1,e-1,-1),a(k(n-1,e,-1),-n+1))),k.mem1[r]):e>n||0===e&&0>n?i:n===e?l:1===e?$(n-1):n-e&1?o(k(n,e,-1)):k(n,e,-1)}function D(n,e,t,r){var u,i,l=Tn.Arithmetic,s=l.add,a=l.I,c=l.O;return 0>n||0>=e||t>r||t+e>n+1||n>e*r?c:r===n&&1===e||e===n&&1===r?a:(u=String(n)+","+String(e)+","+String(t)+","+String(r),null==D.mem[u]&&(n-=e*(t-1),r=r-t+1,i=String(n)+","+String(e)+","+String(t)+","+String(r),null==D.mem[i]&&(D.mem[i]=o(function(t,u){return s(t,D(n-r,e-1,1,u))},c,null,jn.max(1,jn.ceil((n-r)/(e-1))),jn.min(r,n-r-e+2),1)),D.mem[u]=D.mem[i]),D.mem[u])}function R(n,e,t){e=null==e?null:0|e,t=null==t?null:0|t;var r,u=Tn.Arithmetic,i=u.add,l=t?t:0,s=t?t:1,a=e?e:1,c=e?e:n,f=u.O;return 0>n||e&&t&&(e+t>n+1||n>e*t)||t&&t>n||e&&e>n?f:(t&&!e&&(l=0,s=1,a=t,c=t,e=t,t=null),r=String(n)+"|"+String(e)+"|"+String(t),null==R.mem[r]&&(R.mem[r]=o(function(e,t){return o(function(e,r){return i(e,D(n,t,1,r))},e,null,s,l?l:n-t+1,1)},f,null,a,c,1)),R.mem[r])}function N(n,e,t,r){var u,i=Tn.Arithmetic,l=i.add,s=i.O,a=i.I;return 0>n||0>=e||t>r||t*e>n||n>e*r?s:1===e?n>=t&&r>=n?a:s:n===e?1>=t&&r>=1?a:s:t===r?e*t===n?a:s:n===r?$(n-e*t+e-1,e-1):(u=String(n)+","+String(e)+","+String(t)+","+String(r),null==N.mem[u]&&(N.mem[u]=o(function(n,u){return l(n,N(u,e-1,t,r))},s,null,jn.max(n-r,0),n-t,1)),N.mem[u])}function U(n,e,t){e=null==e?null:0|e,t=null==t?null:0|t;var r,u=Tn.Arithmetic,i=u.O,l=u.I,s=u.add,a=(u.mul,u.div,i);return 0>n||e&&t&&(e+t>n+1||n>e*t)||t&&t>n||e&&e>n?a:(r=String(n)+"|"+String(e)+"|"+String(t),null==U.mem[r]&&(e&&t?U.mem[r]=e*t===n?l:N(n,e,1,t):e?U.mem[r]=N(n,e,1,n):t?U.mem[r]=n===t?l:o(function(e,r){return s(e,N(n,r,1,t))},a,null,jn.ceil(n/t),n-t+1,1):U.mem[r]=n>=1?L(n-1):l),U.mem[r])}function P(n){var e,t=Tn.Arithmetic,r=t.O,u=t.N,i=t.div,l=t.mul;return 14>=n?0>n?r:u([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900][n]):(e=String(n),null==P.mem[e]&&(P.mem[e]=i(l(P(n-1),4*n-2),n+1)),P.mem[e])}function T(n){var e,t=Tn.Arithmetic,r=t.O,u=t.N,i=t.add,l=t.mul;return 12>=n?0>n?r:u([1,1,2,5,15,52,203,877,4140,21147,115975,678570][n]):(e=String(n),null==T.mem[e]&&(T.mem[e]=o(function(e,t){return i(e,l($(n-1,t),T(t)))},r,null,0,n-1,1)),T.mem[e])}function j(n){var e,t=Tn.Arithmetic,r=t.O,u=t.N,i=t.add;return 29>=n?0>n?r:u([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811][n]):(e=String(n),null==j.mem[e]&&(j.mem[e]=i(j(n-1),j(n-2))),j.mem[e])}function X(n){if(!arguments.length||null==n)return se;var e=0;if(r(n)){n=n.toUpperCase().split(",");for(var t=0,u=n.length;u>t;t++)e|=Gn.call(X,n[t])?X[n[t]]:0;e>0&&!((de|fe)&e)&&(e|=se),0>=e&&(e=se)}else e=me&n?me&n:se;return fe&e&&de&e&&(e&=~de),ce&e&&(ae|se)&e&&(e&=~(ae|se)),ae&e&&se&e&&(e&=~se),fe&e&&(e&=~le),e}function J(){var n,e,r,u,i,l,o,s,a,c,f,d=arguments.length;if(!d)return[];if(!0===arguments[0]){for(c=arguments[1].length,n=2;d>n;n++)c*=arguments[n].length;for(f=new Array(c),n=0;c>n;n++){for(s=0,l=1,r=n,e=1;d>e;e++)u=arguments[e].length,i=r%u,r=~~(r/u),o=arguments[e][i],s+=l*o,l*=u;f[n]=s}}else{for(c=arguments[0].length,n=1;d>n;n++)c*=arguments[n].length;for(f=new Array(c),n=0;c>n;n++){for(s=new Array(d),a=0,r=n,e=d-1;e>=0;e--)if(u=arguments[e].length,i=r%u,r=~~(r/u),o=arguments[e][i],t(o))for(l=o.length-1;l>=0;l--)s[d-++a]=o[l];else s[d-++a]=o;f[n]=s}}return f}function V(){var n,e,t=arguments,r=t.length,u=0;for(e=0;r>e;e++)u+=t[e].length;return n=0,e=0,s(u,function(r){return r>=n+t[e].length&&(n+=t[e++].length),n+t[e][r-n]})}function G(n,e,t){var r,u,i,l,o,s,a,c,f,d,m,h,p,_,g,b,v,y,x,A,w,M,O,q,I=n.length,S=null,C=null;if(!I)return[];for("function"==typeof t?(C=t,t=!0):t=!1,ne!==e&&ee!==e&&te!==e&&re!==e&&ue!==e&&ie!==e&&(e=!1),v=new Array(I),b=[],u=1,r=0;I>r;r++)if("function"==typeof n[r][0])null==v[n[r][1]]?v[n[r][1]]=[[n[r][0],r]]:v[n[r][1]].push([n[r][0],r]);else if(b.push(r),u*=n[r].length,!u||0>=u)return[];if(!b.length)return[];for(_=new Array(u),p=0,h=I-1,y=b.length-1,A=new Array(I),w=0,r=0;u>r;r++){for(d=new Array(I),x=!1,l=r,i=y;i>=0;i--)if(g=b[i],o=n[g].length,s=l%o,l=~~(l/o),d[g]=n[g][s],null!=v[g]){A[0]=g,w=1;do for(g=A[--w],M=v[g],a=d[g],O=0,q=M.length;q>O;O++)g=M[O][1],d[g]=M[O][0](a),null!=v[g]&&(A[w++]=g);while(w>0)}if(e||t)if(t&&!C(d,h,h))x=!0;else for(f=d[h],ee===e&&(S={},S[f]=1),m=h-1;m>=0;m--){if(c=d[m],ne===e&&f!==c||ee===e&&1===S[c]||te===e&&c>=f||re===e&&f>=c||ue===e&&f>c||ie===e&&c>f||t&&!C(d,m,h)){x=!0;break}ee===e&&(S[c]=1),f=c}x||(_[p++]=d)}return _.length>p&&(_.length=p),_}function F(n,e,u,i,l,o){var a,c,d,m,h,p,_,g,b,v=e,y=v.length,w=!1,M=[],O=[],q={},I=function(e){return e>=0&&n>e};for(e=[],w=!1,h=0,d=0;y>d;d++,h++)if(c=v[d],r(c))if(a=c.match(zn)){if(0<a[1].indexOf("..")?(a=a[1].split("..").map(Number),m=a[0]>a[1]?H(n,s(a[0]-a[1]+1,a[1],1).filter(I)).reverse():H(n,s(a[1]-a[0]+1,a[0],1).filter(I))):m=H(n,a[1].split(",").map(Number).filter(I)),!m.length){w=!0;break}e.push(m)}else if(a=c.match(Yn)){if(0<a[1].indexOf("..")?(a=a[1].split("..").map(Number),m=(a[0]>a[1]?s(a[0]-a[1]+1,a[0],-1):s(a[1]-a[0]+1,a[0],1)).filter(I)):m=a[1].split(",").map(Number).filter(I),!m.length){w=!0;break}e.push(m)}else{if(p=-1,_=null,g=null,c=c.replace(Bn,function(n,e){return null===_&&(p=parseInt(e,10),_="v"+String(p)),_}),!I(p)){u&&u.splice(h--,1);continue}try{g=new Function(_,"return Math.floor("+c+");")}catch(S){g=null}if("function"!=typeof g){u&&u.splice(h--,1);continue}q[p]?q[p].push(g):q[p]=[g],0>u.indexOf(p)&&O.push(p),M.push([g,null,null,p,u[h]]),e.push(M[M.length-1])}else if(t(c)){if(m=!1===c[0]?H(n,c.slice(1).filter(I)):c.slice(1).filter(I),!m.length){w=!0;break}e.push(m)}if(w&&(e=[]),O.length)for(d=0,y=O.length;y>d;d++)u.push(O[d]),w||e.push(s(n,0,1));if(d=A(u),-1===d?(f(u,u),w||f(e,e)):0===d&&(c=x(u,1,!1,!0),mn(u,c),w||mn(e,c)),w)return[];if(M.length)for(d=0,y=M.length;y>d;d++)if(a=M[d],a[1]=u.indexOf(a[3]),a[2]=u.indexOf(a[4]),g=q[a[3]],"function"!=typeof e[a[1]][0]){if(m=e[a[1]].filter(function(e){for(var t,r=0,u=g.length;u>r;r++)if(t=g[r](e),0>t||t>=n)return!1;return!0}),!m.length){w=!0;break}e[a[1]]=m}return w?[]:(i="="===i?ne:"!="===i||"<>"===i?ee:"<"===i?te:"<="===i||"=<"===i?ie:">"===i?re:">="===i||"=>"===i?ue:!1,b="function"==typeof l?function(e,t,r){return 0<=e[t]&&e[t]<n&&l(e,t,r)}:function(e,t,r){return 0<=e[t]&&e[t]<n},!0===o?e:G(e,i,b))}function H(n,e,t){if(null==e||!e.length||1>=e.length)return 1===e.length?s(n-1,function(n){return n<e[0]?n:n+1}):s(n,0,1);if(!0===t){var r=A(e);-1===r?e=f(new Array(e.length),e):0===r&&(e=x(e.slice(),1,!0))}return b(null,n,e)}function W(n,e){if(0>e)return[];var t,r=s(e,0,0),u=n.length;for(e-=1,t=0;u>t;t++)r[e-n[t]]=1;return r}function B(n,e){e=jn.min(e||n.length,n.length);var t,r=[];for(e-=1,t=0;e>=t;t++)0<n[t]&&r.push(e-t);return r}function Y(n,e,t){return null==n?null:(e=e||n.length,_(new Array(e),n,1,-1,-1===t?e-1:0,-1===t?0:e-1,0,e-1))}function z(n,e,t){return null==n?null:(e=e||n.length,p(new Array(e),n,1,1,-1===t?e-1:0,-1===t?0:e-1,0,e-1))}function K(n,e,r){if(null==e)return null;var u,i=null,l=e.length;if(r=-1===r?-1:1,n)u=o(q,0,e),1>=u?i=e.slice():(i=z(H(u-1,Y(e,l-1,r))),0<(u-=o(q,0,i))&&i.push(u),0>r&&f(i,i));else{var a,c,d,m,h,p=1,_=0,g=0,b="push";if(0>r&&(p=-p,_=l-1-_,b="unshift"),t(e[_]))for(h=e[_],i=[[h[1],h[0]]],a=0,d=1,m=p+_;l>d;d++,m+=p)h=e[m],c=0>r?0:a,h[1]===i[c][0]?i[c][1]+=h[0]:(i[b]([h[1],h[0]]),a++);else for(u=e[_],i=s(u,1,0),0>r&&(g=u-1-g),d=1,m=p+_;l>d;d++,m+=p)for(a=0,c=g,h=e[m];u>a&&h>0;)i[c]++,h--,a++,c+=p}return i}function Q(n,e){if(null==n)return null;var t,r,u,i,l=[],o=n.length,s=-1===e,a=1,c=0,f="push";for(s&&(a=-a,c=o-1-c,f="unshift"),u=n[c],i=[u,1],t=1;o>t;t++)r=a*t+c,u===n[r]?i[1]++:(l[f](i),u=n[r],i=[u,1]);return l[f](i),l}function Z(n,e){if(null==n)return null;var t,r,u,i,l,o=[],s=n.length,a=-1===e,c=1,f=0,d="push";for(a&&(c=-c,f=s-1-f,d="unshift"),t=0;s>t;t++)if(l=n[c*t+f],1===l[1])o[d](l[0]);else for(u=l[1],i=l[0],r=0;u>r;r++)o[d](i);return o}function nn(n,e,t){var r,u,i=e.length,l=i*i;for(n=n||new Array(l),r=0,u=0;l>r;)n[r+u]=0,++u>=i&&(u=0,r+=i);if(!0===t)for(r=0;i>r;r++)n[i*e[r]+r]=1;else for(r=0,u=0;i>u;u++,r+=i)n[r+e[r]]=1;return n}function en(n,e,t){var r,u,i=e.length,l=jn.floor(jn.sqrt(i));if(n=n||new Array(l),!0===t)for(r=0,u=0;l>r;)e[l*r+u]&&(n[u]=r),++u>=l&&(u=0,r++);else for(r=0,u=0;l>r;)e[r+u]&&(n[r]=u),++u>=l&&(u=0,r++);return n}function tn(n,e,t){var r=n?n.length:0,u=1,i=0,l=0,s=r>l?n[l]||1:1;return-1===t&&(u=-1,i=(r||e)-1),o(function(e,t){return 0>=s&&(l++,i+=u,s=r>l?n[l]||1:1),s--,e[t]=i,e},new Array(e),null,0,e-1)}function rn(n){return ln(null,x(n,1,!1,!0))}function un(n,e){return e&&e.length?o(function(n,t,r){return n[r]=t<e.length?e[t]:t,n},n,n):n}function ln(n,e){return o(function(n,e,t){return n[e]=t,n},n||new Array(e.length),e)}function on(n,e,t){var r=e.length,u=jn.ceil(Hn(t||r)),i=1<<u,l=(1<<1+u)-1,a=s(l,0,0);return o(function(n,e,t){for(var r=e+i,l=0;u>l;l++)1&r&&(e-=a[r>>>1<<1]),a[r]+=1,r>>>=1;return a[r]+=1,n[t]=e,n},n||new Array(r),e)}function sn(n,e,t){var r,u,i,l=e.length,s=jn.ceil(Hn(t||l)),a=1<<s,c=(1<<1+s)-1,f=new Array(c);for(r=0;s>=r;r++)for(i=1,u=1<<r;u>=i;i++)f[u-1+i]=1<<s-r;return o(function(n,e,t){for(var r=1,u=0;s>u;u++)f[r]-=1,r<<=1,e>=f[r]&&(e-=f[r],r++);return f[r]=0,n[t]=r-a,n},n||new Array(l),e)}function an(n,e,t){var r,u=n.length,i=null==e;if(u>1)for(i&&(e=new Array(u-1),t=0),r=u-1;r>=1;r--)e[t++]=[n[0],n[r]];else i&&(e=[]);return i?e:t}function cn(n,e){var t,r,u,i,l=n.length,o=new Array(l),s=!0===e?1:0,a=new Array(l),c=0,f=0;for(t=0;l>t;t++)a[t]=0;for(u=new Array(l),i=0,r=c++,u[i++]=r,a[r]=1;l>c;){if(r=n[r],a[r])for(i>s&&(u.length=i,o[f++]=u),u=new Array(l),i=0;l>c&&a[r=c];)++c;a[r]||(u[i++]=r,a[r]=1)}return i>s&&(u.length=i,o[f++]=u),f<o.length&&(o.length=f),o}function fn(n){var e,t,r=n.length,u=new Array(r),i=0,l=cn(n,!0);for(e=0,t=l.length;t>e;e++)i=an(l[e],u,i);return i<u.length&&(u.length=i),u}function dn(n,e){var t,r,u,i=n.length,l=new Array(e);for(t=0;e>t;t++)l[t]=t;for(t=0;i>t;t++)swap=r[t],u=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=u;return l}function mn(n,e,t){var r=n.length,u=e.length;if(!0===t)return o(u>r?function(t,u){return t[u]=e[u]<r?n[e[u]]:n[u],t}:r>u?function(t,r){return t[r]=u>r?n[e[r]]:n[r],t}:function(t,r){return t[r]=n[e[r]],t},new Array(r),null,0,r-1,1);for(var i=n.slice(),l=0;r>l;l++)n[l]=i[e[l]];return n}function hn(n){return o(function(n,e){return mn(n,e,!0)},n.length?n[0].slice():[],n,1,n.length-1,1)}function pn(n){var e,t,r,u=n.length,i=0;for(t=0;u>t;t++)i+=n[t].length;return e=0,t=0,r=u?n[t].length:0,s(i,function(u){return u>=e+r&&(e+=r,r=n[++t].length),e+n[t][u-e]})}function _n(n,e){if(e=e||n.length,e!==n.length)return!1;var t,r,u=s(e,0,0);for(t=0;e>t;t++){if(r=n[t],0>r||r>=e||0<u[r])return!1;u[r]++}for(t=0;e>t;t++)if(1!==u[t])return!1;return!0}function gn(n){for(var e=n.length,t=0;e>t;t++)if(n[t]!==t)return!1;return!0}function bn(n){for(var e=n.length,t=0,r=n[t];e>t;t++,r=n[t])if(0>r||r>=e||n[r]!==t)return!1;return!0}function vn(n,e){if(e=e||1,1>e)return!1;var t,r,u,i=n.length;for(t=0;i>t;t++){for(r=n[t],u=1;e>=u&&t!==r;)u++,r=n[r];if(t!==r||u!==e&&(u>=e||e%u>0))return!1}return!0}function yn(n,e,t){e=0|e;for(var r=0,u=n.length,i=0;u>i;i++)if(n[i]===i&&++r>e)return!1;return!0===t?r===e:!0}function xn(n){for(var e=n.length,t=1,r=n[0];e>t;t++)if(n[t]!==(r+t)%e)return!1;return!0}function An(n){for(var e=n.length-1,t=-1,r=0,u=n[r];e>r;r++,u=n[r])if(u>t&&(t=u),r>=t)return!1;return!0}function wn(n,e,t,r){if(!n.length||0>=e)return!1;r=!1!==r;var u,i,l,o,s,a=n.length;for(u=0,l=0,s=0,o=new Array(a);a>s;){if(i=n[u],u===i||1===o[i])for((r||u!==i)&&l++,o[i]=1,u=0;a>u&&1===o[n[u]];)u++;else o[i]=1,u=i;s++}return"<="===t?e>=l:">="===t?l>=e:l===e}function Mn(n,e,t,r,u,i){var l,o,s,a,c,f,d,m,h,p,_=e;if("tuple"===r?(l=_[0],_=_[1]):l=_.length,h=0,p=l-1,f=1,a=p,c=h,d=1,m=0,ae&u&&(f=-f,a=p-a,c=p-c,d=-d,m=p-m),oe&u&&(f=-f,a=p-a,c=p-c,d=-d,m=p-m),le&u&&(t=-t),0>t)if("tuple"===r){for(o=a;o>=h&&p>=o&&0===n[o];)o-=f;if(o>=h&&p>=o)for(_-=1,n[o]=n[o]-1,s=o+f;s>=h&&p>=s;s+=f)n[s]=_;else n=null}else{for(o=a;o>=h&&p>=o&&0===n[o];)o-=f;if(o>=h&&p>=o)for(n[o]=n[o]-1,s=o+f;s>=h&&p>=s;s+=f)n[s]=_[d*s+m]-1;else n=null}else if("tuple"===r){for(o=a;o>=h&&p>=o&&n[o]+1===_;)o-=f;if(o>=h&&p>=o)for(n[o]=n[o]+1,s=o+f;s>=h&&p>=s;s+=f)n[s]=0;else n=null}else{for(o=a;o>=h&&p>=o&&n[o]+1===_[d*o+m];)o-=f;if(o>=h&&p>=o)for(n[o]=n[o]+1,s=o+f;s>=h&&p>=s;s+=f)n[s]=0;else n=null}return n}function On(n,e,t,r){return null}function qn(n,e,t,r,u,i,l){var o,s,a,c,f,d,m,h,p,_,g,b,v,y,x=e,A=null==i?x:i;if(v=0,y=x-1,h=1,m=y,p=1,_=0,g=1,b=0,ae&u&&(h=-h,m=y-m,p=-p,_=A-1-_,t=-t),oe&u&&(h=-h,m=y-m,g=-1,b=A-1),le&u&&(t=-t),0>t)if("cyclic"===r)if(o=y-m,p*n[o]+_>0)for(g=x-1,h=x+h,a=0;x>a;a++)f=(p*n[o]+_+g)%x,n[o]=p*f+_,o=(o+h)%x;else n=null;else if("involution"===r)n=null;else if("connected"===r)n=null;else do{for(d=!1,o=m-h;o>=v&&y>=o&&p*n[o]<=p*n[o+h];)o-=h;if(o>=v&&y>=o){for(s=m;s>=v&&y>=s&&h*(s-o)>0&&p*n[o]<=p*n[s];)s-=h;for(f=n[o],n[o]=n[s],n[s]=f,a=o+h,c=m;a>=v&&y>=a&&c>=v&&y>=c&&h*(c-a)>0;)f=n[a],n[a]=n[c],n[c]=f,d=d||g*a+b===n[a]||g*c+b===n[c],a+=h,c-=h;if("derangement"===r)for(s>=v&&y>=s&&(d=d||g*s+b===n[s]),c>=v&&y>=c&&(d=d||g*c+b===n[c]),d=d||g*o+b===n[o],a=o-h;!d&&a>=v&&y>=a;a-=h)d=g*a+b===n[a];else d=!1}else n=null}while(n&&d);else if("cyclic"===r)if(o=y-m,p*n[o]+_<x-1)for(g=x+1,h=x+h,a=0;x>a;a++)f=(p*n[o]+_+g)%x,n[o]=p*f+_,o=(o+h)%x;else n=null;else if("involution"===r){for(o=x,d=!0;d&&o--;)for(s=n[o],n[o]=o,n[s]=s;s--;)if(n[s]===s){n[o]=s,n[s]=o,d=!1;break}d&&(n=null)}else if("connected"===r)n=null;else do{for(d=!1,o=m-h;o>=v&&y>=o&&p*n[o]>=p*n[o+h];)o-=h;if(o>=v&&y>=o){for(s=m;s>=v&&y>=s&&h*(s-o)>0&&p*n[o]>=p*n[s];)s-=h;for(f=n[o],n[o]=n[s],n[s]=f,a=o+h,c=m;a>=v&&y>=a&&c>=v&&y>=c&&h*(c-a)>0;)f=n[a],n[a]=n[c],n[c]=f,d=d||g*a+b===n[a]||g*c+b===n[c],a+=h,c-=h;if("derangement"===r)for(s>=v&&y>=s&&(d=d||g*s+b===n[s]),c>=v&&y>=c&&(d=d||g*c+b===n[c]),d=d||g*o+b===n[o],a=o-h;!d&&a>=v&&y>=a;a-=h)d=g*a+b===n[a];else d=!1}else n=null}while(n&&d);return n}function In(n,e,t,r,u){if(null==n)return null;var i,l=null;if("ordered"===u)for(l={},i=0;t>i;i++)l[n[i]]=1;return l}function Sn(n,e,t,r,u,i){var l,o,s,a,c,f,d,m,h,p,_,g,b,v,y=e[1],x=e[0];if(d=0,m=y-1,f=1,c=m,h=1,p=0,_=1,g=0,ae&u&&(h=-h,p=x-1-p,f=-f,c=m-c,_=-_,g=m-g),oe&u&&(f=-f,c=m-c,_=-_,g=m-g),le&u&&(t=-t),0>t)if("ordered+repeated"===r){for(l=c;l>=d&&m>=l&&0===n[l];)l-=f;if(l>=d&&m>=l)for(x-=1,n[l]=n[l]-1,o=l+f;o>=d&&m>=o;o+=f)n[o]=x;else n=null}else if("ordered"===r){for(null==i&&(i=In(n,x,y,u,r)),l=c,s=-1;-1===s&&l>=d&&m>=l;){if(h*n[l]+p-h>=0)for(o=h*n[l]+p-h;o>=0&&x>o;o-=h)if(a=h*o+p,null==i[a]){s=l,i[a]=1;break}i[n[l]]=null,l-=f}if(s>-1)for(n[s]=a,o=x-1-p,a=h*o+p,l=s+f;l>=d&&m>=l;l+=f){for(;o>=0&&x>o&&null!=i[a];)o-=h,a=h*o+p;n[l]=a,i[a]=1}else n=null}else if(v="repeated"===r,b=v?0:1,ae&u)if(f=-f,c=m-c,_=-_,g=m-g,l=m-c,o=0>f?d:m,!v&&n[o]+1>y||v&&n[o]>0){if(v)for(;l>=d&&m>=l&&0===n[l];)l+=f;else for(;l>=d&&m>=l&&_*l+g===n[l];)l+=f;for(n[l]-=1,l-=f;l>=d&&m>=l;)n[l]=n[l+f]-b,l-=f}else n=null;else{for(s=-1,l=c;l-f>=d&&m>=l-f;l-=f)if(n[l]>n[l-f]+b){s=l;break}if(!(s>=d&&m>=s)&&0<n[0>f?m:d]&&(s=0>f?m:d),s>=d&&m>=s){for(a=x-1+b,l=c;l>=d&&m>=l&&f*(l-s)>0;l-=f)a-=b,n[l]=a;n[s]--}else n=null}else if("ordered+repeated"===r){for(l=c;l>=d&&m>=l&&n[l]+1===x;)l-=f;if(l>=d&&m>=l)for(n[l]=n[l]+1,o=l+f;o>=d&&m>=o;o+=f)n[o]=0;else n=null}else if("ordered"===r){for(null==i&&(i=In(n,x,y,u,r)),l=c,s=-1;-1===s&&l>=d&&m>=l;){if(h*n[l]+p+h<x)for(o=h*n[l]+p+h;o>=0&&x>o;o+=h)if(a=h*o+p,null==i[a]){s=l,i[a]=1;break}i[n[l]]=null,l-=f}if(s>-1)for(n[s]=a,o=p,a=h*o+p,l=s+f;l>=d&&m>=l;l+=f){for(;o>=0&&x>o&&null!=i[a];)o+=h,a=h*o+p;n[l]=a,i[a]=1}else n=null}else if(v="repeated"===r,b=v?0:1,ae&u)if(f=-f,c=m-c,_=-_,g=m-g,l=m-c,!v&&n[l]+y<x||v&&n[l]+1<x){for(a=_*l+g;l+f>=d&&m>=l+f&&n[l]+b===n[l+f];)n[l]=a,l+=f,a+=b;n[l]+=1}else n=null;else{if(v){for(s=-1,o=x-1,l=c;l>=d&&m>=l;l-=f)if(n[l]<o){s=l;break}}else for(s=-1,o=x-y,l=c;l>=d&&m>=l;l-=f)if(n[l]<o+_*l+g){s=l;break}if(s>=d&&m>=s){if(a=n[s]+1,o=v?x-1:x-y+_*s+g,a===o)n[s]=a;else if(o>a)for(l=s;l>=d&&m>=l;l+=f)n[l]=a,a+=b}else n=null}return n}function Cn(n,e,t,r){var u,i,l,o,s,a,c,f,d=e,m=0,h=e-1;return o=1,c=1,f=0,ae&r?null:(oe&r&&(o=-o),le&r&&(t=-t),0>o?(u=e-(n[d]||1),i=e-1,s=i,a=u):(u=0,i=n[d]-1,s=u,a=i),0>t?0<n[d]?(l=n[a],l>m?1===n[d]||l>n[a-o]+1?(n[a]-=1,n[a+o]=h,n[d]++):n[d]--:n[d]=0):n=null:0===n[d]?(n[u]=c*m+f,n[d]=1):c*n[s]+f<h?c*n[a]+f<h?(n[a+o]=n[a]+c,n[d]++):(n[a-o]+=c,n[d]--):n=null,n)}function Ln(n,e,t,r,u){return null}function En(n,e,t,r,u,i,l){var o,a,c,f,d,m,h,p,_,g,b=e;if(_=0,g=n.length-1,p=1,c=_,f=g,oe&i&&(p=-p,c=g-c,f=g-f),le&i&&(t=-t),0>t)if(r)n=null;else if(ae&i)n=null;else if(a=u?c+p:c,a>=_&&g>=a&&n[a]>1){for(o=f,h=0;o>=_&&g>=o&&p*(o-a)>=0&&1===n[o];)h+=n[o],o-=p;m=n[o]-1,h++,n[o]=m,n=0>p?n.slice(o):n.slice(0,o+1),h>m?(a=h%m,n=0>p?(a?[a]:[]).concat(s(jn.floor(h/m),m)).concat(n):n.concat(s(jn.floor(h/m),m)).concat(a?[a]:[])):h>0&&(n=0>p?[h].concat(n):n.concat([h]))}else n=null;else if(r)n=null;else if(ae&i)n=null;else if(u?(m=jn.min(u,b-u),d=jn.floor(b/u)+(b%u?1:0)-1,m=g>d||n[c+(d-1)*p]<m,a=c+p):(m=n[c]<b,a=c),a>=_&&g>=a&&m){for(g>0?(o=f-p,h=n[f]):(o=f,h=0);o>=_&&g>=o&&o-p>=_&&g>=o-p&&p*(o-a)>0&&n[o]===n[o-p];)h+=n[o],o-=p;n[o]++,h--,n=h>0?0>p?s(h,1).concat(n.slice(o)):n.slice(0,o+1).concat(s(h,1)):0>p?n.slice(o):n.slice(0,o+1)}else n=null;return n}function $n(n,e,t,r,u,i,l){var o,a,c,f,d,m,h,p,_=e;if(h=0,p=n.length-1,m=1,a=h,c=p,oe&i&&(m=-m,a=p-a,c=p-c),le&i&&(t=-t),0>t)if(r)if(u)n=null;else if(ae&i)if(f=n[a],_-r+1>f){for(n[a]=1,o=a+m;o>=h&&p>=o&&1===n[o];)o+=m;n[o]--,o-m>=h&&p>=o-m&&(n[o-m]=1+f)}else n=null;else if(f=n[c],_-r+1>f){for(n[c]=1,o=c;o>=h&&p>=o&&1===n[o];)o-=m;n[o]--,o+m>=h&&p>=o+m&&(n[o+m]=1+f)}else n=null;else if(u)n=null;else if(ae&i)n=null;else if(_>n.length){for(o=c,d=0;o>=h&&p>=o&&1===n[o];)o-=m,d++;f=n[o]-1,n[o]=f,d++,d>0&&(o+m>=h&&p>=o+m?(o+=m,n[o]=d,d=0,n=0>m?n.slice(o):n.slice(0,o+1)):n=0>m?s(d,1,0).concat(n):n.concat(s(d,1,0)))}else n=null;else if(r)if(u)n=null;else if(ae&i)if(_-r+1>n[c]){for(o=a;o>=h&&p>=o&&1===n[o];)o+=m;f=n[o],n[o]=1,n[a]=f-1,o+m>=h&&p>=o+m&&n[o+m]++}else n=null;else if(_-r+1>n[a]){for(o=c;o>=h&&p>=o&&1===n[o];)o-=m;f=n[o],n[o]=1,n[c]=f-1,o-m>=h&&p>=o-m&&n[o-m]++}else n=null;else u?n=null:ae&i?n=null:_>n[a]?(d=n[c],n[c-m]++,0>m?(n.shift(),n.unshift.apply(n,s(d-1,1,0))):(n.pop(),n.push.apply(n,s(d-1,1,0)))):n=null;return n}var kn,Dn,Rn,Nn,Un,Pn,Tn={VERSION:"0.8.7"},jn=Math,Xn="prototype",Jn="constructor",Vn=Array.prototype.slice,Gn=Object[Xn].hasOwnProperty,Fn=Object[Xn].toString,Hn=jn.log2||function(n){return jn.log(n)/jn.LN2},Wn=/^\s+|\s+$/g,Bn=(String.prototype.trim?function(n){return n.trim()}:function(n){return n.replace(Wn,"")},/\[(\d+)\]/g),Yn=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,zn=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,Kn=Object.create,Qn=function(n,e){for(var t in e)Gn.call(e,t)&&(n[t]=e[t]);return n},Zn=function(n,e){1===arguments.length&&(e=n,n=Object);var t=e[Jn];return Gn.call(e,"__static__")&&(t=Qn(t,e.__static__),delete e.__static__),t[Xn]=Qn(Kn(n[Xn]),e),t},ne=1,ee=-1,te=3,re=-3,ue=-2,ie=2,le=1,oe=2,se=4,ae=8,ce=16,fe=32,de=se|ae|ce,me=de|fe|le|oe;return $.mem1={},$.mem2={},$.mem3={},k.mem1={},k.mem2={},D.mem={},R.mem={},N.mem={},U.mem={},P.mem={},T.mem={},j.mem={},Tn.Class=Zn,Tn.Options={MAXMEM:1e6,RANDOM:"index"},X.LEX=X.LEXICOGRAPHIC=se,X.COLEX=X.COLEXICOGRAPHIC=ae,X.MINIMAL=X.GRAY=ce,X.RANDOM=fe,X.REV=X.ANTI=X.REVERSE=X.REVERSED=le,X.REF=X.REFLECT=X.REFLECTED=oe,X.REVLEX=X.ANTILEX=X.REVERSELEXICOGRAPHIC=X.ANTILEXICOGRAPHIC=se|le,X.REFLEX=X.REFLECTEDLEXICOGRAPHIC=se|oe,X.REVCOLEX=X.ANTICOLEX=X.REVERSECOLEXICOGRAPHIC=X.ANTICOLEXICOGRAPHIC=ae|le,X.REFCOLEX=X.REFLECTEDCOLEXICOGRAPHIC=ae|oe,Tn.ORDER=X,Tn.Math={O:0,I:1,J:-1,N:function(n){return Tn.Arithmetic.add(Tn.Arithmetic.O,n)},V:function(n){return Tn.Arithmetic.sub(Tn.Arithmetic.O,n)},rnd:jn.random,rndInt:function(n,e){return Tn.Math.round((e-n)*Tn.Math.rnd()+n)},equ:function(n,e){return n===e},gte:function(n,e){return n>=e},lte:function(n,e){return e>=n},gt:function(n,e){return n>e},lt:function(n,e){return e>n},inside:function(n,e,t,r){return r?n>=e&&t>=n:n>e&&t>n},clamp:function(n,e,t){return e>n?e:n>t?t:n},wrap:function(n,e,t){return e>n?t:n>t?e:n},wrapR:function(n,e){return 0>n?n+e:n},add:q,sub:function(n,e){return n-e},mul:I,div:function(n,e){return Tn.Math.floor(n/e)},mod:function(n,e){return n%e},pow:jn.pow,shl:function(n,e){return n<<e},shr:function(n,e){return n>>e},bor:function(n,e){return n|e},band:function(n,e){return n&e},xor:function(n,e){return n^e},abs:jn.abs,min:jn.min,max:jn.max,floor:jn.floor,ceil:jn.ceil,round:jn.round,num:function(n){return"number"==typeof n?Tn.Math.floor(n):parseInt(n,10)},val:function(n){return Tn.Math.floor(n.valueOf())},sum:S,product:C,pow2:L,exp:E,factorial:$,stirling:k,partitions:R,compositions:U,bell:T,catalan:P,fibonacci:j},Tn.Arithmetic={isDefault:function(){return 0===Tn.Arithmetic.O&&Tn.Arithmetic.add===q},O:0,I:1,J:-1,N:Tn.Math.N,V:Tn.Math.V,equ:Tn.Math.equ,gte:Tn.Math.gte,lte:Tn.Math.lte,gt:Tn.Math.gt,lt:Tn.Math.lt,inside:Tn.Math.inside,clamp:Tn.Math.clamp,wrap:Tn.Math.wrap,wrapR:Tn.Math.wrapR,add:Tn.Math.add,sub:Tn.Math.sub,mul:Tn.Math.mul,div:Tn.Math.div,mod:Tn.Math.mod,pow:Tn.Math.pow,shl:Tn.Math.shl,shr:Tn.Math.shr,bor:Tn.Math.bor,band:Tn.Math.band,xor:Tn.Math.xor,abs:Tn.Math.abs,min:Tn.Math.min,max:Tn.Math.max,floor:Tn.Math.floor,ceil:Tn.Math.ceil,round:Tn.Math.round,rnd:Tn.Math.rndInt,num:Tn.Math.num,val:Tn.Math.val},Tn.Util={array:s,operate:o,intersection:g,difference:b,union:v,search:O,complementation:c,reflection:f,reversion:d,gray:m,finitedifference:p,partialsum:_,sort:x,shuffle:w,pick:M,pluck:a},Tn.BitArray=Zn({constructor:function he(n){var e=this;return e instanceof he?(e.length=n,
void(e.bits=new Uint32Array(jn.ceil(n/32)))):new he(n)},length:0,bits:null,dispose:function(){var n=this;return n.length=null,n.bits=null,n},clone:function(){var n=this,e=new Tn.BitArray(n.length);return e.bits=new Uint32Array(n.bits),e},fromArray:function(n){var e=this;return e.bits=new Uint32Array(n),e},toArray:function(){return Vn.call(this.bits)},toString:function(){var n,e,t=this.toArray();for(n=0,e=t.length;e>n;n++)t[n]=u(t[n]);return t.join("")},reset:function(){var n,e=this,t=e.bits,r=t.length;for(n=0;r>n;n++)t[n]=0;return e},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){var e=this;return e.bits[n>>>5]|=1<<(31&n),e},unset:function(n){var e=this;return e.bits[n>>>5]&=~(1<<(31&n)),e},toggle:function(n){var e=this;return e.bits[n>>>5]^=1<<(31&n),e}}),kn=Tn.CombinatorialIterator=Zn({constructor:function pe(n,e,r,u){var i,l=this,o=Tn.Arithmetic;if(!(l instanceof pe))return new pe(n,e,r,u);if(i=l[Jn],t(n)&&(n[0]instanceof pe||n[n.length-1]instanceof pe)){l.$=r=e||{},r.rand=r.rand||{},r.seq=n,n=null,l.name="CombinatorialIterator",r.type="sequence",r.rand.sequence=1;var a=1/0,c=-(1/0),f=1/0,d=-(1/0);l.n=e=s(r.seq.length,function(n){return r.seq[n].n}),r.base_=s(r.seq.length,function(n){var e=r.seq[n].base();return e>c&&(c=e),a>e&&(a=e),e}),r.dimension_=s(r.seq.length,function(n){var e=r.seq[n].dimension();return e>d&&(d=e),f>e&&(f=e),e}),r.minbase=a,r.base=r.maxbase=c,r.mindimension=f,r.dimension=r.maxdimension=d}else l.name=n||"CombinatorialIterator",l.n=e||0,l.$=r=r||{};r.sub=null,r.type=String(r.type||"default").toLowerCase(),r.order=r.order||se,r.rand=r.rand||{},r.count=i.count(l.n,l.$),r.base=r.base||0,r.minbase=null!=r.minbase?r.minbase:r.base,r.maxbase=null!=r.maxbase?r.maxbase:r.base,r.dimension=r.dimension||0,r.mindimension=null!=r.mindimension?r.mindimension:r.dimension,r.maxdimension=null!=r.maxdimension?r.maxdimension:r.dimension,r.first=o.O,r.last=o.gt(r.count,o.O)?o.sub(r.count,o.I):o.J,r.instance=l,l.order(r.order),u&&u.iter instanceof pe&&l.fuse(u.method,u.iter,u.pos,u.cascade)},__static__:{Iterable:function _e(n,e){var t=this;return t instanceof _e?(e=-1===e?-1:1,void(t.next=function(){return n.hasNext(e)?{value:n.next(e)}:{done:!0}})):new _e(n,e)},C:function(n,e){return c(n,n,e)},P:function(n){return f(n,n)},T:function(n,e){return d(n,e)},DUAL:function(n,e,t){if(null==n)return null;if(t&&"sequence"===t.type)return n;var r=this,u=r.C,i=r.P,l=(r.T,t&&null!=t.base?t.base:e),o=t&&null!=t.order?t.order:se;return n=fe&o?oe&o?i(n):n:ce&o?oe&o?i(n):n:ae&o?oe&o?u(n,l,t):i(u(n,l,t)):oe&o?i(n):n},count:function(n,e){var t=Tn.Arithmetic,r=t.O;return e&&"sequence"===e.type&&e.seq&&e.seq.length?o(function(n,e){return t.add(n,e.total())},r,e.seq):r},initial:function(n,e,t,r){return e&&"sequence"===e.type&&e.seq&&e.seq.length?!0===r?this.succ(0,0,n,e,t):(t=-1===t?-1:1,0>t?e.seq[e.seq.length-1].item0(-1):e.seq[0].item0(1)):null},succ:function(n,e,t,r,u,i){if(null==t||null==n)return null;var l=this,o=Tn.Arithmetic;if(u=-1===u?-1:1,r&&"sequence"===r.type){if(!r.seq||!r.seq.length)return null;for(;0<=r.seq_curr&&r.seq_curr<r.seq.length&&!r.seq[r.seq_curr].hasNext(u);)r.seq_curr+=u;return 0<=r.seq_curr&&r.seq_curr<r.seq.length?r.seq[r.seq_curr].next(u):null}return null==e?null:l.unrank(o.add(e,0>u?o.J:o.I),t,r)},rand:function(n,e){var t,r=this,u=Tn.Arithmetic,i=e&&null!=e.last?e.last:u.sub(r.count(n,e),u.I),l=u.O,o=u.rnd(l,i);return e&&"sequence"===e.type?e.seq&&e.seq.length?e.seq[Tn.Math.rndInt(0,e.seq.length-1)].random():null:t=u.equ(l,o)?r.initial(n,e,1):u.equ(i,o)?r.initial(n,e,-1):r.unrank(o,n,e)},rank:e,unrank:e,fusion:function(n,e,t,r,u,i,l){if(-1===l){var o=e;e=t,t=o}if(null==e||null==t)return e||t||null;if("multiply"===n)return J(!0,e,t);if("add"===n||"connect"===n||"concat"===n){var a=e.length?e[0]+1:0;return s(e.length+t.length,"add"===n?function(n){return n<e.length?e[n]:e.length+t[n-e.length]}:"connect"===n?function(n){return n<e.length?(e[n]+1>a&&(a=e[n]+1),e[n]):a+t[n-e.length]}:function(n){return n<e.length?e[n]:t[n-e.length]})}if("complete"===n||"interleave"===n||"combine"===n){var c=e.length,f=t.length,d=c+f,m=0,h=0,p=0,_=0,g=c>h?e[h]:-1,b=null!=i?h<i.length?i[h]:-1:g,v="complete"===n?H(u,e,!0):null;return s(d,"complete"===n?function(n){var r;return b===n?(r=g,h++,g=c>h?e[h]:-1,b=null!=i?h<i.length?i[h]:-1:g):r=v[t[m++]],r}:"interleave"===n?function(n){var r;return b===n?(r=g,h++,g=c>h?e[h]:-1,b=null!=i?h<i.length?i[h]:-1:g):r=t[m++],r}:function(n){var r;return g===n?(r=g,h++,g=c>h?e[h]:-1,p=_,_=r):r=_+t[m++],r})}return s(e.length,function(n){return 0<=e[n]&&e[n]<t.length?t[e[n]]:e[n]})},output:function(n,e,r,u){return null==n?null:u&&t(u.output)?s(n.length,function(e){return 0<=n[e]&&n[e]<u.output.length?u.output[n[e]]:n[e]}):u&&"sequence"===u.type?n:n.slice()}},name:"CombinatorialIterator",n:0,$:null,__index:null,_index:null,__item:null,item__:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var e=this;return!0!==n&&e.$.sub&&(e.$.sub.dispose(),e.$.sub=null),"sequence"===e.$.type&&e.$.seq&&e.$.seq.length&&o(function(n,e){e.dispose()},null,e.$.seq),e.name=null,e.n=null,e.$=null,e.__index=null,e._index=null,e.__item=null,e.item__=null,e._item=null,e.__subindex=null,e._subindex=null,e.__subitem=null,e._subitem=null,e._prev=null,e._next=null,e._traversed&&(e._traversed.dispose(),e._traversed=null),e},fuse:function(n,e,t,r){var u=this,i=u.$;return 1===arguments.length&&!1===n?i.sub&&(i.sub=null,i.submethod=null,i.subpos=null,i.subcascade=null,i.subcount=null,i.subdimension=null,i.subposition=null,u.rewind()):e instanceof kn&&(n=String(n||"project").toLowerCase(),t=t||null,r=-1===r?-1:1,i.sub=e,i.submethod=n,i.subpos=t,i.subcascade=r,i.subcount=Tn.Arithmetic.mul(i.count,i.sub.total()),"multiply"===n?i.subdimension=i.dimension*i.sub.dimension():"add"===n||"connect"===n||"concat"===n||"complete"===n||"interleave"===n||"combine"===n?i.subdimension=i.dimension+i.sub.dimension():i.subdimension=i.dimension,u.rewind()),u},unfuse:function(){return this.fuse(!1)},multiplyWith:function(n,e){return this.fuse("multiply",n,null,e)},addWith:function(n,e){return this.fuse("add",n,null,e)},connectWith:function(n,e){return this.fuse("connect",n,null,e)},concatWith:function(n,e){return this.fuse("concat",n,null,e)},completeWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("complete",n,e||this.position(),t)},interleaveWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("interleave",n,e||this.position(),t)},combineWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("combine",n,e||this.position(),t)},projectOn:function(n,e){return this.fuse("project",n,null,e)},base:function(n){var e=this.$;return e.sub&&!0!==n?e.subbase||e.base||0:e.base||0},dimension:function(n){var e=this.$;return e.sub&&!0!==n?e.subdimension||e.dimension||0:e.dimension||0},position:function(n){var e=this.$;return e.sub&&!0!==n?e.subposition||e.position||null:e.position||null},total:function(n){var e=this.$;return e.sub&&!0!==n?e.subcount||e.count||0:e.count||0},_init:function(n){var e,t,r,u=this,i=u[Jn],l=u.$,o=u.n,s=Tn.Arithmetic,a=s.O,c=(s.I,l.order);return u.__index=u._index=a,u._item=u.__item=u.item__=null,u._prev=!1,u._next=!1,t=l.count,r=l.last,"sequence"===l.type&&(l.seq_curr=l.seq&&l.seq.length?0>n?l.seq.length-1:0:-1),fe&c?("gen"===Tn.Options.RANDOM||1===l.rand[l.type]||s.gt(t,Tn.Options.MAXMEM)||s.isDefault()&&0>t?(u.__item=i.rand(o,l),u.__index=a):(u._traversed&&u._traversed.dispose(),u._traversed=new Tn.BitArray(s.val(t)),e=u.random("index"),u._traversed.set(+e),u.__item=i.unrank(e,o,l),null!=u.__item&&(u.__index=e)),u._index=a):(u.__item=i.initial(o,l,n,!0),null!=u.__item&&(u.__index=0>n?r:a,u._update()),u._index=u.__index),u._item=i.output(u.__item,u.__index,o,l),u._prev=fe&c||n>0?!1:null!=u.__item,u._next=0>n&&!(fe&c)?!1:null!=u.__item,u},_update:function(){return this.item__=null,this},order:function(n,e){if(!arguments.length)return this._order;var t,u,i,l,o,s,a,c=this,f=c[Jn],d=Tn.Arithmetic,m=(d.O,d.I,!0===n);if(e=-1===e,i=c.n,l=c.$,c._traversed&&(c._traversed.dispose(),c._traversed=null),m?n=l.order:r(n)&&-1<(u=n.indexOf("|"))?(t=n.substr(u+1),n=X(n.substr(0,u))):t=n=X(n),o=e?-1:1,l.order=n,l.sub?(m?l.sub.rewind(o):l.sub.order(t,o),c.__subindex=l.sub.index(),c.__subitem=l.sub.next(o),c._subindex=null,c._subitem=null):(c.__subindex=null,c.__subitem=null,c._subindex=null,c._subitem=null),"sequence"===l.type&&l.seq&&l.seq.length)for(s=0,a=l.seq.length;a>s;s++)m?l.seq[s].rewind(o):l.seq[s].order(n,o);return c._init(o),l.sub&&(c._prev=c._prev&&null!=c.__subitem,c._next=c._next&&null!=c.__subitem,c._subindex=d.add(d.mul(c.__subindex,l.count),c._index),c._subitem=f.fusion(l.submethod,c._item,c.__subitem,c.dimension(),c.base(),l.subpos,l.subcascade)),c},index:function(n,e){if(e=!0===e,!arguments.length)return this.$.sub?this._subindex:this._index;var t,r=this,u=r[Jn],i=Tn.Arithmetic,l=i.O,o=(i.I,i.J),s=r.n,a=r.$,c=a.sub&&!e?a.subcount:a.count,f=a.sub&&!e?r._subindex:r._index,d=a.order;return n=i.wrapR(i.N(n),c),!i.equ(n,f)&&i.inside(n,o,c)&&(c=a.count,t=a.last,a.sub&&!e&&(a.sub.index(i.div(n,c)),r.__subindex=a.sub.index(),r.__subitem=a.sub.item(),n=i.mod(n,c)),fe&d||(r.__index=n,r._index=n,r.__item=i.equ(l,n)?u.initial(s,a,1):i.equ(t,n)?u.initial(s,a,-1):u.unrank(n,s,a),r._update(),r._item=u.output(r.__item,r.__index,s,a),r._prev=null!=r.__item,r._next=null!=r.__item),a.sub&&(r._prev=r._prev&&null!=r.__subitem,r._next=r._next&&null!=r.__subitem,r._subindex=i.add(i.mul(r.__subindex,c),r._index),r._subitem=u.fusion(a.submethod,r._item,r.__subitem,r.dimension(),r.base(),a.subpos,a.subcascade))),r},item0:function(n){var e=this;return e[Jn].initial(e.n,e.$,-1===n?-1:1)},item:function(n,e){if(!arguments.length)return this.$.sub?this._subitem:this._item;var u,i,l,o,s,a,c=this,f=c[Jn],d=c.n,m=c.$,h=m.sub?m.subcount:m.count,p=m.sub?c._subindex:c._index,_=Tn.Arithmetic,g=_.O,b=(_.I,_.J),v=null;return r(e)?-1<(a=e.indexOf("|"))?(v=e.substr(a+1),e=X(e.substr(0,a))):v=e=X(e):null!=e?v=e=X(e):(e=m.order,v=null),m.sub||(v=null),t(n)?(h=m.count,u=m.last,l=m.order,m.order=e,c.__item=n.slice(),c._update(),c.__index=f.rank(c.__item,d,m),c._item=f.output(c.__item,c.__index,d,m),fe&e?c._index=c.__index:c._index=c.__index,c._prev=null!=c.__item,c._next=null!=c.__item,c):(n=_.wrapR(_.N(n),h),e===m.order&&null===v&&_.equ(n,p)?m.sub?c._subitem:c._item:_.inside(n,b,h)?(s=null,h=m.count,u=m.last,m.sub&&(s=m.sub.item(_.div(n,h),v),n=_.mod(n,h)),fe&e?(i=null,l=m.order,m.order=e,o=f.output(f.rand(d,m),i,d,m),m.order=l,m.sub&&(o=f.fusion(m.submethod,o,s,c.dimension(),c.base(),m.subpos,m.subcascade)),o):(i=n,l=m.order,m.order=e,o=f.output(_.equ(g,n)?f.initial(d,m,1):_.equ(u,n)?f.initial(d,m,-1):f.unrank(i,d,m),i,d,m),m.order=l,m.sub&&(o=f.fusion(m.submethod,o,s,c.dimension(),c.base(),m.subpos,m.subcascade)),o)):null)},random:function(n,e,t,r){var u,i=this,l=i[Jn],o=i.$,s=o.order;if(r=!0===r,"index"===n){var a,c,f=Tn.Arithmetic,d=f.N,m=f.O,h=f.I;return e===!!e&&(r=e,e=null,t=null),o.sub&&!r?(a=o.subcount,c=f.sub(a,h)):(a=o.count,c=o.last),null==e&&null==t?(e=m,t=c):null==t?(e=d(e||0),t=c):(e=d(e),t=d(t)),f.rnd(e,t)}return o.order|=fe,u=l.rand(i.n,o),o.order=s,u=l.output(u,null,i.n,o),o.sub&&!r?l.fusion(o.submethod,u,o.sub.random(),i.dimension(),i.base(),o.subpos,o.subcascade):u},rewind:function(n){var e=this;return e.order(!0,-1===n?-1:1)},hasNext:function(n){var e=this;return-1===n?fe&e.$.order?!1:e._prev:e._next},next:function(n){var e,t,r,u,o,s,a=this,c=a[Jn],f=Tn.Arithmetic,d=f.O,m=f.I,h=f.J,p=a.n,_=a.$,g=_.order,b=_.count,v=_.sub?a._subitem:a._item,y=null!=v;if(n=-1===n?-1:1,0>n&&fe&g)return null;if(e=0>n?h:m,fe&g)if(u=_.last,f.lt(a._index,u))if(t=a._traversed){for(r=a.random("index"),o=Tn.Math.rnd()>.5?h:m;t.isset(+r);)r=f.wrap(f.add(r,o),d,u);t.set(+r),a.__item=c.unrank(r,p,_),null!=a.__item&&(a.__index=r)}else a.__item=c.rand(p,_),a.__index=null;else a._item=a.__item=null,a._traversed&&(a._traversed.dispose(),a._traversed=null);else a.__item=c.succ(a.__item,a.__index,p,_,n,a.item__),null!=a.__item&&(a.__index=f.add(a.__index,e));if(s=null!=a.__item)a._index=f.add(a._index,e),null===a.__index&&(a.__index=a._index),0>n?(a._prev=s,a._next=y):(a._prev=y,a._next=s);else if(_.sub&&_.sub.hasNext(n)){if(a.__subindex=_.sub.index(),a.__subitem=_.sub.next(n),"sequence"===_.type&&_.seq&&_.seq.length)for(i=0,l=_.seq.length;i<l;i++)_.seq[i].rewind(n);a._init(n),s=null!=a.__item}else a.__subindex=null,a.__subitem=null,0>n?(a._prev=s,a._next=y):(a._prev=y,a._next=s);return a._item=c.output(a.__item,a.__index,p,_),_.sub&&(s=s&&null!=a.__subitem,a._subindex=s?f.add(f.mul(a.__subindex,b),a._index):null,a._subitem=s?c.fusion(_.submethod,a._item,a.__subitem,a.dimension(),a.base(),_.subpos,_.subcascade):null,0>n?a._prev=s:a._next=s),v},range:function(n,e){var t,r,u,i,l=this,s=Tn.Arithmetic,a=s.N,c=s.O,f=s.I,d=l.$,m=d.sub?d.subcount:d.count,h=d.sub?s.sub(m,f):d.last,p=1,_=arguments.length,g=!(fe&d.order);return 1>_?(n=c,e=h):2>_?(n=a(n),e=h):(n=a(n),e=a(e)),n=s.wrapR(n,m),e=s.wrapR(e,m),s.gt(n,e)&&(t=n,n=e,e=t,p=-1),n=s.clamp(n,c,h),g&&(e=s.clamp(e,c,h)),s.lte(n,e)?(i=[l.$.order,l.__index,l._index,l.__item&&l.__item.slice(),l._item,l.__subindex,l._subindex,l.__subitem,l._subitem,l._prev,l._next],g&&l.index(n),u=s.val(s.sub(e,n)),r=o(function(n,e,t){return n[t]=l.next(),n},new Array(u+1),null,0>p?u:0,0>p?0:u,0>p?-1:1),l.$.order=i[0],l.__index=i[1],l._index=i[2],l.__item=i[3],l._item=i[4],l.__subindex=i[5],l._subindex=i[6],l.__subitem=i[7],l._subitem=i[8],l._prev=i[9],l._next=i[10],l._update()):r=[],r},__iter__:function(){return new kn.Iterable(this)}}),"undefined"!=typeof Symbol&&"undefined"!=typeof Symbol.iterator&&(kn[Xn][Symbol.iterator]=kn[Xn].__iter__),Dn=Tn.Tensor=Zn(kn,{constructor:function ge(){var n,e=this,u=null,i=Vn.call(arguments);if(n=!i.length||i[i.length-1]instanceof kn||t(i[i.length-1])||i[i.length-1]===+i[i.length-1]?{}:i.pop()||{},i.length&&t(i[0])&&(i=i[0]),i&&i.length||(i=[]),!(e instanceof ge))return new ge(i,n);if(n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||se,n.rand=n.rand||{},"partial"===n.type){i=t(i)&&i.length?i[0]:i;var l=-1,a=n.data||[],c=n.position||null;i instanceof kn?(u=i,i=u.base(),l=i):u=n.sub,i=+(i||0)||0,a.length&&(r(a[0])||a[0].length&&(!0===a[0][0]||!1===a[0][0]))&&(l===i&&(i+=a.length,l=-1),a=ge.generate(i,a,c,n.ordering||null)),l===i&&(i+=(a.length?a[0].length:0)||0,l=-1),n.data=a,n.position=c||s((a.length?a[0].length:0)||0,0,1),n.dimension=n.position.length,n.base=i,n.rand.partial=1}else if("tuple"===n.type)i[0]=i[0]||1,i[1]=i[1]||1,i[0]instanceof kn?(u=i[0],i[0]=u.dimension()):i[1]instanceof kn?(u=i[1],i[1]=u.base()):u=n.sub,n.base=i[1],n.dimension=i[0];else{var f=o(function(n,e){return e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e),n},[1/0,0],i);n.base=i,n.minbase=f[0],n.maxbase=f[1],n.dimension=i.length}kn.call(e,"Tensor",i,n,u?{method:"partial"===n.type?n.submethod||"complete":n.submethod,iter:u,pos:"partial"===n.type?n.subpos||n.position:n.subpos,cascade:n.subcascade}:null)},__static__:{C:kn.C,P:kn.P,T:kn.T,DUAL:kn.DUAL,count:function(n,e){var t=Tn.Arithmetic.O,r=e&&e.type?e.type:"tensor";return"partial"===r?e.data&&e.data.length?Tn.Arithmetic.N(e.data.length):t:"tuple"===r?!n||0>=n[0]?t:Tn.Math.exp(n[1],n[0]):n&&n.length?Tn.Math.product(n):t},initial:function(n,e,t){var r,u=this,i=e&&e.type?e.type:"tensor",l=e&&e.order?e.order:se;return t=-1===t?-1:1,(se&l&&le&l||ae&l&&!(le&l))&&(t=-t),"partial"===i?r=e.data&&e.data.length?0>t?e.data[e.data.length-1]:e.data[0]:null:(r="tuple"===i?n[0]?0>t?s(n[0],n[1]-1,0):s(n[0],0,0):[]:n.length?0>t?s(n.length,function(e){return n[e]-1}):s(n.length,0,0):[],r=u.DUAL(r,n,e)),r},succ:function(n,e,t,r,u,i){if(!t||null==n)return null;var l=r&&r.type?r.type:"tensor",o=r&&null!=r.order?r.order:se;if(u=-1===u?-1:1,"partial"===l){if(!r.data||!r.data.length)return null;le&o&&(u=-u);var s=null==e?r.data.indexOf(n):Tn.Arithmetic.val(e);return 0>u?s-1>=0?r.data[s-1]:null:s>=0&&s+1<r.data.length?r.data[s+1]:null}return!t[0]||0>=t[0]?null:Mn(n,t,u,l,o,i)},rand:function(n,e){var t,r=Tn.Math.rndInt,u=this,i=e&&e.type?e.type:"tensor";return"partial"===i?t=e.data&&e.data.length?e.data[r(0,e.data.length-1)]:null:(t="tuple"===i?n[0]?s(n[0],function(e){return r(0,n[1]-1)}):[]:n.length?s(n.length,function(e){return r(0,n[e]-1)}):[],t=u.DUAL(t,n,e)),t},randu:kn.rand,rank:function(n,e,t){var r,u,i,l=this,o=Tn.Arithmetic,s=t&&null!=t.order?t.order:se,a=t&&t.type?t.type:"tensor",c=o.add,f=o.sub,d=o.mul,r=o.O,m=o.J;if("partial"===a)r=o.N(t.data&&t.data.length?t.data.indexOf(n):-1);else if(n=l.DUAL(n,e,t),"tuple"===a){if(u=e[0],!u)return m;for(e=e[1],i=0;u>i;i++)r=c(d(r,e),n[i])}else{if(u=e.length,!u)return m;for(i=0;u>i;i++)r=c(d(r,e[i]),n[i])}return(se&s&&le&s||ae&s&&!(le&s))&&(r=f(t&&null!=t.last?t.last:f(l.count(e,t),o.I),r)),r},unrank:function(n,e,t){var r,u,i,l,o,s,a=this,c=Tn.Arithmetic,f=t&&null!=t.order?t.order:se,d=t&&t.type?t.type:"tensor",m=c.sub,h=c.mod,p=c.div,_=c.val;if(null==n||!c.inside(n,c.J,t&&null!=t.count?t.count:a.count(e,t)))return null;if((se&f&&le&f||ae&f&&!(le&f))&&(n=m(t&&null!=t.last?t.last:m(a.count(e,t),c.I),n)),"partial"===d){if(!t.data||!t.data.length)return null;n=_(n),o=n>=0&&n<t.data.length?t.data[n]:null}else{if("tuple"===d){if(s=e[0],!s)return[];for(o=new Array(s),u=e[1],r=n,i=s-1;i>=0;i--)l=h(r,u),r=p(r,u),o[i]=_(l)}else{if(s=e.length,!s)return[];for(o=new Array(s),r=n,i=s-1;i>=0;i--)u=e[i],l=h(r,u),r=p(r,u),o[i]=_(l)}o=a.DUAL(o,e,t)}return o},fusion:kn.fusion,output:function(n,e,r,u){var i=this;return null==n?null:u&&"tensor"===u.type&&t(u.output)?i.component(n,u.output):kn.output.call(i,n,e,r,u)},gray:m,product:J,directsum:V,component:function(n,e){return null==n?null:null==e?n:s(n.length,function(t){return t<e.length&&0<=n[t]&&n[t]<e[t].length?e[t][n[t]]:n[t]})},conditional:G,generate:F}}),Rn=Tn.Permutation=Zn(kn,{constructor:function be(n,e){var r=this,u=null;return r instanceof be?(e=e||{},e.type=String(e.type||"permutation").toLowerCase(),n=n||0,n instanceof kn?(u=n,n=u.dimension()):u=e.sub,e.base=e.dimension=n,e.rand=e.rand||{},e.rand.derangement=1,e.rand.involution=1,e.rand.connected=1,"multiset"===e.type&&(e.multiplicity=t(e.multiplicity)&&e.multiplicity.length?e.multiplicity.slice():s(n,1,0),e.multiplicity=e.multiplicity.concat(s(n-o(q,0,e.multiplicity),1,0)),e.base=e.multiplicity.length,e.multiset=tn(e.multiplicity,n)),void kn.call(r,"Permutation",n,e,u?{method:e.submethod,iter:u,pos:e.subpos,cascade:e.subcascade}:null)):new be(n,e)},__static__:{C:kn.C,P:kn.P,T:kn.T,DUAL:kn.DUAL,count:function(n,e){var t=Tn.Arithmetic,r=t.O,u=Tn.Math.factorial,i=Tn.Math.stirling,l=e&&e.type?e.type:"permutation",o=e&&null!=e["cycles="]?0|e["cycles="]:null,s=e&&null!=e["fixed="]?0|e["fixed="]:null;return 0>n?r:"cyclic"===l?t.N(n):"multiset"===l?u(n,e.multiplicity):"derangement"===l?s?2>n-s?r:t.mul(u(n,s),u(n-s,!1)):2>n?r:u(n,!1):"involution"===l?u(n,!0):"connected"===l?u(n-1):o?i(n,o,1):u(n)},initial:function(n,e,t){var r,u=this,i=e&&e.type?e.type:"permutation",l=e&&null!=-e.order?e.order:se,o=e&&null!=e["cycles="]?0|e["cycles="]:null,a=e&&null!=e["fixed="]?0|e["fixed="]:null;if(0===n)return[];if(t=-1===t?-1:1,(se&l&&le&l||ae&l&&!(le&l))&&(t=-t),"cyclic"===i)r=0>t?[n-1].concat(s(n-1,0,1)):s(n,0,1);else if("derangement"===i){if(a||2>n)return null;if(1&n){var c=jn.floor(n/2);r=0>t?s(n-c-1,n-1,-1).concat([c-1,c]).concat(s(c-1,c-2,-1)):s(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=0>t?s(n,n-1,-1):s(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===i?0>t?e.multiset.slice().reverse():e.multiset.slice():"connected"===i?null:"involution"===i?0>t?s(n,n-1,-1):s(n,0,1):o?null:0>t?s(n,n-1,-1):s(n,0,1);return r=u.DUAL(r,n,e)},succ:function(n,e,t,r,u,i){if(!t||0>=t||null==n)return null;var l=r&&r.type?r.type:"permutation",o=r&&null!=r["cycles="]?0|r["cycles="]:null,s=r&&null!=r["fixed="]?0|r["fixed="]:null;return"derangement"===l&&s||"permutation"===l&&o?null:(u=-1===u?-1:1,qn(n,t,u,l,r&&null!=r.order?r.order:se,r&&null!=r.base?r.base:null,i))},rand:function(n,e){var t,r=Tn.Math.rndInt,u=this,i=e&&e.type?e.type:"permutation",l=e&&null!=e["cycles="]?0|e["cycles="]:null,o=e&&null!=e["fixed="]?0|e["fixed="]:null;if(0===n)return[];if("cyclic"===i){var a=r(0,n-1);t=a>0?s(n-a,a,1).concat(s(a,0,1)):s(n,0,1)}else if("derangement"===i){if(o)return null;t=new Array(n);var c,f,d,m=!1;do{for(c=0;n>c;c++)t[c]=c;for(c=n-1,m=!1;c>=0;){if(d=r(0,c),t[d]===c){m=!0;break}f=t[c],t[c]=t[d],t[d]=f,c--}m=m||0===t[0]}while(m)}else if("involution"===i){t=s(n,0,1);for(var h,p,_,g,f,b,v=Tn.Math.rnd,y=.5,x=1,A=n,M=[1].concat(s(n-1,function(){var n=y;return x+=1,y=1/(1+x*y),n})),O=s(n,0,1);A>=2;)h=A-1,p=O[h],--A,y=M[A],f=v(),f>y&&(_=r(0,A-1),g=O[_],--A,b=O[_],O[_]=O[A],O[A]=b,b=t[g],t[g]=t[p],t[p]=b)}else if("multiset"===i)t=w(e.multiset.slice());else if("connected"===i)t=w(s(n,0,1),!0);else{if(l)return null;t=w(s(n,0,1))}return t=u.DUAL(t,n,e)},randu:kn.rand,rank:function(n,t,r){var u,i,l,o,s,a=this,c=Tn.Arithmetic,f=r&&r.type?r.type:"permutation",d=r&&null!=r["cycles="]?0|r["cycles="]:null,m=(r&&null!=r["fixed="]?0|r["fixed="]:null,r&&null!=-r.order?r.order:se),h=c.sub,p=c.add,_=c.mul,g=c.div,b=c.O,v=c.I,y=c.J;if(t=t||n.length,!t)return b;if(n=a.DUAL(n,t,r),"cyclic"===f)b=c.NUM(n[0]);else{if("derangement"===f||"involution"===f||"connected"===f)return e();if("multiset"===f)for(s=r.multiplicity.slice(),o=r&&null!=r.count?r.count:Tn.Math.factorial(t,s),l=t-1,u=0;l>u&&c.gt(o,v);u++)i=n[u],b=p(b,g(_(o,S(s,0,i-1,1)),t-u)),o=g(_(o,s[i]),t-u),s[i]--;else{if(d)return y;for(n=on(null,n),l=t-1,u=0;l>u;u++)b=p(_(b,t-u),n[u])}}return(se&m&&le&m||ae&m&&!(le&m))&&(b=h(r&&null!=r.last?r.last:h(a.count(t,r),v),b)),b},unrank:function(n,t,r){var u,i,l,o,a,c,f,d,m=this,h=Tn.Arithmetic,p=r&&r.type?r.type:"permutation",_=r&&null!=r["cycles="]?0|r["cycles="]:null,g=(r&&null!=r["fixed="]?0|r["fixed="]:null,r&&null!=-r.order?r.order:se),b=h.mod,v=h.div,y=h.mul,x=h.sub,A=h.val;if(null==n||!h.inside(n,h.J,r&&null!=r.count?r.count:m.count(t,r)))return null;if(!t)return[];if((se&g&&le&g||ae&g&&!(le&g))&&(n=x(r&&null!=r.last?r.last:x(m.count(t,r),h.I),n)),"cyclic"===p)n=A(n),u=s(t,function(e){return(n+e)%t});else{if("derangement"===p||"involution"===p||"connected"===p)return e();if("multiset"===p)for(d=r.multiplicity.slice(),u=s(t),f=r&&null!=r.count?r.count:Tn.Math.factorial(t,d),l=0;t>l;l++){for(a=0,o=0,i=A(v(y(n,t-l),f));o<d.length&&a+d[o]<=i;)a+=d[o++];n=x(n,v(y(f,a),t-l)),f=v(y(f,d[o]),t-l),d[o]--,u[l]=o}else{if(_)return null;for(u=s(t),u[t-1]=0,i=n,l=t-2;l>=0;l--)a=t-l,c=b(i,a),i=v(i,a),u[l]=A(c);sn(u,u)}}return u=m.DUAL(u,t,r)},fusion:kn.fusion,output:kn.output,permute:mn,shuffle:function(n,e){if("cyclic"===e){var t=n.length,r=Tn.Math.rndInt(0,t-1);return r>0&&n.push.apply(n,n.splice(0,r)),n}return"connected"===e?w(n,!0):w(n)},product:function(){return arguments.length?hn(t(arguments[0])&&t(arguments[0][0])?arguments[0]:Vn.call(arguments)):null},directsum:function(){return arguments.length?pn(t(arguments[0])&&t(arguments[0][0])?arguments[0]:Vn.call(arguments)):null},cycles:function(n,e){return-1===e?cycles2permutation(n):cn(n)},swaps:function(n,e){return-1===e?dn(n):fn(n)},inversion:function(n,e){return-1===e?sn(null,n):on(null,n)},inverse:function(n){return ln(null,n)},multiset:function(n,e,t){return n===+n?tn(e,n,-1===t?-1:1):-1===t?rn(n):un(n,e)},matrix:function(n,e,t){return-1===t?en(null,n,e):nn(null,n,e)},parity:e,is_permutation:_n,is_identity:gn,is_cyclic:xn,is_derangement:yn,is_involution:bn,is_kthroot:vn,is_connected:An,is_kcycle:wn},_update:function(){var n=this;return n.item__=On(n.__item,n.n,n.$.order,n.$.type),n}}),Nn=Tn.Combination=Zn(kn,{constructor:function ve(n,e,r){var u=this,i=null;if(!(u instanceof ve))return new ve(n,e,r);if(t(n)?(r=e||{},e=n[1]||0,n=n[0]||0):(r=r||{},n=n||0,e=e||0),r.type=String(r.type||"unordered").toLowerCase(),-1<r.type.indexOf("+")){var l=r.type.split("+");l.sort(),r.type=l.join("+")}e instanceof kn?(i=e,e=i.dimension()):n instanceof kn?(i=n,n=i.base()):i=r.sub,r.base=n,r.dimension=e,kn.call(u,"Combination",[n,e],r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:kn.C,P:kn.P,T:kn.T,DUAL:kn.DUAL,count:function(n,e){var t=Tn.Math.factorial,r=e&&e.type?e.type:"unordered";return"ordered+repeated"===r?Tn.Math.exp(n[0],n[1]):"repeated"===r?t(n[0]+n[1]-1,n[1]):"ordered"===r?t(n[0],-n[1]):t(n[0],n[1])},initial:function(n,e,t){var r,u=this,i=e&&e.type?e.type:"unordered",l=e&&null!=e.order?e.order:se;return 0===n[1]?[]:(t=-1===t?-1:1,(se&l&&le&l||ae&l&&!(le&l))&&(t=-t),r="ordered+repeated"===i||"repeated"===i?0>t?s(n[1],n[0]-1,0):s(n[1],0,0):"ordered"===i?0>t?s(n[1],n[0]-1,-1):s(n[1],0,1):0>t?s(n[1],n[0]-n[1],1):s(n[1],0,1),r=u.DUAL(r,n,e))},succ:function(n,e,t,r,u,i){return!t||!t[0]||0>=t[0]||0===t[1]||null==n?null:(u=-1===u?-1:1,Sn(n,t,u,r&&r.type?r.type:"unordered",r&&null!=r.order?r.order:se,i))},rand:function(n,e){var t,r,u,i,l=this,o=e&&e.type?e.type:"unordered",a=n[1],c=Tn.Math.rndInt;return 0===a?[]:(n=n[0],r=n-a,u=n-1,"repeated"===o||"ordered+repeated"===o?(t=1===a?[c(0,u)]:s(a,function(){return c(0,u)}),a>1&&"repeated"===o&&x(t,1,!0)):"ordered"===o?(i={},t=1===a?[c(0,u)]:n===a?w(s(a,0,1)):s(a,function(){for(var e=c(0,u);1===i[e];)e=(e+1)%n;return i[e]=1,e})):(i={},t=1===a?[c(0,u)]:n===a?s(a,0,1):a>r?H(n,s(r,function(){for(var e=c(0,u);1===i[e];)e=(e+1)%n;return i[e]=1,e}),!0):x(s(a,function(){for(var e=c(0,u);1===i[e];)e=(e+1)%n;return i[e]=1,e}),1,!0)),t=l.DUAL(t,n,e))},randu:kn.rand,rank:function(n,e,t){var r,u,i,l,o,s=this,a=Tn.Arithmetic,c=a.add,f=a.sub,d=a.mul,m=a.O,h=a.I,p=m,_=e[1],g=t&&null!=t.order?t.order:se,b=t&&t.type?t.type:"unordered",v=Tn.Math.factorial;if(0===_)return m;if(n=s.DUAL(n,e,t),"ordered+repeated"===b)for(l=e[0],r=0;_>r;r++)p=c(d(p,l),n[r]);else if("repeated"===b){for(l=e[0]+_-1,o=t&&t.count?t.count:v(l,_),r=1;_>=r;r++)u=l-1-n[r-1]-r+1,i=_+1-r,u>=i&&(p=c(p,v(u,i)));p=f(f(o,h),p)}else if("ordered"===b)for(l=e[0],n=on(null,n,l),r=0;_>r;r++)p=c(d(p,l-r),n[r]);else{for(l=e[0],o=t&&t.count?t.count:v(l,_),r=1;_>=r;r++)u=l-1-n[r-1],i=_+1-r,u>=i&&(p=c(p,v(u,i)));p=f(f(o,h),p)}return(se&g&&le&g||ae&g&&!(le&g))&&(p=f(t&&null!=t.last?t.last:f(s.count(e,t),h),p)),p},unrank:function(n,e,t){var r,u,i,l,o,a,c,f=this,d=Tn.Arithmetic,m=d.O,h=d.I,p=d.sub,_=d.div,g=d.mod,b=d.mul,v=d.lte,y=d.gt,x=d.val,A=e[1],w=t&&t.type?t.type:"unordered",M=t&&null!=t.order?t.order:se;if(e=e[0],null==n||!d.inside(n,d.J,t&&null!=t.count?t.count:f.count(e,t)))return null;if(0===A)return[];if((se&M&&le&M||ae&M&&!(le&M))&&(n=p(t&&null!=t.last?t.last:p(f.count(e,t),d.I),n)),r=s(A),"ordered+repeated"===w)for(l=n,a=A-1;a>=0;a--)o=g(l,e),l=_(l,e),r[a]=x(o);else if("ordered"===w){for(l=n,a=A-1;a>=0;a--)i=e-a,o=g(l,i),l=_(l,i),r[a]=x(o);sn(r,r,i)}else{c="repeated"===w,i=c?e+A-1:e,u=t&&t.count?t.count:Tn.Math.factorial(i,A),n=p(p(u,h),n),u=_(b(u,i-A),i),o=i-A+1,l=A,a=i-1;do v(u,n)?(r[A-l]=c?i-o-A+1:i-o-l+1,y(u,m)&&(n=p(n,u),u=_(b(u,l),a)),l--,a--):(u=_(b(u,a-l),a),o--,a--);while(l>0)}return r=f.DUAL(r,e,t)},fusion:kn.fusion,output:function(n,e,t,r){return null==n?null:r&&"binary"===r.output?W(n,t[0]):kn.output.call(this,n,e,t,r)},complement:function(n,e,t){return!0===t?w(H(e,n,!0)):H(e,n)},binary:function(n,e,t){return-1===t?B(n,e):W(n,e)},pick:function(n,e,t){return e>0&&n.length?M(n,e,"ordered+repeated"!==t&&"ordered"!==t,"ordered+repeated"===t||"repeated"===t,new Array(e)):[]},choose:function(n,e){return e&&e.length?s(e.length,function(t){return 0<=e[t]&&e[t]<n.length?n[e[t]]:null}):[]}},_update:function(){var n=this;return n.item__=In(n.__item,n.n[0],n.n[1],n.$.order,n.$.type),n}}),Nn.conjugate=Nn.complement,Nn.project=Nn.choose,Un=Tn.Powerset=Tn.Subset=Zn(kn,{constructor:function ye(n,e){var t=this,r=null;return t instanceof ye?(e=e||{},n=n||0,n instanceof kn?(r=n,n=r.base()):r=e.sub,e.type=e.type||"subset",e.rand=e.rand||{},e.rand.subset=1,e.base=n,e.dimension=n,e.mindimension=0,e.maxdimension=n,void kn.call(t,"Subset",n,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)):new ye(n,e)},__static__:{C:function(n,e){return e+1===n.length?(n=H(e,n.slice(0,n[e])),n.concat(n.length<e?new Array(e-n.length):[]).concat(n.length)):H(e,n)},P:function(n,e){return e+1===n.length?h(n,f(n,n,e,0,n[e]-1),e-n[e],0,n[e]-1):f(n,n)},T:kn.T,DUAL:function(n,e,t){if(null==n)return null;var r=this,u=r.C,i=r.P,l=(r.T,t&&null!=t.order?t.order:se);return n=t&&"binary"===t.type?fe&l?oe&l?n:i(n,e):ce&l?oe&l?n:i(n,e):ae&l?oe&l?i(u(n,e),e):u(n,e):oe&l?n:i(n,e):fe&l?oe&l?i(n,e):n:ce&l?oe&l?i(n,e):n:ae&l?oe&l?u(n,e):i(u(n,e),e):oe&l?i(n,e):n},count:function(n,e){return Tn.Math.pow2(n)},initial:function(n,e,t){var r,u=this,i=e&&null!=e.order?e.order:se;return t=-1===t?-1:1,(se&i&&le&i||ae&i&&!(le&i))&&(t=-t),e&&"binary"===e.type?r=0>t?s(n,0,1):[]:(r=new Array(n+1),r[n]=0,0>t&&(r[0]=n-1,r[n]=1)),r=u.DUAL(r,n,e)},succ:function(n,e,t,r,u,i){return null==n?null:r&&"binary"===r.type?kn.succ.call(this,n,e,t,r,u):Cn(n,t,-1===u?-1:1,r&&null!=r.order?r.order:se)},rand:function(n,e){for(var t,r=this,u=Tn.Math.rndInt,i=null,l=n-1;l>=0;l--)u(0,1)&&(i={len:i?i.len+1:1,k:l,next:i});return t=i?s(i.len,function(n){var e=i.k;return i=i.next,e}):[],e&&"binary"===e.type||(t=t.concat(t.length<n?new Array(n-t.length):[]).concat(t.length)),t=r.DUAL(t,n,e)},randu:kn.rand,rank:function(n,t,r){var u=this,i=Tn.Arithmetic,l=i.O,o=i.I,s=i.add,a=i.shl,c=i.sub,f=r&&null!=r.order?r.order:se,d=l,m=0,h=n.length;if(!r||"binary"!==r.type)return e();for(n=u.DUAL(n,t,r);h>m;)d=s(d,a(o,n[m++]));return(se&f&&le&f||ae&f&&!(le&f))&&(d=c(r&&null!=r.last?r.last:c(u.count(t,r),o),d)),d},unrank:function(n,t,r){var u=this,i=Tn.Arithmetic,l=i.O,o=i.band,s=i.shr,a=i.gt,c=i.sub,f=r&&null!=r.order?r.order:se,d=[],m=0;if(null==n||!i.inside(n,i.J,r&&null!=r.count?r.count:u.count(t,r)))return null;if(!r||"binary"!==r.type)return e();for((se&f&&le&f||ae&f&&!(le&f))&&(n=c(r&&null!=r.last?r.last:c(count,i.I),n));a(n,l);)a(o(n,1),l)&&d.push(m),a(o(n,2),l)&&d.push(m+1),a(o(n,4),l)&&d.push(m+2),a(o(n,8),l)&&d.push(m+3),a(o(n,16),l)&&d.push(m+4),a(o(n,32),l)&&d.push(m+5),a(o(n,64),l)&&d.push(m+6),a(o(n,128),l)&&d.push(m+7),m+=8,n=s(n,8);return d=u.DUAL(d,t,r)},fusion:kn.fusion,output:function(n,e,t,r){return null==n?null:(t+1===n.length&&(n=oe&(r&&null!=r.order?r.order:se)?n.slice(t-n[t],t):n.slice(0,n[t])),r&&"binary"===r.output?W(n,t):kn.output.call(this,n,e,t,r))},binary:function(n,e,t){return-1===t?B(n,e):W(n,e)}}}),Pn=Tn.Partition=Zn(kn,{constructor:function xe(n,e){var t=this,r=null;if(!(t instanceof xe))return new xe(n,e);e=e||{},e.type=e.type||"partition",n=n||1,n instanceof kn?(r=n,n=r.base()):r=e.sub;var u=e["max="]?0|e["max="]:null,i=e["parts="]?0|e["parts="]:null,l=i?i:u?n-u+1:n,o=i?i:u?jn.ceil(n/u):1;e.base=n,e.dimension=i||n,e.mindimension=jn.min(o,l),e.maxdimension=jn.max(o,l),e.rand=e.rand||{},e.rand.partition=1,e.rand.composition=1,e.rand.packed=1,kn.call(t,"Partition",n,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:function(n,e,t){var r=t&&t.type?t.type:"partition",u=t&&null!=t.order?t.order:se,i=t&&t["max="]?0|t["max="]:null,l=t&&t["parts="]?0|t["parts="]:null;return"composition"!==r&&ae&u&&f(n,n),l||i?n:K("composition"===r,n,1)},P:kn.P,T:kn.T,DUAL:kn.DUAL,count:function(n,e){var t=e&&e["max="]?0|e["max="]:null,r=e&&e["parts="]?0|e["parts="]:null,u=e&&e.type?e.type:"partition";return"composition"===u?Tn.Math.compositions(n,r,t):Tn.Math.partitions(n,r,t)},initial:function(n,e,t){var r,u,i,l=this,o=e&&e.type?e.type:"partition",a=e&&e["max="]?0|e["max="]:null,c=e&&e["parts="]?0|e["parts="]:null,d=e&&null!=e.order?e.order:se,m="composition"===o;return 0>=n||c&&a&&(c+a>n+1||n>c*a)||c&&c>n||a&&a>n?null:(t=-1===t?-1:1,(se&d&&le&d||ae&d&&le&d)&&(t=-t),c&&a?(1===c&&(r=[a]),m?(i=jn.min(a,jn.ceil((n-a)/(c-1))),r=[(n-a)%i||i].concat(s(c-2,i,0)).concat([a]),0>t&&f(r,r)):0>t?(u=jn.min(c,jn.floor(n/a)||1),n-=u*a,c-=u,0===n&&c>0&&(u--,
c++,n+=a),r=[a].concat(s(u-1,a,0)).concat(n>0&&c>0?[n-c+1].concat(s(c-1,1,0)):[])):(i=jn.min(a,jn.ceil((n-a)/(c-1))),r=[a].concat(s(c-2,i,0).concat([(n-a)%i||i])))):c?m?(r=s(c-1,1,0).concat([n-c+1]),0>t&&f(r,r)):(i=jn.ceil(n/c),u=n%i||i,r=0>t?[n-c+1].concat(s(c-1,1,0)):s(c-1,i,0).concat([u])):a?(u=jn.floor(n/a),i=n%a,r=m?0>t?s(u,a,0).concat(i?[i]:[]):s(n-a,1,0).concat([a]):0>t?s(u,a,0).concat(i?[i]:[]):[a].concat(s(n-a,1,0))):r=0>t?[n]:s(n,1,0),r=l.DUAL(r,n,e))},succ:function(n,e,t,r,u,i){if(null==t||null==n)return null;var l=r&&r.type?r.type:"partition",o=r&&r["max="]?0|r["max="]:null,s=r&&r["parts="]?0|r["parts="]:null;return 0>=t||s&&o&&(s+o>t+1||t>s*o)||s&&s>t||o&&o>t?null:(u=-1===u?-1:1,"composition"===l?$n(n,t,u,s,o,r&&null!=r.order?r.order:se,i):En(n,t,u,s,o,r&&null!=r.order?r.order:se,i))},rand:function(n,e){var t,r,u,i,l,o=this,a=Tn.Math.rndInt,c=e&&e.type?e.type:"partition",f=(e&&null!=e.order?e.order:se,e&&e["max="]?0|e["max="]:null),d=e&&e["parts="]?0|e["parts="]:null,m=0,h=0,p="composition"===c,_=!1;if(0>=n||d&&f&&(d+f>n+1||n>d*f)||d&&d>n||f&&f>n)return null;if(d&&f)return null;if(f&&!d&&(d=f,_=!0),d)1===d?(r=[n],h=n):n===d?(r=s(d,1,0),h=n):(t={},u=n-2,s(r=x(s(d-1,function(){for(l=a(0,u);1===t[l];)l=(l+1)%(u+1);return t[l]=1,l+1}),1,!0),function(n){return l=r[n],i=l-m,m=l,h+=i,i}));else{for(t=null,l=1;n>l;l++)a(0,1)&&(i=l-m,m=l,h+=i,t={len:t?t.len+1:1,x:i,next:t});r=t?s(t.len,function(){return i=t.x,t=t.next,i}):[]}return n>h&&(r.length?r.splice(a(0,r.length-1),0,n-h):r.push(n-h)),p?_&&(r=w(K(0,x(r,-1)))):(r=x(r,-1),_&&(r=K(0,r))),r=o.DUAL(r,n,e)},randu:kn.rand,rank:e,unrank:e,fusion:kn.fusion,output:function(n,e,t,r){if(null==n)return null;var u=n,i=r&&r.type?r.type:"partition",l=r&&null!=r.order?r.order:se,o=oe&l?-1:1;r&&r["max="]?0|r["max="]:null,r&&r["parts="]?0|r["parts="]:null;return"composition"===i||"packed"===i&&(n=Q(n,o)),u===n?n.slice():n},conjugate:function(n,e){return K("composition"===e,n)},subset:function(n,e){return-1===e?z(n):Y(n)},pack:function(n,e){return-1===e?Z(n):Q(n)}},_update:function(){var n=this;return n.item__=Ln(n.__item,n.n,n.$.order,n.$.type,n.$),n}}),Pn.transpose=Pn.conjugate,Tn});