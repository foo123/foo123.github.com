/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python, Java, C/C++
*   @version: 0.8.0
*   https://github.com/foo123/Abacus
**/
!function(n,t,e){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[t])&&(n[t]=n.$deps[t]=e.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=e.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(t,[],function(r){r(t,e.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return e.moduleUri=t.uri,e.call(n)}):t in n||(n[t]=e.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[t]})}(this,"Abacus",function(n){"use strict";function t(){throw new Error("Method not implemented!")}function e(n){return n instanceof Array||"[object Array]"===Sn.call(n)}function r(n){return n instanceof String||"[object String]"===Sn.call(n)}function u(n){var t=n.toString(2),e=32-t.length;return e>0?new Array(e+1).join("0")+t:t}function i(n,t,r,u,i,l,o){var a,s,c,f,d,m,h,_,p=t,b=null,v=r&&e(r);if(v&&(null==u&&(u=0),null==i&&(i=r.length-1)),null==l&&(l=u>i?-1:1),0===l||v&&!r.length||0>=In.floor((i-u)/l)+1)return p;if(0>l?(_=(u-i)%-l,_&&(b=i),i+=_,m=i,h=u,f=-1,c=-(-l<<4)):(_=(i-u)%l,_&&(b=i),i-=_,m=u,h=i,f=1,c=l<<4),d=u+l*(15&In.floor((i-u)/l+1)),v){for(m=In.max(0,m),h=In.min(r.length-1,h),a=u;a>=m&&h>=a&&f*(d-a)>0;a+=l)p=n(p,r[a],a);for(s=d;s>=m&&h>=s;s+=c)a=s,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a),a+=l,p=n(p,r[a],a);!0===o&&null!==b&&b>=0&&b<r.length&&(p=n(p,r[b],b))}else{for(a=u;a>=m&&h>=a&&f*(d-a)>0;a+=l)p=n(p,a,a);for(s=d;s>=m&&h>=s;s+=c)a=s,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a),a+=l,p=n(p,a,a);!0===o&&null!==b&&(p=n(p,b,b))}return p}function l(n,t,r){var u=e(n)?n:(n=0|n)>0?new Array(n):[];if(n=u.length,n>0&&null!=t){r=r||0;var l=t;i("function"==typeof t?function(n,e,r){return n[r]=t(r),n}:t===+t?function(n,t,e){return n[e]=l,l+=r,n}:function(n,e,r){return n[r]=t,n},u,u)}return u}function o(n,t,e){return i(function(n,e,r){return n[r]=e[t],n},!0===e?n:new Array(n.length),n)}function a(n,t,r,u,l){return null==t?null:i(e(r)?function(n,t,e){return n[e]=r[e]-1-t,n}:function(n,t,e){return n[e]=r-1-t,n},n,t,u,l)}function s(n,t,e,r){if(null==n)return null;if(null==e&&(e=0),null==r&&(r=n.length-1),r>e)for(var u,i=e,l=r;l>i;i++,l--)u=n[i],n[i]=n[l],n[l]=u;return n}function c(n,t){return null==t&&(t=0),e(n)?l(n,function(e){return t-n[e]}):n===+n&&t===+t?t-n:Mn.Arithmetic.sub(Mn.Arithmetic.N(t),n)}function f(n,t,r,u,l){if(null==t)return null;var o=0;return i(e(r)?function(n,t,e){return n[e]=r[e]>0?(t+o)%r[e]:0,o+=r[e]-n[e],n}:function(n,t,e){return n[e]=(t+o)%r,o+=r-n[e],n},n,t,u,l)}function d(n,t,e,r,u,l){if(null==t)return null;null==e&&(e=1),null==r&&(r=0);var o=0;return i(function(n,t,u){return n[u]=r+e*(t-o),o=t,n},n,t,u,l)}function m(n,t,e,r,u,l){if(null==t)return null;null==e&&(e=1),null==r&&(r=0);var o=0;return i(function(n,t,u){return o+=t,n[u]=r+e*o,n},n,t,u,l)}function h(n,t,e,r,u,i,l,o){r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=t.length-1),null==l&&(l=0),null==o&&(o=e.length-1);var a=u>i?-1:1,s=l>o?-1:1,c=a*(i-u)+1,f=s*(o-l)+1,d=u,m=l,h=0;if(null==n&&(n=new Array(In.min(c,f))),0===n.length)return n;for(;a*(i-d)>=0&&s*(o-m)>=0;)1===r&&t[d]<e[m]||-1===r&&t[d]>e[m]?d+=a:1===r&&t[d]>e[m]||-1===r&&t[d]<e[m]?m+=s:(n[h++]=t[d],d+=a,m+=s);return h<n.length&&(n.length=h),n}function _(n,t,e,r,u,i,o,a){r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=t===+t?t-1:t.length-1),null==o&&(o=0),null==a&&(a=e?e.length-1:-1);var s=u>i?-1:1,c=o>a?-1:1,f=s*(i-u)+1,d=u,m=u,h=0;if(!e||!e.length)return t===+t?l(t,u,s):t?t.slice():t;if(null==n&&(n=new Array(f)),t===+t){for(;s*(i-d)>=0&&c*(a-m)>=0;)d===e[m]?(d+=s,m+=s):1===r&&d>e[m]||-1===r&&d<e[m]?m+=c:(n[h++]=d,d+=s);for(;s*(i-d)>=0;)n[h++]=d,d+=s}else{for(;s*(i-d)>=0&&c*(a-m)>=0;)t[d]===e[m]?(d+=s,m+=s):1===r&&t[d]>e[m]||-1===r&&t[d]<e[m]?m+=c:(n[h++]=t[d],d+=s);for(;s*(i-d)>=0;)n[h++]=t[d],d+=s}return h<n.length&&(n.length=h),n}function p(n,t,e,r,u,i,l,o,a,s,c){r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=t.length-1),null==l&&(l=0),null==o&&(o=e.length-1),!0===a?s=!1:(a=!1,s=!1!==s),c=!0===c;var f=u>i?-1:1,d=l>o?-1:1,m=f*(i-u)+1,h=d*(o-l)+1,_=m+h,p=u,b=l,v=0,g=null,y=!s;if(null==n&&(n=new Array(_)),0===n.length)return c?t:n;for(;f*(i-p)>=0&&d*(o-b)>=0;){if(s&&v){if(t[p]===g){p+=f;continue}if(e[b]===g){b+=d;continue}}a?1===r&&t[p][0]<e[b][0]||-1===r&&t[p][0]>e[b][0]?(n[v++]=g=t[p],p+=f):1===r&&t[p][0]>e[b][0]||-1===r&&t[p][0]<e[b][0]?(n[v++]=g=e[b],b+=d):(t[p][1]<e[b][1]?(n[v++]=g=t[p],y&&(n[v++]=e[b])):(n[v++]=g=e[b],y&&(n[v++]=t[p])),p+=f,b+=d):1===r&&t[p]<e[b]||-1===r&&t[p]>e[b]?(n[v++]=g=t[p],p+=f):1===r&&t[p]>e[b]||-1===r&&t[p]<e[b]?(n[v++]=g=e[b],b+=d):(n[v++]=g=t[p],y&&(n[v++]=e[b]),p+=f,b+=d)}for(;f*(i-p)>=0;)(y||t[p]!==g)&&(n[v++]=g=t[p],p+=f);for(;d*(o-b)>=0;)(y||e[b]!==g)&&(n[v++]=g=e[b],b+=d);if(c){for(p=u,v=0;_>v;v++,p+=f)t[p]=n[v];return t}return v<n.length&&(n.length=v),n}function b(n,t,e,r,u){null==r&&(r=0),null==u&&(u=n.length-1);var l=r>u?-1:1,a=l*(u-r)+1;if(e=!0===e,1>=a)return e?1===a?[r]:[]:n;t=-1===t?-1:1;var s,c,f=a,d=1,m=2,h=In.min,_=new Array(a);for(e&&(s=r,c=new Array(a),n=i(function(t,e,r){return t[r]=[n[s],s],s+=l,t},c,c),r=0,u=a-1,l=1);f>0;)i(function(u,i){p(_,n,n,t,r+l*i,r+l*(i+d-1),r+l*(i+d),r+l*h(i+m-1,a-1),e,!1,!0)},null,null,0,a-d-1,m),d<<=1,m<<=1,f>>=1;return e?o(n,1,!0):n}function v(n,t,r,u){var l,o=Mn.Math.rndInt,a=!0===t?1:0;return e(r)?1<(l=r.length)&&i(function(n){if(a<l--){var t=o(0,l-a),e=n[r[l]];n[r[l]]=n[r[t]],n[r[t]]=e}return n},n,r,0,l-1):(null==r&&(r=0),null==u&&(u=n.length-1),1<(l=u-r+1)&&i(function(n){if(a<l--){var t=o(0,l-a),e=n[r+l];n[r+l]=n[r+t],n[r+t]=e}return n},n,n,0,l-1)),n}function g(n,t,e,r,u,i,l){null==i&&(i=0),null==l&&(l=n.length-1);var o,a,s,c,f=Mn.Math.rndInt,d=l-i+1;if(t=In.min(t,d),e=!0===e,o=new Array(t),!0===r){for(d-=1,a=0;t>a;a++)o[a]=n[i+f(0,d)];return e&&b(o),o}for(a=0;t>a;a++)s=f(0,--d),c=n[i+s],n[i+s]=n[i+d],n[i+d]=c,o[a]=c,u&&(u[a]=s);if(u)for(a=t-1;a>=0;a--)s=u[a],c=n[i+d],n[i+d]=n[i+s],n[i+s]=c,d++;return e&&b(o),o}function y(n,t,e,r,u){e=-1===e?-1:1,null==r&&(r=0),null==u&&(u=t.length-1);var i,l,o=r,a=u;if(n===t[o])return o;if(n===t[a])return a;for(;a>o;){if(i=o+(a-o+1>>>1),l=t[i],n===l)return i;1===e&&l>n||-1===e&&n>l?a=i-1:o=i+1}return-1}function x(n,t){return n+t}function A(n,t){return n*t}function w(n,t,e,r){return i(Mn.Arithmetic.add,Mn.Arithmetic.O,n,t,e,r)}function M(n,t,e,r){return i(Mn.Arithmetic.mul,Mn.Arithmetic.I,n,t,e,r)}function I(n){var t=Mn.Arithmetic;return t.shl(t.I,t.N(n))}function O(n,t){var e=Mn.Arithmetic,r=e.N;return e.pow(r(n),r(t))}function C(n,t){var r,u=Mn.Arithmetic,l=u.O,o=u.I,a=u.J,s=u.N,c=u.add,f=(u.sub,u.div),d=u.mul;return null==t?10>=n?0>n?l:0===n?o:s([1,2,6,24,120,720,5040,40320,362880,3628800][n-1]):(r=String(n),null==C.mem1[r]&&(C.mem1[r]=d(C(n-1),n)),C.mem1[r]):!1===t?10>=n?2>n?l:s([1,2,9,44,265,1854,14833,133496,1334961][n-2]):(r="!"+String(n),null==C.mem2[r]&&(C.mem2[r]=c(1&n?a:o,d(C(n-1,!1),n))),C.mem2[r]):!0===t?10>=n?0>n?l:0===n?o:s([1,2,4,10,26,76,232,764,2620,9496][n-1]):(r="I"+String(n),null==C.mem2[r]&&(C.mem2[r]=c(C(n-1,!0),d(C(n-2,!0),n-1))),C.mem2[r]):e(t)?t.length?0>n?l:(r=String(n)+"@"+t.join(","),null==C.mem3[r]&&(C.mem3[r]=f(C(n),i(function(n,t){return d(n,C(t))},C(t[t.length-1]),t,t.length-2,0))),C.mem3[r]):0>n?l:C(n):t===+t?0>t?-t>n?l:(r=String(n)+"@"+String(t),null==C.mem3[r]&&(C.mem3[r]=i(d,o,null,n+t+1,n)),C.mem3[r]):(t+t>n&&(t=n-t),0>t||1>n?l:0===t||1===n?o:1===t?s(n):(r=String(n)+"@"+String(t),null==C.mem3[r]&&(C.mem3[r]=u.isDefault()?In.round(i(function(t,e){return t*(1+n/e)},(n-=t)+1,null,2,t)):f(C(n,-t),C(t))),C.mem3[r])):l}function E(n,t,e,r){var u,l=Mn.Arithmetic,o=l.add,a=l.O;return 0>n||0>=t||e>r||e+t>n+1||n>t*r?a:r===n&&1===t||t===n&&1===r?l.I:(u=String(n)+","+String(t)+","+String(e)+","+String(r),null==E.mem[u]&&(n-=t*(e-1),r=r-e+1,E.mem[u]=i(function(e,u){return o(e,E(n-r,t-1,1,u))},a,null,In.max(1,In.ceil((n-r)/(t-1))),In.min(r,n-r-t+2),1)),E.mem[u])}function L(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,u=Mn.Arithmetic.add,l=Mn.Arithmetic.O,o=e?e:0,a=e?e:1,s=t?t:1,c=t?t:n;return 0>n||t&&e&&(t+e>n+1||n>t*e)||e&&e>n||t&&t>n?l:(e&&!t&&(o=0,a=1,s=e,c=e,t=e,e=null),r=String(n)+"|"+String(t)+"|"+String(e),null==L.mem[r]&&(L.mem[r]=i(function(t,e){return i(function(t,r){return u(t,E(n,e,1,r))},t,null,a,o?o:n-e+1,1)},l,null,s,c,1)),L.mem[r])}function S(n,t,e,r){var u,l=Mn.Arithmetic,o=l.add,a=l.O;return 0>n||0>=t||e>r||e+t>n+1||n>t*r?a:e===r?t*e===n?l.I:a:n===r?C(n-t*e+t-1,t-1):e+1===r?C(t,n-t*e):(u=String(n)+","+String(t)+","+String(e)+","+String(r),null==S.mem[u]&&(S.mem[u]=i(function(n,u){return o(n,S(u,t-1,e,r))},a,null,n-r,n-e,1)),S.mem[u])}function R(n,t,e){t=null==t?null:0|t,e=null==e?null:0|e;var r,u=Mn.Arithmetic.O,l=Mn.Arithmetic.add;return 0>n||t&&e&&(t+e>n+1||n>t*e)||e&&e>n||t&&t>n?u:(r=String(n)+"|"+String(t)+"|"+String(e),null==R.mem[r]&&(t&&e?R.mem[r]=S(n,t,1,e):t?R.mem[r]=S(n,t,1,n):e?R.mem[r]=i(function(t,r){return l(t,S(n,r,1,e))},u,null,In.ceil(n/e),n,1):R.mem[r]=n>=1?I(n-1):Arithmetic.I),R.mem[r])}function D(n){if(!arguments.length||null==n)return Tn;if(r(n)){n=n.toUpperCase().split(",");var t,e=0,u=n.length;for(t=0;u>t;t++)e|=Ln.call(D,n[t])?D[n[t]]:0;return e>0&&!(e&(Jn|qn))&&(e|=Tn),e&qn&&(e&=~Pn),e>0?e:Tn}return n&qn&&(n&=~Pn),Vn&n?n:Tn}function k(){var n,t,r,u,i,l,o,a,s,c,f=arguments,d=f.length;if(!d)return[];if(!0===f[0]){for(s=f[1].length,n=2;d>n;n++)s*=f[n].length;for(c=new Array(s),n=0;s>n;n++){for(a=0,l=1,r=n,t=1;d>t;t++)u=f[t].length,i=r%u,r=~~(r/u),o=f[t][i],a+=l*o,l*=u;c[n]=a}}else{for(s=f[0].length,n=1;d>n;n++)s*=f[n].length;for(c=new Array(s),n=0;s>n;n++){for(a=[],r=n,t=d-1;t>=0;t--)if(u=f[t].length,i=r%u,r=~~(r/u),o=f[t][i],e(o))for(l=o.length-1;l>=0;l--)a.unshift(o[l]);else a.unshift(o);c[n]=a}}return c}function U(n,t){if(0>t)return[];var e,r=l(t,0,0),u=n.length;for(t-=1,e=0;u>e;e++)r[t-n[e]]=1;return r}function $(n,t){t=In.min(t||n.length,n.length);var e,r=[];for(t-=1,e=0;t>=e;e++)0<n[e]&&r.push(t-e);return r}function P(n,t){return null==n?null:(t=t||n.length,m(new Array(t),n,1,-1,0,t-1))}function N(n,t){return null==n?null:(t=t||n.length,d(new Array(t),n,1,1,0,t-1))}function T(n,t){if(null==n)return null;var r,u,i,o,a,s,c=n.length,f=1,d=0,m=0,h="push",_=-1===t;if(_&&(f=-f,d=c-1-d,h="unshift"),e(n[d]))for(a=n[d],s=[[a[1],a[0]]],o=0,i=1;c>i;i++)a=n[f*i+d],u=_?0:o,a[1]===s[u][0]?s[u][1]+=a[0]:(s[h]([a[1],a[0]]),o++);else for(r=n[d],s=l(r,1,0),_&&(m=r-1-m),i=1;c>i;i++)for(u=0,a=n[f*i+d];r>u&&a>0;)s[f*u+m]++,a--,u++;return s}function j(n,t){if(null==n)return null;var e,r=n.length,u=i(x,0,n),l=-1===t;return e=P(l?n.slice().reverse():n,u),e.length=r,e=_(null,u-1,e,1,null,null,0,r>1?r-1:0),r=e.length,e=N(e,u),e.length=r,e[r-1]=u-i(x,0,e,0,r>2?r-2:0,1),l&&s(e),e}function X(n,t){if(null==n)return null;var e,r,u,i,l=[],o=n.length,a=-1===t,s=1,c=0,f="push";for(a&&(s=-s,c=o-1-c,f="unshift"),u=n[c],i=[u,1],e=1;o>e;e++)r=s*e+c,u===n[r]?i[1]++:(l[f](i),u=n[r],i=[u,1]);return l[f](i),l}function q(n,t){if(null==n)return null;var e,r,u,i,l,o=[],a=n.length,s=-1===t,c=1,f=0,d="push";for(s&&(c=-c,f=a-1-f,d="unshift"),e=0;a>e;e++)if(l=n[c*e+f],1===l[1])o[d](l[0]);else for(u=l[1],i=l[0],r=0;u>r;r++)o[d](i);return o}function J(n,t,e){var r=n?n.length:0,u=1,l=0,o=0,a=r>o?n[o]||1:1;return-1===e&&(u=-1,l=(r||t)-1),i(function(t,e){return 0>=a&&(o++,l+=u,a=r>o?n[o]||1:1),a--,t[e]=l,t},new Array(t),null,0,t-1)}function V(n,t,e){var r,u,i=t.length,l=i*i;for(n=n||new Array(l),r=0,u=0;l>r;)n[r+u]=0,++u>=i&&(u=0,r+=i);if(!0===e)for(r=0;i>r;r++)n[i*t[r]+r]=1;else for(r=0,u=0;i>u;u++,r+=i)n[r+t[r]]=1;return n}function G(n,t,e){var r,u,i=t.length,l=In.floor(In.sqrt(i));if(n=n||new Array(l),!0===e)for(r=0,u=0;l>r;)t[l*r+u]&&(n[u]=r),++u>=l&&(u=0,r++);else for(r=0,u=0;l>r;)t[r+u]&&(n[r]=u),++u>=l&&(u=0,r++);return n}function H(n){return B(null,b(n,1,!0))}function F(n,t){return t&&t.length?i(function(n,e,r){return n[r]=e<t.length?t[e]:e,n},n,n):n}function B(n,t){return i(function(n,t,e){return n[t]=e,n},n||new Array(t.length),t)}function Y(n,t,e){var r=t.length,u=In.ceil(Rn(e||r)),o=1<<u,a=(1<<1+u)-1,s=l(a,0,0);return i(function(n,t,e){for(var r=t+o,i=0;u>i;i++)1&r&&(t-=s[r>>>1<<1]),s[r]+=1,r>>>=1;return s[r]+=1,n[e]=t,n},n||new Array(r),t)}function z(n,t,e){var r,u,l,o=t.length,a=In.ceil(Rn(e||o)),s=1<<a,c=(1<<1+a)-1,f=new Array(c);for(r=0;a>=r;r++)for(l=1,u=1<<r;u>=l;l++)f[u-1+l]=1<<a-r;return i(function(n,t,e){for(var r=1,u=0;a>u;u++)f[r]-=1,r<<=1,t>=f[r]&&(t-=f[r],r++);return f[r]=0,n[e]=r-s,n},n||new Array(o),t)}function K(n,t,e){var r,u=n.length,i=null==t;if(u>1)for(i&&(t=new Array(u-1),e=0),r=u-1;r>=1;r--)t[e++]=[n[0],n[r]];else i&&(t=[]);return i?t:e}function Q(n,t){var e,r,u,i,l=n.length,o=new Array(l),a=!0===t?1:0,s=new Array(l),c=0,f=0;for(e=0;l>e;e++)s[e]=0;for(u=new Array(l),i=0,r=c++,u[i++]=r,s[r]=1;l>c;){if(r=n[r],s[r])for(i>a&&(u.length=i,o[f++]=u),u=new Array(l),i=0;l>c&&s[r=c];)++c;s[r]||(u[i++]=r,s[r]=1)}return i>a&&(u.length=i,o[f++]=u),f<o.length&&(o.length=f),o}function W(n){var t,e,r=n.length,u=new Array(r),i=0,l=Q(n,!0);for(t=0,e=l.length;e>t;t++)i=K(l[t],u,i);return i<u.length&&(u.length=i),u}function Z(n,t){var e,r,u,i=n.length,l=new Array(t);for(e=0;t>e;e++)l[e]=e;for(e=0;i>e;e++)swap=r[e],u=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=u;return l}function nn(n){var t,e,r,u=n,i=u.length,l=i?u[0]:[],o=l.length;for(e=1;i>e;e++)for(r=l.slice(),t=0;o>t;t++)l[t]=r[u[e][t]];return l}function tn(n){var t,e,r,u,i,l,o=n,a=o.length,s=0;for(r=0;a>r;r++)s+=o[r].length;for(t=new Array(s),u=0,r=0;a>r;r++){for(i=o[r],l=i.length,e=0;l>e;e++)t[u+e]=u+i[e];u+=l}return t}function en(n,t){if(t=t||n.length,t!==n.length)return!1;var e,r,u=l(t,0,0);for(e=0;t>e;e++){if(r=n[e],0>r||r>=t||0<u[r])return!1;u[r]++}for(e=0;t>e;e++)if(1!==u[e])return!1;return!0}function rn(n){for(var t=n.length,e=0;t>e;e++)if(n[e]!==e)return!1;return!0}function un(n){for(var t=n.length,e=0,r=n[e];t>e;e++,r=n[e])if(0>r||r>=t||n[r]!==e)return!1;return!0}function ln(n,t){if(t=t||1,1>t)return!1;var e,r,u,i=n.length;for(e=0;i>e;e++){for(r=n[e],u=1;t>=u&&e!==r;)u++,r=n[r];if(e!==r||u!==t&&(u>=t||t%u>0))return!1}return!0}function on(n,t,e){t=0|t;for(var r=0,u=n.length,i=0;u>i;i++)if(n[i]===i&&r++,r>t)return!1;return!0===e?r===t:!0}function an(n){for(var t=n.length,e=1,r=n[0];t>e;e++)if(n[e]!==(r+e)%t)return!1;return!0}function sn(n){for(var t=n.length-1,e=-1,r=0,u=n[r];t>r;r++,u=n[r])if(u>e&&(e=u),r>=e)return!1;return!0}function cn(n,t,e){if(null==n)return null;var r=this,u=r.C,i=r.P,l=e&&null!=e.base?e.base:t,o=e&&null!=e.order?e.order:Tn;return n=qn&o?Nn&o?i(n):n:Xn&o?Nn&o?i(n):n:jn&o?Nn&o?u(n,l,e):i(u(n,l,e)):Nn&o?i(n):n}function fn(n,t,e,r,u,i){var l,o,a,s,c,f,d,m,h,_,p=t;if("tuple"===r?(l=p[0],p=p[1]):l=p.length,h=0,_=l-1,f=1,s=_,c=h,d=1,m=0,jn&u&&(f=-f,s=_-s,c=_-c,d=-d,m=_-m),Nn&u&&(f=-f,s=_-s,c=_-c,d=-d,m=_-m),Pn&u&&(e=-e),0>e)if("tuple"===r){for(o=s;o>=h&&_>=o&&0===n[o];)o-=f;if(o>=h&&_>=o)for(p-=1,n[o]=n[o]-1,a=o+f;a>=h&&_>=a;a+=f)n[a]=p;else n=null}else{for(o=s;o>=h&&_>=o&&0===n[o];)o-=f;if(o>=h&&_>=o)for(n[o]=n[o]-1,a=o+f;a>=h&&_>=a;a+=f)n[a]=p[d*a+m]-1;else n=null}else if("tuple"===r){for(o=s;o>=h&&_>=o&&n[o]+1===p;)o-=f;if(o>=h&&_>=o)for(n[o]=n[o]+1,a=o+f;a>=h&&_>=a;a+=f)n[a]=0;else n=null}else{for(o=s;o>=h&&_>=o&&n[o]+1===p[d*o+m];)o-=f;if(o>=h&&_>=o)for(n[o]=n[o]+1,a=o+f;a>=h&&_>=a;a+=f)n[a]=0;else n=null}return n}function dn(n,t,e,r,u,i,l){var o,a,s,c,f,d,m,h,_,p,b,v,g,y,x=t,A=null==i?x:i;if(g=0,y=x-1,h=1,m=y,_=1,p=0,b=1,v=0,jn&u&&(h=-h,m=y-m,_=-_,p=A-1-p,e=-e),Nn&u&&(h=-h,m=y-m,b=-1,v=A-1),Pn&u&&(e=-e),0>e)if("cyclic"===r)if(o=y-m,_*n[o]+p>0)for(b=x-1,h=x+h,s=0;x>s;s++)f=(_*n[o]+p+b)%x,n[o]=_*f+p,o=(o+h)%x;else n=null;else if("involution"===r)n=null;else do{for(d=!1,o=m-h;o>=g&&y>=o&&_*n[o]<=_*n[o+h];)o-=h;if(o>=g&&y>=o){for(a=m;a>=g&&y>=a&&h*(a-o)>0&&_*n[o]<=_*n[a];)a-=h;for(f=n[o],n[o]=n[a],n[a]=f,s=o+h,c=m;s>=g&&y>=s&&c>=g&&y>=c&&h*(c-s)>0;)f=n[s],n[s]=n[c],n[c]=f,d=d||b*s+v===n[s]||b*c+v===n[c],s+=h,c-=h;if("derangement"===r)for(a>=g&&y>=a&&(d=d||b*a+v===n[a]),c>=g&&y>=c&&(d=d||b*c+v===n[c]),d=d||b*o+v===n[o],s=o-h;!d&&s>=g&&y>=s;s-=h)d=b*s+v===n[s];else d=!1}else n=null}while(n&&d);else if("cyclic"===r)if(o=y-m,_*n[o]+p<x-1)for(b=x+1,h=x+h,s=0;x>s;s++)f=(_*n[o]+p+b)%x,n[o]=_*f+p,o=(o+h)%x;else n=null;else if("involution"===r)n=null;else do{for(d=!1,o=m-h;o>=g&&y>=o&&_*n[o]>=_*n[o+h];)o-=h;if(o>=g&&y>=o){for(a=m;a>=g&&y>=a&&h*(a-o)>0&&_*n[o]>=_*n[a];)a-=h;for(f=n[o],n[o]=n[a],n[a]=f,s=o+h,c=m;s>=g&&y>=s&&c>=g&&y>=c&&h*(c-s)>0;)f=n[s],n[s]=n[c],n[c]=f,d=d||b*s+v===n[s]||b*c+v===n[c],s+=h,c-=h;if("derangement"===r)for(a>=g&&y>=a&&(d=d||b*a+v===n[a]),c>=g&&y>=c&&(d=d||b*c+v===n[c]),d=d||b*o+v===n[o],s=o-h;!d&&s>=g&&y>=s;s-=h)d=b*s+v===n[s];else d=!1}else n=null}while(n&&d);return n}function mn(n,t,e,r,u){if(null==n)return null;var i,l=null;if("ordered"===u)for(l={},i=0;e>i;i++)l[n[i]]=1;return l}function hn(n,t,e,r,u,i){var l,o,a,s,c,f,d,m,h,_,p,b,v,g,y=t[1],x=t[0];if(d=0,m=y-1,f=1,c=m,h=1,_=0,p=1,b=0,jn&u&&(h=-h,_=x-1-_,f=-f,c=m-c,p=-p,b=m-b),Nn&u&&(f=-f,c=m-c,p=-p,b=m-b),Pn&u&&(e=-e),0>e)if("ordered+repeated"===r){for(l=c;l>=d&&m>=l&&0===n[l];)l-=f;if(l>=d&&m>=l)for(x-=1,n[l]=n[l]-1,o=l+f;o>=d&&m>=o;o+=f)n[o]=x;else n=null}else if("ordered"===r){for(null==i&&(i=mn(n,x,y,u,r)),l=c,a=-1;-1===a&&l>=d&&m>=l;){if(h*n[l]+_-h>=0)for(o=h*n[l]+_-h;o>=0&&x>o;o-=h)if(s=h*o+_,null==i[s]){a=l,i[s]=1;break}i[n[l]]=null,l-=f}if(a>-1)for(n[a]=s,o=x-1-_,s=h*o+_,l=a+f;l>=d&&m>=l;l+=f){for(;o>=0&&x>o&&null!=i[s];)o-=h,s=h*o+_;n[l]=s,i[s]=1}else n=null}else if(g="repeated"===r,v=g?0:1,jn&u)if(f=-f,c=m-c,p=-p,b=m-b,l=m-c,o=0>f?d:m,!g&&n[o]+1>y||g&&n[o]>0){if(g)for(;l>=d&&m>=l&&0===n[l];)l+=f;else for(;l>=d&&m>=l&&p*l+b===n[l];)l+=f;for(n[l]-=1,l-=f;l>=d&&m>=l;)n[l]=n[l+f]-v,l-=f}else n=null;else{for(a=-1,l=c;l-f>=d&&m>=l-f;l-=f)if(n[l]>n[l-f]+v){a=l;break}if(!(a>=d&&m>=a)&&0<n[0>f?m:d]&&(a=0>f?m:d),a>=d&&m>=a){for(s=x-1+v,l=c;l>=d&&m>=l&&f*(l-a)>0;l-=f)s-=v,n[l]=s;n[a]--}else n=null}else if("ordered+repeated"===r){for(l=c;l>=d&&m>=l&&n[l]+1===x;)l-=f;if(l>=d&&m>=l)for(n[l]=n[l]+1,o=l+f;o>=d&&m>=o;o+=f)n[o]=0;else n=null}else if("ordered"===r){for(null==i&&(i=mn(n,x,y,u,r)),l=c,a=-1;-1===a&&l>=d&&m>=l;){if(h*n[l]+_+h<x)for(o=h*n[l]+_+h;o>=0&&x>o;o+=h)if(s=h*o+_,null==i[s]){a=l,i[s]=1;break}i[n[l]]=null,l-=f}if(a>-1)for(n[a]=s,o=_,s=h*o+_,l=a+f;l>=d&&m>=l;l+=f){for(;o>=0&&x>o&&null!=i[s];)o+=h,s=h*o+_;n[l]=s,i[s]=1}else n=null}else if(g="repeated"===r,v=g?0:1,jn&u)if(f=-f,c=m-c,p=-p,b=m-b,l=m-c,!g&&n[l]+y<x||g&&n[l]+1<x){for(s=p*l+b;l+f>=d&&m>=l+f&&n[l]+v===n[l+f];)n[l]=s,l+=f,s+=v;n[l]+=1}else n=null;else{if(g){for(a=-1,o=x-1,l=c;l>=d&&m>=l;l-=f)if(n[l]<o){a=l;break}}else for(a=-1,o=x-y,l=c;l>=d&&m>=l;l-=f)if(n[l]<o+p*l+b){a=l;break}if(a>=d&&m>=a){if(s=n[a]+1,o=g?x-1:x-y+p*a+b,s===o)n[a]=s;else if(o>s)for(l=a;l>=d&&m>=l;l+=f)n[l]=s,s+=v}else n=null}return n}function _n(n,t,e){if(null==n)return null;var r=this,u=r.C,i=r.P,l=e&&null!=e.order?e.order:Tn;return n=qn&l?Nn&l?n:i(n):Xn&l?Nn&l?n:i(n):jn&l?Nn&l?i(u(n,t)):u(n,t):Nn&l?n:i(n)}function pn(n,t,e,r,u,i,o){if(jn&i)return null;var a,s,c,f,d,m,h,_,p,b,v=t;if(p=0,b=n.length-1,_=1,c=p,f=b,Nn&i&&(_=-_,c=b-c,f=b-f),Pn&i&&(e=-e),r&&!u&&(u=r,r=null),0>e)if(r)n=null;else if(s=u?c+_:c,s>=p&&b>=s&&n[s]>1){for(a=f,h=0;a>=p&&b>=a&&_*(a-s)>=0&&1===n[a];)h+=n[a],a-=_;m=n[a]-1,h++,n[a]=m,n=0>_?n.slice(a):n.slice(0,a+1),h>m?n=0>_?((h%=m)?[h]:[]).concat(l(In.floor(h/m),m)).concat(n):n.concat(l(In.floor(h/m),m),(h%=m)?[h]:[]):h>0&&(n=0>_?[h].concat(n):n.concat([h]))}else n=null;else if(r)n=null;else if(u?(m=In.min(u,v-u),d=In.floor(v/u)+(v%u?1:0)-1,m=b>d||n[c+(d-1)*_]<m,s=c+_):(m=n[c]<v,s=c),s>=p&&b>=s&&m){for(b>0?(a=f-_,h=n[f]):(a=f,h=0);a>=p&&b>=a&&a-_>=p&&b>=a-_&&_*(a-s)>0&&n[a]===n[a-_];)h+=n[a],a-=_;n[a]++,h--,n=h>0?0>_?l(h,1).concat(n.slice(a)):n.slice(0,a+1).concat(l(h,1)):0>_?n.slice(a):n.slice(0,a+1)}else n=null;return n}function bn(n,t,e,r,u,i,o){if(jn&i)return null;var a,s,c,f,d,m,h,_,p=t;if(h=0,_=n.length-1,m=1,s=h,c=_,Nn&i&&(m=-m,s=_-s,c=_-c),Pn&i&&(e=-e),0>e)if(r)if(u)n=null;else if(f=n[c],p-r+1>f){for(n[c]=1,a=c;a>=h&&_>=a&&1===n[a];)a-=m;n[a]--,a+m>=h&&_>=a+m&&(n[a+m]=1+f)}else n=null;else if(u)n=null;else if(p>n.length){for(a=c,d=0;a>=h&&_>=a&&1===n[a];)a-=m,d++;f=n[a]-1,n[a]=f,d++,d>0&&(a+m>=h&&_>=a+m?(a+=m,n[a]=d,d=0,n=0>m?n.slice(a):n.slice(0,a+1)):n=0>m?l(d,1,0).concat(n):n.concat(l(d,1,0)))}else n=null;else if(r)if(u)n=null;else if(p-r+1>n[s]){for(a=c;a>=h&&_>=a&&1===n[a];)a-=m;f=n[a],n[a]=1,n[c]=f-1,a-m>=h&&_>=a-m&&n[a-m]++}else n=null;else u?n=null:p>n[s]?(d=n[c],n[c-m]++,0>m?(n.shift(),n.unshift.apply(n,l(d-1,1,0))):(n.pop(),n.push.apply(n,l(d-1,1,0)))):n=null;return n}var vn,gn,yn,xn,An,wn,Mn={VERSION:"0.8.0"},In=Math,On="prototype",Cn="constructor",En=Array.prototype.slice,Ln=Object[On].hasOwnProperty,Sn=Object[On].toString,Rn=In.log2||function(n){return In.log(n)/In.LN2},Dn=/^\s+|\s+$/g,kn=(String.prototype.trim?function(n){return n.trim()}:function(n){return n.replace(Dn,"")},Object.create),Un=function(n,t){for(var e in t)Ln.call(t,e)&&(n[e]=t[e]);return n},$n=function(n,t){1===arguments.length&&(t=n,n=Object);var e=t[Cn];return Ln.call(t,"__static__")&&(e=Un(e,t.__static__),delete t.__static__),e[On]=Un(kn(n[On]),t),e},Pn=1,Nn=2,Tn=4,jn=8,Xn=16,qn=32,Jn=Tn|jn|Xn,Vn=Jn|qn|Pn|Nn;return C.mem1={},C.mem2={},C.mem3={},E.mem={},L.mem={},S.mem={},R.mem={},Mn.Class=$n,Mn.Options={MAXMEM:1e6,RANDOM:"index"},D.LEX=D.LEXICOGRAPHIC=Tn,D.COLEX=D.COLEXICOGRAPHIC=jn,D.MINIMAL=D.GRAY=Xn,D.RANDOM=qn,D.REV=D.ANTI=D.REVERSE=D.REVERSED=Pn,D.REF=D.REFLECT=D.REFLECTED=Nn,D.REVLEX=D.ANTILEX=D.REVERSELEXICOGRAPHIC=D.ANTILEXICOGRAPHIC=Tn|Pn,D.REFLEX=D.REFLECTEDLEXICOGRAPHIC=Tn|Nn,D.REVCOLEX=D.ANTICOLEX=D.REVERSECOLEXICOGRAPHIC=D.ANTICOLEXICOGRAPHIC=jn|Pn,D.REFCOLEX=D.REFLECTEDCOLEXICOGRAPHIC=jn|Nn,Mn.ORDER=D,Mn.Math={O:0,I:1,J:-1,N:function(n){return Mn.Arithmetic.add(Mn.Arithmetic.O,n)},V:function(n){return Mn.Arithmetic.sub(Mn.Arithmetic.O,n)},rnd:In.random,rndInt:function(n,t){return Mn.Math.round((t-n)*Mn.Math.rnd()+n)},equ:function(n,t){return n===t},gte:function(n,t){return n>=t},lte:function(n,t){return t>=n},gt:function(n,t){return n>t},lt:function(n,t){return t>n},inside:function(n,t,e,r){return r?n>=t&&e>=n:n>t&&e>n},clamp:function(n,t,e){return t>n?t:n>e?e:n},wrap:function(n,t,e){return t>n?e:n>e?t:n},wrapR:function(n,t){return 0>n?n+t:n},add:x,sub:function(n,t){return n-t},mul:A,div:function(n,t){return Mn.Math.floor(n/t)},mod:function(n,t){return n%t},pow:In.pow,shl:function(n,t){return n<<t},shr:function(n,t){return n>>t},bor:function(n,t){return n|t},band:function(n,t){return n&t},xor:function(n,t){return n^t},abs:In.abs,min:In.min,max:In.max,floor:In.floor,ceil:In.ceil,round:In.round,num:function(n){return"number"==typeof n?Mn.Math.floor(n):parseInt(n,10)},val:function(n){return Mn.Math.floor(n.valueOf())},sum:w,product:M,pow2:I,exp:O,factorial:C,partitions:L,compositions:R},Mn.Arithmetic={isDefault:function(){return 0===Mn.Arithmetic.O&&Mn.Arithmetic.add===x},O:0,I:1,J:-1,N:Mn.Math.N,V:Mn.Math.V,equ:Mn.Math.equ,gte:Mn.Math.gte,lte:Mn.Math.lte,gt:Mn.Math.gt,lt:Mn.Math.lt,inside:Mn.Math.inside,clamp:Mn.Math.clamp,wrap:Mn.Math.wrap,wrapR:Mn.Math.wrapR,add:Mn.Math.add,sub:Mn.Math.sub,mul:Mn.Math.mul,div:Mn.Math.div,mod:Mn.Math.mod,pow:Mn.Math.pow,shl:Mn.Math.shl,shr:Mn.Math.shr,bor:Mn.Math.bor,band:Mn.Math.band,xor:Mn.Math.xor,abs:Mn.Math.abs,min:Mn.Math.min,max:Mn.Math.max,floor:Mn.Math.floor,ceil:Mn.Math.ceil,round:Mn.Math.round,rnd:Mn.Math.rndInt,num:Mn.Math.num,val:Mn.Math.val},Mn.Util={array:l,operate:i,intersection:h,difference:_,union:p,search:y,conjugation:a,parity:s,inversion:c,gray:f,finitedifference:d,partialsum:m,sort:b,shuffle:v,pick:g,pluck:o},Mn.BitArray=$n({constructor:function Gn(n){var t=this;return t instanceof Gn?(t.length=n,void(t.bits=new Uint32Array(In.ceil(n/32)))):new Gn(n)},length:0,bits:null,dispose:function(){var n=this;return n.length=null,n.bits=null,n},clone:function(){var n=this,t=new Mn.BitArray(n.length);return t.bits=new Uint32Array(n.bits),t},fromArray:function(n){var t=this;return t.bits=new Uint32Array(n),t},toArray:function(){return En.call(this.bits)},toString:function(){var n,t,e=this.toArray();for(n=0,t=e.length;t>n;n++)e[n]=u(e[n]);return e.join("")},reset:function(){var n,t=this,e=t.bits,r=e.length;for(n=0;r>n;n++)e[n]=0;return t},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){var t=this;return t.bits[n>>>5]|=1<<(31&n),t},unset:function(n){var t=this;return t.bits[n>>>5]&=~(1<<(31&n)),t},toggle:function(n){var t=this;return t.bits[n>>>5]^=1<<(31&n),t}}),vn=Mn.CombinatorialIterator=$n({constructor:function Hn(n,t,e){var r=this,u=r[Cn],i=Mn.Arithmetic;r.name=n||"CombinatorialIterator",r.n=t||0,r.$=e=e||{},e.type=String(e.type||"default").toLowerCase(),e.order=e.order||Tn,e.base=e.base||0,e.minbase=null!=e.minbase?e.minbase:e.base,e.maxbase=null!=e.maxbase?e.maxbase:e.base,e.dimension=e.dimension||0,e.mindimension=null!=e.mindimension?e.mindimension:e.dimension,e.maxdimension=null!=e.maxdimension?e.maxdimension:e.dimension,e.rand=e.rand||{},e.count=u.count(r.n,r.$),e.first=i.O,e.last=i.gt(e.count,i.O)?i.sub(e.count,i.I):i.J,e.sub instanceof Hn&&(e.subcount=Mn.Arithmetic.mul(e.count,e.sub.total()),e.submethod=String(e.submethod||"project").toLowerCase(),e.subcascade=-1===e.subcascade?-1:1,"concatenate"===e.submethod?e.subdimension=e.dimension+e.sub.dimension():"compose"===e.submethod?e.subdimension=e.dimension*e.sub.dimension():e.subdimension=e.dimension),e.instance=r,r.order(e.order)},__static__:{Iterable:function Fn(n,t){var e=this;return e instanceof Fn?(t=-1===t?-1:1,void(e.next=function(){return n.hasNext(t)?{value:n.next(t)}:{done:!0}})):new Fn(n,t)},C:function(n,t){return a(n,n,t)},P:function(n){return s(n)},T:function(n,t){return c(n,t)},DUAL:cn,count:t,initial:t,succ:function(n,t,e,r,u,i){if(null==e||null==n||null==t)return null;var l=this,o=Mn.Arithmetic;r&&null!=r.order?r.order:Tn;return u=-1===u?-1:1,l.unrank(o.add(t,0>u?o.J:o.I),e,r)},rand:function(n,t){var e,r=this,u=Mn.Arithmetic,i=t&&null!=t.last?t.last:u.sub(r.count(n,t),u.I),l=u.O,o=u.rnd(l,i);return e=u.equ(l,o)?r.initial(n,t,1):u.equ(i,o)?r.initial(n,t,-1):r.unrank(o,n,t)},rank:t,unrank:t,cascade:function(n,t,e,r){if(-1===r){var u=n;n=t,t=u}return"concatenate"===e?n&&t?n.concat(t):n||t||null:"compose"===e?n&&t?k(!0,n,t):n||t||null:null==n||null==t?null:l(n.length,function(e){return n[e]<t.length?t[n[e]]:null})},output:function(n,t,e,r){return null==n?null:n.slice()}},name:"CombinatorialIterator",n:0,$:null,__index:null,_index:null,__item:null,item__:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var t=this;return!0!==n&&t.$.sub&&(t.$.sub.dispose(),t.$.sub=null),t.name=null,t.n=null,t.$=null,t.__index=null,t._index=null,t.__item=null,t.item__=null,t._item=null,t.__subindex=null,t._subindex=null,t.__subitem=null,t._subitem=null,t._prev=null,t._next=null,t._traversed&&(t._traversed.dispose(),t._traversed=null),t},base:function(n){var t=this.$;return t.sub&&!0!==n?t.subbase||t.base||0:t.base||0},dimension:function(n){var t=this.$;return t.sub&&!0!==n?t.subdimension||t.dimension||0:t.dimension||0},total:function(n){var t=this.$;return t.sub&&!0!==n?t.subcount||t.count||0:t.count||0},_init:function(n){var t,e,r,u=this,i=u[Cn],l=u.$,o=u.n,a=Mn.Arithmetic,s=a.O,c=(a.I,l.order);return u.__index=u._index=s,u._item=u.__item=u.item__=null,u._prev=!1,u._next=!1,e=l.count,r=l.last,qn&c?("gen"===Mn.Options.RANDOM||1===l.rand[l.type]||a.gt(e,Mn.Options.MAXMEM)||a.isDefault()&&0>e?(u.__item=i.rand(o,l),u.__index=s):(u._traversed&&u._traversed.dispose(),u._traversed=new Mn.BitArray(a.val(e)),t=u.random("index"),u._traversed.set(+t),u.__item=i.unrank(t,o,l),null!=u.__item&&(u.__index=t)),u._index=s):(u.__item=i.initial(o,l,n),null!=u.__item&&(u.__index=0>n?r:s,u._update()),u._index=u.__index),u._item=i.output(u.__item,u.__index,o,l),u._prev=qn&c||n>0?!1:null!=u.__item,u._next=0>n&&!(qn&c)?!1:null!=u.__item,u},_update:function(){return this.item__=null,this},order:function(n,t){if(!arguments.length)return this._order;var e,u,i,l,o,a=this,s=a[Cn],c=Mn.Arithmetic,f=(c.O,c.I,!0===n);return t=-1===t,i=a.n,l=a.$,a._traversed&&(a._traversed.dispose(),a._traversed=null),f?n=l.order:r(n)&&-1<(u=n.indexOf("|"))?(e=n.substr(u+1),n=D(n.substr(0,u))):e=n=D(n),o=t?-1:1,l.order=n,l.sub?(f?l.sub.rewind(o):l.sub.order(e,o),a.__subindex=l.sub.index(),a.__subitem=l.sub.next(o),a._subindex=null,a._subitem=null):(a.__subindex=null,a.__subitem=null,a._subindex=null,a._subitem=null),a._init(o),l.sub&&(a._prev=a._prev&&null!=a.__subitem,a._next=a._next&&null!=a.__subitem,a._subindex=c.add(c.mul(a.__subindex,l.count),a._index),a._subitem=s.cascade(a._item,a.__subitem,l.submethod,l.subcascade)),a},index:function(n,t){if(t=!0===t,!arguments.length)return this.$.sub?this._subindex:this._index;var e,r=this,u=r[Cn],i=Mn.Arithmetic,l=i.O,o=(i.I,i.J),a=r.n,s=r.$,c=s.sub&&!t?s.subcount:s.count,f=s.sub&&!t?r._subindex:r._index,d=s.order;return n=i.wrapR(i.N(n),c),!i.equ(n,f)&&i.inside(n,o,c)&&(c=s.count,e=s.last,s.sub&&!t&&(s.sub.index(i.div(n,c)),r.__subindex=s.sub.index(),r.__subitem=s.sub.item(),n=i.mod(n,c)),qn&d||(r.__index=n,r._index=n,r.__item=i.equ(l,n)?u.initial(a,s,1):i.equ(e,n)?u.initial(a,s,-1):u.unrank(n,a,s),r._update(),r._item=u.output(r.__item,r.__index,a,s),r._prev=null!=r.__item,r._next=null!=r.__item),s.sub&&(r._prev=r._prev&&null!=r.__subitem,r._next=r._next&&null!=r.__subitem,r._subindex=i.add(i.mul(r.__subindex,c),r._index),r._subitem=u.cascade(r._item,r.__subitem,s.submethod,s.subcascade))),r},item:function(n,t){if(!arguments.length)return this.$.sub?this._subitem:this._item;var u,i,l,o,a,s,c=this,f=c[Cn],d=c.n,m=c.$,h=m.sub?m.subcount:m.count,_=m.sub?c._subindex:c._index,p=Mn.Arithmetic,b=p.O,v=(p.I,p.J),g=null;return r(t)?-1<(s=t.indexOf("|"))?(g=t.substr(s+1),t=D(t.substr(0,s))):g=t=D(t):null!=t?g=t=D(t):(t=m.order,g=null),m.sub||(g=null),e(n)?(h=m.count,u=m.last,l=m.order,m.order=t,c.__item=n.slice(),c._update(),c.__index=f.rank(c.__item,d,m),c._item=f.output(c.__item,c.__index,d,m),qn&t?c._index=c.__index:c._index=c.__index,c._prev=null!=c.__item,c._next=null!=c.__item,c):(n=p.wrapR(p.N(n),h),t===m.order&&null===g&&p.equ(n,_)?m.sub?c._subitem:c._item:p.inside(n,v,h)?(a=null,h=m.count,u=m.last,m.sub&&(a=m.sub.item(p.div(n,h),g),n=p.mod(n,h)),qn&t?(i=null,l=m.order,m.order=t,o=f.output(f.rand(d,m),i,d,m),m.order=l,m.sub&&(o=f.cascade(o,a,m.submethod,m.subcascade)),o):(i=n,l=m.order,m.order=t,o=f.output(p.equ(b,n)?f.initial(d,m,1):p.equ(u,n)?f.initial(d,m,-1):f.unrank(i,d,m),i,d,m),m.order=l,m.sub&&(o=f.cascade(o,a,m.submethod,m.subcascade)),o)):null)},random:function(n,t,e,r){var u,i=this,l=i[Cn],o=i.$,a=o.order;if(r=!0===r,"index"===n){var s,c,f=Mn.Arithmetic,d=f.N,m=f.O,h=f.I;return t===!!t&&(r=t,t=null,e=null),o.sub&&!r?(s=o.subcount,c=f.sub(s,h)):(s=o.count,c=o.last),null==t&&null==e?(t=m,e=c):null==e?(t=d(t||0),e=c):(t=d(t),e=d(e)),f.rnd(t,e)}return o.order|=qn,u=l.rand(i.n,o),o.order=a,u=l.output(u,null,i.n,o),o.sub&&!r?l.cascade(u,o.sub.random(),o.submethod,o.subcascade):u},rewind:function(n){var t=this;return t.order(!0,-1===n?-1:1)},hasNext:function(n){var t=this;return-1===n?qn&t.$.order?!1:t._prev:t._next},next:function(n){var t,e,r,u,i,l,o=this,a=o[Cn],s=Mn.Arithmetic,c=s.O,f=s.I,d=s.J,m=o.n,h=o.$,_=h.order,p=h.count,b=h.sub?o._subitem:o._item,v=null!=b;
if(n=-1===n?-1:1,0>n&&qn&_)return null;if(t=0>n?d:f,qn&_)if(u=h.last,s.lt(o._index,u))if(e=o._traversed){for(r=o.random("index"),i=Mn.Math.rnd()>.5?d:f;e.isset(+r);)r=s.wrap(s.add(r,i),c,u);e.set(+r),o.__item=a.unrank(r,m,h),null!=o.__item&&(o.__index=r)}else o.__item=a.rand(m,h),o.__index=null;else o._item=o.__item=null,o._traversed&&(o._traversed.dispose(),o._traversed=null);else o.__item=a.succ(o.__item,o.__index,m,h,n,o.item__),null!=o.__item&&(o.__index=s.add(o.__index,t));return l=null!=o.__item,l?(o._index=s.add(o._index,t),null===o.__index&&(o.__index=o._index),0>n?(o._prev=l,o._next=v):(o._prev=v,o._next=l)):h.sub&&h.sub.hasNext(n)?(o.__subindex=h.sub.index(),o.__subitem=h.sub.next(n),o._init(n),l=null!=o.__item):(o.__subindex=null,o.__subitem=null,0>n?(o._prev=l,o._next=v):(o._prev=v,o._next=l)),o._item=a.output(o.__item,o.__index,m,h),h.sub&&(l=l&&null!=o.__subitem,o._subindex=l?s.add(s.mul(o.__subindex,p),o._index):null,o._subitem=l?a.cascade(o._item,o.__subitem,h.submethod,h.subcascade):null,0>n?o._prev=l:o._next=l),b},range:function(n,t){var e,r,u,l,o=this,a=Mn.Arithmetic,s=a.N,c=a.O,f=a.I,d=o.$,m=d.sub?d.subcount:d.count,h=d.sub?a.sub(m,f):d.last,_=1,p=arguments.length,b=!(qn&d.order);return 1>p?(n=c,t=h):2>p?(n=s(n),t=h):(n=s(n),t=s(t)),n=a.wrapR(n,m),t=a.wrapR(t,m),a.gt(n,t)&&(e=n,n=t,t=e,_=-1),n=a.clamp(n,c,h),b&&(t=a.clamp(t,c,h)),a.lte(n,t)?(l=[o.$.order,o.__index,o._index,o.__item&&o.__item.slice(),o._item,o.__subindex,o._subindex,o.__subitem,o._subitem,o._prev,o._next],b&&o.index(n),u=a.val(a.sub(t,n)),r=i(function(n,t,e){return n[e]=o.next(),n},new Array(u+1),null,0>_?u:0,0>_?0:u,0>_?-1:1),o.$.order=l[0],o.__index=l[1],o._index=l[2],o.__item=l[3],o._item=l[4],o.__subindex=l[5],o._subindex=l[6],o.__subitem=l[7],o._subitem=l[8],o._prev=l[9],o._next=l[10],o._update()):r=[],r},__iter__:function(){return new vn.Iterable(this)}}),"undefined"!=typeof Symbol&&"undefined"!=typeof Symbol.iterator&&(vn[On][Symbol.iterator]=vn[On].__iter__),gn=Mn.Tensor=$n(vn,{constructor:function Bn(){var n,t=this,r=En.call(arguments);if(n=!r.length||r[r.length-1]instanceof vn||e(r[r.length-1])||r[r.length-1]===+r[r.length-1]?{}:r.pop()||{},n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||Tn,r.length&&e(r[0])&&(r=r[0]),r&&r.length||(r=[]),!(t instanceof Bn))return new Bn(r,n);if("tuple"===n.type)r[0]=r[0]||1,r[1]=r[1]||1,r[0]instanceof vn?(n.sub=r[0],r[0]=n.sub.dimension()):r[1]instanceof vn&&(n.sub=r[1],r[1]=n.sub.base()),n.base=r[1],n.dimension=r[0];else{var u=i(function(n,t){return t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t),n},[1/0,0],r);n.base=r,n.minbase=u[0],n.maxbase=u[1],n.dimension=r.length}vn.call(t,"Tensor",r,n)},__static__:{C:vn.C,P:vn.P,T:vn.T,DUAL:cn,count:function(n,t){var e=Mn.Arithmetic.O,r=t&&t.type?t.type:"tensor";return"tuple"===r?!n||0>=n[0]?e:Mn.Math.exp(n[0],n[1]):n&&n.length?Mn.Math.product(n):e},initial:function(n,t,e){var r,u=this,i=t&&t.type?t.type:"tensor",o=t&&t.order?t.order:Tn;return e=-1===e?-1:1,(Tn&o&&Pn&o||jn&o&&!(Pn&o))&&(e=-e),r="tuple"===i?n[0]?0>e?l(n[0],n[1]-1,0):l(n[0],0,0):[]:n.length?0>e?l(n.length,function(t){return n[t]-1}):l(n.length,0,0):[],r=u.DUAL(r,n,t)},succ:function(n,t,e,r,u,i){return!e||!e[0]||0>=e[0]||null==n?null:(u=-1===u?-1:1,fn(n,e,u,r&&r.type?r.type:"tensor",r&&null!=r.order?r.order:Tn,i))},rand:function(n,t){var e,r=Mn.Math.rndInt,u=this,i=t&&t.type?t.type:"tensor";return e="tuple"===i?n[0]?l(n[0],function(t){return r(0,n[1]-1)}):[]:n.length?l(n.length,function(t){return r(0,n[t]-1)}):[],e=u.DUAL(e,n,t)},randu:vn.rand,rank:function(n,t,e){var r,u,i,l=this,o=Mn.Arithmetic,a=e&&null!=e.order?e.order:Tn,s=e&&e.type?e.type:"tensor",c=o.add,f=o.sub,d=o.mul,r=o.O,m=o.J;if(n=l.DUAL(n,t,e),"tuple"===s){if(u=t[0],!u)return m;for(t=t[1],i=0;u>i;i++)r=c(d(r,t),n[i])}else{if(u=t.length,!u)return m;for(i=0;u>i;i++)r=c(d(r,t[i]),n[i])}return(Tn&a&&Pn&a||jn&a&&!(Pn&a))&&(r=f(e&&null!=e.last?e.last:f(l.count(t,e),o.I),r)),r},unrank:function(n,t,e){var r,u,i,l,o,a,s=this,c=Mn.Arithmetic,f=e&&null!=e.order?e.order:Tn,d=e&&e.type?e.type:"tensor",m=c.sub,h=c.mod,_=c.div,p=c.val;if((Tn&f&&Pn&f||jn&f&&!(Pn&f))&&(n=m(e&&null!=e.last?e.last:m(s.count(t,e),c.I),n)),"tuple"===d){if(a=t[0],!a)return[];for(o=new Array(a),u=t[1],r=n,i=a-1;i>=0;i--)l=h(r,u),r=_(r,u),o[i]=p(l)}else{if(a=t.length,!a)return[];for(o=new Array(a),r=n,i=a-1;i>=0;i--)u=t[i],l=h(r,u),r=_(r,u),o[i]=p(l)}return o=s.DUAL(o,t,e)},cascade:vn.cascade,output:vn.output,gray:f,product:k,component:function(n,t){var e,r,u,i,l,o,a=[],s=t,c=s.length;for(e=0;c>e;e++)if(u=s[e],l=n[e],i=u[l],i instanceof Array)for(r=0,o=i.length;o>r;r++)a.push(i[r]);else a.push(i);return a}}}),yn=Mn.Permutation=$n(vn,{constructor:function Yn(n,t){var r=this;return r instanceof Yn?(t=t||{},t.type=String(t.type||"permutation").toLowerCase(),n=n||1,n instanceof vn&&(t.sub=n,n=t.sub.dimension()),t.base=t.dimension=n,t.rand={derangement:1,involution:1},"multiset"===t.type&&(t.multiplicity=e(t.multiplicity)&&t.multiplicity.length?t.multiplicity.slice():l(n,1,0),t.multiplicity=t.multiplicity.concat(l(n-i(x,0,t.multiplicity),1,0)),t.base=t.multiplicity.length,t.multiset=J(t.multiplicity,n)),void vn.call(r,"Permutation",n,t)):new Yn(n,t)},__static__:{C:vn.C,P:vn.P,T:vn.T,DUAL:cn,count:function(n,t){var e=Mn.Arithmetic.O,r=Mn.Math.factorial,u=t&&t.type?t.type:"permutation";return 0>=n?e:"cyclic"===u?Mn.Arithmetic.N(n):"multiset"===u?r(n,t.multiplicity):"derangement"===u?2>n?e:r(n,!1):"involution"===u?r(n,!0):r(n)},initial:function(n,t,e){var r,u=this,i=t&&t.type?t.type:"permutation",o=t&&null!=-t.order?t.order:Tn;if(0>=n)return null;if(e=-1===e?-1:1,(Tn&o&&Pn&o||jn&o&&!(Pn&o))&&(e=-e),"cyclic"===i)r=0>e?[n-1].concat(l(n-1,0,1)):l(n,0,1);else if("derangement"===i){if(2>n)return null;if(1&n){var a=In.floor(n/2);r=0>e?l(n-a-1,n-1,-1).concat([a-1,a]).concat(l(a-1,a-2,-1)):l(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=0>e?l(n,n-1,-1):l(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===i?0>e?t.multiset.slice().reverse():t.multiset.slice():0>e?l(n,n-1,-1):l(n,0,1);return r=u.DUAL(r,n,t)},succ:function(n,t,e,r,u,i){if(!e||0>=e||null==n)return null;var l=r&&r.type?r.type:"permutation";return u=-1===u?-1:1,dn(n,e,u,l,r&&null!=r.order?r.order:Tn,r&&null!=r.base?r.base:null,i)},rand:function(n,t){var e,r=Mn.Math.rndInt,u=this,i=t&&t.type?t.type:"permutation";if("cyclic"===i){var o=r(0,n-1);e=o>0?l(n-o,o,1).concat(l(o,0,1)):l(n,0,1)}else if("derangement"===i){e=new Array(n);var a,s,c,f=!1;do{for(a=0;n>a;a++)e[a]=a;for(a=n-1,f=!1;a>=0;){if(c=r(0,a),e[c]===a){f=!0;break}s=e[a],e[a]=e[c],e[c]=s,a--}f=f||0===e[0]}while(f)}else if("involution"===i){e=l(n,0,1);for(var d,m,h,_,s,p,b=Mn.Math.rnd,g=.5,y=1,x=n,A=[1].concat(l(n-1,function(){var n=g;return y+=1,g=1/(1+y*g),n})),w=l(n,0,1);x>=2;)d=x-1,m=w[d],--x,g=A[x],s=b(),s>g&&(h=r(0,x-1),_=w[h],--x,p=w[h],w[h]=w[x],w[x]=p,p=e[_],e[_]=e[m],e[m]=p)}else e=v("multiset"===i?t.multiset.slice():l(n,0,1));return e=u.DUAL(e,n,t)},randu:vn.rand,rank:function(n,e,r){var u,i,l,o,a,s=this,c=Mn.Arithmetic,f=r&&r.type?r.type:"permutation",d=r&&null!=-r.order?r.order:Tn,m=c.sub,h=c.add,_=c.mul,p=c.div,b=c.O,v=c.I;if(e=e||n.length,!e)return c.J;if(n=s.DUAL(n,e,r),"cyclic"===f)b=c.NUM(n[0]);else{if("derangement"===f||"involution"===f)return t();if("multiset"===f)for(a=r.multiplicity.slice(),o=r&&null!=r.count?r.count:Mn.Math.factorial(e,a),l=e-1,u=0;l>u&&c.gt(o,v);u++)i=n[u],b=h(b,p(_(o,w(a,0,i-1,1)),e-u)),o=p(_(o,a[i]),e-u),a[i]--;else for(n=Y(null,n),l=e-1,u=0;l>u;u++)b=h(_(b,e-u),n[u])}return(Tn&d&&Pn&d||jn&d&&!(Pn&d))&&(b=m(r&&null!=r.last?r.last:m(s.count(e,r),v),b)),b},unrank:function(n,e,r){var u,i,o,a,s,c,f,d,m=this,h=Mn.Arithmetic,_=r&&r.type?r.type:"permutation",p=r&&null!=-r.order?r.order:Tn,b=h.mod,v=h.div,g=h.mul,y=h.sub,x=h.val;if(!e)return[];if((Tn&p&&Pn&p||jn&p&&!(Pn&p))&&(n=y(r&&null!=r.last?r.last:y(m.count(e,r),h.I),n)),"cyclic"===_)n=x(n),u=l(e,function(t){return(n+t)%e});else{if("derangement"===_||"involution"===_)return t();if("multiset"===_)for(d=r.multiplicity.slice(),u=l(e),f=r&&null!=r.count?r.count:Mn.Math.factorial(e,d),o=0;e>o;o++){for(s=0,a=0,i=x(v(g(n,e-o),f));a<d.length&&s+d[a]<=i;)s+=d[a++];n=y(n,v(g(f,s),e-o)),f=v(g(f,d[a]),e-o),d[a]--,u[o]=a}else{for(u=l(e),u[e-1]=0,i=n,o=e-2;o>=0;o--)s=e-o,c=b(i,s),i=v(i,s),u[o]=x(c);z(u,u)}}return u=m.DUAL(u,e,r)},cascade:vn.cascade,output:vn.output,permute:function(n,t,e){var r,u,i,o=n.length;for(!0===e?(u=l(o),i=n):(u=n,i=n.slice()),r=0;o>r;r++)u[r]=i[t[r]];return u},shuffle:function(n,t){if(!0===t){var e=n.length,r=Mn.Math.rndInt(0,e-1);return r>0&&n.push.apply(n,n.splice(0,r)),n}return v(n)},compose:function(){return nn(En.call(arguments))},concatenate:function(){return tn(En.call(arguments))},cycles:function(n,t){return-1===t?cycles2permutation(n):Q(n)},swaps:function(n,t){return-1===t?Z(n):W(n)},inversion:function(n,t){return-1===t?z(null,n):Y(null,n)},inverse:function(n){return B(null,n)},multiset:function(n,t,e){return n===+n?J(t,n,-1===e?-1:1):-1===e?H(n):F(n,t)},matrix:function(n,t,e){return-1===e?G(null,n,t):V(null,n,t)},parity:t,is_permutation:en,is_identity:rn,is_cyclic:an,is_derangement:on,is_involution:un,is_kthroot:ln,is_indecomposable:sn,is_connected:sn}}),xn=Mn.Combination=$n(vn,{constructor:function zn(n,t,r){var u=this;if(!(u instanceof zn))return new zn(n,t,r);if(e(n)?(r=t||{},t=n[1]||1,n=n[0]||1):(r=r||{},n=n||1,t=t||1),r.type=String(r.type||"unordered").toLowerCase(),-1<r.type.indexOf("+")){var i=r.type.split("+");i.sort(),r.type=i.join("+")}t instanceof vn?(r.sub=t,t=r.sub.dimension()):n instanceof vn&&(r.sub=n,n=r.sub.base()),r.base=n,r.dimension=t,vn.call(u,"Combination",[n,t],r)},__static__:{C:vn.C,P:vn.P,T:vn.T,DUAL:cn,count:function(n,t){var e=Mn.Math.factorial,r=t&&t.type?t.type:"unordered";return"ordered+repeated"===r?Mn.Math.exp(n[0],n[1]):"repeated"===r?e(n[0]+n[1]-1,n[1]):"ordered"===r?e(n[0],-n[1]):e(n[0],n[1])},initial:function(n,t,e){var r,u=this,i=t&&t.type?t.type:"unordered",o=t&&null!=t.order?t.order:Tn;return e=-1===e?-1:1,(Tn&o&&Pn&o||jn&o&&!(Pn&o))&&(e=-e),r="ordered+repeated"===i||"repeated"===i?0>e?l(n[1],n[0]-1,0):l(n[1],0,0):"ordered"===i?0>e?l(n[1],n[0]-1,-1):l(n[1],0,1):0>e?l(n[1],n[0]-n[1],1):l(n[1],0,1),r=u.DUAL(r,n,t)},succ:function(n,t,e,r,u,i){return!e||!e[0]||0>=e[0]||null==n?null:(u=-1===u?-1:1,hn(n,e,u,r&&r.type?r.type:"unordered",r&&null!=r.order?r.order:Tn,i))},rand:function(n,t){var e,r,u,i,o=this,a=t&&t.type?t.type:"unordered",s=n[1],c=Mn.Math.rndInt;return n=n[0],r=n-s,u=n-1,"repeated"===a||"ordered+repeated"===a?(e=1===s?[c(0,u)]:l(s,function(){return c(0,u)}),s>1&&"repeated"===a&&b(e)):"ordered"===a?(i={},e=1===s?[c(0,u)]:n===s?v(l(s,0,1)):l(s,function(){for(var t=c(0,u);1===i[t];)t=(t+1)%n;return i[t]=1,t})):(i={},e=1===s?[c(0,u)]:n===s?l(s,0,1):s>r?_(null,n,b(l(r,function(){for(var t=c(0,u);1===i[t];)t=(t+1)%n;return i[t]=1,t}))):b(l(s,function(){for(var t=c(0,u);1===i[t];)t=(t+1)%n;return i[t]=1,t}))),e=o.DUAL(e,n,t)},randu:vn.rand,rank:function(n,t,e){var r,u,i,l,o,a=this,s=Mn.Arithmetic,c=s.add,f=s.sub,d=s.mul,m=s.O,h=s.I,_=m,p=t[1],b=e&&null!=e.order?e.order:Tn,v=e&&e.type?e.type:"unordered",g=Mn.Math.factorial;if(n=a.DUAL(n,t,e),"ordered+repeated"===v)for(l=t[0],r=0;p>r;r++)_=c(d(_,l),n[r]);else if("repeated"===v){for(l=t[0]+p-1,o=e&&e.count?e.count:g(l,p),r=1;p>=r;r++)u=l-1-n[r-1]-r+1,i=p+1-r,u>=i&&(_=c(_,g(u,i)));_=f(f(o,h),_)}else if("ordered"===v)for(l=t[0],n=Y(null,n,l),r=0;p>r;r++)_=c(d(_,l-r),n[r]);else{for(l=t[0],o=e&&e.count?e.count:g(l,p),r=1;p>=r;r++)u=l-1-n[r-1],i=p+1-r,u>=i&&(_=c(_,g(u,i)));_=f(f(o,h),_)}return(Tn&b&&Pn&b||jn&b&&!(Pn&b))&&(_=f(e&&null!=e.last?e.last:f(a.count(t,e),h),_)),_},unrank:function(n,t,e){var r,u,i,o,a,s,c,f=this,d=Mn.Arithmetic,m=d.O,h=d.I,_=d.sub,p=d.div,b=d.mod,v=d.mul,g=d.lte,y=d.gt,x=d.val,A=t[1],w=e&&e.type?e.type:"unordered",M=e&&null!=e.order?e.order:Tn;if(t=t[0],(Tn&M&&Pn&M||jn&M&&!(Pn&M))&&(n=_(e&&null!=e.last?e.last:_(f.count(t,e),d.I),n)),r=l(A),"ordered+repeated"===w)for(o=n,s=A-1;s>=0;s--)a=b(o,t),o=p(o,t),r[s]=x(a);else if("ordered"===w){for(o=n,s=A-1;s>=0;s--)i=t-s,a=b(o,i),o=p(o,i),r[s]=x(a);z(r,r,i)}else{c="repeated"===w,i=c?t+A-1:t,u=e&&e.count?e.count:Mn.Math.factorial(i,A),n=_(_(u,h),n),u=p(v(u,i-A),i),a=i-A+1,o=A,s=i-1;do g(u,n)?(r[A-o]=c?i-a-A+1:i-a-o+1,y(u,m)&&(n=_(n,u),u=p(v(u,o),s)),o--,s--):(u=p(v(u,s-o),s),a--,s--);while(o>0)}return r=f.DUAL(r,t,e)},cascade:vn.cascade,output:function(n,t,e,r){return null==n?null:n=r&&"binary"===r.type?U(n,e[0]):n.slice()},complement:function(n,t,e){return!0===e?v(_(null,t,b(n))):_(null,t,n)},binary:function(n,t,e){return-1===e?$(n,t):U(n,t)},pick:function(n,t,e){return t>0&&n.length?g(n,t,"ordered+repeated"!==e&&"ordered"!==e,"ordered+repeated"===e||"repeated"===e,new Array(t)):[]},choose:function(n,t){return l(t.length,function(e){return n[t[e]]})}},_update:function(){var n=this;return n.item__=mn(n.__item,n.n[0],n.n[1],n.$.order,n.$.type),n}}),xn.conjugate=xn.complement,xn.project=xn.choose,An=Mn.Powerset=Mn.Subset=$n(vn,{constructor:function Kn(n,t){var e=this;return e instanceof Kn?(t=t||{},t.type=t.type||"subset",n=n||1,n instanceof vn&&(t.sub=n,n=t.sub.base()),t.base=n,t.dimension=n,t.mindimension=0,t.maxdimension=n,void vn.call(e,"Subset",n,t)):new Kn(n,t)},__static__:{C:function(n,t){return _(null,t,n)},P:vn.P,T:vn.T,DUAL:_n,count:function(n,t){return Mn.Math.pow2(n)},initial:function(n,t,e){var r,u=this,i=t&&null!=t.order?t.order:Tn;return e=-1===e?-1:1,(Tn&i&&Pn&i||jn&i&&!(Pn&i))&&(e=-e),r=0>e?l(n,0,1):[],r=u.DUAL(r,n,t)},succ:vn.succ,rand:function(n,t){for(var e,r=this,u=Mn.Math.rndInt,i=null,o=n-1;o>=0;o--)u(0,1)&&(i={len:i?i.len+1:1,k:o,next:i});return e=i?l(i.len,function(n){var t=i.k;return i=i.next,t}):[],e=r.DUAL(e,n,t)},randu:vn.rand,rank:function(n,t,e){var r=this,u=Mn.Arithmetic,i=u.O,l=u.I,o=u.add,a=u.shl,s=u.sub,c=e&&null!=e.order?e.order:Tn,f=i,d=0,m=n.length;for(n=r.DUAL(n,t,e);m>d;)f=o(f,a(l,n[d++]));return(Tn&c&&Pn&c||jn&c&&!(Pn&c))&&(f=s(e&&null!=e.last?e.last:s(r.count(t,e),l),f)),f},unrank:function(n,t,e){var r=this,u=Mn.Arithmetic,i=u.O,l=u.J,o=u.band,a=u.shr,s=u.gt,c=u.sub,f=e&&null!=e.order?e.order:Tn,d=[],m=0,h=e&&e.count?e.count:r.count(t,e);if(!u.inside(n,l,h))return null;for((Tn&f&&Pn&f||jn&f&&!(Pn&f))&&(n=c(e&&null!=e.last?e.last:c(h,u.I),n));s(n,i);)s(o(n,1),i)&&d.push(m),s(o(n,2),i)&&d.push(m+1),s(o(n,4),i)&&d.push(m+2),s(o(n,8),i)&&d.push(m+3),s(o(n,16),i)&&d.push(m+4),s(o(n,32),i)&&d.push(m+5),s(o(n,64),i)&&d.push(m+6),s(o(n,128),i)&&d.push(m+7),m+=8,n=a(n,8);return d=r.DUAL(d,t,e)},cascade:vn.cascade,output:function(n,t,e,r){if(null==n)return null;var u=n;return r&&"binary"===r.type&&(n=U(n,e)),u===n?n.slice():n},binary:function(n,t,e){return-1===e?$(n,t):U(n,t)}}}),wn=Mn.Partition=$n(vn,{constructor:function Qn(n,t){var e=this;if(!(e instanceof Qn))return new Qn(n,t);t=t||{},t.type=t.type||"partition",n=n||1,n instanceof vn&&(t.sub=n,n=t.sub.base());var r=t["max="]?0|t["max="]:null,u=t["parts="]?0|t["parts="]:null,i=u?u:r?n-r+1:n,l=u?u:r?In.ceil(n/r):1;t.base=n,t.dimension=u||n,t.mindimension=In.min(l,i),t.maxdimension=In.max(l,i),t.rand={partition:1,composition:1,packed:1},vn.call(e,"Partition",n,t)},__static__:{C:function(n,t,e){return e&&"composition"===e.type?j(n):T(n)},P:vn.P,T:vn.T,DUAL:cn,count:function(n,t){var e=t&&t["max="]?0|t["max="]:null,r=t&&t["parts="]?0|t["parts="]:null,u=t&&t.type?t.type:"partition";return"composition"===u?Mn.Math.compositions(n,r,e):Mn.Math.partitions(n,r,e)},initial:function(n,t,e){var r,u,i,o=this,a=t&&t.type?t.type:"partition",c=t&&t["max="]?0|t["max="]:null,f=t&&t["parts="]?0|t["parts="]:null,d=t&&null!=t.order?t.order:Tn,m="composition"===a,h=!1;return 0>=n||f&&c&&(f+c>n+1||n>f*c)||f&&f>n||c&&c>n?null:(e=-1===e?-1:1,(Tn&d&&Pn&d||jn&d&&!(Pn&d))&&(e=-e),f&&c?(1===f&&(r=[c]),m?(i=In.min(c,In.ceil((n-c)/(f-1))),r=[(n-c)%i||i].concat(l(f-2,i,0)).concat([c]),0>e&&s(r)):0>e?(u=In.min(f,In.floor(n/c)||1),n-=u*c,f-=u,0===n&&f>0&&(u--,f++,n+=c),r=[c].concat(l(u-1,c,0)).concat(n>0&&f>0?[n-f+1].concat(l(f-1,1,0)):[])):(i=In.min(c,In.ceil((n-c)/(f-1))),r=[c].concat(l(f-2,i,0).concat([(n-c)%i||i])))):(h=!1,m?c&&!f&&(f=c,c=null,h=!0):f&&!c&&(c=f,f=null,h=!0),f?m?(r=l(f-1,1,0).concat([n-f+1]),0>e&&s(r)):(i=In.ceil(n/f),u=n%i||i,r=0>e?[n-f+1].concat(l(f-1,1,0)):l(f-1,i,0).concat([u])):c?m?(r=l(n-c,1,0).concat([c]),0>e&&s(r)):(u=In.floor(n/c),i=n%c,r=0>e?l(u,c,0).concat(i?[i]:[]):[c].concat(l(n-c,1,0))):r=0>e?[n]:l(n,1,0)),r=o.DUAL(r,n,t))},succ:function(n,t,e,r,u,i){if(null==e||null==n)return null;var l=r&&r.type?r.type:"partition",o=r&&r["max="]?0|r["max="]:null,a=r&&r["parts="]?0|r["parts="]:null;return 0>=e||a&&o&&(a+o>e+1||e>a*o)||a&&a>e||o&&o>e?null:(u=-1===u?-1:1,"composition"===l?bn(n,e,u,a,o,r&&null!=r.order?r.order:Tn,i):pn(n,e,u,a,o,r&&null!=r.order?r.order:Tn,i))},rand:function(n,t){var e,r,u,i,o,a=this,s=Mn.Math.rndInt,c=t&&t.type?t.type:"partition",f=t&&null!=t.order?t.order:Tn,d=t&&t["max="]?0|t["max="]:null,m=t&&t["parts="]?0|t["parts="]:null,h=0,_=0,p="composition"===c,g=!1;if(0>=n||m&&d&&(m+d>n+1||n>m*d)||m&&m>n||d&&d>n)return null;if(m&&d)return null;if(g=!1,d&&!m&&(m=d,g=!0),m)1===m?(r=[n],_=n):n===m?(r=l(m,1,0),_=n):(e={},u=n-2,l(r=b(l(m-1,function(){for(o=s(0,u);1===e[o];)o=(o+1)%(u+1);return e[o]=1,o+1})),function(n){return o=r[n],i=o-h,h=o,_+=i,i}));else{for(e=null,o=1;n>o;o++)s(0,1)&&(i=o-h,h=o,_+=i,e={len:e?e.len+1:1,x:i,next:e});r=e?l(e.len,function(){return i=e.x,e=e.next,i}):[]}return n>_&&(r.length?r.splice(s(0,r.length-1),0,n-_):r.push(n-_)),p?g&&(r=v(T(b(r,-1)))):(r=b(r,-1),(qn&f||d)&&(r=T(r))),r=a.DUAL(r,n,t)},randu:vn.rand,rank:t,unrank:t,cascade:vn.cascade,output:function(n,t,e,r){if(null==n)return null;var u=n,i=r&&r.type?r.type:"partition",l=r&&null!=r.order?r.order:Tn,o=Nn&l?-1:1,a=r&&r["max="]?0|r["max="]:null,s=r&&r["parts="]?0|r["parts="]:null;return"composition"===i||(s&&!a&&(n=T(n,o)),"packed"===i&&(n=X(n,o))),u===n?n.slice():n},conjugate:function(n,t){return"composition"===t?j(n):T(n)},subset:function(n,t){return-1===t?N(n):P(n)},pack:function(n,t){return-1===t?q(n):X(n)}}}),wn.transpose=wn.conjugate,Mn});