/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python, Java, C/C++
*   @version: 0.8.8
*   https://github.com/foo123/Abacus
**/
!function(n,e,t){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[e])&&(n[e]=n.$deps[e]=t.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[e]=t.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(e,[],function(r){r(e,t.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["module"],function(e){return t.moduleUri=e.uri,t.call(n)}):e in n||(n[e]=t.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[e]})}(this,"Abacus",function(n){"use strict";function e(){throw new Error("Method not implemented!")}function t(n){return n instanceof Array||"[object Array]"===Hn.call(n)}function r(n){return n instanceof String||"[object String]"===Hn.call(n)}function u(n){return"function"==typeof n}function o(n){var e=n.toString(2),t=32-e.length;return t>0?new Array(t+1).join("0")+e:e}function s(n,e,r,u,l,i,o){var s,a,c,f,d,m,h,p,_=e,g=null,b=r&&t(r);if(b&&(null==u&&(u=0),null==l&&(l=r.length-1)),null==i&&(i=u>l?-1:1),0===i||b&&!r.length||0>=Xn.floor((l-u)/i)+1)return _;if(0>i?(p=(u-l)%-i,p&&(g=l),l+=p,m=l,h=u,f=-1,c=-(-i<<4)):(p=(l-u)%i,p&&(g=l),l-=p,m=u,h=l,f=1,c=i<<4),d=u+i*(15&Xn.floor((l-u)/i+1)),b){for(m=Xn.max(0,m),h=Xn.min(r.length-1,h),s=u;s>=m&&h>=s&&f*(d-s)>0;s+=i)_=n(_,r[s],s);for(a=d;a>=m&&h>=a;a+=c)s=a,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s),s+=i,_=n(_,r[s],s);!0===o&&null!==g&&g>=0&&g<r.length&&(_=n(_,r[g],g))}else{for(s=u;s>=m&&h>=s&&f*(d-s)>0;s+=i)_=n(_,s,s);for(a=d;a>=m&&h>=a;a+=c)s=a,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s),s+=i,_=n(_,s,s);!0===o&&null!==g&&(_=n(_,g,g))}return _}function a(n,e,r){var l=t(n)?n:(n=0|n)>0?new Array(n):[];if(n=l.length,n>0&&null!=e){r=r||0;var i=e;s(u(e)?function(n,t,r){return n[r]=e(r),n}:e===+e?function(n,e,t){return n[t]=i,i+=r,n}:function(n,t,r){return n[r]=e,n},l,l)}return l}function c(n,e,t){return s(function(n,e,r){return n[r]=e[t],n},n,e)}function f(n,e,r,u,l){return null==e?n:s(t(r)?function(n,e,t){return n[t]=r[t]-1-e,n}:function(n,e,t){return n[t]=r-1-e,n},n,e,u,l)}function d(n,e,t,r,u){if(null==e)return n;if(null==r&&(r=0),null==u&&(u=e.length-1),u>=r)for(var l,i=r,o=u;o>=i;i++,o--)l=e[i],n[i]=e[o],n[o]=l;return n}function m(n,e){return null==e&&(e=0),t(n)?a(n,t(e)?function(t){return e[t]-1-n[n.length-1-t]}:function(t){return e-n[t]}):n===+n&&e===+e?e-n:jn.Arithmetic.sub(jn.Arithmetic.N(e),n)}function h(n,e,r,u,l){if(null==e)return n;var i=0;return s(t(r)?function(n,e,t){return n[t]=r[t]>0?(e+i)%r[t]:0,i+=r[t]-n[t],n}:function(n,e,t){return n[t]=(e+i)%r,i+=r-n[t],n},n,e,u,l)}function p(n,e,t,r,u){return null==e?n:(null==u&&(u=e.length-1),null==r&&(r=0),s(function(n,e,r){return n[r+t]=e,n},n,e,0>t?r:u,0>t?u:r,0>t?1:-1))}function _(n,e,t,r,u,l,i,o){if(null==e)return null;null==t&&(t=1),null==r&&(r=0),null==u&&(u=0),null==l&&(l=e.length-1),null==i&&(i=u),null==o&&(o=l);var a=0,c=i>o?-1:1,f=i;return s(function(n,e,u){return e=r+t*e,n[f]=e-a,a=e,f+=c,n},n,e,u,l)}function g(n,e,t,r,u,l,i,o){if(null==e)return null;null==t&&(t=1),null==r&&(r=0),null==u&&(u=0),null==l&&(l=e.length-1),null==i&&(i=u),null==o&&(o=l);var a=0,c=i>o?-1:1,f=i;return s(function(n,e,u){return a+=e,n[f]=r+t*a,f+=c,n},n,e,u,l)}function b(n,e,t,r,u,l,i,o){r=-1===r?-1:1,null==u&&(u=0),null==l&&(l=e.length-1),null==i&&(i=0),null==o&&(o=t.length-1);var s=u>l?-1:1,a=i>o?-1:1,c=s*(l-u)+1,f=a*(o-i)+1,d=u,m=i,h=0;if(null==n&&(n=new Array(Xn.min(c,f))),0===n.length)return n;for(;s*(l-d)>=0&&a*(o-m)>=0;)1===r&&e[d]<t[m]||-1===r&&e[d]>t[m]?d+=s:1===r&&e[d]>t[m]||-1===r&&e[d]<t[m]?m+=a:(n[h++]=e[d],d+=s,m+=a);return h<n.length&&(n.length=h),n}function v(n,e,t,r,u,l,i,o,s){s=!0===s,r=-1===r?-1:1,null==u&&(u=0),null==l&&(l=e===+e?e-1:e.length-1),null==i&&(i=0),null==o&&(o=t?t.length-1:-1);var c=u>l?-1:1,f=i>o?-1:1,d=c*(l-u)+1,m=u,h=i,p=0;if(!t||!t.length)return e===+e?a(e,u,c):e?e.slice():e;if(null==n&&(n=new Array(s?2*d:d)),e===+e){for(;c*(l-m)>=0&&f*(o-h)>=0;)m===t[h]?(s&&(n[p++]=m),m+=c,h+=f):1===r&&m>t[h]||-1===r&&m<t[h]?h+=f:(n[p++]=m,m+=c);for(;c*(l-m)>=0;)n[p++]=m,m+=c}else{for(;c*(l-m)>=0&&f*(o-h)>=0;)e[m]===t[h]?(s&&(n[p++]=e[m]),m+=c,h+=f):1===r&&e[m]>t[h]||-1===r&&e[m]<t[h]?h+=f:(n[p++]=e[m],m+=c);for(;c*(l-m)>=0;)n[p++]=e[m],m+=c}return p<n.length&&(n.length=p),n}function y(n,e,t,r,u,l,i,o,s,a,c){r=-1===r?-1:1,null==u&&(u=0),null==l&&(l=e.length-1),null==i&&(i=0),null==o&&(o=t.length-1),!0===s?a=!1:(s=!1,a=!1!==a),c=!0===c;var f=u>l?-1:1,d=i>o?-1:1,m=f*(l-u)+1,h=d*(o-i)+1,p=m+h,_=u,g=i,b=0,v=null,y=!a;if(null==n&&(n=new Array(p)),0===n.length)return c?e:n;for(;f*(l-_)>=0&&d*(o-g)>=0;){if(a&&b){if(e[_]===v){_+=f;continue}if(t[g]===v){g+=d;continue}}s?1===r&&e[_][0]<t[g][0]||-1===r&&e[_][0]>t[g][0]?(n[b++]=v=e[_],_+=f):1===r&&e[_][0]>t[g][0]||-1===r&&e[_][0]<t[g][0]?(n[b++]=v=t[g],g+=d):(1===r&&e[_][1]<t[g][1]||-1===r&&e[_][1]>t[g][1]?(n[b++]=v=e[_],y&&(n[b++]=t[g])):(n[b++]=v=t[g],y&&(n[b++]=e[_])),_+=f,g+=d):1===r&&e[_]<t[g]||-1===r&&e[_]>t[g]?(n[b++]=v=e[_],_+=f):1===r&&e[_]>t[g]||-1===r&&e[_]<t[g]?(n[b++]=v=t[g],g+=d):(n[b++]=v=e[_],y&&(n[b++]=t[g]),_+=f,g+=d)}for(;f*(l-_)>=0;)(y||e[_]!==v)&&(n[b++]=v=e[_],_+=f);for(;d*(o-g)>=0;)(y||t[g]!==v)&&(n[b++]=v=t[g],g+=d);if(c){for(_=0>f?l:u,b=0;p>b;b++,_++)e[_]=n[b];return e}return b<n.length&&(n.length=b),n}function x(n,e,t,r,u){var l,i,o,s,a,c,f,d,m;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,r[5]=0,c=0,m=0,s=e,a=-1,l=u?n[s][0]:n[s],o=s+1;t>=o;o++){if(i=u?n[o][0]:n[o],i>l){if(-1===c){a=o-1;break}0===c&&(c=1)}else if(l>i){if(1===c){a=o-1;break}0===c&&(c=-1)}l=i}if(0===c&&(c=1),-1===a)a=t,r[0]=s,r[1]=a,r[2]=c;else{for(f=a+1,d=-1,l=u?n[f][0]:n[f],o=f+1;t>=o;o++){if(i=u?n[o][0]:n[o],i>l){if(-1===m){d=o-1;break}0===m&&(m=1)}else if(l>i){if(1===m){d=o-1;break}0===m&&(m=-1)}l=i}-1===d&&(d=t),0===m&&(m=1),r[0]=s,r[1]=a,r[2]=c,r[3]=f,r[4]=d,r[5]=m}}function A(n,e,t,r,u,l){null==u&&(u=0),null==l&&(l=n.length-1);var i=u>l?-1:1,o=i*(l-u)+1;if(r=!0===r,1>=o)return r?1===o?[u]:[]:n;e=-1===e?-1:1;var a,f,m,h,p,_=o,g=1,b=2,v=Xn.min,A=new Array(o);if(r&&(n=s(function(n,e,t){return n[t-u]=[e,t],n},new Array(o),n,u,l,1),u=0,l=o-1),!0===t){h=u,p=-1,a=[-1,-1,0,-1,-1,0];do x(n,u,l,a,r),-1===a[3]?(e!==a[2]&&l>u&&d(n,n,u,l),f=u,m=l):(a[2]=e!==a[2]?1:0,a[5]=e!==a[5]?1:0,y(A,n,n,e,a[2]?a[1]:a[0],a[2]?a[0]:a[1],a[5]?a[4]:a[3],a[5]?a[3]:a[4],r,!1,!0),f=a[0],m=a[4]),-1!==p&&y(A,n,n,e,h,p,f,m,r,!1,!0),p=m,u=m+1;while(l>=u)}else for(;_>0;)s(function(t,l){y(A,n,n,e,u+i*l,u+i*(l+g-1),u+i*(l+g),u+i*v(l+b-1,o-1),r,!1,!0)},null,null,0,o-g-1,b),g<<=1,b<<=1,_>>=1;return r?c(n,n,1):n}function w(n,e,t,r){var u,l,i,o=n.length;if(null==t&&(t=0),null==r&&(r=o-1),null==e||0===e){for(e=0,l=n[t],u=t+1;r>=u;u++){if(i=n[u],i>l){if(-1===e)return 0;0===e&&(e=1)}else if(l>i){if(1===e)return 0;0===e&&(e=-1)}l=i}return 0===e?1:e}if(e=-1===e?-1:1,t>=r)return e;if(-1===e)for(l=n[t],u=t+1;r>=u;u++){if(i=n[u],i>l)return 0;l=i}else for(l=n[t],u=t+1;r>=u;u++){if(i=n[u],l>i)return 0;l=i}return e}function M(n,e,r,u){var l,i=jn.Math.rndInt,o=!0===e?1:0;return t(r)?1<(l=r.length)&&s(function(n){if(o<l--){var e=i(0,l-o),t=n[r[l]];n[r[l]]=n[r[e]],n[r[e]]=t}return n},n,r,0,l-1):(null==r&&(r=0),null==u&&(u=n.length-1),1<(l=u-r+1)&&s(function(n){if(o<l--){var e=i(0,l-o),t=n[r+l];n[r+l]=n[r+e],n[r+e]=t}return n},n,n,0,l-1)),n}function O(n,e,t,r,u,l,i){null==l&&(l=0),null==i&&(i=n.length-1);var o,s,a,c,f=jn.Math.rndInt,d=i-l+1;if(e=Xn.min(e,d),t=!0===t,o=new Array(e),!0===r){for(d-=1,s=0;e>s;s++)o[s]=n[l+f(0,d)];return t&&A(o),o}for(s=0;e>s;s++)a=f(0,--d),c=n[l+a],n[l+a]=n[l+d],n[l+d]=c,o[s]=c,u&&(u[s]=a);if(u)for(s=e-1;s>=0;s--)a=u[s],c=n[l+d],n[l+d]=n[l+a],n[l+a]=c,d++;return t&&A(o),o}function q(n,e,t,r,u){t=-1===t?-1:1,null==r&&(r=0),null==u&&(u=e.length-1);var l,i,o=r,s=u;if(n===e[o])return o;if(n===e[s])return s;for(;s>o;){if(l=o+(s-o+1>>>1),i=e[l],n===i)return l;1===t&&i>n||-1===t&&n>i?s=l-1:o=l+1}return-1}function I(n,e){return n+e}function S(n,e){return n*e}function L(n,e,t,r){return s(jn.Arithmetic.add,jn.Arithmetic.O,n,e,t,r)}function C(n,e,t,r){return s(jn.Arithmetic.mul,jn.Arithmetic.I,n,e,t,r)}function E(n){var e=jn.Arithmetic;return e.shl(e.I,e.N(n))}function $(n,e){var t=jn.Arithmetic,r=t.N;return t.pow(r(n),r(e))}function k(n,e){var r,u=jn.Arithmetic,l=u.O,i=u.I,o=u.J,a=u.N,c=u.add,f=(u.sub,u.div),d=u.mul;return null==e?10>=n?0>n?l:0===n?i:a([1,2,6,24,120,720,5040,40320,362880,3628800][n-1]):(r=String(n),null==k.mem1[r]&&(k.mem1[r]=d(k(n-1),n)),k.mem1[r]):!1===e?10>=n?2>n?l:a([1,2,9,44,265,1854,14833,133496,1334961][n-2]):(r="!"+String(n),null==k.mem2[r]&&(k.mem2[r]=c(1&n?o:i,d(k(n-1,!1),n))),k.mem2[r]):!0===e?10>=n?0>n?l:0===n?i:a([1,2,4,10,26,76,232,764,2620,9496][n-1]):(r="I"+String(n),null==k.mem2[r]&&(k.mem2[r]=c(k(n-1,!0),d(k(n-2,!0),n-1))),k.mem2[r]):t(e)?e.length?0>n?l:(r=String(n)+"@"+A(e.slice(),1,!0).join(","),null==k.mem3[r]&&(k.mem3[r]=f(k(n),s(function(n,e){return d(n,k(e))},k(e[e.length-1]),e,e.length-2,0))),k.mem3[r]):0>n?l:k(n):e===+e?0>e?-e>=n?-e===n?k(n):l:(r=String(n)+"@"+String(e),null==k.mem3[r]&&(k.mem3[r]=s(d,i,null,n+e+1,n)),k.mem3[r]):0>e||1>n||e>n?l:(e+e>n&&(e=n-e),0===e||1===n?i:1===e?a(n):(r=String(n)+"@"+String(e),null==k.mem3[r]&&(k.mem3[r]=u.isDefault()?Xn.round(s(function(e,t){return e*(1+n/t)},(n-=e)+1,null,2,e)):c(k(n-1,e-1),k(n-1,e))),k.mem3[r])):l}function D(n,e,t){var r,u=jn.Arithmetic,l=u.O,i=u.I,o=u.V,s=u.add,a=u.mul;return 0>n||0>e?l:2===t?n===e||1===e&&0>n?i:0===n||0===e?l:(r=String(n)+","+String(e),null==D.mem2[r]&&(D.mem2[r]=s(D(n-1,e-1,2),a(D(n-1,e,2),e))),D.mem2[r]):-1===t?e>n||0===e&&0>n?l:n===e?i:(r="-"+String(n)+","+String(e),null==D.mem1[r]&&(D.mem1[r]=s(D(n-1,e-1,-1),a(D(n-1,e,-1),-n+1))),D.mem1[r]):e>n||0===e&&0>n?l:n===e?i:1===e?k(n-1):n-e&1?o(D(n,e,-1)):D(n,e,-1)}function R(n,e,t,r){var u,l,i=jn.Arithmetic,o=i.add,a=i.I,c=i.O;return 0>n||0>=e||t>r||t+e>n+1||n>e*r?c:r===n&&1===e||e===n&&1===r?a:(u=String(n)+","+String(e)+","+String(t)+","+String(r),null==R.mem[u]&&(n-=e*(t-1),r=r-t+1,l=String(n)+","+String(e)+","+String(t)+","+String(r),null==R.mem[l]&&(R.mem[l]=s(function(t,u){return o(t,R(n-r,e-1,1,u))},c,null,Xn.max(1,Xn.ceil((n-r)/(e-1))),Xn.min(r,n-r-e+2),1)),R.mem[u]=R.mem[l]),R.mem[u])}function N(n,e,t){e=null==e?null:0|e,t=null==t?null:0|t;var r,u=jn.Arithmetic,l=u.add,i=t?t:0,o=t?t:1,a=e?e:1,c=e?e:n,f=u.O;return 0>n||e&&t&&(e+t>n+1||n>e*t)||t&&t>n||e&&e>n?f:(t&&!e&&(i=0,o=1,a=t,c=t,e=t,t=null),r=String(n)+"|"+String(e)+"|"+String(t),null==N.mem[r]&&(N.mem[r]=s(function(e,t){return s(function(e,r){return l(e,R(n,t,1,r))},e,null,o,i?i:n-t+1,1)},f,null,a,c,1)),N.mem[r])}function U(n,e,t,r){var u,l=jn.Arithmetic,i=l.add,o=l.O,a=l.I;return 0>n||0>=e||t>r||t*e>n||n>e*r?o:1===e?n>=t&&r>=n?a:o:n===e?1>=t&&r>=1?a:o:t===r?e*t===n?a:o:n===r?k(n-e*t+e-1,e-1):(u=String(n)+","+String(e)+","+String(t)+","+String(r),null==U.mem[u]&&(U.mem[u]=s(function(n,u){return i(n,U(u,e-1,t,r))},o,null,Xn.max(n-r,0),n-t,1)),U.mem[u])}function P(n,e,t){e=null==e?null:0|e,t=null==t?null:0|t;var r,u=jn.Arithmetic,l=u.O,i=u.I,o=u.add,a=(u.mul,u.div,l);return 0>n||e&&t&&(e+t>n+1||n>e*t)||t&&t>n||e&&e>n?a:(r=String(n)+"|"+String(e)+"|"+String(t),null==P.mem[r]&&(e&&t?P.mem[r]=e*t===n?i:U(n,e,1,t):e?P.mem[r]=U(n,e,1,n):t?P.mem[r]=n===t?i:s(function(e,r){return o(e,U(n,r,1,t))},a,null,Xn.ceil(n/t),n-t+1,1):P.mem[r]=n>=1?E(n-1):i),P.mem[r])}function T(n){var e,t=jn.Arithmetic,r=t.O,u=t.N,l=t.div,i=t.mul;return 14>=n?0>n?r:u([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900][n]):(e=String(n),null==T.mem[e]&&(T.mem[e]=l(i(T(n-1),4*n-2),n+1)),T.mem[e])}function j(n){var e,t=jn.Arithmetic,r=t.O,u=t.N,l=t.add,i=t.mul;return 12>=n?0>n?r:u([1,1,2,5,15,52,203,877,4140,21147,115975,678570][n]):(e=String(n),null==j.mem[e]&&(j.mem[e]=s(function(e,t){return l(e,i(k(n-1,t),j(t)))},r,null,0,n-1,1)),j.mem[e])}function X(n){var e,t=jn.Arithmetic,r=t.O,u=t.N,l=t.add;return 29>=n?0>n?r:u([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811][n]):(e=String(n),null==X.mem[e]&&(X.mem[e]=l(X(n-1),X(n-2))),X.mem[e])}function J(n){if(!arguments.length||null==n)return ae;var e=0;if(r(n)){n=n.toUpperCase().split(",");for(var t=0,u=n.length;u>t;t++)e|=Fn.call(J,n[t])?J[n[t]]:0;e>0&&!((me|de)&e)&&(e|=ae),0>=e&&(e=ae)}else e=he&n?he&n:ae;return de&e&&me&e&&(e&=~me),fe&e&&(ce|ae)&e&&(e&=~(ce|ae)),ce&e&&ae&e&&(e&=~ae),de&e&&(e&=~oe),e}function V(){var n,e,r,u,l,i,o,s,a,c,f,d=arguments.length;if(!d)return[];if(!0===arguments[0]){for(c=arguments[1].length,n=2;d>n;n++)c*=arguments[n].length;for(f=new Array(c),n=0;c>n;n++){for(s=0,i=1,r=n,e=1;d>e;e++)u=arguments[e].length,l=r%u,r=~~(r/u),o=arguments[e][l],s+=i*o,i*=u;f[n]=s}}else{for(c=arguments[0].length,n=1;d>n;n++)c*=arguments[n].length;for(f=new Array(c),n=0;c>n;n++){for(s=new Array(d),a=0,r=n,e=d-1;e>=0;e--)if(u=arguments[e].length,l=r%u,r=~~(r/u),o=arguments[e][l],t(o))for(i=o.length-1;i>=0;i--)s[d-++a]=o[i];else s[d-++a]=o;f[n]=s}}return f}function G(){var n,e,t=arguments,r=t.length,u=0;for(e=0;r>e;e++)u+=t[e].length;return n=0,e=0,a(u,function(r){return r>=n+t[e].length&&(n+=t[e++].length),n+t[e][r-n]})}function F(n,e,t){var r,l,i,o,s,a,c,f,d,m,h,p,_,g,b,v,y,x,A,w,M,O,q,I,S=n.length,L=null,C=null;if(!S)return[];for(u(t)?(C=t,t=!0):t=!1,ee!==e&&te!==e&&re!==e&&ue!==e&&le!==e&&ie!==e&&(e=!1),y=new Array(S),v=[],l=1,r=0;S>r;r++)if(u(n[r][0]))null==y[n[r][1]]?y[n[r][1]]=[[n[r][0],r]]:y[n[r][1]].push([n[r][0],r]);else if(v.push(r),l*=n[r].length,!l||0>=l)return[];if(!v.length)return[];for(g=new Array(l),_=0,p=S-1,x=v.length-1,w=new Array(S),M=0,r=0;l>r;r++){for(m=new Array(S),A=!1,o=r,i=x;i>=0;i--)if(b=v[i],s=n[b].length,a=o%s,o=~~(o/s),m[b]=n[b][a],null!=y[b]){w[0]=b,M=1;do for(b=w[--M],O=y[b],c=m[b],q=0,I=O.length;I>q;q++)b=O[q][1],m[b]=O[q][0](c),null!=y[b]&&(w[M++]=b);while(M>0)}if(e||t)if(t&&!C(m,p,p))A=!0;else for(d=m[p],te===e&&(L={},L[d]=1),h=p-1;h>=0;h--){if(f=m[h],ee===e&&d!==f||te===e&&1===L[f]||re===e&&f>=d||ue===e&&d>=f||le===e&&d>f||ie===e&&f>d||t&&!C(m,h,p)){A=!0;break}te===e&&(L[f]=1),d=f}A||(g[_++]=m)}return g.length>_&&(g.length=_),g}function H(n,e,l,i,o){o=o||{};var s,c,f,m,h,p,_,g,b,v=null==o.min?0:o.min,y=null==o.max?n-1:o.max,x=y-v+1,M=e,O=M.length,q=!1,I=[],S=[],L={},C=function(n){return n>=v&&y>=n};for(e=[],q=!1,h=0,f=0;O>f;f++,h++)if(c=M[f],r(c))if(s=c.match(Kn)){if(0<s[1].indexOf("..")?(s=s[1].split("..").map(Number),m=s[0]>s[1]?W(n,a(s[0]-s[1]+1,s[1],1).filter(C)).reverse():W(n,a(s[1]-s[0]+1,s[0],1).filter(C))):m=W(n,s[1].split(",").map(Number).filter(C)),!m.length){q=!0;break}e.push(m)}else if(s=c.match(zn)){if(0<s[1].indexOf("..")?(s=s[1].split("..").map(Number),m=(s[0]>s[1]?a(s[0]-s[1]+1,s[0],-1):a(s[1]-s[0]+1,s[0],1)).filter(C)):m=s[1].split(",").map(Number).filter(C),!m.length){q=!0;break}e.push(m)}else{if(p=-1,_=null,g=null,c=c.replace(Yn,function(n,e){return null===_&&(p=parseInt(e,10),_="v"+String(p)),_}),!C(p)){l&&l.splice(h--,1);continue}try{g=new Function(_,"return Math.floor("+c+");")}catch(E){g=null}if(!u(g)){l&&l.splice(h--,1);continue}L[p]?L[p].push(g):L[p]=[g],0>l.indexOf(p)&&S.push(p),I.push([g,null,null,p,l[h]]),e.push(I[I.length-1])}else if(t(c)){if(m=!1===c[0]?W(n,c.slice(1).filter(C)):c.slice(1).filter(C),!m.length){q=!0;break}e.push(m)}if(q&&(e=[]),S.length)for(f=0,O=S.length;O>f;f++)l.push(S[f]),q||e.push(a(x,v,1));if(f=w(l),-1===f?(d(l,l),q||d(e,e)):0===f&&(c=A(l,1,!1,!0),hn(l,c),q||hn(e,c)),q)return[];if(I.length)for(f=0,O=I.length;O>f;f++)if(s=I[f],s[1]=l.indexOf(s[3]),s[2]=l.indexOf(s[4]),g=L[s[3]],!u(e[s[1]][0])){if(m=e[s[1]].filter(function(n){for(var e,t=0,r=g.length;r>t;t++)if(e=g[t](n),v>e||e>y)return!1;return!0}),!m.length){q=!0;break}e[s[1]]=m}return q?[]:(i="="===i?ee:"!="===i||"<>"===i?te:"<"===i?re:"<="===i||"=<"===i?ie:">"===i?ue:">="===i||"=>"===i?le:!1,b=u(o.extra_conditions)?function(n,e,t){return v<=n[e]&&n[e]<=y&&o.extra_conditions(n,e,t)}:function(n,e,t){return v<=n[e]&&n[e]<=y},!0===o.lazy?e:F(e,i,b))}function W(n,e,t){if(null==e||!e.length||1>=e.length)return 1===e.length?a(n-1,function(n){return n<e[0]?n:n+1}):a(n,0,1);if(!0===t){var r=w(e);-1===r?e=d(new Array(e.length),e):0===r&&(e=A(e.slice(),1,!0))}return v(null,n,e)}function B(n,e){if(0>=e)return[];var t,r=a(e,0,0),u=n.length;for(e-=1,t=0;u>t;t++)r[e-n[t]]=1;return r}function Y(n,e){e=Xn.min(e||n.length,n.length);var t,r=[];for(e-=1,t=0;e>=t;t++)0<n[t]&&r.push(e-t);return r}function z(n,e,t){return null==n?null:(e=e||n.length,g(new Array(e),n,1,-1,-1===t?e-1:0,-1===t?0:e-1,0,e-1))}function K(n,e,t){return null==n?null:(e=e||n.length,_(new Array(e),n,1,1,-1===t?e-1:0,-1===t?0:e-1,0,e-1))}function Q(n,e,r){if(null==e)return null;var u,l=null,i=e.length;if(r=-1===r?-1:1,n)u=s(I,0,e),1>=u?l=e.slice():(l=K(W(u-1,z(e,i-1,r))),0<(u-=s(I,0,l))&&l.push(u),0>r&&d(l,l));else{var o,c,f,m,h,p=1,_=0,g=0,b="push";if(0>r&&(p=-p,_=i-1-_,b="unshift"),t(e[_]))for(h=e[_],l=[[h[1],h[0]]],o=0,f=1,m=p+_;i>f;f++,m+=p)h=e[m],c=0>r?0:o,h[1]===l[c][0]?l[c][1]+=h[0]:(l[b]([h[1],h[0]]),o++);else for(u=e[_],l=a(u,1,0),0>r&&(g=u-1-g),f=1,m=p+_;i>f;f++,m+=p)for(o=0,c=g,h=e[m];u>o&&h>0;)l[c]++,h--,o++,c+=p}return l}function Z(n,e){if(null==n)return null;var t,r,u,l,i=[],o=n.length,s=-1===e,a=1,c=0,f="push";for(s&&(a=-a,c=o-1-c,f="unshift"),u=n[c],l=[u,1],t=1;o>t;t++)r=a*t+c,u===n[r]?l[1]++:(i[f](l),u=n[r],l=[u,1]);return i[f](l),i}function nn(n,e){if(null==n)return null;var t,r,u,l,i,o=[],s=n.length,a=-1===e,c=1,f=0,d="push";for(a&&(c=-c,f=s-1-f,d="unshift"),t=0;s>t;t++)if(i=n[c*t+f],1===i[1])o[d](i[0]);else for(u=i[1],l=i[0],r=0;u>r;r++)o[d](l);return o}function en(n,e,t){var r,u,l=e.length,i=l*l;for(n=n||new Array(i),r=0,u=0;i>r;)n[r+u]=0,++u>=l&&(u=0,r+=l);if(!0===t)for(r=0;l>r;r++)n[l*e[r]+r]=1;else for(r=0,u=0;l>u;u++,r+=l)n[r+e[r]]=1;return n}function tn(n,e,t){var r,u,l=e.length,i=Xn.floor(Xn.sqrt(l));if(n=n||new Array(i),!0===t)for(r=0,u=0;i>r;)e[i*r+u]&&(n[u]=r),++u>=i&&(u=0,r++);else for(r=0,u=0;i>r;)e[r+u]&&(n[r]=u),++u>=i&&(u=0,r++);return n}function rn(n,e,t){var r=n?n.length:0,u=1,l=0,i=0,o=r>i?n[i]||1:1;return-1===t&&(u=-1,l=(r||e)-1),s(function(e,t){return 0>=o&&(i++,l+=u,o=r>i?n[i]||1:1),o--,e[t]=l,e},new Array(e),null,0,e-1)}function un(n){return on(null,A(n,1,!1,!0))}function ln(n,e){return e&&e.length?s(function(n,t,r){return n[r]=t<e.length?e[t]:t,n},n,n):n}function on(n,e){return s(function(n,e,t){return n[e]=t,n},n||new Array(e.length),e)}function sn(n,e,t){var r=e.length,u=Xn.ceil(Wn(t||r)),l=1<<u,i=(1<<1+u)-1,o=a(i,0,0);return s(function(n,e,t){for(var r=e+l,i=0;u>i;i++)1&r&&(e-=o[r>>>1<<1]),o[r]+=1,r>>>=1;return o[r]+=1,n[t]=e,n},n||new Array(r),e)}function an(n,e,t){var r,u,l,i=e.length,o=Xn.ceil(Wn(t||i)),a=1<<o,c=(1<<1+o)-1,f=new Array(c);for(r=0;o>=r;r++)for(l=1,u=1<<r;u>=l;l++)f[u-1+l]=1<<o-r;return s(function(n,e,t){for(var r=1,u=0;o>u;u++)f[r]-=1,r<<=1,e>=f[r]&&(e-=f[r],r++);return f[r]=0,n[t]=r-a,n},n||new Array(i),e)}function cn(n,e,t){var r,u=n.length,l=null==e;if(u>1)for(l&&(e=new Array(u-1),t=0),r=u-1;r>=1;r--)e[t++]=[n[0],n[r]];else l&&(e=[]);return l?e:t}function fn(n,e){var t,r,u,l,i=n.length,o=new Array(i),s=!0===e?1:0,a=new Array(i),c=0,f=0;for(t=0;i>t;t++)a[t]=0;for(u=new Array(i),l=0,r=c++,u[l++]=r,a[r]=1;i>c;){if(r=n[r],a[r])for(l>s&&(u.length=l,o[f++]=u),u=new Array(i),l=0;i>c&&a[r=c];)++c;a[r]||(u[l++]=r,a[r]=1)}return l>s&&(u.length=l,o[f++]=u),f<o.length&&(o.length=f),o}function dn(n){var e,t,r=n.length,u=new Array(r),l=0,i=fn(n,!0);for(e=0,t=i.length;t>e;e++)l=cn(i[e],u,l);return l<u.length&&(u.length=l),u}function mn(n,e){var t,r,u,l=n.length,i=new Array(e);for(t=0;e>t;t++)i[t]=t;for(t=0;l>t;t++)swap=r[t],u=i[r[0]],i[r[0]]=i[r[1]],i[r[1]]=u;return i}function hn(n,e,t){var r=n.length,u=e.length;if(!0===t)return s(u>r?function(t,u){return t[u]=e[u]<r?n[e[u]]:n[u],t}:r>u?function(t,r){return t[r]=u>r?n[e[r]]:n[r],t}:function(t,r){return t[r]=n[e[r]],t},new Array(r),null,0,r-1,1);for(var l=n.slice(),i=0;r>i;i++)n[i]=l[e[i]];return n}function pn(n){return s(function(n,e){return hn(n,e,!0)},n.length?n[0].slice():[],n,1,n.length-1,1)}function _n(n){var e,t,r,u=n.length,l=0;for(t=0;u>t;t++)l+=n[t].length;return e=0,t=0,r=u?n[t].length:0,a(l,function(u){return u>=e+r&&(e+=r,r=n[++t].length),e+n[t][u-e]})}function gn(n,e){if(e=e||n.length,e!==n.length)return!1;var t,r,u=a(e,0,0);for(t=0;e>t;t++){if(r=n[t],0>r||r>=e||0<u[r])return!1;u[r]++}for(t=0;e>t;t++)if(1!==u[t])return!1;return!0}function bn(n){for(var e=n.length,t=0;e>t;t++)if(n[t]!==t)return!1;return!0}function vn(n){for(var e=n.length,t=0,r=n[t];e>t;t++,r=n[t])if(0>r||r>=e||n[r]!==t)return!1;return!0}function yn(n,e){if(e=e||1,1>e)return!1;var t,r,u,l=n.length;for(t=0;l>t;t++){for(r=n[t],u=1;e>=u&&t!==r;)u++,r=n[r];if(t!==r||u!==e&&(u>=e||e%u>0))return!1}return!0}function xn(n,e,t){e=0|e;for(var r=0,u=n.length,l=0;u>l;l++)if(n[l]===l&&++r>e)return!1;return!0===t?r===e:!0}function An(n){for(var e=n.length,t=1,r=n[0];e>t;t++)if(n[t]!==(r+t)%e)return!1;return!0}function wn(n){for(var e=n.length-1,t=-1,r=0,u=n[r];e>r;r++,u=n[r])if(u>t&&(t=u),r>=t)return!1;return!0}function Mn(n,e,t,r){if(!n.length||0>=e)return!1;r=!1!==r;var u,l,i,o,s,a=n.length;for(u=0,i=0,s=0,o=new Array(a);a>s;){if(l=n[u],u===l||1===o[l])for((r||u!==l)&&i++,o[l]=1,u=0;a>u&&1===o[n[u]];)u++;else o[l]=1,u=l;s++}return"<="===t?e>=i:">="===t?i>=e:i===e}function On(n,e,t,r,u,l){var i,o,s,a,c,f,d,m,h,p,_=e;if("tuple"===r?(i=_[0],_=_[1]):i=_.length,h=0,p=i-1,f=1,a=p,c=h,d=1,m=0,ce&u&&(f=-f,a=p-a,c=p-c,d=-d,m=p-m),se&u&&(f=-f,a=p-a,c=p-c,d=-d,m=p-m),oe&u&&(t=-t),0>t)if("tuple"===r){for(o=a;o>=h&&p>=o&&0===n[o];)o-=f;if(o>=h&&p>=o)for(_-=1,n[o]=n[o]-1,s=o+f;s>=h&&p>=s;s+=f)n[s]=_;else n=null}else{for(o=a;o>=h&&p>=o&&0===n[o];)o-=f;if(o>=h&&p>=o)for(n[o]=n[o]-1,s=o+f;s>=h&&p>=s;s+=f)n[s]=_[d*s+m]-1;else n=null}else if("tuple"===r){for(o=a;o>=h&&p>=o&&n[o]+1===_;)o-=f;if(o>=h&&p>=o)for(n[o]=n[o]+1,s=o+f;s>=h&&p>=s;s+=f)n[s]=0;else n=null}else{for(o=a;o>=h&&p>=o&&n[o]+1===_[d*o+m];)o-=f;if(o>=h&&p>=o)for(n[o]=n[o]+1,s=o+f;s>=h&&p>=s;s+=f)n[s]=0;else n=null}return n}function qn(n,e,t,r){return null}function In(n,e,t,r,u,l,i){var o,s,a,c,f,d,m,h,p,_,g,b,v,y,x=e,A=null==l?x:l;if(v=0,y=x-1,h=1,m=y,p=1,_=0,g=1,b=0,ce&u&&(h=-h,m=y-m,p=-p,_=A-1-_,t=-t),se&u&&(h=-h,m=y-m,g=-1,b=A-1),oe&u&&(t=-t),0>t)if("cyclic"===r)if(o=y-m,p*n[o]+_>0)for(g=x-1,h=x+h,a=0;x>a;a++)f=(p*n[o]+_+g)%x,n[o]=p*f+_,o=(o+h)%x;else n=null;else if("involution"===r)n=null;else if("connected"===r)n=null;else do{for(d=!1,o=m-h;o>=v&&y>=o&&p*n[o]<=p*n[o+h];)o-=h;if(o>=v&&y>=o){for(s=m;s>=v&&y>=s&&h*(s-o)>0&&p*n[o]<=p*n[s];)s-=h;for(f=n[o],n[o]=n[s],n[s]=f,a=o+h,c=m;a>=v&&y>=a&&c>=v&&y>=c&&h*(c-a)>0;)f=n[a],n[a]=n[c],n[c]=f,d=d||g*a+b===n[a]||g*c+b===n[c],a+=h,c-=h;if("derangement"===r)for(s>=v&&y>=s&&(d=d||g*s+b===n[s]),c>=v&&y>=c&&(d=d||g*c+b===n[c]),d=d||g*o+b===n[o],a=o-h;!d&&a>=v&&y>=a;a-=h)d=g*a+b===n[a];else d=!1}else n=null}while(n&&d);else if("cyclic"===r)if(o=y-m,p*n[o]+_<x-1)for(g=x+1,h=x+h,a=0;x>a;a++)f=(p*n[o]+_+g)%x,n[o]=p*f+_,o=(o+h)%x;else n=null;else if("involution"===r){for(o=x,d=!0;d&&o--;)for(s=n[o],n[o]=o,n[s]=s;s--;)if(n[s]===s){n[o]=s,n[s]=o,d=!1;break}d&&(n=null)}else if("connected"===r)n=null;else do{for(d=!1,o=m-h;o>=v&&y>=o&&p*n[o]>=p*n[o+h];)o-=h;if(o>=v&&y>=o){for(s=m;s>=v&&y>=s&&h*(s-o)>0&&p*n[o]>=p*n[s];)s-=h;for(f=n[o],n[o]=n[s],n[s]=f,a=o+h,c=m;a>=v&&y>=a&&c>=v&&y>=c&&h*(c-a)>0;)f=n[a],n[a]=n[c],n[c]=f,d=d||g*a+b===n[a]||g*c+b===n[c],a+=h,c-=h;if("derangement"===r)for(s>=v&&y>=s&&(d=d||g*s+b===n[s]),c>=v&&y>=c&&(d=d||g*c+b===n[c]),d=d||g*o+b===n[o],a=o-h;!d&&a>=v&&y>=a;a-=h)d=g*a+b===n[a];else d=!1}else n=null}while(n&&d);return n}function Sn(n,e,t,r,u){if(null==n)return null;var l,i=null;if("ordered"===u)for(i={},l=0;t>l;l++)i[n[l]]=1;return i}function Ln(n,e,t,r,u,l){var i,o,s,a,c,f,d,m,h,p,_,g,b,v,y=e[1],x=e[0];if(d=0,m=y-1,f=1,c=m,h=1,p=0,_=1,g=0,ce&u&&(h=-h,p=x-1-p,f=-f,c=m-c,_=-_,g=m-g),se&u&&(f=-f,c=m-c,_=-_,g=m-g),oe&u&&(t=-t),0>t)if("ordered+repeated"===r){for(i=c;i>=d&&m>=i&&0===n[i];)i-=f;if(i>=d&&m>=i)for(x-=1,n[i]=n[i]-1,o=i+f;o>=d&&m>=o;o+=f)n[o]=x;else n=null}else if("ordered"===r){for(null==l&&(l=Sn(n,x,y,u,r)),i=c,s=-1;-1===s&&i>=d&&m>=i;){if(h*n[i]+p-h>=0)for(o=h*n[i]+p-h;o>=0&&x>o;o-=h)if(a=h*o+p,null==l[a]){s=i,l[a]=1;break}l[n[i]]=null,i-=f}if(s>-1)for(n[s]=a,o=x-1-p,a=h*o+p,i=s+f;i>=d&&m>=i;i+=f){for(;o>=0&&x>o&&null!=l[a];)o-=h,a=h*o+p;n[i]=a,l[a]=1}else n=null}else if(v="repeated"===r,b=v?0:1,ce&u)if(f=-f,c=m-c,_=-_,g=m-g,i=m-c,o=0>f?d:m,!v&&n[o]+1>y||v&&n[o]>0){if(v)for(;i>=d&&m>=i&&0===n[i];)i+=f;else for(;i>=d&&m>=i&&_*i+g===n[i];)i+=f;for(n[i]-=1,i-=f;i>=d&&m>=i;)n[i]=n[i+f]-b,i-=f}else n=null;else{for(s=-1,i=c;i-f>=d&&m>=i-f;i-=f)if(n[i]>n[i-f]+b){s=i;break}if(!(s>=d&&m>=s)&&0<n[0>f?m:d]&&(s=0>f?m:d),s>=d&&m>=s){for(a=x-1+b,i=c;i>=d&&m>=i&&f*(i-s)>0;i-=f)a-=b,n[i]=a;n[s]--}else n=null}else if("ordered+repeated"===r){for(i=c;i>=d&&m>=i&&n[i]+1===x;)i-=f;if(i>=d&&m>=i)for(n[i]=n[i]+1,o=i+f;o>=d&&m>=o;o+=f)n[o]=0;else n=null}else if("ordered"===r){for(null==l&&(l=Sn(n,x,y,u,r)),i=c,s=-1;-1===s&&i>=d&&m>=i;){if(h*n[i]+p+h<x)for(o=h*n[i]+p+h;o>=0&&x>o;o+=h)if(a=h*o+p,null==l[a]){s=i,l[a]=1;break}l[n[i]]=null,i-=f}if(s>-1)for(n[s]=a,o=p,a=h*o+p,i=s+f;i>=d&&m>=i;i+=f){for(;o>=0&&x>o&&null!=l[a];)o+=h,a=h*o+p;n[i]=a,l[a]=1}else n=null}else if(v="repeated"===r,b=v?0:1,ce&u)if(f=-f,c=m-c,_=-_,g=m-g,i=m-c,!v&&n[i]+y<x||v&&n[i]+1<x){for(a=_*i+g;i+f>=d&&m>=i+f&&n[i]+b===n[i+f];)n[i]=a,i+=f,a+=b;n[i]+=1}else n=null;else{if(v){for(s=-1,o=x-1,i=c;i>=d&&m>=i;i-=f)if(n[i]<o){s=i;break}}else for(s=-1,o=x-y,i=c;i>=d&&m>=i;i-=f)if(n[i]<o+_*i+g){s=i;break}if(s>=d&&m>=s){if(a=n[s]+1,o=v?x-1:x-y+_*s+g,a===o)n[s]=a;else if(o>a)for(i=s;i>=d&&m>=i;i+=f)n[i]=a,a+=b}else n=null}return n}function Cn(n,e,t,r){var u,l,i,o,s,a,c,f,d=e,m=0,h=e-1;return o=1,c=1,f=0,ce&r?null:(se&r&&(o=-o),oe&r&&(t=-t),0>o?(u=e-(n[d]||1),l=e-1,s=l,a=u):(u=0,l=n[d]-1,s=u,a=l),0>t?0<n[d]?(i=n[a],i>m?1===n[d]||i>n[a-o]+1?(n[a]-=1,n[a+o]=h,n[d]++):n[d]--:n[d]=0):n=null:0===n[d]?(n[u]=c*m+f,n[d]=1):c*n[s]+f<h?c*n[a]+f<h?(n[a+o]=n[a]+c,n[d]++):(n[a-o]+=c,n[d]--):n=null,n)}function En(n,e,t,r,u){return null}function $n(n,e,t,r,u,l,i){var o,s,c,f,d,m,h,p,_,g,b=e;if(_=0,g=n.length-1,p=1,c=_,f=g,se&l&&(p=-p,c=g-c,f=g-f),oe&l&&(t=-t),0>t)if(r)n=null;else if(ce&l)n=null;else if(s=u?c+p:c,s>=_&&g>=s&&n[s]>1){for(o=f,h=0;o>=_&&g>=o&&p*(o-s)>=0&&1===n[o];)h+=n[o],o-=p;m=n[o]-1,h++,n[o]=m,n=0>p?n.slice(o):n.slice(0,o+1),h>m?(s=h%m,n=0>p?(s?[s]:[]).concat(a(Xn.floor(h/m),m)).concat(n):n.concat(a(Xn.floor(h/m),m)).concat(s?[s]:[])):h>0&&(n=0>p?[h].concat(n):n.concat([h]))}else n=null;else if(r)n=null;else if(ce&l)n=null;else if(u?(m=Xn.min(u,b-u),d=Xn.floor(b/u)+(b%u?1:0)-1,m=g>d||n[c+(d-1)*p]<m,s=c+p):(m=n[c]<b,s=c),s>=_&&g>=s&&m){for(g>0?(o=f-p,h=n[f]):(o=f,h=0);o>=_&&g>=o&&o-p>=_&&g>=o-p&&p*(o-s)>0&&n[o]===n[o-p];)h+=n[o],o-=p;n[o]++,h--,n=h>0?0>p?a(h,1).concat(n.slice(o)):n.slice(0,o+1).concat(a(h,1)):0>p?n.slice(o):n.slice(0,o+1)}else n=null;return n}function kn(n,e,t,r,u,l,i){var o,s,c,f,d,m,h,p,_=e;if(h=0,p=n.length-1,m=1,s=h,c=p,se&l&&(m=-m,s=p-s,c=p-c),oe&l&&(t=-t),0>t)if(r)if(u)n=null;else if(ce&l)if(f=n[s],_-r+1>f){for(n[s]=1,o=s+m;o>=h&&p>=o&&1===n[o];)o+=m;n[o]--,o-m>=h&&p>=o-m&&(n[o-m]=1+f)}else n=null;else if(f=n[c],_-r+1>f){for(n[c]=1,o=c;o>=h&&p>=o&&1===n[o];)o-=m;n[o]--,o+m>=h&&p>=o+m&&(n[o+m]=1+f)}else n=null;else if(u)n=null;else if(ce&l)n=null;else if(_>n.length){for(o=c,d=0;o>=h&&p>=o&&1===n[o];)o-=m,d++;f=n[o]-1,n[o]=f,d++,d>0&&(o+m>=h&&p>=o+m?(o+=m,n[o]=d,d=0,n=0>m?n.slice(o):n.slice(0,o+1)):n=0>m?a(d,1,0).concat(n):n.concat(a(d,1,0)))}else n=null;else if(r)if(u)n=null;else if(ce&l)if(_-r+1>n[c]){for(o=s;o>=h&&p>=o&&1===n[o];)o+=m;f=n[o],n[o]=1,n[s]=f-1,o+m>=h&&p>=o+m&&n[o+m]++}else n=null;else if(_-r+1>n[s]){for(o=c;o>=h&&p>=o&&1===n[o];)o-=m;f=n[o],n[o]=1,n[c]=f-1,o-m>=h&&p>=o-m&&n[o-m]++}else n=null;else u?n=null:ce&l?n=null:_>n[s]?(d=n[c],n[c-m]++,0>m?(n.shift(),n.unshift.apply(n,a(d-1,1,0))):(n.pop(),n.push.apply(n,a(d-1,1,0)))):n=null;return n}var Dn,Rn,Nn,Un,Pn,Tn,jn={VERSION:"0.8.8"},Xn=Math,Jn="prototype",Vn="constructor",Gn=Array.prototype.slice,Fn=Object[Jn].hasOwnProperty,Hn=Object[Jn].toString,Wn=Xn.log2||function(n){return Xn.log(n)/Xn.LN2},Bn=/^\s+|\s+$/g,Yn=(String.prototype.trim?function(n){return n.trim()}:function(n){return n.replace(Bn,"")},/\[(\d+)\]/g),zn=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,Kn=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,Qn=Object.create,Zn=function(n,e){for(var t in e)Fn.call(e,t)&&(n[t]=e[t]);return n},ne=function(n,e){1===arguments.length&&(e=n,n=Object);var t=e[Vn];return Fn.call(e,"__static__")&&(t=Zn(t,e.__static__),delete e.__static__),t[Jn]=Zn(Qn(n[Jn]),e),t},ee=1,te=-1,re=3,ue=-3,le=-2,ie=2,oe=1,se=2,ae=4,ce=8,fe=16,de=32,me=ae|ce|fe,he=me|de|oe|se;return k.mem1={},k.mem2={},k.mem3={},D.mem1={},D.mem2={},R.mem={},N.mem={},U.mem={},P.mem={},T.mem={},j.mem={},X.mem={},jn.Class=ne,jn.Options={MAXMEM:1e6,RANDOM:"index"},J.LEX=J.LEXICOGRAPHIC=ae,J.COLEX=J.COLEXICOGRAPHIC=ce,J.MINIMAL=J.GRAY=fe,J.RANDOM=de,J.REV=J.ANTI=J.REVERSE=J.REVERSED=oe,J.REF=J.REFLECT=J.REFLECTED=se,J.REVLEX=J.ANTILEX=J.REVERSELEXICOGRAPHIC=J.ANTILEXICOGRAPHIC=ae|oe,J.REFLEX=J.REFLECTEDLEXICOGRAPHIC=ae|se,J.REVCOLEX=J.ANTICOLEX=J.REVERSECOLEXICOGRAPHIC=J.ANTICOLEXICOGRAPHIC=ce|oe,J.REFCOLEX=J.REFLECTEDCOLEXICOGRAPHIC=ce|se,jn.ORDER=J,jn.Math={O:0,I:1,J:-1,N:function(n){return jn.Arithmetic.add(jn.Arithmetic.O,n)},V:function(n){return jn.Arithmetic.sub(jn.Arithmetic.O,n)},rnd:Xn.random,rndInt:function(n,e){return jn.Math.round((e-n)*jn.Math.rnd()+n)},equ:function(n,e){return n===e},gte:function(n,e){return n>=e},lte:function(n,e){return e>=n},gt:function(n,e){return n>e},lt:function(n,e){return e>n},inside:function(n,e,t,r){return r?n>=e&&t>=n:n>e&&t>n},clamp:function(n,e,t){return e>n?e:n>t?t:n},wrap:function(n,e,t){return e>n?t:n>t?e:n},wrapR:function(n,e){return 0>n?n+e:n},add:I,sub:function(n,e){return n-e},mul:S,div:function(n,e){return jn.Math.floor(n/e)},mod:function(n,e){return n%e},pow:Xn.pow,shl:function(n,e){return n<<e},shr:function(n,e){return n>>e},bor:function(n,e){return n|e},band:function(n,e){return n&e},xor:function(n,e){return n^e},abs:Xn.abs,min:Xn.min,max:Xn.max,floor:Xn.floor,ceil:Xn.ceil,round:Xn.round,num:function(n){return"number"==typeof n?jn.Math.floor(n):parseInt(n,10)},val:function(n){return jn.Math.floor(n.valueOf())},sum:L,product:C,pow2:E,exp:$,factorial:k,stirling:D,partitions:N,compositions:P,bell:j,catalan:T,fibonacci:X},jn.Arithmetic={isDefault:function(){return 0===jn.Arithmetic.O&&jn.Arithmetic.add===I},O:0,I:1,J:-1,N:jn.Math.N,V:jn.Math.V,equ:jn.Math.equ,gte:jn.Math.gte,lte:jn.Math.lte,gt:jn.Math.gt,lt:jn.Math.lt,inside:jn.Math.inside,clamp:jn.Math.clamp,wrap:jn.Math.wrap,wrapR:jn.Math.wrapR,add:jn.Math.add,sub:jn.Math.sub,mul:jn.Math.mul,div:jn.Math.div,mod:jn.Math.mod,pow:jn.Math.pow,shl:jn.Math.shl,shr:jn.Math.shr,bor:jn.Math.bor,band:jn.Math.band,xor:jn.Math.xor,abs:jn.Math.abs,min:jn.Math.min,max:jn.Math.max,floor:jn.Math.floor,ceil:jn.Math.ceil,round:jn.Math.round,rnd:jn.Math.rndInt,num:jn.Math.num,val:jn.Math.val},jn.Util={array:a,operate:s,intersection:b,difference:v,union:y,search:q,complementation:f,reflection:d,reversion:m,gray:h,finitedifference:_,partialsum:g,sort:A,shuffle:M,pick:O,pluck:c},jn.BitArray=ne({constructor:function pe(n){
var e=this;return e instanceof pe?(e.length=n,void(e.bits=new Uint32Array(Xn.ceil(n/32)))):new pe(n)},length:0,bits:null,dispose:function(){var n=this;return n.length=null,n.bits=null,n},clone:function(){var n=this,e=new jn.BitArray(n.length);return e.bits=new Uint32Array(n.bits),e},fromArray:function(n){var e=this;return e.bits=new Uint32Array(n),e},toArray:function(){return Gn.call(this.bits)},toString:function(){var n,e,t=this.toArray();for(n=0,e=t.length;e>n;n++)t[n]=o(t[n]);return t.join("")},reset:function(){var n,e=this,t=e.bits,r=t.length;for(n=0;r>n;n++)t[n]=0;return e},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){var e=this;return e.bits[n>>>5]|=1<<(31&n),e},unset:function(n){var e=this;return e.bits[n>>>5]&=~(1<<(31&n)),e},toggle:function(n){var e=this;return e.bits[n>>>5]^=1<<(31&n),e}}),Dn=jn.CombinatorialIterator=ne({constructor:function _e(n,e,r,u){var l,i=this;jn.Arithmetic;if(!(i instanceof _e))return new _e(n,e,r,u);if(l=i[Vn],t(n)&&(n[0]instanceof _e||n[n.length-1]instanceof _e)){i.$=r=e||{},r.seq=n,n=null,i.n=e=r.seq.length,r.type="sequence",r.rand=r.rand||{},r.rand.sequence=1;var o=1/0,a=-(1/0),c=1/0,f=-(1/0);s(function(n,e){var t=e.base(),r=e.dimension();t>a&&(a=t),o>t&&(o=t),r>f&&(f=r),c>r&&(c=r)},null,r.seq),r.base=r.maxbase=a,r.minbase=o,r.dimension=r.maxdimension=f,r.mindimension=c}else i.n=e||0,i.$=r=r||{};i.name=n||"CombinatorialIterator",r.type=String(r.type||"default").toLowerCase(),r.order=r.order||ae,r.rand=r.rand||{},r.sub=null,r.instance=i,i.init().order(r.order),u&&u.iter instanceof _e&&i.fuse(u.method,u.iter,u.pos,u.cascade)},__static__:{Iterable:function ge(n,e){var t=this;return t instanceof ge?(e=-1===e?-1:1,void(t.next=function(){return n.hasNext(e)?{value:n.next(e)}:{done:!0}})):new ge(n,e)},C:function(n,e,t){if(t+1===n.length){var r=-1===n[0];n=r?n.slice(t-n[t],t):n.slice(0,n[t]),n=f(n,n,e),n=(r?(n.length<t?new Array(t-n.length):[]).concat(n):n.concat(n.length<t?new Array(t-n.length):[])).concat(n.length)}else f(n,n,e);return n},P:function(n,e){return e+1===n.length?-1===n[0]?(n=p(n,d(n,n,e,e-(n[e]||1),e-1),-e+n[e],e-(n[e]||1),e-1),1>n[e]&&(n[0]=0)):(n=p(n,d(n,n,e,0,n[e]-1),e-n[e],0,n[e]-1),e>n[e]&&(n[0]=-1)):d(n,n),n},T:function(n,e){return m(n,e)},DUAL:function(n,e,t){if(null==n)return null;if(t&&"sequence"===t.type)return n;var r=this,u=r.C,l=r.P,i=(r.T,t&&null!=t.base?t.base:e),o=t&&null!=t.dimension?t.dimension:e,s=t&&null!=t.order?t.order:ae;return n=de&s?se&s?l(n,o):n:fe&s?se&s?l(n,o):n:ce&s?se&s?u(n,i,o,t):l(u(n,i,o,t),o):se&s?l(n,o):n},count:function(n,e){var t=jn.Arithmetic,r=t.O;return e&&"sequence"===e.type&&e.seq&&e.seq.length?s(function(n,e){return t.add(n,e.total())},r,e.seq):r},initial:function(n,e,t,r){return e&&"sequence"===e.type&&e.seq&&e.seq.length?!0===r?this.succ(0,0,n,e,t):(t=-1===t?-1:1,0>t?e.seq[e.seq.length-1].item0(-1):e.seq[0].item0(1)):null},succ:function(n,e,t,r,u,l){if(null==t||null==n)return null;var i=this,o=jn.Arithmetic;if(u=-1===u?-1:1,r&&"sequence"===r.type){if(!r.seq||!r.seq.length)return null;for(;0<=r.seq_curr&&r.seq_curr<r.seq.length&&!r.seq[r.seq_curr].hasNext(u);)r.seq_curr+=u;return 0<=r.seq_curr&&r.seq_curr<r.seq.length?r.seq[r.seq_curr].next(u):null}return null==e?null:i.unrank(o.add(e,0>u?o.J:o.I),t,r)},rand:function(n,e){var t,r=this,u=jn.Arithmetic,l=e&&null!=e.last?e.last:u.sub(r.count(n,e),u.I),i=u.O,o=u.rnd(i,l);return e&&"sequence"===e.type?e.seq&&e.seq.length?e.seq[jn.Math.rndInt(0,e.seq.length-1)].random():null:t=u.equ(i,o)?r.initial(n,e,1):u.equ(l,o)?r.initial(n,e,-1):r.unrank(o,n,e)},rank:e,unrank:e,fusion:function(n,e,t,r,u,l,i){if(-1===i){var o=e;e=t,t=o}if(null==e||null==t)return e||t||null;if("multiply"===n)return V(!0,e,t);if("add"===n||"connect"===n||"concat"===n){var s=e.length?e[0]+1:0;return a(e.length+t.length,"add"===n?function(n){return n<e.length?e[n]:e.length+t[n-e.length]}:"connect"===n?function(n){return n<e.length?(e[n]+1>s&&(s=e[n]+1),e[n]):s+t[n-e.length]}:function(n){return n<e.length?e[n]:t[n-e.length]})}if("complete"===n||"interleave"===n||"combine"===n){var c=e.length,f=t.length,d=c+f,m=0,h=0,p=0,_=c>h?e[h]:-1,g=null!=l?h<l.length?l[h]:-1:_,b="complete"===n?W(u,e,!0):null;return a(d,"complete"===n?function(n){var r;return g===n?(r=_,h++,_=c>h?e[h]:-1,g=null!=l?h<l.length?l[h]:-1:_):r=b[t[m++]],r}:"interleave"===n?function(n){var r;return g===n?(r=_,h++,_=c>h?e[h]:-1,g=null!=l?h<l.length?l[h]:-1:_):r=t[m++],r}:function(n){var r;return _===n?(r=_,h++,_=c>h?e[h]:-1,p++):r=p+t[m++],r})}return a(e.length,function(n){return 0<=e[n]&&e[n]<t.length?t[e[n]]:e[n]})},output:function(n,e,l,i){var o=i&&i.type?i.type:null,a=i&&null!=i.output?i.output:null;return null==n?null:null==a?"sequence"===o?n:n.slice():u(a)?a(n,l):t(a)?s(function(n,e,t){return n[t]=e>=0&&e<a.length?a[e]:e,n},new Array(n.length),n):r(a)?s(function(n,e,t){return n+=e>=0&&e<a.length?a.charAt(e):String(e)},"",n):"sequence"===o?n:n.slice()}},name:"CombinatorialIterator",n:0,$:null,__index:null,_index:null,__item:null,item__:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var e=this;return!0!==n&&e.$.sub&&(e.$.sub.dispose(),e.$.sub=null),"sequence"===e.$.type&&e.$.seq&&e.$.seq.length&&s(function(n,e){e.dispose()},null,e.$.seq),e.name=null,e.n=null,e.$=null,e.__index=null,e._index=null,e.__item=null,e.item__=null,e._item=null,e.__subindex=null,e._subindex=null,e.__subitem=null,e._subitem=null,e._prev=null,e._next=null,e._traversed&&(e._traversed.dispose(),e._traversed=null),e},init:function(){var n=this,e=n[Vn],t=n.$,r=n.n,u=jn.Arithmetic;return t.base=t.base||0,t.minbase=null!=t.minbase?t.minbase:t.base,t.maxbase=null!=t.maxbase?t.maxbase:t.base,t.dimension=t.dimension||0,t.mindimension=null!=t.mindimension?t.mindimension:t.dimension,t.maxdimension=null!=t.maxdimension?t.maxdimension:t.dimension,t.count=e.count(r,t),t.first=u.O,t.last=u.gt(t.count,u.O)?u.sub(t.count,u.I):u.J,n},fuse:function(n,e,t,r){var u=this,l=u.$;return 1===arguments.length&&!1===n?l.sub&&(l.sub=null,l.submethod=null,l.subpos=null,l.subcascade=null,l.subcount=null,l.subdimension=null,l.subposition=null,u.rewind()):e instanceof Dn&&(n=String(n||"project").toLowerCase(),t=t||null,r=-1===r?-1:1,l.sub=e,l.submethod=n,l.subpos=t,l.subcascade=r,l.subcount=jn.Arithmetic.mul(l.count,l.sub.total()),"multiply"===n?l.subdimension=l.dimension*l.sub.dimension():"add"===n||"connect"===n||"concat"===n||"complete"===n||"interleave"===n||"combine"===n?l.subdimension=l.dimension+l.sub.dimension():l.subdimension=l.dimension,u.rewind()),u},unfuse:function(){return this.fuse(!1)},multiplyWith:function(n,e){return this.fuse("multiply",n,null,e)},addWith:function(n,e){return this.fuse("add",n,null,e)},connectWith:function(n,e){return this.fuse("connect",n,null,e)},concatWith:function(n,e){return this.fuse("concat",n,null,e)},completeWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("complete",n,e||this.position(),t)},interleaveWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("interleave",n,e||this.position(),t)},combineWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("combine",n,e||this.position(),t)},projectOn:function(n,e){return this.fuse("project",n,null,e)},base:function(n){var e=this.$;return e.sub&&!0!==n?e.subbase||e.base||0:e.base||0},dimension:function(n){var e=this.$;return e.sub&&!0!==n?e.subdimension||e.dimension||0:e.dimension||0},position:function(n){var e=this.$;return e.sub&&!0!==n?e.subposition||e.position||null:e.position||null},total:function(n){var e=this.$;return e.sub&&!0!==n?e.subcount||e.count||0:e.count||0},_reset:function(n){var e,t,r,u=this,l=u[Vn],i=u.$,o=u.n,s=jn.Arithmetic,a=s.O,c=(s.I,i.order);return u.__index=u._index=a,u._item=u.__item=u.item__=null,u._prev=!1,u._next=!1,t=i.count,r=i.last,"sequence"===i.type&&(i.seq_curr=i.seq&&i.seq.length?0>n?i.seq.length-1:0:-1),de&c?("gen"===jn.Options.RANDOM||1===i.rand[i.type]||s.gt(t,jn.Options.MAXMEM)||s.isDefault()&&0>t?(u.__item=l.rand(o,i),u.__index=a):(u._traversed&&u._traversed.dispose(),u._traversed=new jn.BitArray(s.val(t)),e=u.random("index"),u._traversed.set(+e),u.__item=l.unrank(e,o,i),null!=u.__item&&(u.__index=e)),u._index=a):(u.__item=l.initial(o,i,n,!0),null!=u.__item&&(u.__index=0>n?r:a,u._update()),u._index=u.__index),u._item=l.output(u.__item,u.__index,o,i),u._prev=de&c||n>0?!1:null!=u.__item,u._next=0>n&&!(de&c)?!1:null!=u.__item,u},_update:function(){return this.item__=null,this},order:function(n,e){if(!arguments.length)return this._order;var t,u,l,i,o,s,a,c=this,f=c[Vn],d=jn.Arithmetic,m=(d.O,d.I,!0===n);if(e=-1===e,l=c.n,i=c.$,c._traversed&&(c._traversed.dispose(),c._traversed=null),m?n=i.order:r(n)&&-1<(u=n.indexOf("|"))?(t=n.substr(u+1),n=J(n.substr(0,u))):t=n=J(n),o=e?-1:1,i.order=n,i.sub?(m?i.sub.rewind(o):i.sub.order(t,o),c.__subindex=i.sub.index(),c.__subitem=i.sub.next(o),c._subindex=null,c._subitem=null):(c.__subindex=null,c.__subitem=null,c._subindex=null,c._subitem=null),"sequence"===i.type&&i.seq&&i.seq.length)for(s=0,a=i.seq.length;a>s;s++)m?i.seq[s].rewind(o):i.seq[s].order(n,o);return c._reset(o),i.sub&&(c._prev=c._prev&&null!=c.__subitem,c._next=c._next&&null!=c.__subitem,c._subindex=d.add(d.mul(c.__subindex,i.count),c._index),c._subitem=f.fusion(i.submethod,c._item,c.__subitem,c.dimension(),c.base(),i.subpos,i.subcascade)),c},index:function(n,e){if(e=!0===e,!arguments.length)return this.$.sub?this._subindex:this._index;var t,r=this,u=r[Vn],l=jn.Arithmetic,i=l.O,o=(l.I,l.J),s=r.n,a=r.$,c=a.sub&&!e?a.subcount:a.count,f=a.sub&&!e?r._subindex:r._index,d=a.order;return n=l.wrapR(l.N(n),c),!l.equ(n,f)&&l.inside(n,o,c)&&(c=a.count,t=a.last,a.sub&&!e&&(a.sub.index(l.div(n,c)),r.__subindex=a.sub.index(),r.__subitem=a.sub.item(),n=l.mod(n,c)),de&d||(r.__index=n,r._index=n,r.__item=l.equ(i,n)?u.initial(s,a,1):l.equ(t,n)?u.initial(s,a,-1):u.unrank(n,s,a),r._update(),r._item=u.output(r.__item,r.__index,s,a),r._prev=null!=r.__item,r._next=null!=r.__item),a.sub&&(r._prev=r._prev&&null!=r.__subitem,r._next=r._next&&null!=r.__subitem,r._subindex=l.add(l.mul(r.__subindex,c),r._index),r._subitem=u.fusion(a.submethod,r._item,r.__subitem,r.dimension(),r.base(),a.subpos,a.subcascade))),r},item0:function(n){var e=this;return e[Vn].initial(e.n,e.$,-1===n?-1:1)},item:function(n,e){if(!arguments.length)return this.$.sub?this._subitem:this._item;var u,l,i,o,s,a,c=this,f=c[Vn],d=c.n,m=c.$,h=m.sub?m.subcount:m.count,p=m.sub?c._subindex:c._index,_=jn.Arithmetic,g=_.O,b=(_.I,_.J),v=null;return r(e)?-1<(a=e.indexOf("|"))?(v=e.substr(a+1),e=J(e.substr(0,a))):v=e=J(e):null!=e?v=e=J(e):(e=m.order,v=null),m.sub||(v=null),t(n)?(h=m.count,u=m.last,i=m.order,m.order=e,c.__item=n.slice(),c._update(),c.__index=f.rank(c.__item,d,m),c._item=f.output(c.__item,c.__index,d,m),de&e?c._index=c.__index:c._index=c.__index,c._prev=null!=c.__item,c._next=null!=c.__item,c):(n=_.wrapR(_.N(n),h),e===m.order&&null===v&&_.equ(n,p)?m.sub?c._subitem:c._item:_.inside(n,b,h)?(s=null,h=m.count,u=m.last,m.sub&&(s=m.sub.item(_.div(n,h),v),n=_.mod(n,h)),de&e?(l=null,i=m.order,m.order=e,o=f.output(f.rand(d,m),l,d,m),m.order=i,m.sub&&(o=f.fusion(m.submethod,o,s,c.dimension(),c.base(),m.subpos,m.subcascade)),o):(l=n,i=m.order,m.order=e,o=f.output(_.equ(g,n)?f.initial(d,m,1):_.equ(u,n)?f.initial(d,m,-1):f.unrank(l,d,m),l,d,m),m.order=i,m.sub&&(o=f.fusion(m.submethod,o,s,c.dimension(),c.base(),m.subpos,m.subcascade)),o)):null)},random:function(n,e,t,r){var u,l=this,i=l[Vn],o=l.$,s=o.order;if(r=!0===r,"index"===n){var a,c,f=jn.Arithmetic,d=f.N,m=f.O,h=f.I;return e===!!e&&(r=e,e=null,t=null),o.sub&&!r?(a=o.subcount,c=f.sub(a,h)):(a=o.count,c=o.last),null==e&&null==t?(e=m,t=c):null==t?(e=d(e||0),t=c):(e=d(e),t=d(t)),f.rnd(e,t)}return o.order|=de,u=i.rand(l.n,o),o.order=s,u=i.output(u,null,l.n,o),o.sub&&!r?i.fusion(o.submethod,u,o.sub.random(),l.dimension(),l.base(),o.subpos,o.subcascade):u},rewind:function(n){var e=this;return e.order(!0,-1===n?-1:1)},hasNext:function(n){var e=this;return-1===n?de&e.$.order?!1:e._prev:e._next},next:function(n){var e,t,r,u,o,s,a=this,c=a[Vn],f=jn.Arithmetic,d=f.O,m=f.I,h=f.J,p=a.n,_=a.$,g=_.order,b=_.count,v=_.sub?a._subitem:a._item,y=null!=v;if(n=-1===n?-1:1,0>n&&de&g)return null;if(e=0>n?h:m,de&g)if(u=_.last,f.lt(a._index,u))if(t=a._traversed){for(r=a.random("index"),o=jn.Math.rnd()>.5?h:m;t.isset(+r);)r=f.wrap(f.add(r,o),d,u);t.set(+r),a.__item=c.unrank(r,p,_),null!=a.__item&&(a.__index=r)}else a.__item=c.rand(p,_),a.__index=null;else a._item=a.__item=null,a._traversed&&(a._traversed.dispose(),a._traversed=null);else a.__item=c.succ(a.__item,a.__index,p,_,n,a.item__),null!=a.__item&&(a.__index=f.add(a.__index,e));if(s=null!=a.__item)a._index=f.add(a._index,e),null===a.__index&&(a.__index=a._index),0>n?(a._prev=s,a._next=y):(a._prev=y,a._next=s);else if(_.sub&&_.sub.hasNext(n)){if(a.__subindex=_.sub.index(),a.__subitem=_.sub.next(n),"sequence"===_.type&&_.seq&&_.seq.length)for(i=0,l=_.seq.length;i<l;i++)_.seq[i].rewind(n);a._reset(n),s=null!=a.__item}else a.__subindex=null,a.__subitem=null,0>n?(a._prev=s,a._next=y):(a._prev=y,a._next=s);return a._item=c.output(a.__item,a.__index,p,_),_.sub&&(s=s&&null!=a.__subitem,a._subindex=s?f.add(f.mul(a.__subindex,b),a._index):null,a._subitem=s?c.fusion(_.submethod,a._item,a.__subitem,a.dimension(),a.base(),_.subpos,_.subcascade):null,0>n?a._prev=s:a._next=s),v},range:function(n,e){var t,r,u,l,i=this,o=jn.Arithmetic,a=o.N,c=o.O,f=o.I,d=i.$,m=d.sub?d.subcount:d.count,h=d.sub?o.sub(m,f):d.last,p=1,_=arguments.length,g=!(de&d.order);return 1>_?(n=c,e=h):2>_?(n=a(n),e=h):(n=a(n),e=a(e)),n=o.wrapR(n,m),e=o.wrapR(e,m),o.gt(n,e)&&(t=n,n=e,e=t,p=-1),n=o.clamp(n,c,h),g&&(e=o.clamp(e,c,h)),o.lte(n,e)?(l=[i.$.order,i.__index,i._index,i.__item&&i.__item.slice(),i._item,i.__subindex,i._subindex,i.__subitem,i._subitem,i._prev,i._next],g&&i.index(n),u=o.val(o.sub(e,n)),r=s(function(n,e,t){return n[t]=i.next(),n},new Array(u+1),null,0>p?u:0,0>p?0:u,0>p?-1:1),i.$.order=l[0],i.__index=l[1],i._index=l[2],i.__item=l[3],i._item=l[4],i.__subindex=l[5],i._subindex=l[6],i.__subitem=l[7],i._subitem=l[8],i._prev=l[9],i._next=l[10],i._update()):r=[],r},__iter__:function(){return new Dn.Iterable(this)}}),"undefined"!=typeof Symbol&&"undefined"!=typeof Symbol.iterator&&(Dn[Jn][Symbol.iterator]=Dn[Jn].__iter__),Rn=jn.Tensor=ne(Dn,{constructor:function be(){var n,e=this,u=null,l=Gn.call(arguments);if(n=!l.length||l[l.length-1]instanceof Dn||t(l[l.length-1])||l[l.length-1]===+l[l.length-1]?{}:l.pop()||{},l.length&&t(l[0])&&(l=l[0]),l&&l.length||(l=[]),!(e instanceof be))return new be(l,n);if(n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||ae,n.rand=n.rand||{},"partial"===n.type){l=t(l)&&l.length?l[0]:l;var i=-1,o=n.data||[],c=n.position||null;l instanceof Dn?(u=l,l=u.base(),i=l):u=n.sub,l=+(l||0)||0,o.length&&(r(o[0])||o[0].length&&(!0===o[0][0]||!1===o[0][0]))&&(i===l&&(l+=o.length,i=-1),o=be.generate(l,o,c,n.ordering||null)),i===l&&(l+=(o.length?o[0].length:0)||0,i=-1),n.data=o,n.position=c||a((o.length?o[0].length:0)||0,0,1),n.dimension=n.position.length,n.base=l,n.rand.partial=1}else if("tuple"===n.type)l[0]=l[0]||1,l[1]=l[1]||1,l[0]instanceof Dn?(u=l[0],l[0]=u.dimension()):l[1]instanceof Dn?(u=l[1],l[1]=u.base()):u=n.sub,n.base=l[1],n.dimension=l[0],"gray"===n.output&&(n.output=function(n,e){return be.gray(n,e[1])});else{var f=s(function(n,e){return e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e),n},[1/0,0],l);n.base=l,n.minbase=f[0],n.maxbase=f[1],n.dimension=l.length,"gray"===n.output&&(n.output=function(n,e){return be.gray(n,e)})}Dn.call(e,"Tensor",l,n,u?{method:"partial"===n.type?n.submethod||"complete":n.submethod,iter:u,pos:"partial"===n.type?n.subpos||n.position:n.subpos,cascade:n.subcascade}:null)},__static__:{C:Dn.C,P:Dn.P,T:Dn.T,DUAL:Dn.DUAL,count:function(n,e){var t=jn.Arithmetic.O,r=e&&e.type?e.type:"tensor";return"partial"===r?e.data&&e.data.length?jn.Arithmetic.N(e.data.length):t:"tuple"===r?!n||0>=n[0]?t:jn.Math.exp(n[1],n[0]):n&&n.length?jn.Math.product(n):t},initial:function(n,e,t){var r,u=this,l=e&&e.type?e.type:"tensor",i=e&&e.order?e.order:ae;return t=-1===t?-1:1,(!(ce&i)&&oe&i||ce&i&&!(oe&i))&&(t=-t),"partial"===l?r=e.data&&e.data.length?0>t?e.data[e.data.length-1]:e.data[0]:null:(r="tuple"===l?n[0]?0>t?a(n[0],n[1]-1,0):a(n[0],0,0):[]:n.length?0>t?a(n.length,function(e){return n[e]-1}):a(n.length,0,0):[],r=u.DUAL(r,n,e)),r},succ:function(n,e,t,r,u,l){if(!t||null==n)return null;var i=r&&r.type?r.type:"tensor",o=r&&null!=r.order?r.order:ae;if(u=-1===u?-1:1,"partial"===i){if(!r.data||!r.data.length)return null;oe&o&&(u=-u);var s=null==e?r.data.indexOf(n):jn.Arithmetic.val(e);return 0>u?s-1>=0?r.data[s-1]:null:s>=0&&s+1<r.data.length?r.data[s+1]:null}return!t[0]||0>=t[0]?null:On(n,t,u,i,o,l)},rand:function(n,e){var t,r=jn.Math.rndInt,u=this,l=e&&e.type?e.type:"tensor";return"partial"===l?t=e.data&&e.data.length?e.data[r(0,e.data.length-1)]:null:(t="tuple"===l?n[0]?a(n[0],function(e){return r(0,n[1]-1)}):[]:n.length?a(n.length,function(e){return r(0,n[e]-1)}):[],t=u.DUAL(t,n,e)),t},randu:Dn.rand,rank:function(n,e,t){var r,u,l,i=this,o=jn.Arithmetic,s=t&&null!=t.order?t.order:ae,a=t&&t.type?t.type:"tensor",c=o.add,f=o.sub,d=o.mul,r=o.O,m=o.J;if("partial"===a)r=o.N(t.data&&t.data.length?t.data.indexOf(n):-1);else if(n=i.DUAL(n,e,t),"tuple"===a){if(u=e[0],!u)return m;for(e=e[1],l=0;u>l;l++)r=c(d(r,e),n[l])}else{if(u=e.length,!u)return m;for(l=0;u>l;l++)r=c(d(r,e[l]),n[l])}return(!(ce&s)&&oe&s||ce&s&&!(oe&s))&&(r=f(t&&null!=t.last?t.last:f(i.count(e,t),o.I),r)),r},unrank:function(n,e,t){var r,u,l,i,o,s,a=this,c=jn.Arithmetic,f=t&&null!=t.order?t.order:ae,d=t&&t.type?t.type:"tensor",m=c.sub,h=c.mod,p=c.div,_=c.val;if(null==n||!c.inside(n,c.J,t&&null!=t.count?t.count:a.count(e,t)))return null;if((!(ce&f)&&oe&f||ce&f&&!(oe&f))&&(n=m(t&&null!=t.last?t.last:m(a.count(e,t),c.I),n)),"partial"===d){if(!t.data||!t.data.length)return null;n=_(n),o=n>=0&&n<t.data.length?t.data[n]:null}else{if("tuple"===d){if(s=e[0],!s)return[];for(o=new Array(s),u=e[1],r=n,l=s-1;l>=0;l--)i=h(r,u),r=p(r,u),o[l]=_(i)}else{if(s=e.length,!s)return[];for(o=new Array(s),r=n,l=s-1;l>=0;l--)u=e[l],i=h(r,u),r=p(r,u),o[l]=_(i)}o=a.DUAL(o,e,t)}return o},fusion:Dn.fusion,output:function(n,e,r,u){var l=this;return null==n?null:u&&"tensor"===u.type&&t(u.output)?l.component(n,u.output):Dn.output.call(l,n,e,r,u)},gray:function(n,e){return h(new Array(n.length),n,e)},product:V,directsum:G,component:function(n,e){return null==n?null:null==e?n:a(n.length,function(t){return t<e.length&&0<=n[t]&&n[t]<e[t].length?e[t][n[t]]:n[t]})},conditional:F,generate:H}}),Nn=jn.Permutation=ne(Dn,{constructor:function ve(n,e){var r=this,u=null;return r instanceof ve?(e=e||{},e.type=String(e.type||"permutation").toLowerCase(),n=n||0,n instanceof Dn?(u=n,n=u.dimension()):u=e.sub,e.base=e.dimension=n,e.rand=e.rand||{},e.rand.derangement=1,e.rand.involution=1,e.rand.connected=1,"multiset"===e.type&&(e.multiplicity=t(e.multiplicity)&&e.multiplicity.length?e.multiplicity.slice():a(n,1,0),e.multiplicity=e.multiplicity.concat(a(n-s(I,0,e.multiplicity),1,0)),e.base=e.multiplicity.length,e.multiset=rn(e.multiplicity,n)),void Dn.call(r,"Permutation",n,e,u?{method:e.submethod,iter:u,pos:e.subpos,cascade:e.subcascade}:null)):new ve(n,e)},__static__:{C:Dn.C,P:Dn.P,T:Dn.T,DUAL:Dn.DUAL,count:function(n,e){var t=jn.Arithmetic,r=t.O,u=jn.Math.factorial,l=jn.Math.stirling,i=e&&e.type?e.type:"permutation",o=e&&null!=e["cycles="]?0|e["cycles="]:null,s=e&&null!=e["fixed="]?0|e["fixed="]:null;return 0>n?r:"cyclic"===i?t.N(n):"multiset"===i?u(n,e.multiplicity):"derangement"===i?s?2>n-s?r:t.mul(u(n,s),u(n-s,!1)):2>n?r:u(n,!1):"involution"===i?u(n,!0):"connected"===i?u(n-1):o?l(n,o,1):u(n)},initial:function(n,e,t){var r,u=this,l=e&&e.type?e.type:"permutation",i=e&&null!=-e.order?e.order:ae,o=e&&null!=e["cycles="]?0|e["cycles="]:null,s=e&&null!=e["fixed="]?0|e["fixed="]:null;if(0===n)return[];if(t=-1===t?-1:1,(!(ce&i)&&oe&i||ce&i&&!(oe&i))&&(t=-t),"cyclic"===l)r=0>t?[n-1].concat(a(n-1,0,1)):a(n,0,1);else if("derangement"===l){if(s||2>n)return null;if(1&n){var c=Xn.floor(n/2);r=0>t?a(n-c-1,n-1,-1).concat([c-1,c]).concat(a(c-1,c-2,-1)):a(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=0>t?a(n,n-1,-1):a(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===l?0>t?e.multiset.slice().reverse():e.multiset.slice():"connected"===l?null:"involution"===l?0>t?a(n,n-1,-1):a(n,0,1):o?null:0>t?a(n,n-1,-1):a(n,0,1);return r=u.DUAL(r,n,e)},succ:function(n,e,t,r,u,l){if(!t||0>=t||null==n)return null;var i=r&&r.type?r.type:"permutation",o=r&&null!=r["cycles="]?0|r["cycles="]:null,s=r&&null!=r["fixed="]?0|r["fixed="]:null;return"derangement"===i&&s||"permutation"===i&&o?null:(u=-1===u?-1:1,In(n,t,u,i,r&&null!=r.order?r.order:ae,r&&null!=r.base?r.base:null,l))},rand:function(n,e){var t,r=jn.Math.rndInt,u=this,l=e&&e.type?e.type:"permutation",i=e&&null!=e["cycles="]?0|e["cycles="]:null,o=e&&null!=e["fixed="]?0|e["fixed="]:null;if(0===n)return[];if("cyclic"===l){var s=r(0,n-1);t=s>0?a(n-s,s,1).concat(a(s,0,1)):a(n,0,1)}else if("derangement"===l){if(o)return null;t=new Array(n);var c,f,d,m=!1;do{for(c=0;n>c;c++)t[c]=c;for(c=n-1,m=!1;c>=0;){if(d=r(0,c),t[d]===c){m=!0;break}f=t[c],t[c]=t[d],t[d]=f,c--}m=m||0===t[0]}while(m)}else if("involution"===l){t=a(n,0,1);for(var h,p,_,g,f,b,v=jn.Math.rnd,y=.5,x=1,A=n,w=[1].concat(a(n-1,function(){var n=y;return x+=1,y=1/(1+x*y),n})),O=a(n,0,1);A>=2;)h=A-1,p=O[h],--A,y=w[A],f=v(),f>y&&(_=r(0,A-1),g=O[_],--A,b=O[_],O[_]=O[A],O[A]=b,b=t[g],t[g]=t[p],t[p]=b)}else if("multiset"===l)t=M(e.multiset.slice());else if("connected"===l)t=M(a(n,0,1),!0);else{if(i)return null;t=M(a(n,0,1))}return t=u.DUAL(t,n,e)},randu:Dn.rand,rank:function(n,t,r){var u,l,i,o,s,a=this,c=jn.Arithmetic,f=r&&r.type?r.type:"permutation",d=r&&null!=r["cycles="]?0|r["cycles="]:null,m=(r&&null!=r["fixed="]?0|r["fixed="]:null,r&&null!=-r.order?r.order:ae),h=c.sub,p=c.add,_=c.mul,g=c.div,b=c.O,v=c.I,y=c.J;if(t=t||n.length,!t)return b;if(n=a.DUAL(n,t,r),"cyclic"===f)b=c.NUM(n[0]);else{if("derangement"===f||"involution"===f||"connected"===f)return e();if("multiset"===f)for(s=r.multiplicity.slice(),o=r&&null!=r.count?r.count:jn.Math.factorial(t,s),i=t-1,u=0;i>u&&c.gt(o,v);u++)l=n[u],b=p(b,g(_(o,L(s,0,l-1,1)),t-u)),o=g(_(o,s[l]),t-u),s[l]--;else{if(d)return y;for(n=sn(null,n),i=t-1,u=0;i>u;u++)b=p(_(b,t-u),n[u])}}return(!(ce&m)&&oe&m||ce&m&&!(oe&m))&&(b=h(r&&null!=r.last?r.last:h(a.count(t,r),v),b)),b},unrank:function(n,t,r){var u,l,i,o,s,c,f,d,m=this,h=jn.Arithmetic,p=r&&r.type?r.type:"permutation",_=r&&null!=r["cycles="]?0|r["cycles="]:null,g=(r&&null!=r["fixed="]?0|r["fixed="]:null,r&&null!=-r.order?r.order:ae),b=h.mod,v=h.div,y=h.mul,x=h.sub,A=h.val;if(null==n||!h.inside(n,h.J,r&&null!=r.count?r.count:m.count(t,r)))return null;if(!t)return[];if((!(ce&g)&&oe&g||ce&g&&!(oe&g))&&(n=x(r&&null!=r.last?r.last:x(m.count(t,r),h.I),n)),"cyclic"===p)n=A(n),u=a(t,function(e){return(n+e)%t});else{if("derangement"===p||"involution"===p||"connected"===p)return e();if("multiset"===p)for(d=r.multiplicity.slice(),u=a(t),f=r&&null!=r.count?r.count:jn.Math.factorial(t,d),i=0;t>i;i++){for(s=0,o=0,l=A(v(y(n,t-i),f));o<d.length&&s+d[o]<=l;)s+=d[o++];n=x(n,v(y(f,s),t-i)),f=v(y(f,d[o]),t-i),d[o]--,u[i]=o}else{if(_)return null;for(u=a(t),u[t-1]=0,l=n,i=t-2;i>=0;i--)s=t-i,c=b(l,s),l=v(l,s),u[i]=A(c);an(u,u)}}return u=m.DUAL(u,t,r)},fusion:Dn.fusion,output:Dn.output,permute:hn,shuffle:function(n,e){if("cyclic"===e){var t=n.length,r=jn.Math.rndInt(0,t-1);return r>0&&n.push.apply(n,n.splice(0,r)),n}return"connected"===e?M(n,!0):M(n)},product:function(){return arguments.length?pn(t(arguments[0])&&t(arguments[0][0])?arguments[0]:Gn.call(arguments)):null},directsum:function(){return arguments.length?_n(t(arguments[0])&&t(arguments[0][0])?arguments[0]:Gn.call(arguments)):null},cycles:function(n,e){return-1===e?cycles2permutation(n):fn(n)},swaps:function(n,e){return-1===e?mn(n):dn(n)},inversion:function(n,e){return-1===e?an(null,n):sn(null,n)},inverse:function(n){return on(null,n)},multiset:function(n,e,t){return n===+n?rn(e,n,-1===t?-1:1):-1===t?un(n):ln(n,e)},matrix:function(n,e,t){return-1===t?tn(null,n,e):en(null,n,e)},parity:e,is_permutation:gn,is_identity:bn,is_cyclic:An,is_derangement:xn,is_involution:vn,is_kthroot:yn,is_connected:wn,is_kcycle:Mn},_update:function(){var n=this;return n.item__=qn(n.__item,n.n,n.$.order,n.$.type),n}}),Un=jn.Combination=ne(Dn,{constructor:function ye(n,e,r){var u=this,l=null;if(!(u instanceof ye))return new ye(n,e,r);if(t(n)?(r=e||{},e=n[1]||0,n=n[0]||0):(r=r||{},n=n||0,e=e||0),r.type=String(r.type||"unordered").toLowerCase(),-1<r.type.indexOf("+")){var i=r.type.split("+");i.sort(),r.type=i.join("+")}e instanceof Dn?(l=e,e=l.dimension()):n instanceof Dn?(l=n,n=l.base()):l=r.sub,r.base=n,r.dimension=e,"binary"===r.output?r.output=function(n,e){return ye.binary(n,e[0],1)}:"conjugate"===r.output&&(r.output=function(n,e){return ye.complement(n,e[0])}),Dn.call(u,"Combination",[n,e],r,l?{method:r.submethod,iter:l,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:Dn.C,P:Dn.P,T:Dn.T,DUAL:Dn.DUAL,count:function(n,e){var t=jn.Math.factorial,r=e&&e.type?e.type:"unordered";return"ordered+repeated"===r?jn.Math.exp(n[0],n[1]):"repeated"===r?t(n[0]+n[1]-1,n[1]):"ordered"===r?t(n[0],-n[1]):t(n[0],n[1])},initial:function(n,e,t){var r,u=this,l=e&&e.type?e.type:"unordered",i=e&&null!=e.order?e.order:ae;return 0===n[1]?[]:(t=-1===t?-1:1,(!(ce&i)&&oe&i||ce&i&&!(oe&i))&&(t=-t),r="ordered+repeated"===l||"repeated"===l?0>t?a(n[1],n[0]-1,0):a(n[1],0,0):"ordered"===l?0>t?a(n[1],n[0]-1,-1):a(n[1],0,1):0>t?a(n[1],n[0]-n[1],1):a(n[1],0,1),r=u.DUAL(r,n,e))},succ:function(n,e,t,r,u,l){return!t||!t[0]||0>=t[0]||0===t[1]||null==n?null:(u=-1===u?-1:1,Ln(n,t,u,r&&r.type?r.type:"unordered",r&&null!=r.order?r.order:ae,l))},rand:function(n,e){var t,r,u,l,i=this,o=e&&e.type?e.type:"unordered",s=n[1],c=jn.Math.rndInt;return 0===s?[]:(n=n[0],r=n-s,u=n-1,"repeated"===o||"ordered+repeated"===o?(t=1===s?[c(0,u)]:a(s,function(){return c(0,u)}),s>1&&"repeated"===o&&A(t,1,!0)):"ordered"===o?(l={},t=1===s?[c(0,u)]:n===s?M(a(s,0,1)):a(s,function(){for(var e=c(0,u);1===l[e];)e=(e+1)%n;return l[e]=1,e})):(l={},t=1===s?[c(0,u)]:n===s?a(s,0,1):s>r?W(n,a(r,function(){for(var e=c(0,u);1===l[e];)e=(e+1)%n;return l[e]=1,e}),!0):A(a(s,function(){for(var e=c(0,u);1===l[e];)e=(e+1)%n;return l[e]=1,e}),1,!0)),t=i.DUAL(t,n,e))},randu:Dn.rand,rank:function(n,e,t){var r,u,l,i,o,s=this,a=jn.Arithmetic,c=a.add,f=a.sub,d=a.mul,m=a.O,h=a.I,p=m,_=e[1],g=t&&null!=t.order?t.order:ae,b=t&&t.type?t.type:"unordered",v=jn.Math.factorial;if(0===_)return m;if(n=s.DUAL(n,e,t),"ordered+repeated"===b)for(i=e[0],r=0;_>r;r++)p=c(d(p,i),n[r]);else if("repeated"===b){for(i=e[0]+_-1,o=t&&t.count?t.count:v(i,_),r=1;_>=r;r++)u=i-1-n[r-1]-r+1,l=_+1-r,u>=l&&(p=c(p,v(u,l)));p=f(f(o,h),p)}else if("ordered"===b)for(i=e[0],n=sn(null,n,i),r=0;_>r;r++)p=c(d(p,i-r),n[r]);else{for(i=e[0],o=t&&t.count?t.count:v(i,_),r=1;_>=r;r++)u=i-1-n[r-1],l=_+1-r,u>=l&&(p=c(p,v(u,l)));p=f(f(o,h),p)}return(!(ce&g)&&oe&g||ce&g&&!(oe&g))&&(p=f(t&&null!=t.last?t.last:f(s.count(e,t),h),p)),p},unrank:function(n,e,t){var r,u,l,i,o,s,c,f=this,d=jn.Arithmetic,m=d.O,h=d.I,p=d.sub,_=d.div,g=d.mod,b=d.mul,v=d.lte,y=d.gt,x=d.val,A=e[1],w=t&&t.type?t.type:"unordered",M=t&&null!=t.order?t.order:ae;if(e=e[0],null==n||!d.inside(n,d.J,t&&null!=t.count?t.count:f.count(e,t)))return null;if(0===A)return[];if((!(ce&M)&&oe&M||ce&M&&!(oe&M))&&(n=p(t&&null!=t.last?t.last:p(f.count(e,t),d.I),n)),r=a(A),"ordered+repeated"===w)for(i=n,s=A-1;s>=0;s--)o=g(i,e),i=_(i,e),r[s]=x(o);else if("ordered"===w){for(i=n,s=A-1;s>=0;s--)l=e-s,o=g(i,l),i=_(i,l),r[s]=x(o);an(r,r,l)}else{c="repeated"===w,l=c?e+A-1:e,u=t&&t.count?t.count:jn.Math.factorial(l,A),n=p(p(u,h),n),u=_(b(u,l-A),l),o=l-A+1,i=A,s=l-1;do v(u,n)?(r[A-i]=c?l-o-A+1:l-o-i+1,y(u,m)&&(n=p(n,u),u=_(b(u,i),s)),i--,s--):(u=_(b(u,s-i),s),o--,s--);while(i>0)}return r=f.DUAL(r,e,t)},fusion:Dn.fusion,output:Dn.output,complement:function(n,e,t){return!0===t?M(W(e,n,!0)):W(e,n)},binary:function(n,e,t){return-1===t?Y(n,e):B(n,e)},pick:function(n,e,t){return e>0&&n.length?O(n,e,"ordered+repeated"!==t&&"ordered"!==t,"ordered+repeated"===t||"repeated"===t,new Array(e)):[]},choose:function(n,e){return e&&e.length?a(e.length,function(t){return 0<=e[t]&&e[t]<n.length?n[e[t]]:null}):[]}},_update:function(){var n=this;return n.item__=Sn(n.__item,n.n[0],n.n[1],n.$.order,n.$.type),n}}),Un.conjugate=Un.complement,Un.project=Un.choose,Pn=jn.Powerset=jn.Subset=ne(Dn,{constructor:function xe(n,e){var t=this,r=null;return t instanceof xe?(e=e||{},n=n||0,n instanceof Dn?(r=n,n=r.base()):r=e.sub,e.type=e.type||"subset",e.rand=e.rand||{},e.rand.subset=1,e.base=n,e.dimension=n,e.mindimension=0,e.maxdimension=n,"binary"===e.output&&(e.output=function(n,e){return xe.binary(n,e,1)}),void Dn.call(t,"Subset",n,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)):new xe(n,e)},__static__:{C:function(n,e,t){if(t+1===n.length){var r=-1===n[0];n=r?n.slice(t-n[t],t):n.slice(0,n[t]),n=W(e,n),n=(r?(n.length<t?new Array(t-n.length):[]).concat(n):n.concat(n.length<t?new Array(t-n.length):[])).concat(n.length)}else n=W(e,n);return n},P:Dn.P,T:Dn.T,DUAL:function(n,e,t){if(null==n)return null;var r,u=this;return t&&"binary"===t.type?(r=t&&null!=t.order?t.order:ae,t.order=se&r?r&~se:r|se,n=Dn.DUAL.call(u,n,e,t),t.order=r):n=Dn.DUAL.call(u,n,e,t),n},count:function(n,e){return jn.Math.pow2(n)},initial:function(n,e,t){var r,u=this,l=e&&null!=e.order?e.order:ae;return t=-1===t?-1:1,(!(ce&l)&&oe&l||ce&l&&!(oe&l))&&(t=-t),r=new Array(n+1),r[n]=0,e&&"binary"===e.type?0>t&&s(function(n,e){r[e]=e},null,null,0,n,1):0>t&&(r[0]=n-1,r[n]=1),r=u.DUAL(r,n,e)},succ:function(n,e,t,r,u,l){return null==n?null:r&&"binary"===r.type?Dn.succ.call(this,n,e,t,r,u):Cn(n,t,-1===u?-1:1,r&&null!=r.order?r.order:ae)},rand:function(n,e){for(var t,r=this,u=jn.Math.rndInt,l=null,i=n-1;i>=0;i--)u(0,1)&&(l={len:l?l.len+1:1,k:i,next:l});return t=l?a(l.len,function(n){var e=l.k;return l=l.next,e}):[],t=t.concat(t.length<n?new Array(n-t.length):[]).concat(t.length),t=r.DUAL(t,n,e)},randu:Dn.rand,rank:function(n,t,r){var u,l,i,o=this,s=jn.Arithmetic,a=s.O,c=s.I,f=s.add,d=s.shl,m=s.sub,h=r&&null!=r.order?r.order:ae;if(!r||"binary"!==r.type)return e();for(n=o.DUAL(n,t,r),u=a,l=0,i=n[t];i>l;)u=f(u,d(c,n[l++]));return(!(ce&h)&&oe&h||ce&h&&!(oe&h))&&(u=m(r&&null!=r.last?r.last:m(o.count(t,r),c),u)),u},unrank:function(n,t,r){var u,l,i=this,o=jn.Arithmetic,s=o.O,a=o.band,c=o.shr,f=o.gt,d=o.sub,m=r&&null!=r.order?r.order:ae;if(null==n||!o.inside(n,o.J,r&&null!=r.count?r.count:i.count(t,r)))return null;if(!r||"binary"!==r.type)return e();for((!(ce&m)&&oe&m||ce&m&&!(oe&m))&&(n=d(r&&null!=r.last?r.last:d(count,o.I),n)),u=new Array(t+1),u[t]=0,l=0;f(n,s);)f(a(n,1),s)&&(u[u[t]++]=l),f(a(n,2),s)&&(u[u[t]++]=l+1),f(a(n,4),s)&&(u[u[t]++]=l+2),f(a(n,8),s)&&(u[u[t]++]=l+3),f(a(n,16),s)&&(u[u[t]++]=l+4),f(a(n,32),s)&&(u[u[t]++]=l+5),f(a(n,64),s)&&(u[u[t]++]=l+6),f(a(n,128),s)&&(u[u[t]++]=l+7),l+=8,n=c(n,8);return u=i.DUAL(u,t,r)},fusion:Dn.fusion,output:function(n,e,t,r){if(null==n)return null;if(t+1===n.length){var u=r&&null!=r.order?r.order:ae,l=r&&"binary"===r.type,i=ce&u,o=se&u;n=l&&!(i&&!o||o&&!i)||!l&&(i&&!o||o&&!i)?n.slice(t-n[t],t):n.slice(0,n[t])}return Dn.output.call(this,n,e,t,r)},binary:function(n,e,t){return-1===t?Y(n,e):B(n,e)}}}),Tn=jn.Partition=ne(Dn,{constructor:function Ae(n,e){var t=this,r=null;if(!(t instanceof Ae))return new Ae(n,e);e=e||{},e.type=e.type||"partition",n=n||1,n instanceof Dn?(r=n,n=r.base()):r=e.sub;var u=e["max="]?0|e["max="]:null,l=e["parts="]?0|e["parts="]:null,i=l?l:u?n-u+1:n,o=l?l:u?Xn.ceil(n/u):1;e.base=n,e.dimension=l||n,e.mindimension=Xn.min(o,i),e.maxdimension=Xn.max(o,i),e.rand=e.rand||{},e.rand.partition=1,e.rand.composition=1,"conjugate"===e.output?e.output=function(n,e){return Ae.conjugate(n,"partition")}:"subset"===e.output?e.output=function(n,e){
return Ae.subset(n,1)}:"packed"===e.output&&(e.output=function(n,e){return Ae.pack(n,1)}),Dn.call(t,"Partition",n,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:function(n,e,t,r){var u=this,l=r&&r.type?r.type:"partition",i=r&&null!=r.order?r.order:ae,o=r&&r["max="]?0|r["max="]:null,s=r&&r["parts="]?0|r["parts="]:null;if("composition"!==l&&ce&i&&(n=u.P(n,t)),!s&&!o)if(t+1===n.length){var a=-1===n[0];n=a?n.slice(t-n[t],t):n.slice(0,n[t]),n=Q("composition"===l,n,1),n=(a?(n.length<t?new Array(t-n.length):[]).concat(n):n.concat(n.length<t?new Array(t-n.length):[])).concat(n.length)}else n=Q("composition"===l,n,1);return n},P:Dn.P,T:Dn.T,DUAL:Dn.DUAL,count:function(n,e){var t=e&&e["max="]?0|e["max="]:null,r=e&&e["parts="]?0|e["parts="]:null,u=e&&e.type?e.type:"partition";return"composition"===u?jn.Math.compositions(n,r,t):jn.Math.partitions(n,r,t)},initial:function(n,e,t){var r,u,l,i=this,o=e&&e.type?e.type:"partition",s=e&&e["max="]?0|e["max="]:null,c=e&&e["parts="]?0|e["parts="]:null,f=e&&null!=e.order?e.order:ae,m="composition"===o;return 0>=n||c&&s&&(c+s>n+1||n>c*s)||c&&c>n||s&&s>n?null:(t=-1===t?-1:1,(!(ce&f)&&oe&f||ce&f&&!(oe&f))&&(t=-t),c&&s?(1===c&&(r=[s]),m?(l=Xn.min(s,Xn.ceil((n-s)/(c-1))),r=[(n-s)%l||l].concat(a(c-2,l,0)).concat([s]),0>t&&d(r,r)):0>t?(u=Xn.min(c,Xn.floor(n/s)||1),n-=u*s,c-=u,0===n&&c>0&&(u--,c++,n+=s),r=[s].concat(a(u-1,s,0)).concat(n>0&&c>0?[n-c+1].concat(a(c-1,1,0)):[])):(l=Xn.min(s,Xn.ceil((n-s)/(c-1))),r=[s].concat(a(c-2,l,0).concat([(n-s)%l||l])))):c?m?(r=a(c-1,1,0).concat([n-c+1]),0>t&&d(r,r)):(l=Xn.ceil(n/c),u=n%l||l,r=0>t?[n-c+1].concat(a(c-1,1,0)):a(c-1,l,0).concat([u])):s?(u=Xn.floor(n/s),l=n%s,r=m?0>t?a(u,s,0).concat(l?[l]:[]):a(n-s,1,0).concat([s]):0>t?a(u,s,0).concat(l?[l]:[]):[s].concat(a(n-s,1,0))):r=0>t?[n]:a(n,1,0),r=i.DUAL(r,n,e))},succ:function(n,e,t,r,u,l){if(null==t||null==n)return null;var i=r&&r.type?r.type:"partition",o=r&&r["max="]?0|r["max="]:null,s=r&&r["parts="]?0|r["parts="]:null;return 0>=t||s&&o&&(s+o>t+1||t>s*o)||s&&s>t||o&&o>t?null:(u=-1===u?-1:1,"composition"===i?kn(n,t,u,s,o,r&&null!=r.order?r.order:ae,l):$n(n,t,u,s,o,r&&null!=r.order?r.order:ae,l))},rand:function(n,e){var t,r,u,l,i,o=this,s=jn.Math.rndInt,c=e&&e.type?e.type:"partition",f=(e&&null!=e.order?e.order:ae,e&&e["max="]?0|e["max="]:null),d=e&&e["parts="]?0|e["parts="]:null,m=0,h=0,p="composition"===c,_=!1;if(0>=n||d&&f&&(d+f>n+1||n>d*f)||d&&d>n||f&&f>n)return null;if(d&&f)return null;if(f&&!d&&(d=f,_=!0),d)1===d?(r=[n],h=n):n===d?(r=a(d,1,0),h=n):(t={},u=n-2,a(r=A(a(d-1,function(){for(i=s(0,u);1===t[i];)i=(i+1)%(u+1);return t[i]=1,i+1}),1,!0),function(n){return i=r[n],l=i-m,m=i,h+=l,l}));else{for(t=null,i=1;n>i;i++)s(0,1)&&(l=i-m,m=i,h+=l,t={len:t?t.len+1:1,x:l,next:t});r=t?a(t.len,function(){return l=t.x,t=t.next,l}):[]}return n>h&&(r.length?r.splice(s(0,r.length-1),0,n-h):r.push(n-h)),p?_&&(r=M(Q(0,A(r,-1)))):(r=A(r,-1),_&&(r=Q(0,r))),r=o.DUAL(r,n,e)},randu:Dn.rand,rank:e,unrank:e,fusion:Dn.fusion,output:function(n,e,t,r){return null==n?null:(t+1===n.length&&(n=se&(r&&null!=r.order?r.order:ae)?n.slice(t-n[t],t):n.slice(0,n[t])),Dn.output.call(this,n,e,t,r))},conjugate:function(n,e){return Q("composition"===e,n)},subset:function(n,e){return-1===e?K(n):z(n)},pack:function(n,e){return-1===e?nn(n):Z(n)}},_update:function(){var n=this;return n.item__=En(n.__item,n.n,n.$.order,n.$.type,n.$),n}}),Tn.transpose=Tn.conjugate,jn});