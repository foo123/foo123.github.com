/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python, Java, C/C++
*   @version: 0.8.7
*   https://github.com/foo123/Abacus
**/
!function(n,e,t){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[e])&&(n[e]=n.$deps[e]=t.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[e]=t.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(e,[],function(r){r(e,t.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["module"],function(e){return t.moduleUri=e.uri,t.call(n)}):e in n||(n[e]=t.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[e]})}(this,"Abacus",function(n){"use strict";function e(){throw new Error("Method not implemented!")}function t(n){return n instanceof Array||"[object Array]"===Vn.call(n)}function r(n){return n instanceof String||"[object String]"===Vn.call(n)}function u(n){var e=n.toString(2),t=32-e.length;return t>0?new Array(t+1).join("0")+e:e}function o(n,e,r,u,i,l,o){var s,a,f,c,d,m,h,p,_=e,b=null,g=r&&t(r);if(g&&(null==u&&(u=0),null==i&&(i=r.length-1)),null==l&&(l=u>i?-1:1),0===l||g&&!r.length||0>=Un.floor((i-u)/l)+1)return _;if(0>l?(p=(u-i)%-l,p&&(b=i),i+=p,m=i,h=u,c=-1,f=-(-l<<4)):(p=(i-u)%l,p&&(b=i),i-=p,m=u,h=i,c=1,f=l<<4),d=u+l*(15&Un.floor((i-u)/l+1)),g){for(m=Un.max(0,m),h=Un.min(r.length-1,h),s=u;s>=m&&h>=s&&c*(d-s)>0;s+=l)_=n(_,r[s],s);for(a=d;a>=m&&h>=a;a+=f)s=a,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s),s+=l,_=n(_,r[s],s);!0===o&&null!==b&&b>=0&&b<r.length&&(_=n(_,r[b],b))}else{for(s=u;s>=m&&h>=s&&c*(d-s)>0;s+=l)_=n(_,s,s);for(a=d;a>=m&&h>=a;a+=f)s=a,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s),s+=l,_=n(_,s,s);!0===o&&null!==b&&(_=n(_,b,b))}return _}function s(n,e,r){var u=t(n)?n:(n=0|n)>0?new Array(n):[];if(n=u.length,n>0&&null!=e){r=r||0;var i=e;o("function"==typeof e?function(n,t,r){return n[r]=e(r),n}:e===+e?function(n,e,t){return n[t]=i,i+=r,n}:function(n,t,r){return n[r]=e,n},u,u)}return u}function a(n,e,t){return o(function(n,e,r){return n[r]=e[t],n},n,e)}function f(n,e,r,u,i){return null==e?n:o(t(r)?function(n,e,t){return n[t]=r[t]-1-e,n}:function(n,e,t){return n[t]=r-1-e,n},n,e,u,i)}function c(n,e,t,r,u){if(null==e)return n;if(null==r&&(r=0),null==u&&(u=e.length-1),u>=r)for(var i,l=r,o=u;o>=l;l++,o--)i=e[l],n[l]=e[o],n[o]=i;return n}function d(n,e){return null==e&&(e=0),t(n)?s(n,t(e)?function(t){return e[t]-1-n[n.length-1-t]}:function(t){return e-n[t]}):n===+n&&e===+e?e-n:Nn.Arithmetic.sub(Nn.Arithmetic.N(e),n)}function m(n,e,r,u,i){if(null==e)return null;var l=0;return o(t(r)?function(n,e,t){return n[t]=r[t]>0?(e+l)%r[t]:0,l+=r[t]-n[t],n}:function(n,e,t){return n[t]=(e+l)%r,l+=r-n[t],n},n,e,u,i)}function h(n,e,t,r,u,i,l,s){if(null==e)return null;null==t&&(t=1),null==r&&(r=0),null==u&&(u=0),null==i&&(i=e.length-1),null==l&&(l=u),null==s&&(s=i);var a=0,f=l>s?-1:1,c=l;return o(function(n,e,u){return e=r+t*e,n[c]=e-a,a=e,c+=f,n},n,e,u,i)}function p(n,e,t,r,u,i,l,s){if(null==e)return null;null==t&&(t=1),null==r&&(r=0),null==u&&(u=0),null==i&&(i=e.length-1),null==l&&(l=u),null==s&&(s=i);var a=0,f=l>s?-1:1,c=l;return o(function(n,e,u){return a+=e,n[c]=r+t*a,c+=f,n},n,e,u,i)}function _(n,e,t,r,u,i,l,o){r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=e.length-1),null==l&&(l=0),null==o&&(o=t.length-1);var s=u>i?-1:1,a=l>o?-1:1,f=s*(i-u)+1,c=a*(o-l)+1,d=u,m=l,h=0;if(null==n&&(n=new Array(Un.min(f,c))),0===n.length)return n;for(;s*(i-d)>=0&&a*(o-m)>=0;)1===r&&e[d]<t[m]||-1===r&&e[d]>t[m]?d+=s:1===r&&e[d]>t[m]||-1===r&&e[d]<t[m]?m+=a:(n[h++]=e[d],d+=s,m+=a);return h<n.length&&(n.length=h),n}function b(n,e,t,r,u,i,l,o,a){a=!0===a,r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=e===+e?e-1:e.length-1),null==l&&(l=0),null==o&&(o=t?t.length-1:-1);var f=u>i?-1:1,c=l>o?-1:1,d=f*(i-u)+1,m=u,h=l,p=0;if(!t||!t.length)return e===+e?s(e,u,f):e?e.slice():e;if(null==n&&(n=new Array(a?2*d:d)),e===+e){for(;f*(i-m)>=0&&c*(o-h)>=0;)m===t[h]?(a&&(n[p++]=m),m+=f,h+=c):1===r&&m>t[h]||-1===r&&m<t[h]?h+=c:(n[p++]=m,m+=f);for(;f*(i-m)>=0;)n[p++]=m,m+=f}else{for(;f*(i-m)>=0&&c*(o-h)>=0;)e[m]===t[h]?(a&&(n[p++]=e[m]),m+=f,h+=c):1===r&&e[m]>t[h]||-1===r&&e[m]<t[h]?h+=c:(n[p++]=e[m],m+=f);for(;f*(i-m)>=0;)n[p++]=e[m],m+=f}return p<n.length&&(n.length=p),n}function g(n,e,t,r,u,i,l,o,s,a,f){r=-1===r?-1:1,null==u&&(u=0),null==i&&(i=e.length-1),null==l&&(l=0),null==o&&(o=t.length-1),!0===s?a=!1:(s=!1,a=!1!==a),f=!0===f;var c=u>i?-1:1,d=l>o?-1:1,m=c*(i-u)+1,h=d*(o-l)+1,p=m+h,_=u,b=l,g=0,v=null,y=!a;if(null==n&&(n=new Array(p)),0===n.length)return f?e:n;for(;c*(i-_)>=0&&d*(o-b)>=0;){if(a&&g){if(e[_]===v){_+=c;continue}if(t[b]===v){b+=d;continue}}s?1===r&&e[_][0]<t[b][0]||-1===r&&e[_][0]>t[b][0]?(n[g++]=v=e[_],_+=c):1===r&&e[_][0]>t[b][0]||-1===r&&e[_][0]<t[b][0]?(n[g++]=v=t[b],b+=d):(1===r&&e[_][1]<t[b][1]||-1===r&&e[_][1]>t[b][1]?(n[g++]=v=e[_],y&&(n[g++]=t[b])):(n[g++]=v=t[b],y&&(n[g++]=e[_])),_+=c,b+=d):1===r&&e[_]<t[b]||-1===r&&e[_]>t[b]?(n[g++]=v=e[_],_+=c):1===r&&e[_]>t[b]||-1===r&&e[_]<t[b]?(n[g++]=v=t[b],b+=d):(n[g++]=v=e[_],y&&(n[g++]=t[b]),_+=c,b+=d)}for(;c*(i-_)>=0;)(y||e[_]!==v)&&(n[g++]=v=e[_],_+=c);for(;d*(o-b)>=0;)(y||t[b]!==v)&&(n[g++]=v=t[b],b+=d);if(f){for(_=0>c?i:u,g=0;p>g;g++,_++)e[_]=n[g];return e}return g<n.length&&(n.length=g),n}function v(n,e,t,r,u){var i,l,o,s,a,f,c,d,m;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,r[5]=0,f=0,m=0,s=e,a=-1,i=u?n[s][0]:n[s],o=s+1;t>=o;o++){if(l=u?n[o][0]:n[o],l>i){if(-1===f){a=o-1;break}0===f&&(f=1)}else if(i>l){if(1===f){a=o-1;break}0===f&&(f=-1)}i=l}if(0===f&&(f=1),-1===a)a=t,r[0]=s,r[1]=a,r[2]=f;else{for(c=a+1,d=-1,i=u?n[c][0]:n[c],o=c+1;t>=o;o++){if(l=u?n[o][0]:n[o],l>i){if(-1===m){d=o-1;break}0===m&&(m=1)}else if(i>l){if(1===m){d=o-1;break}0===m&&(m=-1)}i=l}-1===d&&(d=t),0===m&&(m=1),r[0]=s,r[1]=a,r[2]=f,r[3]=c,r[4]=d,r[5]=m}}function y(n,e,t,r,u,i){null==u&&(u=0),null==i&&(i=n.length-1);var l=u>i?-1:1,s=l*(i-u)+1;if(r=!0===r,1>=s)return r?1===s?[u]:[]:n;e=-1===e?-1:1;var f,d,m,h,p,_=s,b=1,y=2,x=Un.min,A=new Array(s);if(r&&(n=o(function(n,e,t){return n[t-u]=[e,t],n},new Array(s),n,u,i,1),u=0,i=s-1),!0===t){h=u,p=-1,f=[-1,-1,0,-1,-1,0];do v(n,u,i,f,r),-1===f[3]?(e!==f[2]&&i>u&&c(n,n,u,i),d=u,m=i):(f[2]=e!==f[2]?1:0,f[5]=e!==f[5]?1:0,g(A,n,n,e,f[2]?f[1]:f[0],f[2]?f[0]:f[1],f[5]?f[4]:f[3],f[5]?f[3]:f[4],r,!1,!0),d=f[0],m=f[4]),-1!==p&&g(A,n,n,e,h,p,d,m,r,!1,!0),p=m,u=m+1;while(i>=u)}else for(;_>0;)o(function(t,i){g(A,n,n,e,u+l*i,u+l*(i+b-1),u+l*(i+b),u+l*x(i+y-1,s-1),r,!1,!0)},null,null,0,s-b-1,y),b<<=1,y<<=1,_>>=1;return r?a(n,n,1):n}function x(n,e,t,r){var u,i,l,o=n.length;if(null==t&&(t=0),null==r&&(r=o-1),null==e||0===e){for(e=0,i=n[t],u=t+1;r>=u;u++){if(l=n[u],l>i){if(-1===e)return 0;0===e&&(e=1)}else if(i>l){if(1===e)return 0;0===e&&(e=-1)}i=l}return 0===e?1:e}if(e=-1===e?-1:1,t>=r)return e;if(-1===e)for(i=n[t],u=t+1;r>=u;u++){if(l=n[u],l>i)return 0;i=l}else for(i=n[t],u=t+1;r>=u;u++){if(l=n[u],i>l)return 0;i=l}return e}function A(n,e,r,u){var i,l=Nn.Math.rndInt,s=!0===e?1:0;return t(r)?1<(i=r.length)&&o(function(n){if(s<i--){var e=l(0,i-s),t=n[r[i]];n[r[i]]=n[r[e]],n[r[e]]=t}return n},n,r,0,i-1):(null==r&&(r=0),null==u&&(u=n.length-1),1<(i=u-r+1)&&o(function(n){if(s<i--){var e=l(0,i-s),t=n[r+i];n[r+i]=n[r+e],n[r+e]=t}return n},n,n,0,i-1)),n}function w(n,e,t,r,u,i,l){null==i&&(i=0),null==l&&(l=n.length-1);var o,s,a,f,c=Nn.Math.rndInt,d=l-i+1;if(e=Un.min(e,d),t=!0===t,o=new Array(e),!0===r){for(d-=1,s=0;e>s;s++)o[s]=n[i+c(0,d)];return t&&y(o),o}for(s=0;e>s;s++)a=c(0,--d),f=n[i+a],n[i+a]=n[i+d],n[i+d]=f,o[s]=f,u&&(u[s]=a);if(u)for(s=e-1;s>=0;s--)a=u[s],f=n[i+d],n[i+d]=n[i+a],n[i+a]=f,d++;return t&&y(o),o}function M(n,e,t,r,u){t=-1===t?-1:1,null==r&&(r=0),null==u&&(u=e.length-1);var i,l,o=r,s=u;if(n===e[o])return o;if(n===e[s])return s;for(;s>o;){if(i=o+(s-o+1>>>1),l=e[i],n===l)return i;1===t&&l>n||-1===t&&n>l?s=i-1:o=i+1}return-1}function O(n,e){return n+e}function q(n,e){return n*e}function I(n,e,t,r){return o(Nn.Arithmetic.add,Nn.Arithmetic.O,n,e,t,r)}function S(n,e,t,r){return o(Nn.Arithmetic.mul,Nn.Arithmetic.I,n,e,t,r)}function C(n){var e=Nn.Arithmetic;return e.shl(e.I,e.N(n))}function L(n,e){var t=Nn.Arithmetic,r=t.N;return t.pow(r(n),r(e))}function E(n,e){var r,u=Nn.Arithmetic,i=u.O,l=u.I,s=u.J,a=u.N,f=u.add,c=(u.sub,u.div),d=u.mul;return null==e?10>=n?0>n?i:0===n?l:a([1,2,6,24,120,720,5040,40320,362880,3628800][n-1]):(r=String(n),null==E.mem1[r]&&(E.mem1[r]=d(E(n-1),n)),E.mem1[r]):!1===e?10>=n?2>n?i:a([1,2,9,44,265,1854,14833,133496,1334961][n-2]):(r="!"+String(n),null==E.mem2[r]&&(E.mem2[r]=f(1&n?s:l,d(E(n-1,!1),n))),E.mem2[r]):!0===e?10>=n?0>n?i:0===n?l:a([1,2,4,10,26,76,232,764,2620,9496][n-1]):(r="I"+String(n),null==E.mem2[r]&&(E.mem2[r]=f(E(n-1,!0),d(E(n-2,!0),n-1))),E.mem2[r]):t(e)?e.length?0>n?i:(r=String(n)+"@"+y(e.slice(),1,!0).join(","),null==E.mem3[r]&&(E.mem3[r]=c(E(n),o(function(n,e){return d(n,E(e))},E(e[e.length-1]),e,e.length-2,0))),E.mem3[r]):0>n?i:E(n):e===+e?0>e?-e>=n?-e===n?E(n):i:(r=String(n)+"@"+String(e),null==E.mem3[r]&&(E.mem3[r]=o(d,l,null,n+e+1,n)),E.mem3[r]):0>e||1>n||e>n?i:(e+e>n&&(e=n-e),0===e||1===n?l:1===e?a(n):(r=String(n)+"@"+String(e),null==E.mem3[r]&&(E.mem3[r]=u.isDefault()?Un.round(o(function(e,t){return e*(1+n/t)},(n-=e)+1,null,2,e)):f(E(n-1,e-1),E(n-1,e))),E.mem3[r])):i}function $(n,e,t){var r,u=Nn.Arithmetic,i=u.O,l=u.I,o=u.V,s=u.add,a=u.mul;return 0>n||0>e?i:2===t?n===e||1===e&&0>n?l:0===n||0===e?i:(r=String(n)+","+String(e),null==$.mem2[r]&&($.mem2[r]=s($(n-1,e-1,2),a($(n-1,e,2),e))),$.mem2[r]):-1===t?e>n||0===e&&0>n?i:n===e?l:(r="-"+String(n)+","+String(e),null==$.mem1[r]&&($.mem1[r]=s($(n-1,e-1,-1),a($(n-1,e,-1),-n+1))),$.mem1[r]):1&Un.abs(n-e)?o($(n,e,-1)):$(n,e,-1)}function k(n,e,t,r){var u,i,l=Nn.Arithmetic,s=l.add,a=l.I,f=l.O;return 0>n||0>=e||t>r||t+e>n+1||n>e*r?f:r===n&&1===e||e===n&&1===r?a:(u=String(n)+","+String(e)+","+String(t)+","+String(r),null==k.mem[u]&&(n-=e*(t-1),r=r-t+1,i=String(n)+","+String(e)+","+String(t)+","+String(r),null==k.mem[i]&&(k.mem[i]=o(function(t,u){return s(t,k(n-r,e-1,1,u))},f,null,Un.max(1,Un.ceil((n-r)/(e-1))),Un.min(r,n-r-e+2),1)),k.mem[u]=k.mem[i]),k.mem[u])}function D(n,e,t){e=null==e?null:0|e,t=null==t?null:0|t;var r,u=Nn.Arithmetic,i=u.add,l=t?t:0,s=t?t:1,a=e?e:1,f=e?e:n,c=u.O;return 0>n||e&&t&&(e+t>n+1||n>e*t)||t&&t>n||e&&e>n?c:(t&&!e&&(l=0,s=1,a=t,f=t,e=t,t=null),r=String(n)+"|"+String(e)+"|"+String(t),null==D.mem[r]&&(D.mem[r]=o(function(e,t){return o(function(e,r){return i(e,k(n,t,1,r))},e,null,s,l?l:n-t+1,1)},c,null,a,f,1)),D.mem[r])}function R(n,e,t,r){var u,i=Nn.Arithmetic,l=i.add,s=i.O,a=i.I;return 0>n||0>=e||t>r||t*e>n||n>e*r?s:1===e?n>=t&&r>=n?a:s:n===e?1>=t&&r>=1?a:s:t===r?e*t===n?a:s:n===r?E(n-e*t+e-1,e-1):(u=String(n)+","+String(e)+","+String(t)+","+String(r),null==R.mem[u]&&(R.mem[u]=o(function(n,u){return l(n,R(u,e-1,t,r))},s,null,Un.max(n-r,0),n-t,1)),R.mem[u])}function N(n,e,t){e=null==e?null:0|e,t=null==t?null:0|t;var r,u=Nn.Arithmetic,i=u.O,l=u.I,s=u.add,a=(u.mul,u.div,i);return 0>n||e&&t&&(e+t>n+1||n>e*t)||t&&t>n||e&&e>n?a:(r=String(n)+"|"+String(e)+"|"+String(t),null==N.mem[r]&&(e&&t?N.mem[r]=e*t===n?l:R(n,e,1,t):e?N.mem[r]=R(n,e,1,n):t?N.mem[r]=n===t?l:o(function(e,r){return s(e,R(n,r,1,t))},a,null,Un.ceil(n/t),n-t+1,1):N.mem[r]=n>=1?C(n-1):l),N.mem[r])}function U(n){var e,t=Nn.Arithmetic,r=t.O,u=t.N,i=t.div,l=t.mul;return 14>=n?0>n?r:u([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900][n]):(e=String(n),null==U.mem[e]&&(U.mem[e]=i(l(U(n-1),4*n-2),n+1)),U.mem[e])}function P(n){var e,t=Nn.Arithmetic,r=t.O,u=t.N,i=t.add,l=t.mul;return 12>=n?0>n?r:u([1,1,2,5,15,52,203,877,4140,21147,115975,678570][n]):(e=String(n),null==P.mem[e]&&(P.mem[e]=o(function(e,t){return i(e,l(E(n-1,t),P(t)))},r,null,0,n-1,1)),P.mem[e])}function T(n){var e,t=Nn.Arithmetic,r=t.O,u=t.N,i=t.add;return 29>=n?0>n?r:u([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811][n]):(e=String(n),null==T.mem[e]&&(T.mem[e]=i(T(n-1),T(n-2))),T.mem[e])}function j(n){if(!arguments.length||null==n)return ie;var e=0;if(r(n)){n=n.toUpperCase().split(",");for(var t=0,u=n.length;u>t;t++)e|=Xn.call(j,n[t])?j[n[t]]:0;e>0&&!((ae|se)&e)&&(e|=ie),0>=e&&(e=ie)}else e=fe&n?fe&n:ie;return se&e&&ae&e&&(e&=~ae),oe&e&&(le|ie)&e&&(e&=~(le|ie)),le&e&&ie&e&&(e&=~ie),se&e&&(e&=~re),e}function X(){var n,e,r,u,i,l,o,s,a,f,c,d=arguments.length;if(!d)return[];if(!0===arguments[0]){for(f=arguments[1].length,n=2;d>n;n++)f*=arguments[n].length;for(c=new Array(f),n=0;f>n;n++){for(s=0,l=1,r=n,e=1;d>e;e++)u=arguments[e].length,i=r%u,r=~~(r/u),o=arguments[e][i],s+=l*o,l*=u;c[n]=s}}else{for(f=arguments[0].length,n=1;d>n;n++)f*=arguments[n].length;for(c=new Array(f),n=0;f>n;n++){for(s=new Array(d),a=0,r=n,e=d-1;e>=0;e--)if(u=arguments[e].length,i=r%u,r=~~(r/u),o=arguments[e][i],t(o))for(l=o.length-1;l>=0;l--)s[d-++a]=o[l];else s[d-++a]=o;c[n]=s}}return c}function V(){var n,e,t=arguments,r=t.length,u=0;for(e=0;r>e;e++)u+=t[e].length;return n=0,e=0,s(u,function(r){return r>=n+t[e].length&&(n+=t[e++].length),n+t[e][r-n]})}function J(n,e,t){var r,u,i,l,o,s,a,f,c,d,m,h,p,_,b,g,v,y,x,A,w,M,O,q,I=n.length,S=null,C=null;if(!I)return[];for("function"==typeof t?(C=t,t=!0):t=!1,Kn!==e&&Qn!==e&&Zn!==e&&ne!==e&&ee!==e&&te!==e&&(e=!1),v=new Array(I),g=[],u=1,r=0;I>r;r++)if("function"==typeof n[r][0])null==v[n[r][1]]?v[n[r][1]]=[[n[r][0],r]]:v[n[r][1]].push([n[r][0],r]);else if(g.push(r),u*=n[r].length,!u||0>=u)return[];if(!g.length)return[];for(_=new Array(u),p=0,h=I-1,y=g.length-1,A=new Array(I),w=0,r=0;u>r;r++){for(d=new Array(I),x=!1,l=r,i=y;i>=0;i--)if(b=g[i],o=n[b].length,s=l%o,l=~~(l/o),d[b]=n[b][s],null!=v[b]){A[0]=b,w=1;do for(b=A[--w],M=v[b],a=d[b],O=0,q=M.length;q>O;O++)b=M[O][1],d[b]=M[O][0](a),null!=v[b]&&(A[w++]=b);while(w>0)}if(e||t)if(t&&!C(d,h,h))x=!0;else for(c=d[h],Qn===e&&(S={},S[c]=1),m=h-1;m>=0;m--){if(f=d[m],Kn===e&&c!==f||Qn===e&&1===S[f]||Zn===e&&f>=c||ne===e&&c>=f||ee===e&&c>f||te===e&&f>c||t&&!C(d,m,h)){x=!0;break}Qn===e&&(S[f]=1),c=f}x||(_[p++]=d)}return _.length>p&&(_.length=p),_}function G(n,e,u,i,l,o){var a,f,d,m,h,p,_,b,g,v=e,A=v.length,w=!1,M=[],O=[],q={},I=function(e){return e>=0&&n>e};for(e=[],w=!1,h=0,d=0;A>d;d++,h++)if(f=v[d],r(f))if(a=f.match(Wn)){if(0<a[1].indexOf("..")?(a=a[1].split("..").map(Number),m=a[0]>a[1]?F(n,s(a[0]-a[1]+1,a[1],1).filter(I)).reverse():F(n,s(a[1]-a[0]+1,a[0],1).filter(I))):m=F(n,a[1].split(",").map(Number).filter(I)),!m.length){w=!0;break}e.push(m)}else if(a=f.match(Hn)){if(0<a[1].indexOf("..")?(a=a[1].split("..").map(Number),m=(a[0]>a[1]?s(a[0]-a[1]+1,a[0],-1):s(a[1]-a[0]+1,a[0],1)).filter(I)):m=a[1].split(",").map(Number).filter(I),!m.length){w=!0;break}e.push(m)}else{if(p=-1,_=null,b=null,f=f.replace(Fn,function(n,e){return null===_&&(p=parseInt(e,10),_="v"+String(p)),_}),!I(p)){u&&u.splice(h--,1);continue}try{b=new Function(_,"return Math.floor("+f+");")}catch(S){b=null}if("function"!=typeof b){u&&u.splice(h--,1);continue}q[p]?q[p].push(b):q[p]=[b],0>u.indexOf(p)&&O.push(p),M.push([b,null,null,p,u[h]]),e.push(M[M.length-1])}else if(t(f)){if(m=!1===f[0]?F(n,f.slice(1).filter(I)):f.slice(1).filter(I),!m.length){w=!0;break}e.push(m)}if(w&&(e=[]),O.length)for(d=0,A=O.length;A>d;d++)u.push(O[d]),w||e.push(s(n,0,1));if(d=x(u),-1===d?(c(u,u),w||c(e,e)):0===d&&(f=y(u,1,!1,!0),dn(u,f),w||dn(e,f)),w)return[];if(M.length)for(d=0,A=M.length;A>d;d++)if(a=M[d],a[1]=u.indexOf(a[3]),a[2]=u.indexOf(a[4]),b=q[a[3]],"function"!=typeof e[a[1]][0]){if(m=e[a[1]].filter(function(e){for(var t,r=0,u=b.length;u>r;r++)if(t=b[r](e),0>t||t>=n)return!1;return!0}),!m.length){w=!0;break}e[a[1]]=m}return w?[]:(i="="===i?Kn:"!="===i||"<>"===i?Qn:"<"===i?Zn:"<="===i||"=<"===i?te:">"===i?ne:">="===i||"=>"===i?ee:!1,g="function"==typeof l?function(e,t,r){return 0<=e[t]&&e[t]<n&&l(e,t,r)}:function(e,t,r){return 0<=e[t]&&e[t]<n},!0===o?e:J(e,i,g))}function F(n,e,t){if(null==e||!e.length||1>=e.length)return 1===e.length?s(n-1,function(n){return n<e[0]?n:n+1}):s(n,0,1);if(!0===t){var r=x(e);-1===r?e=c(new Array(e.length),e):0===r&&(e=y(e.slice(),1,!0))}return b(null,n,e)}function H(n,e){if(0>e)return[];var t,r=s(e,0,0),u=n.length;for(e-=1,t=0;u>t;t++)r[e-n[t]]=1;return r}function W(n,e){e=Un.min(e||n.length,n.length);var t,r=[];for(e-=1,t=0;e>=t;t++)0<n[t]&&r.push(e-t);return r}function B(n,e,t){return null==n?null:(e=e||n.length,p(new Array(e),n,1,-1,-1===t?e-1:0,-1===t?0:e-1,0,e-1))}function Y(n,e,t){return null==n?null:(e=e||n.length,h(new Array(e),n,1,1,-1===t?e-1:0,-1===t?0:e-1,0,e-1))}function z(n,e,r){if(null==e)return null;var u,i=null,l=e.length;if(r=-1===r?-1:1,n)u=o(O,0,e),1>=u?i=e.slice():(i=Y(F(u-1,B(e,l-1,r))),0<(u-=o(O,0,i))&&i.push(u),0>r&&c(i,i));else{var a,f,d,m,h,p=1,_=0,b=0,g="push";if(0>r&&(p=-p,_=l-1-_,g="unshift"),t(e[_]))for(h=e[_],i=[[h[1],h[0]]],a=0,d=1,m=p+_;l>d;d++,m+=p)h=e[m],f=0>r?0:a,h[1]===i[f][0]?i[f][1]+=h[0]:(i[g]([h[1],h[0]]),a++);else for(u=e[_],i=s(u,1,0),0>r&&(b=u-1-b),d=1,m=p+_;l>d;d++,m+=p)for(a=0,f=b,h=e[m];u>a&&h>0;)i[f]++,h--,a++,f+=p}return i}function K(n,e){if(null==n)return null;var t,r,u,i,l=[],o=n.length,s=-1===e,a=1,f=0,c="push";for(s&&(a=-a,f=o-1-f,c="unshift"),u=n[f],i=[u,1],t=1;o>t;t++)r=a*t+f,u===n[r]?i[1]++:(l[c](i),u=n[r],i=[u,1]);return l[c](i),l}function Q(n,e){if(null==n)return null;var t,r,u,i,l,o=[],s=n.length,a=-1===e,f=1,c=0,d="push";for(a&&(f=-f,c=s-1-c,d="unshift"),t=0;s>t;t++)if(l=n[f*t+c],1===l[1])o[d](l[0]);else for(u=l[1],i=l[0],r=0;u>r;r++)o[d](i);return o}function Z(n,e,t){var r,u,i=e.length,l=i*i;for(n=n||new Array(l),r=0,u=0;l>r;)n[r+u]=0,++u>=i&&(u=0,r+=i);if(!0===t)for(r=0;i>r;r++)n[i*e[r]+r]=1;else for(r=0,u=0;i>u;u++,r+=i)n[r+e[r]]=1;return n}function nn(n,e,t){var r,u,i=e.length,l=Un.floor(Un.sqrt(i));if(n=n||new Array(l),!0===t)for(r=0,u=0;l>r;)e[l*r+u]&&(n[u]=r),++u>=l&&(u=0,r++);else for(r=0,u=0;l>r;)e[r+u]&&(n[r]=u),++u>=l&&(u=0,r++);return n}function en(n,e,t){var r=n?n.length:0,u=1,i=0,l=0,s=r>l?n[l]||1:1;return-1===t&&(u=-1,i=(r||e)-1),o(function(e,t){return 0>=s&&(l++,i+=u,s=r>l?n[l]||1:1),s--,e[t]=i,e},new Array(e),null,0,e-1)}function tn(n){return un(null,y(n,1,!1,!0))}function rn(n,e){return e&&e.length?o(function(n,t,r){return n[r]=t<e.length?e[t]:t,n},n,n):n}function un(n,e){return o(function(n,e,t){return n[e]=t,n},n||new Array(e.length),e)}function ln(n,e,t){var r=e.length,u=Un.ceil(Jn(t||r)),i=1<<u,l=(1<<1+u)-1,a=s(l,0,0);return o(function(n,e,t){for(var r=e+i,l=0;u>l;l++)1&r&&(e-=a[r>>>1<<1]),a[r]+=1,r>>>=1;return a[r]+=1,n[t]=e,n},n||new Array(r),e)}function on(n,e,t){var r,u,i,l=e.length,s=Un.ceil(Jn(t||l)),a=1<<s,f=(1<<1+s)-1,c=new Array(f);for(r=0;s>=r;r++)for(i=1,u=1<<r;u>=i;i++)c[u-1+i]=1<<s-r;return o(function(n,e,t){for(var r=1,u=0;s>u;u++)c[r]-=1,r<<=1,e>=c[r]&&(e-=c[r],r++);return c[r]=0,n[t]=r-a,n},n||new Array(l),e)}function sn(n,e,t){var r,u=n.length,i=null==e;if(u>1)for(i&&(e=new Array(u-1),t=0),r=u-1;r>=1;r--)e[t++]=[n[0],n[r]];else i&&(e=[]);return i?e:t}function an(n,e){var t,r,u,i,l=n.length,o=new Array(l),s=!0===e?1:0,a=new Array(l),f=0,c=0;for(t=0;l>t;t++)a[t]=0;for(u=new Array(l),i=0,r=f++,u[i++]=r,a[r]=1;l>f;){if(r=n[r],a[r])for(i>s&&(u.length=i,o[c++]=u),u=new Array(l),i=0;l>f&&a[r=f];)++f;a[r]||(u[i++]=r,a[r]=1)}return i>s&&(u.length=i,o[c++]=u),c<o.length&&(o.length=c),o}function fn(n){var e,t,r=n.length,u=new Array(r),i=0,l=an(n,!0);for(e=0,t=l.length;t>e;e++)i=sn(l[e],u,i);return i<u.length&&(u.length=i),u}function cn(n,e){var t,r,u,i=n.length,l=new Array(e);for(t=0;e>t;t++)l[t]=t;for(t=0;i>t;t++)swap=r[t],u=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=u;return l}function dn(n,e,t){var r=n.length,u=e.length;if(!0===t)return o(u>r?function(t,u){return t[u]=e[u]<r?n[e[u]]:n[u],t}:r>u?function(t,r){return t[r]=u>r?n[e[r]]:n[r],t}:function(t,r){return t[r]=n[e[r]],t},new Array(r),null,0,r-1,1);for(var i=n.slice(),l=0;r>l;l++)n[l]=i[e[l]];return n}function mn(n){return o(function(n,e){return dn(n,e,!0)},n.length?n[0].slice():[],n,1,n.length-1,1)}function hn(n){var e,t,r,u=n.length,i=0;for(t=0;u>t;t++)i+=n[t].length;return e=0,t=0,r=u?n[t].length:0,s(i,function(u){return u>=e+r&&(e+=r,r=n[++t].length),e+n[t][u-e]})}function pn(n,e){if(e=e||n.length,e!==n.length)return!1;var t,r,u=s(e,0,0);for(t=0;e>t;t++){if(r=n[t],0>r||r>=e||0<u[r])return!1;u[r]++}for(t=0;e>t;t++)if(1!==u[t])return!1;return!0}function _n(n){for(var e=n.length,t=0;e>t;t++)if(n[t]!==t)return!1;return!0}function bn(n){for(var e=n.length,t=0,r=n[t];e>t;t++,r=n[t])if(0>r||r>=e||n[r]!==t)return!1;return!0}function gn(n,e){if(e=e||1,1>e)return!1;var t,r,u,i=n.length;for(t=0;i>t;t++){for(r=n[t],u=1;e>=u&&t!==r;)u++,r=n[r];if(t!==r||u!==e&&(u>=e||e%u>0))return!1}return!0}function vn(n,e,t){e=0|e;for(var r=0,u=n.length,i=0;u>i;i++)if(n[i]===i&&++r>e)return!1;return!0===t?r===e:!0}function yn(n){for(var e=n.length,t=1,r=n[0];e>t;t++)if(n[t]!==(r+t)%e)return!1;return!0}function xn(n){for(var e=n.length-1,t=-1,r=0,u=n[r];e>r;r++,u=n[r])if(u>t&&(t=u),r>=t)return!1;return!0}function An(n,e,t,r,u,i){var l,o,s,a,f,c,d,m,h,p,_=e;if("tuple"===r?(l=_[0],_=_[1]):l=_.length,h=0,p=l-1,c=1,a=p,f=h,d=1,m=0,le&u&&(c=-c,a=p-a,f=p-f,d=-d,m=p-m),ue&u&&(c=-c,a=p-a,f=p-f,d=-d,m=p-m),re&u&&(t=-t),0>t)if("tuple"===r){for(o=a;o>=h&&p>=o&&0===n[o];)o-=c;if(o>=h&&p>=o)for(_-=1,n[o]=n[o]-1,s=o+c;s>=h&&p>=s;s+=c)n[s]=_;else n=null}else{for(o=a;o>=h&&p>=o&&0===n[o];)o-=c;if(o>=h&&p>=o)for(n[o]=n[o]-1,s=o+c;s>=h&&p>=s;s+=c)n[s]=_[d*s+m]-1;else n=null}else if("tuple"===r){for(o=a;o>=h&&p>=o&&n[o]+1===_;)o-=c;if(o>=h&&p>=o)for(n[o]=n[o]+1,s=o+c;s>=h&&p>=s;s+=c)n[s]=0;else n=null}else{for(o=a;o>=h&&p>=o&&n[o]+1===_[d*o+m];)o-=c;if(o>=h&&p>=o)for(n[o]=n[o]+1,s=o+c;s>=h&&p>=s;s+=c)n[s]=0;else n=null}return n}function wn(n,e,t,r){return null}function Mn(n,e,t,r,u,i,l){var o,s,a,f,c,d,m,h,p,_,b,g,v,y,x=e,A=null==i?x:i;if(v=0,y=x-1,h=1,m=y,p=1,_=0,b=1,g=0,le&u&&(h=-h,m=y-m,p=-p,_=A-1-_,t=-t),ue&u&&(h=-h,m=y-m,b=-1,g=A-1),re&u&&(t=-t),0>t)if("cyclic"===r)if(o=y-m,p*n[o]+_>0)for(b=x-1,h=x+h,a=0;x>a;a++)c=(p*n[o]+_+b)%x,n[o]=p*c+_,o=(o+h)%x;else n=null;else if("involution"===r)n=null;else if("connected"===r)n=null;else do{for(d=!1,o=m-h;o>=v&&y>=o&&p*n[o]<=p*n[o+h];)o-=h;if(o>=v&&y>=o){for(s=m;s>=v&&y>=s&&h*(s-o)>0&&p*n[o]<=p*n[s];)s-=h;for(c=n[o],n[o]=n[s],n[s]=c,a=o+h,f=m;a>=v&&y>=a&&f>=v&&y>=f&&h*(f-a)>0;)c=n[a],n[a]=n[f],n[f]=c,d=d||b*a+g===n[a]||b*f+g===n[f],a+=h,f-=h;if("derangement"===r)for(s>=v&&y>=s&&(d=d||b*s+g===n[s]),f>=v&&y>=f&&(d=d||b*f+g===n[f]),d=d||b*o+g===n[o],a=o-h;!d&&a>=v&&y>=a;a-=h)d=b*a+g===n[a];else d=!1}else n=null}while(n&&d);else if("cyclic"===r)if(o=y-m,p*n[o]+_<x-1)for(b=x+1,h=x+h,a=0;x>a;a++)c=(p*n[o]+_+b)%x,n[o]=p*c+_,o=(o+h)%x;else n=null;else if("involution"===r){for(o=x,d=!0;d&&o--;)for(s=n[o],n[o]=o,n[s]=s;s--;)if(n[s]===s){n[o]=s,n[s]=o,d=!1;break}d&&(n=null)}else if("connected"===r)n=null;else do{for(d=!1,o=m-h;o>=v&&y>=o&&p*n[o]>=p*n[o+h];)o-=h;if(o>=v&&y>=o){for(s=m;s>=v&&y>=s&&h*(s-o)>0&&p*n[o]>=p*n[s];)s-=h;for(c=n[o],n[o]=n[s],n[s]=c,a=o+h,f=m;a>=v&&y>=a&&f>=v&&y>=f&&h*(f-a)>0;)c=n[a],n[a]=n[f],n[f]=c,d=d||b*a+g===n[a]||b*f+g===n[f],a+=h,f-=h;if("derangement"===r)for(s>=v&&y>=s&&(d=d||b*s+g===n[s]),f>=v&&y>=f&&(d=d||b*f+g===n[f]),d=d||b*o+g===n[o],a=o-h;!d&&a>=v&&y>=a;a-=h)d=b*a+g===n[a];else d=!1}else n=null}while(n&&d);return n}function On(n,e,t,r,u){if(null==n)return null;var i,l=null;if("ordered"===u)for(l={},i=0;t>i;i++)l[n[i]]=1;return l}function qn(n,e,t,r,u,i){var l,o,s,a,f,c,d,m,h,p,_,b,g,v,y=e[1],x=e[0];if(d=0,m=y-1,c=1,f=m,h=1,p=0,_=1,b=0,le&u&&(h=-h,p=x-1-p,c=-c,f=m-f,_=-_,b=m-b),ue&u&&(c=-c,f=m-f,_=-_,b=m-b),re&u&&(t=-t),0>t)if("ordered+repeated"===r){for(l=f;l>=d&&m>=l&&0===n[l];)l-=c;if(l>=d&&m>=l)for(x-=1,n[l]=n[l]-1,o=l+c;o>=d&&m>=o;o+=c)n[o]=x;else n=null}else if("ordered"===r){for(null==i&&(i=On(n,x,y,u,r)),l=f,s=-1;-1===s&&l>=d&&m>=l;){if(h*n[l]+p-h>=0)for(o=h*n[l]+p-h;o>=0&&x>o;o-=h)if(a=h*o+p,null==i[a]){s=l,i[a]=1;break}i[n[l]]=null,l-=c}if(s>-1)for(n[s]=a,o=x-1-p,a=h*o+p,l=s+c;l>=d&&m>=l;l+=c){for(;o>=0&&x>o&&null!=i[a];)o-=h,a=h*o+p;n[l]=a,i[a]=1}else n=null}else if(v="repeated"===r,g=v?0:1,le&u)if(c=-c,f=m-f,_=-_,b=m-b,l=m-f,o=0>c?d:m,!v&&n[o]+1>y||v&&n[o]>0){if(v)for(;l>=d&&m>=l&&0===n[l];)l+=c;else for(;l>=d&&m>=l&&_*l+b===n[l];)l+=c;for(n[l]-=1,l-=c;l>=d&&m>=l;)n[l]=n[l+c]-g,l-=c}else n=null;else{for(s=-1,l=f;l-c>=d&&m>=l-c;l-=c)if(n[l]>n[l-c]+g){s=l;break}if(!(s>=d&&m>=s)&&0<n[0>c?m:d]&&(s=0>c?m:d),s>=d&&m>=s){for(a=x-1+g,l=f;l>=d&&m>=l&&c*(l-s)>0;l-=c)a-=g,n[l]=a;n[s]--}else n=null}else if("ordered+repeated"===r){for(l=f;l>=d&&m>=l&&n[l]+1===x;)l-=c;if(l>=d&&m>=l)for(n[l]=n[l]+1,o=l+c;o>=d&&m>=o;o+=c)n[o]=0;else n=null}else if("ordered"===r){for(null==i&&(i=On(n,x,y,u,r)),l=f,s=-1;-1===s&&l>=d&&m>=l;){if(h*n[l]+p+h<x)for(o=h*n[l]+p+h;o>=0&&x>o;o+=h)if(a=h*o+p,null==i[a]){s=l,i[a]=1;break}i[n[l]]=null,l-=c}if(s>-1)for(n[s]=a,o=p,a=h*o+p,l=s+c;l>=d&&m>=l;l+=c){for(;o>=0&&x>o&&null!=i[a];)o+=h,a=h*o+p;n[l]=a,i[a]=1}else n=null}else if(v="repeated"===r,g=v?0:1,le&u)if(c=-c,f=m-f,_=-_,b=m-b,l=m-f,!v&&n[l]+y<x||v&&n[l]+1<x){for(a=_*l+b;l+c>=d&&m>=l+c&&n[l]+g===n[l+c];)n[l]=a,l+=c,a+=g;n[l]+=1}else n=null;else{if(v){for(s=-1,o=x-1,l=f;l>=d&&m>=l;l-=c)if(n[l]<o){s=l;break}}else for(s=-1,o=x-y,l=f;l>=d&&m>=l;l-=c)if(n[l]<o+_*l+b){s=l;break}if(s>=d&&m>=s){if(a=n[s]+1,o=v?x-1:x-y+_*s+b,a===o)n[s]=a;else if(o>a)for(l=s;l>=d&&m>=l;l+=c)n[l]=a,a+=g}else n=null}return n}function In(n,e,t,r,u){return null}function Sn(n,e,t,r,u,i,l){var o,a,f,c,d,m,h,p,_,b,g=e;if(_=0,b=n.length-1,p=1,f=_,c=b,ue&i&&(p=-p,f=b-f,c=b-c),re&i&&(t=-t),0>t)if(r)n=null;else if(le&i)n=null;else if(a=u?f+p:f,a>=_&&b>=a&&n[a]>1){for(o=c,h=0;o>=_&&b>=o&&p*(o-a)>=0&&1===n[o];)h+=n[o],o-=p;m=n[o]-1,h++,n[o]=m,n=0>p?n.slice(o):n.slice(0,o+1),h>m?(a=h%m,n=0>p?(a?[a]:[]).concat(s(Un.floor(h/m),m)).concat(n):n.concat(s(Un.floor(h/m),m)).concat(a?[a]:[])):h>0&&(n=0>p?[h].concat(n):n.concat([h]))}else n=null;else if(r)n=null;else if(le&i)n=null;else if(u?(m=Un.min(u,g-u),d=Un.floor(g/u)+(g%u?1:0)-1,m=b>d||n[f+(d-1)*p]<m,a=f+p):(m=n[f]<g,a=f),a>=_&&b>=a&&m){for(b>0?(o=c-p,h=n[c]):(o=c,h=0);o>=_&&b>=o&&o-p>=_&&b>=o-p&&p*(o-a)>0&&n[o]===n[o-p];)h+=n[o],o-=p;n[o]++,h--,n=h>0?0>p?s(h,1).concat(n.slice(o)):n.slice(0,o+1).concat(s(h,1)):0>p?n.slice(o):n.slice(0,o+1)}else n=null;return n}function Cn(n,e,t,r,u,i,l){var o,a,f,c,d,m,h,p,_=e;if(h=0,p=n.length-1,m=1,a=h,f=p,ue&i&&(m=-m,a=p-a,f=p-f),re&i&&(t=-t),0>t)if(r)if(u)n=null;else if(le&i)if(c=n[a],_-r+1>c){for(n[a]=1,o=a+m;o>=h&&p>=o&&1===n[o];)o+=m;n[o]--,o-m>=h&&p>=o-m&&(n[o-m]=1+c)}else n=null;else if(c=n[f],_-r+1>c){for(n[f]=1,o=f;o>=h&&p>=o&&1===n[o];)o-=m;n[o]--,o+m>=h&&p>=o+m&&(n[o+m]=1+c)}else n=null;else if(u)n=null;else if(le&i)n=null;else if(_>n.length){for(o=f,d=0;o>=h&&p>=o&&1===n[o];)o-=m,d++;c=n[o]-1,n[o]=c,d++,d>0&&(o+m>=h&&p>=o+m?(o+=m,n[o]=d,d=0,n=0>m?n.slice(o):n.slice(0,o+1)):n=0>m?s(d,1,0).concat(n):n.concat(s(d,1,0)))}else n=null;else if(r)if(u)n=null;else if(le&i)if(_-r+1>n[f]){for(o=a;o>=h&&p>=o&&1===n[o];)o+=m;c=n[o],n[o]=1,n[a]=c-1,o+m>=h&&p>=o+m&&n[o+m]++}else n=null;else if(_-r+1>n[a]){for(o=f;o>=h&&p>=o&&1===n[o];)o-=m;c=n[o],n[o]=1,n[f]=c-1,o-m>=h&&p>=o-m&&n[o-m]++}else n=null;else u?n=null:le&i?n=null:_>n[a]?(d=n[f],n[f-m]++,0>m?(n.shift(),n.unshift.apply(n,s(d-1,1,0))):(n.pop(),n.push.apply(n,s(d-1,1,0)))):n=null;return n}var Ln,En,$n,kn,Dn,Rn,Nn={VERSION:"0.8.7"},Un=Math,Pn="prototype",Tn="constructor",jn=Array.prototype.slice,Xn=Object[Pn].hasOwnProperty,Vn=Object[Pn].toString,Jn=Un.log2||function(n){return Un.log(n)/Un.LN2},Gn=/^\s+|\s+$/g,Fn=(String.prototype.trim?function(n){return n.trim()}:function(n){return n.replace(Gn,"")},/\[(\d+)\]/g),Hn=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,Wn=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,Bn=Object.create,Yn=function(n,e){for(var t in e)Xn.call(e,t)&&(n[t]=e[t]);return n},zn=function(n,e){1===arguments.length&&(e=n,n=Object);var t=e[Tn];return Xn.call(e,"__static__")&&(t=Yn(t,e.__static__),delete e.__static__),t[Pn]=Yn(Bn(n[Pn]),e),t},Kn=1,Qn=-1,Zn=3,ne=-3,ee=-2,te=2,re=1,ue=2,ie=4,le=8,oe=16,se=32,ae=ie|le|oe,fe=ae|se|re|ue;return E.mem1={},E.mem2={},E.mem3={},$.mem1={},$.mem2={},k.mem={},D.mem={},R.mem={},N.mem={},U.mem={},P.mem={},T.mem={},Nn.Class=zn,Nn.Options={MAXMEM:1e6,RANDOM:"index"},j.LEX=j.LEXICOGRAPHIC=ie,j.COLEX=j.COLEXICOGRAPHIC=le,j.MINIMAL=j.GRAY=oe,j.RANDOM=se,j.REV=j.ANTI=j.REVERSE=j.REVERSED=re,j.REF=j.REFLECT=j.REFLECTED=ue,j.REVLEX=j.ANTILEX=j.REVERSELEXICOGRAPHIC=j.ANTILEXICOGRAPHIC=ie|re,j.REFLEX=j.REFLECTEDLEXICOGRAPHIC=ie|ue,j.REVCOLEX=j.ANTICOLEX=j.REVERSECOLEXICOGRAPHIC=j.ANTICOLEXICOGRAPHIC=le|re,j.REFCOLEX=j.REFLECTEDCOLEXICOGRAPHIC=le|ue,Nn.ORDER=j,Nn.Math={O:0,I:1,J:-1,N:function(n){return Nn.Arithmetic.add(Nn.Arithmetic.O,n)},V:function(n){return Nn.Arithmetic.sub(Nn.Arithmetic.O,n)},rnd:Un.random,rndInt:function(n,e){return Nn.Math.round((e-n)*Nn.Math.rnd()+n)},equ:function(n,e){return n===e},gte:function(n,e){return n>=e},lte:function(n,e){return e>=n},gt:function(n,e){return n>e},lt:function(n,e){return e>n},inside:function(n,e,t,r){return r?n>=e&&t>=n:n>e&&t>n},clamp:function(n,e,t){return e>n?e:n>t?t:n},wrap:function(n,e,t){return e>n?t:n>t?e:n},wrapR:function(n,e){return 0>n?n+e:n},add:O,sub:function(n,e){return n-e},mul:q,div:function(n,e){return Nn.Math.floor(n/e)},mod:function(n,e){return n%e},pow:Un.pow,shl:function(n,e){return n<<e},shr:function(n,e){return n>>e},bor:function(n,e){return n|e},band:function(n,e){return n&e},xor:function(n,e){return n^e},abs:Un.abs,min:Un.min,max:Un.max,floor:Un.floor,ceil:Un.ceil,round:Un.round,num:function(n){return"number"==typeof n?Nn.Math.floor(n):parseInt(n,10)},val:function(n){return Nn.Math.floor(n.valueOf())},sum:I,product:S,pow2:C,exp:L,factorial:E,stirling:$,partitions:D,compositions:N,bell:P,catalan:U,fibonacci:T},Nn.Arithmetic={isDefault:function(){return 0===Nn.Arithmetic.O&&Nn.Arithmetic.add===O},O:0,I:1,J:-1,N:Nn.Math.N,V:Nn.Math.V,equ:Nn.Math.equ,gte:Nn.Math.gte,lte:Nn.Math.lte,gt:Nn.Math.gt,lt:Nn.Math.lt,inside:Nn.Math.inside,clamp:Nn.Math.clamp,wrap:Nn.Math.wrap,wrapR:Nn.Math.wrapR,add:Nn.Math.add,sub:Nn.Math.sub,mul:Nn.Math.mul,div:Nn.Math.div,mod:Nn.Math.mod,pow:Nn.Math.pow,shl:Nn.Math.shl,shr:Nn.Math.shr,bor:Nn.Math.bor,band:Nn.Math.band,xor:Nn.Math.xor,abs:Nn.Math.abs,min:Nn.Math.min,max:Nn.Math.max,floor:Nn.Math.floor,ceil:Nn.Math.ceil,round:Nn.Math.round,rnd:Nn.Math.rndInt,num:Nn.Math.num,val:Nn.Math.val},Nn.Util={array:s,operate:o,intersection:_,difference:b,union:g,search:M,complementation:f,reflection:c,reversion:d,gray:m,finitedifference:h,partialsum:p,sort:y,shuffle:A,pick:w,pluck:a},Nn.BitArray=zn({constructor:function ce(n){var e=this;return e instanceof ce?(e.length=n,void(e.bits=new Uint32Array(Un.ceil(n/32)))):new ce(n)},length:0,bits:null,dispose:function(){var n=this;return n.length=null,n.bits=null,n},clone:function(){var n=this,e=new Nn.BitArray(n.length);return e.bits=new Uint32Array(n.bits),e},fromArray:function(n){var e=this;return e.bits=new Uint32Array(n),e},toArray:function(){return jn.call(this.bits)},toString:function(){var n,e,t=this.toArray();for(n=0,e=t.length;e>n;n++)t[n]=u(t[n]);return t.join("")},reset:function(){var n,e=this,t=e.bits,r=t.length;for(n=0;r>n;n++)t[n]=0;return e},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){var e=this;return e.bits[n>>>5]|=1<<(31&n),e},unset:function(n){var e=this;return e.bits[n>>>5]&=~(1<<(31&n)),e},toggle:function(n){var e=this;return e.bits[n>>>5]^=1<<(31&n),e}}),Ln=Nn.CombinatorialIterator=zn({
constructor:function de(n,e,r,u){var i,l=this,o=Nn.Arithmetic;if(!(l instanceof de))return new de(n,e,r,u);if(i=l[Tn],t(n)&&(n[0]instanceof de||n[n.length-1]instanceof de)){l.$=r=e||{},r.rand=r.rand||{},r.seq=n,n=null,l.name="CombinatorialIterator",r.type="sequence",r.rand.sequence=1;var a=1/0,f=-(1/0),c=1/0,d=-(1/0);l.n=e=s(r.seq.length,function(n){return r.seq[n].n}),r.base_=s(r.seq.length,function(n){var e=r.seq[n].base();return e>f&&(f=e),a>e&&(a=e),e}),r.dimension_=s(r.seq.length,function(n){var e=r.seq[n].dimension();return e>d&&(d=e),c>e&&(c=e),e}),r.minbase=a,r.base=r.maxbase=f,r.mindimension=c,r.dimension=r.maxdimension=d}else l.name=n||"CombinatorialIterator",l.n=e||0,l.$=r=r||{};r.sub=null,r.type=String(r.type||"default").toLowerCase(),r.order=r.order||ie,r.rand=r.rand||{},r.count=i.count(l.n,l.$),r.base=r.base||0,r.minbase=null!=r.minbase?r.minbase:r.base,r.maxbase=null!=r.maxbase?r.maxbase:r.base,r.dimension=r.dimension||0,r.mindimension=null!=r.mindimension?r.mindimension:r.dimension,r.maxdimension=null!=r.maxdimension?r.maxdimension:r.dimension,r.first=o.O,r.last=o.gt(r.count,o.O)?o.sub(r.count,o.I):o.J,r.instance=l,l.order(r.order),u&&u.iter instanceof de&&l.fuse(u.method,u.iter,u.pos,u.cascade)},__static__:{Iterable:function me(n,e){var t=this;return t instanceof me?(e=-1===e?-1:1,void(t.next=function(){return n.hasNext(e)?{value:n.next(e)}:{done:!0}})):new me(n,e)},C:function(n,e){return f(n,n,e)},P:function(n){return c(n,n)},T:function(n,e){return d(n,e)},DUAL:function(n,e,t){if(null==n)return null;if(t&&"sequence"===t.type)return n;var r=this,u=r.C,i=r.P,l=(r.T,t&&null!=t.base?t.base:e),o=t&&null!=t.order?t.order:ie;return n=se&o?ue&o?i(n):n:oe&o?ue&o?i(n):n:le&o?ue&o?u(n,l,t):i(u(n,l,t)):ue&o?i(n):n},count:function(n,e){var t=Nn.Arithmetic,r=t.O;return e&&"sequence"===e.type&&e.seq&&e.seq.length?o(function(n,e){return t.add(n,e.total())},r,e.seq):r},initial:function(n,e,t,r){return e&&"sequence"===e.type&&e.seq&&e.seq.length?!0===r?this.succ(0,0,n,e,t):(t=-1===t?-1:1,0>t?e.seq[e.seq.length-1].item0(-1):e.seq[0].item0(1)):null},succ:function(n,e,t,r,u,i){if(null==t||null==n)return null;var l=this,o=Nn.Arithmetic;if(u=-1===u?-1:1,r&&"sequence"===r.type){if(!r.seq||!r.seq.length)return null;for(;0<=r.seq_curr&&r.seq_curr<r.seq.length&&!r.seq[r.seq_curr].hasNext(u);)r.seq_curr+=u;return 0<=r.seq_curr&&r.seq_curr<r.seq.length?r.seq[r.seq_curr].next(u):null}return null==e?null:l.unrank(o.add(e,0>u?o.J:o.I),t,r)},rand:function(n,e){var t,r=this,u=Nn.Arithmetic,i=e&&null!=e.last?e.last:u.sub(r.count(n,e),u.I),l=u.O,o=u.rnd(l,i);return e&&"sequence"===e.type?e.seq&&e.seq.length?e.seq[Nn.Math.rndInt(0,e.seq.length-1)].random():null:t=u.equ(l,o)?r.initial(n,e,1):u.equ(i,o)?r.initial(n,e,-1):r.unrank(o,n,e)},rank:e,unrank:e,fusion:function(n,e,t,r,u,i,l){if(-1===l){var o=e;e=t,t=o}if(null==e||null==t)return e||t||null;if("multiply"===n)return X(!0,e,t);if("add"===n||"connect"===n||"concat"===n){var a=e.length?e[0]+1:0;return s(e.length+t.length,"add"===n?function(n){return n<e.length?e[n]:e.length+t[n-e.length]}:"connect"===n?function(n){return n<e.length?(e[n]+1>a&&(a=e[n]+1),e[n]):a+t[n-e.length]}:function(n){return n<e.length?e[n]:t[n-e.length]})}if("complete"===n||"interleave"===n||"combine"===n){var f=e.length,c=t.length,d=f+c,m=0,h=0,p=0,_=0,b=f>h?e[h]:-1,g=null!=i?h<i.length?i[h]:-1:b,v="complete"===n?F(u,e,!0):null;return s(d,"complete"===n?function(n){var r;return g===n?(r=b,h++,b=f>h?e[h]:-1,g=null!=i?h<i.length?i[h]:-1:b):r=v[t[m++]],r}:"interleave"===n?function(n){var r;return g===n?(r=b,h++,b=f>h?e[h]:-1,g=null!=i?h<i.length?i[h]:-1:b):r=t[m++],r}:function(n){var r;return b===n?(r=b,h++,b=f>h?e[h]:-1,p=_,_=r):r=_+t[m++],r})}return s(e.length,function(n){return 0<=e[n]&&e[n]<t.length?t[e[n]]:e[n]})},output:function(n,e,r,u){return null==n?null:u&&t(u.output)?s(n.length,function(e){return 0<=n[e]&&n[e]<u.output.length?u.output[n[e]]:n[e]}):n.slice()}},name:"CombinatorialIterator",n:0,$:null,__index:null,_index:null,__item:null,item__:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var e=this;return!0!==n&&e.$.sub&&(e.$.sub.dispose(),e.$.sub=null),"sequence"===e.$.type&&e.$.seq&&e.$.seq.length&&o(function(n,e){e.dispose()},null,e.$.seq),e.name=null,e.n=null,e.$=null,e.__index=null,e._index=null,e.__item=null,e.item__=null,e._item=null,e.__subindex=null,e._subindex=null,e.__subitem=null,e._subitem=null,e._prev=null,e._next=null,e._traversed&&(e._traversed.dispose(),e._traversed=null),e},fuse:function(n,e,t,r){var u=this,i=u.$;return 1===arguments.length&&!1===n?i.sub&&(i.sub=null,i.submethod=null,i.subpos=null,i.subcascade=null,i.subcount=null,i.subdimension=null,i.subposition=null,u.rewind()):e instanceof Ln&&(n=String(n||"project").toLowerCase(),t=t||null,r=-1===r?-1:1,i.sub=e,i.submethod=n,i.subpos=t,i.subcascade=r,i.subcount=Nn.Arithmetic.mul(i.count,i.sub.total()),"multiply"===n?i.subdimension=i.dimension*i.sub.dimension():"add"===n||"connect"===n||"concat"===n||"complete"===n||"interleave"===n||"combine"===n?i.subdimension=i.dimension+i.sub.dimension():i.subdimension=i.dimension,u.rewind()),u},unfuse:function(){return this.fuse(!1)},multiplyWith:function(n,e){return this.fuse("multiply",n,null,e)},addWith:function(n,e){return this.fuse("add",n,null,e)},connectWith:function(n,e){return this.fuse("connect",n,null,e)},concatWith:function(n,e){return this.fuse("concat",n,null,e)},completeWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("complete",n,e||this.position(),t)},interleaveWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("interleave",n,e||this.position(),t)},combineWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("combine",n,e||this.position(),t)},projectOn:function(n,e){return this.fuse("project",n,null,e)},base:function(n){var e=this.$;return e.sub&&!0!==n?e.subbase||e.base||0:e.base||0},dimension:function(n){var e=this.$;return e.sub&&!0!==n?e.subdimension||e.dimension||0:e.dimension||0},position:function(n){var e=this.$;return e.sub&&!0!==n?e.subposition||e.position||null:e.position||null},total:function(n){var e=this.$;return e.sub&&!0!==n?e.subcount||e.count||0:e.count||0},_init:function(n){var e,t,r,u=this,i=u[Tn],l=u.$,o=u.n,s=Nn.Arithmetic,a=s.O,f=(s.I,l.order);return u.__index=u._index=a,u._item=u.__item=u.item__=null,u._prev=!1,u._next=!1,t=l.count,r=l.last,"sequence"===l.type&&(l.seq_curr=l.seq&&l.seq.length?0>n?l.seq.length-1:0:-1),se&f?("gen"===Nn.Options.RANDOM||1===l.rand[l.type]||s.gt(t,Nn.Options.MAXMEM)||s.isDefault()&&0>t?(u.__item=i.rand(o,l),u.__index=a):(u._traversed&&u._traversed.dispose(),u._traversed=new Nn.BitArray(s.val(t)),e=u.random("index"),u._traversed.set(+e),u.__item=i.unrank(e,o,l),null!=u.__item&&(u.__index=e)),u._index=a):(u.__item=i.initial(o,l,n,!0),null!=u.__item&&(u.__index=0>n?r:a,u._update()),u._index=u.__index),u._item=i.output(u.__item,u.__index,o,l),u._prev=se&f||n>0?!1:null!=u.__item,u._next=0>n&&!(se&f)?!1:null!=u.__item,u},_update:function(){return this.item__=null,this},order:function(n,e){if(!arguments.length)return this._order;var t,u,i,l,o,s,a,f=this,c=f[Tn],d=Nn.Arithmetic,m=(d.O,d.I,!0===n);if(e=-1===e,i=f.n,l=f.$,f._traversed&&(f._traversed.dispose(),f._traversed=null),m?n=l.order:r(n)&&-1<(u=n.indexOf("|"))?(t=n.substr(u+1),n=j(n.substr(0,u))):t=n=j(n),o=e?-1:1,l.order=n,l.sub?(m?l.sub.rewind(o):l.sub.order(t,o),f.__subindex=l.sub.index(),f.__subitem=l.sub.next(o),f._subindex=null,f._subitem=null):(f.__subindex=null,f.__subitem=null,f._subindex=null,f._subitem=null),"sequence"===l.type&&l.seq&&l.seq.length)for(s=0,a=l.seq.length;a>s;s++)m?l.seq[s].rewind(o):l.seq[s].order(n,o);return f._init(o),l.sub&&(f._prev=f._prev&&null!=f.__subitem,f._next=f._next&&null!=f.__subitem,f._subindex=d.add(d.mul(f.__subindex,l.count),f._index),f._subitem=c.fusion(l.submethod,f._item,f.__subitem,f.dimension(),f.base(),l.subpos,l.subcascade)),f},index:function(n,e){if(e=!0===e,!arguments.length)return this.$.sub?this._subindex:this._index;var t,r=this,u=r[Tn],i=Nn.Arithmetic,l=i.O,o=(i.I,i.J),s=r.n,a=r.$,f=a.sub&&!e?a.subcount:a.count,c=a.sub&&!e?r._subindex:r._index,d=a.order;return n=i.wrapR(i.N(n),f),!i.equ(n,c)&&i.inside(n,o,f)&&(f=a.count,t=a.last,a.sub&&!e&&(a.sub.index(i.div(n,f)),r.__subindex=a.sub.index(),r.__subitem=a.sub.item(),n=i.mod(n,f)),se&d||(r.__index=n,r._index=n,r.__item=i.equ(l,n)?u.initial(s,a,1):i.equ(t,n)?u.initial(s,a,-1):u.unrank(n,s,a),r._update(),r._item=u.output(r.__item,r.__index,s,a),r._prev=null!=r.__item,r._next=null!=r.__item),a.sub&&(r._prev=r._prev&&null!=r.__subitem,r._next=r._next&&null!=r.__subitem,r._subindex=i.add(i.mul(r.__subindex,f),r._index),r._subitem=u.fusion(a.submethod,r._item,r.__subitem,r.dimension(),r.base(),a.subpos,a.subcascade))),r},item0:function(n){var e=this;return e[Tn].initial(e.n,e.$,-1===n?-1:1)},item:function(n,e){if(!arguments.length)return this.$.sub?this._subitem:this._item;var u,i,l,o,s,a,f=this,c=f[Tn],d=f.n,m=f.$,h=m.sub?m.subcount:m.count,p=m.sub?f._subindex:f._index,_=Nn.Arithmetic,b=_.O,g=(_.I,_.J),v=null;return r(e)?-1<(a=e.indexOf("|"))?(v=e.substr(a+1),e=j(e.substr(0,a))):v=e=j(e):null!=e?v=e=j(e):(e=m.order,v=null),m.sub||(v=null),t(n)?(h=m.count,u=m.last,l=m.order,m.order=e,f.__item=n.slice(),f._update(),f.__index=c.rank(f.__item,d,m),f._item=c.output(f.__item,f.__index,d,m),se&e?f._index=f.__index:f._index=f.__index,f._prev=null!=f.__item,f._next=null!=f.__item,f):(n=_.wrapR(_.N(n),h),e===m.order&&null===v&&_.equ(n,p)?m.sub?f._subitem:f._item:_.inside(n,g,h)?(s=null,h=m.count,u=m.last,m.sub&&(s=m.sub.item(_.div(n,h),v),n=_.mod(n,h)),se&e?(i=null,l=m.order,m.order=e,o=c.output(c.rand(d,m),i,d,m),m.order=l,m.sub&&(o=c.fusion(m.submethod,o,s,f.dimension(),f.base(),m.subpos,m.subcascade)),o):(i=n,l=m.order,m.order=e,o=c.output(_.equ(b,n)?c.initial(d,m,1):_.equ(u,n)?c.initial(d,m,-1):c.unrank(i,d,m),i,d,m),m.order=l,m.sub&&(o=c.fusion(m.submethod,o,s,f.dimension(),f.base(),m.subpos,m.subcascade)),o)):null)},random:function(n,e,t,r){var u,i=this,l=i[Tn],o=i.$,s=o.order;if(r=!0===r,"index"===n){var a,f,c=Nn.Arithmetic,d=c.N,m=c.O,h=c.I;return e===!!e&&(r=e,e=null,t=null),o.sub&&!r?(a=o.subcount,f=c.sub(a,h)):(a=o.count,f=o.last),null==e&&null==t?(e=m,t=f):null==t?(e=d(e||0),t=f):(e=d(e),t=d(t)),c.rnd(e,t)}return o.order|=se,u=l.rand(i.n,o),o.order=s,u=l.output(u,null,i.n,o),o.sub&&!r?l.fusion(o.submethod,u,o.sub.random(),i.dimension(),i.base(),o.subpos,o.subcascade):u},rewind:function(n){var e=this;return e.order(!0,-1===n?-1:1)},hasNext:function(n){var e=this;return-1===n?se&e.$.order?!1:e._prev:e._next},next:function(n){var e,t,r,u,o,s,a=this,f=a[Tn],c=Nn.Arithmetic,d=c.O,m=c.I,h=c.J,p=a.n,_=a.$,b=_.order,g=_.count,v=_.sub?a._subitem:a._item,y=null!=v;if(n=-1===n?-1:1,0>n&&se&b)return null;if(e=0>n?h:m,se&b)if(u=_.last,c.lt(a._index,u))if(t=a._traversed){for(r=a.random("index"),o=Nn.Math.rnd()>.5?h:m;t.isset(+r);)r=c.wrap(c.add(r,o),d,u);t.set(+r),a.__item=f.unrank(r,p,_),null!=a.__item&&(a.__index=r)}else a.__item=f.rand(p,_),a.__index=null;else a._item=a.__item=null,a._traversed&&(a._traversed.dispose(),a._traversed=null);else a.__item=f.succ(a.__item,a.__index,p,_,n,a.item__),null!=a.__item&&(a.__index=c.add(a.__index,e));if(s=null!=a.__item)a._index=c.add(a._index,e),null===a.__index&&(a.__index=a._index),0>n?(a._prev=s,a._next=y):(a._prev=y,a._next=s);else if(_.sub&&_.sub.hasNext(n)){if(a.__subindex=_.sub.index(),a.__subitem=_.sub.next(n),"sequence"===_.type&&_.seq&&_.seq.length)for(i=0,l=_.seq.length;i<l;i++)_.seq[i].rewind(n);a._init(n),s=null!=a.__item}else a.__subindex=null,a.__subitem=null,0>n?(a._prev=s,a._next=y):(a._prev=y,a._next=s);return a._item=f.output(a.__item,a.__index,p,_),_.sub&&(s=s&&null!=a.__subitem,a._subindex=s?c.add(c.mul(a.__subindex,g),a._index):null,a._subitem=s?f.fusion(_.submethod,a._item,a.__subitem,a.dimension(),a.base(),_.subpos,_.subcascade):null,0>n?a._prev=s:a._next=s),v},range:function(n,e){var t,r,u,i,l=this,s=Nn.Arithmetic,a=s.N,f=s.O,c=s.I,d=l.$,m=d.sub?d.subcount:d.count,h=d.sub?s.sub(m,c):d.last,p=1,_=arguments.length,b=!(se&d.order);return 1>_?(n=f,e=h):2>_?(n=a(n),e=h):(n=a(n),e=a(e)),n=s.wrapR(n,m),e=s.wrapR(e,m),s.gt(n,e)&&(t=n,n=e,e=t,p=-1),n=s.clamp(n,f,h),b&&(e=s.clamp(e,f,h)),s.lte(n,e)?(i=[l.$.order,l.__index,l._index,l.__item&&l.__item.slice(),l._item,l.__subindex,l._subindex,l.__subitem,l._subitem,l._prev,l._next],b&&l.index(n),u=s.val(s.sub(e,n)),r=o(function(n,e,t){return n[t]=l.next(),n},new Array(u+1),null,0>p?u:0,0>p?0:u,0>p?-1:1),l.$.order=i[0],l.__index=i[1],l._index=i[2],l.__item=i[3],l._item=i[4],l.__subindex=i[5],l._subindex=i[6],l.__subitem=i[7],l._subitem=i[8],l._prev=i[9],l._next=i[10],l._update()):r=[],r},__iter__:function(){return new Ln.Iterable(this)}}),"undefined"!=typeof Symbol&&"undefined"!=typeof Symbol.iterator&&(Ln[Pn][Symbol.iterator]=Ln[Pn].__iter__),En=Nn.Tensor=zn(Ln,{constructor:function he(){var n,e=this,u=null,i=jn.call(arguments);if(n=!i.length||i[i.length-1]instanceof Ln||t(i[i.length-1])||i[i.length-1]===+i[i.length-1]?{}:i.pop()||{},i.length&&t(i[0])&&(i=i[0]),i&&i.length||(i=[]),!(e instanceof he))return new he(i,n);if(n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||ie,n.rand=n.rand||{},"partial"===n.type){i=t(i)&&i.length?i[0]:i;var l=-1,a=n.data||[],f=n.position||null;i instanceof Ln?(u=i,i=u.base(),l=i):u=n.sub,i=+(i||0)||0,a.length&&(r(a[0])||a[0].length&&(!0===a[0][0]||!1===a[0][0]))&&(l===i&&(i+=a.length,l=-1),a=he.generate(i,a,f,n.ordering||null)),l===i&&(i+=(a.length?a[0].length:0)||0,l=-1),n.data=a,n.position=f||s((a.length?a[0].length:0)||0,0,1),n.dimension=n.position.length,n.base=i,n.rand.partial=1}else if("tuple"===n.type)i[0]=i[0]||1,i[1]=i[1]||1,i[0]instanceof Ln?(u=i[0],i[0]=u.dimension()):i[1]instanceof Ln?(u=i[1],i[1]=u.base()):u=n.sub,n.base=i[1],n.dimension=i[0];else{var c=o(function(n,e){return e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e),n},[1/0,0],i);n.base=i,n.minbase=c[0],n.maxbase=c[1],n.dimension=i.length}Ln.call(e,"Tensor",i,n,u?{method:"partial"===n.type?n.submethod||"complete":n.submethod,iter:u,pos:"partial"===n.type?n.subpos||n.position:n.subpos,cascade:n.subcascade}:null)},__static__:{C:Ln.C,P:Ln.P,T:Ln.T,DUAL:Ln.DUAL,count:function(n,e){var t=Nn.Arithmetic.O,r=e&&e.type?e.type:"tensor";return"partial"===r?e.data&&e.data.length?Nn.Arithmetic.N(e.data.length):t:"tuple"===r?!n||0>=n[0]?t:Nn.Math.exp(n[1],n[0]):n&&n.length?Nn.Math.product(n):t},initial:function(n,e,t){var r,u=this,i=e&&e.type?e.type:"tensor",l=e&&e.order?e.order:ie;return t=-1===t?-1:1,(ie&l&&re&l||le&l&&!(re&l))&&(t=-t),"partial"===i?r=e.data&&e.data.length?0>t?e.data[e.data.length-1]:e.data[0]:null:(r="tuple"===i?n[0]?0>t?s(n[0],n[1]-1,0):s(n[0],0,0):[]:n.length?0>t?s(n.length,function(e){return n[e]-1}):s(n.length,0,0):[],r=u.DUAL(r,n,e)),r},succ:function(n,e,t,r,u,i){if(!t||null==n)return null;var l=r&&r.type?r.type:"tensor",o=r&&null!=r.order?r.order:ie;if(u=-1===u?-1:1,"partial"===l){if(!r.data||!r.data.length)return null;re&o&&(u=-u);var s=null==e?r.data.indexOf(n):Nn.Arithmetic.val(e);return 0>u?s-1>=0?r.data[s-1]:null:s>=0&&s+1<r.data.length?r.data[s+1]:null}return!t[0]||0>=t[0]?null:An(n,t,u,l,o,i)},rand:function(n,e){var t,r=Nn.Math.rndInt,u=this,i=e&&e.type?e.type:"tensor";return"partial"===i?t=e.data&&e.data.length?e.data[r(0,e.data.length-1)]:null:(t="tuple"===i?n[0]?s(n[0],function(e){return r(0,n[1]-1)}):[]:n.length?s(n.length,function(e){return r(0,n[e]-1)}):[],t=u.DUAL(t,n,e)),t},randu:Ln.rand,rank:function(n,e,t){var r,u,i,l=this,o=Nn.Arithmetic,s=t&&null!=t.order?t.order:ie,a=t&&t.type?t.type:"tensor",f=o.add,c=o.sub,d=o.mul,r=o.O,m=o.J;if("partial"===a)r=o.N(t.data&&t.data.length?t.data.indexOf(n):-1);else if(n=l.DUAL(n,e,t),"tuple"===a){if(u=e[0],!u)return m;for(e=e[1],i=0;u>i;i++)r=f(d(r,e),n[i])}else{if(u=e.length,!u)return m;for(i=0;u>i;i++)r=f(d(r,e[i]),n[i])}return(ie&s&&re&s||le&s&&!(re&s))&&(r=c(t&&null!=t.last?t.last:c(l.count(e,t),o.I),r)),r},unrank:function(n,e,t){var r,u,i,l,o,s,a=this,f=Nn.Arithmetic,c=t&&null!=t.order?t.order:ie,d=t&&t.type?t.type:"tensor",m=f.sub,h=f.mod,p=f.div,_=f.val;if((ie&c&&re&c||le&c&&!(re&c))&&(n=m(t&&null!=t.last?t.last:m(a.count(e,t),f.I),n)),"partial"===d){if(!t.data||!t.data.length)return null;n=_(n),o=n>=0&&n<t.data.length?t.data[n]:null}else{if("tuple"===d){if(s=e[0],!s)return[];for(o=new Array(s),u=e[1],r=n,i=s-1;i>=0;i--)l=h(r,u),r=p(r,u),o[i]=_(l)}else{if(s=e.length,!s)return[];for(o=new Array(s),r=n,i=s-1;i>=0;i--)u=e[i],l=h(r,u),r=p(r,u),o[i]=_(l)}o=a.DUAL(o,e,t)}return o},fusion:Ln.fusion,output:function(n,e,r,u){var i=this;return null==n?null:u&&"tensor"===u.type&&t(u.output)?i.component(n,u.output):Ln.output.call(i,n,e,r,u)},gray:m,product:X,directsum:V,component:function(n,e){return null==n?null:null==e?n:s(n.length,function(t){return t<e.length&&0<=n[t]&&n[t]<e[t].length?e[t][n[t]]:n[t]})},conditional:J,generate:G}}),$n=Nn.Permutation=zn(Ln,{constructor:function pe(n,e){var r=this,u=null;return r instanceof pe?(e=e||{},e.type=String(e.type||"permutation").toLowerCase(),n=n||1,n instanceof Ln?(u=n,n=u.dimension()):u=e.sub,e.base=e.dimension=n,e.rand=e.rand||{},e.rand.derangement=1,e.rand.involution=1,e.rand.connected=1,"multiset"===e.type&&(e.multiplicity=t(e.multiplicity)&&e.multiplicity.length?e.multiplicity.slice():s(n,1,0),e.multiplicity=e.multiplicity.concat(s(n-o(O,0,e.multiplicity),1,0)),e.base=e.multiplicity.length,e.multiset=en(e.multiplicity,n)),void Ln.call(r,"Permutation",n,e,u?{method:e.submethod,iter:u,pos:e.subpos,cascade:e.subcascade}:null)):new pe(n,e)},__static__:{C:Ln.C,P:Ln.P,T:Ln.T,DUAL:Ln.DUAL,count:function(n,e){var t=Nn.Arithmetic,r=t.O,u=Nn.Math.factorial,i=Nn.Math.stirling,l=e&&e.type?e.type:"permutation",o=e&&null!=e["cycles="]?0|e["cycles="]:null,s=e&&null!=e["fixed="]?0|e["fixed="]:null;return 0>=n?r:"cyclic"===l?t.N(n):"multiset"===l?u(n,e.multiplicity):"derangement"===l?s?2>n-s?r:t.mul(u(n,s),u(n-s,!1)):2>n?r:u(n,!1):"involution"===l?u(n,!0):"connected"===l?u(n-1):o?i(n,o,1):u(n)},initial:function(n,e,t){var r,u=this,i=e&&e.type?e.type:"permutation",l=e&&null!=-e.order?e.order:ie,o=e&&null!=e["cycles="]?0|e["cycles="]:null,a=e&&null!=e["fixed="]?0|e["fixed="]:null;if(0>=n)return null;if(t=-1===t?-1:1,(ie&l&&re&l||le&l&&!(re&l))&&(t=-t),"cyclic"===i)r=0>t?[n-1].concat(s(n-1,0,1)):s(n,0,1);else if("derangement"===i){if(a||2>n)return null;if(1&n){var f=Un.floor(n/2);r=0>t?s(n-f-1,n-1,-1).concat([f-1,f]).concat(s(f-1,f-2,-1)):s(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=0>t?s(n,n-1,-1):s(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===i?0>t?e.multiset.slice().reverse():e.multiset.slice():"connected"===i?null:"involution"===i?0>t?s(n,n-1,-1):s(n,0,1):o?null:0>t?s(n,n-1,-1):s(n,0,1);return r=u.DUAL(r,n,e)},succ:function(n,e,t,r,u,i){if(!t||0>=t||null==n)return null;var l=r&&r.type?r.type:"permutation",o=r&&null!=r["cycles="]?0|r["cycles="]:null,s=r&&null!=r["fixed="]?0|r["fixed="]:null;return"derangement"===l&&s||"permutation"===l&&o?null:(u=-1===u?-1:1,Mn(n,t,u,l,r&&null!=r.order?r.order:ie,r&&null!=r.base?r.base:null,i))},rand:function(n,e){var t,r=Nn.Math.rndInt,u=this,i=e&&e.type?e.type:"permutation",l=e&&null!=e["cycles="]?0|e["cycles="]:null,o=e&&null!=e["fixed="]?0|e["fixed="]:null;if("cyclic"===i){var a=r(0,n-1);t=a>0?s(n-a,a,1).concat(s(a,0,1)):s(n,0,1)}else if("derangement"===i){if(o)return null;t=new Array(n);var f,c,d,m=!1;do{for(f=0;n>f;f++)t[f]=f;for(f=n-1,m=!1;f>=0;){if(d=r(0,f),t[d]===f){m=!0;break}c=t[f],t[f]=t[d],t[d]=c,f--}m=m||0===t[0]}while(m)}else if("involution"===i){t=s(n,0,1);for(var h,p,_,b,c,g,v=Nn.Math.rnd,y=.5,x=1,w=n,M=[1].concat(s(n-1,function(){var n=y;return x+=1,y=1/(1+x*y),n})),O=s(n,0,1);w>=2;)h=w-1,p=O[h],--w,y=M[w],c=v(),c>y&&(_=r(0,w-1),b=O[_],--w,g=O[_],O[_]=O[w],O[w]=g,g=t[b],t[b]=t[p],t[p]=g)}else if("multiset"===i)t=A(e.multiset.slice());else if("connected"===i)t=A(s(n,0,1),!0);else{if(l)return null;t=A(s(n,0,1))}return t=u.DUAL(t,n,e)},randu:Ln.rand,rank:function(n,t,r){var u,i,l,o,s,a=this,f=Nn.Arithmetic,c=r&&r.type?r.type:"permutation",d=r&&null!=r["cycles="]?0|r["cycles="]:null,m=(r&&null!=r["fixed="]?0|r["fixed="]:null,r&&null!=-r.order?r.order:ie),h=f.sub,p=f.add,_=f.mul,b=f.div,g=f.O,v=f.I,y=f.J;if(t=t||n.length,!t)return y;if(n=a.DUAL(n,t,r),"cyclic"===c)g=f.NUM(n[0]);else{if("derangement"===c||"involution"===c||"connected"===c)return e();if("multiset"===c)for(s=r.multiplicity.slice(),o=r&&null!=r.count?r.count:Nn.Math.factorial(t,s),l=t-1,u=0;l>u&&f.gt(o,v);u++)i=n[u],g=p(g,b(_(o,I(s,0,i-1,1)),t-u)),o=b(_(o,s[i]),t-u),s[i]--;else{if(d)return y;for(n=ln(null,n),l=t-1,u=0;l>u;u++)g=p(_(g,t-u),n[u])}}return(ie&m&&re&m||le&m&&!(re&m))&&(g=h(r&&null!=r.last?r.last:h(a.count(t,r),v),g)),g},unrank:function(n,t,r){var u,i,l,o,a,f,c,d,m=this,h=Nn.Arithmetic,p=r&&r.type?r.type:"permutation",_=r&&null!=r["cycles="]?0|r["cycles="]:null,b=(r&&null!=r["fixed="]?0|r["fixed="]:null,r&&null!=-r.order?r.order:ie),g=h.mod,v=h.div,y=h.mul,x=h.sub,A=h.val;if(!t)return[];if((ie&b&&re&b||le&b&&!(re&b))&&(n=x(r&&null!=r.last?r.last:x(m.count(t,r),h.I),n)),"cyclic"===p)n=A(n),u=s(t,function(e){return(n+e)%t});else{if("derangement"===p||"involution"===p||"connected"===p)return e();if("multiset"===p)for(d=r.multiplicity.slice(),u=s(t),c=r&&null!=r.count?r.count:Nn.Math.factorial(t,d),l=0;t>l;l++){for(a=0,o=0,i=A(v(y(n,t-l),c));o<d.length&&a+d[o]<=i;)a+=d[o++];n=x(n,v(y(c,a),t-l)),c=v(y(c,d[o]),t-l),d[o]--,u[l]=o}else{if(_)return null;for(u=s(t),u[t-1]=0,i=n,l=t-2;l>=0;l--)a=t-l,f=g(i,a),i=v(i,a),u[l]=A(f);on(u,u)}}return u=m.DUAL(u,t,r)},fusion:Ln.fusion,output:Ln.output,permute:dn,shuffle:function(n,e){if("cyclic"===e){var t=n.length,r=Nn.Math.rndInt(0,t-1);return r>0&&n.push.apply(n,n.splice(0,r)),n}return"connected"===e?A(n,!0):A(n)},product:function(){return arguments.length?mn(t(arguments[0])&&t(arguments[0][0])?arguments[0]:jn.call(arguments)):null},directsum:function(){return arguments.length?hn(t(arguments[0])&&t(arguments[0][0])?arguments[0]:jn.call(arguments)):null},cycles:function(n,e){return-1===e?cycles2permutation(n):an(n)},swaps:function(n,e){return-1===e?cn(n):fn(n)},inversion:function(n,e){return-1===e?on(null,n):ln(null,n)},inverse:function(n){return un(null,n)},multiset:function(n,e,t){return n===+n?en(e,n,-1===t?-1:1):-1===t?tn(n):rn(n,e)},matrix:function(n,e,t){return-1===t?nn(null,n,e):Z(null,n,e)},parity:e,is_permutation:pn,is_identity:_n,is_cyclic:yn,is_derangement:vn,is_involution:bn,is_kthroot:gn,is_connected:xn},_update:function(){var n=this;return n.item__=wn(n.__item,n.n,n.$.order,n.$.type),n}}),kn=Nn.Combination=zn(Ln,{constructor:function _e(n,e,r){var u=this,i=null;if(!(u instanceof _e))return new _e(n,e,r);if(t(n)?(r=e||{},e=n[1]||1,n=n[0]||1):(r=r||{},n=n||1,e=e||1),r.type=String(r.type||"unordered").toLowerCase(),-1<r.type.indexOf("+")){var l=r.type.split("+");l.sort(),r.type=l.join("+")}e instanceof Ln?(i=e,e=i.dimension()):n instanceof Ln?(i=n,n=i.base()):i=r.sub,r.base=n,r.dimension=e,Ln.call(u,"Combination",[n,e],r,i?{method:r.submethod,iter:i,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:Ln.C,P:Ln.P,T:Ln.T,DUAL:Ln.DUAL,count:function(n,e){var t=Nn.Math.factorial,r=e&&e.type?e.type:"unordered";return"ordered+repeated"===r?Nn.Math.exp(n[0],n[1]):"repeated"===r?t(n[0]+n[1]-1,n[1]):"ordered"===r?t(n[0],-n[1]):t(n[0],n[1])},initial:function(n,e,t){var r,u=this,i=e&&e.type?e.type:"unordered",l=e&&null!=e.order?e.order:ie;return t=-1===t?-1:1,(ie&l&&re&l||le&l&&!(re&l))&&(t=-t),r="ordered+repeated"===i||"repeated"===i?0>t?s(n[1],n[0]-1,0):s(n[1],0,0):"ordered"===i?0>t?s(n[1],n[0]-1,-1):s(n[1],0,1):0>t?s(n[1],n[0]-n[1],1):s(n[1],0,1),r=u.DUAL(r,n,e)},succ:function(n,e,t,r,u,i){return!t||!t[0]||0>=t[0]||null==n?null:(u=-1===u?-1:1,qn(n,t,u,r&&r.type?r.type:"unordered",r&&null!=r.order?r.order:ie,i))},rand:function(n,e){var t,r,u,i,l=this,o=e&&e.type?e.type:"unordered",a=n[1],f=Nn.Math.rndInt;return n=n[0],r=n-a,u=n-1,"repeated"===o||"ordered+repeated"===o?(t=1===a?[f(0,u)]:s(a,function(){return f(0,u)}),a>1&&"repeated"===o&&y(t,1,!0)):"ordered"===o?(i={},t=1===a?[f(0,u)]:n===a?A(s(a,0,1)):s(a,function(){for(var e=f(0,u);1===i[e];)e=(e+1)%n;return i[e]=1,e})):(i={},t=1===a?[f(0,u)]:n===a?s(a,0,1):a>r?F(n,s(r,function(){for(var e=f(0,u);1===i[e];)e=(e+1)%n;return i[e]=1,e}),!0):y(s(a,function(){for(var e=f(0,u);1===i[e];)e=(e+1)%n;return i[e]=1,e}),1,!0)),t=l.DUAL(t,n,e)},randu:Ln.rand,rank:function(n,e,t){var r,u,i,l,o,s=this,a=Nn.Arithmetic,f=a.add,c=a.sub,d=a.mul,m=a.O,h=a.I,p=m,_=e[1],b=t&&null!=t.order?t.order:ie,g=t&&t.type?t.type:"unordered",v=Nn.Math.factorial;if(n=s.DUAL(n,e,t),"ordered+repeated"===g)for(l=e[0],r=0;_>r;r++)p=f(d(p,l),n[r]);else if("repeated"===g){for(l=e[0]+_-1,o=t&&t.count?t.count:v(l,_),r=1;_>=r;r++)u=l-1-n[r-1]-r+1,i=_+1-r,u>=i&&(p=f(p,v(u,i)));p=c(c(o,h),p)}else if("ordered"===g)for(l=e[0],n=ln(null,n,l),r=0;_>r;r++)p=f(d(p,l-r),n[r]);else{for(l=e[0],o=t&&t.count?t.count:v(l,_),r=1;_>=r;r++)u=l-1-n[r-1],i=_+1-r,u>=i&&(p=f(p,v(u,i)));p=c(c(o,h),p)}return(ie&b&&re&b||le&b&&!(re&b))&&(p=c(t&&null!=t.last?t.last:c(s.count(e,t),h),p)),p},unrank:function(n,e,t){var r,u,i,l,o,a,f,c=this,d=Nn.Arithmetic,m=d.O,h=d.I,p=d.sub,_=d.div,b=d.mod,g=d.mul,v=d.lte,y=d.gt,x=d.val,A=e[1],w=t&&t.type?t.type:"unordered",M=t&&null!=t.order?t.order:ie;if(e=e[0],(ie&M&&re&M||le&M&&!(re&M))&&(n=p(t&&null!=t.last?t.last:p(c.count(e,t),d.I),n)),r=s(A),"ordered+repeated"===w)for(l=n,a=A-1;a>=0;a--)o=b(l,e),l=_(l,e),r[a]=x(o);else if("ordered"===w){for(l=n,a=A-1;a>=0;a--)i=e-a,o=b(l,i),l=_(l,i),r[a]=x(o);on(r,r,i)}else{f="repeated"===w,i=f?e+A-1:e,u=t&&t.count?t.count:Nn.Math.factorial(i,A),n=p(p(u,h),n),u=_(g(u,i-A),i),o=i-A+1,l=A,a=i-1;do v(u,n)?(r[A-l]=f?i-o-A+1:i-o-l+1,y(u,m)&&(n=p(n,u),u=_(g(u,l),a)),l--,a--):(u=_(g(u,a-l),a),o--,a--);while(l>0)}return r=c.DUAL(r,e,t)},fusion:Ln.fusion,output:function(n,e,t,r){return null==n?null:r&&"binary"===r.type?H(n,t[0]):Ln.output.call(this,n,e,t,r)},complement:function(n,e,t){return!0===t?A(F(e,n,!0)):F(e,n)},binary:function(n,e,t){return-1===t?W(n,e):H(n,e)},pick:function(n,e,t){return e>0&&n.length?w(n,e,"ordered+repeated"!==t&&"ordered"!==t,"ordered+repeated"===t||"repeated"===t,new Array(e)):[]},choose:function(n,e){return e&&e.length?s(e.length,function(t){return 0<=e[t]&&e[t]<n.length?n[e[t]]:null}):[]}},_update:function(){var n=this;return n.item__=On(n.__item,n.n[0],n.n[1],n.$.order,n.$.type),n}}),kn.conjugate=kn.complement,kn.project=kn.choose,Dn=Nn.Powerset=Nn.Subset=zn(Ln,{constructor:function be(n,e){var t=this,r=null;return t instanceof be?(e=e||{},e.type=e.type||"subset",n=n||1,n instanceof Ln?(r=n,n=r.base()):r=e.sub,e.base=n,e.dimension=n,e.mindimension=0,e.maxdimension=n,void Ln.call(t,"Subset",n,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)):new be(n,e)},__static__:{C:function(n,e){return F(e,n)},P:Ln.P,T:Ln.T,DUAL:function(n,e,t){if(null==n)return null;var r=this,u=r.C,i=r.P,l=(r.T,t&&null!=t.order?t.order:ie);return n=se&l?ue&l?n:i(n):oe&l?ue&l?n:i(n):le&l?ue&l?i(u(n,e)):u(n,e):ue&l?n:i(n)},count:function(n,e){return Nn.Math.pow2(n)},initial:function(n,e,t){var r,u=this,i=e&&null!=e.order?e.order:ie;return t=-1===t?-1:1,(ie&i&&re&i||le&i&&!(re&i))&&(t=-t),r=0>t?s(n,0,1):[],r=u.DUAL(r,n,e)},succ:Ln.succ,rand:function(n,e){for(var t,r=this,u=Nn.Math.rndInt,i=null,l=n-1;l>=0;l--)u(0,1)&&(i={len:i?i.len+1:1,k:l,next:i});return t=i?s(i.len,function(n){var e=i.k;return i=i.next,e}):[],t=r.DUAL(t,n,e)},randu:Ln.rand,rank:function(n,e,t){var r=this,u=Nn.Arithmetic,i=u.O,l=u.I,o=u.add,s=u.shl,a=u.sub,f=t&&null!=t.order?t.order:ie,c=i,d=0,m=n.length;for(n=r.DUAL(n,e,t);m>d;)c=o(c,s(l,n[d++]));return(ie&f&&re&f||le&f&&!(re&f))&&(c=a(t&&null!=t.last?t.last:a(r.count(e,t),l),c)),c},unrank:function(n,e,t){var r=this,u=Nn.Arithmetic,i=u.O,l=u.J,o=u.band,s=u.shr,a=u.gt,f=u.sub,c=t&&null!=t.order?t.order:ie,d=[],m=0,h=t&&t.count?t.count:r.count(e,t);if(!u.inside(n,l,h))return null;for((ie&c&&re&c||le&c&&!(re&c))&&(n=f(t&&null!=t.last?t.last:f(h,u.I),n));a(n,i);)a(o(n,1),i)&&d.push(m),a(o(n,2),i)&&d.push(m+1),a(o(n,4),i)&&d.push(m+2),a(o(n,8),i)&&d.push(m+3),a(o(n,16),i)&&d.push(m+4),a(o(n,32),i)&&d.push(m+5),a(o(n,64),i)&&d.push(m+6),a(o(n,128),i)&&d.push(m+7),m+=8,n=s(n,8);return d=r.DUAL(d,e,t)},fusion:Ln.fusion,output:function(n,e,t,r){return null==n?null:r&&"binary"===r.type?H(n,t):Ln.output.call(this,n,e,t,r)},binary:function(n,e,t){return-1===t?W(n,e):H(n,e)}}}),Rn=Nn.Partition=zn(Ln,{constructor:function ge(n,e){var t=this,r=null;if(!(t instanceof ge))return new ge(n,e);e=e||{},e.type=e.type||"partition",n=n||1,n instanceof Ln?(r=n,n=r.base()):r=e.sub;var u=e["max="]?0|e["max="]:null,i=e["parts="]?0|e["parts="]:null,l=i?i:u?n-u+1:n,o=i?i:u?Un.ceil(n/u):1;e.base=n,e.dimension=i||n,e.mindimension=Un.min(o,l),e.maxdimension=Un.max(o,l),e.rand=e.rand||{},e.rand.partition=1,e.rand.composition=1,e.rand.packed=1,Ln.call(t,"Partition",n,e,r?{method:e.submethod,iter:r,pos:e.subpos,cascade:e.subcascade}:null)},__static__:{C:function(n,e,t){var r=t&&t.type?t.type:"partition",u=t&&null!=t.order?t.order:ie,i=t&&t["max="]?0|t["max="]:null,l=t&&t["parts="]?0|t["parts="]:null;return"composition"!==r&&le&u&&c(n,n),l||i?n:z("composition"===r,n,1)},P:Ln.P,T:Ln.T,DUAL:Ln.DUAL,count:function(n,e){var t=e&&e["max="]?0|e["max="]:null,r=e&&e["parts="]?0|e["parts="]:null,u=e&&e.type?e.type:"partition";return"composition"===u?Nn.Math.compositions(n,r,t):Nn.Math.partitions(n,r,t)},initial:function(n,e,t){var r,u,i,l=this,o=e&&e.type?e.type:"partition",a=e&&e["max="]?0|e["max="]:null,f=e&&e["parts="]?0|e["parts="]:null,d=e&&null!=e.order?e.order:ie,m="composition"===o;return 0>=n||f&&a&&(f+a>n+1||n>f*a)||f&&f>n||a&&a>n?null:(t=-1===t?-1:1,(ie&d&&re&d||le&d&&re&d)&&(t=-t),f&&a?(1===f&&(r=[a]),m?(i=Un.min(a,Un.ceil((n-a)/(f-1))),r=[(n-a)%i||i].concat(s(f-2,i,0)).concat([a]),0>t&&c(r,r)):0>t?(u=Un.min(f,Un.floor(n/a)||1),n-=u*a,f-=u,0===n&&f>0&&(u--,f++,n+=a),r=[a].concat(s(u-1,a,0)).concat(n>0&&f>0?[n-f+1].concat(s(f-1,1,0)):[])):(i=Un.min(a,Un.ceil((n-a)/(f-1))),r=[a].concat(s(f-2,i,0).concat([(n-a)%i||i])))):f?m?(r=s(f-1,1,0).concat([n-f+1]),0>t&&c(r,r)):(i=Un.ceil(n/f),u=n%i||i,r=0>t?[n-f+1].concat(s(f-1,1,0)):s(f-1,i,0).concat([u])):a?(u=Un.floor(n/a),i=n%a,r=m?0>t?s(u,a,0).concat(i?[i]:[]):s(n-a,1,0).concat([a]):0>t?s(u,a,0).concat(i?[i]:[]):[a].concat(s(n-a,1,0))):r=0>t?[n]:s(n,1,0),r=l.DUAL(r,n,e))},succ:function(n,e,t,r,u,i){if(null==t||null==n)return null;var l=r&&r.type?r.type:"partition",o=r&&r["max="]?0|r["max="]:null,s=r&&r["parts="]?0|r["parts="]:null;return 0>=t||s&&o&&(s+o>t+1||t>s*o)||s&&s>t||o&&o>t?null:(u=-1===u?-1:1,"composition"===l?Cn(n,t,u,s,o,r&&null!=r.order?r.order:ie,i):Sn(n,t,u,s,o,r&&null!=r.order?r.order:ie,i))},rand:function(n,e){var t,r,u,i,l,o=this,a=Nn.Math.rndInt,f=e&&e.type?e.type:"partition",c=(e&&null!=e.order?e.order:ie,e&&e["max="]?0|e["max="]:null),d=e&&e["parts="]?0|e["parts="]:null,m=0,h=0,p="composition"===f,_=!1;if(0>=n||d&&c&&(d+c>n+1||n>d*c)||d&&d>n||c&&c>n)return null;if(d&&c)return null;if(c&&!d&&(d=c,_=!0),d)1===d?(r=[n],h=n):n===d?(r=s(d,1,0),h=n):(t={},u=n-2,s(r=y(s(d-1,function(){for(l=a(0,u);1===t[l];)l=(l+1)%(u+1);return t[l]=1,l+1}),1,!0),function(n){return l=r[n],i=l-m,m=l,h+=i,i}));else{for(t=null,l=1;n>l;l++)a(0,1)&&(i=l-m,m=l,h+=i,t={len:t?t.len+1:1,x:i,next:t});r=t?s(t.len,function(){return i=t.x,t=t.next,i}):[]}return n>h&&(r.length?r.splice(a(0,r.length-1),0,n-h):r.push(n-h)),p?_&&(r=A(z(0,y(r,-1)))):(r=y(r,-1),_&&(r=z(0,r))),r=o.DUAL(r,n,e)},randu:Ln.rand,rank:e,unrank:e,fusion:Ln.fusion,output:function(n,e,t,r){if(null==n)return null;var u=n,i=r&&r.type?r.type:"partition",l=r&&null!=r.order?r.order:ie,o=ue&l?-1:1;r&&r["max="]?0|r["max="]:null,r&&r["parts="]?0|r["parts="]:null;return"composition"===i||"packed"===i&&(n=K(n,o)),u===n?n.slice():n},conjugate:function(n,e){return z("composition"===e,n)},subset:function(n,e){
return-1===e?Y(n):B(n)},pack:function(n,e){return-1===e?Q(n):K(n)}},_update:function(){var n=this;return n.item__=In(n.__item,n.n,n.$.order,n.$.type,n.$),n}}),Rn.transpose=Rn.conjugate,Nn});