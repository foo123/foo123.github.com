/**
*
*   FILTER.js Plugins
*   @version: @@VERSION@@
*   @dependencies: Filter.js
*
*   JavaScript Image Processing Library (Plugins)
*   https://github.com/foo123/FILTER.js
*
**/!function(n,e){"use strict";"object"==typeof module&&module.exports?module.exports=e.call(n,module.$deps&&module.$deps.FILTER||require("./FILTER".toLowerCase())):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified("FILTER_PLUGINS")?define("FILTER_PLUGINS",["module","FILTER"],function(r,t){return e.moduleUri=r.uri,e.call(n,t),t}):(e.call(n,n.FILTER)||1)&&"function"==typeof define&&define.amd&&define(function(){return n.FILTER})}(this,function n(e){return!function(e){"use strict";var r=e._notSupportClamp,t=Math.random;e.Create({name:"NoiseFilter",min:-127,max:127,init:function(n,e){var r=this;r.min=n||-127,r.max=e||127},path:e.getPath(n.moduleUri),serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{min:n.min,max:n.max}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.min=e.min,r.max=e.max),r},apply:function(n,e,a){var i=this;if(!i._isOn)return n;var s,o,l,u,h,c,f,d,m=i.max-i.min,g=i.min,p=n.length;if(r)for(s=0;p>s;s+=4)l=n[s],u=n[s+1],h=n[s+2],o=m*t()+g,c=l+o,f=u+o,d=h+o,0>c?c=0:c>255&&(c=255),0>f?f=0:f>255&&(f=255),0>d?d=0:d>255&&(d=255),n[s]=~~c,n[s+1]=~~f,n[s+2]=~~d;else for(s=0;p>s;s+=4)l=n[s],u=n[s+1],h=n[s+2],o=m*t()+g,c=l+o,f=u+o,d=h+o,n[s]=~~c,n[s+1]=~~f,n[s+2]=~~d;return n}})}(e),!function(e){"use strict";var r=e._notSupportClamp,t=e.Array32F,a=e.Color.RGB2YCbCr,i=e.Color.YCbCr2RGB;e.Create({name:"HistogramEqualizeFilter",path:e.getPath(n.moduleUri),apply:function(n,e,s){var o=this;if(!o._isOn)return n;var l,u,h,c,f,d,m,g,p,_,v,y=0,C=255,b=0,M=n.length,w=M>>2,I=1/w;for(f=new t(256),p=0;256>p;p+=8)f[p]=0,f[p+1]=0,f[p+2]=0,f[p+3]=0,f[p+4]=0,f[p+5]=0,f[p+6]=0,f[p+7]=0;for(p=0;M>p;p+=4)_=a(n.subarray(p,p+3)),l=n[p]=~~_[2],u=n[p+1]=~~_[0],h=n[p+2]=~~_[1],f[u]+=I,u>y?y=u:C>u&&(C=u);for(b=0,p=0;256>p;p+=8)b+=f[p],f[p]=b,b+=f[p+1],f[p+1]=b,b+=f[p+2],f[p+2]=b,b+=f[p+3],f[p+3]=b,b+=f[p+4],f[p+4]=b,b+=f[p+5],f[p+5]=b,b+=f[p+6],f[p+6]=b,b+=f[p+7],f[p+7]=b;if(c=y-C,r)for(p=0;M>p;p+=4)_=[n[p+1],n[p+2],n[p]],_[0]=f[_[0]]*c+C,v=i(_),d=v[0],m=v[1],g=v[2],d=0>d?0:d>255?255:d,m=0>m?0:m>255?255:m,g=0>g?0:g>255?255:g,n[p]=~~d,n[p+1]=~~m,n[p+2]=~~g;else for(p=0;M>p;p+=4)_=[n[p+1],n[p+2],n[p]],_[0]=f[_[0]]*c+C,v=i(_),n[p]=~~v[0],n[p+1]=~~v[1],n[p+2]=~~v[2];return n}}),e.Create({name:"GrayscaleHistogramEqualizeFilter",path:e.getPath(n.moduleUri),apply:function(n,e,a){var i=this;if(!i._isOn)return n;var s,o,l,u,h,c=0,f=255,d=0,m=n.length,g=m>>2,p=1/g;for(u=new t(256),h=0;256>h;h+=8)u[h]=0,u[h+1]=0,u[h+2]=0,u[h+3]=0,u[h+4]=0,u[h+5]=0,u[h+6]=0,u[h+7]=0;for(h=0;m>h;h+=4)s=n[h],u[s]+=p,s>c?c=s:f>s&&(f=s);for(d=0,h=0;256>h;h+=8)d+=u[h],u[h]=d,d+=u[h+1],u[h+1]=d,d+=u[h+2],u[h+2]=d,d+=u[h+3],u[h+3]=d,d+=u[h+4],u[h+4]=d,d+=u[h+5],u[h+5]=d,d+=u[h+6],u[h+6]=d,d+=u[h+7],u[h+7]=d;if(l=c-f,r)for(h=0;m>h;h+=4)s=n[h],o=u[s]*l+f,o=0>o?0:o>255?255:o,o=~~o,n[h]=o,n[h+1]=o,n[h+2]=o;else for(h=0;m>h;h+=4)s=n[h],o=~~(u[s]*l+f),n[h]=o,n[h+1]=o,n[h+2]=o;return n}}),e.Create({name:"RGBHistogramEqualizeFilter",path:e.getPath(n.moduleUri),apply:function(n,e,a){var i=this;if(!i._isOn)return n;var s,o,l,u,h,c,f,d,m,g,p,_,v,y,C,b,M=0,w=0,I=0,O=255,z=255,x=255,P=n.length,k=P>>2,F=1/k;for(f=new t(256),d=new t(256),m=new t(256),b=0;256>b;b+=8)f[b]=0,d[b]=0,m[b]=0,f[b+1]=0,d[b+1]=0,m[b+1]=0,f[b+2]=0,d[b+2]=0,m[b+2]=0,f[b+3]=0,d[b+3]=0,m[b+3]=0,f[b+4]=0,d[b+4]=0,m[b+4]=0,f[b+5]=0,d[b+5]=0,m[b+5]=0,f[b+6]=0,d[b+6]=0,m[b+6]=0,f[b+7]=0,d[b+7]=0,m[b+7]=0;for(b=0;P>b;b+=4)s=n[b],o=n[b+1],l=n[b+2],f[s]+=F,d[o]+=F,m[l]+=F,s>M?M=s:O>s&&(O=s),o>w?w=o:z>o&&(z=o),l>I?I=l:x>l&&(x=l);for(g=p=_=0,b=0;256>b;b+=8)g+=f[b],f[b]=g,p+=d[b],d[b]=p,_+=m[b],m[b]=_,g+=f[b+1],f[b+1]=g,p+=d[b+1],d[b+1]=p,_+=m[b+1],m[b+1]=_,g+=f[b+2],f[b+2]=g,p+=d[b+2],d[b+2]=p,_+=m[b+2],m[b+2]=_,g+=f[b+3],f[b+3]=g,p+=d[b+3],d[b+3]=p,_+=m[b+3],m[b+3]=_,g+=f[b+4],f[b+4]=g,p+=d[b+4],d[b+4]=p,_+=m[b+4],m[b+4]=_,g+=f[b+5],f[b+5]=g,p+=d[b+5],d[b+5]=p,_+=m[b+5],m[b+5]=_,g+=f[b+6],f[b+6]=g,p+=d[b+6],d[b+6]=p,_+=m[b+6],m[b+6]=_,g+=f[b+7],f[b+7]=g,p+=d[b+7],d[b+7]=p,_+=m[b+7],m[b+7]=_;if(u=M-O,h=w-z,c=I-x,r)for(b=0;P>b;b+=4)s=n[b],o=n[b+1],l=n[b+2],v=f[s]*u+O,y=d[o]*h+z,C=m[l]*c+x,v=0>v?0:v>255?255:v,y=0>y?0:y>255?255:y,C=0>C?0:C>255?255:C,n[b]=~~v,n[b+1]=~~y,n[b+2]=~~C;else for(b=0;P>b;b+=4)s=n[b],o=n[b+1],l=n[b+2],v=f[s]*u+O,y=d[o]*h+z,C=m[l]*c+x,n[b]=~~v,n[b+1]=~~y,n[b+2]=~~C;return n}})}(e),!function(e){"use strict";var r=Math.sqrt,t=e._notSupportClamp,a=e.Array32F;e.Create({name:"PixelateFilter",scale:1,init:function(n){var e=this;e.scale=n||1},path:e.getPath(n.moduleUri),serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{scale:n.scale}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.scale=e.scale),r},apply:function(n,e,i){var s=this;if(!s._isOn||s.scale<=1)return n;s.scale>100&&(s.scale=100);var o,l,u,h,c,f,d,m,g,p,_,v,y,C,b,M,w,I,O,z,x,P,k,F,Y,S,N,A,L,R,X,U,H,q,E,G,B,T,W,j,$,D,V,Q,J,K,Z=n.length,nn=Z>>>2,en=(e<<1)+e;for(o=~~(r(nn)*s.scale*.01),l=e*o,u=i%o,h=e%o,c=(u-1)*e,g=1/(o*o),p=1/(h*o),_=1/(u*o),v=1/(h*u),y=g,C=p,b=_,M=v,x=o-1,P=(o-1)*e,G=0,T=e-1,B=0,W=nn-e,w=new a(3*nn),k=0,F=0,Y=0,I=O=z=0,Y=0;e>Y;Y++,k+=4,F+=3)I+=n[k],O+=n[k+1],z+=n[k+2],w[F]=I,w[F+1]=O,w[F+2]=z;for(F=0,Y=0,I=O=z=0,k=en+e;Z>k;k+=4,F+=3,Y++)Y>=e&&(Y=0,I=O=z=0),I+=n[k],O+=n[k+1],z+=n[k+2],w[F+en]=w[F]+I,w[F+en+1]=w[F+1]+O,w[F+en+2]=w[F+2]+z;for(Y=0,S=0,N=0,U=Y,H=N,q=U+x,E=H+P,q=q>T?T:q,E=E>W?W:E,j=U+H,V=q+E,$=q+H,D=U+E,j=(j<<1)+j,$=($<<1)+$,D=(D<<1)+D,V=(V<<1)+V,m=y,Q=m*(w[V]-w[$]-w[D]+w[j]),J=m*(w[V+1]-w[$+1]-w[D+1]+w[j+1]),K=m*(w[V+2]-w[$+2]-w[D+2]+w[j+2]),t&&(Q=0>Q?0:Q>255?255:Q,J=0>J?0:J>255?255:J,K=0>K?0:K>255?255:K),Q=~~Q,J=~~J,K=~~K,A=0,L=0,R=0,k=0;Z>k;k+=4)X=A+Y+R+N<<2,n[X]=Q,n[X+1]=J,n[X+2]=K,A++,(A+Y>=e||A>=o)&&(A=0,L++,R+=e),(L+S>=i||L>=o)&&(Y+=o,Y>=e&&(Y=0,S+=o,N+=l),A=0,L=0,R=0,U=Y,H=N,q=U+x,E=H+P,q=q>T?T:q,E=E>W?W:E,j=U+H,V=q+E,$=q+H,D=U+E,j=(j<<1)+j,$=($<<1)+$,D=(D<<1)+D,V=(V<<1)+V,f=0==q-U-h+1,d=0==E-H-c,m=f&&d?M:f?C:d?b:y,Q=m*(w[V]-w[$]-w[D]+w[j]),J=m*(w[V+1]-w[$+1]-w[D+1]+w[j+1]),K=m*(w[V+2]-w[$+2]-w[D+2]+w[j+2]),t&&(Q=0>Q?0:Q>255?255:Q,J=0>J?0:J>255?255:J,K=0>K?0:K>255?255:K),Q=~~Q,J=~~J,K=~~K);return n}})}(e),!function(e){"use strict";var r=Math.sqrt,t=(Math.SQRT2,Math.min,e._notSupportClamp),a=e.Array32F;e.Create({name:"TriangularPixelateFilter",scale:1,init:function(n){var e=this;e.scale=n||1},path:e.getPath(n.moduleUri),serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{scale:n.scale}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.scale=e.scale),r},apply:function(n,e,i){var s=this;if(!s._isOn||s.scale<=1)return n;s.scale>100&&(s.scale=100);var o,l,u,h,c,f,d,m,g,p,_,v,y,C,b,M,w,I,O,z,x,P,k,F,Y,S,N,A,L,R,X,U,H,q,E,G,B,T,W,j,$,D,V,Q,J,K,Z,nn,en,rn,tn,an,sn,on,ln=n.length,un=ln>>>2,hn=(e<<1)+e;for(o=~~(r(un)*s.scale*.01),l=o>>1,u=o-1,h=e*o,c=i%o,f=e%o,d=(c-1)*e,_=1/(o*o),v=1/(f*o),y=1/(c*o),C=1/(f*c),b=2*_,M=2*v,w=2*y,I=2*C,k=u,F=u*e,T=0,j=e-1,W=0,$=un-e,O=new a(3*un),Y=0,S=0,N=0,z=x=P=0,N=0;e>N;N++,Y+=4,S+=3)z+=n[Y],x+=n[Y+1],P+=n[Y+2],O[S]=z,O[S+1]=x,O[S+2]=P;for(S=0,N=0,z=x=P=0,Y=hn+e;ln>Y;Y+=4,S+=3,N++)N>=e&&(N=0,z=x=P=0),z+=n[Y],x+=n[Y+1],P+=n[Y+2],O[S+hn]=O[S]+z,O[S+hn+1]=O[S+1]+x,O[S+hn+2]=O[S+2]+P;for(N=0,A=0,L=0,q=N,E=L,G=N-l+k,B=L+F,G=G>j?j:G,B=B>$?$:B,D=q+E,J=G+B,V=G+E,Q=q+B,D=(D<<1)+D,V=(V<<1)+V,Q=(Q<<1)+Q,J=(J<<1)+J,p=b,en=p*(O[J]-O[V]-O[Q]+O[D]),rn=p*(O[J+1]-O[V+1]-O[Q+1]+O[D+1]),tn=p*(O[J+2]-O[V+2]-O[Q+2]+O[D+2]),q=N+l,G=N+k,G=G>j?j:G,D=q+E,J=G+B,V=G+E,Q=q+B,D=(D<<1)+D,V=(V<<1)+V,Q=(Q<<1)+Q,J=(J<<1)+J,an=p*(O[J]-O[V]-O[Q]+O[D]),sn=p*(O[J+1]-O[V+1]-O[Q+1]+O[D+1]),on=p*(O[J+2]-O[V+2]-O[Q+2]+O[D+2]),t&&(en=0>en?0:en>255?255:en,rn=0>rn?0:rn>255?255:rn,tn=0>tn?0:tn>255?255:tn,an=0>an?0:an>255?255:an,sn=0>sn?0:sn>255?255:sn,on=0>on?0:on>255?255:on),en=~~en,rn=~~rn,tn=~~tn,an=~~an,sn=~~sn,on=~~on,K=en,Z=rn,nn=tn,R=0,X=0,U=0,Y=0;ln>Y;Y+=4)H=R+N+U+L<<2,n[H]=K,n[H+1]=Z,n[H+2]=nn,R++,(R+N>=e||R>=o)&&(R=0,X++,U+=e,K=en,Z=rn,nn=tn),R>u-X&&(K=an,Z=sn,nn=on),(X+A>=i||X>=o)&&(N+=o,N>=e&&(N=0,A+=o,L+=h),R=0,X=0,U=0,q=N,E=L,G=N-l+k,B=L+F,G=G>j?j:G,B=B>$?$:B,D=q+E,J=G+B,V=G+E,Q=q+B,D=(D<<1)+D,V=(V<<1)+V,Q=(Q<<1)+Q,J=(J<<1)+J,m=0==G-q+l-f+1,g=0==B-E-d,p=m&&g?I:m?M:g?w:b,en=p*(O[J]-O[V]-O[Q]+O[D]),rn=p*(O[J+1]-O[V+1]-O[Q+1]+O[D+1]),tn=p*(O[J+2]-O[V+2]-O[Q+2]+O[D+2]),q=N+l,G=N+k,G=G>j?j:G,D=q+E,J=G+B,V=G+E,Q=q+B,D=(D<<1)+D,V=(V<<1)+V,Q=(Q<<1)+Q,J=(J<<1)+J,m=0==G-q+l-f+1,p=m&&g?I:m?M:g?w:b,an=p*(O[J]-O[V]-O[Q]+O[D]),sn=p*(O[J+1]-O[V+1]-O[Q+1]+O[D+1]),on=p*(O[J+2]-O[V+2]-O[Q+2]+O[D+2]),t&&(en=0>en?0:en>255?255:en,rn=0>rn?0:rn>255?255:rn,tn=0>tn?0:tn>255?255:tn,an=0>an?0:an>255?255:an,sn=0>sn?0:sn>255?255:sn,on=0>on?0:on>255?255:on),en=~~en,rn=~~rn,tn=~~tn,an=~~an,sn=~~sn,on=~~on,K=en,Z=rn,nn=tn);return n}})}(e),!function(e,r){"use strict";var t=7/16,a=3/16,i=5/16,s=1/16,o=e.Array32F,l=e.Color.clamp,u=e.Color.RGB2YCbCr,h=e.Color.YCbCr2RGB;e.Create({name:"HalftoneFilter",_threshold:.4,_size:1,_grayscale:!1,init:function(n,e,t){var a=this;a._size=n||1,a._threshold=l(r===e?.4:e,0,1),a._grayscale=!!t},path:e.getPath(n.moduleUri),size:function(n){return this._size=n,this},threshold:function(n){return this._threshold=l(n,0,1),this},grayscale:function(n){return arguments.length||(n=!0),this._grayscale=!!n,this},serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{_size:n._size,_threshold:n._threshold,_grayscale:n._grayscale}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r._size=e._size,r._threshold=e._threshold,r._grayscale=e._grayscale),r},apply:function(n,e,r){var c,f,d,m,g,p,_,v,y,C,b,M,w,I,O,z,x,P=this,k=n.length,F=k>>>2,Y=new o(3*F),S=P._size,N=S*S,A=1/N,L=255*P._threshold,R=R<<1,X=!P._grayscale,U=S*e,H=t,q=a,E=i,G=s;for(_=0,v=0,p=0;r>_;){for(M=w=I=0,y=0,C=0,b=0;S>C;)c=p+v+y+b<<2,f=3*(p+v+y+b),M+=n[c]+Y[f],w+=n[c+1]+Y[f+1],I+=n[c+2]+Y[f+2],y++,y>=S&&(y=0,C++,b+=e);if(M*=A,w*=A,I*=A,g=X?u([M,w,I]):[M,w,I],d=g[0],d>L?X?(g[0]=l(~~d,0,255),m=h(g)):m=[255,255,255]:m=[0,0,0],c=p+v<<2,O=n[c]-m[0],z=n[c+1]-m[1],x=n[c+2]-m[2],e>p+S)for(y=S,C=0,b=0;S>C;)f=3*(p+v+y+b),Y[f]+=H*O,Y[f+1]+=H*z,Y[f+2]+=H*x,y++,y>=R&&(y=S,C++,b+=e);if(r>_+S&&p>S)for(y=-S,C=S,b=0;R>C;)f=3*(p+v+y+b),Y[f]+=q*O,Y[f+1]+=q*z,Y[f+2]+=q*x,y++,y>=0&&(y=-S,C++,b+=e);if(r>_+S)for(y=0,C=S,b=0;R>C;)f=3*(p+v+y+b),Y[f]+=E*O,Y[f+1]+=E*z,Y[f+2]+=E*x,y++,y>=S&&(y=0,C++,b+=e);if(r>_+S&&e>p+S)for(y=S,C=S,b=0;R>C;)f=3*(p+v+y+b),Y[f]+=G*O,Y[f+1]+=G*z,Y[f+2]+=G*x,y++,y>=R&&(y=S,C++,b+=e);for(y=0,C=0,b=0;S>C;)c=p+v+y+b<<2,n[c]=m[0],n[c+1]=m[1],n[c+2]=m[2],y++,y>=S&&(y=0,C++,b+=e);p+=S,p>=e&&(p=0,_+=S,v+=U)}return n}})}(e),!function(e){"use strict";var r=(Math.sqrt,Math.exp,Math.log),t=Math.abs,a=Math.floor,i=e._notSupportClamp,s=e.Array32F;e.Create({name:"BokehFilter",centerX:0,centerY:0,radius:10,amount:10,init:function(n,e,r,t){var a=this;a.centerX=n||0,a.centerY=e||0,a.radius=r||10,a.amount=t||10},path:e.getPath(n.moduleUri),serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{centerX:n.centerX,centerY:n.centerY,radius:n.radius,amount:n.amount}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.centerX=e.centerX,r.centerY=e.centerY,r.radius=e.radius,r.amount=e.amount),r},apply:function(n,e,o){var l=this;if(!l._isOn)return n;var u,h,c,f,d,m,g,p,_,v,y,C,b,M,w,I,O,z,x,P,k,F,Y,S,N,A,L,R,X,U,H,q,E,G=n.length,B=l.centerX||0,T=l.centerY||0,W=l.radius,j=l.amount;if(0>=j)return n;for(u=G>>2,U=0,H=e-1,q=0,E=u-e,B=a(B*(e-1)),T=a(T*(o-1)),c=(u<<1)+u,g=(e<<1)+e,h=new s(c),p=0,_=0,v=0,f=d=m=0,v=0;e>v;v++,p+=4,_+=3)f+=n[p],d+=n[p+1],m+=n[p+2],h[_]=f,h[_+1]=d,h[_+2]=m;for(p=g+e,_=0,v=0,f=d=m=0,p=g+e;G>p;p+=4,_+=3,v++)v>=e&&(v=0,f=d=m=0),f+=n[p],d+=n[p+1],m+=n[p+2],h[_+g]=h[_]+f,h[_+g+1]=h[_+1]+d,h[_+g+2]=h[_+2]+m;for(v=0,y=0,C=0,p=0;G>p;p+=4,v++)v>=e&&(v=0,y++,C+=e),M=v-B,w=y-T,b=t(M)+t(w),I=b>W?~~r((b-W)*j):~~(b/W+.5),I>0&&(O=I*e,z=.25/(I*I),x=v-I,P=C-O,k=v+I,F=C+O,U>x?x=U:k>H&&(k=H),q>P?P=q:F>E&&(F=E),Y=x+P,A=k+F,S=k+P,N=x+F,Y=(Y<<1)+Y,S=(S<<1)+S,N=(N<<1)+N,A=(A<<1)+A,L=z*(h[A]-h[S]-h[N]+h[Y]),R=z*(h[A+1]-h[S+1]-h[N+1]+h[Y+1]),X=z*(h[A+2]-h[S+2]-h[N+2]+h[Y+2]),i&&(L=0>L?0:L>255?255:L,R=0>R?0:R>255?255:R,X=0>X?0:X>255?255:X),n[p]=~~L,n[p+1]=~~R,n[p+2]=~~X);return n}})}(e),!function(e){"use strict";e.Create({name:"SeamlessTileFilter",type:0,init:function(n){var e=this;e.type=n||0},path:e.getPath(n.moduleUri),serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{type:n.type}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.type=e.type),r},apply:function(n,r,t){var a,i,s,o,l,u,h,c,f,d,m,g,p,_,v,y=this,C=y.type;for(r!==t?n=e.Image.resize(n,r,t,g=r>t?r:t,g):g=r,p=Math.round(g/2),_=g*g,v=n.length,a=new e.ImArray(v),i=new e.ImArray(v),s=new e.Array8U(_),c=0,f=0,d=0;v>d;d+=4,c++)c>=g&&(c=0,f++),m=(c+p)%g+(f+p)%g*g<<2,a[m]=n[d],a[m+1]=n[d+1],a[m+2]=n[d+2],a[m+3]=n[d+3];for(c=0;p-1>=c;c++)for(f=0;p-1>=f;f++){switch(C){case 0:h=Math.sqrt((c-p)*(c-p)+(f-p)*(f-p))/p;break;case 1:h=p-f>p-c?(f-p)/p:(c-g/2)/p;break;case 2:default:h=p-f>p-c?Math.sqrt((f-g)*(f-g)+(c-g)*(c-g))/(1.13*g):Math.sqrt((c-g)*(c-g)+(f-g)*(f-g))/(1.13*g)}h=255-255*h,1>h?h=1:h>255&&(h=255),s[c+f*g]=h,s[c+(g-1-f)*g]=h,s[g-1-c+f*g]=h,s[g-1-c+(g-1-f)*g]=h}for(f=0;g-1>=f;f++)for(c=0;g-1>=c;c++)m=c+f*g,o=s[m],l=s[(c+p)%g+(f+p)%g*g],u=o+l,o/=u,l/=u,m<<=2,i[m]=~~(o*n[m]+l*a[m]),i[m+1]=~~(o*n[m+1]+l*a[m+1]),i[m+2]=~~(o*n[m+2]+l*a[m+2]),i[m+3]=n[m+3];return r!==t&&(i=e.Image.resize(i,g,g,r,t)),i}})}(e),!function(e){"use strict";e.Create({name:"FloodFillFilter",x:0,y:0,color:null,tolerance:0,path:e.getPath(n.moduleUri),init:function(n,e,r,t){var a=this;a.x=n||0,a.y=e||0,a.color=r||[0,0,0],a.tolerance=t||0},serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{color:n.color,x:n.x,y:n.y,tolerance:n.tolerance}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.color=e.color,r.x=e.x,r.y=e.y,r.tolerance=e.tolerance),r},apply:function(n,e,r){var t,a,i,s,o,l,u,h,c,f,d=this,m=~~(255*(d.tolerance>=1?.999:d.tolerance)),g=d.color,p=e<<2,_=d.x,v=d.y,y=n.length,C=0,b=y-p,M=0,w=e-1<<2,I=Math.abs;if(u=v*e<<2,_<<=2,M>_||_>w||C>u||u>b||n[_+u]===g[0]&&n[_+u+1]===g[1]&&n[_+u+2]===g[2])return n;for(t=[n[_+u],n[_+u+1],n[_+u+2]],h=[],u+p>=C&&b>=u+p&&h.push([u,_,_,p]),h.push([u+p,_,_,-p]);h.length;){for(c=h.pop(),u=c[0]+(p=c[3]),o=c[1],l=c[2],s=o;s>=M&&(i=s+u,I(t[0]-n[i])<=m&&I(t[1]-n[i+1])<=m&&I(t[2]-n[i+2])<=m);s-=4)n[i]=g[0],n[i+1]=g[1],n[i+2]=g[2];if(s>=o){for(;l>=s&&!(I(t[0]-n[s+u])<=m&&I(t[1]-n[s+u+1])<=m&&I(t[2]-n[s+u+2])<=m);)s+=4;a=s,f=l>=s}else a=s+4,o>a&&u-p>=C&&b>=u-p&&h.push([u,a,o-4,-p]),s=o+4,f=!0;for(;f;){for(i=s+u;w>=s&&I(t[0]-n[i])<=m&&I(t[1]-n[i+1])<=m&&I(t[2]-n[i+2])<=m;)n[i]=g[0],n[i+1]=g[1],n[i+2]=g[2],s+=4,i=s+u;for(u+p>=C&&b>=u+p&&h.push([u,a,s-4,p]),s>l+4&&u-p>=C&&b>=u-p&&h.push([u,l+4,s-4,-p]);l>=s&&!(I(t[0]-n[s+u])<=m&&I(t[1]-n[s+u+1])<=m&&I(t[2]-n[s+u+2])<=m);)s+=4;a=s,f=l>=s}}return n}})}(e),!function(e){"use strict";var r=e._notSupportClamp,t=e.Color.RGB2HSV,a=.7083333333333334;e.Create({name:"HSVConverterFilter",path:e.getPath(n.moduleUri),apply:function(n,e,i){var s=this;if(!s._isOn)return n;var o,l,u,h,c,f=n.length;if(r)for(o=0;f>o;o+=4)l=t(n.subarray(o,o+3)),u=l[0]*a,c=255*l[1],h=l[2],0>u?u=0:u>255&&(u=255),0>h?h=0:h>255&&(h=255),0>c?c=0:c>255&&(c=255),n[o]=~~u,n[o+1]=~~h,n[o+2]=~~c;else for(o=0;f>o;o+=4)l=t(n.subarray(o,o+3)),u=l[0]*a,c=255*l[1],h=l[2],n[o]=~~u,n[o+1]=~~h,n[o+2]=~~c;return n}})}(e),!function(e){"use strict";var r=(e._notSupportClamp,e.Color.RGBA2Color),t=e.Color.Color2RGBA;e.Create({name:"ThresholdFilter",thresholds:null,quantizedColors:null,init:function(n,e){var r=this;r.thresholds=n,r.quantizedColors=e||null},path:e.getPath(n.moduleUri),serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{thresholds:n.thresholds,quantizedColors:n.quantizedColors}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.thresholds=e.thresholds,r.quantizedColors=e.quantizedColors),r},apply:function(n,e,a){var i=this;if(!(i._isOn&&i.thresholds&&i.thresholds.length&&i.quantizedColors&&i.quantizedColors.length))return n;var s,o,l,u,h=n.length,c=i.thresholds,f=c.length,d=i.quantizedColors,m=d.length;for(l=0;h>l;l+=4){for(s=r(n.subarray[l+4]),u=0;f>u&&s>c[u];)u++;s=m>u?d[u]:255,o=t(s),n[l]=o[0],n[l+1]=o[1],n[l+2]=o[2],n[l+3]=o[3]}return n}})}(e),!function(e){"use strict";var r=(e._notSupportClamp,e.ImArray,e.Color.clampPixel),t=e.Color.RGB2HSV,a=(e.Color.HSV2RGB,e.Color.Color2RGBA);e.Create({name:"HueExtractorFilter",range:null,background:0,init:function(n,e){var r=this;r.range=n,r.background=e||0},path:e.getPath(n.moduleUri),serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{range:n.range,background:n.background}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.range=e.range,r.background=e.background),r},apply:function(n,e,i){var s=this;if(!s._isOn||!s.range||!s.range.length)return n;var o,l,u,h,c,f,d,m=n.length,g=s.range[0],p=s.range[s.range.length-1];for(f=a(s.background||0),o=~~r(f[0]),l=~~r(f[1]),u=~~r(f[2]),h=~~r(f[3]),c=0;m>c;c+=4)d=t(n.subarray(c,c+3))[0],(g>d||d>p)&&(n[c]=o,n[c+1]=l,n[c+2]=u,n[c+3]=h);return n}})}(e),!function(e){"use strict";function r(n,e,r,t,a,i){var s,o,h,v,y,C=n.length,b=new u(C),M=new u(C),w=new u(C),I=new u(C),O=new u(i),z=new u(i),x=a*a,P=2*x,k=g*x;for(s=0;i>s&&(o=_(-(s*s)/P),!(c>=o&&s>=2));s++)h=_(-((y=s-.5)*y)/P),v=_(-((y=s+.5)*y)/P),O[s]=(o+h+v)/3/k,z[s]=v-h;var y,F,Y,S,N,A,L,R,X,U=s-1,H=e-(s-1),q=e*(s-1),E=e*(r-(s-1));for(y=U;H>y;y++)for(F=q;E>F;F+=e){for(Y=y+F,S=n[Y]*O[0],N=S,A=1,L=e;s>A;)N+=O[A]*(n[Y-L]+n[Y+L]),S+=O[A]*(n[Y-A]+n[Y+A]),L+=e,A++;M[Y]=N,b[Y]=S}for(y=U;H>y;y++)for(F=q;E>F;F+=e){for(R=0,Y=y+F,X=1;s>X;X++)R+=z[X]*(M[Y-X]-M[Y+X]);w[Y]=R}for(y=s;e-s>y;y++)for(F=q;E>F;F+=e){for(R=0,Y=y+F,L=e,X=1;s>X;X++)R+=z[X]*(b[Y-L]-b[Y+L]),L+=e;I[Y]=R}U=s,H=e-s,q=e*s,E=e*(r-s);var G,B,T,W,j,$,D,V,Q,J,K,Z,nn,en,rn,tn,an,sn,on,ln;for(y=U;H>y;y++)for(F=q;E>F;F+=e)Y=y+F,G=Y-e,B=Y+e,W=Y-1,T=Y+1,j=G-1,$=G+1,D=B-1,V=B+1,Q=w[Y],J=I[Y],K=l(Q,J),nn=l(w[G],I[G]),en=l(w[B],I[B]),tn=l(w[W],I[W]),rn=l(w[T],I[T]),sn=l(w[$],I[$]),ln=l(w[V],I[V]),on=l(w[D],I[D]),an=l(w[j],I[j]),(0>=Q*J?p(Q)>=p(J)?(Z=p(Q*K))>=p(J*sn-(Q+J)*rn)&&Z>p(J*on-(Q+J)*tn):(Z=p(J*K))>=p(Q*sn-(J+Q)*nn)&&Z>p(Q*on-(J+Q)*en):p(Q)>=Math.abs(J)?(Z=p(Q*K))>=p(J*ln+(Q-J)*rn)&&Z>p(J*an+(Q-J)*tn):(Z=p(J*K))>=p(Q*ln+(J-Q)*en)&&Z>p(Q*an+(J-Q)*nn))?t[Y]=K>=d?m:Math.floor(f*K):t[Y]=0}function t(n,e,r,t,i,s){var o,l,u,h=0,c=n.length;for(o=0;c>o;o++)n[o]=0;for(u=0,l=0,h=0;c>h;h++,u++)u>=e&&(u=0,l++),0===n[h]&&t[h]>=s&&a(n,e,r,t,u,l,h,i)}function a(n,e,r,t,i,s,o,l){var u,h,c,f=0==i?i:i-1,d=i==e-1?i:i+1,m=0==s?s:s-1,g=s==r-1?s:s+1;for(n[o]=t[o],u=f,h=m;d>=u&&g>=h;){if(c=u+h*e,(h!=s||u!=i)&&0===n[c]&&t[c]>=l)return void a(n,e,r,t,u,h,c,l);h++,h>g&&(h=m,u++)}}function i(n,r){var t,a,i,s,o,l=n.length,u=e.LUMA[0],h=e.LUMA[1],c=e.LUMA[2];for(t=0,a=0;l>t;t+=4,a++)i=n[t],s=n[t+1],o=n[t+2],r[a]=~~(u*i+h*s+c*o+.5)}function s(n){var e,r,t,a,i,s=new h(256),o=new h(256),l=n.length;for(e=0;l>e;e++)s[n[e]]++;for(r=0,t=0,e=0;256>e;e++){for(r+=s[e],i=255*r/l,a=t+1;i>=a;a++)o[a]=e;t=i}for(e=0;l>e;e++)n[e]=o[n[e]]}function o(n,e){var r,t,a,i=n.length;for(r=0,t=0;i>r;r+=4,t++)a=e[t]>0?255:0,n[r]=n[r+1]=n[r+2]=a}var l,u=e.Array32F,h=e.Array32I,c=.005,f=100,d=1e3,m=f*d,g=e.CONST.PI2,p=Math.abs,_=Math.exp;l=Math.hypot?Math.hypot:function(n,e){return p(n)+p(e)},e.Create({name:"CannyEdgesFilter",low:2.5,high:7.5,gaussRadius:2,gaussWidth:16,contrastNormalized:!1,path:e.getPath(n.moduleUri),init:function(n,e,r,t,a){var i=this;i.low=arguments.length<1?2.5:n,i.high=arguments.length<2?7.5:e,i.gaussRadius=arguments.length<3?2:r,i.gaussWidth=arguments.length<4?16:t,i.contrastNormalized=!!a},thresholds:function(n,e){var r=this;return r.low=n,r.high=e,r},kernel:function(n,e){var r=this;return r.gaussRadius=n,r.gaussWidth=e,r},serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{low:n.low,high:n.high,gaussRadius:n.gaussRadius,gaussWidth:n.gaussWidth,contrastNormalized:n.contrastNormalized}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.low=e.low,r.high=e.high,r.gaussRadius=e.gaussRadius,r.gaussWidth=e.gaussWidth,r.contrastNormalized=e.contrastNormalized),r},apply:function(n,e,a){var l,u,c,d,m=this,g=n.length>>2;return c=new h(g),d=new h(g),l=Math.round(m.low*f),u=Math.round(m.high*f),i(n,c),m.contrastNormalized&&s(c),r(c,e,a,d,m.gaussRadius,m.gaussWidth),t(c,e,a,d,l,u),o(n,c),n}})}(e),!function(e,r){"use strict";function t(n,e,r,t,a,i,s){var o,l,u,h,c,f,d,m=n.length;for(h=0,u=0,o=l=0;e>h;)d=4899*n[u]+9617*n[u+1]+1868*n[u+2]+8192>>>14,d&=255,o+=d,l+=d*d,t[h]=d,a[h]=o,i[h]=l,s[h]=d,h++,u+=4;for(c=0,f=1,h=e,u=e<<2,o=l=0;m>u;)d=4899*n[u]+9617*n[u+1]+1868*n[u+2]+8192>>>14,d&=255,o+=d,l+=d*d,t[h]=d,a[h]=a[h-e]+o,i[h]=i[h-e]+l,s[h]=s[h+1-e]+(d+t[h-e])+(f>1?s[h-e-e]:0)+(c>0?s[h-1-e]:0),c++,h++,u+=4,c>=e&&(c=0,f++,o=l=0)}function a(n,e,r,t){var a,i,s,o,l,u,h,c,m,g,p,_=n.length,v=new f(_);for(a=0;e>a;a++)v[a]=0,v[a+e]=0,v[a+_-e]=0,v[a+_-e-e]=0,t[a]=0,t[a+_-e]=0;for(i=0,s=0;r>i;i++,s+=e)v[0+s]=0,v[1+s]=0,v[e-1+s]=0,v[e-2+s]=0,t[0+s]=0,t[e-1+s]=0;for(a=2;e-2>a;a++)for(o=0,i=2,s=e<<1;r-2>i;i++,s+=e)h=a+s,c=h+e,m=c+e,g=h-e,p=g-e,o=0+(n[p-2]<<1)+(n[g-2]<<2)+(n[h-2]<<2)+n[h-2]+(n[c-2]<<2)+(n[m-2]<<1)+(n[p-1]<<2)+(n[g-1]<<3)+n[g-1]+(n[h-1]<<4)-(n[h-1]<<2)+(n[c-1]<<3)+n[c-1]+(n[m-1]<<2)+(n[p]<<2)+n[p]+(n[g]<<4)-(n[g]<<2)+(n[h]<<4)-n[h]+(n[c]<<4)-(n[c]<<2)+(n[m]<<2)+n[m]+(n[p+1]<<2)+(n[g+1]<<3)+n[g+1]+(n[h+1]<<4)-(n[h+1]<<2)+(n[c+1]<<3)+n[c+1]+(n[m+1]<<2)+(n[p+2]<<1)+(n[g+2]<<2)+(n[h+2]<<2)+n[h+2]+(n[c+2]<<2)+(n[m+2]<<1),v[h]=((103*o+8192&4294967295)>>>14&255)>>>0;for(a=1;e-1>a;a++)for(i=1,s=e;r-1>i;i++,s+=e)h=s+a,c=h+e,g=h-e,l=0-v[g-1]+v[g+1]-v[h-1]-v[h-1]+v[h+1]+v[h+1]-v[c-1]+v[c+1],u=0+v[g-1]+v[g]+v[g]+v[g+1]-v[c-1]-v[c]-v[c]-v[c+1],t[h]=d(l)+d(u);for(a=0,o=0;e>a;)o+=t[a],t[a]=o,a++;for(a=e,s=0,o=0;_>a;)o+=t[a],t[a]=t[a-e]+o,a++,s++,s>=e&&(s=0,o=0);return t}function i(n,e){var r=.2*m(e.width,n.width),t=.2*m(e.height,n.height);return!!(d(n.x-e.x)<=r&&d(n.y-e.y)<=t&&d(n.width-e.width)<=r&&d(n.height-e.height)<=t)}function s(n,e){n.x+=e.x,n.y+=e.y,n.width+=e.width,n.height+=e.height}function o(n,e){return!!(n.x>=e.x&&n.y>=e.y&&n.x+n.width<=e.x+e.width&&n.y+n.height<=e.y+e.height)}function l(n){n.x=~~(n.x+.5),n.y=~~(n.y+.5),n.width=~~(n.width+.5),n.height=~~(n.height+.5)}function u(n,e){return e.area-n.area}function h(n,e){var r,t,a,h,c,f,d,m=n.length,g=new Array(m),p=[],_=0,v=!1;for(a=0;m>a;a++)g[a]=0;for(a=0;m>a;a++){for(v=!1,h=0;a>h;h++)i(n[h],n[a])&&(v=!0,g[a]=g[h]);v||(g[a]=_,_++)}for(r=new Array(_),t=new Array(_),a=0;_>a;a++)r[a]=0,t[a]={x:0,y:0,width:0,height:0};for(a=0;m>a;a++)d=g[a],r[d]++,s(t[d],n[a]);for(a=0;_>a;a++)c=r[a],c>=e&&(f=1/(c+c),d={x:f*(2*t[a].x+c),y:f*(2*t[a].y+c),width:f*(2*t[a].width+c),height:f*(2*t[a].height+c)},p.push(d));for(m=p.length,a=0;m>a;a++)for(h=a+1;m>h;h++)!p[a].inside&&o(p[a],p[h])?p[a].inside=!0:!p[h].inside&&o(p[h],p[a])&&(p[h].inside=!0);for(a=m;--a>=0;)p[a].inside?p.splice(a,1):(l(p[a]),p[a].area=p[a].width*p[a].height);return p.sort(u)}var c=e.Array32F,f=e.Array8U,d=Math.abs,m=Math.max,g=Math.min,p=(Math.floor,Math.round,Math.sqrt),_="hasOwnProperty";e.Create({name:"HaarDetectorFilter",_update:!1,hasMeta:!0,haardata:null,objects:null,baseScale:1,scaleIncrement:1.25,stepIncrement:.5,minNeighbors:1,doCannyPruning:!0,cannyLow:20,cannyHigh:100,init:function(n,e,t,a,i,s){var o=this;o.objects=null,o.haardata=n||null,o.baseScale=r===e?1:e,o.scaleIncrement=r===t?1.25:t,o.stepIncrement=r===a?.5:a,o.minNeighbors=r===i?1:i,o.doCannyPruning=r===s?!0:!!s},path:e.getPath(n.moduleUri),dispose:function(){var n=this;return n.objects=null,n.haardata=null,n.$super("dispose"),n},haar:function(n){var e=this;return e.haardata=n,e},params:function(n){var e=this;return n&&(n[_]("haardata")&&(e.haardata=n.haardata),n[_]("baseScale")&&(e.baseScale=n.baseScale),n[_]("scaleIncrement")&&(e.scaleIncrement=n.scaleIncrement),n[_]("stepIncrement")&&(e.stepIncrement=n.stepIncrement),n[_]("minNeighbors")&&(e.minNeighbors=n.minNeighbors),n[_]("doCannyPruning")&&(e.doCannyPruning=n.doCannyPruning),n[_]("cannyLow")&&(e.cannyLow=n.cannyLow),n[_]("cannyHigh")&&(e.cannyHigh=n.cannyHigh)),e},serialize:function(){var n=this,e={filter:n.name,_isOn:!!n._isOn,params:{haardata:n.haardata,baseScale:n.baseScale,scaleIncrement:n.scaleIncrement,stepIncrement:n.stepIncrement,minNeighbors:n.minNeighbors,doCannyPruning:n.doCannyPruning,cannyLow:n.cannyLow,cannyHigh:n.cannyHigh}};return e},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.haardata=e.haardata,r.baseScale=e.baseScale,r.scaleIncrement=e.scaleIncrement,r.stepIncrement=e.stepIncrement,r.minNeighbors=e.minNeighbors,r.doCannyPruning=e.doCannyPruning,r.cannyLow=e.cannyLow,r.cannyHigh=e.cannyHigh),r},getMeta:function(){return this.objects},setMeta:function(n){return this.objects=n,this},apply:function(n,e,r){var i,s,o,l,u,d,m,_,v,y,C,b,M,w,I,O,z,x,P,k,F,Y,S,N,A,L,R,X,U,H,q,E,G,B,T,W,j,$,D,N,V,Q,J,K,Z,nn,en,rn,tn,an,sn,on,ln,un,hn,cn,fn,dn,mn,gn=this,pn=n.length>>>2,_n=gn.haardata,vn=_n.stages,yn=gn.baseScale,Cn=gn.scaleIncrement,bn=gn.stepIncrement,Mn=gn.minNeighbors,wn=gn.doCannyPruning,In=gn.cannyLow,On=gn.cannyHigh,zn=_n.size1,xn=_n.size2,Pn=g(e/zn,r/xn),kn=[],Fn=pn-1,Yn=0,Sn=0,Nn=vn.length;for(t(n,e,r,s=new f(pn),o=new c(pn),l=new c(pn),u=new c(pn)),wn&&a(s,e,r,d=new c(pn)),A=0,L=e-1,R=0,X=pn-e,i=yn;Pn>=i;){for(v=~~(i*zn),m=~~(v*bn),y=~~(i*xn),_=~~(y*bn),I=y*e,O=_*e,C=Sn*O,F=e-v,Y=r-y,U=v*y,H=1/U,M=Sn,w=C;Y>M;M+=_,w+=O)for(b=Yn;F>b;b+=m)if(z=b-1+w-e,x=z+v,P=z+I,k=P+v,z=0>z?0:z>Fn?Fn:z,x=0>x?0:x>Fn?Fn:x,P=0>P?0:P>Fn?Fn:P,k=0>k?0:k>Fn?Fn:k,!(wn&&(B=H*(d[k]-d[P]-d[x]+d[z]),In>B||B>On))){for(q=H*(o[k]-o[P]-o[x]+o[z]),E=H*(l[k]-l[P]-l[x]+l[z]),G=E-q*q,G=G>1?p(G):1,T=!0,S=0;Nn>S;S++){for(W=vn[S],j=W.thres,$=W.trees,D=$.length,mn=0,N=0;D>N;N++)for(J=$[N].feats,V=0;;){if(K=J[V],Z=K.rects,nn=Z.length,en=K.thres,rn=0,K.tilt)for(tn=0;nn>tn;tn++)an=Z[tn],sn=b+~~(i*an[0]),on=(M-1+~~(i*an[1]))*e,ln=b+~~(i*(an[0]+an[2])),un=(M-1+~~(i*(an[1]+an[2])))*e,hn=b+~~(i*(an[0]-an[3])),cn=(M-1+~~(i*(an[1]+an[3])))*e,fn=b+~~(i*(an[0]+an[2]-an[3])),dn=(M-1+~~(i*(an[1]+an[2]+an[3])))*e,sn=A>sn?A:sn>L?L:sn,ln=A>ln?A:ln>L?L:ln,hn=A>hn?A:hn>L?L:hn,fn=A>fn?A:fn>L?L:fn,on=R>on?R:on>X?X:on,un=R>un?R:un>X?X:un,cn=R>cn?R:cn>X?X:cn,dn=R>dn?R:dn>X?X:dn,rn+=an[4]*(u[fn+dn]-u[hn+cn]-u[ln+un]+u[sn+on]);else for(tn=0;nn>tn;tn++)an=Z[tn],sn=b-1+~~(i*an[0]),ln=b-1+~~(i*(an[0]+an[2])),on=e*(M-1+~~(i*an[1])),un=e*(M-1+~~(i*(an[1]+an[3]))),sn=A>sn?A:sn>L?L:sn,ln=A>ln?A:ln>L?L:ln,on=R>on?R:on>X?X:on,un=R>un?R:un>X?X:un,rn+=an[4]*(o[ln+un]-o[sn+un]-o[ln+on]+o[sn+on]);if(Q=en*G>rn*H?0:1){if(K.has_r){mn+=K.r_val;break}V=K.r_node}else{if(K.has_l){mn+=K.l_val;break}V=K.l_node}}if(T=mn>j,!T)break}T&&kn.push({x:b,y:M,width:v,height:y})}i*=Cn}return gn.objects=h(kn,Mn),n}})}(e),!function(e){"use strict";var r=(e._notSupportClamp,Math.min),t=Math.floor,a=e.CHANNEL.RED;e.CHANNEL.GREEN,e.CHANNEL.BLUE,e.CHANNEL.ALPHA;e.Create({name:"ChannelCopyFilter",_srcImg:null,srcImg:null,centerX:0,centerY:0,srcChannel:0,dstChannel:0,path:e.getPath(n.moduleUri),init:function(n,e,r,t,i){var s=this;s._srcImg=null,s.srcImg=null,s.srcChannel=e||a,s.dstChannel=r||a,s.centerX=t||0,s.centerY=i||0,n&&s.setSrc(n)},dispose:function(){var n=this;return n.srcImg=null,n._srcImg=null,n.$super("dispose"),n},setSrc:function(n){var e=this;return n?(e.srcImg=n,e._srcImg={data:n.getData(),width:n.width,height:n.height}):(e.srcImg=null,e._srcImg=null),e},serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{_srcImg:n._srcImg,centerX:n.centerX,centerY:n.centerY,srcChannel:n.srcChannel,dstChannel:n.dstChannel}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r._srcImg=e._srcImg,r.centerX=e.centerX,r.centerY=e.centerY,r.srcChannel=e.srcChannel,r.dstChannel=e.dstChannel),r},apply:function(n,e,a){var i=this;if(!i._isOn||!i._srcImg)return n;var s,o,l,u,h,c,f=i._srcImg.data,d=n.length,m=(f.length,i._srcImg.width),g=i._srcImg.height,p=i.srcChannel,_=i.dstChannel,v=r(e,m),y=r(a,g),C=i.centerX||0,b=i.centerY||0,M=m>>1,w=g>>1;for(C=t(C*(e-1))-M,b=t(b*(a-1))-w,s=0,o=0,l=0,s=0;d>s;s+=4,o++)o>=e&&(o=0,l++),h=o-C,c=l-b,h>=0&&v>h&&c>=0&&y>c&&(u=h+c*m<<2,n[s+_]=f[u+p]);return n}})}(e),!function(e){"use strict";var r=(e._notSupportClamp,Math.min),t=Math.floor;e.Create({name:"AlphaMaskFilter",_alphaMask:null,alphaMask:null,centerX:0,centerY:0,path:e.getPath(n.moduleUri),init:function(n,e,r){var t=this;t.centerX=e||0,t.centerY=r||0,t._alphaMask=null,t.alphaMask=null,n&&t.setMask(n)},dispose:function(){var n=this;return n.alphaMask=null,n._alphaMask=null,n.$super("dispose"),n},setMask:function(n){var e=this;return n?(e.alphaMask=n,e._alphaMask={data:n.getData(),width:n.width,height:n.height}):(e.alphaMask=null,e._alphaMask=null),e},serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{_alphaMask:n._alphaMask,centerX:n.centerX,centerY:n.centerY}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r._alphaMask=e._alphaMask,r.centerX=e.centerX,r.centerY=e.centerY),r},apply:function(n,e,a){var i=this;if(!i._isOn||!i._alphaMask)return n;var s,o,l,u,h,c,f=i._alphaMask.data,d=i._alphaMask.width,m=i._alphaMask.height,g=n.length,p=(f.length,r(e,d)),_=r(a,m),v=i.centerX||0,y=i.centerY||0,C=d>>1,b=m>>1;for(v=t(v*(e-1))-C,y=t(y*(a-1))-b,o=0,l=0,s=0;g>s;s+=4,o++)o>=e&&(o=0,l++),h=o-v,c=l-y,h>=0&&p>h&&c>=0&&_>c?(u=h+c*d<<2,n[s+3]=f[u+3]):n[s+3]=0;return n}})}(e),!function(e,r){"use strict";var t,a="hasOwnProperty",i=Math.min,s=Math.max,o=Math.round,l=(Math.floor,Math.abs),u=e._notSupportClamp;t={normal:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=d,i=m,s=g,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},lighten:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=h>d?h:d,i=c>m?c:m,s=f>g?f:g,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},darken:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=h>d?d:h,i=c>m?m:c,s=f>g?g:f,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},multiply:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=h*d*.003921568627451,i=c*m*.003921568627451,s=f*g*.003921568627451,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},average:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=.5*(h+d),i=.5*(c+m),s=.5*(f+g),h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},add:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=h+d,i=c+m,s=f+g,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},subtract:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=255>h+d?0:h+d-255,i=255>c+m?0:c+m-255,s=255>f+g?0:f+g-255,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),
n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},difference:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],h=1-o,c=n[e],f=n[e+1],d=n[e+2],m=r[t],g=r[t+1],p=r[t+2];a=l(m-c),i=l(g-f),s=l(p-d),c=a*o+c*h,f=i*o+f*h,d=s*o+d*h,u&&(c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f,d=0>d?0:d>255?255:d),n[e]=~~c,n[e+1]=~~f,n[e+2]=~~d},negation:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],h=1-o,c=n[e],f=n[e+1],d=n[e+2],m=r[t],g=r[t+1],p=r[t+2];a=255-l(255-m-c),i=255-l(255-g-f),s=255-l(255-p-d),c=a*o+c*h,f=i*o+f*h,d=s*o+d*h,u&&(c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f,d=0>d?0:d>255?255:d),n[e]=~~c,n[e+1]=~~f,n[e+2]=~~d},screen:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=255-((255-d)*(255-h)>>8),i=255-((255-m)*(255-c)>>8),s=255-((255-g)*(255-f)>>8),h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},exclusion:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=d+h-2*d*h*.003921568627451,i=m+c-2*m*c*.003921568627451,s=g+f-2*g*f*.003921568627451,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},overlay:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=128>h?2*d*h*.003921568627451:255-2*(255-d)*(255-h)*.003921568627451,i=128>c?2*m*c*.003921568627451:255-2*(255-m)*(255-c)*.003921568627451,a=128>f?2*g*f*.003921568627451:255-2*(255-g)*(255-f)*.003921568627451,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},softlight:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=128>h?2*((d>>1)+64)*(.003921568627451*h):255-2*(255-((d>>1)+64))*(255-h)*.003921568627451,i=128>c?2*((m>>1)+64)*(.003921568627451*c):255-2*(255-((m>>1)+64))*(255-c)*.003921568627451,s=128>f?2*((g>>1)+64)*(.003921568627451*f):255-2*(255-((g>>1)+64))*(255-f)*.003921568627451,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},hardlight:function(n,e,r,t){var a,i,s,o=.003921568627451*r[t+3],l=1-o,h=n[e],c=n[e+1],f=n[e+2],d=r[t],m=r[t+1],g=r[t+2];a=128>d?2*h*d*.003921568627451:255-2*(255-h)*(255-d)*.003921568627451,i=128>m?2*c*m*.003921568627451:255-2*(255-c)*(255-m)*.003921568627451,s=128>g?2*f*g*.003921568627451:255-2*(255-f)*(255-g)*.003921568627451,h=a*o+h*l,c=i*o+c*l,f=s*o+f*l,u&&(h=0>h?0:h>255?255:h,c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f),n[e]=~~h,n[e+1]=~~c,n[e+2]=~~f},colordodge:function(n,e,r,t){var a,s,o,l=.003921568627451*r[t+3],h=1-l,c=n[e],f=n[e+1],d=n[e+2],m=r[t],g=r[t+1],p=r[t+2];a=255==c?c:i(255,(m<<8)/(255-c)),s=255==f?f:i(255,(g<<8)/(255-f)),o=255==d?c:i(255,(p<<8)/(255-d)),c=a*l+c*h,f=s*l+f*h,d=o*l+d*h,u&&(c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f,d=0>d?0:d>255?255:d),n[e]=~~c,n[e+1]=~~f,n[e+2]=~~d},colorburn:function(n,e,r,t){var a,i,o,l=.003921568627451*r[t+3],h=1-l,c=n[e],f=n[e+1],d=n[e+2],m=r[t],g=r[t+1],p=r[t+2];a=0==c?c:s(0,255-(255-m<<8)/c),i=0==f?f:s(0,255-(255-g<<8)/f),o=0==d?d:s(0,255-(255-p<<8)/d),c=a*l+c*h,f=i*l+f*h,d=o*l+d*h,u&&(c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f,d=0>d?0:d>255?255:d),n[e]=~~c,n[e+1]=~~f,n[e+2]=~~d},linearlight:function(n,e,r,t){var a,i,s,o,l=.003921568627451*r[t+3],h=1-l,c=n[e],f=n[e+1],d=n[e+2],m=r[t],g=r[t+1],p=r[t+2];128>c?(o=2*c,a=255>o+m?0:o+m-255):(o=2*(c-128),a=o+m),128>f?(o=2*f,i=255>o+g?0:o+g-255):(o=2*(f-128),i=o+g),128>d?(o=2*d,s=255>o+p?0:o+p-255):(o=2*(d-128),s=o+p),c=a*l+c*h,f=i*l+f*h,d=s*l+d*h,u&&(c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f,d=0>d?0:d>255?255:d),n[e]=~~c,n[e+1]=~~f,n[e+2]=~~d},reflect:function(n,e,r,t){var a,s,o,l=.003921568627451*r[t+3],h=1-l,c=n[e],f=n[e+1],d=n[e+2],m=r[t],g=r[t+1],p=r[t+2];a=255==c?c:i(255,m*m/(255-c)),s=255==f?f:i(255,g*g/(255-f)),o=255==d?d:i(255,p*p/(255-d)),c=a*l+c*h,f=s*l+f*h,d=o*l+d*h,u&&(c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f,d=0>d?0:d>255?255:d),n[e]=~~c,n[e+1]=~~f,n[e+2]=~~d},glow:function(n,e,r,t){var a,s,o,l=.003921568627451*r[t+3],h=1-l,c=n[e],f=n[e+1],d=n[e+2],m=r[t],g=r[t+1],p=r[t+2];a=255==m?m:i(255,c*c/(255-m)),s=255==g?g:i(255,f*f/(255-g)),o=255==p?p:i(255,d*d/(255-p)),c=a*l+c*h,f=s*l+f*h,d=o*l+d*h,u&&(c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f,d=0>d?0:d>255?255:d),n[e]=~~c,n[e+1]=~~f,n[e+2]=~~d},phoenix:function(n,e,r,t){var a,o,l,h=.003921568627451*r[t+3],c=1-h,f=n[e],d=n[e+1],m=n[e+2],g=r[t],p=r[t+1],_=r[t+2];a=i(g,f)-s(g,f)+255,o=i(p,d)-s(p,d)+255,l=i(_,m)-s(_,m)+255,f=a*h+f*c,d=o*h+d*c,m=l*h+m*c,u&&(f=0>f?0:f>255?255:f,d=0>d?0:d>255?255:d,m=0>m?0:m>255?255:m),n[e]=~~f,n[e+1]=~~d,n[e+2]=~~m},vividlight:function(n,e,r,t){var a,o,l,h,c=.003921568627451*r[t+3],f=1-c,d=n[e],m=n[e+1],g=n[e+2],p=r[t],_=r[t+1],v=r[t+2];128>d?(h=2*d,a=0==h?h:s(0,255-(255-p<<8)/h)):(h=2*(d-128),a=255==h?h:i(255,(p<<8)/(255-h))),128>m?(h=2*m,o=0==h?h:s(0,255-(255-_<<8)/h)):(h=2*(m-128),o=255==h?h:i(255,(_<<8)/(255-h))),128>g?(h=2*g,l=0==h?h:s(0,255-(255-v<<8)/h)):(h=2*(m-128),l=255==h?h:i(255,(v<<8)/(255-h))),d=a*c+d*f,m=o*c+m*f,g=l*c+g*f,u&&(d=0>d?0:d>255?255:d,m=0>m?0:m>255?255:m,g=0>g?0:g>255?255:g),n[e]=~~d,n[e+1]=~~m,n[e+2]=~~g},pinlight:function(n,e,r,t){var a,i,s,o,l=.003921568627451*r[t+3],h=1-l,c=n[e],f=n[e+1],d=n[e+2],m=r[t],g=r[t+1],p=r[t+2];128>c?(o=2*c,a=o>m?o:m):(o=2*(c-128),a=o>m?m:o),128>f?(o=2*f,i=o>g?o:g):(o=2*(c-128),i=o>g?g:o),128>d?(o=2*d,s=o>p?o:p):(o=2*(d-128),s=o>p?p:o),c=a*l+c*h,f=i*l+f*h,d=s*l+d*h,u&&(c=0>c?0:c>255?255:c,f=0>f?0:f>255?255:f,d=0>d?0:d>255?255:d),n[e]=~~c,n[e+1]=~~f,n[e+2]=~~d},hardmix:function(n,e,r,t){var a,o,l,h,c=.003921568627451*r[t+3],f=1-c,d=n[e],m=n[e+1],g=n[e+2],p=r[t],_=r[t+1],v=r[t+2];128>d?(h=2*d,a=0==h?h:s(0,255-(255-p<<8)/h)):(h=2*(d-128),a=255==h?h:i(255,(p<<8)/(255-h))),a=128>a?0:255,128>m?(h=2*m,o=0==h?h:s(0,255-(255-_<<8)/h)):(h=2*(m-128),o=255==h?h:i(255,(_<<8)/(255-h))),o=128>o?0:255,128>g?(h=2*g,l=0==h?h:s(0,255-(255-v<<8)/h)):(h=2*(g-128),l=255==h?h:i(255,(v<<8)/(255-h))),l=128>l?0:255,d=a*c+d*f,m=o*c+m*f,g=l*c+g*f,u&&(d=0>d?0:d>255?255:d,m=0>m?0:m>255?255:m,g=0>g?0:g>255?255:g),n[e]=~~d,n[e+1]=~~m,n[e+2]=~~g}},t.lineardodge=t.add,t.linearburn=t.subtract,e.Create({name:"BlendFilter",_blendMode:null,_blendImage:null,blendImage:null,startX:0,startY:0,path:e.getPath(n.moduleUri),init:function(n,e){var r=this;r.startX=0,r.startY=0,r._blendImage=null,r.blendImage=null,r._blendMode=null,n&&r.setImage(n),e&&r.setMode(e)},dispose:function(){var n=this;return n.blendImage=null,n._blendImage=null,n._blendMode=null,n.$super("dispose"),n},setImage:function(n){var e=this;return n?(e.blendImage=n,e._blendImage={data:n.getData(),width:n.width,height:n.height}):(e.blendImage=null,e._blendImage=null),e},setMode:function(n){var e=this;return n?(e._blendMode=(""+n).toLowerCase(),t[a](e._blendMode)||(e._blendMode=null)):e._blendMode=null,e},serialize:function(){var n=this;return{filter:n.name,_isOn:!!n._isOn,params:{_blendImage:n._blendImage,_blendMode:n._blendMode,startX:n.startX,startY:n.startY}}},unserialize:function(n){var e,r=this;return n&&r.name===n.filter&&(r._isOn=!!n._isOn,e=n.params,r.startX=e.startX,r.startY=e.startY,r._blendImage=e._blendImage,r.setMode(e._blendMode)),r},reset:function(){var n=this;return n.startX=0,n.startY=0,n._blendMode=null,n},apply:function(n,e,r){var a=this;if(!a._isOn||!a._blendMode||!a._blendImage)return n;var s,l,u,h,c,f,d,m,g,p,_,v,y,C,b=a.startX||0,M=a.startY||0,w=0,I=0,O=a._blendImage,z=t[a._blendMode];if(0>b&&(w=-b,b=0),0>M&&(I=-M,M=0),h=O.width,c=O.height,b>=e||M>=r)return n;if(w>=h||I>=c)return n;if(b=o(b),M=o(M),w=o(w),I=o(I),s=i(e-b,h-w),l=i(r-M,c-I),0>=s||0>=l)return n;for(u=O.data,p=b,_=M*e,v=w,y=I*h,f=b+s,d=w+s,m=0,g=l*s;g>m;)C=v+y<<2,u[C+3]&&z(n,p+_<<2,u,C),m++,p++,p>=f&&(p=b,_+=e),v++,v>=d&&(v=w,y+=h);return n}})}(e),e});