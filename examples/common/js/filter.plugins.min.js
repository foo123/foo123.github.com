/**
*
*   FILTER.js Plugins
*   @version: 0.7-alpha2
*   @dependencies: Filter.js
*
*   JavaScript Image Processing Library (Plugins)
*   https://github.com/foo123/FILTER.js
*
**/!function(r,e,n,t){"use strict";function a(r,e,n,t,a){var i;return r?{file:__filename,path:__dirname}:e?{file:i=self.location.href,path:i.split("/").slice(0,-1).join("/")}:n&&a&&a.uri?{file:i=a.uri,path:i.split("/").slice(0,-1).join("/")}:t&&(i=document.getElementsByTagName("script"))&&i.length?{file:i=i[i.length-1].src,path:i.split("/").slice(0,-1).join("/")}:{file:null,path:null}}function i(r,e,n,t,a){var i,o=r.length,l=new Array(o);for(i=0;o>i;i++)l[i]=1===t?n[r[i]]||a(e[i]):2===t?a(r[i]):n[r[i]];return l}function o(r,e,n,t,a,i){var o,l,s,u,c,f,h,p=n.length;if(i){for(o=0;p>o;o++)n[o]in r||importScripts(e+t[o]);return a()}f=document.getElementsByTagName("head")[0],h=document.createElement("a"),l=/^\./,s=0,o=0,u=function(r,n){var t=0,a=document.createElement("script");a.type="text/javascript",a.language="javascript",a.onload=a.onreadystatechange=function(){t||a.readyState&&"loaded"!=a.readyState&&"complete"!=a.readyState||(t=1,a.onload=a.onreadystatechange=null,n(),f.removeChild(a),a=null)},l.test(r)&&(h.href=e+r,r=h.protocol+"//"+h.host+h.pathname+h.search+h.hash),a.src=r,f.appendChild(a)},c=function(){n[o]in r?++o>=p?a():n[o]in r?c():u(t[o],c):++s<30?setTimeout(c,30):(s=0,o++,c())};for(;p>o&&n[o]in r;)o++;p>o?u(t[o],c):a()}n=n||[[],[]];var l,s,u,c="undefined"!=typeof global&&"[object global]"==={}.toString.call(global),f=!c&&"undefined"!=typeof navigator,h=!c&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,p="function"==typeof define&&define.amd,m=c&&"object"==typeof module&&module.exports,d=h?self:r,g=a(c,h,p,f),v=[].concat(n[0]),_=[].concat(n[1]),C=v.length,M=/\.js$/i;if(m)module.$deps=module.$deps||{},module.exports=module.$deps[e]=t.apply(r,[{NODE:module}].concat(i(v,_,module.$deps,1,require)))||1;else if(p&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)){if(!require.defined(e)){for(u={},s=0;C>s;s++)require.specified(v[s])||(u[v[s]]=_[s].replace(M,""));require.config({paths:u}),define(e,["require","exports","module"].concat(v),function(e,n,a){return t.apply(r,[{AMD:a}].concat(i(v,_,arguments,2,e)))})}}else e in d||o(d,g.path+"/",v,_,function(){d[e]=l=t.apply(r,[{}].concat(i(v,_,d)))||1,p&&define(e,["require"],function(){return l})},h)}(this,"FILTER_PLUGINS",[["FILTER"],["./filter.js"]],function(r,e){return r.FILTER_PLUGINS=e,!function(e){"use strict";var n=e._notSupportClamp,t=Math.random;e.Create({name:"NoiseFilter",min:-127,max:127,init:function(r,e){var n=this;n.min=r||-127,n.max=e||127},path:e.getPath(r.AMD),serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{min:r.min,max:r.max}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n.min=e.min,n.max=e.max),n},apply:function(r){var e=this;if(!e._isOn)return r;var a,i,o,l,s,u,c,f,h=e.max-e.min,p=e.min,m=r.length;if(n)for(a=0;m>a;a+=4)o=r[a],l=r[a+1],s=r[a+2],i=h*t()+p,u=o+i,c=l+i,f=s+i,0>u?u=0:u>255&&(u=255),0>c?c=0:c>255&&(c=255),0>f?f=0:f>255&&(f=255),r[a]=~~u,r[a+1]=~~c,r[a+2]=~~f;else for(a=0;m>a;a+=4)o=r[a],l=r[a+1],s=r[a+2],i=h*t()+p,u=o+i,c=l+i,f=s+i,r[a]=~~u,r[a+1]=~~c,r[a+2]=~~f;return r}})}(e),!function(e){"use strict";var n=e._notSupportClamp,t=e.Array32F,a=e.Color.RGB2YCbCr,i=e.Color.YCbCr2RGB;e.Create({name:"HistogramEqualizeFilter",path:e.getPath(r.AMD),apply:function(r){var e=this;if(!e._isOn)return r;var o,l,s,u,c,f,h,p,m,d,g,v=0,_=255,C=0,M=r.length,b=M>>2,y=1/b;for(c=new t(256),m=0;256>m;m+=4)c[m]=0,c[m+1]=0,c[m+2]=0,c[m+3]=0;for(m=0;M>m;m+=4)o=r[m],l=r[m+1],s=r[m+2],d=a({r:o,g:l,b:s}),o=r[m]=~~d.cr,l=r[m+1]=~~d.y,s=r[m+2]=~~d.cb,c[l]+=y,l>v?v=l:_>l&&(_=l);for(C=0,m=0;256>m;m+=4)C+=c[m],c[m]=C,C+=c[m+1],c[m+1]=C,C+=c[m+2],c[m+2]=C,C+=c[m+3],c[m+3]=C;if(u=v-_,n)for(m=0;M>m;m+=4)d={cr:r[m],y:r[m+1],cb:r[m+2]},d.y=c[d.y]*u+_,g=i(d),f=g.r,h=g.g,p=g.b,f=0>f?0:f>255?255:f,h=0>h?0:h>255?255:h,p=0>p?0:p>255?255:p,r[m]=~~f,r[m+1]=~~h,r[m+2]=~~p;else for(m=0;M>m;m+=4)d={cr:r[m],y:r[m+1],cb:r[m+2]},d.y=c[d.y]*u+_,g=i(d),r[m]=~~g.r,r[m+1]=~~g.g,r[m+2]=~~g.b;return r}})}(e),!function(e){"use strict";var n=e._notSupportClamp,t=e.Array32F;e.Create({name:"GrayscaleHistogramEqualizeFilter",path:e.getPath(r.AMD),apply:function(r){var e=this;if(!e._isOn)return r;var a,i,o,l,s,u=0,c=255,f=0,h=r.length,p=h>>2,m=1/p;for(l=new t(256),s=0;256>s;s+=4)l[s]=0,l[s+1]=0,l[s+2]=0,l[s+3]=0;for(s=0;h>s;s+=4)a=r[s],l[a]+=m,a>u?u=a:c>a&&(c=a);for(f=0,s=0;256>s;s+=4)f+=l[s],l[s]=f,f+=l[s+1],l[s+1]=f,f+=l[s+2],l[s+2]=f,f+=l[s+3],l[s+3]=f;if(o=u-c,n)for(s=0;h>s;s+=4)a=r[s],i=l[a]*o+c,i=0>i?0:i>255?255:i,i=~~i,r[s]=i,r[s+1]=i,r[s+2]=i;else for(s=0;h>s;s+=4)a=r[s],i=~~(l[a]*o+c),r[s]=i,r[s+1]=i,r[s+2]=i;return r}})}(e),!function(e){"use strict";var n=e._notSupportClamp,t=e.Array32F;e.Create({name:"RGBHistogramEqualizeFilter",path:e.getPath(r.AMD),apply:function(r){var e=this;if(!e._isOn)return r;var a,i,o,l,s,u,c,f,h,p,m,d,g,v,_,C,M=0,b=0,y=0,O=255,I=255,A=255,z=r.length,Y=z>>2,S=1/Y;for(c=new t(256),f=new t(256),h=new t(256),C=0;256>C;C+=4)c[C]=0,f[C]=0,h[C]=0,c[C+1]=0,f[C+1]=0,h[C+1]=0,c[C+2]=0,f[C+2]=0,h[C+2]=0,c[C+3]=0,f[C+3]=0,h[C+3]=0;for(C=0;z>C;C+=4)a=r[C],i=r[C+1],o=r[C+2],c[a]+=S,f[i]+=S,h[o]+=S,a>M?M=a:O>a&&(O=a),i>b?b=i:I>i&&(I=i),o>y?y=o:A>o&&(A=o);for(p=m=d=0,C=0;256>C;C+=4)p+=c[C],c[C]=p,m+=f[C],f[C]=m,d+=h[C],h[C]=d,p+=c[C+1],c[C+1]=p,m+=f[C+1],f[C+1]=m,d+=h[C+1],h[C+1]=d,p+=c[C+2],c[C+2]=p,m+=f[C+2],f[C+2]=m,d+=h[C+2],h[C+2]=d,p+=c[C+3],c[C+3]=p,m+=f[C+3],f[C+3]=m,d+=h[C+3],h[C+3]=d;if(l=M-O,s=b-I,u=y-A,n)for(C=0;z>C;C+=4)a=r[C],i=r[C+1],o=r[C+2],g=c[a]*l+O,v=f[i]*s+I,_=h[o]*u+A,g=0>g?0:g>255?255:g,v=0>v?0:v>255?255:v,_=0>_?0:_>255?255:_,r[C]=~~g,r[C+1]=~~v,r[C+2]=~~_;else for(C=0;z>C;C+=4)a=r[C],i=r[C+1],o=r[C+2],g=c[a]*l+O,v=f[i]*s+I,_=h[o]*u+A,r[C]=~~g,r[C+1]=~~v,r[C+2]=~~_;return r}})}(e),!function(e){"use strict";var n=Math.sqrt,t=e._notSupportClamp,a=e.Array32F;e.Create({name:"PixelateFilter",scale:1,init:function(r){var e=this;e.scale=r||1},path:e.getPath(r.AMD),serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{scale:r.scale}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n.scale=e.scale),n},apply:function(r,e,i){var o=this;if(!o._isOn||o.scale<=1)return r;o.scale>100&&(o.scale=100);var l,s,u,c,f,h,p,m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E,P,w,D,N,R,B,G,L,H,T,j,$,U,V,Q,W,J,K,Z=r.length,re=Z>>2,ee=(e<<1)+e;for(l=~~(n(re)*o.scale*.01),s=e*l,u=i%l,c=e%l,f=(u-1)*e,d=1/(l*l),g=1/(c*l),v=1/(u*l),_=1/(c*u),C=d,M=g,b=v,y=_,Y=l-1,S=(l-1)*e,L=0,T=e-1,H=0,j=re-e,O=new a(3*re),X=0,k=0,x=0,I=A=z=0,x=0;e>x;x++,X+=4,k+=3)I+=r[X],A+=r[X+1],z+=r[X+2],O[k]=I,O[k+1]=A,O[k+2]=z;for(k=0,x=0,I=A=z=0,X=ee+e;Z>X;X+=4,k+=3,x++)x>=e&&(x=0,I=A=z=0),I+=r[X],A+=r[X+1],z+=r[X+2],O[k+ee]=O[k]+I,O[k+ee+1]=O[k+1]+A,O[k+ee+2]=O[k+2]+z;for(x=0,F=0,q=0,N=x,R=q,B=N+Y,G=R+S,B=B>T?T:B,G=G>j?j:G,$=N+R,Q=B+G,U=B+R,V=N+G,$=($<<1)+$,U=(U<<1)+U,V=(V<<1)+V,Q=(Q<<1)+Q,m=C,W=m*(O[Q]-O[U]-O[V]+O[$]),J=m*(O[Q+1]-O[U+1]-O[V+1]+O[$+1]),K=m*(O[Q+2]-O[U+2]-O[V+2]+O[$+2]),t&&(W=0>W?0:W>255?255:W,J=0>J?0:J>255?255:J,K=0>K?0:K>255?255:K),W=~~W,J=~~J,K=~~K,E=0,P=0,w=0,X=0;Z>X;X+=4)D=E+x+w+q<<2,r[D]=W,r[D+1]=J,r[D+2]=K,E++,(E+x>=e||E>=l)&&(E=0,P++,w+=e),(P+F>=i||P>=l)&&(x+=l,x>=e&&(x=0,F+=l,q+=s),E=0,P=0,w=0,N=x,R=q,B=N+Y,G=R+S,B=B>T?T:B,G=G>j?j:G,$=N+R,Q=B+G,U=B+R,V=N+G,$=($<<1)+$,U=(U<<1)+U,V=(V<<1)+V,Q=(Q<<1)+Q,h=0==B-N-c+1,p=0==G-R-f,m=h&&p?y:h?M:p?b:C,W=m*(O[Q]-O[U]-O[V]+O[$]),J=m*(O[Q+1]-O[U+1]-O[V+1]+O[$+1]),K=m*(O[Q+2]-O[U+2]-O[V+2]+O[$+2]),t&&(W=0>W?0:W>255?255:W,J=0>J?0:J>255?255:J,K=0>K?0:K>255?255:K),W=~~W,J=~~J,K=~~K);return r}})}(e),!function(e){"use strict";var n=Math.sqrt,t=(Math.SQRT2,Math.min,e._notSupportClamp),a=e.Array32F;e.Create({name:"TriangularPixelateFilter",scale:1,init:function(r){var e=this;e.scale=r||1},path:e.getPath(r.AMD),serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{scale:r.scale}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n.scale=e.scale),n},apply:function(r,e,i){var o=this;if(!o._isOn||o.scale<=1)return r;o.scale>100&&(o.scale=100);var l,s,u,c,f,h,p,m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E,P,w,D,N,R,B,G,L,H,T,j,$,U,V,Q,W,J,K,Z,re,ee,ne,te,ae,ie,oe,le=r.length,se=le>>2,ue=(e<<1)+e;for(l=~~(n(se)*o.scale*.01),s=l>>1,u=l-1,c=e*l,f=i%l,h=e%l,p=(f-1)*e,v=1/(l*l),_=1/(h*l),C=1/(f*l),M=1/(h*f),b=2*v,y=2*_,O=2*C,I=2*M,X=u,k=u*e,T=0,$=e-1,j=0,U=se-e,A=new a(3*se),x=0,F=0,q=0,z=Y=S=0,q=0;e>q;q++,x+=4,F+=3)z+=r[x],Y+=r[x+1],S+=r[x+2],A[F]=z,A[F+1]=Y,A[F+2]=S;for(F=0,q=0,z=Y=S=0,x=ue+e;le>x;x+=4,F+=3,q++)q>=e&&(q=0,z=Y=S=0),z+=r[x],Y+=r[x+1],S+=r[x+2],A[F+ue]=A[F]+z,A[F+ue+1]=A[F+1]+Y,A[F+ue+2]=A[F+2]+S;for(q=0,E=0,P=0,B=q,G=P,L=q-s+X,H=P+k,L=L>$?$:L,H=H>U?U:H,V=B+G,J=L+H,Q=L+G,W=B+H,V=(V<<1)+V,Q=(Q<<1)+Q,W=(W<<1)+W,J=(J<<1)+J,g=b,ee=g*(A[J]-A[Q]-A[W]+A[V]),ne=g*(A[J+1]-A[Q+1]-A[W+1]+A[V+1]),te=g*(A[J+2]-A[Q+2]-A[W+2]+A[V+2]),B=q+s,L=q+X,L=L>$?$:L,V=B+G,J=L+H,Q=L+G,W=B+H,V=(V<<1)+V,Q=(Q<<1)+Q,W=(W<<1)+W,J=(J<<1)+J,ae=g*(A[J]-A[Q]-A[W]+A[V]),ie=g*(A[J+1]-A[Q+1]-A[W+1]+A[V+1]),oe=g*(A[J+2]-A[Q+2]-A[W+2]+A[V+2]),t&&(ee=0>ee?0:ee>255?255:ee,ne=0>ne?0:ne>255?255:ne,te=0>te?0:te>255?255:te,ae=0>ae?0:ae>255?255:ae,ie=0>ie?0:ie>255?255:ie,oe=0>oe?0:oe>255?255:oe),ee=~~ee,ne=~~ne,te=~~te,ae=~~ae,ie=~~ie,oe=~~oe,K=ee,Z=ne,re=te,w=0,D=0,N=0,x=0;le>x;x+=4)R=w+q+N+P<<2,r[R]=K,r[R+1]=Z,r[R+2]=re,w++,(w+q>=e||w>=l)&&(w=0,D++,N+=e,K=ee,Z=ne,re=te),w>u-D&&(K=ae,Z=ie,re=oe),(D+E>=i||D>=l)&&(q+=l,q>=e&&(q=0,E+=l,P+=c),w=0,D=0,N=0,B=q,G=P,L=q-s+X,H=P+k,L=L>$?$:L,H=H>U?U:H,V=B+G,J=L+H,Q=L+G,W=B+H,V=(V<<1)+V,Q=(Q<<1)+Q,W=(W<<1)+W,J=(J<<1)+J,m=0==L-B+s-h+1,d=0==H-G-p,g=m&&d?I:m?y:d?O:b,ee=g*(A[J]-A[Q]-A[W]+A[V]),ne=g*(A[J+1]-A[Q+1]-A[W+1]+A[V+1]),te=g*(A[J+2]-A[Q+2]-A[W+2]+A[V+2]),B=q+s,L=q+X,L=L>$?$:L,V=B+G,J=L+H,Q=L+G,W=B+H,V=(V<<1)+V,Q=(Q<<1)+Q,W=(W<<1)+W,J=(J<<1)+J,m=0==L-B+s-h+1,g=m&&d?I:m?y:d?O:b,ae=g*(A[J]-A[Q]-A[W]+A[V]),ie=g*(A[J+1]-A[Q+1]-A[W+1]+A[V+1]),oe=g*(A[J+2]-A[Q+2]-A[W+2]+A[V+2]),t&&(ee=0>ee?0:ee>255?255:ee,ne=0>ne?0:ne>255?255:ne,te=0>te?0:te>255?255:te,ae=0>ae?0:ae>255?255:ae,ie=0>ie?0:ie>255?255:ie,oe=0>oe?0:oe>255?255:oe),ee=~~ee,ne=~~ne,te=~~te,ae=~~ae,ie=~~ie,oe=~~oe,K=ee,Z=ne,re=te);return r}})}(e),!function(e){"use strict";var n=e._notSupportClamp,t=e.Color.RGB2HSV,a=.7083333333333334;e.Create({name:"HSVConverterFilter",path:e.getPath(r.AMD),apply:function(r){var e=this;if(!e._isOn)return r;var i,o,l,s,u,c,f,h,p=r.length;if(n)for(s=0;p>s;s+=4)i=r[s],o=r[s+1],l=r[s+2],u=t({r:i,g:o,b:l}),c=u.h*a,h=255*u.s,f=u.v,0>c?c=0:c>255&&(c=255),0>f?f=0:f>255&&(f=255),0>h?h=0:h>255&&(h=255),r[s]=~~c,r[s+1]=~~f,r[s+2]=~~h;else for(s=0;p>s;s+=4)i=r[s],o=r[s+1],l=r[s+2],u=t({r:i,g:o,b:l}),c=u.h*a,h=255*u.s,f=u.v,r[s]=~~c,r[s+1]=~~f,r[s+2]=~~h;return r}})}(e),!function(e){"use strict";var n=(e._notSupportClamp,e.ImArray,e.Color.clampPixel),t=e.Color.RGB2HSV,a=(e.Color.HSV2RGB,e.Color.Color2RGBA);e.Create({name:"HueExtractorFilter",range:null,background:0,init:function(r,e){var n=this;n.range=r,n.background=e||0},path:e.getPath(r.AMD),serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{range:r.range,background:r.background}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n.range=e.range,n.background=e.background),n},apply:function(r){var e=this;if(!e._isOn||!e.range||!e.range.length)return r;var i,o,l,s,u,c,f,h,p,m,d=r.length,g=e.range[0],v=e.range[e.range.length-1];for(p=a(e.background||0),s=~~n(p.r),u=~~n(p.g),c=~~n(p.b),f=~~n(p.a),h=0;d>h;h+=4)i=r[h],o=r[h+1],l=r[h+2],m=t({r:i,g:o,b:l}).h,(g>m||m>v)&&(r[h]=s,r[h+1]=u,r[h+2]=c,r[h+3]=f);return r}})}(e),!function(e){"use strict";{var n=(e._notSupportClamp,Math.min),t=Math.floor,a=e.CHANNEL.RED;e.CHANNEL.GREEN,e.CHANNEL.BLUE,e.CHANNEL.ALPHA}e.Create({name:"ChannelCopyFilter",_srcImg:null,srcImg:null,centerX:0,centerY:0,srcChannel:0,dstChannel:0,init:function(r,e,n,t,i){var o=this;o._srcImg=null,o.srcImg=null,o.srcChannel=e||a,o.dstChannel=n||a,o.centerX=t||0,o.centerY=i||0,r&&o.setSrc(r)},path:e.getPath(r.AMD),serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{_srcImg:r._srcImg,centerX:r.centerX,centerY:r.centerY,srcChannel:r.srcChannel,dstChannel:r.dstChannel}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n._srcImg=e._srcImg,n.centerX=e.centerX,n.centerY=e.centerY,n.srcChannel=e.srcChannel,n.dstChannel=e.dstChannel),n},setSrc:function(r){var e=this;return r&&(e.srcImg=r,e._srcImg={data:r.getData(),width:r.width,height:r.height}),e},apply:function(r,e,a){var i=this;if(!i._isOn||!i._srcImg)return r;var o,l,s,u,c,f,h=i._srcImg.data,p=r.length,m=(h.length,i._srcImg.width),d=i._srcImg.height,g=i.srcChannel,v=i.dstChannel,_=n(e,m),C=n(a,d),M=i.centerX||0,b=i.centerY||0,y=m>>1,O=d>>1;for(M=t(M*(e-1))-y,b=t(b*(a-1))-O,o=0,l=0,s=0,o=0;p>o;o+=4,l++)l>=e&&(l=0,s++),c=l-M,f=s-b,c>=0&&_>c&&f>=0&&C>f&&(u=c+f*m<<2,r[o+v]=h[u+g]);return r}})}(e),!function(e){"use strict";var n=(e._notSupportClamp,Math.min),t=Math.floor;e.Create({name:"AlphaMaskFilter",_alphaMask:null,alphaMask:null,centerX:0,centerY:0,init:function(r,e,n){var t=this;t.centerX=e||0,t.centerY=n||0,t._alphaMask=null,t.alphaMask=null,r&&t.setMask(r)},path:e.getPath(r.AMD),serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{_alphaMask:r._alphaMask,centerX:r.centerX,centerY:r.centerY}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n._alphaMask=e._alphaMask,n.centerX=e.centerX,n.centerY=e.centerY),n},setMask:function(r){var e=this;return r&&(e.alphaMask=r,e._alphaMask={data:r.getData(),width:r.width,height:r.height}),e},apply:function(r,e,a){var i=this;if(!i._isOn||!i._alphaMask)return r;var o,l,s,u,c,f,h=i._alphaMask.data,p=i._alphaMask.width,m=i._alphaMask.height,d=r.length,g=(h.length,n(e,p)),v=n(a,m),_=i.centerX||0,C=i.centerY||0,M=p>>1,b=m>>1;for(_=t(_*(e-1))-M,C=t(C*(a-1))-b,l=0,s=0,o=0;d>o;o+=4,l++)l>=e&&(l=0,s++),c=l-_,f=s-C,c>=0&&g>c&&f>=0&&v>f?(u=c+f*p<<2,r[o+3]=h[u+3]):r[o+3]=0;return r}})}(e),!function(e,n){"use strict";var t,a=Math.min,i=Math.max,o=Math.round,l=(Math.floor,Math.abs),s=e._notSupportClamp;e.Create({name:"BlendFilter",_blendMode:null,_blendImage:null,blendMode:null,blendImage:null,startX:0,startY:0,amount:1,init:function(r,e,n){var t=this;t.startX=0,t.startY=0,t.amount=1,t._blendImage=null,t.blendImage=null,t._blendMode=null,t.blendMode=null,r&&t.setImage(r),e&&t.setMode(e,n)},path:e.getPath(r.AMD),serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{_blendImage:r._blendImage,_blendMode:r._blendMode,startX:r.startX,startY:r.startY,amount:r.amount}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n._blendImage=e._blendImage,n.startX=e.startX,n.startY=e.startY,n.setMode(e._blendMode,e.amount)),n},setImage:function(r){var e=this;return r&&(e.blendImage=r,e._blendImage={data:r.getData(),width:r.width,height:r.height}),e},setMode:function(r,e){var o=this;return r?(o._blendMode=(""+r).toLowerCase(),o.blendMode=t[o._blendMode]||null,o.amount=i(0,a(1,n===e?1:e))):(o._blendMode=null,o.blendMode=null),o},reset:function(){var r=this;return r.startX=0,r.startY=0,r.amount=1,r._blendMode=null,r.blendMode=null,r},apply:function(r,e,n){var t=this;if(!t._isOn||!t.blendMode||!t._blendImage)return r;var i,l,s,u,c,f=t.startX||0,h=t.startY||0,p=0,m=0,d=t._blendImage,g=t.amount||1;return u=d.width,c=d.height,0>f&&(p=-f,f=0),0>h&&(m=-h,h=0),f>=e||h>=n?r:p>=u||m>=c?r:(f=o(f),h=o(h),p=o(p),m=o(m),i=a(e-f,u-p),l=a(n-h,c-m),0>=i||0>=l?r:(s=d.data,t.blendMode(r,e,n,s,u,c,f,h,p,m,i,l,g)))}}),t={normal:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=Y,x=S,F=X,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},lighten:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=I>Y?I:Y,x=A>S?A:S,F=z>X?z:X,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},darken:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=I>Y?Y:I,x=A>S?S:A,F=z>X?X:z,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},multiply:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=I*Y*.003921568627451,x=A*S*.003921568627451,F=z*X*.003921568627451,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},average:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=.5*(I+Y),x=.5*(A+S),F=.5*(z+X),I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},add:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=I+Y,x=A+S,F=z+X,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},subtract:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=255>I+Y?0:I+Y-255,x=255>A+S?0:A+S-255,F=255>z+X?0:z+X-255,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},difference:function(r,e,n,t,a,i,o,u,c,f,h,p,m){var d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E;for(E=1-m,b=o,y=u*e,O=c,I=f*a,d=o+h,g=c+h,v=0,_=p*h;_>v;)C=b+y<<2,M=O+I<<2,A=r[C],z=r[C+1],Y=r[C+2],S=t[M],X=t[M+1],k=t[M+2],x=l(S-A),F=l(X-z),q=l(k-Y),A=x*m+A*E,z=F*m+z*E,Y=q*m+Y*E,s&&(A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z,Y=0>Y?0:Y>255?255:Y),r[C]=~~A,r[C+1]=~~z,r[C+2]=~~Y,v++,b++,b>=d&&(b=o,y+=e),O++,O>=g&&(O=c,I+=a);return r},negation:function(r,e,n,t,a,i,o,u,c,f,h,p,m){var d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E;for(E=1-m,b=o,y=u*e,O=c,I=f*a,d=o+h,g=c+h,v=0,_=p*h;_>v;)C=b+y<<2,M=O+I<<2,A=r[C],z=r[C+1],Y=r[C+2],S=t[M],X=t[M+1],k=t[M+2],x=255-l(255-S-A),F=255-l(255-X-z),q=255-l(255-k-Y),A=x*m+A*E,z=F*m+z*E,Y=q*m+Y*E,s&&(A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z,Y=0>Y?0:Y>255?255:Y),r[C]=~~A,r[C+1]=~~z,r[C+2]=~~Y,v++,b++,b>=d&&(b=o,y+=e),O++,O>=g&&(O=c,I+=a);return r},screen:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=255-((255-Y)*(255-I)>>8),x=255-((255-S)*(255-A)>>8),F=255-((255-X)*(255-z)>>8),I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},exclusion:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=Y+I-2*Y*I*.003921568627451,x=S+A-2*S*A*.003921568627451,F=X+z-2*X*z*.003921568627451,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},overlay:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=128>I?2*Y*I*.003921568627451:255-2*(255-Y)*(255-I)*.003921568627451,x=128>A?2*S*A*.003921568627451:255-2*(255-S)*(255-A)*.003921568627451,k=128>z?2*X*z*.003921568627451:255-2*(255-X)*(255-z)*.003921568627451,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},softlight:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=128>I?2*((Y>>1)+64)*.003921568627451*I:255-2*(255-((Y>>1)+64))*(255-I)*.003921568627451,x=128>A?2*((S>>1)+64)*.003921568627451*A:255-2*(255-((S>>1)+64))*(255-A)*.003921568627451,F=128>z?2*((X>>1)+64)*.003921568627451*z:255-2*(255-((X>>1)+64))*(255-z)*.003921568627451,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},hardlight:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;for(q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],k=128>Y?2*I*Y*.003921568627451:255-2*(255-I)*(255-Y)*.003921568627451,x=128>S?2*A*S*.003921568627451:255-2*(255-A)*(255-S)*.003921568627451,F=128>X?2*z*X*.003921568627451:255-2*(255-z)*(255-X)*.003921568627451,I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},colordodge:function(r,e,n,t,i,o,l,u,c,f,h,p,m){var d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E;for(E=1-m,b=l,y=u*e,O=c,I=f*i,d=l+h,g=c+h,v=0,_=p*h;_>v;)C=b+y<<2,M=O+I<<2,A=r[C],z=r[C+1],Y=r[C+2],S=t[M],X=t[M+1],k=t[M+2],x=255==A?A:a(255,(S<<8)/(255-A)),F=255==z?z:a(255,(X<<8)/(255-z)),q=255==Y?A:a(255,(k<<8)/(255-Y)),A=x*m+A*E,z=F*m+z*E,Y=q*m+Y*E,s&&(A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z,Y=0>Y?0:Y>255?255:Y),r[C]=~~A,r[C+1]=~~z,r[C+2]=~~Y,v++,b++,b>=d&&(b=l,y+=e),O++,O>=g&&(O=c,I+=i);return r},colorburn:function(r,e,n,t,a,o,l,u,c,f,h,p,m){var d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E;for(E=1-m,b=l,y=u*e,O=c,I=f*a,d=l+h,g=c+h,v=0,_=p*h;_>v;)C=b+y<<2,M=O+I<<2,A=r[C],z=r[C+1],Y=r[C+2],S=t[M],X=t[M+1],k=t[M+2],x=0==A?A:i(0,255-(255-S<<8)/A),F=0==z?z:i(0,255-(255-X<<8)/z),q=0==Y?Y:i(0,255-(255-k<<8)/Y),A=x*m+A*E,z=F*m+z*E,Y=q*m+Y*E,s&&(A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z,Y=0>Y?0:Y>255?255:Y),r[C]=~~A,r[C+1]=~~z,r[C+2]=~~Y,v++,b++,b>=d&&(b=l,y+=e),O++,O>=g&&(O=c,I+=a);return r},linearlight:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;for(var E;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],128>I?(E=2*I,k=255>E+Y?0:E+Y-255):(E=2*(I-128),k=E+Y),128>A?(E=2*A,x=255>E+S?0:E+S-255):(E=2*(A-128),x=E+S),128>z?(E=2*z,F=255>E+X?0:E+X-255):(E=2*(z-128),F=E+X),I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},reflect:function(r,e,n,t,i,o,l,u,c,f,h,p,m){var d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E;for(E=1-m,b=l,y=u*e,O=c,I=f*i,d=l+h,g=c+h,v=0,_=p*h;_>v;)C=b+y<<2,M=O+I<<2,A=r[C],z=r[C+1],Y=r[C+2],S=t[M],X=t[M+1],k=t[M+2],x=255==A?A:a(255,S*S/(255-A)),F=255==z?z:a(255,X*X/(255-z)),q=255==Y?Y:a(255,k*k/(255-Y)),A=x*m+A*E,z=F*m+z*E,Y=q*m+Y*E,s&&(A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z,Y=0>Y?0:Y>255?255:Y),r[C]=~~A,r[C+1]=~~z,r[C+2]=~~Y,v++,b++,b>=d&&(b=l,y+=e),O++,O>=g&&(O=c,I+=i);return r},glow:function(r,e,n,t,i,o,l,u,c,f,h,p,m){var d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E;for(E=1-m,b=l,y=u*e,O=c,I=f*i,d=l+h,g=c+h,v=0,_=p*h;_>v;)C=b+y<<2,M=O+I<<2,A=r[C],z=r[C+1],Y=r[C+2],S=t[M],X=t[M+1],k=t[M+2],x=255==S?S:a(255,A*A/(255-S)),F=255==X?X:a(255,z*z/(255-X)),q=255==k?k:a(255,Y*Y/(255-k)),A=x*m+A*E,z=F*m+z*E,Y=q*m+Y*E,s&&(A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z,Y=0>Y?0:Y>255?255:Y),r[C]=~~A,r[C+1]=~~z,r[C+2]=~~Y,v++,b++,b>=d&&(b=l,y+=e),O++,O>=g&&(O=c,I+=i);return r},phoenix:function(r,e,n,t,o,l,u,c,f,h,p,m,d){var g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E,P;for(P=1-d,y=u,O=c*e,I=f,A=h*o,g=u+p,v=f+p,_=0,C=m*p;C>_;)M=y+O<<2,b=I+A<<2,z=r[M],Y=r[M+1],S=r[M+2],X=t[b],k=t[b+1],x=t[b+2],F=a(X,z)-i(X,z)+255,q=a(k,Y)-i(k,Y)+255,E=a(x,S)-i(x,S)+255,z=F*d+z*P,Y=q*d+Y*P,S=E*d+S*P,s&&(z=0>z?0:z>255?255:z,Y=0>Y?0:Y>255?255:Y,S=0>S?0:S>255?255:S),r[M]=~~z,r[M+1]=~~Y,r[M+2]=~~S,_++,y++,y>=g&&(y=u,O+=e),I++,I>=v&&(I=f,A+=o);return r},vividlight:function(r,e,n,t,o,l,u,c,f,h,p,m,d){var g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E,P;P=1-d,y=u,O=c*e,I=f,A=h*o,g=u+p,v=f+p,_=0,C=m*p;for(var w;C>_;)M=y+O<<2,b=I+A<<2,z=r[M],Y=r[M+1],S=r[M+2],X=t[b],k=t[b+1],x=t[b+2],128>z?(w=2*z,F=0==w?w:i(0,255-(255-X<<8)/w)):(w=2*(z-128),F=255==w?w:a(255,(X<<8)/(255-w))),128>Y?(w=2*Y,q=0==w?w:i(0,255-(255-k<<8)/w)):(w=2*(Y-128),q=255==w?w:a(255,(k<<8)/(255-w))),128>S?(w=2*S,E=0==w?w:i(0,255-(255-x<<8)/w)):(w=2*(Y-128),E=255==w?w:a(255,(x<<8)/(255-w))),z=F*d+z*P,Y=q*d+Y*P,S=E*d+S*P,s&&(z=0>z?0:z>255?255:z,Y=0>Y?0:Y>255?255:Y,S=0>S?0:S>255?255:S),r[M]=~~z,r[M+1]=~~Y,r[M+2]=~~S,_++,y++,y>=g&&(y=u,O+=e),I++,I>=v&&(I=f,A+=o);return r},pinlight:function(r,e,n,t,a,i,o,l,u,c,f,h,p){var m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q;q=1-p,M=o,b=l*e,y=u,O=c*a,m=o+f,d=u+f,g=0,v=h*f;for(var E;v>g;)_=M+b<<2,C=y+O<<2,I=r[_],A=r[_+1],z=r[_+2],Y=t[C],S=t[C+1],X=t[C+2],128>I?(E=2*I,k=E>Y?E:Y):(E=2*(I-128),k=E>Y?Y:E),128>A?(E=2*A,x=E>S?E:S):(E=2*(I-128),x=E>S?S:E),128>z?(E=2*z,F=E>X?E:X):(E=2*(z-128),F=E>X?X:E),I=k*p+I*q,A=x*p+A*q,z=F*p+z*q,s&&(I=0>I?0:I>255?255:I,A=0>A?0:A>255?255:A,z=0>z?0:z>255?255:z),r[_]=~~I,r[_+1]=~~A,r[_+2]=~~z,g++,M++,M>=m&&(M=o,b+=e),y++,y>=d&&(y=u,O+=a);return r},hardmix:function(r,e,n,t,o,l,u,c,f,h,p,m,d){var g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E,P;P=1-d,y=u,O=c*e,I=f,A=h*o,g=u+p,v=f+p,_=0,C=m*p;for(var w;C>_;)M=y+O<<2,b=I+A<<2,z=r[M],Y=r[M+1],S=r[M+2],X=t[b],k=t[b+1],x=t[b+2],128>z?(w=2*z,F=0==w?w:i(0,255-(255-X<<8)/w)):(w=2*(z-128),F=255==w?w:a(255,(X<<8)/(255-w))),F=128>F?0:255,128>Y?(w=2*Y,q=0==w?w:i(0,255-(255-k<<8)/w)):(w=2*(Y-128),q=255==w?w:a(255,(k<<8)/(255-w))),q=128>q?0:255,128>S?(w=2*S,E=0==w?w:i(0,255-(255-x<<8)/w)):(w=2*(S-128),E=255==w?w:a(255,(x<<8)/(255-w))),E=128>E?0:255,z=F*d+z*P,Y=q*d+Y*P,S=E*d+S*P,s&&(z=0>z?0:z>255?255:z,Y=0>Y?0:Y>255?255:Y,S=0>S?0:S>255?255:S),r[M]=~~z,r[M+1]=~~Y,r[M+2]=~~S,_++,y++,y>=g&&(y=u,O+=e),I++,I>=v&&(I=f,A+=o);return r}},t.lineardodge=t.add,t.linearburn=t.subtract}(e),!function(e){"use strict";var n=(e._notSupportClamp,e.Color.RGBA2Color),t=e.Color.Color2RGBA;e.Create({name:"ThresholdFilter",thresholds:null,quantizedColors:null,init:function(r,e){var n=this;n.thresholds=r,n.quantizedColors=e||null},path:e.getPath(r.AMD),serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{thresholds:r.thresholds,quantizedColors:r.quantizedColors}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n.thresholds=e.thresholds,n.quantizedColors=e.quantizedColors),n},apply:function(r){var e=this;if(!(e._isOn&&e.thresholds&&e.thresholds.length&&e.quantizedColors&&e.quantizedColors.length))return r;var a,i,o,l,s,u,c,f,h=r.length,p=e.thresholds,m=p.length,d=e.quantizedColors,g=d.length;for(c=0;h>c;c+=4){for(s=n({r:r[c],g:r[c+1],b:r[c+2],a:r[c+3]}),f=0;m>f&&s>p[f];)f++;s=g>f?d[f]:255,u=t(s),a=u.r,i=u.g,o=u.b,l=u.a,r[c]=a,r[c+1]=i,r[c+2]=o,r[c+3]=l}return r}})}(e),!function(e){"use strict";var n=(Math.sqrt,Math.exp,Math.log),t=Math.abs,a=Math.floor,i=e._notSupportClamp,o=e.Array32F;e.Create({name:"BokehFilter",centerX:0,centerY:0,radius:10,amount:10,init:function(r,e,n,t){var a=this;a.centerX=r||0,a.centerY=e||0,a.radius=n||10,a.amount=t||10},path:e.getPath(r.AMD),serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{centerX:r.centerX,centerY:r.centerY,radius:r.radius,amount:r.amount}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n.centerX=e.centerX,n.centerY=e.centerY,n.radius=e.radius,n.amount=e.amount),n},apply:function(r,e,l){var s=this;if(!s._isOn)return r;var u,c,f,h,p,m,d,g,v,_,C,M,b,y,O,I,A,z,Y,S,X,k,x,F,q,E,P,w,D,N,R,B,G,L=r.length,H=s.centerX||0,T=s.centerY||0,j=s.radius,$=s.amount;if(0>=$)return r;for(u=L>>2,N=0,R=e-1,B=0,G=u-e,H=a(H*(e-1)),T=a(T*(l-1)),f=(u<<1)+u,d=(e<<1)+e,c=new o(f),g=0,v=0,_=0,h=p=m=0,_=0;e>_;_++,g+=4,v+=3)h+=r[g],p+=r[g+1],m+=r[g+2],c[v]=h,c[v+1]=p,c[v+2]=m;for(g=d+e,v=0,_=0,h=p=m=0,g=d+e;L>g;g+=4,v+=3,_++)_>=e&&(_=0,h=p=m=0),h+=r[g],p+=r[g+1],m+=r[g+2],c[v+d]=c[v]+h,c[v+d+1]=c[v+1]+p,c[v+d+2]=c[v+2]+m;for(_=0,C=0,M=0,g=0;L>g;g+=4,_++)_>=e&&(_=0,C++,M+=e),y=_-H,O=C-T,b=t(y)+t(O),I=b>j?~~n((b-j)*$):~~(b/j+.5),I>0&&(A=I*e,z=.25/(I*I),Y=_-I,S=M-A,X=_+I,k=M+A,N>Y?Y=N:X>R&&(X=R),B>S?S=B:k>G&&(k=G),x=Y+S,E=X+k,F=X+S,q=Y+k,x=(x<<1)+x,F=(F<<1)+F,q=(q<<1)+q,E=(E<<1)+E,P=z*(c[E]-c[F]-c[q]+c[x]),w=z*(c[E+1]-c[F+1]-c[q+1]+c[x+1]),D=z*(c[E+2]-c[F+2]-c[q+2]+c[x+2]),i&&(P=0>P?0:P>255?255:P,w=0>w?0:w>255?255:w,D=0>D?0:D>255?255:D),r[g]=~~P,r[g+1]=~~w,r[g+2]=~~D);return r}})}(e),!function(e){"use strict";e.Create({name:"FloodFillFilter",x:0,y:0,color:null,tolerance:0,path:e.getPath(r.AMD),init:function(r,e,n,t){var a=this;a.x=r||0,a.y=e||0,a.color=n||[0,0,0],a.tolerance=t||0},serialize:function(){var r=this;return{filter:r.name,_isOn:!!r._isOn,params:{color:r.color,x:r.x,y:r.y,tolerance:r.tolerance}}},unserialize:function(r){var e,n=this;return r&&n.name===r.filter&&(n._isOn=!!r._isOn,e=r.params,n.color=e.color,n.x=e.x,n.y=e.y,n.tolerance=e.tolerance),n},apply:function(r,e){var n,t,a,i,o,l,s,u,c,f=this,h=(f.tolerance,f.color),p=e<<2,m=f.x,d=f.y,g=r.length,v=0,_=g-p,C=0,M=e-1<<2;if(l=d*e<<2,m<<=2,C>m||m>M||v>l||l>_||r[m+l]===h[0]&&r[m+l+1]===h[1]&&r[m+l+2]===h[2])return r;for(n=[r[m+l],r[m+l+1],r[m+l+2]],s=[],l+p>=v&&_>=l+p&&s.push([l,m,m,p]),s.push([l+p,m,m,-p]);s.length;){for(u=s.pop(),l=u[0]+(p=u[3]),i=u[1],o=u[2],a=i;a>=C&&(n[0]===r[a+l]&&n[1]===r[a+l+1]&&n[2]===r[a+l+2]);a-=4)r[a+l]=h[0],r[a+l+1]=h[1],r[a+l+2]=h[2];if(a>=i){for(;o>=a&&(n[0]!==r[a+l]||n[1]!==r[a+l+1]||n[2]!==r[a+l+2]);)a+=4;t=a,c=o>=a}else t=a+4,i>t&&l-p>=v&&_>=l-p&&s.push([l,t,i-4,-p]),a=i+4,c=!0;for(;c;){for(;M>=a&&n[0]===r[a+l]&&n[1]===r[a+l+1]&&n[2]===r[a+l+2];)r[a+l]=h[0],r[a+l+1]=h[1],r[a+l+2]=h[2],a+=4;for(l+p>=v&&_>=l+p&&s.push([l,t,a-4,p]),a>o+4&&l-p>=v&&_>=l-p&&s.push([l,o+4,a-4,-p]);o>=a&&(n[0]!==r[a+l]||n[1]!==r[a+l+1]||n[2]!==r[a+l+2]);)a+=4;t=a,c=o>=a}}return r}})}(e),r.FILTER_PLUGINS});