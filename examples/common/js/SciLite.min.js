/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.11
* 2026-01-01 23:44:25
* https://github.com/foo123/SciLite
*
**/!function(r,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(r)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(r)}):n in r||(r[n]=t.call(r)||1)&&"function"==typeof define&&define.amd&&define(function(){return r[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function r(){}var t,e,A=null,_=null,I=Math,L={},i={},T=I.PI,f=I.E,a=I.log(10),l=I.log(2),X=1/0,s=NaN,rn=1e-15,h=Number.MAX_VALUE,m=Number.MIN_VALUE,g=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,z=g,O=0,$=1,Z=-1,tn=.5,en=2,un=10,on=[],fn=Object.prototype.hasOwnProperty,cn=Object.prototype.toString,k=Array.isArray||function(n){return"[object Array]"===cn.call(n)},an={VERSION:"0.9.11",_:{},fn:{},op:{},constant:{pi:T,e:f,eps:rn,realmax:h,realmin:m,intmax:g,intmin:d,inf:X,Inf:X,nan:s,NaN:s}},c=an._,ln=an.constant,E=an.fn;function v(n){throw String(n)+": input(s) not supported"}function sn(n,r){return n instanceof r}function hn(n){return"function"==typeof n}function mn(n){return"[object Object]"===cn.call(n)}function q(n){return"string"==typeof n}function gn(n){return dn(n)&&n.isNaN()||Number.isNaN(n)}function pn(n){return dn(n)&&!n.isFinite()||u(n)&&!isFinite(n)}function u(n){return"number"==typeof n}function dn(n){return null!=A&&n instanceof A}function F(n){return"number"==typeof n||null!=A&&n instanceof A}function p(n){return dn(n)&&n.isInt()||u(n)&&Number.isInteger(n)}function o(n){return null!=_&&n instanceof _}function vn(n){return!o(n)||V(O,n.im)}function y(n,r){if(u(n)||o(n)||dn(n))return!0;if(!1===r){if(w(n)&&1===n.length)return!0;if(b(n)&&1===n.length&&1===n[0].length)return!0}return!1}function w(n){return k(n)&&y(n[0])}function b(n){return k(n)&&k(n[0])&&y(n[0][0])}function yn(n){return!k(n)}function wn(n){return k(n)&&!k(n[0])}function bn(n){return k(n)&&k(n[0])}function W(n,r){for(var t=new Array(n),e=0;e<n;++e)t[e]=hn(r)?r(e,t):r;return t}function S(n,r,t){for(var e,i,u=new Array(n),o=0;o<n;++o)for(u[o]=i=new Array(r),e=0;e<r;++e)i[e]=hn(t)?t(o,e,u):t;return u}function xn(n,t){return n.length?W(n[0],function(r){return 1<n.length?xn(n.slice(1),function(n){return hn(t)?t([r].concat(n)):t}):hn(t)?t([r]):t}):[]}function kn(n){return yn(n)?[[n]]:wn(n)?[n]:n}function Sn(n){return yn(n)?[[n]]:wn(n)?n.map(function(n){return[n]}):n}function An(n,r){return F(n)?n:o(n)?r?n.re:n:w(n)&&1===n.length?An(n[0],r):b(n)&&1===n.length&&1===n[0].length?An(n[0][0],r):n}function N(n){if(null!=n)if(bn(n)){if(1===U(n))return n[0];if(1===B(n))return n.map(function(n){return n[0]})}else if(yn(n))return[n];return n}function U(n){return n.length}function B(n){return n[0].length}function j(r,t){return W(r.length,function(n){return r[n][t]})}function M(n){return"number"==typeof n?n:dn(n)?n.$valueOf():o(n)?n.valueOf():n}function Q(n){return null!=A&&"number"==typeof n?A(n):n}function _n(n){return k(n)?n.map(_n):y(n)?M(n):n}function In(n){return n=k(n)?n.map(In):n}function En(r,n,t){if(F(n))return r(n);if(o(n)){if(t)return r(n);if(V(n.im,O))return r(n.re)}return k(n)?n.map(function(n){return En(r,n,t)}):n}function qn(t,n,e,i){return F(n)&&F(e)?t(n,e):y(n)&&y(e)?i?t(Tn(n),Tn(e)):vn(n)&&vn(e)?t(Rn(n),Rn(e)):s:k(n)&&k(e)?n.map(function(n,r){return qn(t,n,e[r],i)}):s}function Nn(t,e){if(!hn(t))return k(t)&&(t.$scilitevarargout$=!0),t;null==e&&(e=1);function n(){var n=[].slice.call(arguments);return n.unshift(e),n=t.apply(null,n),1<e&&k(n)&&(n.$scilitevarargout$=!0),n}return n.nargout=function(r){return function(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),(1<r||1<e)&&k(n)&&(n.$scilitevarargout$=!0),n}},n}function jn(n){return gn(n)?n="nan":pn(n)?n=(Xn(n,O)?"-":"")+"inf":p(n)?n=String(n):F(n)?n=n.toFixed(4).replace(/\.0{4}$/,""):o(n)&&(n=String(n)),n}function Mn(t){var r;return null==t?t="":q(t)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(t)&&(t="\\text{"+t+"}"):t=gn(t)?"\\text{nan}":F(t)?[rn,h,m,g,d].reduce(function(n,r){return n||V(t,r)},!1)?String(t):jn(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):o(t)?String(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):b(t)?(r=!1,B(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,I.round(c.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-I.round(c.MAXPRINTSIZE/2)))}),r=!0),"\\begin{bmatrix}"+(t=U(t)>c.MAXPRINTSIZE?t.slice(0,I.round(c.MAXPRINTSIZE/2)).concat([W(t[0].length,function(n){return I.round(c.MAXPRINTSIZE/2)===n&&r?"\\ddots":"\\vdots"})]).concat(t.slice(1-I.round(c.MAXPRINTSIZE/2))):t).map(function(n){return n.map(Mn).join(" & \\hskip 1em ")}).join(" \\\\ ")+"\\end{bmatrix}"):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,I.round(c.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(t.slice(1-I.round(c.MAXPRINTSIZE/2))):t).map(Mn).join(" \\hskip 1em "):"object"==typeof t||"function"==typeof t?"":String(t),t}function Pn(t){var r,e;return null==t?t="":q(t)||(t=gn(t)?"nan":F(t)?([rn,h,m,g,d].reduce(function(n,r){return n||V(t,r)},!1)?String:jn)(t):o(t)?String(t):b(t)?(r=!1,B(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,I.round(c.MAXPRINTSIZE/2)).concat("..").concat(n.slice(1-I.round(c.MAXPRINTSIZE/2)))}),r=!0),U(t)>c.MAXPRINTSIZE&&(t=t.slice(0,I.round(c.MAXPRINTSIZE/2)).concat([W(t[0].length,function(n){return I.round(c.MAXPRINTSIZE/2)===n&&r?"\\":":"})]).concat(t.slice(1-I.round(c.MAXPRINTSIZE/2)))),e=W(B(t),function(n){return j(t,n).reduce(function(n,r){return I.max(n,Pn(r).length)},0)}),t.map(function(n,r){return"["+n.map(function(n,r){n=Pn(n);return n=n.length<e[r]?new Array(e[r]-n.length+1).join(" ")+n:n}).join("  ")+"]"}).join("\n")):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,I.round(c.MAXPRINTSIZE/2)).concat([".."]).concat(t.slice(1-I.round(c.MAXPRINTSIZE/2))):t).map(Pn).join("  "):"object"==typeof t||"function"==typeof t?"":String(t)),t}function Rn(n){return k(n)?n.map(Rn):o(n)&&V(n.im,O)?n.re:n}function Tn(n){return _?k(n)?n.map(Tn):F(n)?new _(Q(n),O):n:n}function V(n,r){return u(n)?u(r)?n===r:r.eq(n):n.eq(r)}function Xn(n,r){return u(n)?u(r)?n<r:r.gt(n):n.lt(r)}function zn(n,r){return u(n)?u(r)?r<n:r.lt(n):n.gt(r)}function Zn(n,r){return u(n)?u(r)?n<=r:r.gte(n):n.lte(r)}function Ln(n,r){return u(n)?u(r)?r<=n:r.lte(n):n.gte(r)}function G(n,r){return u(n)?u(r)?n+r:r.add(n):n.add(r)}function D(n,r){return u(n)?u(r)?n-r:r.neg().add(n):n.sub(r)}function H(n,r){return u(n)?u(r)?n*r:r.mul(n):n.mul(r)}function K(n,r){return u(n)?u(r)?n/r:A(n).div(r):n.div(r)}function On(n,r){return gn(n)||gn(r)?s:u(n)?u(r)?n<0&&!p(r)?Rn(new _(n).pow(r)):I.pow(n,r):n<0&&!p(r)?Rn(new _(A(n)).pow(r)):A(n).pow(r):zn(O,n)&&!p(r)?Rn(new _(n).pow(A(r))):n.pow(r)}function $n(n,r){return u(n)?u(r)?n%r:A(n).mod(r):n.mod(r)}function Cn(n){return u(n)?-n:n.neg()}function Fn(n){return u(n)?1/n:$.div(n)}function P(t,e){if(q(t)){if(q(e))return t===e?1:0;if(y(e))return t===String(e)?1:0;if(w(e))return e.map(function(n){return P(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return P(t,e[n][r])})}else if(F(t)){if(q(e))return String(t)===e?1:0;if(F(e))return V(t,e)?1:0;if(o(e))return V(e.re,t)&&V(e.im,O)?1:0;if(w(e))return e.map(function(n){return P(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return P(t,e[n][r])})}else if(o(t)){if(q(e))return String(t)===e?1:0;if(F(e))return V(t.re,e)&&V(t.im,O)?1:0;if(o(e))return V(t.re,e.re)&&V(t.im,e.im)?1:0;if(w(e))return e.map(function(n){return P(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return P(t,e[n][r])})}else if(w(t)){if(q(e)||y(e))return t.map(function(n){return P(n,e)});if(w(e)){if(t.length!==e.length)throw"eq: inputs have incompatible dimensions";return t.map(function(n,r){return P(n,e[r])})}if(b(e)){if(t.length!==B(e))throw"eq: inputs have incompatible dimensions";return S(U(e),B(e),function(n,r){return P(t[r],e[n][r])})}}else if(b(t)){if(q(e)||y(e))return S(U(t),B(t),function(n,r){return P(t[n][r],e)});if(w(e)){if(B(t)!==e.length)throw"eq: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return P(t[n][r],e[r])})}if(b(e)){if(U(t)!==U(e)||B(t)!==B(e))throw"eq: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return P(t[n][r],e[n][r])})}}return 0}function Wn(t,e){if(q(t)){if(q(e))return t===e?0:1;if(y(e))return t===String(e)?0:1;if(w(e))return e.map(function(n){return Wn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Wn(t,e[n][r])})}else if(F(t)){if(q(e))return String(t)===e?0:1;if(F(e))return V(t,e)?0:1;if(o(e))return V(e.re,t)&&V(e.im,O)?0:1;if(w(e))return e.map(function(n){return Wn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Wn(t,e[n][r])})}else if(o(t)){if(q(e))return String(t)===e?0:1;if(F(e))return V(t.re,e)&&V(t.im,O)?0:1;if(o(e))return V(t.re,e.re)&&V(t.im,e.im)?0:1;if(w(e))return e.map(function(n){return Wn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Wn(t,e[n][r])})}else if(w(t)){if(q(e)||y(e))return t.map(function(n){return Wn(n,e)});if(w(e)){if(t.length!==e.length)throw"ne: inputs have incompatible dimensions";return t.map(function(n,r){return Wn(n,e[r])})}if(b(e)){if(t.length!==B(e))throw"ne: inputs have incompatible dimensions";return S(U(e),B(e),function(n,r){return Wn(t[r],e[n][r])})}}else if(b(t)){if(q(e)||y(e))return S(U(t),B(t),function(n,r){return Wn(t[n][r],e)});if(w(e)){if(B(t)!==e.length)throw"ne: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Wn(t[n][r],e[r])})}if(b(e)){if(U(t)!==U(e)||B(t)!==B(e))throw"ne: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Wn(t[n][r],e[n][r])})}}return 0}function Un(t,e){if(q(t)){if(q(e))return t<e?1:0;if(y(e))return t<String(e)?1:0;if(w(e))return e.map(function(n){return Un(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Un(t,e[n][r])})}else if(F(t)){if(q(e))return String(t)<e?1:0;if(F(e))return Xn(t,e)?1:0;if(o(e))return Xn(e.re,t)&&V(e.im,O)?1:0;if(w(e))return e.map(function(n){return Un(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Un(t,e[n][r])})}else if(o(t)){if(q(e))return String(t)<e?1:0;if(F(e))return Xn(t.re,e)&&V(t.im,O)?1:0;if(o(e))return Xn(t.re,e.re)&&V(t.im,O)&&V(e.im,O)||Xn(t.im,e.im)&&V(t.re,O)&&V(e.re,O)?1:0;if(w(e))return e.map(function(n){return Un(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Un(t,e[n][r])})}else if(w(t)){if(q(e)||y(e))return t.map(function(n){return Un(n,e)});if(w(e)){if(t.length!==e.length)throw"lt: inputs have incompatible dimensions";return t.map(function(n,r){return Un(n,e[r])})}if(b(e)){if(t.length!==B(e))throw"lt: inputs have incompatible dimensions";return S(U(e),B(e),function(n,r){return Un(t[r],e[n][r])})}}else if(b(t)){if(q(e)||y(e))return S(U(t),B(t),function(n,r){return Un(t[n][r],e)});if(w(e)){if(B(t)!==e.length)throw"lt: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Un(t[n][r],e[r])})}if(b(e)){if(U(t)!==U(e)||B(t)!==B(e))throw"lt: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Un(t[n][r],e[n][r])})}}return 0}function Bn(t,e){if(q(t)){if(q(e))return e<t?1:0;if(y(e))return t>String(e)?1:0;if(w(e))return e.map(function(n){return Bn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Bn(t,e[n][r])})}else if(F(t)){if(q(e))return String(t)>e?1:0;if(F(e))return zn(t,e)?1:0;if(o(e))return zn(e.re,t)&&V(e.im,O)?1:0;if(w(e))return e.map(function(n){return Bn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Bn(t,e[n][r])})}else if(o(t)){if(q(e))return String(t)>e?1:0;if(F(e))return zn(t.re,e)&&V(t.im,O)?1:0;if(o(e))return zn(t.re,e.re)&&V(t.im,O)&&V(e.im,O)||zn(t.im,e.im)&&V(t.re,O)&&V(e.re,O)?1:0;if(w(e))return e.map(function(n){return Bn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Bn(t,e[n][r])})}else if(w(t)){if(q(e)||y(e))return t.map(function(n){return Bn(n,e)});if(w(e)){if(t.length!==e.length)throw"gt: inputs have incompatible dimensions";return t.map(function(n,r){return Bn(n,e[r])})}if(b(e)){if(t.length!==B(e))throw"gt: inputs have incompatible dimensions";return S(U(e),B(e),function(n,r){return Bn(t[r],e[n][r])})}}else if(b(t)){if(q(e)||y(e))return S(U(t),B(t),function(n,r){return Bn(t[n][r],e)});if(w(e)){if(B(t)!==e.length)throw"gt: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Bn(t[n][r],e[r])})}if(b(e)){if(U(t)!==U(e)||B(t)!==B(e))throw"gt: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Bn(t[n][r],e[n][r])})}}return 0}function Qn(t,e){if(q(t)){if(q(e))return t<=e?1:0;if(y(e))return t<=String(e)?1:0;if(w(e))return e.map(function(n){return Qn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Qn(t,e[n][r])})}else if(F(t)){if(q(e))return String(t)<=e?1:0;if(F(e))return Zn(t,e)?1:0;if(o(e))return Zn(e.re,t)&&V(e.im,O)?1:0;if(w(e))return e.map(function(n){return Qn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Qn(t,e[n][r])})}else if(o(t)){if(q(e))return String(t)<=e?1:0;if(F(e))return Zn(t.re,e)&&V(t.im,O)?1:0;if(o(e))return Zn(t.re,e.re)&&V(t.im,O)&&V(e.im,O)||Zn(t.im,e.im)&&V(t.re,O)&&V(e.re,O)?1:0;if(w(e))return e.map(function(n){return Qn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Qn(t,e[n][r])})}else if(w(t)){if(q(e)||y(e))return t.map(function(n){return Qn(n,e)});if(w(e)){if(t.length!==e.length)throw"le: inputs have incompatible dimensions";return t.map(function(n,r){return Qn(n,e[r])})}if(b(e)){if(t.length!==B(e))throw"le: inputs have incompatible dimensions";return S(U(e),B(e),function(n,r){return Qn(t[r],e[n][r])})}}else if(b(t)){if(q(e)||y(e))return S(U(t),B(t),function(n,r){return Qn(t[n][r],e)});if(w(e)){if(B(t)!==e.length)throw"le: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Qn(t[n][r],e[r])})}if(b(e)){if(U(t)!==U(e)||B(t)!==B(e))throw"le: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Qn(t[n][r],e[n][r])})}}return 0}function Vn(t,e){if(q(t)){if(q(e))return e<=t?1:0;if(y(e))return t>=String(e)?1:0;if(w(e))return e.map(function(n){return Vn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Vn(t,e[n][r])})}else if(F(t)){if(q(e))return String(t)>=e?1:0;if(F(e))return Ln(t,e)?1:0;if(o(e))return Ln(e.re,t)&&V(e.im,O)?1:0;if(w(e))return e.map(function(n){return Vn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Vn(t,e[n][r])})}else if(o(t)){if(q(e))return String(t)>=e?1:0;if(F(e))return Ln(t.re,e)&&V(t.im,O)?1:0;if(o(e))return Ln(t.re,e.re)&&V(t.im,O)&&V(e.im,O)||Ln(t.im,e.im)&&V(t.re,O)&&V(e.re,O)?1:0;if(w(e))return e.map(function(n){return Vn(t,n)});if(b(e))return S(U(e),B(e),function(n,r){return Vn(t,e[n][r])})}else if(w(t)){if(q(e)||y(e))return t.map(function(n){return Vn(n,e)});if(w(e)){if(t.length!==e.length)throw"ge: inputs have incompatible dimensions";return t.map(function(n,r){return Vn(n,e[r])})}if(b(e)){if(t.length!==B(e))throw"ge: inputs have incompatible dimensions";return S(U(e),B(e),function(n,r){return Vn(t[r],e[n][r])})}}else if(b(t)){if(q(e)||y(e))return S(U(t),B(t),function(n,r){return Vn(t[n][r],e)});if(w(e)){if(B(t)!==e.length)throw"ge: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Vn(t[n][r],e[r])})}if(b(e)){if(U(t)!==U(e)||B(t)!==B(e))throw"ge: inputs have incompatible dimensions";return S(U(t),B(t),function(n,r){return Vn(t[n][r],e[n][r])})}}return 0}function Gn(n){return o(n)?n.sign():L.sign(n)}function J(n,r){return F(n)&&F(r)?G(n,r):o(n)&&y(r)?n.add(r):o(r)&&y(n)?r.add(n):s}function Dn(n,r){return F(n)&&F(r)?D(n,r):o(n)&&y(r)?n.sub(r):o(r)&&y(n)?r.neg().add(n):s}function Y(n,r){return F(n)&&F(r)?H(n,r):o(n)&&y(r)?n.mul(r):o(r)&&y(n)?r.mul(n):s}function nn(n,r){return F(n)&&F(r)?K(n,r):o(n)&&y(r)?n.div(r):o(r)&&y(n)?r.inv().mul(n):s}function Hn(n,r){return F(n)&&F(r)?On(n,r):o(n)&&y(r)?n.pow(r):o(r)&&y(n)?new _(n,O).pow(r):s}function Kn(n){return F(n)?Cn(n):o(n)?n.neg():s}function Jn(n){return F(n)?n:o(n)?n.conj():s}function Yn(n){return F(n)?V(n,O)?X:Fn(n):o(n)?V(n.abs(),O)?new _(X,Xn(n.im,O)?X:-X):n.inv():s}function nr(n){return F(n)?L.abs(n):o(n)?n.abs():s}function rr(n){return F(n)?Xn(n,O)?ln.pi:O:o(n)?n.angle():s}function tr(r,e){if(q(r)&&q(e))return r+e;if(y(r)&&y(e))return J(r,e);if(b(r)&&b(e)){if(U(r)===U(e)&&B(r)===B(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return tr(n,t[r])})});throw"add: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return tr(n,e[r])});throw"add: vector dimensions do not match"}return k(r)?r.map(function(n){return tr(n,e)}):k(e)?e.map(function(n){return tr(r,n)}):void v("add")}function er(r,e){if(y(r)&&y(e))return Dn(r,e);if(b(r)&&b(e)){if(U(r)===U(e)&&B(r)===B(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return er(n,t[r])})});throw"sub: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return er(n,e[r])});throw"sub: vector dimensions do not match"}return k(r)?r.map(function(n){return er(n,e)}):k(e)?e.map(function(n){return er(r,n)}):void v("sub")}function ir(r,e){if(y(r)&&y(e))return Y(r,e);if(b(r)&&b(e)){if(U(r)===U(e)&&B(r)===B(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return ir(n,t[r])})});throw"dotmul: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return ir(n,e[r])});throw"dotmul: vector dimensions do not match"}return k(r)?r.map(function(n){return ir(n,e)}):k(e)?e.map(function(n){return ir(r,n)}):void v("dotmul")}function ur(r,e){if(y(r)&&y(e))return nn(r,e);if(b(r)&&b(e)){if(U(r)===U(e)&&B(r)===B(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return ur(n,t[r])})});throw"dotdiv: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return ur(n,e[r])});throw"dotdiv: vector dimensions do not match"}return k(r)?r.map(function(n){return ur(n,e)}):k(e)?e.map(function(n){return ur(r,n)}):void v("dotdiv")}function or(r,e){if(y(r)&&y(e))return Hn(r,e);if(b(r)&&b(e)){if(U(r)===U(e)&&B(r)===B(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return or(n,t[r])})});throw"dotpow: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return or(n,e[r])});throw"dotpow: vector dimensions do not match"}return k(r)?r.map(function(n){return or(n,e)}):k(e)?e.map(function(n){return or(r,n)}):void v("dotpow")}function R(i,u){if(y(i)&&y(u))return Y(i,u);if(b(i)&&b(u)){if(B(i)===U(u))return n=U(i),r=B(u),o=U(u),S(n,r,function(n,r){for(var t=O,e=0;e<o;++e)t=J(t,Y(i[n][e],u[e][r]));return t});throw"mul: matrix-matrix dimensions do not match"}if(w(i)&&b(u)){if(i.length===U(u))return r=B(u),o=i.length,S(n=1,r,function(n,r){for(var t=O,e=0;e<o;++e)t=J(t,Y(i[e],u[e][r]));return t});throw"mul: vector-matrix dimensions do not match"}if(b(i)&&w(u)){var o;if(B(i)===u.length)return n=U(i),o=u.length,S(n,r=1,function(n,r){for(var t=O,e=0;e<o;++e)t=J(t,Y(i[n][e],u[e]));return t});throw"mul: matrix-vector dimensions do not match"}var n,r;return w(i)&&w(u)?S(n=i.length,r=u.length,function(n,r){return Y(i[n],u[r])}):k(i)?i.map(function(n){return R(n,u)}):k(u)?u.map(function(n){return R(i,n)}):void v("mul")}function fr(n,r){if(y(n)&&y(r))return Hn(n,r);if(b(n)&&U(n)===B(n)&&p(r)){if((r=M(r))<0&&(r=-r,!(n=yt(n))||!n.length))throw"pow: no inverse";if(0===r)return zr(U(n));if(1===r)return n;if(2===r)return R(n,n);for(var t=zr(U(n));0!==r;)1&r&&(t=R(t,n)),0<(r>>=1)&&(n=R(n,n));return t}v("pow")}function cr(n){return y(n)?Kn(n):k(n)?n.map(cr):n}function ar(e,n=":",t=null){if(wn(e)){if(w(n)&&n.length===e.length&&et(n,function(n){return 0===M(n)||1===M(n)}))return o=1===(o=n.reduce(function(n,r,t){return 1===M(r)&&n.push(e[t]),n},[])).length?o[0]:o;if(":"===(n=y(n)?An(n,!0):n)||p(n)||w(n))return r=e.length,1===(o=(n=p(n=":"===n?Zr(1,r):n)?[n]:n).map(function(n){if((n=M(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[n-1]})).length?o[0]:o;throw"get: invalid range"}if(bn(e)){var i=U(e),u=B(e),r=i*u;if(null==t&&b(n)&&U(n)===i&&B(n)===u&&et(n,function(n){return 0===M(n)||1===M(n)})){for(var o=[],f=0;f<u;++f)for(var c=0;c<i;++c)1===M(n[c][f])&&o.push(e[c][f]);return o=1===o.length?o[0]:o}if(y(n)&&(n=An(n,!0)),y(t)&&(t=An(t,!0)),":"===n||p(n)||w(n)){if(p(n=":"===n?Zr(1,i):n)&&(n=[n]),null==t)return o=1===(o=n.map(function(n){if((n=M(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[(n-1)%i][I.floor((n-1)/i)]})).length?o[0]:o;if(":"===t||p(t)||w(t))return p(t=":"===t?Zr(1,u):t)&&(t=[t]),o=1===(o=n.map(function(r){if((r=M(r))<1&&(r+=i),r<1||i<r)throw"get: index out of bounds";return t.map(function(n){if((n=M(n))<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[r-1][n-1]})})).length&&1===o[0].length?o[0][0]:o}throw"get: invalid range"}return e}function lr(i,r=":",n=null,u=null){if(wn(i)){if(bn(u)&&(u=j(u,0)),w(r)&&r.length===i.length&&et(r,function(n){return 0===M(n)||1===M(n)})){if(yn(u))return r.forEach(function(n,r){1===M(n)&&(i[r]=u)}),i;if(k(u))return h=0,t=u.length,r.forEach(function(n,r){if(1===M(n)){if(t<=h)throw"set: index out of bounds";i[r]=u[h++]}}),i}if(":"===(r=y(r)?An(r,!0):r)||p(r)||w(r)){var e=i.length;if(p(r=":"===r?Zr(1,e):r)&&(r=[r]),yn(u))return r.forEach(function(n){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u}),i;if(k(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u[r]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(bn(i)){var o,f,t,c,a,l,s,h,m=U(i),g=B(i),e=m*g;if(b(r)&&U(r)===m&&B(r)===g&&et(r,function(n){return 0===M(n)||1===M(n)})){if(yn(u))return r.forEach(function(n,t){n.forEach(function(n,r){1===M(n)&&(i[t][r]=u)})}),i;if(bn(u)){for(o=U(u),f=B(u),s=a=0;a<g;++a,++s){if(1===f)s=0;else if(f<=s)throw"set: index out of bounds";for(l=c=0;c<m;++c,++l)if(1===M(r[c][a])){if(1===o)l=0;else if(o<=l)throw"set: index out of bounds";i[c][a]=u[l][s]}}return i}if(k(u)){for(t=u.length,a=h=0;a<g;++a)for(c=0;c<m;++c)if(1===M(r[c][a])){if(t<=h)throw"set: index out of bounds";i[c][a]=u[h++]}return i}}if(y(r)&&(r=An(r,!0)),y(n)&&(n=An(n,!0)),":"===r||p(r)||w(r)){if(null==n){if(p(r=":"===r?Zr(1,e):r)&&(r=[r]),yn(u))return r.forEach(function(n){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][I.floor((n-1)/m)]=u}),i;if(bn(u))return o=U(u),f=B(u),r.forEach(function(n,r){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";var t=1===o?0:r%m,r=1===f?0:I.floor(r/m);if(o<=t||f<=r)throw"set: index out of bounds";i[(n-1)%m][I.floor((n-1)/m)]=u[t][r]}),i;if(k(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][I.floor((n-1)/m)]=u[r]}),i}else if(":"===n||p(n)||w(n)){if(p(r=":"===r?Zr(1,m):r)&&(r=[r]),p(n=":"===n?Zr(1,g):n)&&(n=[n]),yn(u))return r.forEach(function(r){if((r=M(r))<1&&(r+=m),r<1||m<r)throw"set: index out of bounds";n.forEach(function(n){if((n=M(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";i[r-1][n-1]=u})}),i;if(bn(u))return o=U(u),f=B(u),r.forEach(function(t,e){if((t=M(t))<1&&(t+=m),t<1||m<t)throw"set: index out of bounds";if(1===o)e=0;else if(o<=e)throw"set: index out of bounds";n.forEach(function(n,r){if((n=M(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";if(1===f)r=0;else if(f<=r)throw"set: index out of bounds";i[t-1][n-1]=u[e][r]})}),i;if(k(u)&&u.length>=r.length*n.length)return h=0,n.forEach(function(t,n){if((t=M(t))<1&&(t+=g),t<1||g<t)throw"set: index out of bounds";r.forEach(function(n,r){if((n=M(n))<1&&(n+=m),n<1||m<n)throw"set: index out of bounds";i[n-1][t-1]=u[h++]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function sr(n,r){var t,e,i;return u(n)&&u(r)?(t=n,e=r,t=I.abs(t),e=I.abs(e),(i=0)===t?e:0===e?t:e<t?t*I.sqrt(1+(i=e/t)*i):t<e?e*I.sqrt(1+(i=t/e)*i):t*I.SQRT2):L.sqrt(G(H(n,n),H(r,r)))}function hr(){var n,r,t,e=0,i=0;if(u(hr.z1))return t=hr.z1,hr.z1=null,t;for(;0===e||1===e;)e=I.random();for(;0===i||1===i;)i=I.random();return r=(n=I.sqrt(-2*I.log(e)))*I.cos(2*T*i),t=n*I.sin(2*T*i),hr.z1=t,r}function mr(n,r){var t,n=1===arguments.length?n:er(n,r);return n.reduce(function(n,r){return n&&(u(r)||o(r)&&u(r.re)&&u(r.im))},!0)?(t=0,r=(r=n).map(function(n){return n=nr(n),t<n&&(t=n),n}),0===t?0:t*I.sqrt(r.reduce(function(n,r){return r===t?n+1:n+(n=r/t)*n},0))):L.sqrt(jr(Hr(n,n)))}function gr(n,r){n=1===arguments.length?n:er(n,r);return jr(Hr(n,n))}function pr(n,r,t){n=ur(er(n,r),t);return jr(Hr(n,n))}function dr(n,r,t){n=er(n,r);return jr(Hr(N(R(n,t)),n))}function vr(n,r,t){return V(t=2===arguments.length?r:t,$)?2===arguments.length?wr(n):wr(n,r):V(t,en)?2===arguments.length?mr(n):mr(n,r):pn(t)?2===arguments.length?yr(n):yr(n,r):Hn(Gr(or(Rr(2===arguments.length?n:er(n,r)),t)),Fn(t))}function yr(n,r){return Vr(Rr(1===arguments.length?n:er(n,r)))}function wr(n,r){return Gr(Rr(1===arguments.length?n:er(n,r)))}function br(n,r){return Dn($,nn(nn(Hr(n,r),L.sqrt(jr(Hr(n,n)))),L.sqrt(jr(Hr(r,r)))))}function xr(n,r){return br(er(n,$t(n)),er(r,$t(r)))}function kr(n,e){return Q(n.reduce(function(n,r,t){return n+1-P(r,e[t])},0)/n.length)}function Sr(n,e){return Q(1-n.reduce(function(n,r,t){return n+P(r,e[t])},0)/n.length)}function Ar(n,r,t){var e;return b(n)&&b(r)?(n=tr(er(n,Qr(Qr(n))),rn),r=tr(er(r,Qr(Qr(r))),rn),n=ur(n,Gr(Gr(n))),r=ur(r,Gr(Gr(r))),e=Gr(Gr(tr(er(ir(n,E.log(ur(n,r))),n),r))),t&&(e=Y(J(e,Gr(Gr(tr(er(ir(r,E.log(ur(r,n))),r),n)))),tn))):(n=tr(er(n,Qr(n)),rn),r=tr(er(r,Qr(r)),rn),n=ur(n,Gr(n)),r=ur(r,Gr(r)),e=Gr(tr(er(ir(n,E.log(ur(n,r))),n),r)),t&&(e=Y(J(e,Gr(tr(er(ir(r,E.log(ur(r,n))),r),n))),tn))),e}function _r(n,r){for(var t,e,i=n.length,u=n.map(function(n,r){return[n,r]}).sort(function(n,r){return P(n[0],r[0])?n[1]-r[1]:Un(n[0],r[0])?-1:1}),o=new Array(i),f=0;f<i;){for(e=1,t=f;t+e<i&&P(u[t][0],u[t+e][0]);)++e;for(;t<f+e;)o[u[t][1]]=gn(u[t][0])?s:Q(r?(2*f<=i?f+1:i-f)+(1<e?1/e:0):f+1+(1<e?1/e:0)),++t;f=t}return o}function Ir(n,r){var t=n.length;return 1<t?nn(Gr(ir(ur(er(n,$t(n)),Ct(n)),ur(er(r,$t(r)),Ct(r)))),Q(t-1)):$}function Er(n,r){return Ir(_r(n),_r(r))}function qr(n,r){if(1<n.length){for(var t,e=n.length,i=O,u=0;u<e;++u)for(t=u+1;t<e;++t)i=J(i,Y(Gn(Dn(n[u],n[t])),Gn(Dn(r[u],r[t]))));return nn(nn(Y(i,en),e),e-1)}return $}function Nr(){if(!sn(this,Nr))return new Nr;this.data=[]}function jr(n){return En(function(n){return o(n)?n.re:n},n,!0)}function Mr(n){return En(function(n){return o(n)?n.im:0},n,!0)}function Pr(n){return En(Jn,n,!0)}function Rr(n){return En(nr,n,!0)}function Tr(n,r){if(pn(r=null==r?en:r)){if(y(n=N(n)))return nr(n);if(w(n))return(Xn(r,O)?Qr:Vr)(Rr(n));if(b(n)&&zn(r,O))return Vr(Gr(Rr(Or(n))))}else if(F(r)){if(n=N(n),V(r,$)){if(y(n))return nr(n);if(w(n))return Gr(Rr(n));if(b(n))return Vr(Gr(Rr(n)))}else if(V(r,en)){if(y(n))return nr(n);if(w(n))return mr(n);if(b(n))return Vr(Mt(n,null,!1,!1))}else if(zn(r,O)){if(y(n))return nr(n);if(w(n))return vr(n,r)}}else if("fro"===r&&b(n))return L.sqrt(kt(jr(R($r(n),n))));v("norm")}function Xr(n,r){return w(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),O)}function zr(n,t){return null==t&&(t=$),S(M(n=An(n=null==n?1:n,!0)),M(n),function(n,r){return n===r?t:O})}function Zr(n,r,t){if(1===arguments.length&&k(n)){if(bn(n)){for(var e,i=U(n),u=B(n),o=new Array(u*i),f=0,c=0;c<u;++c)for(e=0;e<i;++e)o[f++]=n[e][c];return o}return n}if(null!=t&&null!=r||(null!=r?(t=r,r=$):(t=n,n=r=$)),n=An(n,!0),r=An(r,!0),t=An(t,!0),o=[],zn(r,O))for(;Zn(n,t);n=G(n,r))o.push(n);else if(Xn(r,O))for(;Ln(n,t);n=G(n,r))o.push(n);return o}function Lr(n,r,t){if("horz"===n){if(wn(r)&&wn(t))return r.concat(t);if(bn(r)&&bn(t)&&U(r)===U(t))return r.map(function(n,r){return n.concat(t[r])})}if("vert"===n){if(wn(r)&&wn(t))return r.concat(t);if(bn(r)&&bn(t)&&B(r)===B(t))return r.concat(t)}v("cat")}function Or(t){return bn(t)?S(B(t),U(t),function(n,r){return t[r][n]}):t}function $r(t){return bn(t)?S(B(t),U(t),function(n,r){return y(t[r][n])?Jn(t[r][n]):t[r][n]}):wn(t)?t.map(function(n){return y(n)?Jn(n):n}):y(t)?Jn(t):t}function Cr(t,i){return i=M(i||0),yn(t)?[[t]]:wn(t)?S(t.length,t.length,function(n,r){return i===n-r?t[n]:O}):bn(t)?t.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i===e-t&&n.push(r),n},n)},[]):void v("diag")}function Fr(t,n){var e,i;return yn(t)?t:wn(t)?t.slice().reverse():bn(t)?(e=U(t),i=B(t),1===(n=M(n=null==n?1:n))?S(e,i,function(n,r){return t[e-1-n][r]}):2===n?S(e,i,function(n,r){return t[n][i-1-r]}):t):void v("flip")}function Wr(n,r){var t=jr(n),e=jr(r),n=Mr(n),r=Mr(r),t=Xn(t,e)?-1:zn(t,e)?1:0,e=Xn(n,r)?-1:zn(n,r)?1:0;return t||e}function Ur(n,r){var t=nr(n),e=nr(r),n=rr(n),r=rr(r),t=Xn(t,e)?-1:zn(t,e)?1:0,e=Xn(n,r)?-1:zn(n,r)?1:0;return t||e}function Br(r,t,e,i,n){var u;if(yn(r))return r;if(w(r))return null==i&&(i=vn(r)?Wr:Ur),u=r.map(function(n,r){return{v:n,i:r}}).sort("descend"===e?function(n,r){return i(r.v,n.v)||n.i-r.i}:function(n,r){return i(n.v,r.v)||n.i-r.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(b(r)){if(1===t)return n?(u=W(B(r),function(n){n=j(r,n);return Br(n,t,e,null==i?vn(n)?Wr:Ur:i,!0)}),[S(U(r),B(r),function(n,r){return u[r][0][n]}),S(U(r),B(r),function(n,r){return u[r][1][n]})]):(u=W(B(r),function(n){n=j(r,n);return Br(n,t,e,null==i?vn(n)?Wr:Ur:i,!1)}),S(U(r),B(r),function(n,r){return u[r][n]}));if(2===t)return n?(u=W(U(r),function(n){n=r[n];return Br(n,t,e,null==i?vn(n)?Wr:Ur:i,!0)}),[S(U(r),B(r),function(n,r){return u[n][0][r]}),S(U(r),B(r),function(n,r){return u[n][1][r]})]):(u=W(U(r),function(n){n=r[n];return Br(n,t,e,null==i?vn(n)?Wr:Ur:i,!1)}),S(U(r),B(r),function(n,r){return u[n][r]}))}v("sort")}function Qr(r){return y(r=N(r))?r:w(r)?r.reduce(function(n,r){return n=Xn(r,n)?r:n},X):b(r)?W(B(r),function(n){return Qr(j(r,n))}):s}function Vr(r){return y(r=N(r))?r:w(r)?r.reduce(function(n,r){return n=zn(r,n)?r:n},-X):b(r)?W(B(r),function(n){return Vr(j(r,n))}):s}function Gr(r,n){if(y(r=N(r)))return r;if(w(r))return r.reduce(J,O);if(b(r)){if(1===(n=M(n=null==n?1:n)))return W(B(r),function(n){return Gr(j(r,n))});if(2===n)return W(U(r),function(n){return Gr(r[n])})}return s}function Dr(r,n){if(y(r=N(r)))return r;if(w(r))return r.reduce(Y,$);if(b(r)){if(1===(n=M(n=null==n?1:n)))return W(B(r),function(n){return Dr(j(r,n))});if(2===n)return W(U(r),function(n){return Dr(r[n])})}return s}function Hr(r,e,i){if(i=!0===i,r=N(r),e=N(e),y(r)&&y(e))return Y(r,i?e:Jn(e));if(w(r)&&w(e)){if(r.length===e.length)return r.reduce(function(n,r,t){return J(n,Y(r,i?e[t]:Jn(e[t])))},0)}else if(b(r)&&b(e)&&U(r)===U(e)&&B(r)===B(e))return W(B(r),function(n){return Hr(j(r,n),j(e,n),i)});return 0}function Kr(t,e){var n,r,i,u;if(b(t)){if(b(e))return n=U(t),r=B(t),i=U(e),u=B(e),S(n*i,r*u,function(n,r){return R(t[I.floor(n/i)][I.floor(r/u)],e[n%i][r%u])});if(w(e))return n=U(t),r=B(t),i=1,u=e.length,S(n*i,r*u,function(n,r){return R(t[n][I.floor(r/u)],e[r%u])})}else if(w(t)){if(w(e))return S(t.length,e.length,function(n,r){return R(t[n],e[r])});if(b(e))return n=t.length,i=U(e),u=B(e),S(n*i,(r=1)*u,function(n,r){return R(t[I.floor(n/i)],e[n%i][r%u])})}return R(t,e)}function Jr(r,t,n){if(w(t)){var e,i,u;if(null==r||y(r)){for(null==r&&(r=$),e=0,i=t.length-1,u=O;e<i;++e)u=J(u,Y(r,nn(J(t[e+1],t[e]),en)));return u}if(w(r)&&r.length===t.length){for(e=0,i=r.length-1,u=O;e<i;++e)u=J(u,Y(nr(Dn(r[e+1],r[e])),nn(J(t[e+1],t[e]),en)));return u}}else if(b(t))if(1===(n=M(n=null==n?1:n))){if(null==r||y(r)||w(r)&&r.length===U(t))return W(B(t),function(n){return Jr(r,j(t,n))});if(b(r)&&U(r)===U(t)&&B(r)===B(t))return W(B(t),function(n){return Jr(null==r?null:j(r,n),j(t,n))})}else if(2===n){if(null==r||y(r)||w(r)&&r.length===B(t))return W(U(r),function(n){return Jr(r,t[n])});if(b(r)&&U(r)===U(t)&&B(r)===B(t))return W(U(r),function(n){return Jr(r[n],t[n])})}v("trapz")}function Yr(r,t,e,i){var u;if(y(r))return r;if(w(r)){if("reverse"===(e=null==e?"forward":e))return r.slice().reverse().map(function(n,r){return u=0===r?n:t(u,n)}).reverse();if("forward"===e)return r.map(function(n,r){return u=0===r?n:t(u,n)})}else if(b(r)){if(1===(i=M(i=null==i?1:i)))return W(B(r),function(n){return Yr(j(r,n),t,e,i)});if(2===i)return W(U(r),function(n){return Yr(r[n],t,e,i)})}return!1}function nt(r,t,e,i,u){var o;if(w(r))return W(o=r.length,function(n){return t(r.slice(I.max(0,n-e),I.min(o-1,n+i)+1))});if(b(r)){if(1===(u=M(u=null==u?1:u)))return W(B(r),function(n){return nt(j(r,n),t,e,i,u)});if(2===u)return W(U(r),function(n){return nt(r[n],t,e,i,u)})}return!1}function rt(n){var r,t,e=[].slice.call(arguments,1);return k(e[0])&&(e=N(e[0])),yn(n)?(r=[1,1],e.length?e.map(function(n){return r[M(n)-1]}):r):wn(n)?(r=[1,n.length],e.length?e.map(function(n){return r[M(n)-1]}):r):k(t=n)&&k(t[0])&&k(t[0][0])?(r=[n.length].concat(rt(n[0])),e.length?e.map(function(n){return r[M(n)-1]}):r):bn(n)?(r=[U(n),B(n)],e.length?e.map(function(n){return r[M(n)-1]}):r):[]}function tt(n,i){var u;return w(n)?n.reduce(function(n,r,t){return i(r,t+1,1)&&n.push(t+1),n},[]):b(n)?(u=U(n),n.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i(r,e+1,t+1)&&n.push(e+u*t+1),n},n)},[])):[]}function et(n,r){if(y(n))return r(n,1,1)?1:0;if(w(n)){for(var t=0,e=n.length;t<e;++t)if(!r(n[t],t+1,1))return 0;return 1}if(b(n)){for(var t=0,i=U(n),u=B(n);t<i;++t)for(var o=0;o<u;++o)if(!r(n[t][o],t+1,o+1))return 0;return 1}return 0}function it(n,r){if(y(n))return r(n,1,1)?1:0;if(w(n)){for(var t=0,e=n.length;t<e;++t)if(r(n[t],t+1,1))return 1}else if(b(n))for(var t=0,i=U(n),u=B(n);t<i;++t)for(var o=0;o<u;++o)if(r(n[t][o],t+1,o+1))return 1;return 0}function ut(n,r,t){if(q(n)&&q(r))return n===r?1:0;if(gn(n)&&gn(r))return t?1:0;if(y(n)&&y(r))return P(n,r)?1:0;if(k(n)&&k(r)){if(n.length!==r.length)return 0;for(var e=0,i=n.length;e<i;++e)if(!ut(n[e],r[e],t))return 0;return 1}return 0}function ot(n,r,t){var e;r!==t&&(e=n[r],n[r]=n[t],n[t]=e)}function ft(n,r,t,e,i,u){var o,f=n[0].length;for(null==e&&(e=$),null==i&&(i=$),o=u||0;o<f;++o)n[r][o]=J(Y(i,n[r][o]),Y(e,n[t][o]))}function ct(n,r,t,e,i,u,o){for(var f,c,a=n[0].length,l=0;l<a;++l)f=n[r][l],c=n[t][l],n[r][l]=J(Y(e,f),Y(i,c)),n[t][l]=J(Y(u,f),Y(o,c))}function at(n,r,t,e,i,u,o){for(var f,c,a=n.length,l=0;l<a;++l)f=n[l][r],c=n[l][t],n[l][r]=J(Y(e,f),Y(u,c)),n[l][t]=J(Y(i,f),Y(o,c))}function lt(t,e,i,n,r){var u=U(t),o=B(t);return u&&o?k(e)&&k(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<o}),S(e.length,i.length,function(n,r){return t[e[n]][i[r]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=o),(n=null==n?u-1:n)<0&&(n+=u),(r=null==r?o-1:r)<0&&(r+=o),e=I.max(0,I.min(u-1,e)),n=I.max(0,I.min(u-1,n)),i=I.max(0,I.min(o-1,i)),r=I.max(0,I.min(o-1,r)),e<=n&&i<=r?S(n-e+1,r-i+1,function(n,r){return t[e+n][i+r]}):[]):[]}function st(t,e,n){var i=U(t),u=B(t),o=U(e),f=B(e);return"vert"===(n=n||"horz")?S(i+o,I.max(u,f),function(n,r){return u<=r?n<i?O:e[n-i][r]:f<=r?n<i?t[n][r]:O:(n<i?t[n]:e[n-i])[r]}):S(I.max(i,o),u+f,function(n,r){return i<=n?r<u?O:e[n][r-u]:o<=n?r<u?t[n][r]:O:r<u?t[n][r]:e[n][r-u]})}function ht(n,r,t,e){var i,u,o,f=U(n),c=B(n);if(!1===t||f===c){for(e=Q(e||0),i=I.min(f,c),u=0;u<i;++u){if("lower"===r||"diagonal"===r)for(o=u+1;o<i;++o)if(!Qn(nr(n[u][o]),e))return;if("upper"===r||"diagonal"===r)for(o=0;o<u;++o)if(!Qn(nr(n[u][o]),e))return}if(c<f){for(u=i;u<f;++u)for(o=0;o<c;++o)if(!Qn(nr(n[u][o]),e))return}else if(f<c)for(o=i;o<c;++o)for(u=0;u<f;++u)if(!Qn(nr(n[u][o]),e))return;return 1}}function mt(n,r){var t,e,i;return P(r,O)?(t=$,e=O):P(n,O)?(t=O,P(e=Gn(Jn(r)),O)&&(e=$)):(i=Gn(n),t=nn(n=nr(n),n=sr(n,nr(r))),e=nn(Y(i,Jn(r)),n)),[t,e]}function gt(n,r,t,e,i){var u,o,f,c,a=U(i),l=In(i),s=2===r.length&&y(r[0])?(o=r[0],f=Kn(r[1]),c=r[1],r[0]):2===r.length&&2===r[0].length?(o=r[0][0],f=r[0][1],c=r[1][0],r[1][1]):(o=r[t][t],f=r[t][e],c=r[e][t],r[e][e]);if("right"===n)for(u=0;u<a;++u)l[u][t]=J(Y(o,i[u][t]),Y(c,i[u][e])),l[u][e]=J(Y(f,i[u][t]),Y(s,i[u][e]));else for(u=0;u<a;++u)l[t][u]=J(Y(o,i[t][u]),Y(f,i[e][u])),l[e][u]=J(Y(c,i[t][u]),Y(s,i[e][u]));return l}c.decimal=function(n){"function"==typeof n?(A=n,fn.call(A.prototype,"_valueof")||(A.prototype._valueof=null,A.prototype.$valueOf=function(){return null==this._valueof&&(this._valueof=parseFloat(this.toFixed(9))),this._valueof},A.prototype.sign=function(){return A.sign(this)}),O=A(0),$=A(1),Z=A(-1),tn=A(.5),en=A(2),un=A(10),a=A(I.log(10)),l=A(I.log(2)),ln.eps=A(rn),ln.pi=A(T),ln.e=A(f),ln.realmax=A(h),ln.realmin=A(m),ln.intmax=A(g),ln.intmin=A(d),ln.bitmax=A(z)):(A=null,O=0,Z=-($=1),tn=.5,en=2,un=10,l=I.log(2),a=I.log(10),ln.eps=rn,ln.pi=T,ln.e=f,ln.realmax=h,ln.realmin=m,ln.intmax=g,ln.intmin=d,ln.bitmax=z),_&&(e=new _(O,$),t=new _(ln.e,O)),on.forEach(function(n){n()})},c.is_array=k,c.is_obj=mn,c.is_string=q,c.is_nan=gn,c.is_inf=pn,c.is_number=u,c.is_decimal=dn,c.is_int=p,c.is_complex=o,c.is_real=vn,c.is_scalar=y,c.is_vector=w,c.is_matrix=b,c.array=W,c.matrix=S,c.ndarray=xn,E.rowvec=kn,E.colvec=Sn,c.sca=An,c.vec=N,c.tonumber=_n,c.todecimal=function n(r){return k(r)?r.map(n):y(r)?Q(r):r},c.copy=In,c.apply=En,c.apply2=qn,c.exist=function(n,r){return mn(r)&&q(n)&&fn.call(r,n)?1:0},c.varargout=Nn,c.num2str=jn,c.MAXPRINTSIZE=X,c.tex=function(n){return k(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(Mn).join("\\]\n\\[")+"\\]":k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?"\\["+n.map(Mn).join("\\]\n\\[")+"\\]":"\\["+Mn(n)+"\\]":"\\["+(n=n.length>c.MAXPRINTSIZE?n.slice(0,I.round(c.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-I.round(c.MAXPRINTSIZE/2))):n).map(Mn).join("\\]\n\\[")+"\\]":"":(n=Mn(n)).length&&(n="\\["+n+"\\]"),n},c.str=function(n){return n=k(n)?n.length?n.$scilitevarargout$?n.map(Pn).join("\n\n"):k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?n.map(Pn).join("\n\n"):Pn(n):(n=n.length>c.MAXPRINTSIZE?n.slice(0,I.round(c.MAXPRINTSIZE/2)).concat(":").concat(n.slice(1-I.round(c.MAXPRINTSIZE/2))):n).map(Pn).join("\n"):"":Pn(n)},c.neq=V,c.nlt=Xn,c.ngt=zn,c.nle=Zn,c.nge=Ln,c.nadd=G,c.nsub=D,c.nmul=H,c.ndiv=K,c.npow=On,c.nmod=$n,c.nneg=Cn,c.ninv=Fn,c.eq=P,c.ne=Wn,c.lt=Un,c.gt=Bn,c.le=Qn,c.ge=Vn,c.ssign=Gn,c.sadd=J,c.ssub=Dn,c.smul=Y,c.sdiv=nn,c.spow=Hn,c.sneg=Kn,c.sconj=Jn,c.sinv=Yn,c.sabs=nr,c.sangle=rr,c.add=tr,c.sub=er,c.dotmul=ir,E.times=ir,c.dotdiv=ur,c.dotpow=or,E.power=or,c.mul=R,c.pow=fr,E.mpower=fr,c.neg=cr,c.get=ar,c.set=lr,c.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],Nr.prototype={constructor:Nr,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,option:function(n,r,t,e){var i,u,o,f={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},c={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},a={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},l=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:a[l[(e||0)%l.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=a[l[(e||0)%l.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=f["-"]),n._LineStyle||(n._LineStyle="-"),t=t||0;t<r.length;){if("Color"===r[t])q(i=r[t+1])?fn.call(c,i)?n.Color=a[c[i]]:fn.call(a,i)&&(n.Color=a[i]):w(i)&&3===i.length&&(n.Color=_n(i));else if("LineWidth"===r[t])F(i=r[t+1])&&(n.LineWidth=2*_n(i));else{if("LineStyle"!==r[t]){if(q(r[t])){for(u in o=!1,i=r[t],a)-1<i.indexOf(u)&&(n.Color=a[u],o=!0);for(u in f)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=f[u],o=!0);if(o){t+=1;continue}}break}q(i=r[t+1])&&fn.call(f,i)&&(n._LineStyle=i,n.LineStyle=f[i])}t+=2}return t},parse:function(n,r,t){var e,i,u,o,f,c,a,l=this,s=0,h=0;if("pie"===r)for(;s<n.length;)w(u=N(n[s]))&&l.data.push({y:_n(u)}),s+=1;else if("plot3"===r)for(;s<n.length;)c=f=o=null,w(u=N(n[s]))&&(o=u),w(u=N(n[s+1]))&&(f=u),w(u=N(n[s+2]))&&(c=u,s+=3),o&&f&&c?(s=l.option(a={},n,s,h),l.data.push({x:_n(o),y:_n(f),z:_n(c),style:a}),++h):s+=1;else for(;s<n.length;)if(f=o=null,w(u=N(n[s]))&&(o=u),w(n[s+1])||b(n[s+1])?(f=N(n[s+1]),s+=2):o&&(o=Zr(1,(f=o).length),s+=1),o&&f)if(o=_n(o),s=l.option(a={},n,s,h),b(f))for(e=0,i=B(f);e<i;++e)l.data.push({x:o,y:_n(j(f,e)),style:a}),a=l.option(a,n,s,++h);else l.data.push({x:o,y:_n(f),style:a}),++h;else s+=1;return l}},c.figure=Nr,c.createCanvas=function(n,r){},c.currentCanvas=function(){},E.clc=r,E.disp=r,E.clear=r,E.help=r,E.who=r,E.whos=r,E.exist=r,["floor","ceil","round","sign","abs","exp","log","log10","log2","sqrt","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){L[r]="log"===r?function(n){return u(n)?I.log(n):n.ln()}:"log10"===r?function(n){return u(n)?I.log10(n):n.log(un)}:"log2"===r?function(n){return u(n)?I.log2(n):n.log(en)}:function(n){return u(n)?I[r](n):n[r]()}}),L.atan2=function(n,r){return V(O,r)&&V(O,n)?O:(u(n)&&u(r)?I:A).atan2(n,r)},L.fix=function(n){return Xn(n,O)?L.ceil(n):L.floor(n)},c.realMath=L,(_=function n(r,t,e){var i=this;if(!sn(i,n))return new n(r,t,e);o(r)?(i.re=r.re,i.im=r.im):(t=t||O,"polar"===e?(i._rho=L.abs(r),i.re=H(i._rho,L.cos(t)),i.im=H(i._rho,L.sin(t))):(i.re=r,i.im=t))}).prototype={constructor:_,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var r=this;return null==r._rho&&(r._rho=sr(r.re,r.im)),r._rho},norm2:function(){return null==this._rho2&&(this._rho2=On(this.abs(),en)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=L.atan2(n.im,n.re)),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=V(n.im,O)?L.sign(n.re):n.div(n.abs()),o(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return F(n)?new _(G(this.re,n),this.im):new _(G(this.re,n.re),G(this.im,n.im))},sub:function(n){return F(n)?new _(D(this.re,n),this.im):new _(D(this.re,n.re),D(this.im,n.im))},mul:function(n){var r,t,e,i=this;return F(n)?new _(V(i.re,O)?O:H(i.re,n),V(i.im,O)?O:H(i.im,n)):(r=i.re,e=n.re,i=i.im,t=H(r,G(e,n=n.im)),n=H(n,G(r,i)),e=H(e,D(i,r)),new _(D(t,n),G(t,e)))},div:function(n){var r,t,e,i=this;return F(n)?new _(V(i.re,O)?O:K(i.re,n),V(i.im,O)?O:K(i.im,n)):(t=n.norm2(),r=i.re,e=K(n.re,t),i=i.im,t=H(r,G(e,n=Cn(K(n.im,t)))),n=H(n,G(r,i)),e=H(e,D(i,r)),new _(D(t,n),G(t,e)))},pow:function(n){var r,t;return gn(n)?s:F(n)?new _(On(this.abs(),n),H(this.angle(),n),"polar"):o(n)?(r=this.abs(),t=this.angle(),new _(On(r,n.re),H(n.im,L.log(r)),"polar").mul(new _(L.exp(Cn(H(n.im,t))),H(t,n.re),"polar"))):void 0},neg:function(){return new _(Cn(this.re),Cn(this.im))},conj:function(){return new _(this.re,Cn(this.im))},inv:function(){var n=this.norm2();return new _(K(this.re,n),Cn(K(this.im,n)))},toString:function(){var n=this;return null==n._str&&(n._str=jn(n.re)+(Xn(n.im,O)?" - ":" + ")+jn(L.abs(n.im))+"i"),n._str},valueOf:function(){return M(this.re)}},e=new _(O,$),t=new _(ln.e,O),i={floor:function(n){return new _(L.floor(n.re),L.floor(n.im))},ceil:function(n){return new _(L.ceil(n.re),L.ceil(n.im))},round:function(n){return new _(L.round(n.re),L.round(n.im))},fix:function(n){return new _(L.fix(n.re),L.fix(n.im))},sign:function(n){return n.sign()},sqrt:function(n){return n.pow(new _(tn,O))},exp:function(n){return t.pow(n)},log:function(n){return new _(L.log(n.abs()),n.angle())},log10:function(n){return i.log(n).div(a)},log2:function(n){return i.log(n).div(l)},sin:function(n){return new _(H(L.sin(n.re),L.cosh(n.im)),H(L.cos(n.re),L.sinh(n.im)))},cos:function(n){return new _(H(L.cos(n.re),L.cosh(n.im)),Cn(H(L.sin(n.re),L.sinh(n.im))))},tan:function(n){return i.sin(n).div(i.cos(n))},sinh:function(n){return new _(H(L.sinh(n.re),L.cos(n.im)),H(L.cosh(n.re),L.sin(n.im)))},cosh:function(n){return new _(H(L.cosh(n.re),L.cos(n.im)),H(L.sinh(n.re),L.sin(n.im)))},tanh:function(n){return i.sinh(n).div(i.cosh(n))},asin:function(n){return e.neg().mul(i.log(e.mul(n).add(i.sqrt(_($,O).sub(n.pow(en))))))},acos:function(n){return e.neg().mul(i.log(n.add(e.mul(i.sqrt(_($,O).sub(n.pow(en)))))))},atan:function(n){return e.div(en).mul(i.log(e.add(n).div(e.sub(n))))},asinh:function(n){return i.log(n.add(i.sqrt(n.pow(en).add($))))},acosh:function(n){return i.log(n.add(i.sqrt(n.pow(en).sub($))))},atanh:function(n){return i.log(n.add($).div(n.neg().add($))).div(en)}},c.complexMath=i,E.complex=_,["floor","ceil","round","fix","sign","exp","log","log10","log2","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){E[r]=i[r]?function(n){return En(function(n){return(o(n)?i:L)[r](n)},n,!0)}:function(n){return En(function(n){return L[r](n)},n,!1)}}),E.atan2=function(n,r){return qn(function(n,r){return L.atan2(n,r)},n,r,!1)},E.sqrt=function(n){return En(function(n){return o(n)?i.sqrt(n):zn(O,n)?new _(O,L.sqrt(Cn(n))):L.sqrt(n)},n,!0)},["sqrt","pow","log"].forEach(function(r){E["real"+r]=function(n){return En(function(n){o(n=Rn(n))&&v("real"+r);n=L[r](n);return gn(n)||!vn(n)?v("real"+r):n},n,!0)}}),E.real=jr,E.imag=Mr,E.conj=Pr,E.abs=Rr,E.angle=function(n){return En(rr,n,!0)},E.norm=Tr,E.zeros=function(n,r){return Xr(E.fix(n),y(r)?E.fix(r):r)},E.ones=function(n,r){return n=E.fix(n),r=y(r)?E.fix(r):r,w(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),$)},E.eye=function(n){return zr(E.fix(n),$)},E.rand=function(n,r){return n=E.fix(n),r=y(r)?E.fix(r):r,null==n?Q(I.random()):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),function(){return Q(I.random())}))},E.randi=function(n,r,t){return e=E.fix(n),n=E.fix(r),r=y(t)?E.fix(t):t,e=M(e),null==n&&null==r?Q(I.ceil(I.random()*e)):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),function(){return Q(I.ceil(I.random()*e))}));var e},E.randn=function(n,r){return n=E.fix(n),r=y(r)?E.fix(r):r,null==n?Q(hr()):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),function(){return Q(hr())}))},E.magic=function(n){var t;return n=p(n=An(E.fix(n),!0))?M(n):null,!p(n)||n<=2?1===n?[[$]]:[]:(t=function n(e){var t,i,r,u,o,f,c,a=1&e,l=0==(3&e),s=e*e,h=e-a>>1;if(a)return S(e,e,function(n,r){var t=(n+1+r+1+(e-3)/2)%e;return t<0&&(t+=e),(n=(n+1+2*(r+1)-2)%e)<0&&(n+=e),e*t+n+1});if(l)return i=0,S(e,e,function(n,r){return++i,(n+1&3)>>1==(r+1&3)>>1?s-(i-1):i});if(t=h*h,f=n(h),c=S(e,e,function(n,r){return n<h?r<h?f[n][r]:f[n][r-h]+2*t:r<h?n<h?f[n][r]:f[n-h][r]+3*t:f[n-h][r-h]+t}),1<(i=(h-1)/2))for(r=1;r<=h;++r){for(u=2;u<=i;++u)o=c[r-1][u-1],c[r-1][u-1]=c[r+h-1][u-1],c[r+h-1][u-1]=o;for(u=e-i+2;u<=e;++u)o=c[r-1][u-1],c[r-1][u-1]=c[r+h-1][u-1],c[r+h-1][u-1]=o}for(r=1;r<=i;++r)o=c[r-1][0],c[r-1][0]=c[r+h-1][0],c[r+h-1][0]=o;for(r=i+2;r<=h;++r)o=c[r-1][0],c[r-1][0]=c[r+h-1][0],c[r+h-1][0]=o;return o=c[i][i-1],c[i][i-1]=c[i+h][i-1],c[i+h][i-1]=o,c}(n),S(n,n,function(n,r){return Q(t[n][r])}))},E.pascal=function(n){var t,r;return 1<arguments.length&&v("pascal"),n=p(n=E.fix(An(n,!0)))?M(n):null,!p(n)||n<=0?[]:(t=S(r=n,r,function(n,r,t){return 0===n||0===r?1:t[n-1][r]+t[n][r-1]}),S(n,n,function(n,r){return Q(t[n][r])}))},E.rosser=function(){return[[Q(611),Q(196),Q(-192),Q(407),Q(-8),Q(-52),Q(-49),Q(29)],[Q(196),Q(899),Q(113),Q(-192),Q(-71),Q(-43),Q(-8),Q(-44)],[Q(-192),Q(113),Q(899),Q(196),Q(61),Q(49),Q(8),Q(52)],[Q(407),Q(-192),Q(196),Q(611),Q(8),Q(44),Q(59),Q(-23)],[Q(-8),Q(-71),Q(61),Q(8),Q(411),Q(-599),Q(208),Q(208)],[Q(-52),Q(-43),Q(49),Q(44),Q(-599),Q(411),Q(208),Q(208)],[Q(-49),Q(-8),Q(8),Q(59),Q(208),Q(208),Q(99),Q(-911)],[Q(29),Q(-44),Q(52),Q(-23),Q(208),Q(208),Q(-911),Q(99)]]},E.vander=function(n){return w(n=N(n))||v("vander"),n.map(function(t){return W(n.length,function(n,r){return 0===n?$:Y(r[n-1],t)}).reverse()})},E.toeplitz=function(t,e){return 1===arguments.length?S((e=N(t)).length,e.length,function(n,r){return n===r?e[0]:n<r?e[I.abs(n-r)]:Jn(e[I.abs(n-r)])}):(t=N(t),e=N(e),S(t.length,e.length,function(n,r){return n===r?t[0]:(n<r?e:t)[I.abs(n-r)]}))},E.hankel=function(t,e){var i,n;return 1===arguments.length?(t=N(t),S(i=t.length,i,function(n,r){return i-1-n<r?O:t[(n+r)%i]})):(t=N(t),e=N(e),i=t.length,S(n=e.length,n,function(n,r){return i<=n+r-1?e[n+r-i]:t[(n+r)%i]}))},E.hadamard=function(n){return function n(r){return 1===r?[[$]]:2===r?[[$,$],[$,Z]]:4===r?[[$,$,$,$],[$,Z,$,Z],[$,$,Z,Z],[$,Z,Z,$]]:0==r%4&&(r=n(r/2)).length?Kr([[$,$],[$,Z]],r):[]}(M(n))},E.hilb=function(n){return S(n=M(An(n,!0)),n,function(n,r){return Q(1/(n+1+r+1-1))})},E.invhilb=function(n){n=M(An(n,!0));var r=E.hilb(n);return(n<10?yt:wt)(r)},E.linspace=function(n,r,t){t=M(t=null==t?100:t);for(var e=K(D(r,n),t-1),i=new Array(t),u=0,o=n;u<t;++u,o=G(o,e))i[u]=o;return i},E.logspace=function(n,r,t){t=M(t=null==t?100:t);for(var e=On(K(r,n),1/(t-1)),i=new Array(t),u=0,o=n;u<t;++u,o=Y(o,e))i[u]=o;return i},E.meshgrid=Nn(function(n,r,t){var e=r,i=t;if(null==i&&(i=e),e=N(e),i=N(i),w(e)&&w(i))return[S(i.length,e.length,function(n,r){return e[r]}),S(i.length,e.length,function(n,r){return i[n]})];v("meshgrid")},2),E.ndgrid=Nn(function(n){var r=n,t=[].slice.call(arguments,1);t=t.map(N);for(var e=[],i=W(r,function(n){return(1===t.length?t[0]:t[n]).length}),u=0;u<r;++u)e.push(xn(i,function(n){return(1===t.length?t[0]:t[u])[n[u]]}));return 1===r?e[0]:e}),E.colon=function(n,r,t){return 1===arguments.length&&k(n)?Sn(Zr(n)):Zr.apply(null,arguments)},E.cat=function(n,r,t){var e,i=[];if(1===(n=M(n)))for(i=r,e=2;e<arguments.length;++e)i=Lr("vert",i,arguments[e]);else if(2===n)for(i=r,e=2;e<arguments.length;++e)i=Lr("horz",i,arguments[e]);return i},E.horzcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Lr("horz",t,arguments[e]);return t},E.vertcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Lr("vert",t,arguments[e]);return t},E.transpose=function(n){return Or(n=wn(n)?kn(n):n)},E.ctranspose=function(n){return $r(n=wn(n)?kn(n):n)},E.diag=Cr,E.blkdiag=function(){return t=[].slice.call(arguments),l=a=c=f=o=0,t.forEach(function(n,r){yn(n)&&(t[r]=n=[[n]]),wn(n)&&(t[r]=n=Cr(n)),bn(n)||v("blkdiag"),o+=U(n),f+=B(n)}),e=t[c],i=U(e),u=B(e),S(o,f,function(n,r){return a+i<=n&&(a+=i,l+=u,e=t[++c],i=U(e),u=B(e)),r<l||l+u<=r?O:e[n-a][r-l]});var t,e,i,u,o,f,c,a,l},E.tril=function(t,e){if(bn(t))return e=M(e||0),S(U(t),B(t),function(n,r){return r<=n+e?t[n][r]:O});v("tril")},E.triu=function(t,e){if(bn(t))return e=M(e||0),S(U(t),B(t),function(n,r){return n+e<=r?t[n][r]:O});v("triu")},E.repmat=function(t,e,i){return w(e)&&(i=e[1],e=e[0]),null==i&&(i=e),e=M(e),i=M(i),bn(t=wn(t=yn(t)?[[t]]:t)?[t]:t)?S(e*U(t),i*B(t),function(n,r){return t[n%e][r%i]}):t},E.repelem=function(r,t){var e,i;if(w(r))if(w(t)){if(t.length===r.length)return e=0,i=-1,W(M(Gr(t)),function(n){return n===e&&(e+=M(t[++i])),r[i]})}else if(p(t))return t=M(t),i=-1,W(t*r.length,function(n){return 0==n%t&&++i,r[i]});return r},E.reshape=function(t,e,n){w(e)&&(n=e[1],e=e[0]),e=M(e),n=M(n);var i,r=e*n;return yn(t)&&1===e&&1===n?[[t]]:wn(t)&&t.length===r?S(e,n,function(n,r){return t[n+e*r]}):bn(t)&&U(t)*B(t)==r?(i=U(t),S(e,n,function(n,r){n+=e*r;return t[n%i][I.floor(n/i)]})):t},E.squeeze=function(n){return n},E.rot90=function(n,r){var t=n=wn(n)?kn(n):n,n=r;if(bn(t)){var e=U(t),i=B(t);if((n=I.round(M(n=null==n?1:n))%4)<0&&(n+=4),1===n)return S(i,e,function(n,r){return t[r][i-1-n]});if(3===n)return S(i,e,function(n,r){return t[e-1-r][n]});if(2===n)return S(e,i,function(n,r){return t[e-1-n][i-1-r]})}return t},E.flip=Fr,E.fliplr=function(n){return Fr(n,2)},E.flipud=function(n){return Fr(n,1)},E.sort=Nn(function(n,r,t,e){for(var i=2,u=null;i<arguments.length;){if("ComparisonMethod"===arguments[i]){"real"===arguments[i+1]?u=Wr:"abs"===arguments[i+1]&&(u=Ur),1===i?(t=1,e="ascend"):2===i&&(e="ascend");break}i+=1}return null==e&&(e="ascend"),Br(r,t=M(t=null==t?1:t),e,u,1<n)}),E.min=Qr,E.max=Vr,E.sum=Gr,E.prod=Dr,E.dot=Hr,E.cross=function(n,r){if(n=N(n),r=N(r),!w(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(w(r)&&3===r.length)return[Dn(Y(n[1],r[2]),Y(n[2],r[1])),Dn(Y(n[2],r[0]),Y(n[0],r[2])),Dn(Y(n[0],r[1]),Y(n[1],r[0]))];throw"cross: input 2 not vector of length 3"},E.kron=Kr,E.diff=function(n,r,t){for(null==t&&(t=1),p(r=null==r?1:r)||v("diff"),r=M(r);0<r--;)n=function r(t,n){if(w(t=N(t)))return 1<t.length?W(t.length-1,function(n){return Dn(t[n+1],t[n])}):[];if(b(t)){if(1===(n=M(n=null==n?1:n)))return W(B(t),function(n){return r(j(t,n))});if(2===n)return W(U(t),function(n){return r(t[n])})}v("diff")}(n,t);return n},E.trapz=function(n,r,t){return arguments.length<3&&(k(r)?t=1:k(n)&&!k(r)&&(t=r,r=n,n=null)),Jr(k(n)?N(n):n,N(r),t)},E.cumtrapz=function(n,r,t){return arguments.length<3&&(k(r)?t=1:k(n)&&!k(r)&&(t=r,r=n,n=null)),function r(t,e,i){if(y(e))return e;if(w(e)){if(null==t||y(t))return e.map(function(n,r){return Jr(t,e.slice(0,r+1))});if(w(t)&&t.length===e.length)return e.map(function(n,r){return Jr(t.slice(0,r+1),e.slice(0,r+1))})}else if(b(e))if(1===(i=M(i=null==i?1:i))){if(null==t||y(t)||w(t)&&t.length===U(e))return W(B(e),function(n){return r(t,j(e,n),i)});if(b(t)&&U(t)===U(e)&&B(t)===B(e))return W(B(e),function(n){return r(j(t,n),j(e,n),i)})}else if(2===i){if(null==t||y(t)||w(t)&&t.length===B(e))return W(U(e),function(n){return r(t,e[n],i)});if(b(t)&&U(t)===U(e)&&B(t)===B(e))return W(U(e),function(n){return r(t[n],e[n],i)})}v("cumtrapz")}(k(n)?N(n):n,N(r),t)},E.cumsum=function(n,r,t){n=Yr(N(n),J,t,r);return!1===n&&v("cumsum"),n},E.cumprod=function(n,r,t){n=Yr(N(n),Y,t,r);return!1===n&&v("cumprod"),n},E.cummin=function(n,r,t){n=Yr(N(n),function(n,r){return Un(n,r)?n:r},t,r);return!1===n&&v("cummin"),n},E.cummax=function(n,r,t){n=Yr(N(n),function(n,r){return Bn(n,r)?n:r},t,r);return!1===n&&v("cummax"),n},E.movsum=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),Gr,e,i,t))&&v("movsum"),r},E.movprod=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),Dr,e,i,t))&&v("movprod"),r},E.movmean=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),$t,e,i,t))&&v("movmean"),r},E.movmin=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),Qr,e,i,t))&&v("movmin"),r},E.movmax=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),Vr,e,i,t))&&v("movmax"),r},E.bitshift=function(n,r){return En(function(n){return p(n)?Xn(r,O)?M(n)>>-M(r):M(n)<<M(r):n},n,!0)},E.bitand=function t(r,e){if(p(r)){if(p(e))return M(r)&M(e);if(k(e))return e.map(function(n){return t(r,n)})}else if(k(r)){if(p(e))return r.map(function(n){return t(n,e)});if(k(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.bitor=function t(r,e){if(p(r)){if(p(e))return M(r)|M(e);if(k(e))return e.map(function(n){return t(r,n)})}else if(k(r)){if(p(e))return r.map(function(n){return t(n,e)});if(k(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.bitxor=function t(r,e){if(p(r)){if(p(e))return M(r)^M(e);if(k(e))return e.map(function(n){return t(r,n)})}else if(k(r)){if(p(e))return r.map(function(n){return t(n,e)});if(k(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.size=function(n){return Nn(rt.apply(null,[].slice.call(arguments)))},E.length=function(n){return k(n)?n.length?I.max.apply(null,rt(n)):0:null==n?0:1},E.ndims=function(n){return 2+rt(n).slice(2).filter(function(n){return 1<n}).length},E.numel=function(n){return Dr(rt(n))},E.rows=function(n){return rt(n,1)},E.columns=function(n){return rt(n,2)},E.sub2ind=function(n,r,t){return w(r)&&(t=r[1],r=r[0]),r=M(r),t=M(t),1===n.length?r:r-1+M(n[0])*(t-1)+1},E.ind2sub=function(n,r){return r=M(r),1===n.length?[r,1]:[(r-1)%M(n[0])+1,I.floor((r-1)/M(n[0]))+1]},c.find=tt,E.find=function(n){return tt(n,function(n){return!P(n,O)})},c.all=et,E.all=function(n){return et(n,function(n){return!P(n,O)})},c.any=it,E.any=function(n){return it(n,function(n){return!P(n,O)})},E.isequal=function(){var n=arguments.length,r=0,t=1;for(1<n&&(t=ut(arguments[0],arguments[1],!1),r=2);t&&r<n;)t=ut(arguments[0],arguments[r++],!1);return t},E.isequaln=function(){var n=arguments.length,r=0,t=1;for(1<n&&(t=ut(arguments[0],arguments[1],!0),r=2);t&&r<n;)t=ut(arguments[0],arguments[r++],!0);return t},E.isnan=function n(r){return k(r)?r.map(n):gn(r)||o(r)&&(gn(r.re)||gn(r.im))?1:0},E.isinf=function n(r){return k(r)?r.map(n):F(r)?pn(r)?1:0:o(r)&&(pn(r.re)||pn(r.im))?1:0},E.isfinite=function n(r){return k(r)?r.map(n):F(r)?pn(r)?0:1:!o(r)||pn(r.re)||pn(r.im)?0:1},E.isreal=function(n){return et(n,vn)},E.isempty=function(n){return k(n)?k(n[0])?n[0].length?0:1:n.length?0:1:0};var pt=function(r,n,t,e){var i,u,o,f,c,a,l,s,h,m,g,p,d,v,y=U(r),w=B(r),b=w,x=0;if(e=Q(e||0),ht(r,"upper",!1,e))return n?[r,W(b,function(n){return[n,n]}).filter(function(n){return n[0]<y&&n[1]<w&&!Qn(nr(r[n[0]][n[1]]),e)}),Dr(Cr(r)),zr(y)]:r;for(k(t)&&(b=I.min(b,t[1])),d=st(r,zr(y)),i=new Array(b),u=$,v=function(n,r){r=r||0;for(var t=x-1;0<=t;--t)if(n===i[t][r])return t;return-1},o=l=0;o<y&&!(b<=l);++o){for(f=o;Qn(nr(d[f][l]),e);)if(y<=++f&&(f=o,b<=++l)){l=-1;break}if(-1===l)break;for(s=-1,m=null,p=0,f=c=f;f<y;++f)Qn(g=nr(d[f][l]),e)?++p:null!=m&&!Un(g,m)||(m=g,s=f);for(;-1!==s;){if(y-c===p+1){for(o!==s&&(ot(d,o,s),u=Kn(u)),Un(d[o][l],O)&&(ft(d,o,o,O,Z,l),u=Kn(u)),f=s,c=o;0<=f&&-1!==(a=v(f));)f=c-=x-a;i[x++]=[f,l],u=o<b?Y(u,d[o][o]):O;break}for(p=0,h=s,f=c;f<y;++f)f!==h&&(ft(d,f,h,Kn(nn(d[f][l],d[h][l])),$,l),Qn(g=nr(d[f][l]),e)?++p:Un(g,m)&&(m=g,s=f))}++l}return x<b&&(u=O),t=lt(d,0,w,y-1,y+w-1),d=lt(d,0,0,y-1,w-1),i.length>x&&(i.length=x),n?[d,i,u,t]:d};function dt(n,r,t,e){var i,u,o,f,c,a,l=U(n),s=B(n),h=s;for(e=Q(e||0),k(t)&&I.min(h,t[1]),a=st((h=pt(n,!0,t,e))[0],h[3]),i=h[1],n=h[2],u=i.length,f=0;f<u;++f)for(o=i[f][1],c=0;c<f;++c)Qn(nr(a[c][o]),e)||(ft(a,c,f,Kn(a[c][o]),a[f][o]),P(a[c][i[c][1]],$))||ft(a,c,c,O,Yn(a[c][i[c][1]]),i[c][1]);return P(a[u-1][i[u-1][1]],$)||ft(a,u-1,u-1,O,Yn(a[u-1][i[u-1][1]]),i[u-1][1]),t=lt(a,0,s,l-1,l+s-1),a=lt(a,0,0,l-1,s-1),r?[a,i,n,t]:a}function vt(n,r,t){if(y(n)&&y(r))return nn(r,n);if(!b(n))return[];if(!w(r=N(r))&&!b(r))return[];var e,i=B(n);if(U(n)!==i)return[];if(e=w(r)?(h=r.length,1):(h=U(r),B(r)),i!==h)return[];var u,o,f,c,a,l,s,h=pt(Or(n),!0);if(h[1].length!==i)return[];if(u=Or(h[3]),o=Or(h[0]),w(r)){for(f=W(i,O),c=0;c<i;++c){if(P(o[c][c],O))return[];for(s=O,a=0;a<c;++a)s=J(s,Y(o[c][a],f[a]));f[c]=nn(Dn(r[c],s),o[c][c])}return W(i,function(r){return W(i,function(n){return Y(f[n],u[r][n])}).reduce(J,O)})}for(f=Xr(i,e),c=0;c<i;++c){if(P(o[c][c],O))return[];for(l=0;l<e;++l){for(s=O,a=0;a<c;++a)s=J(s,Y(o[c][a],f[a][l]));f[c][l]=nn(Dn(r[c][l],s),o[c][c])}}return S(i,e,function(r,t){return W(i,function(n){return Y(f[n][t],u[r][n])}).reduce(J,O)})}function yt(n){var r,t,e;return y(n)?Yn(n):b(n)&&U(n)===B(n)?1===(t=r=U(n))?[[Yn(n[0][0])]]:P((e=dt(n,!0))[0][r-1][t-1],O)?[]:e[3].map(function(n,r){return n.map(function(n){return nn(n,e[0][r][r])})}):[]}function wt(n){if(U(n)!==B(n))return[];for(var r=zr(U(n)),t=r,e=er(r,n),i=0;i<4;++i)t=R(t,tr(r,e)),i+1<4&&(e=R(e,e));return t}function bt(n,r){var t,e,i=U(n),u=B(n);return r=r||dt(n,!0),e=(t=r[1]).length,[lt(n,W(i,function(n){return n}),W(e,function(n){return t[n][1]})),lt(r[0],0,0,e-1,u-1).map(function(t,e){return t.map(function(n,r){for(r=e;r+1<u&&P(t[r],O);)++r;return nn(n,t[r])})})]}function xt(t,n){var r,e,i,u,o;return y(t)?Yn(t):b(t)?(r=U(t),i=B(t),function t(n,e){return y(e)?y(n)?P(n,e):n.filter(function(n){return t(n,e)}).length===n.length:!!k(e)&&(y(n)?t(e,n):n.length===e.length&&n.filter(function(n,r){return t(n,e[r])}).length===e.length)}(t,0)?Or(t):1===r&&1===i?[[Yn(t[0][0])]]:1===r||1===i?(o=t.reduce(function(n,r){return J(n,Y(r,Jn(r)))},O),S(i,r,function(n,r){return nn(Jn(t[r][n]),o)})):(n=(e=dt(t,!0,null,n||0))[1].length)===i?r===i?e[3].map(function(n,r){return n.map(function(n){return nn(n,e[0][r][r])})}):R(yt(R(u=$r(t),t)),u):n===r?R(u=$r(t),yt(R(t,u))):(i=bt(t,e),o=R(yt(R(u=$r(o=i[0]),o)),u),n=R(u=$r(n=i[1]),yt(R(n,u))),R(n,o))):[]}function kt(e){return y(e)?e:b(e)?e.reduce(function(n,r,t){return J(n,t<r.length?e[t][t]:0)},0):void v("trace")}function St(e,n,r){r=Q(r||0);var t=U(e);return t!==B(e)?0:1===t?e[0][0]:ht(e,"lower",!0,r)||ht(e,"upper",!0,r)?e.reduce(function(n,r,t){return Y(n,e[t][t])},1):!0===n?function n(r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d;function v(t,n,e,i){return S(n-1,n-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})}if(1===t)f=r[0][0];else if(2===t)c=r[0][0],a=r[0][1],l=r[1][0],f=Dn(Y(c,s=r[1][1]),Y(a,l));else if(3===t)c=r[0][0],a=r[0][1],l=r[0][2],s=r[1][0],h=r[1][1],m=r[1][2],g=r[2][0],p=r[2][1],d=r[2][2],f=Dn(Dn(Dn(J(J(Y(Y(c,h),d),Y(Y(a,m),g)),Y(Y(l,s),p)),Y(Y(l,h),g)),Y(Y(a,s),d)),Y(Y(c,m),p));else{for(e=u=i=0;e<t;++e)P(r[0][e],O)&&++i,P(r[e][0],O)&&++u;if(o=$,f=O,i<u)for(e=0;e<t;++e)P(r[e][0],O)||(f=J(f,Y(r[e][0],Y(o,n(v(r,t,e,0),t-1))))),o=$===o?Z:$;else for(e=0;e<t;++e)P(r[0][e],O)||(f=J(f,Y(r[0][e],Y(o,n(v(r,t,0,e),t-1))))),o=$===o?Z:$}return f}(e,t):pt(e,!0,null,r)[2]}function At(n){b(n)&&U(n)===B(n)||v("charpoly");var e,r=U(n),i=(B(n),r),u=new Array(i+1),t=Xr(i,i);for(u[i]=$,e=1;e<=i;++e)t=R(n,t).map(function(n,t){return n.map(function(n,r){return t===r?J(n,u[i-e+1]):n})}),u[i-e]=nn(kt(R(n,t)),-e);return Rn(u.reverse())}function _t(o){return S(B(o),U(o),function(n,r){return e=r,i=n,r=!0,n=U(t=o),u=B(t),n!==u?null:n<=1?0:(i=+(i||0),(e=+(e||0))<0||n<=e||i<0||u<=i?null:(n=St(S(n-1,u-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})),!0===r&&e+i&1?Kn(n):n));var t,e,i,u})}function It(n,r,t){null==r&&(r=2);for(var e,i,u,o,f,c,a=U(n),l=In(n),s=t?W(a,$):null,h=Q(1e-10),m=1;m<=1e4;++m){for(e=c=0;e<a;++e)if((o=j(l,e).map(Q)).splice(e,1),(f=l[e].map(Q)).splice(e,1),o=Tr(o,r),V(f=Tr(f,r),O)||V(o,O))++c;else{for(u=L.sqrt(K(f,o)),Zn(L.abs(D(u,$)),h)&&++c,t&&(s[e]=H(u,s[e])),i=0;i<a;++i)l[i][e]=Y(l[i][e],u);for(i=0;i<a;++i)l[e][i]=nn(l[e][i],u)}if(a===c)break}return t?[s,l]:l}function Et(n,r,t){var e=U(n);if(null==r){var i,u,o=t?zr(e):null,f=n;for(c=1;c<=e-2;++c)for(a=e;c+2<=a;--a)u=[Jn((i=mt(f[a-1-1][c-1],f[a-1][c-1]))[0]),Kn(Jn(i[1]))],t&&(o=gt("right",i,a-1-1,a-1,o)),f=gt("left",u,a-1-1,a-1,gt("right",i,a-1-1,a-1,f));return t?[o,f]:f}var c,a,l,s,h=$r(o=qr_givens(r,!0)[0]),m=zr(e),g=R(h,n),p=R(h,r);for(c=1;c<=e-2;++c)for(a=e;c+2<=a;--a)l=[Jn((s=mt(g[a-1-1][c-1],g[a-1][c-1]))[0]),Kn(Jn(s[1]))],o=gt("right",s,a-1-1,a-1,o),g=gt("left",l,a-1-1,a-1,g),p=gt("left",l,a-1-1,a-1,p),m=gt("right",s=mt(Kn(p[a-1][a-1]),p[a-1][a-1-1]),a-1-1,a-1,m),g=gt("right",s,a-1-1,a-1,g),p=gt("right",s,a-1-1,a-1,p);return[g,p,o,m]}function qt(n,r){for(var t,e,i,u=U(n),o=(B(n),"upper"===r),f=Xr(u,u),c=zr(u),a=0;a<u;++a){for(t=0;t<a;++t){for(e=0,i=O;e<t;++e)i=J(i,Y(Y(c[a][e],Jn(c[t][e])),f[e][e]));c[a][t]=nn(Dn(o?n[t][a]:n[a][t],i),f[t][t])}for(e=0,i=O;e<a;++e)i=J(i,Y(Y(c[a][e],Jn(c[a][e])),f[e][e]));if(f[a][a]=Dn(n[a][a],i),Qn(f[a][a],O))return[]}return[c,f]}function Nt(n,r,t){var e,i,u,o,f,c,a,l,s,h=U(n),m=B(n),g=r?zr(h):null,p=n;if(t)for(e=W(m,function(n){return n}),o=W(m,function(n){return Tr(j(p,n),en)}),a=0;a<m;++a){for(f=o[i=a],c=a+1;c<m;++c)zn(o[c],f)&&(f=o[i=c]);if(V(f,O))break;if(a!==i)for(u=o[a],o[a]=o[i],o[i]=u,u=e[a],e[a]=e[i],e[i]=u,c=0;c<h;++c)u=p[c][a],p[c][a]=p[c][i],p[c][i]=u;for(c=h-1;a+1<=c;--c)s=[Jn((l=mt(p[c-1][a],p[c][a]))[0]),Kn(Jn(l[1]))],p=gt("left",s,c-1,c,p),r&&(g=gt("right",l,c-1,c,g));for(c=a+1;c<m;++c)o[c]=D(o[c],On(nr(p[a][c]),en))}else for(a=0;a<m;++a)for(c=h-1;a+1<=c;--c)s=[Jn((l=mt(p[c-1][a],p[c][a]))[0]),Kn(Jn(l[1]))],p=gt("left",s,c-1,c,p),r&&(g=gt("right",l,c-1,c,g));return r&&t?[g,p,S(m,m,function(n,r){return n===e[r]?$:O})]:r?[g,p]:p}function jt(n){var r,t,e,i,u=Q(1e-10),o=U(n),f=new Array(o),c=new Array(o),a=W(o,0);for(n=In(n),i=0;i<o;++i)r=(e=function(n,r,t,e){var i,u,o,f,c,a,l=O;if(!0===e){for(f=ur(f=W(r,function(){return new _(Q(I.random()||.1),O)}),Tr(f)),i=1;i<=100&&(o=l,l=Hr(f=N(R(n,c=f)),c),f=ur(f,f[0].sign()),f=ur(f,Tr(f)),!Zn(L.abs(D(jr(l),jr(o))),t)||!Zn(L.abs(D(Mr(l),Mr(o))),t));++i);return l}for(u=$r(n),f=ur(f=W(r,function(){return new _(Q(I.random()||.1),O)}),Tr(f)),a=ur(a=W(r,function(){return new _(Q(I.random()||.1),O)}),Tr(a)),i=1;i<=100&&(o=l,f=N(R(n,c=f)),a=N(R(u,a)),l=Hr(f,c),f=ur(f,f[0].sign()),a=ur(a,a[0].sign()),f=ur(f,Tr(f)),a=ur(a,Tr(a)),!Zn(L.abs(D(jr(l),jr(o))),t)||!Zn(L.abs(D(Mr(l),Mr(o))),t));++i);return[l,f,a]}(n,o,u))[0],t=e[1],e=e[2],n=er(n,R(R(nn(a[i]=r,Hr(f[i]=t,c[i]=e,!0)),t),e));return[Rn(Or(f)),Rn(a),Rn(Or(c))]}function Mt(n,r,t,e){r=Q(r=F(r)?r:rn);var i,u=B(n),o=U(n);if(o<u)return i=Mt(Or(n),r,e,t),t&&e?[Or(i[2]),i[1],Or(i[0])]:t||e?[Or(i[0]),i[1]]:i;var f,c,a,l,s,h,m,g,p,d,v,y,w,b,x,k,S,A,_,z,I,E=t?o:0,q=e?u:0,N=In(n),j=E?Xr(o,E):null,M=W(u,O),P=q?Xr(u,q):null,Z=K(ln.realmin,r),R=new Array(u),T=new Array(u),X=new Array(u);for(T[0]=O,b=1;b<=u;++b){for(S=b+1,a=O,y=b;y<=o;++y)a=G(a,G(On(jr(N[y-1][b-1]),en),On(Mr(N[y-1][b-1]),en)));if(R[b-1]=O,zn(a,Z)&&(a=L.sqrt(a),R[b-1]=a,s=V(l=nr(N[b-1][b-1]),O)?$:nn(N[b-1][b-1],l),N[b-1][b-1]=Y(s,G(a,l)),b!==u+0)){for(w=S;w<=u+0;++w){for(s=O,y=b;y<=o;++y)s=J(s,Y(Jn(N[y-1][b-1]),N[y-1][w-1]));for(s=nn(s,H(a,G(a,l))),y=b;y<=o;++y)N[y-1][w-1]=Dn(N[y-1][w-1],Y(s,N[y-1][b-1]))}for(s=Kn(Gn(Jn(N[b-1][b-1]))),w=S;w<=u+0;++w)N[b-1][w-1]=Y(s,N[b-1][w-1])}if(b===u)break;for(a=O,w=S;w<=u;++w)a=G(a,G(On(jr(N[b-1][w-1]),en),On(Mr(N[b-1][w-1]),en)));if(T[S-1]=O,zn(a,Z)){for(a=L.sqrt(a),T[S-1]=a,s=V(l=nr(N[b-1][S-1]),O)?$:nn(N[b-1][S-1],l),N[b-1][S-1]=Y(s,G(a,l)),y=S;y<=o;++y){for(s=O,w=S;w<=u;++w)s=J(s,Y(Jn(N[b-1][w-1]),N[y-1][w-1]));for(s=nn(s,H(a,G(a,l))),w=S;w<=u;++w)N[y-1][w-1]=Dn(N[y-1][w-1],Y(s,N[b-1][w-1]))}for(s=Kn(Gn(Jn(N[b-1][S-1]))),y=S;y<=o;++y)N[y-1][S-1]=Y(N[y-1][S-1],s)}}for(h=O,b=1;b<=u;++b)M[b-1]=R[b-1],X[b-1]=T[b-1],h=Vr([h,G(M[b-1],X[b-1])]);if(h=H(r,h),0<E)for(w=1;w<=E;++w)j[w-1][w-1]=$;if(0<q)for(w=1;w<=q;++w)P[w-1][w-1]=$;for(k=1;k<=u;++k){for(b=u+1-k,z=1;z<=50;++z){for(I=!0,_=1;_<=b;++_){if(Zn(L.abs(X[(x=b+1-_)-1]),h)){I=!1;break}if(Zn(L.abs(M[x-1-1]),h)){I=!0;break}}if(I)for(v=O,d=$,A=x-1,y=x;y<=b&&(g=H(d,X[y-1]),X[y-1]=H(v,X[y-1]),!Zn(L.abs(g),h));++b)if(l=sr(g,p=M[y-1]),v=K(p,M[y-1]=l),d=Cn(K(g,l)),0<E)for(w=1;w<=u;++w)f=jr(j[w-1][A-1]),c=jr(j[w-1][y-1]),j[w-1][A-1]=G(H(f,v),H(c,d)),j[w-1][y-1]=D(H(c,v),H(f,d));if(l=M[b-1],x===b)break;for(f=M[x-1],c=M[b-1-1],m=X[b-1-1],p=X[b-1],m=sr(g=K(G(H(D(c,l),G(c,l)),H(D(m,p),G(m,p))),H(en,H(p,c))),$),Xn(g,O)&&(m=Cn(m)),g=K(G(H(D(f,l),G(f,l)),H(D(K(c,G(g,m)),p),p)),f),d=v=$,y=A=x+1;A<=b;++A){if(m=X[y-1],c=M[y-1],p=H(d,m),m=H(v,m),l=sr(p,g),v=K(g,X[y-1-1]=l),d=K(p,l),g=G(H(f,v),H(m,d)),m=D(H(m,v),H(f,d)),p=H(c,d),c=H(c,v),0<q)for(w=1;w<=u;++w)f=jr(P[w-1][y-1-1]),l=jr(P[w-1][y-1]),P[w-1][y-1-1]=G(H(f,v),H(l,d)),P[w-1][y-1]=D(H(l,v),H(f,d));if(l=sr(p,g),v=K(g,M[y-1-1]=l),d=K(p,l),g=G(H(v,m),H(d,c)),f=D(H(v,c),H(d,m)),0<E)for(w=1;w<=u;++w)c=jr(j[w-1][y-1-1]),l=jr(j[w-1][y-1]),j[w-1][y-1-1]=G(H(c,v),H(l,d)),j[w-1][y-1]=D(H(l,v),H(c,d))}X[x-1]=O,X[b-1]=g,M[b-1]=f}if(Xn(l,O)&&(M[b-1]=Cn(l),0<q))for(w=1;w<=u;++w)P[w-1][b-1]=Kn(P[w-1][b-1])}for(b=1;b<=u;++b){for(m=-1,y=w=b;y<=u;++y)zn(M[y-1],m)&&(m=M[y-1],w=y);if(w!==b){if(M[w-1]=M[b-1],M[b-1]=m,0<q)for(y=1;y<=u;++y)s=P[y-1][w-1],P[y-1][w-1]=P[y-1][b-1],P[y-1][b-1]=s;if(0<E)for(y=1;y<=u;++y)s=j[y-1][w-1],j[y-1][w-1]=j[y-1][b-1],j[y-1][b-1]=s}}if(0<E)for(k=1;k<=u;++k)if(!V(R[(b=u+1-k)-1],O)){for(s=Kn(Gn(N[b-1][b-1])),w=1;w<=E;++w)j[b-1][w-1]=Y(s,j[b-1][w-1]);for(w=1;w<=E;++w){for(s=O,y=b;y<=o;++y)s=J(s,Y(Jn(N[y-1][b-1]),j[y-1][w-1]));for(s=nn(s,Y(nr(N[b-1][b-1]),R[b-1])),y=b;y<=o;++y)j[y-1][w-1]=Dn(j[y-1][w-1],Y(s,N[y-1][b-1]))}}if(0<q&&2<=u)for(k=2;k<=u;++k)if(!V(T[(S=(b=u+1-k)+1)-1],O)){for(s=Kn(Gn(Jn(N[b-1][S-1]))),w=1;w<=q;++w)P[S-1][w-1]=Y(s,P[S-1][w-1]);for(w=1;w<=q;++w){for(s=O,y=S;y<=u;++y)s=J(s,Y(N[b-1][y-1],P[y-1][w-1]));for(s=nn(s,Y(nr(N[b-1][S-1]),T[S-1])),y=S;y<=u;++y)P[y-1][w-1]=Dn(P[y-1][w-1],Y(s,Jn(N[b-1][y-1])))}}return t&&e?[Rn(j),M,Rn(P)]:t||e?[Rn(j||P),M]:M}E.planerot=Nn(function(n,r){w(r=N(r))&&2===r.length||v("planerot");var t=mt(r[0],r[1]),t=[[t[0],t[1]],[Kn(t[1]),t[0]]];return 1<n?[t,R(t,Sn(r))]:t}),E.ref=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)||v("ref");r=pt(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),E.rref=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)||v("rref");r=dt(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),E.linsolve=vt,E.null=function(n,r){return r=r,i=B(t=n),u=(t=dt(n,!0,null,r))[0],o=t[1],f=o.length,r=o.reduce(function(n,r){for(var t=0;t<n.length&&r[1]>n[t];)++t;return t<n.length&&r[1]===n[t]&&n.splice(t,1),n},W(i,function(n){return n})),c=f?o.reduce(function(n,r,t){return Y(n,u[t][r[1]])},$):$,r.map(function(r){for(var n,t=W(i,function(n){return n===r?c:O}),e=0;e<f;++e)(n=o[e][1])<=r&&(t[n]=Dn(t[n],Y(nn(c,u[e][n]),u[e][r])));return t});var t,i,u,o,f,c},E.rowspace=function(n,r){return pt(t=n,!0,null,r)[1].map(function(n){return t[n[0]]});var t},E.colspace=function(n,r){return pt(t=n,!0,null,r)[1].map(function(r){return W(t.length,function(n){return t[n][r[1]]})});var t},E.rank=function(n){return b(n=y(n)?[[n]]:n)||v("rank"),pt(n,!0)[1].length},E.inv=function(n){return y(n)&&(x=[[n]]),b(n)||v("inv"),yt(n)},E.ainv=function(n){return y(n)&&(x=[[n]]),b(n)||v("ainv"),wt(n)},E.rankf=function(n){return b(n=y(n)?[[n]]:n)||v("rankf"),bt(n)},E.pinv=function(n,r){return b(n=y(n)?[[n]]:n)||v("pinv"),xt(n,r)},E.cond=function(n,r){b(n=y(n)?[[n]]:n)||v("cond");var t=yt(n);return t&&t.length?Y(Tr(n,r=null==r?2:r),Tr(t,r)):X},E.trace=kt,E.det=function(n){return b(n=y(n)?[[n]]:n)||v("det"),St(n,!1,1e-15)},E.charpoly=At,E.adjoint=function(n){return b(n)&&U(n)===B(n)||v("adjoint"),_t(n)},E.balance=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)&&U(r)===B(r)||v("balance");var e=It(r,2,1<n);return 2<n?[e[0],W(U(r),function(n){return n+1}),e[1]]:1<n?[Cr(e[0]),e[1]]:e}),E.hess=Nn(function(n,r,t){return b(r=y(r)?[[r]]:r)&&U(r)===B(r)||v("hess"),2<arguments.legnth?(b(t=y(t)?[[t]]:t)&&U(t)===B(t)||v("hess"),Et(r,t)):Et(r,null,1<n)}),E.ldl=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)&&U(r)===B(r)||v("ldl");t=qt(r,t);return t.length||v("ldl"),2<n&&t.push(zr(U(r))),t},2),E.chol=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)&&U(r)===B(r)||v("chol");r=qt(r,t=t||"upper");return r.length||v("chol"),"lower"===t?R(r[0],E.sqrt(r[1])):$r(R(r[0],E.sqrt(r[1])))}),E.lu=Nn(function(n,r){b(r=y(r)?[[r]]:r)||v("lu");var t,r=function(n,r){var t,e,i,u,o,f,c,a,l,s,h,m,g,p,d;for(r=Q(r||0),t=U(n),e=B(n),d=!1,o=In(n),u=zr(t),f=W(t,O),i=zr(t),c=$,a=0;a<t-1;++a){if(Qn(nr(o[a][a]),r)){for(h=a+1,m=!0;h<t&&m;)Qn(nr(o[h][a]),r)?++h:m=!1;if(t<=h){d=!0;break}ot(o,a,h),ot(i,a,h)}for(g=o[a][a],u[a][a]=g,f[a]=Y(c,g),l=a+1;l<t;++l){for(p=o[l][a],u[l][a]=p,s=a+1;s<e;++s)o[l][s]=nn(Dn(Y(g,o[l][s]),Y(o[a][s],p)),c);o[l][a]=O}c=o[a][a]}return d?[]:(f[t-1]=c,[f,u,o,i])}(r);if(r.length)return t=Cr(r[0].map(Yn)),2<n?[R(r[1],t),r[2],r[3]]:[R(Or(r[3]),R(r[1],t)),r[2]];throw"lu: defficient matrix"},2),E.qr=Nn(function(n,r){return b(r=y(r)?[[r]]:r)||v("qr"),Nt(r,1<n,2<n)}),E.schur=Nn(function(n,r){b(r=y(r)?[[r]]:r)&&U(r)===B(r)||v("schur");var t,e,i,u,o,f=1<n,c=U(r),a=Q(1e-8),l=Et(r,null,f);for(f&&(t=l[0],l=l[1]),i=c-1;0<i;--i)for(o=1;o<=100&&(l=tr(R((e=Nt(er(l,u=zr(c,l[i][i])),null,!0))[1],e[0]),u),f&&(t=R(t,e[0])),!Zn(nr(l[i][i-1]),a));++o);return f?[t,l]:l}),E.eig=Nn(function(n,r,t){b(r)&&U(r)===B(r)||v("eig"),b(t)&&v("eig");var e=null;return"nobalance"!==t&&(e=It(r,2,!0),r=e[1],e=e[0]),1<n?(t=jt(r),[e?R(Cr(e),t[0]):t[0],Cr(t[1]),e?R(Cr(e.map(Fn)),t[2]):t[2]]):Rn((ht(r,"upper",!0,1e-15)||ht(r,"lower",!0,1e-15)?W(U(r),function(n){return r[n][n]}):ae(At(r))).sort(function(n,r){return nr(r)-nr(n)}))}),E.svd=Nn(function(n,r,t){return b(r=y(r)?[[r]]:r)||v("svd"),1<n?[(n=Mt(r,t,1<n,2<n))[0],Cr(n[1]),n[2]]:Mt(r,t,!1,!1)});var Pt=function(n,r,t){for(var e,i,u,o,f,c,a,l=U(n),s=B(n),h=s,m=O,g=t?st(n,zr(l)):n,p=0,d=0;d<l&&!(h<=p);++d){for(e=d;Qn(nr(g[e][p]),m);)if(l<=++e&&(e=d,h<=++p)){p=-1;break}if(-1===p)break;for(u=-1,f=null,a=0,e=i=e;e<l;++e)Qn(c=nr(g[e][p]),m)?++a:null!=f&&!Un(c,f)||(f=c,u=e);for(;-1!==u;){if(l-i===a+1){if(d!==u&&ot(g,d,u),Un(g[d][p],O)&&ft(g,d,d,O,Z,p),r)for(c=g[d][p],e=0;e<d;++e)Vn(nr(g[e][p]),c)&&ft(g,e,d,Kn(E.floor(nn(g[e][p],c))),$,p),Un(g[e][p],O)&&ft(g,e,d,$,$,p);e=u,i=d;break}for(a=0,o=u,e=i;e<l;++e)e!==o&&(ft(g,e,o,Kn(E.floor(nn(g[e][p],g[o][p]))),$,p),Qn(c=nr(g[e][p]),m)?++a:Un(c,f)&&(f=c,u=e))}++p}return t?[lt(g,0,s,l-1,l+s-1),lt(g,0,0,l-1,s-1)]:g};E.hermiteForm=Nn(function(n,r){return b(r=y(r)?[[r]]:r)||v("hermiteForm"),Pt(E.round(E.real(r)),!0,1<n)}),E.smithForm=Nn(function(n,r){b(r=y(r)?[[r]]:r)||v("smithForm");r=function(n,r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d,v,y,w,b,x,k=U(n),S=B(n),A=I.min(k,S);for(r&&(e=zr(k)),t&&(i=zr(S)),u=-1,o=0;o<k;++o){for(s=!1,f=u+1;f<S;++f){for(m=0;m<k&&V(n[m][f],O);++m);if(m<k){s=!0;break}}if(!s)break;if(V(n[o][f],O)){for(a=0;a<k&&V(n[a][f],O);++a);ct(n,o,a,O,$,$,O),r&&at(e,o,a,O,$,$,O)}for(at(n,f,o,O,$,$,O),t&&ct(i,f,o,O,$,$,O),f=o,c=!0;c;){for(c=!1,a=o+1;a<k;++a)V(n[a][f],O)||(c=!0,V(O,$n(n[a][f],n[o][f]))||(p=(g=me([n[o][f],n[a][f]]))[1],d=g[2],v=K(n[a][f],g[0]),y=K(n[o][f],g[0]),ct(n,o,a,p,d,Cn(v),y),r&&at(e,o,a,y,Cn(d),v,p)),w=K(n[a][f],n[o][f]),ct(n,o,a,$,O,Cn(w),$),r&&at(e,o,a,$,O,w,$));for(l=f+1;l<S;++l)V(n[o][l],O)||(c=!0,V(O,$n(n[o][l],n[o][f]))||(p=(g=me([n[o][f],n[o][l]]))[1],d=g[2],v=K(n[o][l],g[0]),y=K(n[o][f],g[0]),at(n,f,l,p,Cn(v),d,y),t&&ct(i,f,l,y,v,Cn(d),p)),w=K(n[o][l],n[o][f]),at(n,f,l,$,Cn(w),O,$),t&&ct(i,f,l,$,w,O,$))}u=f}for(h=0;h<A;++h)for(m=h-1;0<=m;--m)V((g=me([n[m][m],n[h][h]]))[0],O)||(p=g[1],d=g[2],v=K(n[h][h],g[0]),y=K(n[m][m],g[0]),b=H(d,v),x=D($,H(p,y)),ct(n,m,h,$,d,v,D(b,$)),r&&at(e,m,h,D($,b),d,v,Z),at(n,m,h,p,x,$,Cn(y)),t&&ct(i,m,h,y,x,$,Cn(p)));return r&&t?[n,e,i]:r?[n,e]:t?[n,i]:n}(E.round(E.real(r)),1<n,1<n);return 1<n?[r[1],r[2],r[0]]:r});var Rt=.254829592,Tt=-.284496736,Xt=1.421413741,zt=-1.453152027,Zt=1.061405429,Lt=.3275911;function Ot(n){n=jr(n);var r,t=L.sign(n)||1;return t<0&&(n=Cn(n)),r=Fn(G(H(Lt,n),$)),H(t,D($,H(G(H(G(H(G(H(G(H(Zt,r),zt),r),Xt),r),Tt),r),Rt),H(r,L.exp(Cn(H(n,n)))))))}function $t(r,n){if(y(r))return r;if(w(r))return r.length?nn(Gr(r),Q(r.length)):s;if(b(r)){if(1===(n=M(n=null==n?1:n)))return W(B(r),function(n){return $t(j(r,n))});if(2===n)return W(U(r),function(n){return $t(r[n])})}v("mean")}function Ct(r,n,t){if(n=M(n||0),y(r))return O;if(w(r))return 0===r.length?s:1===r.length?O:L.sqrt(nn(Gr(or(Rr(er(r,$t(r))),Q(2))),Q(1===n?r.length:r.length-1)));if(b(r)){if(1===(t=M(t=null==t?1:t)))return W(B(r),function(n){return Ct(j(r,n))});if(2===t)return W(U(r),function(n){return Ct(r[n])})}v("std")}function Ft(e,n,i){if(i=M(i||0),2!==arguments.length||0!==M(n)&&1!==M(n)||(i=M(n),n=null),null==n){if(y(e))return O;var r;if(w(e))return e.length<=1?e.length?O:s:(t=e.length,r=$t(e),nn(Gr(ir(Pr(r=er(e,r)),r)),Q(1===i?t:t-1)));if(b(e))return S(B(e),B(e),function(n,r,t){return n===r?Ft(j(e,n),i):r<n?t[r][n]:Ft(j(e,n),j(e,r),i)})}else{if(y(e)&&y(n))return Xr(2,2);if(b(e)&&b(n)&&(e=Zr(e),n=Zr(n)),w(e)&&w(n)){if(e.length!==n.length)throw"cov: inputs not of same dimension";var t;return e.length<=1?e.length?O:s:(t=e.length,nn(Gr(ir(Pr(er(e,$t(e))),er(n,$t(n)))),Q(1===i?t:t-1)))}}v("cov")}function Wt(n,r,t){for(var e,i=r.length,u=0,o=X,f=0;f<i;++f)r[f]&&r[f].length&&Xn(e=t(n,r[f]),o)&&(o=e,u=f);return[u,o]}function Ut(n){return n.length?$t(n):n}function Bt(i,n,r){return W(n,function(e){return Ut(r.reduce(function(n,r,t){return r===e&&n.push(i[t]),n},[]))})}function Qt(t,n,r){return t=t.slice(),W(n,function(n){var r=t.length?I.round(I.random()*(t.length-1)):-1;return-1<r?t.splice(r,1)[0]:[]})}function Vt(n,t,r){var e=n.length;return de(n.slice()).reduce(function(n,r){return!n.length||n[n.length-1].length+1>e/t?n.push([r]):n[n.length-1].push(r),n},[]).map(Ut)}function Gt(n,r,t){for(var e,i,u,o,f,c=n.length,a=[n[I.round(I.random()*(c-1))]],l=new Array(c);a.length<r;){for(u=O,i=0;i<c;++i)e=Wt(n[i],a,t)[1],l[i]=nr(Y(e,Jn(e))),u=G(u,l[i]);for(o=H(u,I.random()),f=O,i=0;i<c;++i)if(Ln(f=G(f,l[i]),o)){a.push(n[i]);break}}return a}function Dt(n,r){var t,e,i,u,o,f=n.length,c=r.length,a=f+c-1;if(!f||!c)return[];for(o=new Array(a),f<c&&(u=n,f=(n=r).length,c=(r=u).length),t=0;t<a;++t)for(o[t]=O,e=0;e<c;++e)0<=(i=t-e)&&i<f&&(o[t]=J(o[t],Y(n[i],r[e])));return o}function Ht(n,r,t){var e,i=[],u=n.slice(),o=u.length-r.length,f=r;if(0<=o)for(i=W(o+1,O);0<=o;){for(e=o,r=f.concat(W(o,O)),i[i.length-1-o]=nn(u[0],r[0]),u=ue(u,oe(r,[Kn(i[i.length-1-o])]));u.length&&P(u[0],O);)u.shift();if((o=u.length-f.length)===e)break}return[i,t?W(n.length-u.length,O).concat(u):u]}on.push(function(){Rt=Q(.254829592),Tt=Q(-.284496736),Xt=Q(1.421413741),zt=Q(-1.453152027),Zt=Q(1.061405429),Lt=Q(.3275911)}),E.erf=function(n){return En(Ot,n,!0)},E.mean=$t,E.median=function r(t,n){if(y(t))return t;if(w(t))return t.length?1&(t=Br(t)).length?t[t.length>>1]:nn(J(t[t.length>>1],t[(t.length>>1)-1]),Q(2)):s;if(b(t)){if(1===(n=M(n=null==n?1:n)))return W(B(t),function(n){return r(j(t,n))});if(2===n)return W(U(t),function(n){return r(t[n])})}v("median")},E.mode=function r(t,n){if(y(t))return t;var e,i;if(w(t))return t.length?(e={},i=0,t.reduce(function(n,r){var t=r.toString(),t=fn.call(e,t)?(e[t]+=1,e[t]):e[t]=1;return i<t?(i=t,n=r):t===i&&Un(r,n)&&(n=r),n},{})):s;if(b(t)){if(1===(n=M(n=null==n?1:n)))return W(B(t),function(n){return r(j(t,n))});if(2===n)return W(U(t),function(n){return r(t[n])})}v("mode")},E.moment=function r(t,e,n){if(y(t))return O;var i;if(w(t))return t.length<=1?t.length?O:s:(i=t.length,nn(Gr(or(er(t,$t(t)),e)),Q(i)));if(b(t)){if(1===(n=M(n=null==n?1:n)))return e=Q(e),W(B(t),function(n){return r(j(t,n),e)});if(2===n)return e=Q(e),W(U(t),function(n){return r(t[n],e)})}v("moment")},E.std=Ct,E.var=function r(t,e,n){if(e=M(e||0),y(t))return O;var i,u;if(w(t))return t.length<=1?t.length?O:s:(i=t.length,u=$t(t),nn(Gr(ir(Pr(u=er(t,u)),u)),Q(1===e?i:i-1)));if(b(t)){if(1===(n=M(n=null==n?1:n)))return W(B(t),function(n){return r(j(t,n),e)});if(2===n)return W(U(t),function(n){return r(t[n],e)})}v("var")},E.cov=Ft,E.corrcoef=function e(i,r){if(null==r){if(y(i)||w(i))return $;if(b(i))return S(B(i),B(i),function(n,r,t){return n===r?$:r<n?t[r][n]:e(j(i,n),j(i,r))})}else{if(y(i)&&y(r))return $;if(w(i)&&w(r)){if(i.length!==r.length)throw"corrcoef: inputs not of same dimension";return Ir(i,r)}if(b(i)&&b(r)){if(U(i)!==U(r)||B(i)!==B(r))throw"corrcoef: inputs not of same dimension";return W(B(i),function(n){return e(j(i,n),j(r,n))})}}v("corrcoef")},E.corr=Nn(function(n,t){if(1<n)throw"corr: only one output is supported";b(t=y(t)?[[t]]:t)||v("corr");var e,n=2,i=Ir;if(n<arguments.length&&k(arguments[n])?(e=arguments[n],++n):e=t,n<arguments.length&&"Type"===arguments[n])switch(arguments[n+1]){case"Spearman":i=Er;break;case"Kendall":i=qr;break;default:i=Ir}return b(e)&&U(t)===U(e)||v("corr"),S(B(t),B(e),function(n,r){return i(j(t,n),j(e,r))})}),E.tiedrank=Nn(function(n,r,t,e){if(1<n)throw"tiedrank: only one output is supported";r=N(r=y(r)?[r]:r);var i=P(O,t)&&P($,e);return b(r)?Or(W(B(r),function(n){return _r(j(r,n),i)})):_r(r,i)}),E.pdist=function(n){var i,u,r=mr;if(b(n=w(n)?Sn(n):n)||v("pdist"),1<arguments.length)switch(arguments[1]){case"fasteuclidean":case"euclidean":r=mr;break;case"fastsquaredeuclidean":case"squaredeuclidean":r=gr;break;case"fastseuclidean":case"seuclidean":u=k(arguments[2])?N(arguments[2]):Ct(n),r=function(n,r,t,e){return pr(n,r,u[t])};break;case"mahalanobis":u=yt(u=k(arguments[2])?arguments[2]:Ft($r(n))),i=$t($r(n)),r=function(n,r,t,e){return L.sqrt(dr(r,i,u))};break;case"cityblock":r=wr;break;case"minkowski":u=y(arguments[2])?arguments[2]:en,r=function(n,r,t,e){return vr(n,r,u)};break;case"chebychev":r=yr;break;case"cosine":r=br;break;case"correlation":r=xr;break;case"hamming":r=kr;break;case"jaccard":r=Sr}for(var t,e=[],o=B(n),f=0;f<o;++f)for(t=f+1;t<o;++t)e.push(r(j(n,t),j(n,f),t,f));return e},E.pdist2=function(e,i){var u,o,f=mr;if(w(e)&&(e=Sn(e)),w(i)&&(i=Sn(i)),b(e)&&b(i)&&U(e)===U(i)||v("pdist2"),2<arguments.length)switch(arguments[2]){case"fasteuclidean":case"euclidean":f=mr;break;case"fastsquaredeuclidean":case"squaredeuclidean":f=gr;break;case"fastseuclidean":case"seuclidean":o=k(arguments[3])?N(arguments[3]):Ct(e),f=function(n,r,t,e){return pr(n,r,o[t])};break;case"mahalanobis":o=yt(o=k(arguments[3])?arguments[3]:Ft($r(e))),u=$t($r(e)),f=function(n,r,t,e){return L.sqrt(dr(r,u,o))};break;case"cityblock":f=wr;break;case"minkowski":o=y(arguments[3])?arguments[3]:en,f=function(n,r,t,e){return vr(n,r,o)};break;case"chebychev":f=yr;break;case"cosine":f=br;break;case"correlation":f=xr;break;case"hamming":f=kr;break;case"jaccard":f=Sr}return S(B(e),B(i),function(n,r,t){return n<=r?f(j(e,n),j(i,r),n,r):t[r][n]})},E.mahal=function(e,n){w(n)&&(n=Sn(n)),w(e)&&(e=Sn(e)),b(n)&&b(e)&&U(n)===U(e)||v("mahal");var r=$r(n),i=yt(Ft(r)),u=$t(r);return S(B(e),B(n),function(n,r,t){return n<=r?dr(j(e,n),u,i):t[r][n]})},E.squareform=function(n,r){var t,e,i,u,o,f;if(w(n=N(n))||"tomatrix"===r){if(y(n))n=[n];else if(b(n))return n;for(e=n.length,t=S(i=I.round((I.sqrt(1+8*e)+1)/2),i,O),u=f=0;u<i;++u)for(o=u+1;o<i;++o)t[o][u]=n[f++],t[u][o]=t[o][u]}else if(b(n)||"tovector"===r){if(y(n))n=[[O,n],[n,O]];else if(w(n))return n;for(e=U(n),t=[],u=0;u<e;++u)for(o=u+1;o<e;++o)t.push(n[o][u])}return t},E.kmeans=Nn(function(n,i,r){var t,e=3,u=Gt,o=gr,f=100;for(b(i)||v("kmeans");e<arguments.length;){if("Start"===arguments[e])if(b(arguments[e+1]))r=U(u=arguments[e+1]);else switch(arguments[e+1]){case"cluster":break;case"uniform":u=Vt;break;case"sample":u=Qt;break;default:u=Gt}else if("Distance"===arguments[e])switch(arguments[e+1]){case"kullbackleibler":o=Ar;break;case"hamming":o=kr;break;case"correlation":o=xr;break;case"cosine":o=br;break;case"cityblock":o=wr;break;case"euclidean":o=mr;break;default:o=gr}else"MaxIter"===arguments[e]&&(f=I.ceil(I.abs(M(An(arguments[e+1],!0)))));e+=2}return(t=function(n,r,t,e,i){var u,o,f,c,a=U(n),l=(B(n),n.map(function(n){return Wt(n,t,e)[0]}));for(t=Bt(n,r,l),u=1;u<=i;++u){for(o=c=0;o<a;++o)f=Wt(n[o],t,e)[0],l[o]!==f&&++c,l[o]=f;if(0===c)break;t=Bt(n,r,l)}return[l,t]}(i,r,b(u)?u:u(i,r,o),o,f))[0]=t[0].map(function(n){return n+1}),1===n?t=t[0]:2<n&&(t.push(W(r,function(e){return idx.reduce(function(n,r,t){return n=r===e?J(n,o(i[t],C[e])):n},O)})),3<n)&&t.push(S(U(i),r,function(n,r){return o(i[n],C[r])})),t}),E.danneal=function(n,i){((i=I.round(M(An(i,!0))))<=0||!b(n)||U(n)!==B(n))&&v("danneal");var u=function(n,r){for(var t,e,i,u,o,f,c,a,l,s,h,m,g,p,d,v=U(n),y=S(v,r,function(){return I.random()}),w=0;w<v;++w){for(c=g=0;c<r;++c)g+=y[w][c];for(c=0;c<r;++c)y[w][c]/=g}for(t=S(v,r,function(){return I.random()}),o=(u=M(L.sqrt(H(Tr(n,1),Tr(n,X)))))/1e3,n=n.map(function(n){return n.map(M)}),i=u;o<i;){for(a=1;a<=100;++a){for(w=0;w<v;++w){for(s=y[w],h=t[w],c=g=0;c<r;++c)g+=I.exp(-h[c]/i);for(c=0;c<r;++c)s[c]=I.exp(-h[c]/i)/g}for(e=S(v,r,0),p=W(r,function(n){for(var r=0,t=0;t<v;++t)r+=y[t][n];return r}),d=R(n,y).map(function(n){return n.map(M)}),w=l=0;w<v;++w)for(s=y[w],h=e[w],c=0;c<r;++c){for(m=p[c]-s[c],f=g=0;f<v;++f)g+=y[f][c]*(n[w][f]-d[f][c]/(2*m));h[c]=g/(1+m),l=I.max(l,I.abs(h[c]-t[w][c]))}if(t=e,l<=1e-4)break}i*=.5}return y}(n,i);return W(U(u),function(n){for(var r=u[n],t=0,e=1;e<i;++e)r[e]>r[t]&&(t=e);return t+1})},E.conv=function(n,r){return(y(n)||y(r)?ir:(n=N(n),r=N(r),w(n)&&w(r)||v("conv"),Dt))(n,r)},E.deconv=Nn(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[ur(r,t),O]:ur(r,t);else{if(r=N(r),t=N(t),w(r)&&w(t)||v("deconv"),!t.length||1===t.length&&P(t[0],O))throw"deconv: divisor is zero";e=Ht(r,t,!0)}return 1<n?e:e[0]}),E.conv2=function(r,t){if(y(r)||y(t))return ir(r,t);if(w(r)){if(w(t))return Dt(r,t);if(b(t))return W(B(t),function(n){return Dt(r,j(t,n))})}else{if(w(t)){if(w(r))return Dt(r,t);if(b(r))return W(r[0].length,function(n){return Dt(j(r,n),t)});throw"conv2: input 1 not supported"}if(!b(r))throw"conv2: input 1 not supported";if(b(t)){var n,e,i,u,o,f,c,a,l,s,h,m,g,p=r,d=t;for(U(p)<U(d)&&(g=p,p=d,d=g),n=U(p),e=B(p),o=Xr(f=n+(i=U(d))-1,c=e+(u=B(d))-1),l=0;l<f;++l)for(s=0;s<c;++s){for(a=O,h=0;h<=l&&!(n<=h);++h)if(!(i<=l-h))for(m=0;m<=s&&!(e<=m);++m)u<=s-m||(a=J(a,Y(p[h][m],d[l-h][s-m])));o[l][s]=a}return o}}throw"conv2: input 2 not supported"},E.filter=function(n,r,t,e,i){n=N(n),r=N(r),t=N(t),w(n)&&w(r)&&w(t)||v("filter");var u,o,f,c,a=n,l=r,s=t,h=s.length,m=l.length,g=a.length,p=new Array(h),d=l[0];for(l=l.map(function(n){return nn(n,d)}),a=a.map(function(n){return nn(n,d)}),u=0;u<h;++u){for(c=O,f=u,o=0;0<=f&&o<g;++o,--f)c=J(c,Y(a[o],s[f]));for(f=u-1,o=1;0<=f&&o<m;++o,--f)c=Dn(c,Y(l[o],p[f]));p[u]=c}return p};var Kt={},Jt={};function Yt(n,r){for(var t,e,i=n.length,u={},o=0;o<i;++o)1!==u[o]&&(e=n[t=function(n,r){for(var t=0;1<r;)t=(t<<1)+(1&n),n>>=1,r>>=1;return t}(o,i)],r[t]=n[o],r[o]=e,u[t]=1)}function ne(n,r,t){var e,i,u=n.length;if(1===u)t[0]=n[0];else{for(e=0;e<u;++e)t[e]=new _(O,O);for(var o,f,c,a,l,s,h=function(n){for(var r=I.sqrt(n),t=3;t<=r;){if(0==n%t)return t;t+=2}return n}(u),m=u/h,g=Q(1/I.sqrt(h)),p=new Array(m),d=new Array(m),v=0;v<h;++v){for(e=0;e<m;++e)p[e]=n[e*h+v];for(1<m&&(ee(p,r,d),i=p,p=d,d=i),o=Q(I.cos(2*T*v/u)),f=Q((r?-1:1)*I.sin(2*T*v/u)),c=$,a=O,e=0;e<u;++e)l=H(g,p[e%m].re),s=H(g,p[e%m].im),t[e]=t[e].add(new _(D(H(l,c),H(s,a)),G(H(s,c),H(l,a)))),l=D(H(c,o),H(a,f)),s=G(H(c,f),H(a,o)),c=l,a=s}}}var re=I.SQRT1_2;function te(n,r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d,v,y,w,b=n.length,x=1;for(Yt(n,t);x<b;){for(e=Q((w=void 0,null==(w=Jt[y=x])&&(Jt[y]=w=I.cos(T/y)),w)),i=Q((r?-1:1)*(y=void 0,null==(y=Kt[w=x])&&(Kt[w]=y=I.sin(T/w)),y)),o=b/(2*x),u=0;u<o;++u)for(l=$,s=O,f=0;f<x;++f)g=t[h=2*u*x+f].re,p=t[h].im,c=t[m=h+x].re,a=t[m].im,d=D(H(l,c),H(s,a)),v=G(H(s,c),H(l,a)),t[h]=new _(H(G(g,d),re),H(G(p,v),re)),t[m]=new _(H(D(g,d),re),H(D(p,v),re)),c=D(H(l,e),H(s,i)),a=G(H(l,i),H(s,e)),l=c,s=a;x<<=1}}function ee(n,r,t){var e,i=n.length;if(!(i<=0))return e=!1,null==t&&(t=new Array(i),e=!0),(i&i-1?ne:te)(n,r,t),e?t:void 0}function ie(n,r,t){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,o,f=!1,c=new Array(e),a=new Array(i),l=new Array(e),s=new Array(i);if(null==t){for(t=new Array(e),u=0;u<e;++u)t[u]=new Array(i);f=!0}for(o=0;o<i;++o,0){for(u=0;u<e;++u)c[u]=n[u][o];for(ee(c,r,l),u=0;u<e;++u)t[u][o]=l[u]}for(u=0;u<e;++u){for(o=0;o<i;++o,0)a[o]=t[u][o];for(ee(a,r,s),o=0;o<i;++o,0)t[u][o]=s[o]}return f?t:void 0}}function ue(n,r){for(var t=n.length-1,e=r.length-1,i=[];0<=t&&0<=e;)i.unshift(J(n[t--],r[e--]));for(;0<=t;)i.unshift(n[t--]);for(;0<=e;)i.unshift(r[e--]);return i}on.push(function(){re=Q(I.SQRT1_2)}),E.fft=function(r){return b(r=N(r))?W(B(r),function(n){return Rn(ee(Tn(j(r,n)),!1))}):w(r)?Rn(ee(Tn(r),!1)):void v("fft")},E.ifft=function(r){return b(r=N(r))?W(B(r),function(n){return Rn(ee(Tn(j(r,n)),!0))}):w(r)?Rn(ee(Tn(r),!0)):void v("ifft")},E.fft2=function(n){return b(n)||v("fft2"),Rn(ie(Tn(n),!1))},E.ifft2=function(n){return b(n)||v("ifft2"),Rn(ie(Tn(n),!0))};var oe=Dt,fe=Ht;function ce(n,r){if(!n.length)return O;r=r||O;for(var t=n.length,e=0,i=n[0];e+1<t;)++e,i=J(Y(i,r),n[e]);return i}function ae(r){if(r.length<=1)return[];var n,t,e,i,u,o,f,c,a,l,s,h,m,g=r.length-1,p=Q(1e-10),d=new _(p,O),v=new _(O,O),y=new _($,O);for(r=r.map(Q),l=function(n){return ce(r,n)},s=function(n){return nn(Dn(l(J(n,d)),l(n)),d)},n=r.map(function(n){return _(n).abs()}),o=n.length-1;0<o&&V(n[o],O);)--o;for(e=G(K(Vr(n.slice(0,o))||O,Vr([n[o],$])),$),t=K(n[0],Vr(G(n[0],Vr(n.slice(1))))),i=W(g,function(){return new _(G(t,H(D(e,t),I.random())),Q(I.random()*T/2),"polar")}),a=1;a<=1e4;++a){for(o=u=0;o<g;++o){if(f=i[o],h=l(f),V((m=s(f)).re,O)&&V(m.im,O)){if(Zn(L.abs(h.re),p)&&Zn(L.abs(h.im),p)){++u;continue}c=new _(e,O)}else c=h.div(m);h=c.div(y.sub(c.mul(i.reduce(function(n,r,t){return n=t===o||V(f.re,r.re)&&V(f.im,r.im)?n:n.add(f.sub(r).inv())},v)))),Zn(L.abs(h.re),p)&&Zn(L.abs(h.im),p)&&++u,i[o]=f.sub(h)}if(u===g)break}return i}function le(n,r){for(var t,e,i,u=O,o=I.min(n.length,r.length)-1,f=0;f<o;++f)t=n[f],i=n[f+1],e=r[f],u=G(u,K(D(H(t,r[f+1]),H(e,i)),en));return 1<o&&(t=n[o],i=n[0],e=r[o],u=G(u,K(D(H(t,r[0]),H(e,i)),en))),u}function se(u,o){var f,n,r,t,e,i,c,a,l,s,h=u.length,m=W(h,function(n){return n});if(h<3)return m;for(f=0,n=1;n<h;++n)(Xn(o[n],o[f])||V(o[n],o[f])&&Xn(u[n],u[f]))&&(f=n);for(m.splice(f,1),--h,m=m.map(function(n){return[(r=u[f],t=o[f],e=u[n],i=o[n],Un(i=L.atan2(D(i,t),D(e,r)),O)?G(i,2*T):i),n];var r,t,e,i}).sort(function(n,r){return Xn(n[0],r[0])?-1:zn(n[0],r[0])?1:0}).map(function(n){return n[1]}),(r=new Array(h+1))[0]=f,r[1]=m[0],r[2]=m[1],t=3,n=2;n<h;++n){for(;1<t&&Zn(O,(e=u[m[n]],i=o[m[n]],c=u[r[t-1]],a=o[r[t-1]],l=u[r[t-2]],s=o[r[t-2]],e=D(e,l),c=D(c,l),l=D(i,s),i=D(a,s),D(H(e,i),H(l,c))));)--t;r[t++]=m[n]}return r.length=t,r}function he(){var n,r,t,e,i=arguments,u=i.length;if(0===u)return O;for(e=0;e<u&&V(O,n=i[e++]););for(n=L.abs(n);e<u;){if(V(n,$))return $;for(;e<u&&V(O,r=i[e++]););if(V(r=L.abs(r),$))return $;if(!V(r,n)){if(V(r,O))break;for(Xn(n,r)&&(t=r,r=n,n=t);!V(O,r);)r=$n(n,t=r),n=t}}return n}function me(n){var r,t,e,i,u=n.length,o=$,f=O,c=O,a=$,l=$,s=$;if(0!==u){if(r=n[0],zn(O,r)&&(r=L.abs(r),l=Z),1===u)return[r,l];if(i=2===u?[n[1],$]:me(n.slice(1)),t=i[0],zn(O,t)&&(t=L.abs(t),s=Z),V(O,r))return W(i.length+1,function(n){return 0===n?t:1===n?l:H(s,i[n-1])});if(V(O,t))return W(i.length+1,function(n){return 0===n?r:1===n?l:H(s,i[n-1])});for(;;){if(e=L.floor(K(r,t)),r=$n(r,t),o=D(o,H(e,c)),f=D(f,H(e,a)),V(O,r))return c=H(c,l),a=H(a,s),W(i.length+1,function(n){return 0===n?t:1===n?c:H(a,i[n-1])});if(e=L.floor(K(t,r)),t=$n(t,r),c=D(c,H(e,o)),a=D(a,H(e,f)),V(O,t))return o=H(o,l),f=H(f,s),W(i.length+1,function(n){return 0===n?r:1===n?o:H(f,i[n-1])})}}}function ge(n,r){var t=L.abs(n);return V(t,L.abs(r))?V(n_sign(n),n_sign(r))?t:Cn(t):H(K(n,he(n,r)),r)}E.polydiv=Nn(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[ur(r,t),O]:ur(r,t);else{if(r=N(r),t=N(t),w(r)&&w(t)||v("polydiv"),!t.length||1===t.length&&P(t[0],O))throw"polydiv: divisor is zero";e=fe(r,t,!1)}return 1<n?e:e[0]}),E.polyval=function(r,n){return w(r=N(r))||v("polyval"),y(n)?Rn(ce(r,n)):w(n)?n.map(function(n){return Rn(ce(r,n))}):void v("polyval")},E.polyvalm=function(r,n){return w(r=N(r))||v("polyvalm"),b(n)&&U(n)===B(n)?Rn(function(n,r){if(!n.length)return Xr(U(r),B(r));for(var t=n.length,e=0,i=U(r),u=zr(i,n[0]);e+1<t;)++e,u=tr(R(u,r),zr(i,n[e]));return u}(r,n)):y(n)?Rn(ce(r,n)):w(n)?n.map(function(n){return Rn(ce(r,n))}):void v("polyvalm")},E.polyfit=function(n,r,i){if(n=N(n),r=N(r),w(n)&&w(r)||v("polyfit"),n.length!==r.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return Rn(function(e,i){var n,u,o,r,t,f,c,a;if(!(w(e)&&e.length&&w(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),o=I.min(e.length,i.length),e.length=o,i.length=o,c={},a=[],u=0;u<o;++u)if(f=String(e[u]),fn.call(c,f)){if(!P(i[c[f]],i[u]))return[];a.push(u)}else c[f]=u;for(;a.length;)u=a.pop(),e.splice(u,1),i.splice(u,1);for(a=c=null,r=W(o=e.length,function(n){for(var r=$,t=0;t<o;++t)t!==n&&(r=Y(r,Dn(e[n],e[t])));return r=nn(i[n],r)}),t=W(o,function(n){return[$,Kn(e[n])]}),n=[],u=0;u<o;++u)n=ue(n,t.reduce(function(n,r,t){return n=t!==u?oe(n,r):n},[r[u]]));return n}(n,r));if(!p(i)||M(i)<0)throw"polyfit: input 3 not positive int";return i=M(i),Rn(R(xt(n.reduce(function(n,r){for(var t=1,e=[$];t<=i;++t)e.unshift(Y(r,e[0]));return n.push(e),n},[])),r))},E.roots=function(n){return w(n=N(n))||v("roots"),Rn(ae(n).sort(function(n,r){return Xn(jr(n),jr(r))?-1:zn(jr(n),jr(r))?1:0}))},E.compan=function(n){return w(n=N(n))||v("compan"),S((t=n).length-1,t.length-1,function(n,r){return 0===n?Kn(nn(t[r+1],t[0])):r+1===n?$:O});var t},E.poly=function(n){return b(n=N(n))&&E.charpoly?E.charpoly(n):(w(n)||v("poly"),Rn(n.reduce(function(n,r){return oe(n,[$,Kn(r)])},[$])))},E.cart2pol=Nn(function(n,r,t,e){return[E.atan2(t,r),E.sqrt(tr(or(r,en),or(t,en))),e]},3),E.pol2cart=Nn(function(n,r,t,e){return[ir(t,E.cos(r)),ir(t,E.sin(r)),e]},3),E.cart2sph=Nn(function(n,r,t,e){var i=tr(or(r,en),or(t,en));return[E.atan2(t,r),E.atan2(e,E.sqrt(i)),E.sqrt(tr(i,or(e,en)))]},3),E.sph2cart=Nn(function(n,r,t,e){return[ir(e,ir(E.cos(t),E.cos(r))),ir(e,ir(E.cos(t),E.sin(r))),ir(e,E.sin(t))]},3),E.polyarea=function(r,t){return r=N(r),t=N(t),b(r)&&b(t)?(U(r)===U(t)&&B(r)===B(t)||v("polyarea"),W(B(r),function(n){return le(j(r,n),j(t,n))})):w(r)&&w(t)?(r.length!==t.length&&v("polyarea"),le(r,t)):void v("polyarea")},E.convhull=Nn(function(n,r,t,e){3<arguments.length&&v("convhull"),b(r)&&2===B(r)?(t=j(r,1),r=j(r,0)):(r=N(r),t=N(t)),w(r)&&w(t)&&r.length===t.length||v("convhull");var i=se(r,t);return 1<n?[i.map(function(n){return n+1}),le(i.map(function(n){return r[n]}),i.map(function(n){return t[n]}))]:i.map(function(n){return n+1})}),E.mod=function(n,t){return P(t=An(t||0),0)?n:En(function(n){var r;return F(n)?Xn(r=$n(n,t),0)&&zn(t,0)?G(r,t):r:n},n,!0)},E.gcd=Nn(function(n,r,t){return function t(e,i,u){if(u){var o,f;if(k(e)){if(o=new Array(e.length),k(i))return e.length!==i.length&&v("gcd"),f=new Array(i.length),[e.map(function(n,r){return n=t(n,i[r],u),o[r]=n[1],f[r]=n[2],n[0]}),o,f];if(p(i))return f=new Array(e.length),[e.map(function(n,r){return n=t(n,i,u),o[r]=n[1],f[r]=n[2],n[0]}),o,f]}if(p(e)){if(k(i))return o=new Array(i.length),f=new Array(i.length),[i.map(function(n,r){return n=t(e,n,u),o[r]=n[1],f[r]=n[2],n[0]}),o,f];if(p(i))return me([e,i])}}else{if(k(e)){if(k(i))return e.length!==i.length&&v("gcd"),e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(k(i))return i.map(function(n,r){return t(e,n)});if(p(i))return he(e,i)}}v("gcd")}(r,t,1<n)}),E.lcm=function t(e,i){if(k(e)){if(k(i))return e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(k(i))return i.map(function(n,r){return t(e,n)});if(p(i))return function(){var n,r,t=arguments,e=t.length;if(e<=1)return 1===e?t[0]:O;if(V(O,t[0])||V(O,t[1]))return O;for(r=ge(t[0],t[1]),n=2;n<e;++n){if(V(O,t[n]))return O;r=ge(r,t[n])}return r}(e,i)}return e};var pe=[Q(2),Q(3),Q(5),Q(7),Q(11),Q(13),Q(17),Q(19),Q(23),Q(29),Q(31),Q(37),Q(41),Q(43),Q(47),Q(53),Q(59),Q(61),Q(67),Q(71),Q(73),Q(79),Q(83),Q(89),Q(97),Q(101),Q(103),Q(107),Q(109)];function de(n){for(var r,t,e=1+(n.length-1);1<e--;)r=I.round(I.random()*+e),t=n[0+e],n[0+e]=n[0+r],n[0+r]=t;return n}function ve(t){for(var n=(t=[].map.call(t,function(n){return k(n)||v("combinations"),Zr(n)})).map(function(n){return n.length}),r=W(n.length,0),e=[];r&&r.length;)e.push(r.map(function(n,r){return t[r][n]})),r=function(n,r){for(var t,e=r.length-1,i=e;0<=i&&i<=e&&n[i]+1===r[+i+0];)--i;if(0<=i&&i<=e)for(n[i]=n[i]+1,t=i+1;0<=t&&t<=e;t+=1)n[t]=0;else n=null;return n}(r,n);return e}function ye(n){if(q(n))return 0<n.length;if(gn(n))return!1;if(u(n))return 0!==n;if(dn(n))return!n.eq(O);if(o(n))return!V(n.re,O)||!V(n.im,O);if(k(n)){if(!n.length)return!1;for(var r=0,t=n.length;r<t;++r)if(!ye(n[r]))return!1;return!0}return!0===n}on.push(function(){pe=[Q(2),Q(3),Q(5),Q(7),Q(11),Q(13),Q(17),Q(19),Q(23),Q(29),Q(31),Q(37),Q(41),Q(43),Q(47),Q(53),Q(59),Q(61),Q(67),Q(71),Q(73),Q(79),Q(83),Q(89),Q(97),Q(101),Q(103),Q(107),Q(109)]}),E.factor=function(n){for(var r,t,e=L.floor(L.abs(jr(An(n)))),i=Q(1e30),u=[],o=e,f=0,c=pe.length;f<c;++f){if(V(o,r=pe[f]))return[r];if(zn(t=H(r,r),e)||null!=i&&zn(t,i))break;for(;V(O,$n(e,r));)u.push(r),e=K(e,r)}if(c<=f)for(t=H(r=G(r,en),r);Zn(t,e)&&(null==i||Zn(t,i));){for(;V(O,$n(e,r));)u.push(r),e=K(e,r);t=H(r=G(r,en),r)}return zn(e,$)&&u.push(e),u},E.randperm=function(n){return(!p(n=I.round(M(n||0)))||n<=0)&&v("randperm"),de(W(n,function(n){return n+1}))},E.perms=function(r){w(r=N(r))||v("perms");for(var n=W(r.length,function(n){return n}),t=[];n&&n.length;)t.push(n.map(function(n){return r[n]})),n=function(n){for(var r,t,e,i,u=n.length-1,o=u,f=o-1;0<=f&&f<=u&&+n[f]>=+n[f+1];)--f;if(0<=f&&f<=u){for(r=o;0<=r&&r<=u&&0<r-f&&+n[f]>=+n[r];)--r;for(t=n[f],n[f]=n[r],n[r]=t,e=f+1,i=o;0<=e&&e<=u&&0<=i&&i<=u&&0<i-e;)t=n[e],n[e]=n[i],n[i]=t,e+=1,--i}else n=null;return n}(n);return t},E.combinations=function(){return ve(arguments)},E.string=function n(r){return k(r)?r.map(n):q(r)?r:String(r)},E.strlength=function(n){if(q(n))return n.length;v("strlength")},E.char=function n(r){return r=N(r),k(r)?r.map(n):q(r)?r.split(""):p(r)?String.fromCharCode(M(r)):String(r)},E.lower=E.tolower=function n(r){return k(r)?r.map(n):q(r)?r.toLowerCase():r},E.upper=E.toupper=function n(r){return k(r)?r.map(n):q(r)?r.toUpperCase():r},E.dec2bin=function n(r){return k(r)?r.map(n):u(r)?r.toString(2):dn(r)?r.toBinary():r},E.bin2dec=function n(r){return k(r)?r.map(n):q(r)?parseInt(r,2):r},E.dec2hex=function n(r){return k(r)?r.map(n):u(r)?r.toString(16):dn(r)?r.toHexadecimal():r},E.hex2dec=function n(r){return k(r)?r.map(n):q(r)?parseInt(r,16):r};var we={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var r=[],t=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?t.length&&(k(t[0])?r=r.length?Lr("vert",r,t):t:r.push(t),t=[]):!sn(n,Ae)&&k(n)?t=t.length?Lr("horz",t,n):n:t.push(n))}),t.length&&(k(t[0])?r=r.length?Lr("vert",r,t):t:r.length?r.push(t):r=t),r}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return E.colon(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r){return Zr(n,r)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r,t){return Zr(n,r,t)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return E.ctranspose(n)}},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return E.transpose(n)}},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:fr},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:or},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,r){return vt(n,r)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:ur},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:ur},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:function(n,r){return R(n=wn(n)?kn(n):n,r=wn(r)?kn(r):r)}},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:ir},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:tr},"-":{name:"sub",arity:2,arityalt:1,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:function(n,r){return 1===arguments.length?cr(n):er(n,r)}},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Vn},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Qn},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Bn},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Un},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Wn},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:P},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,r){return ye(n)&&ye(r)?$:O}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){return ye(n)||ye(r)?$:O}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){n=ye(n),r=ye(r);return n&&!r||r&&!n?$:O}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return ye(n)?O:$}},"=":{name:"set",breakpoint:"set",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,r){var t,e;return k(n)&&sn(n[0],Ae)?(e=n,k(t=r)?await Promise.all(e.map(function(n,r){return be(n,r<t.length?t[r]:null)})):await Promise.all(e.map(function(n,r){return be(n,0===r?t:null)}))):be(n,r.$scilitevarargout$?r[0]:r)}}};async function be(n,r){if(sn(n,Ae)&&q(n.v))return await n.set(r),n.get(!0);throw"setting non-variable"}async function xe(n,r,t){var e,i,u,o,f,c,a=null;if(ye(await Ee(n.if.cond,r,t))){for(e=0,o=(f=n.if.statements).length;e<o;++e)null!=(c=await Ee(f[e],r,t))&&(a=c);return a}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(ye(await Ee(n.elseif[i].cond,r,t))){for(e=0,o=(f=n.elseif[i].statements).length;e<o;++e)null!=(c=await Ee(f[e],r,t))&&(a=c);return a}if(n.else.statements.length){for(e=0,o=(f=n.else.statements).length;e<o;++e)null!=(c=await Ee(f[e],r,t))&&(a=c);return a}}async function ke(n,r,t){var e,i,u,o,f,c,a,l,s=[],h=!1,m=!1,g=await Ee(n.val,r,t),p=n.statements;if(s.$scilitevarargout$=!0,k(g)){for(c=(t=t||{}).brk,a=t.cont,t.brk=function(){h=!0},t.cont=function(){m=!0},u=0,o=(l=bn(g=N(g)))?B(g):g.length;u<o;++u){for(m=h=!1,await n.ind.set(l?j(g,u):g[u]),e=0,i=p.length;e<i&&(f=await Ee(p[e],r,t),!h&&!m);++e)null!=f&&s.push(f);if(h)break}t.brk=c,t.cont=a}return s}async function Se(n,r,t){var e,i,u,o,f,c=[],a=!1,l=!1,s=n.statements;for(c.$scilitevarargout$=!0,o=(t=t||{}).brk,f=t.cont,t.brk=function(){a=!0},t.cont=function(){l=!0};ye(await Ee(n.cond,r,t));){for(l=a=!1,e=0,i=s.length;e<i&&(u=await Ee(s[e],r,t),!a&&!l);++e)null!=u&&c.push(u);if(a)break}return t.brk=o,t.cont=f,c}function Ae(n,r,t){if(!sn(this,Ae))return new Ae(n,r,t);this.ctx=n,this.v=r,this.i=t}async function _e(n){return sn(n,Ae)?await n.get():n}function Ie(n,r){if(!sn(this,Ie))return new Ie(n,r);null==r&&(r=n,n=""),this.op=n,this.arg=r}async function Ee(n,r,t){if(sn(n,Ie))return Ne(n,r,t);if(k(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await Ee(n[e],r,t);return u}return n}function qe(v,y,w,i){var b,x=0,k=0,u=v;function S(n,r,t){null==t&&(t=k),null==r&&(r=x);var e=u.split("\n")[t];return(n=String(n)+" at line "+String((w||0)+t)+" position "+String((i||0)+r)+":")+"\n"+e+"\n"+new Array(r+1).join(" ")+"^\n"}return function i(n){var r,t,e,u,o,f,c,a=[],l=[],s=[];function h(n){var r,t,e,i,u,o,f,c;if(l.length)if(n)for(;0<l.length;){if(u=(i=l.shift())[0],n===(o=we[u]).breakpoint){l.unshift(i);break}if(o.arity>a.length){if(!(null!=o.arityalt&&o.arityalt<=a.length))throw S('invalid or missing argument for "'+u+'"',i[1],i[2]);c=a.splice(0,o.arityalt).reverse()}else c=a.splice(0,o.arity).reverse();f=Ie(o.fn,c),a.unshift(f)}else if(t=(r=l.shift())[0],1===(e=we[t]).fixity){if(e.arity>a.length){if(!(null!=e.arityalt&&e.arityalt<=a.length))throw S('invalid or missing argument for "'+t+'"',r[1],r[2]);c=a.splice(0,e.arityalt).reverse()}else c=a.splice(0,e.arity).reverse();f=Ie(e.fn,c),a.unshift(f)}else{if(-1!==e.fixity)for(;0<l.length&&(u=(i=l[0])[0],(o=we[u]).priority<e.priority||o.priority===e.priority&&(o.associativity<e.associativity||o.associativity===e.associativity&&-1===o.associativity));){if(o.arity>a.length){if(!(null!=o.arityalt&&o.arityalt<=a.length))throw S('invalid or missing argument for "'+u+'"',i[1],i[2]);c=a.splice(0,o.arityalt).reverse()}else c=a.splice(0,o.arity).reverse();f=Ie(o.fn,c),a.unshift(f),l.shift()}l.unshift(r)}}function m(n){if(h(!0),1<a.length||0<l.length)throw S("mismatched terms and operators",l.length?l[0][1]:x,l.length?l[0][2]:k);!0===n&&(sn(a[0],Ie)&&s.push(a[0]),a=[],l=[])}function g(n,r){var t,e=n.test?v.match(n):n===v.slice(0,n.length);return!!e&&(!1===r?n.test?e:[n,n]:n.test?(t=e[r||0].length,v=v.slice(t),x+=t,e):(t=n.length,v=v.slice(t),x+=t,[n,n]))}function p(n,r,t){for(var e,i=t||0,u="";i<v.length;)if(n===(e=v.charAt(i))){if(!(i+1<v.length&&n===v.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return r&&(v=v.slice(i+1),x+=i+1),[u,i+1]}function d(){var n,r,t,e=function(n,r,t){for(var e,i=0,u=0;i<v.length;)if(e=v.charAt(i),!t||'"'!==e&&"'"!==e){if(r===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=p(e,!1,i+1)[1];return u||i>=v.length?-1:i}("]","[",!0);if(-1===e)throw S("mismatched brackets");if(n=v.slice(0,e),/[\[\]]/.test(n)){for(r=[];t=i(",;]");)if(r.push(t),g(","))r.push(Ie(","));else{if(!g(";"))break;r.push(Ie(";"))}g(/^\s+/),g("]")}else r=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,r){var t=n.length,e=0;return r.trim().split(-1<r.indexOf(",")?",":/\s+/g).reduce(function(n,r){return(r="~"===(r=r.trim())?Ie("v",Ae(y,"")):qe(r,y,k+w,x))&&(e?n.push(Ie(",")):t&&n.push(Ie(";")),n.push(r),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,r){return(r=qe(r.trim(),y,k+w,x))&&(n.length&&n.push(Ie(",")),n.push(r)),n},[]),v=v.slice(e+1),x+=e+1,1<(n=n.split("\n")).length&&(k+=n.length-1,n.slice(0,-1).forEach(function(n){x-=n.length+1}));return Ie(we["[]"].fn,r)}for(;0<v.length;)if(g(/^if\b/)){if(m(!0),!(c=i("\n,")))throw S('missing or invalid condition in "if"');for(g("\n")?(++k,x=0):g(","),o=(f={if:{cond:c,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((c=i(["elseif","else","end"]))&&(o.statements=o.statements.concat(c)),g("elseif")){if(!(c=i("\n,")))throw S('missing or invalid condition in "elseif"');g("\n")?(++k,x=0):g(","),f.elseif.push({cond:c,statements:[]}),o=f.elseif[f.elseif.length-1]}else if(g("else"))g(/^[ \t\v\f]+/),g("\n")?(++k,x=0):g(","),o=f.else;else if(g("end")||!c)break;s.push(Ie(xe,f))}else if(g(/^for\b/)){if(m(!0),!(r=g(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw S('missing or invalid declaration in "for"');if(!(c=i("\n,")))throw S('missing or invalid declaration in "for"');for(g("\n")?(++k,x=0):g(","),f={ind:Ae(y,r[1]),val:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Ie(ke,f))}else if(g(/^while\b/)){if(m(!0),!(c=i("\n,")))throw S('missing or invalid condition in "while"');for(g("\n")?(++k,x=0):g(","),f={cond:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Ie(Se,f))}else if(r=g(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(r[1]))break;if("continue"===r[1])g("continue"),s.push(Ie("continue",""));else if("break"===r[1])g("break"),s.push(Ie("break",""));else{if("end"!==r[1])throw S('unexpected "'+r[1]+'"');g("end"),a.unshift(Ie("v",Ae(y,"end")))}}else if(g("..."))g(/^[ \t\v\f]+/),g("\n")&&(++k,x=0);else if(g(";",!1)){if(n&&-1<n.indexOf(";"))break;g(";"),m(!0)}else if(g("\n",!1)){if(n&&-1<n.indexOf("\n"))break;g("\n"),++k,m(!(x=0))}else if(g(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(r=g("%"))b=v.indexOf("\n"),v=v.slice(-1<b?b+1:v.length),-1<b&&++k,m(!(x=0));else if(r=(r=g("'"))||g('"'))o=p(r[0],!0)[0],a.unshift(Ie("'"===r[0]?o.split(""):o));else if(r=g(/^(&&|\|\|)[^&\|]/,1))u=r[1],l.unshift([u,x,k]),h();else if(r=g(/^(xor)[^a-zA-Z]/,1))u=r[1],l.unshift([u,x,k]),h();else if(r=g(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=r[1],l.unshift([u,x,k]),h();else if(r=g("~"))l.unshift(["~",x,k]),h();else if(r=g("="))l.unshift(["=",x,k]),h();else if(r=g(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=r[0],l.unshift([u,x,k]),h();else if(r=g(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(t=r[1],g(/^\s*\:\s*\)/))o=Ie("v",Ae(y,t)),a.unshift(o),l.unshift(["(:)",x,k]),h();else{for(f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");o=fn.call(E,t)?Ie(E[t],f):Ie("v",Ae(y,t,f.length?f:null)),a.unshift(o)}g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h())}else if(r=g(/^[_a-z][_a-z0-9]*/i))t=r[0],o=fn.call(E,t)&&0===E[t].length?Ie(E[t],[]):Ie("v",Ae(y,t)),a.unshift(o),g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h());else if(r=g(/^(-?\s*\d+(\.\d+)?([eE][+-]?\d+)?)([ij])?/))f=r[1].split(/\s+/).join(""),f=A?A(f):parseFloat(f,10),o=Ie(r[4]?new _(0,f):f),a.unshift(o);else if(r=g(/^(-?\s*\.\d+([eE][+-]?\d+)?)([ij])?/))f="-"===(f=r[1].split(/\s+/).join("")).charAt(0)?"-0"+f.slice(1):"0"+f,f=A?A(f):parseFloat(f,10),o=Ie(r[4]?new _(0,f):f),a.unshift(o);else if("["===(e=v.charAt(0)))v=v.slice(1),x+=1,(o=d())&&(a.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw S("mismatched brackets")}if("("===e)if(v=v.slice(1),x+=1,g(/^\s*\:\s*\)/))l.unshift(["(:)",x,k]),h();else{if(a.length&&l.reduce(function(n,r){return r=we[r[0]],n+(r.arity>a.length-n&&null!=r.arityalt?r.arityalt:r.arity)},0)<=a.length){for(h("set"),o=a.shift(),f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");f.length&&(o=Ie("v",Ae(y,o,f)))}else if(o=i(")"),!g(")"))throw S("mismatched parentheses");o&&(a.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw S("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw S(n?'missing expected "'+(q(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(v=v.slice(1),c=[x+=1,k],h("set"),a.length?f=1:(f=0,a.unshift(Ie(":")));o=i(":,)\n"),g(/^[ \t\v\f]+/),o?(a.unshift(o),++f):g(":",!1)&&a.unshift(Ie(":")),g(":"););1<f&&(l.unshift([3===f?"::":":",c[0],c[1]]),h())}}return m(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function Ne(n,r,t){var e;if(sn(n,Ie)){if(""===n.op)return n.arg;if("v"===n.op)return!1===r?n.arg:sn(n.arg.v,Ie)?_e(n.arg):mn(r)&&fn.call(r,n.arg.v)?r[n.arg.v]:await _e(n.arg);if(xe===n.op)return xe(n.arg,r,t);if(ke===n.op)return ke(n.arg,r,t);if(Se===n.op)return Se(n.arg,r,t);if("break"===n.op)return void(t&&hn(t.brk)&&t.brk());if("continue"===n.op)return void(t&&hn(t.cont)&&t.cont());if(we["="].fn===n.op)return t=t||{},e=await Ne(n.arg[0],!1),k(e)&&sn(e[0],Ae)&&(t.nargout=e.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[e,n.arg[1].arg.isByRef()?In(await Ne(n.arg[1],r,t)):await Ne(n.arg[1],r,t)]):n.op.apply(null,[e].concat(await Promise.all(n.arg.slice(1).map(function(n){return Ne(n,r,t)}))));if(hn(n.op))return(t&&p(t.nargout)&&hn(n.op.nargout)?n.op.nargout(t.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return Ne(n,r,t)})))}throw"invalid expr"}return an.op=we,Ae.prototype={constructor:Ae,ctx:null,v:null,i:null,get:async function(n){var r,t,e=this;if(""===e.v)return null;if(sn(e.v,Ie))r=await Ee(e.v);else{if(!fn.call(e.ctx,e.v)&&!fn.call(ln,e.v))throw'undefined variable "'+e.v+'"';r=(fn.call(e.ctx,e.v)?e.ctx:ln)[e.v]}return!0!==n&&null!=e.i?(t=rt(r),n=await Promise.all(e.i.map(function(n,r){return Ee(n,{end:1===e.i.length?t[0]*t[1]:t[r]})})),ar.apply(null,[r].concat(n))):r},set:async function(n){var r,t,e,i=this;if(""!==i.v)if(null!=i.i){if(sn(i.v,Ie))r=await Ee(i.v);else{if(!fn.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';r=i.ctx[i.v]}t=rt(r),1===(e=await Promise.all(i.i.map(function(n,r){return Ee(n,{end:1===i.i.length?t[0]*t[1]:t[r]})}))).length&&(e=e.concat(null)),lr.apply(null,[r].concat(e).concat([n]))}else sn(i.v,Ie)||(i.ctx[i.v]=n);return i},isset:function(){return q(this.v)&&fn.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},Ie.prototype={constructor:Ie,op:null,arg:null},c.createContext=function(){return{ans:null}},c.eval=async function(n,r,t){r=r||c.createContext();var e=qe(String(n),r,null==t?1:t,1),i=null,u=!1;if(k(e))for(var o=0,f=e.length;o<f;++o)e[o]&&(i=await Ne(e[o]),u=!0);else e&&(i=await Ne(e),u=!0);return u&&(k(i)||gn(i)||y(i)||q(i))&&(r.ans=i),u?i:null},an});