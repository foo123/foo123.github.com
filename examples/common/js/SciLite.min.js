/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.8
* 2025-12-23 00:31:13
* https://github.com/foo123/SciLite
*
**/!function(r,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(r)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(r)}):n in r||(r[n]=t.call(r)||1)&&"function"==typeof define&&define.amd&&define(function(){return r[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function r(){}var t,_=null,I=null,k=Math,L={},e={},R=k.PI,i=k.E,o=k.log(10),c=k.log(2),a=1/0,s=NaN,nn=1e-15,h=Number.MAX_VALUE,m=Number.MIN_VALUE,g=Number.MAX_SAFE_INTEGER,T=Number.MIN_SAFE_INTEGER,X=g,O=0,C=1,Z=-1,z=.5,rn=2,tn=10,en=[],un=Object.prototype.hasOwnProperty,fn=Object.prototype.toString,S=Array.isArray||function(n){return"[object Array]"===fn.call(n)},on={VERSION:"0.9.8",_:{},fn:{},op:{},constant:{pi:R,e:i,eps:nn,realmax:h,realmin:m,intmax:g,intmin:T,inf:a,Inf:a,nan:s,NaN:s}},l=on._,ln=on.constant,E=on.fn;function y(n){throw String(n)+": input(s) not supported"}function cn(n,r){return n instanceof r}function an(n){return"function"==typeof n}function sn(n){return"[object Object]"===fn.call(n)}function N(n){return"string"==typeof n}function hn(n){return gn(n)&&n.isNaN()||Number.isNaN(n)}function mn(n){return gn(n)&&!n.isFinite()||u(n)&&!isFinite(n)}function u(n){return"number"==typeof n}function gn(n){return null!=_&&n instanceof _}function $(n){return"number"==typeof n||null!=_&&n instanceof _}function p(n){return gn(n)&&n.isInt()||u(n)&&Number.isInteger(n)}function f(n){return null!=I&&n instanceof I}function pn(n){return!f(n)||Q(O,n.im)}function w(n,r){if(u(n)||f(n)||gn(n))return!0;if(!1===r){if(d(n)&&1===n.length)return!0;if(b(n)&&1===n.length&&1===n[0].length)return!0}return!1}function d(n){return S(n)&&w(n[0])}function b(n){return S(n)&&S(n[0])&&w(n[0][0])}function vn(n){return!S(n)}function dn(n){return S(n)&&!S(n[0])}function yn(n){return S(n)&&S(n[0])}function F(n,r){for(var t=new Array(n),e=0;e<n;++e)t[e]=an(r)?r(e,t):r;return t}function A(n,r,t){for(var e,i,u=new Array(n),f=0;f<n;++f)for(u[f]=i=new Array(r),e=0;e<r;++e)i[e]=an(t)?t(f,e,u):t;return u}function wn(n,t){return n.length?F(n[0],function(r){return 1<n.length?wn(n.slice(1),function(n){return an(t)?t([r].concat(n)):t}):an(t)?t([r]):t}):[]}function bn(n){return vn(n)?[[n]]:dn(n)?n.map(function(n){return[n]}):n}function xn(n,r){return $(n)?n:f(n)?r?n.re:n:d(n)&&1===n.length?xn(n[0],r):b(n)&&1===n.length&&1===n[0].length?xn(n[0][0],r):n}function j(n){if(yn(n)){if(1===W(n))return n[0];if(1===U(n))return n.map(function(n){return n[0]})}else if(vn(n))return[n];return n}function W(n){return n.length}function U(n){return n[0].length}function q(r,t){return F(r.length,function(n){return r[n][t]})}function v(n){return"number"==typeof n?n:gn(n)?n.$valueOf():n.valueOf()}function B(n){return null!=_&&"number"==typeof n?_(n):n}function Sn(n){return S(n)?n.map(Sn):w(n)?v(n):n}function An(n){return n=S(n)?n.map(An):n}function _n(r,n,t){if($(n))return r(n);if(f(n)){if(t)return r(n);if(Q(n.im,O))return r(n.re)}return S(n)?n.map(function(n){return _n(r,n,t)}):n}function In(t,n,e,i){return $(n)&&$(e)?t(n,e):w(n)&&w(e)?i?t(Pn(n),Pn(e)):pn(n)&&pn(e)?t(qn(n),qn(e)):s:S(n)&&S(e)?n.map(function(n,r){return In(t,n,e[r],i)}):s}function kn(t,r){null==r&&(r=1);function n(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),1<r&&S(n)&&(n.$scilitevarargout$=!0),n}return n.nargout=function(r){return function(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),1<r&&S(n)&&(n.$scilitevarargout$=!0),n}},n}function En(n){return hn(n)?n="nan":mn(n)?n=(Mn(n,O)?"-":"")+"inf":p(n)?n=String(n):$(n)?n=n.toFixed(4).replace(/\.0{4}$/,""):f(n)&&(n=String(n)),n}function Nn(t){var r;return null==t?t="":N(t)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(t)&&(t="\\text{"+t+"}"):t=hn(t)?"\\text{nan}":$(t)?[nn,h,m,g,T].reduce(function(n,r){return n||Q(t,r)},!1)?String(t):En(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):f(t)?String(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):b(t)?(r=!1,U(t)>l.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,k.round(l.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-k.round(l.MAXPRINTSIZE/2)))}),r=!0),"\\begin{bmatrix}"+(t=W(t)>l.MAXPRINTSIZE?t.slice(0,k.round(l.MAXPRINTSIZE/2)).concat([F(l.MAXPRINTSIZE,function(n){return k.round(l.MAXPRINTSIZE/2)===n&&r?"\\ddots":"\\vdots"})]).concat(t.slice(1-k.round(l.MAXPRINTSIZE/2))):t).map(function(n){return n.map(Nn).join(" & \\hskip 1em ")}).join(" \\\\ ")+"\\end{bmatrix}"):S(t)?(t=t.length>l.MAXPRINTSIZE?t.slice(0,k.round(l.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(t.slice(1-k.round(l.MAXPRINTSIZE/2))):t).map(Nn).join(" \\hskip 1em "):"object"==typeof t||"function"==typeof t?"":String(t),t}function jn(t){var r,e;return null==t?t="":N(t)||(t=hn(t)?"nan":$(t)?([nn,h,m,g,T].reduce(function(n,r){return n||Q(t,r)},!1)?String:En)(t):f(t)?String(t):b(t)?(r=!1,U(t)>l.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,k.round(l.MAXPRINTSIZE/2)).concat("..").concat(n.slice(1-k.round(l.MAXPRINTSIZE/2)))}),r=!0),W(t)>l.MAXPRINTSIZE&&(t=t.slice(0,k.round(l.MAXPRINTSIZE/2)).concat([F(l.MAXPRINTSIZE,function(n){return k.round(l.MAXPRINTSIZE/2)===n&&r?"\\":":"})]).concat(t.slice(1-k.round(l.MAXPRINTSIZE/2)))),e=F(U(t),function(n){return q(t,n).reduce(function(n,r){return k.max(n,jn(r).length)},0)}),t.map(function(n,r){return"["+n.map(function(n,r){n=jn(n);return n=n.length<e[r]?new Array(e[r]-n.length+1).join(" ")+n:n}).join("  ")+"]"}).join("\n")):S(t)?(t=t.length>l.MAXPRINTSIZE?t.slice(0,k.round(l.MAXPRINTSIZE/2)).concat([".."]).concat(t.slice(1-k.round(l.MAXPRINTSIZE/2))):t).map(jn).join("  "):"object"==typeof t||"function"==typeof t?"":String(t)),t}function qn(n){return S(n)?n.map(qn):f(n)&&Q(n.im,O)?n.re:n}function Pn(n){return I?S(n)?n.map(Pn):$(n)?new I(B(n),O):n:n}function Q(n,r){return u(n)?u(r)?n===r:r.eq(n):n.eq(r)}function Mn(n,r){return u(n)?u(r)?n<r:r.gt(n):n.lt(r)}function Rn(n,r){return u(n)?u(r)?r<n:r.lt(n):n.gt(r)}function Tn(n,r){return u(n)?u(r)?n<=r:r.gte(n):n.lte(r)}function Xn(n,r){return u(n)?u(r)?r<=n:r.lte(n):n.gte(r)}function V(n,r){return u(n)?u(r)?n+r:r.add(n):n.add(r)}function G(n,r){return u(n)?u(r)?n-r:r.neg().add(n):n.sub(r)}function H(n,r){return u(n)?u(r)?n*r:r.mul(n):n.mul(r)}function D(n,r){return u(n)?u(r)?n/r:_(n).div(r):n.div(r)}function Zn(n,r){return hn(n)||hn(r)?s:u(n)?u(r)?n<0&&!p(r)?qn(new I(n).pow(r)):k.pow(n,r):n<0&&!p(r)?qn(new I(_(n)).pow(r)):_(n).pow(r):Rn(O,n)&&!p(r)?qn(new I(n).pow(_(r))):n.pow(r)}function zn(n,r){return u(n)?u(r)?n%r:_(n).mod(r):n.mod(r)}function Ln(n){return u(n)?-n:n.neg()}function On(n){return u(n)?1/n:C.div(n)}function Cn(t,e){if(N(t)){if(N(e))return t===e?1:0;if(w(e))return t===String(e)?1:0;if(d(e))return e.map(function(n){return Cn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Cn(t,e[n][r])})}else if($(t)){if(N(e))return String(t)===e?1:0;if($(e))return Q(t,e)?1:0;if(f(e))return Q(e.re,t)&&Q(e.im,O)?1:0;if(d(e))return e.map(function(n){return Cn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Cn(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)===e?1:0;if($(e))return Q(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Q(t.re,e.re)&&Q(t.im,e.im)?1:0;if(d(e))return e.map(function(n){return Cn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Cn(t,e[n][r])})}else if(d(t)){if(N(e)||w(e))return t.map(function(n){return Cn(n,e)});if(d(e)){if(t.length!==e.length)throw"eq: inputs have incompatible dimensions";return t.map(function(n,r){return Cn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"eq: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Cn(t[r],e[n][r])})}}else if(b(t)){if(N(e)||w(e))return A(W(t),U(t),function(n,r){return Cn(t[n][r],e)});if(d(e)){if(U(t)!==e.length)throw"eq: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Cn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"eq: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Cn(t[n][r],e[n][r])})}}return 0}function $n(t,e){if(N(t)){if(N(e))return t===e?0:1;if(w(e))return t===String(e)?0:1;if(d(e))return e.map(function(n){return $n(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return $n(t,e[n][r])})}else if($(t)){if(N(e))return String(t)===e?0:1;if($(e))return Q(t,e)?0:1;if(f(e))return Q(e.re,t)&&Q(e.im,O)?0:1;if(d(e))return e.map(function(n){return $n(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return $n(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)===e?0:1;if($(e))return Q(t.re,e)&&Q(t.im,O)?0:1;if(f(e))return Q(t.re,e.re)&&Q(t.im,e.im)?0:1;if(d(e))return e.map(function(n){return $n(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return $n(t,e[n][r])})}else if(d(t)){if(N(e)||w(e))return t.map(function(n){return $n(n,e)});if(d(e)){if(t.length!==e.length)throw"ne: inputs have incompatible dimensions";return t.map(function(n,r){return $n(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"ne: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return $n(t[r],e[n][r])})}}else if(b(t)){if(N(e)||w(e))return A(W(t),U(t),function(n,r){return $n(t[n][r],e)});if(d(e)){if(U(t)!==e.length)throw"ne: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return $n(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"ne: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return $n(t[n][r],e[n][r])})}}return 0}function Fn(t,e){if(N(t)){if(N(e))return t<e?1:0;if(w(e))return t<String(e)?1:0;if(d(e))return e.map(function(n){return Fn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Fn(t,e[n][r])})}else if($(t)){if(N(e))return String(t)<e?1:0;if($(e))return Mn(t,e)?1:0;if(f(e))return Mn(e.re,t)&&Q(e.im,O)?1:0;if(d(e))return e.map(function(n){return Fn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Fn(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)<e?1:0;if($(e))return Mn(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Mn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Mn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(d(e))return e.map(function(n){return Fn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Fn(t,e[n][r])})}else if(d(t)){if(N(e)||w(e))return t.map(function(n){return Fn(n,e)});if(d(e)){if(t.length!==e.length)throw"lt: inputs have incompatible dimensions";return t.map(function(n,r){return Fn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"lt: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Fn(t[r],e[n][r])})}}else if(b(t)){if(N(e)||w(e))return A(W(t),U(t),function(n,r){return Fn(t[n][r],e)});if(d(e)){if(U(t)!==e.length)throw"lt: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Fn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"lt: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Fn(t[n][r],e[n][r])})}}return 0}function Wn(t,e){if(N(t)){if(N(e))return e<t?1:0;if(w(e))return t>String(e)?1:0;if(d(e))return e.map(function(n){return Wn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Wn(t,e[n][r])})}else if($(t)){if(N(e))return String(t)>e?1:0;if($(e))return Rn(t,e)?1:0;if(f(e))return Rn(e.re,t)&&Q(e.im,O)?1:0;if(d(e))return e.map(function(n){return Wn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Wn(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)>e?1:0;if($(e))return Rn(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Rn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Rn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(d(e))return e.map(function(n){return Wn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Wn(t,e[n][r])})}else if(d(t)){if(N(e)||w(e))return t.map(function(n){return Wn(n,e)});if(d(e)){if(t.length!==e.length)throw"gt: inputs have incompatible dimensions";return t.map(function(n,r){return Wn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"gt: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Wn(t[r],e[n][r])})}}else if(b(t)){if(N(e)||w(e))return A(W(t),U(t),function(n,r){return Wn(t[n][r],e)});if(d(e)){if(U(t)!==e.length)throw"gt: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Wn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"gt: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Wn(t[n][r],e[n][r])})}}return 0}function Un(t,e){if(N(t)){if(N(e))return t<=e?1:0;if(w(e))return t<=String(e)?1:0;if(d(e))return e.map(function(n){return Un(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Un(t,e[n][r])})}else if($(t)){if(N(e))return String(t)<=e?1:0;if($(e))return Tn(t,e)?1:0;if(f(e))return Tn(e.re,t)&&Q(e.im,O)?1:0;if(d(e))return e.map(function(n){return Un(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Un(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)<=e?1:0;if($(e))return Tn(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Tn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Tn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(d(e))return e.map(function(n){return Un(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Un(t,e[n][r])})}else if(d(t)){if(N(e)||w(e))return t.map(function(n){return Un(n,e)});if(d(e)){if(t.length!==e.length)throw"le: inputs have incompatible dimensions";return t.map(function(n,r){return Un(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"le: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Un(t[r],e[n][r])})}}else if(b(t)){if(N(e)||w(e))return A(W(t),U(t),function(n,r){return Un(t[n][r],e)});if(d(e)){if(U(t)!==e.length)throw"le: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Un(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"le: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Un(t[n][r],e[n][r])})}}return 0}function Bn(t,e){if(N(t)){if(N(e))return e<=t?1:0;if(w(e))return t>=String(e)?1:0;if(d(e))return e.map(function(n){return Bn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Bn(t,e[n][r])})}else if($(t)){if(N(e))return String(t)>=e?1:0;if($(e))return Xn(t,e)?1:0;if(f(e))return Xn(e.re,t)&&Q(e.im,O)?1:0;if(d(e))return e.map(function(n){return Bn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Bn(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)>=e?1:0;if($(e))return Xn(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Xn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Xn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(d(e))return e.map(function(n){return Bn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Bn(t,e[n][r])})}else if(d(t)){if(N(e)||w(e))return t.map(function(n){return Bn(n,e)});if(d(e)){if(t.length!==e.length)throw"ge: inputs have incompatible dimensions";return t.map(function(n,r){return Bn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"ge: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Bn(t[r],e[n][r])})}}else if(b(t)){if(N(e)||w(e))return A(W(t),U(t),function(n,r){return Bn(t[n][r],e)});if(d(e)){if(U(t)!==e.length)throw"ge: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Bn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"ge: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Bn(t[n][r],e[n][r])})}}return 0}function Qn(n){return f(n)?n.sign():L.sign(n)}function J(n,r){return $(n)&&$(r)?V(n,r):f(n)&&w(r)?n.add(r):f(r)&&w(n)?r.add(n):s}function Vn(n,r){return $(n)&&$(r)?G(n,r):f(n)&&w(r)?n.sub(r):f(r)&&w(n)?r.neg().add(n):s}function K(n,r){return $(n)&&$(r)?H(n,r):f(n)&&w(r)?n.mul(r):f(r)&&w(n)?r.mul(n):s}function Y(n,r){return $(n)&&$(r)?D(n,r):f(n)&&w(r)?n.div(r):f(r)&&w(n)?r.inv().mul(n):s}function Gn(n,r){return $(n)&&$(r)?Zn(n,r):f(n)&&w(r)?n.pow(r):f(r)&&w(n)?new I(n,O).pow(r):s}function Hn(n){return $(n)?Ln(n):f(n)?n.neg():s}function Dn(n){return $(n)?n:f(n)?n.conj():s}function Jn(n){return $(n)?Q(n,O)?a:On(n):f(n)?Q(n.abs(),O)?new I(a,Mn(n.im,O)?a:-a):n.inv():s}function Kn(n){return $(n)?L.abs(n):f(n)?n.abs():s}function Yn(n){return $(n)?Mn(n,O)?ln.pi:O:f(n)?n.angle():s}function nr(r,e){if(N(r)&&N(e))return r+e;if(w(r)&&w(e))return J(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return nr(n,t[r])})});throw"add: matrix dimensions do not match"}if(d(r)&&d(e)){if(r.length===e.length)return r.map(function(n,r){return nr(n,e[r])});throw"add: vector dimensions do not match"}return S(r)?r.map(function(n){return nr(n,e)}):S(e)?e.map(function(n){return nr(r,n)}):void y("add")}function rr(r,e){if(w(r)&&w(e))return Vn(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return rr(n,t[r])})});throw"sub: matrix dimensions do not match"}if(d(r)&&d(e)){if(r.length===e.length)return r.map(function(n,r){return rr(n,e[r])});throw"sub: vector dimensions do not match"}return S(r)?r.map(function(n){return rr(n,e)}):S(e)?e.map(function(n){return rr(r,n)}):void y("sub")}function tr(r,e){if(w(r)&&w(e))return K(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return tr(n,t[r])})});throw"dotmul: matrix dimensions do not match"}if(d(r)&&d(e)){if(r.length===e.length)return r.map(function(n,r){return tr(n,e[r])});throw"dotmul: vector dimensions do not match"}return S(r)?r.map(function(n){return tr(n,e)}):S(e)?e.map(function(n){return tr(r,n)}):void y("dotmul")}function er(r,e){if(w(r)&&w(e))return Y(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return er(n,t[r])})});throw"dotdiv: matrix dimensions do not match"}if(d(r)&&d(e)){if(r.length===e.length)return r.map(function(n,r){return er(n,e[r])});throw"dotdiv: vector dimensions do not match"}return S(r)?r.map(function(n){return er(n,e)}):S(e)?e.map(function(n){return er(r,n)}):void y("dotdiv")}function ir(r,e){if(w(r)&&w(e))return Gn(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return ir(n,t[r])})});throw"dotpow: matrix dimensions do not match"}if(d(r)&&d(e)){if(r.length===e.length)return r.map(function(n,r){return ir(n,e[r])});throw"dotpow: vector dimensions do not match"}return S(r)?r.map(function(n){return ir(n,e)}):S(e)?e.map(function(n){return ir(r,n)}):void y("dotpow")}function P(i,u){if(w(i)&&w(u))return K(i,u);if(b(i)&&b(u)){if(U(i)===W(u))return n=W(i),r=U(u),f=W(u),A(n,r,function(n,r){for(var t=O,e=0;e<f;++e)t=J(t,K(i[n][e],u[e][r]));return t});throw"mul: matrix-matrix dimensions do not match"}if(d(i)&&b(u)){if(i.length===W(u))return r=U(u),f=i.length,A(n=1,r,function(n,r){for(var t=O,e=0;e<f;++e)t=J(t,K(i[e],u[e][r]));return t});throw"mul: vector-matrix dimensions do not match"}if(b(i)&&d(u)){var f;if(U(i)===u.length)return n=W(i),f=u.length,A(n,r=1,function(n,r){for(var t=O,e=0;e<f;++e)t=J(t,K(i[n][e],u[e]));return t});throw"mul: matrix-vector dimensions do not match"}var n,r;return d(i)&&d(u)?A(n=i.length,r=u.length,function(n,r){return K(i[n],u[r])}):S(i)?i.map(function(n){return P(n,u)}):S(u)?u.map(function(n){return P(i,n)}):void y("mul")}function ur(n,r){if(w(n)&&w(r))return Gn(n,r);if(b(n)&&W(n)===U(n)&&p(r)){if((r=v(r))<0&&(r=-r,!(n=tt(n))||!n.length))throw"pow: no inverse";if(0===r)return wr(W(n));if(1===r)return n;if(2===r)return P(n,n);for(var t=wr(W(n));0!==r;)1&r&&(t=P(t,n)),0<(r>>=1)&&(n=P(n,n));return t}y("pow")}function fr(n){return w(n)?Hn(n):S(n)?n.map(fr):n}function or(e,n=":",t=null){if(dn(e)){if(d(n)&&n.length===e.length&&$r(n,function(n){return 0===v(n)||1===v(n)}))return f=1===(f=n.reduce(function(n,r,t){return 1===v(r)&&n.push(e[t]),n},[])).length?f[0]:f;if(":"===(n=w(n)?xn(n,!0):n)||p(n)||d(n))return r=e.length,1===(f=(n=p(n=":"===n?br(1,r):n)?[n]:n).map(function(n){if((n=v(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[n-1]})).length?f[0]:f;throw"get: invalid range"}if(yn(e)){var i=W(e),u=U(e),r=i*u;if(null==t&&b(n)&&W(n)===i&&U(n)===u&&$r(n,function(n){return 0===v(n)||1===v(n)})){for(var f=[],o=0;o<u;++o)for(var l=0;l<i;++l)1===v(n[l][o])&&f.push(e[l][o]);return f=1===f.length?f[0]:f}if(w(n)&&(n=xn(n,!0)),w(t)&&(t=xn(t,!0)),":"===n||p(n)||d(n)){if(p(n=":"===n?br(1,i):n)&&(n=[n]),null==t)return f=1===(f=n.map(function(n){if((n=v(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[(n-1)%i][k.floor((n-1)/i)]})).length?f[0]:f;if(":"===t||p(t)||d(t))return p(t=":"===t?br(1,u):t)&&(t=[t]),f=1===(f=n.map(function(r){if((r=v(r))<1&&(r+=i),r<1||i<r)throw"get: index out of bounds";return t.map(function(n){if((n=v(n))<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[r-1][n-1]})})).length&&1===f[0].length?f[0][0]:f}throw"get: invalid range"}return e}function lr(i,r=":",n=null,u=null){if(dn(i)){if(yn(u)&&(u=q(u,0)),d(r)&&r.length===i.length&&$r(r,function(n){return 0===v(n)||1===v(n)})){if(vn(u))return r.forEach(function(n,r){1===v(n)&&(i[r]=u)}),i;if(S(u))return h=0,t=u.length,r.forEach(function(n,r){if(1===v(n)){if(t<=h)throw"set: index out of bounds";i[r]=u[h++]}}),i}if(":"===(r=w(r)?xn(r,!0):r)||p(r)||d(r)){var e=i.length;if(p(r=":"===r?br(1,e):r)&&(r=[r]),vn(u))return r.forEach(function(n){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u}),i;if(S(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u[r]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(yn(i)){var f,o,t,l,c,a,s,h,m=W(i),g=U(i),e=m*g;if(b(r)&&W(r)===m&&U(r)===g&&$r(r,function(n){return 0===v(n)||1===v(n)})){if(vn(u))return r.forEach(function(n,t){n.forEach(function(n,r){1===v(n)&&(i[t][r]=u)})}),i;if(yn(u)){for(f=W(u),o=U(u),s=c=0;c<g;++c,++s){if(1===o)s=0;else if(o<=s)throw"set: index out of bounds";for(a=l=0;l<m;++l,++a)if(1===v(r[l][c])){if(1===f)a=0;else if(f<=a)throw"set: index out of bounds";i[l][c]=u[a][s]}}return i}if(S(u)){for(t=u.length,c=h=0;c<g;++c)for(l=0;l<m;++l)if(1===v(r[l][c])){if(t<=h)throw"set: index out of bounds";i[l][c]=u[h++]}return i}}if(w(r)&&(r=xn(r,!0)),w(n)&&(n=xn(n,!0)),":"===r||p(r)||d(r)){if(null==n){if(p(r=":"===r?br(1,e):r)&&(r=[r]),vn(u))return r.forEach(function(n){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][k.floor((n-1)/m)]=u}),i;if(yn(u))return f=W(u),o=U(u),r.forEach(function(n,r){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";var t=1===f?0:r%m,r=1===o?0:k.floor(r/m);if(f<=t||o<=r)throw"set: index out of bounds";i[(n-1)%m][k.floor((n-1)/m)]=u[t][r]}),i;if(S(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][k.floor((n-1)/m)]=u[r]}),i}else if(":"===n||p(n)||d(n)){if(p(r=":"===r?br(1,m):r)&&(r=[r]),p(n=":"===n?br(1,g):n)&&(n=[n]),vn(u))return r.forEach(function(r){if((r=v(r))<1&&(r+=m),r<1||m<r)throw"set: index out of bounds";n.forEach(function(n){if((n=v(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";i[r-1][n-1]=u})}),i;if(yn(u))return f=W(u),o=U(u),r.forEach(function(t,e){if((t=v(t))<1&&(t+=m),t<1||m<t)throw"set: index out of bounds";if(1===f)e=0;else if(f<=e)throw"set: index out of bounds";n.forEach(function(n,r){if((n=v(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";if(1===o)r=0;else if(o<=r)throw"set: index out of bounds";i[t-1][n-1]=u[e][r]})}),i;if(S(u)&&u.length>=r.length*n.length)return h=0,n.forEach(function(t,n){if((t=v(t))<1&&(t+=g),t<1||g<t)throw"set: index out of bounds";r.forEach(function(n,r){if((n=v(n))<1&&(n+=m),n<1||m<n)throw"set: index out of bounds";i[n-1][t-1]=u[h++]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function cr(n,r){var t,e,i;return u(n)&&u(r)?(t=n,e=r,t=k.abs(t),e=k.abs(e),(i=0)===t?e:0===e?t:e<t?t*k.sqrt(1+(i=e/t)*i):t<e?e*k.sqrt(1+(i=t/e)*i):t*k.SQRT2):L.sqrt(V(H(n,n),H(r,r)))}function ar(n,r){var t,n=1===arguments.length?n:rr(n,r);return n.reduce(function(n,r){return n&&(u(r)||f(r)&&u(r.re)&&u(r.im))},!0)?(t=0,r=(r=n).map(function(n){return n=Kn(n),t<n&&(t=n),n}),0===t?0:t*k.sqrt(r.reduce(function(n,r){return r===t?n+1:n+(n=r/t)*n},0))):L.sqrt(mr(Rr(n,n)))}function sr(){var n,r,t,e=0,i=0;if(u(sr.z1))return t=sr.z1,sr.z1=null,t;for(;0===e||1===e;)e=k.random();for(;0===i||1===i;)i=k.random();return r=(n=k.sqrt(-2*k.log(e)))*k.cos(2*R*i),t=n*k.sin(2*R*i),sr.z1=t,r}function hr(){if(!cn(this,hr))return new hr;this.data=[]}function mr(n){return _n(function(n){return f(n)?n.re:n},n,!0)}function gr(n){return _n(function(n){return f(n)?n.im:0},n,!0)}function pr(n){return _n(Dn,n,!0)}function vr(n){return _n(Kn,n,!0)}function dr(n,r){if(mn(r=null==r?rn:r)){if(w(n=j(n)))return Kn(n);if(d(n))return(Mn(r,O)?jr:qr)(vr(n));if(b(n)&&Rn(r,O))return qr(Pr(vr(Sr(n))))}else if($(r)){if(n=j(n),Q(r,C)){if(w(n))return Kn(n);if(d(n))return Pr(vr(n));if(b(n))return qr(Pr(vr(n)))}else if(Q(r,rn)){if(w(n))return Kn(n);if(d(n))return ar(n);if(b(n))return qr(gt(n,null,!1,!1))}else if(Rn(r,O)){if(w(n))return Kn(n);if(d(n))return function(n,r,t){return 2===arguments.length&&(t=r),Gn(Pr(ir(vr(2===arguments.length?n:rr(n,r)),t)),On(t))}(n,r)}}else if("fro"===r&&b(n))return L.sqrt(ft(mr(P(Ar(n),n))));y("norm")}function yr(n,r){return d(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),O)}function wr(n,t){return null==t&&(t=C),A(v(n=xn(n=null==n?1:n,!0)),v(n),function(n,r){return n===r?t:O})}function br(n,r,t){if(1===arguments.length&&S(n)){if(yn(n)){for(var e,i=W(n),u=U(n),f=new Array(u*i),o=0,l=0;l<u;++l)for(e=0;e<i;++e)f[o++]=n[e][l];return f}return n}if(null!=t&&null!=r||(null!=r?(t=r,r=C):(t=n,n=r=C)),n=xn(n,!0),r=xn(r,!0),t=xn(t,!0),f=[],Rn(r,O))for(;Tn(n,t);n=V(n,r))f.push(n);else if(Mn(r,O))for(;Xn(n,t);n=V(n,r))f.push(n);return f}function xr(n,r,t){if("horz"===n){if(dn(r)&&dn(t))return r.concat(t);if(yn(r)&&yn(t)&&W(r)===W(t))return r.map(function(n,r){return n.concat(t[r])})}if("vert"===n){if(dn(r)&&dn(t))return r.concat(t);if(yn(r)&&yn(t)&&U(r)===U(t))return r.concat(t)}y("cat")}function Sr(t){return yn(t)?A(U(t),W(t),function(n,r){return t[r][n]}):t}function Ar(t){return yn(t)?A(U(t),W(t),function(n,r){return w(t[r][n])?Dn(t[r][n]):t[r][n]}):dn(t)?t.map(function(n){return w(n)?Dn(n):n}):w(t)?Dn(t):t}function _r(t,i){return i=v(i||0),vn(t)?[[t]]:dn(t)?A(t.length,t.length,function(n,r){return i===n-r?t[n]:O}):yn(t)?t.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i===e-t&&n.push(r),n},n)},[]):void y("diag")}function Ir(t,n){var e,i;return vn(t)?t:dn(t)?t.slice().reverse():yn(t)?(e=W(t),i=U(t),1===(n=v(n=null==n?1:n))?A(e,i,function(n,r){return t[e-1-n][r]}):2===n?A(e,i,function(n,r){return t[n][i-1-r]}):t):void y("flip")}function kr(n,r){var t=mr(n),e=mr(r),n=gr(n),r=gr(r),t=Mn(t,e)?-1:Rn(t,e)?1:0,e=Mn(n,r)?-1:Rn(n,r)?1:0;return t||e}function Er(n,r){var t=Kn(n),e=Kn(r),n=Yn(n),r=Yn(r),t=Mn(t,e)?-1:Rn(t,e)?1:0,e=Mn(n,r)?-1:Rn(n,r)?1:0;return t||e}function Nr(r,t,e,i,n){var u;if(vn(r))return r;if(d(r))return null==i&&(i=pn(r)?kr:Er),u=r.map(function(n,r){return{v:n,i:r}}).sort("descend"===e?function(n,r){return i(r.v,n.v)||n.i-r.i}:function(n,r){return i(n.v,r.v)||n.i-r.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(b(r)){if(1===t)return n?(u=F(U(r),function(n){n=q(r,n);return Nr(n,t,e,null==i?pn(n)?kr:Er:i,!0)}),[A(W(r),U(r),function(n,r){return u[r][0][n]}),A(W(r),U(r),function(n,r){return u[r][1][n]})]):(u=F(U(r),function(n){n=q(r,n);return Nr(n,t,e,null==i?pn(n)?kr:Er:i,!1)}),A(W(r),U(r),function(n,r){return u[r][n]}));if(2===t)return n?(u=F(W(r),function(n){n=r[n];return Nr(n,t,e,null==i?pn(n)?kr:Er:i,!0)}),[A(W(r),U(r),function(n,r){return u[n][0][r]}),A(W(r),U(r),function(n,r){return u[n][1][r]})]):(u=F(W(r),function(n){n=r[n];return Nr(n,t,e,null==i?pn(n)?kr:Er:i,!1)}),A(W(r),U(r),function(n,r){return u[n][r]}))}y("sort")}function jr(r){return w(r=j(r))?r:d(r)?r.reduce(function(n,r){return n=Mn(r,n)?r:n},a):b(r)?F(U(r),function(n){return jr(q(r,n))}):s}function qr(r){return w(r=j(r))?r:d(r)?r.reduce(function(n,r){return n=Rn(r,n)?r:n},-a):b(r)?F(U(r),function(n){return qr(q(r,n))}):s}function Pr(r){return w(r=j(r))?r:d(r)?r.reduce(J,O):b(r)?F(U(r),function(n){return Pr(q(r,n))}):s}function Mr(r){return w(r=j(r))?r:d(r)?r.reduce(K,C):b(r)?F(U(r),function(n){return Mr(q(r,n))}):s}function Rr(r,e,i){if(i=!0===i,r=j(r),e=j(e),w(r)&&w(e))return K(r,i?e:Dn(e));if(d(r)&&d(e)){if(r.length===e.length)return r.reduce(function(n,r,t){return J(n,K(r,i?e[t]:Dn(e[t])))},0)}else if(b(r)&&b(e)&&W(r)===W(e)&&U(r)===U(e))return F(U(r),function(n){return Rr(q(r,n),q(e,n),i)});return 0}function Tr(t,e){var n,r,i,u;if(b(t)){if(b(e))return n=W(t),r=U(t),i=W(e),u=U(e),A(n*i,r*u,function(n,r){return P(t[k.floor(n/i)][k.floor(r/u)],e[n%i][r%u])});if(d(e))return n=W(t),r=U(t),i=1,u=e.length,A(n*i,r*u,function(n,r){return P(t[n][k.floor(r/u)],e[r%u])})}else if(d(t)){if(d(e))return A(t.length,e.length,function(n,r){return P(t[n],e[r])});if(b(e))return n=t.length,i=W(e),u=U(e),A(n*i,(r=1)*u,function(n,r){return P(t[k.floor(n/i)],e[n%i][r%u])})}return P(t,e)}function Xr(r,t,n){if(d(t)){var e,i,u;if(null==r||w(r)){for(null==r&&(r=C),e=0,i=t.length-1,u=O;e<i;++e)u=J(u,K(r,Y(J(t[e+1],t[e]),rn)));return u}if(d(r)&&r.length===t.length){for(e=0,i=r.length-1,u=O;e<i;++e)u=J(u,K(Kn(Vn(r[e+1],r[e])),Y(J(t[e+1],t[e]),rn)));return u}}else if(b(t))if(1===(n=v(n=null==n?1:n))){if(null==r||w(r)||d(r)&&r.length===W(t))return F(U(t),function(n){return Xr(r,q(t,n))});if(b(r)&&W(r)===W(t)&&U(r)===U(t))return F(U(t),function(n){return Xr(null==r?null:q(r,n),q(t,n))})}else if(2===n){if(null==r||w(r)||d(r)&&r.length===U(t))return F(W(r),function(n){return Xr(r,t[n])});if(b(r)&&W(r)===W(t)&&U(r)===U(t))return F(W(r),function(n){return Xr(r[n],t[n])})}y("trapz")}function Zr(r,t,e,i){var u;if(w(r))return r;if(d(r)){if("reverse"===(e=null==e?"forward":e))return r.slice().reverse().map(function(n,r){return u=0===r?n:t(u,n)}).reverse();if("forward"===e)return r.map(function(n,r){return u=0===r?n:t(u,n)})}else if(b(r)){if(1===(i=v(i=null==i?1:i)))return F(U(r),function(n){return Zr(q(r,n),t,e,i)});if(2===i)return F(W(r),function(n){return Zr(r[n],t,e,i)})}return!1}function zr(r,t,e,i,u){var f;if(d(r))return F(f=r.length,function(n){return t(r.slice(k.max(0,n-e),k.min(f-1,n+i)+1))});if(b(r)){if(1===(u=v(u=null==u?1:u)))return F(U(r),function(n){return zr(q(r,n),t,e,i,u)});if(2===u)return F(W(r),function(n){return zr(r[n],t,e,i,u)})}return!1}function Lr(r){var n=[].slice.call(arguments,1);return S(n[0])&&(n=n[0]),vn(r)?n.length?n.map(function(n){return[1,1][v(n)-1]}):[1,1]:dn(r)?n.length?n.map(function(n){return[1,r.length][v(n)-1]}):[1,r.length]:yn(r)?n.length?n.map(function(n){return[W(r),U(r)][v(n)-1]}):[W(r),U(r)]:[]}function Or(n){return S(n)?k.max.apply(null,Lr(n)):null==n?0:1}function Cr(n,i){var u;return d(n)?n.reduce(function(n,r,t){return i(r,t+1,1)&&n.push(t+1),n},[]):b(n)?(u=W(n),n.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i(r,e+1,t+1)&&n.push(e+u*t+1),n},n)},[])):[]}function $r(n,r){if(w(n))return r(n,1,1)?1:0;if(d(n)){for(var t=0,e=n.length;t<e;++t)if(!r(n[t],t+1,1))return 0;return 1}if(b(n)){for(var t=0,i=W(n),u=U(n);t<i;++t)for(var f=0;f<u;++f)if(!r(n[t][f],t+1,f+1))return 0;return 1}return 0}function Fr(n,r){if(w(n))return r(n,1,1)?1:0;if(d(n)){for(var t=0,e=n.length;t<e;++t)if(r(n[t],t+1,1))return 1}else if(b(n))for(var t=0,i=W(n),u=U(n);t<i;++t)for(var f=0;f<u;++f)if(r(n[t][f],t+1,f+1))return 1;return 0}function Wr(n,r,t){var e;r!==t&&(e=n[r],n[r]=n[t],n[t]=e)}function Ur(n,r,t,e,i,u){var f,o=n[0].length;for(null==e&&(e=C),null==i&&(i=C),f=u||0;f<o;++f)n[r][f]=J(K(i,n[r][f]),K(e,n[t][f]))}function Br(n,r,t,e,i,u,f){for(var o,l,c=n[0].length,a=0;a<c;++a)o=n[r][a],l=n[t][a],n[r][a]=J(K(e,o),K(i,l)),n[t][a]=J(K(u,o),K(f,l))}function Qr(n,r,t,e,i,u,f){for(var o,l,c=n.length,a=0;a<c;++a)o=n[a][r],l=n[a][t],n[a][r]=J(K(e,o),K(u,l)),n[a][t]=J(K(i,o),K(f,l))}function Vr(n,t){return w(t)?w(n)?Cn(n,t):n.filter(function(n){return Vr(n,t)}).length===n.length:!!S(t)&&(w(n)?Vr(t,n):n.length===t.length&&n.filter(function(n,r){return Vr(n,t[r])}).length===t.length)}function Gr(t,e,i,n,r){var u=W(t),f=U(t);return u&&f?S(e)&&S(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<f}),A(e.length,i.length,function(n,r){return t[e[n]][i[r]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=f),(n=null==n?u-1:n)<0&&(n+=u),(r=null==r?f-1:r)<0&&(r+=f),e=k.max(0,k.min(u-1,e)),n=k.max(0,k.min(u-1,n)),i=k.max(0,k.min(f-1,i)),r=k.max(0,k.min(f-1,r)),e<=n&&i<=r?A(n-e+1,r-i+1,function(n,r){return t[e+n][i+r]}):[]):[]}function Hr(t,e,n){var i=W(t),u=U(t),f=W(e),o=U(e);return"vert"===(n=n||"horz")?A(i+f,k.max(u,o),function(n,r){return u<=r?n<i?O:e[n-i][r]:o<=r?n<i?t[n][r]:O:(n<i?t[n]:e[n-i])[r]}):A(k.max(i,f),u+o,function(n,r){return i<=n?r<u?O:e[n][r-u]:f<=n?r<u?t[n][r]:O:r<u?t[n][r]:e[n][r-u]})}function Dr(n,r,t,e){var i,u,f,o=W(n),l=U(n);if(!1===t||o===l){for(e=B(e||0),i=k.min(o,l),u=0;u<i;++u){if("lower"===r||"diagonal"===r)for(f=u+1;f<i;++f)if(!Un(Kn(n[u][f]),e))return;if("upper"===r||"diagonal"===r)for(f=0;f<u;++f)if(!Un(Kn(n[u][f]),e))return}if(l<o){for(u=i;u<o;++u)for(f=0;f<l;++f)if(!Un(Kn(n[u][f]),e))return}else if(o<l)for(f=i;f<l;++f)for(u=0;u<o;++u)if(!Un(Kn(n[u][f]),e))return;return 1}}function Jr(n,r){var t,e,i;return Cn(r,O)?(t=C,e=O):Cn(n,O)?(t=O,Cn(e=Qn(Dn(r)),O)&&(e=C)):(i=Qn(n),t=Y(n=Kn(n),n=cr(n,Kn(r))),e=Y(K(i,Dn(r)),n)),[t,e]}function Kr(n,r,t,e,i){var u,f,o,l,c=W(i),a=An(i),s=2===r.length&&w(r[0])?(f=r[0],o=Hn(r[1]),l=r[1],r[0]):2===r.length&&2===r[0].length?(f=r[0][0],o=r[0][1],l=r[1][0],r[1][1]):(f=r[t][t],o=r[t][e],l=r[e][t],r[e][e]);if("right"===n)for(u=0;u<c;++u)a[u][t]=J(K(f,i[u][t]),K(l,i[u][e])),a[u][e]=J(K(o,i[u][t]),K(s,i[u][e]));else for(u=0;u<c;++u)a[t][u]=J(K(f,i[t][u]),K(o,i[e][u])),a[e][u]=J(K(l,i[t][u]),K(s,i[e][u]));return a}l.decimal=function(n){"function"==typeof n?(_=n,un.call(_.prototype,"_valueof")||(_.prototype._valueof=null,_.prototype.$valueOf=function(){return null==this._valueof&&(this._valueof=parseFloat(this.toFixed(9))),this._valueof},_.prototype.sign=function(){return _.sign(this)}),O=_(0),C=_(1),Z=_(-1),z=_(.5),rn=_(2),tn=_(10),o=_(k.log(10)),c=_(k.log(2)),ln.eps=_(nn),ln.pi=_(R),ln.e=_(i),ln.realmax=_(h),ln.realmin=_(m),ln.intmax=_(g),ln.intmin=_(T),ln.bitmax=_(X)):(_=null,O=0,Z=-(C=1),z=.5,rn=2,tn=10,c=k.log(2),o=k.log(10),ln.eps=nn,ln.pi=R,ln.e=i,ln.realmax=h,ln.realmin=m,ln.intmax=g,ln.intmin=T,ln.bitmax=X),I&&(new I(O,C),t=new I(ln.e,O)),en.forEach(function(n){n()})},l.is_array=S,l.is_obj=sn,l.is_string=N,l.is_nan=hn,l.is_inf=mn,l.is_number=u,l.is_decimal=gn,l.is_int=p,l.is_complex=f,l.is_real=pn,l.is_scalar=w,l.is_vector=d,l.is_matrix=b,l.array=F,l.matrix=A,l.ndarray=wn,E.rowvec=function(n){return vn(n)?[[n]]:dn(n)?[n]:n},E.colvec=bn,l.sca=xn,l.vec=j,l.tonumber=Sn,l.todecimal=function n(r){return S(r)?r.map(n):w(r)?B(r):r},l.copy=An,l.apply=_n,l.apply2=In,l.exist=function(n,r){return sn(r)&&N(n)&&un.call(r,n)?1:0},l.varargout=kn,l.num2str=En,l.MAXPRINTSIZE=a,l.tex=function(n){return S(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(Nn).join("\\]\n\\[")+"\\]":S(n[0])?S(n[0][0])||!S(n[1])||n[0].length!==n[1].length?"\\["+n.map(Nn).join("\\]\n\\[")+"\\]":"\\["+Nn(n)+"\\]":"\\["+(n=n.length>l.MAXPRINTSIZE?n.slice(0,k.round(l.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-k.round(l.MAXPRINTSIZE/2))):n).map(Nn).join("\\]\n\\[")+"\\]":"":(n=Nn(n)).length&&(n="\\["+n+"\\]"),n},l.str=function(n){return n=S(n)?n.length?n.$scilitevarargout$?n.map(jn).join("\n\n"):S(n[0])?S(n[0][0])||!S(n[1])||n[0].length!==n[1].length?n.map(jn).join("\n\n"):jn(n):(n=n.length>l.MAXPRINTSIZE?n.slice(0,k.round(l.MAXPRINTSIZE/2)).concat(":").concat(n.slice(1-k.round(l.MAXPRINTSIZE/2))):n).map(jn).join("\n"):"":jn(n)},l.neq=Q,l.nlt=Mn,l.ngt=Rn,l.nle=Tn,l.nge=Xn,l.nadd=V,l.nsub=G,l.nmul=H,l.ndiv=D,l.npow=Zn,l.nmod=zn,l.nneg=Ln,l.ninv=On,l.eq=Cn,l.ne=$n,l.lt=Fn,l.gt=Wn,l.le=Un,l.ge=Bn,l.ssign=Qn,l.sadd=J,l.ssub=Vn,l.smul=K,l.sdiv=Y,l.spow=Gn,l.sneg=Hn,l.sconj=Dn,l.sinv=Jn,l.sabs=Kn,l.sangle=Yn,l.add=nr,l.sub=rr,l.dotmul=tr,E.times=tr,l.dotdiv=er,l.dotpow=ir,E.power=ir,l.mul=P,l.pow=ur,E.mpower=ur,l.neg=fr,l.get=or,l.set=lr,l.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],hr.prototype={constructor:hr,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,option:function(n,r,t,e){var i,u,f,o={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},l={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},c={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},a=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:c[a[(e||0)%a.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=c[a[(e||0)%a.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=o["-"]),n._LineStyle||(n._LineStyle="-"),t=t||0;t<r.length;){if("Color"===r[t])N(i=r[t+1])?un.call(l,i)?n.Color=c[l[i]]:un.call(c,i)&&(n.Color=c[i]):d(i)&&3===i.length&&(n.Color=Sn(i));else if("LineWidth"===r[t])$(i=r[t+1])&&(n.LineWidth=2*Sn(i));else{if("LineStyle"!==r[t]){if(N(r[t])){for(u in f=!1,i=r[t],c)-1<i.indexOf(u)&&(n.Color=c[u],f=!0);for(u in o)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=o[u],f=!0);if(f){t+=1;continue}}break}N(i=r[t+1])&&un.call(o,i)&&(n._LineStyle=i,n.LineStyle=o[i])}t+=2}return t},parse:function(n,r,t){var e,i,u,f,o,l,c=this,a=0,s=0;if("pie"===r)for(;a<n.length;)d(n[a])?c.data.push({y:Sn(n[a++])}):a+=1;else if("plot3"===r)for(;a<n.length;)o=f=u=null,d(n[a])&&(u=n[a]),d(n[a+1])&&(f=n[a+1]),d(n[a+2])&&(o=n[a+2],a+=3),u&&f&&o?(a=c.option(l={},n,a,s),c.data.push({x:Sn(u),y:Sn(f),z:Sn(o),style:l}),++s):a+=1;else for(;a<n.length;)if(f=u=null,d(n[a])&&(u=n[a]),d(n[a+1])||b(n[a+1])?(f=n[a+1],a+=2):u&&(u=br(1,(f=u).length),a+=1),u&&f)if(a=c.option(l={},n,a,s),b(f))for(e=0,i=U(f);e<i;++e)c.data.push({x:Sn(u),y:Sn(q(f,e)),style:l}),l=c.option(l,n,a,++s);else c.data.push({x:Sn(u),y:Sn(f),style:l}),++s;else a+=1;return c}},l.figure=hr,l.createCanvas=function(n,r){},l.currentCanvas=function(){},E.clc=r,E.disp=r,E.clear=r,E.help=r,E.who=r,E.whos=r,E.exist=r,["floor","ceil","round","sign","abs","exp","log","log10","log2","sqrt","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){L[r]="log"===r?function(n){return u(n)?k.log(n):n.ln()}:"log10"===r?function(n){return u(n)?k.log10(n):n.log(tn)}:"log2"===r?function(n){return u(n)?k.log2(n):n.log(rn)}:function(n){return u(n)?k[r](n):n[r]()}}),L.atan2=function(n,r){return Q(O,r)&&Q(O,n)?O:(u(n)&&u(r)?k:_).atan2(n,r)},L.fix=function(n){return Mn(n,O)?L.ceil(n):L.floor(n)},l.realMath=L,(I=function n(r,t,e){var i=this;if(!cn(i,n))return new n(r,t,e);f(r)?(i.re=r.re,i.im=r.im):(t=t||O,"polar"===e?(i._rho=L.abs(r),i.re=H(i._rho,L.cos(t)),i.im=H(i._rho,L.sin(t))):(i.re=r,i.im=t))}).prototype={constructor:I,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var r=this;return null==r._rho&&(r._rho=cr(r.re,r.im)),r._rho},norm2:function(){return null==this._rho2&&(this._rho2=Zn(this.abs(),rn)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=L.atan2(n.im,n.re)),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=Q(n.im,O)?L.sign(n.re):n.div(n.abs()),f(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return $(n)?new I(V(this.re,n),this.im):new I(V(this.re,n.re),V(this.im,n.im))},sub:function(n){return $(n)?new I(G(this.re,n),this.im):new I(G(this.re,n.re),G(this.im,n.im))},mul:function(n){var r,t,e,i=this;return $(n)?new I(Q(i.re,O)?O:H(i.re,n),Q(i.im,O)?O:H(i.im,n)):(r=i.re,e=n.re,i=i.im,t=H(r,V(e,n=n.im)),n=H(n,V(r,i)),e=H(e,G(i,r)),new I(G(t,n),V(t,e)))},div:function(n){var r,t,e,i=this;return $(n)?new I(Q(i.re,O)?O:D(i.re,n),Q(i.im,O)?O:D(i.im,n)):(t=n.norm2(),r=i.re,e=D(n.re,t),i=i.im,t=H(r,V(e,n=Ln(D(n.im,t)))),n=H(n,V(r,i)),e=H(e,G(i,r)),new I(G(t,n),V(t,e)))},pow:function(n){var r,t;return hn(n)?s:$(n)?new I(Zn(this.abs(),n),H(this.angle(),n),"polar"):f(n)?(r=this.abs(),t=this.angle(),new I(Zn(r,n.re),H(n.im,L.log(r)),"polar").mul(new I(L.exp(Ln(H(n.im,t))),H(t,n.re),"polar"))):void 0},neg:function(){return new I(Ln(this.re),Ln(this.im))},conj:function(){return new I(this.re,Ln(this.im))},inv:function(){var n=this.norm2();return new I(D(this.re,n),Ln(D(this.im,n)))},toString:function(){var n=this;return null==n._str&&(n._str=En(n.re)+(Mn(n.im,O)?" - ":" + ")+En(L.abs(n.im))+"i"),n._str},valueOf:function(){return v(this.re)}},new I(O,C),t=new I(ln.e,O),e={floor:function(n){return new I(L.floor(n.re),L.floor(n.im))},ceil:function(n){return new I(L.ceil(n.re),L.ceil(n.im))},round:function(n){return new I(L.round(n.re),L.round(n.im))},fix:function(n){return new I(L.fix(n.re),L.fix(n.im))},sign:function(n){return n.sign()},sqrt:function(n){return n.pow(new I(z,O))},exp:function(n){return t.pow(n)},log:function(n){return new I(L.log(n.abs()),n.angle())},log10:function(n){return e.log(n).div(o)},log2:function(n){return e.log(n).div(c)},sin:function(n){return new I(H(L.sin(n.re),L.cosh(n.im)),H(L.cos(n.re),L.sinh(n.im)))},cos:function(n){return new I(H(L.cos(n.re),L.cosh(n.im)),Ln(H(L.sin(n.re),L.sinh(n.im))))},tan:function(n){return e.sin(n).div(e.cos(n))},sinh:function(n){return new I(H(L.sinh(n.re),L.cos(n.im)),H(L.cosh(n.re),L.sin(n.im)))},cosh:function(n){return new I(H(L.cosh(n.re),L.cos(n.im)),H(L.sinh(n.re),L.sin(n.im)))},tanh:function(n){return e.sinh(n).div(e.cosh(n))},asin:null,acos:null,atan:null,asinh:null,acosh:null,atanh:null},l.complexMath=e,E.complex=I,["floor","ceil","round","fix","sign","exp","log","log10","log2","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){E[r]=e[r]?function(n){return _n(function(n){return(f(n)?e:L)[r](n)},n,!0)}:function(n){return _n(function(n){return L[r](n)},n,!1)}}),E.atan2=function(n,r){return In(function(n,r){return L.atan2(n,r)},n,r,!1)},E.sqrt=function(n){return _n(function(n){return f(n)?e.sqrt(n):Rn(O,n)?new I(O,L.sqrt(Ln(n))):L.sqrt(n)},n,!0)},["sqrt","pow","log"].forEach(function(r){E["real"+r]=function(n){return _n(function(n){f(n=qn(n))&&y("real"+r);n=L[r](n);return hn(n)||!pn(n)?y("real"+r):n},n,!0)}}),E.real=mr,E.imag=gr,E.conj=pr,E.abs=vr,E.angle=function(n){return _n(Yn,n,!0)},E.norm=dr,E.zeros=function(n,r){return yr(E.fix(n),w(r)?E.fix(r):r)},E.ones=function(n,r){return n=E.fix(n),r=w(r)?E.fix(r):r,d(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),C)},E.eye=function(n){return wr(E.fix(n),C)},E.rand=function(n,r){return n=E.fix(n),r=w(r)?E.fix(r):r,null==n?B(k.random()):(d(n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),function(){return B(k.random())}))},E.randi=function(n,r,t){return e=E.fix(n),n=E.fix(r),r=w(t)?E.fix(t):t,e=v(e),null==n&&null==r?B(k.ceil(k.random()*e)):(d(n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),function(){return B(k.ceil(k.random()*e))}));var e},E.randn=function(n,r){return n=E.fix(n),r=w(r)?E.fix(r):r,null==n?B(sr()):(d(n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),function(){return B(sr())}))},E.randperm=function(n){(!p(n=v(n||0))||n<=0)&&y("randperm");for(var r,t,e=F(n,function(n){return n+1}),i=1+(e.length-1);1<i--;)r=k.round(k.random()*+i),t=e[0+i],e[0+i]=e[0+r],e[0+r]=t;return e},E.magic=function(n){var t;return n=p(n=xn(E.fix(n),!0))?v(n):null,!p(n)||n<=2?1===n?[[C]]:[]:(t=function n(e){var t,i,r,u,f,o,l,c=1&e,a=0==(3&e),s=e*e,h=e-c>>1;if(c)return A(e,e,function(n,r){var t=(n+1+r+1+(e-3)/2)%e;return t<0&&(t+=e),(n=(n+1+2*(r+1)-2)%e)<0&&(n+=e),e*t+n+1});if(a)return i=0,A(e,e,function(n,r){return++i,(n+1&3)>>1==(r+1&3)>>1?s-(i-1):i});if(t=h*h,o=n(h),l=A(e,e,function(n,r){return n<h?r<h?o[n][r]:o[n][r-h]+2*t:r<h?n<h?o[n][r]:o[n-h][r]+3*t:o[n-h][r-h]+t}),1<(i=(h-1)/2))for(r=1;r<=h;++r){for(u=2;u<=i;++u)f=l[r-1][u-1],l[r-1][u-1]=l[r+h-1][u-1],l[r+h-1][u-1]=f;for(u=e-i+2;u<=e;++u)f=l[r-1][u-1],l[r-1][u-1]=l[r+h-1][u-1],l[r+h-1][u-1]=f}for(r=1;r<=i;++r)f=l[r-1][0],l[r-1][0]=l[r+h-1][0],l[r+h-1][0]=f;for(r=i+2;r<=h;++r)f=l[r-1][0],l[r-1][0]=l[r+h-1][0],l[r+h-1][0]=f;return f=l[i][i-1],l[i][i-1]=l[i+h][i-1],l[i+h][i-1]=f,l}(n),A(n,n,function(n,r){return B(t[n][r])}))},E.pascal=function(n){var t,r;return 1<arguments.length&&y("pascal"),n=p(n=E.fix(xn(n,!0)))?v(n):null,!p(n)||n<=0?[]:(t=A(r=n,r,function(n,r,t){return 0===n||0===r?1:t[n-1][r]+t[n][r-1]}),A(n,n,function(n,r){return B(t[n][r])}))},E.rosser=function(){return[[B(611),B(196),B(-192),B(407),B(-8),B(-52),B(-49),B(29)],[B(196),B(899),B(113),B(-192),B(-71),B(-43),B(-8),B(-44)],[B(-192),B(113),B(899),B(196),B(61),B(49),B(8),B(52)],[B(407),B(-192),B(196),B(611),B(8),B(44),B(59),B(-23)],[B(-8),B(-71),B(61),B(8),B(411),B(-599),B(208),B(208)],[B(-52),B(-43),B(49),B(44),B(-599),B(411),B(208),B(208)],[B(-49),B(-8),B(8),B(59),B(208),B(208),B(99),B(-911)],[B(29),B(-44),B(52),B(-23),B(208),B(208),B(-911),B(99)]]},E.vander=function(n){return d(n=j(n))||y("vander"),n.map(function(t){return F(n.length,function(n,r){return 0===n?C:K(r[n-1],t)}).reverse()})},E.toeplitz=function(t,e){return 1===arguments.length?A((e=j(t)).length,e.length,function(n,r){return n===r?e[0]:n<r?e[k.abs(n-r)]:Dn(e[k.abs(n-r)])}):(t=j(t),e=j(e),A(t.length,e.length,function(n,r){return n===r?t[0]:(n<r?e:t)[k.abs(n-r)]}))},E.hankel=function(t,e){var i,n;return 1===arguments.length?(t=j(t),A(i=t.length,i,function(n,r){return i-1-n<r?O:t[(n+r)%i]})):(t=j(t),e=j(e),i=t.length,A(n=e.length,n,function(n,r){return i<=n+r-1?e[n+r-i]:t[(n+r)%i]}))},E.hadamard=function(n){return function n(r){return 1===r?[[C]]:2===r?[[C,C],[C,Z]]:4===r?[[C,C,C,C],[C,Z,C,Z],[C,C,Z,Z],[C,Z,Z,C]]:0==r%4&&(r=n(r/2)).length?Tr([[C,C],[C,Z]],r):[]}(v(n))},E.hilb=function(n){return A(n=v(xn(n,!0)),n,function(n,r){return B(1/(n+1+r+1-1))})},E.invhilb=function(n){n=v(xn(n,!0));var r=E.hilb(n);return(n<10?tt:et)(r)},E.linspace=function(n,r,t){t=v(t=null==t?100:t);for(var e=D(G(r,n),t-1),i=new Array(t),u=0,f=n;u<t;++u,f=V(f,e))i[u]=f;return i},E.logspace=function(n,r,t){t=v(t=null==t?100:t);for(var e=Zn(D(r,n),1/(t-1)),i=new Array(t),u=0,f=n;u<t;++u,f=K(f,e))i[u]=f;return i},E.meshgrid=kn(function(n,r,t){return function(t,e){if(1===arguments.length&&(e=t),d(t)&&d(e))return[A(e.length,t.length,function(n,r){return t[r]}),A(e.length,t.length,function(n,r){return e[n]})];y("meshgrid")}(r,t)}),E.ndgrid=kn(function(n){for(var r=n,t=[].slice.call(arguments,1),e=[],i=F(r,function(n){return(1===t.length?t[0]:t[n]).length}),u=0;u<r;++u)e.push(wn(i,function(n){return(1===t.length?t[0]:t[u])[n[u]]}));return 1===r?e[0]:e}),E.colon=br,E.cat=function(n,r,t){var e,i=[];if(1===(n=v(n)))for(i=r,e=2;e<arguments.length;++e)i=xr("vert",i,arguments[e]);else if(2===n)for(i=r,e=2;e<arguments.length;++e)i=xr("horz",i,arguments[e]);return i},E.horzcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=xr("horz",t,arguments[e]);return t},E.vertcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=xr("vert",t,arguments[e]);return t},E.transpose=Sr,E.ctranspose=Ar,E.diag=_r,E.blkdiag=function(){return t=[].slice.call(arguments),a=c=l=o=f=0,t.forEach(function(n,r){vn(n)&&(t[r]=n=[[n]]),dn(n)&&(t[r]=n=_r(n)),yn(n)||y("blkdiag"),f+=W(n),o+=U(n)}),e=t[l],i=W(e),u=U(e),A(f,o,function(n,r){return c+i<=n&&(c+=i,a+=u,e=t[++l],i=W(e),u=U(e)),r<a||a+u<=r?O:e[n-c][r-a]});var t,e,i,u,f,o,l,c,a},E.tril=function(t,e){if(yn(t))return e=v(e||0),A(W(t),U(t),function(n,r){return r<=n+e?t[n][r]:O});y("tril")},E.triu=function(t,e){if(yn(t))return e=v(e||0),A(W(t),U(t),function(n,r){return n+e<=r?t[n][r]:O});y("triu")},E.repmat=function(t,e,i){return d(e)&&(i=e[1],e=e[0]),null==i&&(i=e),e=v(e),i=v(i),yn(t=dn(t=vn(t)?[[t]]:t)?[t]:t)?A(e*W(t),i*U(t),function(n,r){return t[n%e][r%i]}):t},E.repelem=function(r,t){var e,i;if(d(r))if(d(t)){if(t.length===r.length)return e=0,i=-1,F(v(Pr(t)),function(n){return n===e&&(e+=v(t[++i])),r[i]})}else if(p(t))return t=v(t),i=-1,F(t*r.length,function(n){return 0==n%t&&++i,r[i]});return r},E.reshape=function(t,e,n){d(e)&&(n=e[1],e=e[0]),e=v(e),n=v(n);var i,r=e*n;return vn(t)&&1===e&&1===n?[[t]]:dn(t)&&t.length===r?A(e,n,function(n,r){return t[n+e*r]}):yn(t)&&W(t)*U(t)==r?(i=W(t),A(e,n,function(n,r){n+=e*r;return t[n%i][k.floor(n/i)]})):t},E.squeeze=function(n){return n},E.flip=Ir,E.fliplr=function(n){return Ir(n,2)},E.flipud=function(n){return Ir(n,1)},E.sort=kn(function(n,r,t,e){for(var i=2,u=null;i<arguments.length;){if("ComparisonMethod"===arguments[i]){"real"===arguments[i+1]?u=kr:"abs"===arguments[i+1]&&(u=Er),1===i?(t=1,e="ascend"):2===i&&(e="ascend");break}i+=1}return null==e&&(e="ascend"),Nr(r,t=v(t=null==t?1:t),e,u,1<n)}),E.min=jr,E.max=qr,E.sum=Pr,E.prod=Mr,E.dot=Rr,E.cross=function(n,r){if(n=j(n),r=j(r),!d(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(d(r)&&3===r.length)return[Vn(K(n[1],r[2]),K(n[2],r[1])),Vn(K(n[2],r[0]),K(n[0],r[2])),Vn(K(n[0],r[1]),K(n[1],r[0]))];throw"cross: input 2 not vector of length 3"},E.kron=Tr,E.diff=function(n,r,t){for(null==t&&(t=1),p(r=null==r?1:r)||y("diff"),r=v(r);0<r--;)n=function r(t,n){if(d(t=j(t)))return 1<t.length?F(t.length-1,function(n){return Vn(t[n+1],t[n])}):[];if(b(t)){if(1===(n=v(n=null==n?1:n)))return F(U(t),function(n){return r(q(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}y("diff")}(n,t);return n},E.trapz=function(n,r,t){return arguments.length<3&&(S(r)?t=1:S(n)&&!S(r)&&(t=r,r=n,n=null)),Xr(S(n)?j(n):n,j(r),t)},E.cumtrapz=function(n,r,t){return arguments.length<3&&(S(r)?t=1:S(n)&&!S(r)&&(t=r,r=n,n=null)),function r(t,e,i){if(w(e))return e;if(d(e)){if(null==t||w(t))return e.map(function(n,r){return Xr(t,e.slice(0,r+1))});if(d(t)&&t.length===e.length)return e.map(function(n,r){return Xr(t.slice(0,r+1),e.slice(0,r+1))})}else if(b(e))if(1===(i=v(i=null==i?1:i))){if(null==t||w(t)||d(t)&&t.length===W(e))return F(U(e),function(n){return r(t,q(e,n),i)});if(b(t)&&W(t)===W(e)&&U(t)===U(e))return F(U(e),function(n){return r(q(t,n),q(e,n),i)})}else if(2===i){if(null==t||w(t)||d(t)&&t.length===U(e))return F(W(e),function(n){return r(t,e[n],i)});if(b(t)&&W(t)===W(e)&&U(t)===U(e))return F(W(e),function(n){return r(t[n],e[n],i)})}y("cumtrapz")}(S(n)?j(n):n,j(r),t)},E.cumsum=function(n,r,t){n=Zr(j(n),J,t,r);return!1===n&&y("cumsum"),n},E.cumprod=function(n,r,t){n=Zr(j(n),K,t,r);return!1===n&&y("cumprod"),n},E.cummin=function(n,r,t){n=Zr(j(n),function(n,r){return Fn(n,r)?n:r},t,r);return!1===n&&y("cummin"),n},E.cummax=function(n,r,t){n=Zr(j(n),function(n,r){return Wn(n,r)?n:r},t,r);return!1===n&&y("cummax"),n},E.movsum=function(n,r,t){var e,i;return d(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=zr(j(n),Pr,e,i,t))&&y("movsum"),r},E.movprod=function(n,r,t){var e,i;return d(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=zr(j(n),Mr,e,i,t))&&y("movprod"),r},E.movmean=function(n,r,t){var e,i;return d(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=zr(j(n),At,e,i,t))&&y("movmean"),r},E.movmin=function(n,r,t){var e,i;return d(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=zr(j(n),jr,e,i,t))&&y("movmin"),r},E.movmax=function(n,r,t){var e,i;return d(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=zr(j(n),qr,e,i,t))&&y("movmax"),r},E.bitshift=function(n,r){return _n(function(n){return p(n)?Mn(r,O)?v(n)>>-v(r):v(n)<<v(r):n},n,!0)},E.bitand=function t(r,e){if(p(r)){if(p(e))return v(r)&v(e);if(S(e))return e.map(function(n){return t(r,n)})}else if(S(r)){if(p(e))return r.map(function(n){return t(n,e)});if(S(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.bitor=function t(r,e){if(p(r)){if(p(e))return v(r)|v(e);if(S(e))return e.map(function(n){return t(r,n)})}else if(S(r)){if(p(e))return r.map(function(n){return t(n,e)});if(S(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.bitxor=function t(r,e){if(p(r)){if(p(e))return v(r)^v(e);if(S(e))return e.map(function(n){return t(r,n)})}else if(S(r)){if(p(e))return r.map(function(n){return t(n,e)});if(S(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.size=Lr,E.length=Or,E.ndims=function(n){return Or(Lr(n))},E.numel=function(n){return Mr(Lr(n))},E.rows=function(n){return Lr(n,1)},E.columns=function(n){return Lr(n,2)},E.sub2ind=function(n,r,t){return d(r)&&(t=r[1],r=r[0]),r=v(r),t=v(t),1===n.length?r:r-1+v(n[0])*(t-1)+1},E.ind2sub=function(n,r){return r=v(r),1===n.length?[r,1]:[(r-1)%v(n[0])+1,k.floor((r-1)/v(n[0]))+1]},l.find=Cr,E.find=function(n){return Cr(n,function(n){return!Cn(n,O)})},l.all=$r,E.all=function(n){return $r(n,function(n){return!Cn(n,O)})},l.any=Fr,E.any=function(n){return Fr(n,function(n){return!Cn(n,O)})},E.isnan=function n(r){return S(r)?r.map(n):hn(r)||f(r)&&(hn(r.re)||hn(r.im))?1:0},E.isinf=function n(r){return S(r)?r.map(n):$(r)?mn(r)?1:0:f(r)&&(mn(r.re)||mn(r.im))?1:0},E.isfinite=function n(r){return S(r)?r.map(n):$(r)?mn(r)?0:1:!f(r)||mn(r.re)||mn(r.im)?0:1},E.isreal=function(n){return $r(n,pn)},E.isempty=function(n){return S(n)?S(n[0])?n[0].length?0:1:n.length?0:1:0};var Yr=function(n,r,t,e){var i,u,f,o,l,c,a,s,h,m,g,p,v,d,y=W(n),w=U(n),b=w,x=0;for(e=B(e||0),S(t)&&(b=k.min(b,t[1])),v=Hr(n,wr(y)),i=new Array(b),u=C,d=function(n,r){r=r||0;for(var t=x-1;0<=t;--t)if(n===i[t][r])return t;return-1},f=a=0;f<y&&!(b<=a);++f){for(o=f;Un(Kn(v[o][a]),e);)if(y<=++o&&(o=f,b<=++a)){a=-1;break}if(-1===a)break;for(s=-1,m=null,p=0,o=l=o;o<y;++o)Un(g=Kn(v[o][a]),e)?++p:null!=m&&!Fn(g,m)||(m=g,s=o);for(;-1!==s;){if(y-l===p+1){for(f!==s&&(Wr(v,f,s),u=Hn(u)),Fn(v[f][a],O)&&(Ur(v,f,f,O,Z,a),u=Hn(u)),o=s,l=f;0<=o&&-1!==(c=d(o));)o=l-=x-c;i[x++]=[o,a],u=f<b?K(u,v[f][f]):O;break}for(p=0,h=s,o=l;o<y;++o)o!==h&&(Ur(v,o,h,Hn(Y(v[o][a],v[h][a])),C,a),Un(g=Kn(v[o][a]),e)?++p:Fn(g,m)&&(m=g,s=o))}++a}return x<b&&(u=O),t=Gr(v,0,w,y-1,y+w-1),v=Gr(v,0,0,y-1,w-1),i.length>x&&(i.length=x),r?[v,i,u,t]:v};function nt(n,r,t,e){var i,u,f,o,l,c,a=W(n),s=U(n),h=s;for(e=B(e||0),S(t)&&k.min(h,t[1]),c=Hr((h=Yr(n,!0,t,e))[0],h[3]),i=h[1],n=h[2],u=i.length,o=0;o<u;++o)for(f=i[o][1],l=0;l<o;++l)Un(Kn(c[l][f]),e)||(Ur(c,l,o,Hn(c[l][f]),c[o][f]),Cn(c[l][i[l][1]],C))||Ur(c,l,l,O,Jn(c[l][i[l][1]]),i[l][1]);return Cn(c[u-1][i[u-1][1]],C)||Ur(c,u-1,u-1,O,Jn(c[u-1][i[u-1][1]]),i[u-1][1]),t=Gr(c,0,s,a-1,a+s-1),c=Gr(c,0,0,a-1,s-1),r?[c,i,n,t]:c}function rt(n,r,t){if(w(n)&&w(r))return Y(r,n);if(!b(n))return[];if(!d(r)&&!b(r))return[];var e,i=U(n);if(W(n)!==i)return[];if(e=d(r)?(h=r.length,1):(h=W(r),U(r)),i!==h)return[];var u,f,o,l,c,a,s,h=Yr(Sr(n),!0);if(h[1].length!==i)return[];if(u=Sr(h[3]),f=Sr(h[0]),d(r)){for(o=F(i,O),l=0;l<i;++l){if(Cn(f[l][l],O))return[];for(s=O,c=0;c<l;++c)s=J(s,K(f[l][c],o[c]));o[l]=Y(Vn(r[l],s),f[l][l])}return F(i,function(r){return F(i,function(n){return K(o[n],u[r][n])}).reduce(J,O)})}for(o=yr(i,e),l=0;l<i;++l){if(Cn(f[l][l],O))return[];for(a=0;a<e;++a){for(s=O,c=0;c<l;++c)s=J(s,K(f[l][c],o[c][a]));o[l][a]=Y(Vn(r[l][a],s),f[l][l])}}return A(i,e,function(r,t){return F(i,function(n){return K(o[n][t],u[r][n])}).reduce(J,O)})}function tt(n){var r,t,e;return w(n)?Jn(n):b(n)&&W(n)===U(n)?1===(t=r=W(n))?[[Jn(n[0][0])]]:Cn((e=nt(n,!0))[0][r-1][t-1],O)?[]:e[3].map(function(n,r){return n.map(function(n){return Y(n,e[0][r][r])})}):[]}function et(n){if(W(n)!==U(n))return[];for(var r=wr(W(n)),t=r,e=rr(r,n),i=0;i<4;++i)t=P(t,nr(r,e)),i+1<4&&(e=P(e,e));return t}function it(n,r){var t,e,i=W(n),u=U(n);return r=r||nt(n,!0),e=(t=r[1]).length,[Gr(n,F(i,function(n){return n}),F(e,function(n){return t[n][1]})),Gr(r[0],0,0,e-1,u-1).map(function(t,e){return t.map(function(n,r){for(r=e;r+1<u&&Cn(t[r],O);)++r;return Y(n,t[r])})})]}function ut(t,n){var r,e,i,u,f;return w(t)?Jn(t):b(t)?(r=W(t),i=U(t),Vr(t,0)?Sr(t):1===r&&1===i?[[Jn(t[0][0])]]:1===r||1===i?(f=t.reduce(function(n,r){return J(n,K(r,Dn(r)))},O),A(i,r,function(n,r){return Y(Dn(t[r][n]),f)})):(n=(e=nt(t,!0,null,n||0))[1].length)===i?r===i?e[3].map(function(n,r){return n.map(function(n){return Y(n,e[0][r][r])})}):P(tt(P(u=Ar(t),t)),u):n===r?P(u=Ar(t),tt(P(t,u))):(i=it(t,e),f=P(tt(P(u=Ar(f=i[0]),f)),u),n=P(u=Ar(n=i[1]),tt(P(n,u))),P(n,f))):[]}function ft(e){return w(e)?e:b(e)?e.reduce(function(n,r,t){return J(n,t<r.length?e[t][t]:0)},0):void y("trace")}function ot(e,n,r){r=B(r||0);var t=W(e);return t!==U(e)?0:1===t?e[0][0]:Dr(e,"lower",!0,r)||Dr(e,"upper",!0,r)?e.reduce(function(n,r,t){return K(n,e[t][t])},1):!0===n?function n(r,t){var e,i,u,f,o,l,c,a,s,h,m,g,p,v;function d(t,n,e,i){return A(n-1,n-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})}if(1===t)o=r[0][0];else if(2===t)l=r[0][0],c=r[0][1],a=r[1][0],o=Vn(K(l,s=r[1][1]),K(c,a));else if(3===t)l=r[0][0],c=r[0][1],a=r[0][2],s=r[1][0],h=r[1][1],m=r[1][2],g=r[2][0],p=r[2][1],v=r[2][2],o=Vn(Vn(Vn(J(J(K(K(l,h),v),K(K(c,m),g)),K(K(a,s),p)),K(K(a,h),g)),K(K(c,s),v)),K(K(l,m),p));else{for(e=u=i=0;e<t;++e)Cn(r[0][e],O)&&++i,Cn(r[e][0],O)&&++u;if(f=C,o=O,i<u)for(e=0;e<t;++e)Cn(r[e][0],O)||(o=J(o,K(r[e][0],K(f,n(d(r,t,e,0),t-1))))),f=C===f?Z:C;else for(e=0;e<t;++e)Cn(r[0][e],O)||(o=J(o,K(r[0][e],K(f,n(d(r,t,0,e),t-1))))),f=C===f?Z:C}return o}(e,t):Yr(e,!0,null,r)[2]}function lt(n){b(n)&&W(n)===U(n)||y("charpoly");var e,r=W(n),i=(U(n),r),u=new Array(i+1),t=yr(i,i);for(u[i]=C,e=1;e<=i;++e)t=P(n,t).map(function(n,t){return n.map(function(n,r){return t===r?J(n,u[i-e+1]):n})}),u[i-e]=Y(ft(P(n,t)),-e);return qn(u.reverse())}function ct(f){return A(U(f),W(f),function(n,r){return e=r,i=n,r=!0,n=W(t=f),u=U(t),n!==u?null:n<=1?0:(i=+(i||0),(e=+(e||0))<0||n<=e||i<0||u<=i?null:(n=ot(A(n-1,u-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})),!0===r&&e+i&1?Hn(n):n));var t,e,i,u})}function at(n,r,t){var e,i,u,f,o,l,c,a,s,h=W(n),m=U(n),g=r?wr(h):null,p=n;if(t)for(e=F(m,function(n){return n}),f=F(m,function(n){return dr(q(p,n),rn)}),c=0;c<m;++c){for(o=f[i=c],l=c+1;l<m;++l)Rn(f[l],o)&&(o=f[i=l]);if(Q(o,O))break;if(c!==i)for(u=f[c],f[c]=f[i],f[i]=u,u=e[c],e[c]=e[i],e[i]=u,l=0;l<h;++l)u=p[l][c],p[l][c]=p[l][i],p[l][i]=u;for(l=h-1;c+1<=l;--l)s=[Dn((a=Jr(p[l-1][c],p[l][c]))[0]),Hn(Dn(a[1]))],p=Kr("left",s,l-1,l,p),r&&(g=Kr("right",a,l-1,l,g));for(l=c+1;l<m;++l)f[l]=G(f[l],Zn(Kn(p[c][l]),rn))}else for(c=0;c<m;++c)for(l=h-1;c+1<=l;--l)s=[Dn((a=Jr(p[l-1][c],p[l][c]))[0]),Hn(Dn(a[1]))],p=Kr("left",s,l-1,l,p),r&&(g=Kr("right",a,l-1,l,g));return r&&t?[g,p,A(m,m,function(n,r){return n===e[r]?C:O})]:r?[g,p]:p}function st(n,r,t){null==r&&(r=2);for(var e,i,u,f,o,l,c=W(n),a=An(n),s=t?F(c,C):null,h=B(1e-10),m=1;m<=1e4;++m){for(e=l=0;e<c;++e)if((f=q(a,e).map(B)).splice(e,1),(o=a[e].map(B)).splice(e,1),f=dr(f,r),Q(o=dr(o,r),O)||Q(f,O))++l;else{for(u=L.sqrt(D(o,f)),Tn(L.abs(G(u,C)),h)&&++l,t&&(s[e]=H(u,s[e])),i=0;i<c;++i)a[i][e]=K(a[i][e],u);for(i=0;i<c;++i)a[e][i]=Y(a[e][i],u)}if(c===l)break}return t?[s,a]:a}function ht(n,r,t){var e=W(n);if(null==r){var i,u,f=t?wr(e):null,o=n;for(l=1;l<=e-2;++l)for(c=e;l+2<=c;--c)u=[Dn((i=Jr(o[c-1-1][l-1],o[c-1][l-1]))[0]),Hn(Dn(i[1]))],t&&(f=Kr("right",i,c-1-1,c-1,f)),o=Kr("left",u,c-1-1,c-1,Kr("right",i,c-1-1,c-1,o));return t?[f,o]:o}var l,c,a,s,h=Ar(f=qr_givens(r,!0)[0]),m=wr(e),g=P(h,n),p=P(h,r);for(l=1;l<=e-2;++l)for(c=e;l+2<=c;--c)a=[Dn((s=Jr(g[c-1-1][l-1],g[c-1][l-1]))[0]),Hn(Dn(s[1]))],f=Kr("right",s,c-1-1,c-1,f),g=Kr("left",a,c-1-1,c-1,g),p=Kr("left",a,c-1-1,c-1,p),m=Kr("right",s=Jr(Hn(p[c-1][c-1]),p[c-1][c-1-1]),c-1-1,c-1,m),g=Kr("right",s,c-1-1,c-1,g),p=Kr("right",s,c-1-1,c-1,p);return[g,p,f,m]}function mt(n){var r,t,e,i,u=B(1e-10),f=W(n),o=new Array(f),l=new Array(f),c=F(f,0);for(n=An(n),i=0;i<f;++i)r=(e=function(n,r,t,e){var i,u,f,o,l,c,a=O;if(!0===e){for(o=er(o=F(r,function(){return new I(B(k.random()||.1),O)}),dr(o)),i=1;i<=100&&(f=a,a=Rr(o=j(P(n,l=o)),l),o=er(o,o[0].sign()),o=er(o,dr(o)),!Tn(L.abs(G(mr(a),mr(f))),t)||!Tn(L.abs(G(gr(a),gr(f))),t));++i);return a}for(u=Ar(n),o=er(o=F(r,function(){return new I(B(k.random()||.1),O)}),dr(o)),c=er(c=F(r,function(){return new I(B(k.random()||.1),O)}),dr(c)),i=1;i<=100&&(f=a,o=j(P(n,l=o)),c=j(P(u,c)),a=Rr(o,l),o=er(o,o[0].sign()),c=er(c,c[0].sign()),o=er(o,dr(o)),c=er(c,dr(c)),!Tn(L.abs(G(mr(a),mr(f))),t)||!Tn(L.abs(G(gr(a),gr(f))),t));++i);return[a,o,c]}(n,f,u))[0],t=e[1],e=e[2],n=rr(n,P(P(Y(c[i]=r,Rr(o[i]=t,l[i]=e,!0)),t),e));return[qn(Sr(o)),qn(c),qn(Sr(l))]}function gt(n,r,t,e){r=B(r=$(r)?r:nn);var i,u=U(n),f=W(n);if(f<u)return i=gt(Sr(n),r,e,t),t&&e?[Sr(i[2]),i[1],Sr(i[0])]:t||e?[Sr(i[0]),i[1]]:i;var o,l,c,a,s,h,m,g,p,v,d,y,w,b,x,S,A,_,I,Z,k,E=t?f:0,N=e?u:0,j=An(n),q=E?yr(f,E):null,P=F(u,O),M=N?yr(u,N):null,z=D(ln.realmin,r),R=new Array(u),T=new Array(u),X=new Array(u);for(T[0]=O,b=1;b<=u;++b){for(A=b+1,c=O,y=b;y<=f;++y)c=V(c,V(Zn(mr(j[y-1][b-1]),rn),Zn(gr(j[y-1][b-1]),rn)));if(R[b-1]=O,Rn(c,z)&&(c=L.sqrt(c),R[b-1]=c,s=Q(a=Kn(j[b-1][b-1]),O)?C:Y(j[b-1][b-1],a),j[b-1][b-1]=K(s,V(c,a)),b!==u+0)){for(w=A;w<=u+0;++w){for(s=O,y=b;y<=f;++y)s=J(s,K(Dn(j[y-1][b-1]),j[y-1][w-1]));for(s=Y(s,H(c,V(c,a))),y=b;y<=f;++y)j[y-1][w-1]=Vn(j[y-1][w-1],K(s,j[y-1][b-1]))}for(s=Hn(Qn(Dn(j[b-1][b-1]))),w=A;w<=u+0;++w)j[b-1][w-1]=K(s,j[b-1][w-1])}if(b===u)break;for(c=O,w=A;w<=u;++w)c=V(c,V(Zn(mr(j[b-1][w-1]),rn),Zn(gr(j[b-1][w-1]),rn)));if(T[A-1]=O,Rn(c,z)){for(c=L.sqrt(c),T[A-1]=c,s=Q(a=Kn(j[b-1][A-1]),O)?C:Y(j[b-1][A-1],a),j[b-1][A-1]=K(s,V(c,a)),y=A;y<=f;++y){for(s=O,w=A;w<=u;++w)s=J(s,K(Dn(j[b-1][w-1]),j[y-1][w-1]));for(s=Y(s,H(c,V(c,a))),w=A;w<=u;++w)j[y-1][w-1]=Vn(j[y-1][w-1],K(s,j[b-1][w-1]))}for(s=Hn(Qn(Dn(j[b-1][A-1]))),y=A;y<=f;++y)j[y-1][A-1]=K(j[y-1][A-1],s)}}for(h=O,b=1;b<=u;++b)P[b-1]=R[b-1],X[b-1]=T[b-1],h=qr([h,V(P[b-1],X[b-1])]);if(h=H(r,h),0<E)for(w=1;w<=E;++w)q[w-1][w-1]=C;if(0<N)for(w=1;w<=N;++w)M[w-1][w-1]=C;for(S=1;S<=u;++S){for(b=u+1-S,Z=1;Z<=50;++Z){for(k=!0,I=1;I<=b;++I){if(Tn(L.abs(X[(x=b+1-I)-1]),h)){k=!1;break}if(Tn(L.abs(P[x-1-1]),h)){k=!0;break}}if(k)for(d=O,v=C,_=x-1,y=x;y<=b&&(g=H(v,X[y-1]),X[y-1]=H(d,X[y-1]),!Tn(L.abs(g),h));++b)if(a=cr(g,p=P[y-1]),d=D(p,P[y-1]=a),v=Ln(D(g,a)),0<E)for(w=1;w<=u;++w)o=mr(q[w-1][_-1]),l=mr(q[w-1][y-1]),q[w-1][_-1]=V(H(o,d),H(l,v)),q[w-1][y-1]=G(H(l,d),H(o,v));if(a=P[b-1],x===b)break;for(o=P[x-1],l=P[b-1-1],m=X[b-1-1],p=X[b-1],m=cr(g=D(V(H(G(l,a),V(l,a)),H(G(m,p),V(m,p))),H(rn,H(p,l))),C),Mn(g,O)&&(m=Ln(m)),g=D(V(H(G(o,a),V(o,a)),H(G(D(l,V(g,m)),p),p)),o),v=d=C,y=_=x+1;_<=b;++_){if(m=X[y-1],l=P[y-1],p=H(v,m),m=H(d,m),a=cr(p,g),d=D(g,X[y-1-1]=a),v=D(p,a),g=V(H(o,d),H(m,v)),m=G(H(m,d),H(o,v)),p=H(l,v),l=H(l,d),0<N)for(w=1;w<=u;++w)o=mr(M[w-1][y-1-1]),a=mr(M[w-1][y-1]),M[w-1][y-1-1]=V(H(o,d),H(a,v)),M[w-1][y-1]=G(H(a,d),H(o,v));if(a=cr(p,g),d=D(g,P[y-1-1]=a),v=D(p,a),g=V(H(d,m),H(v,l)),o=G(H(d,l),H(v,m)),0<E)for(w=1;w<=u;++w)l=mr(q[w-1][y-1-1]),a=mr(q[w-1][y-1]),q[w-1][y-1-1]=V(H(l,d),H(a,v)),q[w-1][y-1]=G(H(a,d),H(l,v))}X[x-1]=O,X[b-1]=g,P[b-1]=o}if(Mn(a,O)&&(P[b-1]=Ln(a),0<N))for(w=1;w<=u;++w)M[w-1][b-1]=Hn(M[w-1][b-1])}for(b=1;b<=u;++b){for(m=-1,y=w=b;y<=u;++y)Rn(P[y-1],m)&&(m=P[y-1],w=y);if(w!==b){if(P[w-1]=P[b-1],P[b-1]=m,0<N)for(y=1;y<=u;++y)s=M[y-1][w-1],M[y-1][w-1]=M[y-1][b-1],M[y-1][b-1]=s;if(0<E)for(y=1;y<=u;++y)s=q[y-1][w-1],q[y-1][w-1]=q[y-1][b-1],q[y-1][b-1]=s}}if(0<E)for(S=1;S<=u;++S)if(!Q(R[(b=u+1-S)-1],O)){for(s=Hn(Qn(j[b-1][b-1])),w=1;w<=E;++w)q[b-1][w-1]=K(s,q[b-1][w-1]);for(w=1;w<=E;++w){for(s=O,y=b;y<=f;++y)s=J(s,K(Dn(j[y-1][b-1]),q[y-1][w-1]));for(s=Y(s,K(Kn(j[b-1][b-1]),R[b-1])),y=b;y<=f;++y)q[y-1][w-1]=Vn(q[y-1][w-1],K(s,j[y-1][b-1]))}}if(0<N&&2<=u)for(S=2;S<=u;++S)if(!Q(T[(A=(b=u+1-S)+1)-1],O)){for(s=Hn(Qn(Dn(j[b-1][A-1]))),w=1;w<=N;++w)M[A-1][w-1]=K(s,M[A-1][w-1]);for(w=1;w<=N;++w){for(s=O,y=A;y<=u;++y)s=J(s,K(j[b-1][y-1],M[y-1][w-1]));for(s=Y(s,K(Kn(j[b-1][A-1]),T[A-1])),y=A;y<=u;++y)M[y-1][w-1]=Vn(M[y-1][w-1],K(s,Dn(j[b-1][y-1])))}}return t&&e?[qn(q),P,qn(M)]:t||e?[qn(q||M),P]:P}E.planerot=kn(function(n,r){d(r=j(r))&&2===r.length||y("planerot");var t=Jr(r[0],r[1]),t=[[t[0],t[1]],[Hn(t[1]),t[0]]];return 1<n?[t,P(t,bn(r))]:t}),E.ref=kn(function(n,r,t){b(r=w(r)?[[r]]:r)||y("ref");r=Yr(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),E.rref=kn(function(n,r,t){b(r=w(r)?[[r]]:r)||y("rref");r=nt(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),E.linsolve=rt,E.null=function(n,r){return r=r,i=U(t=n),u=(t=nt(n,!0,null,r))[0],f=t[1],o=f.length,r=f.reduce(function(n,r){for(var t=0;t<n.length&&r[1]>n[t];)++t;return t<n.length&&r[1]===n[t]&&n.splice(t,1),n},F(i,function(n){return n})),l=o?f.reduce(function(n,r,t){return K(n,u[t][r[1]])},C):C,r.map(function(r){for(var n,t=F(i,function(n){return n===r?l:O}),e=0;e<o;++e)(n=f[e][1])<=r&&(t[n]=Vn(t[n],K(Y(l,u[e][n]),u[e][r])));return t});var t,i,u,f,o,l},E.rowspace=function(n,r){return Yr(t=n,!0,null,r)[1].map(function(n){return t[n[0]]});var t},E.colspace=function(n,r){return Yr(t=n,!0,null,r)[1].map(function(r){return F(t.length,function(n){return t[n][r[1]]})});var t},E.rank=function(n){return b(n=w(n)?[[n]]:n)||y("rank"),Yr(n,!0)[1].length},E.inv=function(n){return w(n)&&(x=[[n]]),b(n)||y("inv"),tt(n)},E.ainv=function(n){return w(n)&&(x=[[n]]),b(n)||y("ainv"),et(n)},E.rankf=function(n){return b(n=w(n)?[[n]]:n)||y("rankf"),it(n)},E.pinv=function(n,r){return b(n=w(n)?[[n]]:n)||y("pinv"),ut(n,r)},E.cond=function(n,r){b(n=w(n)?[[n]]:n)||y("cond");var t=tt(n);return t&&t.length?K(dr(n,r=null==r?2:r),dr(t,r)):a},E.trace=ft,E.det=function(n){return b(n=w(n)?[[n]]:n)||y("det"),ot(n,!1,1e-15)},E.charpoly=lt,E.adjoint=function(n){return b(n)&&W(n)===U(n)||y("adjoint"),ct(n)},E.ldl=function(n,r){b(n=w(n)?[[n]]:n)||y("ldl");var t,e,i,u,f,o,l=n,c=r,a=W(l);if(a===U(l)&&Vr(l,Ar(l))){for(f=yr(a,a),o=wr(a),t=0;t<a;++t){if("upper"===c){for(e=t+1;e<a;++e){for(i=t+1,u=O;i<e;++i)u=J(u,K(K(o[t][i],Dn(o[e][i])),f[i][i]));o[t][e]=Y(Vn(l[t][e],u),f[e][e])}for(i=t+1,u=O;i<a;++i)u=J(u,K(K(o[t][i],Dn(o[t][i])),f[i][i]))}else{for(e=0;e<t;++e){for(i=0,u=O;i<e;++i)u=J(u,K(K(o[t][i],Dn(o[e][i])),f[i][i]));o[t][e]=Y(Vn(l[t][e],u),f[e][e])}for(i=0,u=O;i<t;++i)u=J(u,K(K(o[t][i],Dn(o[t][i])),f[i][i]))}f[t][t]=Vn(l[t][t],u),Un(f[t][t],O)&&y("ldl")}return[o,f]}y("ldl")},E.lu=function(n){b(n=w(n)?[[n]]:n)||y("lu");var r,t,e,i,u,f,o,l,c,a,s,h,m,g,p,v=!0,d=void 0;for(d=B(d||0),r=W(n),t=U(n),p=!1,u=An(n),i=wr(r),f=F(r,O),e=wr(r),o=C,l=0;l<r-1;++l){if(Un(Kn(u[l][l]),d)){for(s=l+1,h=!0;s<r&&h;)Un(Kn(u[s][l]),d)?++s:h=!1;if(r<=s){p=!0;break}Wr(u,l,s),Wr(e,l,s)}for(m=u[l][l],i[l][l]=m,f[l]=K(o,m),c=l+1;c<r;++c){for(g=u[c][l],i[c][l]=g,a=l+1;a<t;++a)u[c][a]=Y(Vn(K(m,u[c][a]),K(u[l][a],g)),o);u[c][l]=O}o=u[l][l]}if(p)throw"lu: defficient matrix";return f[r-1]=o,v?[P(i,f=_r(f.map(Jn))),u,e]:[f,i,u,e]},E.qr=kn(function(n,r){return b(r=w(r)?[[r]]:r)||y("qr"),at(r,1<n,2<n)}),E.schur=kn(function(n,r){b(r=w(r)?[[r]]:r)&&W(r)===U(r)||y("schur");var t,e,i,u,f,o=1<n,l=W(r),c=B(1e-8),a=ht(r,null,o);for(o&&(t=a[0],a=a[1]),i=l-1;0<i;--i)for(f=1;f<=100&&(a=nr(P((e=at(rr(a,u=wr(l,a[i][i])),null,!0))[1],e[0]),u),o&&(t=P(t,e[0])),!Tn(Kn(a[i][i-1]),c));++f);return o?[t,a]:a}),E.balance=kn(function(n,r,t){b(r=w(r)?[[r]]:r)&&W(r)===U(r)||y("balance");var e=st(r,2,1<n);return 2<n?[e[0],F(W(r),function(n){return n+1}),e[1]]:1<n?[_r(e[0]),e[1]]:e}),E.hess=kn(function(n,r,t){return b(r=w(r)?[[r]]:r)&&W(r)===U(r)||y("hess"),2<arguments.legnth?(b(t=w(t)?[[t]]:t)&&W(t)===U(t)||y("hess"),ht(r,t)):ht(r,null,1<n)}),E.eig=kn(function(n,r,t){b(r)&&W(r)===U(r)||y("eig"),b(t)&&y("eig");var e=null;return"nobalance"!==t&&(e=st(r,2,!0),r=e[1],e=e[0]),1<n?(t=mt(r),[e?P(_r(e),t[0]):t[0],_r(t[1]),e?P(_r(e.map(On)),t[2]):t[2]]):qn((Dr(r,"upper",!0,1e-15)||Dr(r,"lower",!0,1e-15)?F(W(r),function(n){return r[n][n]}):Ot(lt(r))).sort(function(n,r){return Kn(r)-Kn(n)}))}),E.svd=kn(function(n,r,t){return b(r=w(r)?[[r]]:r)||y("svd"),1<n?[(n=gt(r,t,1<n,2<n))[0],_r(n[1]),n[2]]:gt(r,t,!1,!1)});var pt=function(n,r,t){for(var e,i,u,f,o,l,c,a=W(n),s=U(n),h=s,m=O,g=t?Hr(n,wr(a)):n,p=0,v=0;v<a&&!(h<=p);++v){for(e=v;Un(Kn(g[e][p]),m);)if(a<=++e&&(e=v,h<=++p)){p=-1;break}if(-1===p)break;for(u=-1,o=null,c=0,e=i=e;e<a;++e)Un(l=Kn(g[e][p]),m)?++c:null!=o&&!Fn(l,o)||(o=l,u=e);for(;-1!==u;){if(a-i===c+1){if(v!==u&&Wr(g,v,u),Fn(g[v][p],O)&&Ur(g,v,v,O,Z,p),r)for(l=g[v][p],e=0;e<v;++e)Bn(Kn(g[e][p]),l)&&Ur(g,e,v,Hn(E.floor(Y(g[e][p],l))),C,p),Fn(g[e][p],O)&&Ur(g,e,v,C,C,p);e=u,i=v;break}for(c=0,f=u,e=i;e<a;++e)e!==f&&(Ur(g,e,f,Hn(E.floor(Y(g[e][p],g[f][p]))),C,p),Un(l=Kn(g[e][p]),m)?++c:Fn(l,o)&&(o=l,u=e))}++p}return t?[Gr(g,0,s,a-1,a+s-1),Gr(g,0,0,a-1,s-1)]:g};E.hermiteForm=kn(function(n,r){return b(r=w(r)?[[r]]:r)||y("hermiteForm"),pt(E.round(E.real(r)),!0,1<n)}),E.smithForm=kn(function(n,r){b(r=w(r)?[[r]]:r)||y("smithForm");r=function(n,r,t){var e,i,u,f,o,l,c,a,s,h,m,g,p,v,d,y,w,b,x,S=W(n),A=U(n),_=k.min(S,A);for(r&&(e=wr(S)),t&&(i=wr(A)),u=-1,f=0;f<S;++f){for(s=!1,o=u+1;o<A;++o){for(m=0;m<S&&Q(n[m][o],O);++m);if(m<S){s=!0;break}}if(!s)break;if(Q(n[f][o],O)){for(c=0;c<S&&Q(n[c][o],O);++c);Br(n,f,c,O,C,C,O),r&&Qr(e,f,c,O,C,C,O)}for(Qr(n,o,f,O,C,C,O),t&&Br(i,o,f,O,C,C,O),o=f,l=!0;l;){for(l=!1,c=f+1;c<S;++c)Q(n[c][o],O)||(l=!0,Q(O,zn(n[c][o],n[f][o]))||(p=(g=Wt([n[f][o],n[c][o]]))[1],v=g[2],d=D(n[c][o],g[0]),y=D(n[f][o],g[0]),Br(n,f,c,p,v,Ln(d),y),r&&Qr(e,f,c,y,Ln(v),d,p)),w=D(n[c][o],n[f][o]),Br(n,f,c,C,O,Ln(w),C),r&&Qr(e,f,c,C,O,w,C));for(a=o+1;a<A;++a)Q(n[f][a],O)||(l=!0,Q(O,zn(n[f][a],n[f][o]))||(p=(g=Wt([n[f][o],n[f][a]]))[1],v=g[2],d=D(n[f][a],g[0]),y=D(n[f][o],g[0]),Qr(n,o,a,p,Ln(d),v,y),t&&Br(i,o,a,y,d,Ln(v),p)),w=D(n[f][a],n[f][o]),Qr(n,o,a,C,Ln(w),O,C),t&&Br(i,o,a,C,w,O,C))}u=o}for(h=0;h<_;++h)for(m=h-1;0<=m;--m)Q((g=Wt([n[m][m],n[h][h]]))[0],O)||(p=g[1],v=g[2],d=D(n[h][h],g[0]),y=D(n[m][m],g[0]),b=H(v,d),x=G(C,H(p,y)),Br(n,m,h,C,v,d,G(b,C)),r&&Qr(e,m,h,G(C,b),v,d,Z),Qr(n,m,h,p,x,C,Ln(y)),t&&Br(i,m,h,y,x,C,Ln(p)));return r&&t?[n,e,i]:r?[n,e]:t?[n,i]:n}(E.round(E.real(r)),1<n,1<n);return 1<n?[r[1],r[2],r[0]]:r});var vt=.254829592,dt=-.284496736,yt=1.421413741,wt=-1.453152027,bt=1.061405429,xt=.3275911;function St(n){n=mr(n);var r,t=L.sign(n)||1;return t<0&&(n=Ln(n)),r=On(V(H(xt,n),C)),H(t,G(C,H(V(H(V(H(V(H(V(H(bt,r),wt),r),yt),r),dt),r),vt),H(r,L.exp(Ln(H(n,n)))))))}function At(r,n){if(w(r))return r;if(d(r))return r.length?Y(Pr(r),B(r.length)):s;if(b(r)){if(1===(n=v(n=null==n?1:n)))return F(U(r),function(n){return At(q(r,n))});if(2===n)return F(W(r),function(n){return At(r[n])})}y("mean")}function _t(r,n,t){if(n=v(n||0),w(r))return O;if(d(r))return 0===r.length?s:1===r.length?O:L.sqrt(Y(Pr(ir(vr(rr(r,At(r))),B(2))),B(1===n?r.length:r.length-1)));if(b(r)){if(1===(t=v(t=null==t?1:t)))return F(U(r),function(n){return _t(q(r,n))});if(2===t)return F(W(r),function(n){return _t(r[n])})}y("std")}function It(n,r){var t,e,i,u,f,o=n.length,l=r.length,c=o+l-1;if(!o||!l)return[];for(f=new Array(c),o<l&&(u=n,o=(n=r).length,l=(r=u).length),t=0;t<c;++t)for(f[t]=O,e=0;e<l;++e)0<=(i=t-e)&&i<o&&(f[t]=J(f[t],K(n[i],r[e])));return f}function kt(n,r,t){var e,i=[],u=n.slice(),f=u.length-r.length,o=r;if(0<=f)for(i=F(f+1,O);0<=f;){for(e=f,r=o.concat(F(f,O)),i[i.length-1-f]=Y(u[0],r[0]),u=Xt(u,Zt(r,[Hn(i[i.length-1-f])]));u.length&&Cn(u[0],O);)u.shift();if((f=u.length-o.length)===e)break}return[i,t?F(n.length-u.length,O).concat(u):u]}en.push(function(){vt=B(.254829592),dt=B(-.284496736),yt=B(1.421413741),wt=B(-1.453152027),bt=B(1.061405429),xt=B(.3275911)}),E.erf=function(n){return _n(St,n,!0)},E.mean=At,E.median=function r(t,n){if(w(t))return t;if(d(t))return t.length?1&(t=Nr(t)).length?t[t.length>>1]:Y(J(t[t.length>>1],t[(t.length>>1)-1]),B(2)):s;if(b(t)){if(1===(n=v(n=null==n?1:n)))return F(U(t),function(n){return r(q(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}y("median")},E.mode=function r(t,n){if(w(t))return t;var e,i;if(d(t))return t.length?(e={},i=0,t.reduce(function(n,r){var t=r.toString(),t=un.call(e,t)?(e[t]+=1,e[t]):e[t]=1;return i<t?(i=t,n=r):t===i&&Fn(r,n)&&(n=r),n},{})):s;if(b(t)){if(1===(n=v(n=null==n?1:n)))return F(U(t),function(n){return r(q(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}y("mode")},E.moment=function r(t,e,n){if(w(t))return O;var i;if(d(t))return t.length<=1?t.length?O:s:(i=t.length,Y(Pr(ir(rr(t,At(t)),e)),B(i)));if(b(t)){if(1===(n=v(n=null==n?1:n)))return e=B(e),F(U(t),function(n){return r(q(t,n),e)});if(2===n)return e=B(e),F(W(t),function(n){return r(t[n],e)})}y("moment")},E.std=_t,E.var=function r(t,e,n){if(e=v(e||0),w(t))return O;var i,u;if(d(t))return t.length<=1?t.length?O:s:(i=t.length,u=At(t),Y(Pr(tr(pr(u=rr(t,u)),u)),B(1===e?i:i-1)));if(b(t)){if(1===(n=v(n=null==n?1:n)))return F(U(t),function(n){return r(q(t,n),e)});if(2===n)return F(W(t),function(n){return r(t[n],e)})}y("var")},E.cov=function e(i,n,u){if(u=v(u||0),2!==arguments.length||0!==v(n)&&1!==v(n)||(u=v(n),n=null),null==n){if(w(i))return O;var r;if(d(i))return i.length<=1?i.length?O:s:(t=i.length,r=At(i),Y(Pr(tr(pr(r=rr(i,r)),r)),B(1===u?t:t-1)));if(b(i))return A(U(i),U(i),function(n,r,t){return n===r?e(q(i,n),u):r<n?t[r][n]:e(q(i,n),q(i,r),u)})}else{if(w(i)&&w(n))return yr(2,2);if(b(i)&&b(n)&&(i=br(i),n=br(n)),d(i)&&d(n)){if(i.length!==n.length)throw"cov: inputs not of same dimension";var t;return i.length<=1?i.length?O:s:(t=i.length,Y(Pr(tr(pr(rr(i,At(i))),rr(n,At(n)))),B(1===u?t:t-1)))}}y("cov")},E.corrcoef=function e(i,r){if(null==r){if(w(i)||d(i))return C;if(b(i))return A(U(i),U(i),function(n,r,t){return n===r?C:r<n?t[r][n]:e(q(i,n),q(i,r))})}else{if(w(i)&&w(r))return C;if(d(i)&&d(r)){if(i.length!==r.length)throw"corrcoef: inputs not of same dimension";var n=i.length;return 1<n?Y(Pr(tr(er(rr(i,At(i)),_t(i)),er(rr(r,At(r)),_t(r)))),B(n-1)):C}if(b(i)&&b(r)){if(W(i)!==W(r)||U(i)!==U(r))throw"corrcoef: inputs not of same dimension";return F(U(i),function(n){return e(q(i,n),q(r,n))})}}y("corrcoef")},E.conv=function(n,r){return(w(n)||w(r)?tr:(n=j(n),r=j(r),d(n)&&d(r)||y("conv"),It))(n,r)},E.deconv=kn(function(n,r,t){var e;if(w(r)||w(t))e=1<n?[er(r,t),O]:er(r,t);else{if(r=j(r),t=j(t),d(r)&&d(t)||y("deconv"),!t.length||1===t.length&&Cn(t[0],O))throw"deconv: divisor is zero";e=kt(r,t,!0)}return 1<n?e:e[0]}),E.conv2=function(r,t){if(w(r)||w(t))return tr(r,t);if(d(r)){if(d(t))return It(r,t);if(b(t))return F(U(t),function(n){return It(r,q(t,n))})}else{if(d(t)){if(d(r))return It(r,t);if(b(r))return F(r[0].length,function(n){return It(q(r,n),t)});throw"conv2: input 1 not supported"}if(!b(r))throw"conv2: input 1 not supported";if(b(t)){var n,e,i,u,f,o,l,c,a,s,h,m,g,p=r,v=t;for(W(p)<W(v)&&(g=p,p=v,v=g),n=W(p),e=U(p),f=yr(o=n+(i=W(v))-1,l=e+(u=U(v))-1),a=0;a<o;++a)for(s=0;s<l;++s){for(c=O,h=0;h<=a&&!(n<=h);++h)if(!(i<=a-h))for(m=0;m<=s&&!(e<=m);++m)u<=s-m||(c=J(c,K(p[h][m],v[a-h][s-m])));f[a][s]=c}return f}}throw"conv2: input 2 not supported"},E.filter=function(n,r,t,e,i){n=j(n),r=j(r),t=j(t),d(n)&&d(r)&&d(t)||y("filter");var u,f,o,l,c=n,a=r,s=t,h=s.length,m=a.length,g=c.length,p=new Array(h),v=a[0];for(a=a.map(function(n){return Y(n,v)}),c=c.map(function(n){return Y(n,v)}),u=0;u<h;++u){for(l=O,o=u,f=0;0<=o&&f<g;++f,--o)l=J(l,K(c[f],s[o]));for(o=u-1,f=1;0<=o&&f<m;++f,--o)l=Vn(l,K(a[f],p[o]));p[u]=l}return p};var Et={},Nt={};function jt(n,r){for(var t,e,i=n.length,u={},f=0;f<i;++f)1!==u[f]&&(e=n[t=function(n,r){for(var t=0;1<r;)t=(t<<1)+(1&n),n>>=1,r>>=1;return t}(f,i)],r[t]=n[f],r[f]=e,u[t]=1)}function qt(n,r,t){var e,i,u=n.length;if(1===u)t[0]=n[0];else{for(e=0;e<u;++e)t[e]=new I(O,O);for(var f,o,l,c,a,s,h=function(n){for(var r=k.sqrt(n),t=3;t<=r;){if(0==n%t)return t;t+=2}return n}(u),m=u/h,g=B(1/k.sqrt(h)),p=new Array(m),v=new Array(m),d=0;d<h;++d){for(e=0;e<m;++e)p[e]=n[e*h+d];for(1<m&&(Rt(p,r,v),i=p,p=v,v=i),f=B(k.cos(2*R*d/u)),o=B((r?-1:1)*k.sin(2*R*d/u)),l=C,c=O,e=0;e<u;++e)a=H(g,p[e%m].re),s=H(g,p[e%m].im),t[e]=t[e].add(new I(G(H(a,l),H(s,c)),V(H(s,l),H(a,c)))),a=G(H(l,f),H(c,o)),s=V(H(l,o),H(c,f)),l=a,c=s}}}var Pt=k.SQRT1_2;function Mt(n,r,t){var e,i,u,f,o,l,c,a,s,h,m,g,p,v,d,y,w,b=n.length,x=1;for(jt(n,t);x<b;){for(e=B((w=void 0,null==(w=Nt[y=x])&&(Nt[y]=w=k.cos(R/y)),w)),i=B((r?-1:1)*(y=void 0,null==(y=Et[w=x])&&(Et[w]=y=k.sin(R/w)),y)),f=b/(2*x),u=0;u<f;++u)for(a=C,s=O,o=0;o<x;++o)g=t[h=2*u*x+o].re,p=t[h].im,l=t[m=h+x].re,c=t[m].im,v=G(H(a,l),H(s,c)),d=V(H(s,l),H(a,c)),t[h]=new I(H(V(g,v),Pt),H(V(p,d),Pt)),t[m]=new I(H(G(g,v),Pt),H(G(p,d),Pt)),l=G(H(a,e),H(s,i)),c=V(H(a,i),H(s,e)),a=l,s=c;x<<=1}}function Rt(n,r,t){var e,i=n.length;if(!(i<=0))return e=!1,null==t&&(t=new Array(i),e=!0),(i&i-1?qt:Mt)(n,r,t),e?t:void 0}function Tt(n,r,t){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,f,o=!1,l=new Array(e),c=new Array(i),a=new Array(e),s=new Array(i);if(null==t){for(t=new Array(e),u=0;u<e;++u)t[u]=new Array(i);o=!0}for(f=0;f<i;++f,0){for(u=0;u<e;++u)l[u]=n[u][f];for(Rt(l,r,a),u=0;u<e;++u)t[u][f]=a[u]}for(u=0;u<e;++u){for(f=0;f<i;++f,0)c[f]=t[u][f];for(Rt(c,r,s),f=0;f<i;++f,0)t[u][f]=s[f]}return o?t:void 0}}function Xt(n,r){for(var t=n.length-1,e=r.length-1,i=[];0<=t&&0<=e;)i.unshift(J(n[t--],r[e--]));for(;0<=t;)i.unshift(n[t--]);for(;0<=e;)i.unshift(r[e--]);return i}en.push(function(){Pt=B(k.SQRT1_2)}),E.fft=function(r){return b(r=j(r))?F(U(r),function(n){return qn(Rt(Pn(q(r,n)),!1))}):d(r)?qn(Rt(Pn(r),!1)):void y("fft")},E.ifft=function(r){return b(r=j(r))?F(U(r),function(n){return qn(Rt(Pn(q(r,n)),!0))}):d(r)?qn(Rt(Pn(r),!0)):void y("ifft")},E.fft2=function(n){return b(n)||y("fft2"),qn(Tt(Pn(n),!1))},E.ifft2=function(n){return b(n)||y("ifft2"),qn(Tt(Pn(n),!0))};var Zt=It,zt=kt;function Lt(n,r){if(!n.length)return O;r=r||O;for(var t=n.length,e=0,i=n[0];e+1<t;)++e,i=J(K(i,r),n[e]);return i}function Ot(r){if(r.length<=1)return[];var n,t,e,i,u,f,o,l,c,a,s,h,m,g=r.length-1,p=B(1e-10),v=new I(p,O),d=new I(O,O),y=new I(C,O);for(r=r.map(B),a=function(n){return Lt(r,n)},s=function(n){return Y(Vn(a(J(n,v)),a(n)),v)},n=r.map(function(n){return I(n).abs()}),f=n.length-1;0<f&&Q(n[f],O);)--f;for(e=V(D(qr(n.slice(0,f))||O,qr([n[f],C])),C),t=D(n[0],qr(V(n[0],qr(n.slice(1))))),i=F(g,function(){return new I(V(t,H(G(e,t),k.random())),B(k.random()*R/2),"polar")}),c=1;c<=1e4;++c){for(f=u=0;f<g;++f){if(o=i[f],h=a(o),Q((m=s(o)).re,O)&&Q(m.im,O)){if(Tn(L.abs(h.re),p)&&Tn(L.abs(h.im),p)){++u;continue}l=new I(e,O)}else l=h.div(m);h=l.div(y.sub(l.mul(i.reduce(function(n,r,t){return n=t===f||Q(o.re,r.re)&&Q(o.im,r.im)?n:n.add(o.sub(r).inv())},d)))),Tn(L.abs(h.re),p)&&Tn(L.abs(h.im),p)&&++u,i[f]=o.sub(h)}if(u===g)break}return i}function Ct(n,r){for(var t,e,i,u=O,f=k.min(n.length,r.length)-1,o=0;o<f;++o)t=n[o],i=n[o+1],e=r[o],u=V(u,D(G(H(t,r[o+1]),H(e,i)),rn));return 1<f&&(t=n[f],i=n[0],e=r[f],u=V(u,D(G(H(t,r[0]),H(e,i)),rn))),u}function $t(u,f){var o,n,r,t,e,i,l,c,a,s,h=u.length,m=F(h,function(n){return n});if(h<3)return m;for(o=0,n=1;n<h;++n)(Mn(f[n],f[o])||Q(f[n],f[o])&&Mn(u[n],u[o]))&&(o=n);for(m.splice(o,1),--h,m=m.map(function(n){return[(r=u[o],t=f[o],e=u[n],i=f[n],Fn(i=L.atan2(G(i,t),G(e,r)),O)?V(i,2*R):i),n];var r,t,e,i}).sort(function(n,r){return Mn(n[0],r[0])?-1:Rn(n[0],r[0])?1:0}).map(function(n){return n[1]}),(r=new Array(h+1))[0]=o,r[1]=m[0],r[2]=m[1],t=3,n=2;n<h;++n){for(;1<t&&Tn(O,(e=u[m[n]],i=f[m[n]],l=u[r[t-1]],c=f[r[t-1]],a=u[r[t-2]],s=f[r[t-2]],e=G(e,a),l=G(l,a),a=G(i,s),i=G(c,s),G(H(e,i),H(a,l))));)--t;r[t++]=m[n]}return r.length=t,r}function Ft(){var n,r,t,e,i=arguments,u=i.length;if(0===u)return O;for(e=0;e<u&&Q(O,n=i[e++]););for(n=L.abs(n);e<u;){if(Q(n,C))return C;for(;e<u&&Q(O,r=i[e++]););if(Q(r=L.abs(r),C))return C;if(!Q(r,n)){if(Q(r,O))break;for(Mn(n,r)&&(t=r,r=n,n=t);!Q(O,r);)r=zn(n,t=r),n=t}}return n}function Wt(n){var r,t,e,i,u=n.length,f=C,o=O,l=O,c=C,a=C,s=C;if(0!==u){if(r=n[0],Rn(O,r)&&(r=L.abs(r),a=Z),1===u)return[r,a];if(i=2===u?[n[1],C]:Wt(n.slice(1)),t=i[0],Rn(O,t)&&(t=L.abs(t),s=Z),Q(O,r))return F(i.length+1,function(n){return 0===n?t:1===n?a:H(s,i[n-1])});if(Q(O,t))return F(i.length+1,function(n){return 0===n?r:1===n?a:H(s,i[n-1])});for(;;){if(e=L.floor(D(r,t)),r=zn(r,t),f=G(f,H(e,l)),o=G(o,H(e,c)),Q(O,r))return l=H(l,a),c=H(c,s),F(i.length+1,function(n){return 0===n?t:1===n?l:H(c,i[n-1])});if(e=L.floor(D(t,r)),t=zn(t,r),l=G(l,H(e,f)),c=G(c,H(e,o)),Q(O,t))return f=H(f,a),o=H(o,s),F(i.length+1,function(n){return 0===n?r:1===n?f:H(o,i[n-1])})}}}function Ut(n,r){var t=L.abs(n);return Q(t,L.abs(r))?Q(n_sign(n),n_sign(r))?t:Ln(t):H(D(n,Ft(n,r)),r)}E.polydiv=kn(function(n,r,t){var e;if(w(r)||w(t))e=1<n?[er(r,t),O]:er(r,t);else{if(r=j(r),t=j(t),d(r)&&d(t)||y("polydiv"),!t.length||1===t.length&&Cn(t[0],O))throw"polydiv: divisor is zero";e=zt(r,t,!1)}return 1<n?e:e[0]}),E.polyval=function(r,n){return d(r=j(r))||y("polyval"),w(n)?qn(Lt(r,n)):d(n)?n.map(function(n){return qn(Lt(r,n))}):void y("polyval")},E.polyvalm=function(r,n){return d(r=j(r))||y("polyvalm"),b(n)&&W(n)===U(n)?qn(function(n,r){if(!n.length)return yr(W(r),U(r));for(var t=n.length,e=0,i=W(r),u=wr(i,n[0]);e+1<t;)++e,u=nr(P(u,r),wr(i,n[e]));return u}(r,n)):w(n)?qn(Lt(r,n)):d(n)?n.map(function(n){return qn(Lt(r,n))}):void y("polyvalm")},E.polyfit=function(n,r,i){if(n=j(n),r=j(r),d(n)&&d(r)||y("polyfit"),n.length!==r.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return qn(function(e,i){var n,u,f,r,t,o,l,c;if(!(d(e)&&e.length&&d(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),f=k.min(e.length,i.length),e.length=f,i.length=f,l={},c=[],u=0;u<f;++u)if(o=String(e[u]),un.call(l,o)){if(!Cn(i[l[o]],i[u]))return[];c.push(u)}else l[o]=u;for(;c.length;)u=c.pop(),e.splice(u,1),i.splice(u,1);for(c=l=null,r=F(f=e.length,function(n){for(var r=C,t=0;t<f;++t)t!==n&&(r=K(r,Vn(e[n],e[t])));return r=Y(i[n],r)}),t=F(f,function(n){return[C,Hn(e[n])]}),n=[],u=0;u<f;++u)n=Xt(n,t.reduce(function(n,r,t){return n=t!==u?Zt(n,r):n},[r[u]]));return n}(n,r));if(!p(i)||v(i)<0)throw"polyfit: input 3 not positive int";return i=v(i),qn(P(ut(n.reduce(function(n,r){for(var t=1,e=[C];t<=i;++t)e.unshift(K(r,e[0]));return n.push(e),n},[])),r))},E.roots=function(n){return d(n=j(n))||y("roots"),qn(Ot(n).sort(function(n,r){return Mn(mr(n),mr(r))?-1:Rn(mr(n),mr(r))?1:0}))},E.compan=function(n){return d(n=j(n))||y("compan"),A((t=n).length-1,t.length-1,function(n,r){return 0===n?Hn(Y(t[r+1],t[0])):r+1===n?C:O});var t},E.poly=function(n){return b(n=j(n))&&E.charpoly?E.charpoly(n):(d(n)||y("poly"),qn(n.reduce(function(n,r){return Zt(n,[C,Hn(r)])},[C])))},E.cart2pol=kn(function(n,r,t,e){return[E.atan2(t,r),E.sqrt(nr(ir(r,rn),ir(t,rn))),e]},3),E.pol2cart=kn(function(n,r,t,e){return[tr(t,E.cos(r)),tr(t,E.sin(r)),e]},3),E.cart2sph=kn(function(n,r,t,e){var i=nr(ir(r,rn),ir(t,rn));return[E.atan2(t,r),E.atan2(e,E.sqrt(i)),E.sqrt(nr(i,ir(e,rn)))]},3),E.sph2cart=kn(function(n,r,t,e){return[tr(e,tr(E.cos(t),E.cos(r))),tr(e,tr(E.cos(t),E.sin(r))),tr(e,E.sin(t))]},3),E.polyarea=function(r,t){return r=j(r),t=j(t),b(r)&&b(t)?(W(r)===W(t)&&U(r)===U(t)||y("polyarea"),F(U(r),function(n){return Ct(q(r,n),q(t,n))})):d(r)&&d(t)?(r.length!==t.length&&y("polyarea"),Ct(r,t)):void y("polyarea")},E.convhull=kn(function(n,r,t,e){3<arguments.length&&y("convhull"),b(r)&&2===U(r)?(t=q(r,1),r=q(r,0)):(r=j(r),t=j(t)),d(r)&&d(t)&&r.length===t.length||y("convhull");var i=$t(r,t);return 1<n?[i.map(function(n){return n+1}),Ct(i.map(function(n){return r[n]}),i.map(function(n){return t[n]}))]:i.map(function(n){return n+1})}),E.mod=function(n,t){return Cn(t=xn(t||0),0)?n:_n(function(n){var r;return $(n)?Mn(r=zn(n,t),0)&&Rn(t,0)?V(r,t):r:n},n,!0)},E.gcd=kn(function(n,r,t){return function t(e,i,u){if(u){var f,o;if(S(e)){if(f=new Array(e.length),S(i))return e.length!==i.length&&y("gcd"),o=new Array(i.length),[e.map(function(n,r){return n=t(n,i[r],u),f[r]=n[1],o[r]=n[2],n[0]}),f,o];if(p(i))return o=new Array(e.length),[e.map(function(n,r){return n=t(n,i,u),f[r]=n[1],o[r]=n[2],n[0]}),f,o]}if(p(e)){if(S(i))return f=new Array(i.length),o=new Array(i.length),[i.map(function(n,r){return n=t(e,n,u),f[r]=n[1],o[r]=n[2],n[0]}),f,o];if(p(i))return Wt([e,i])}}else{if(S(e)){if(S(i))return e.length!==i.length&&y("gcd"),e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(S(i))return i.map(function(n,r){return t(e,n)});if(p(i))return Ft(e,i)}}y("gcd")}(r,t,1<n)}),E.lcm=function t(e,i){if(S(e)){if(S(i))return e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(S(i))return i.map(function(n,r){return t(e,n)});if(p(i))return function(){var n,r,t=arguments,e=t.length;if(e<=1)return 1===e?t[0]:O;if(Q(O,t[0])||Q(O,t[1]))return O;for(r=Ut(t[0],t[1]),n=2;n<e;++n){if(Q(O,t[n]))return O;r=Ut(r,t[n])}return r}(e,i)}return e};var Bt=[B(2),B(3),B(5),B(7),B(11),B(13),B(17),B(19),B(23),B(29),B(31),B(37),B(41),B(43),B(47),B(53),B(59),B(61),B(67),B(71),B(73),B(79),B(83),B(89),B(97),B(101),B(103),B(107),B(109)];function Qt(n){if(N(n))return 0<n.length;if(hn(n))return!1;if(u(n))return 0!==n;if(gn(n))return!n.eq(O);if(f(n))return!Q(n.re,O)||!Q(n.im,O);if(S(n)){if(!n.length)return!1;for(var r=0,t=n.length;r<t;++r)if(!Qt(n[r]))return!1;return!0}return!0===n}en.push(function(){Bt=[B(2),B(3),B(5),B(7),B(11),B(13),B(17),B(19),B(23),B(29),B(31),B(37),B(41),B(43),B(47),B(53),B(59),B(61),B(67),B(71),B(73),B(79),B(83),B(89),B(97),B(101),B(103),B(107),B(109)]}),E.factor=function(n){for(var r,t,e=L.floor(L.abs(mr(xn(n)))),i=B(1e30),u=[],f=e,o=0,l=Bt.length;o<l;++o){if(Q(f,r=Bt[o]))return[r];if(Rn(t=H(r,r),e)||null!=i&&Rn(t,i))break;for(;Q(O,zn(e,r));)u.push(r),e=D(e,r)}if(l<=o)for(t=H(r=V(r,rn),r);Tn(t,e)&&(null==i||Tn(t,i));){for(;Q(O,zn(e,r));)u.push(r),e=D(e,r);t=H(r=V(r,rn),r)}return Rn(e,C)&&u.push(e),u},E.string=function n(r){return S(r)?r.map(n):N(r)?r:String(r)},E.strlength=function(n){if(N(n))return n.length;y("strlength")},E.char=function n(r){return r=j(r),S(r)?r.map(n):N(r)?r.split(""):p(r)?String.fromCharCode(v(r)):String(r)},E.lower=E.tolower=function n(r){return S(r)?r.map(n):N(r)?r.toLowerCase():r},E.upper=E.toupper=function n(r){return S(r)?r.map(n):N(r)?r.toUpperCase():r},E.dec2bin=function n(r){return S(r)?r.map(n):u(r)?r.toString(2):gn(r)?r.toBinary():r},E.bin2dec=function n(r){return S(r)?r.map(n):N(r)?parseInt(r,2):r},E.dec2hex=function n(r){return S(r)?r.map(n):u(r)?r.toString(16):gn(r)?r.toHexadecimal():r},E.hex2dec=function n(r){return S(r)?r.map(n):N(r)?parseInt(r,16):r};var Vt={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var r=[],t=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?t.length&&(S(t[0])?r=r.length?xr("vert",r,t):t:r.push(t),t=[]):!cn(n,Kt)&&S(n)?t=t.length?xr("horz",t,n):n:t.push(n))}),t.length&&(S(t[0])?r=r.length?xr("vert",r,t):t:r.length?r.push(t):r=t),r}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return br(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r){return br(n,r)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r,t){return br(n,r,t)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:Ar},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:Sr},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:ur},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:ir},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,r){return rt(n,r)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:er},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:er},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:P},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:tr},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:nr},"-":{name:"sub",arity:2,arityalt:1,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:function(n,r){return 1===arguments.length?fr(n):rr(n,r)}},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Bn},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Un},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Wn},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Fn},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:$n},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Cn},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,r){return Qt(n)&&Qt(r)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){return Qt(n)||Qt(r)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){n=Qt(n),r=Qt(r);return n&&!r||r&&!n?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return Qt(n)?0:1}},"=":{name:"set",breakpoint:"set",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,r){var t,e;return S(n)&&cn(n[0],Kt)?(e=n,S(t=r)?await Promise.all(e.map(function(n,r){return Gt(n,r<t.length?t[r]:null)})):await Promise.all(e.map(function(n,r){return Gt(n,0===r?t:null)}))):Gt(n,r.$scilitevarargout$?r[0]:r)}}};async function Gt(n,r){if(cn(n,Kt)&&N(n.v))return await n.set(r),n.get(!0);throw"setting non-variable"}async function Ht(n,r,t){var e,i,u,f,o,l,c=null;if(Qt(await ne(n.if.cond,r,t))){for(e=0,f=(o=n.if.statements).length;e<f;++e)null!=(l=await ne(o[e],r,t))&&(c=l);return c}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(Qt(await ne(n.elseif[i].cond,r,t))){for(e=0,f=(o=n.elseif[i].statements).length;e<f;++e)null!=(l=await ne(o[e],r,t))&&(c=l);return c}if(n.else.statements.length){for(e=0,f=(o=n.else.statements).length;e<f;++e)null!=(l=await ne(o[e],r,t))&&(c=l);return c}}async function Dt(n,r,t){var e,i,u,f,o,l,c,a,s=null,h=!1,m=!1,g=await ne(n.val,r,t),p=n.statements;if(S(g)){for(l=(t=t||{}).brk,c=t.cont,t.brk=function(){h=!0},t.cont=function(){m=!0},u=0,f=(a=yn(g))?U(g):g.length;u<f;++u){for(m=h=!1,await n.ind.set(a?q(g,u):g[u]),e=0,i=p.length;e<i&&(o=await ne(p[e],r,t),!h&&!m);++e)null!=o&&(s=o);if(h)break}t.brk=l,t.cont=c}return s}async function Jt(n,r,t){var e,i,u,f=null,o=!1,l=!1,c=n.statements,a=(t=t||{}).brk,s=t.cont;for(t.brk=function(){o=!0},t.cont=function(){l=!0};Qt(await ne(n.cond,r,t));){for(l=o=!1,e=0,i=c.length;e<i&&(u=await ne(c[e],r,t),!o&&!l);++e)null!=u&&(f=u);if(o)break}return t.brk=a,t.cont=s,f}function Kt(n,r,t){if(!cn(this,Kt))return new Kt(n,r,t);this.ctx=n,this.v=r,this.i=t}async function Yt(n){return cn(n,Kt)?await n.get():n}function M(n,r){if(!cn(this,M))return new M(n,r);null==r&&(r=n,n=""),this.op=n,this.arg=r}async function ne(n,r,t){if(cn(n,M))return te(n,r,t);if(S(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await ne(n[e],r,t);return u}return n}function re(d,y,w,i){var b,x=0,S=0,u=d;function A(n,r,t){null==t&&(t=S),null==r&&(r=x);var e=u.split("\n")[t];return(n=String(n)+" at line "+String((w||0)+t)+" position "+String((i||0)+r)+":")+"\n"+e+"\n"+new Array(r+1).join(" ")+"^\n"}return function i(n){var r,t,e,u,f,o,l,c=[],a=[],s=[];function h(n){var r,t,e,i,u,f,o,l;if(a.length)if(n)for(;0<a.length;){if(u=(i=a.shift())[0],n===(f=Vt[u]).breakpoint){a.unshift(i);break}if(f.arity>c.length){if(!(null!=f.arityalt&&f.arityalt<=c.length))throw A('invalid or missing argument for "'+u+'"',i[1],i[2]);l=c.splice(0,f.arityalt).reverse()}else l=c.splice(0,f.arity).reverse();o=M(f.fn,l),c.unshift(o)}else if(t=(r=a.shift())[0],1===(e=Vt[t]).fixity){if(e.arity>c.length){if(!(null!=e.arityalt&&e.arityalt<=c.length))throw A('invalid or missing argument for "'+t+'"',r[1],r[2]);l=c.splice(0,e.arityalt).reverse()}else l=c.splice(0,e.arity).reverse();o=M(e.fn,l),c.unshift(o)}else{if(-1!==e.fixity)for(;0<a.length&&(u=(i=a[0])[0],(f=Vt[u]).priority<e.priority||f.priority===e.priority&&(f.associativity<e.associativity||f.associativity===e.associativity&&-1===f.associativity));){if(f.arity>c.length){if(!(null!=f.arityalt&&f.arityalt<=c.length))throw A('invalid or missing argument for "'+u+'"',i[1],i[2]);l=c.splice(0,f.arityalt).reverse()}else l=c.splice(0,f.arity).reverse();o=M(f.fn,l),c.unshift(o),a.shift()}a.unshift(r)}}function m(n){if(h(!0),1<c.length||0<a.length)throw A("mismatched terms and operators",a.length?a[0][1]:x,a.length?a[0][2]:S);!0===n&&(cn(c[0],M)&&s.push(c[0]),c=[],a=[])}function g(n,r){var t,e=n.test?d.match(n):n===d.slice(0,n.length);return!!e&&(!1===r?n.test?e:[n,n]:n.test?(t=e[r||0].length,d=d.slice(t),x+=t,e):(t=n.length,d=d.slice(t),x+=t,[n,n]))}function p(n,r,t){for(var e,i=t||0,u="";i<d.length;)if(n===(e=d.charAt(i))){if(!(i+1<d.length&&n===d.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return r&&(d=d.slice(i+1),x+=i+1),[u,i+1]}function v(){var n,r,t,e=function(n,r,t){for(var e,i=0,u=0;i<d.length;)if(e=d.charAt(i),!t||'"'!==e&&"'"!==e){if(r===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=p(e,!1,i+1)[1];return u||i>=d.length?-1:i}("]","[",!0);if(-1===e)throw A("mismatched brackets");if(n=d.slice(0,e),/[\[\]]/.test(n)){for(r=[];t=i(",;]");)if(r.push(t),g(","))r.push(M(","));else{if(!g(";"))break;r.push(M(";"))}g(/^\s+/),g("]")}else r=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,r){var t=n.length,e=0;return r.trim().split(-1<r.indexOf(",")?",":/\s+/g).reduce(function(n,r){return(r=re(r.trim(),y,S+w,x))&&(e?n.push(M(",")):t&&n.push(M(";")),n.push(r),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,r){return(r=re(r.trim(),y,S+w,x))&&(n.length&&n.push(M(",")),n.push(r)),n},[]),d=d.slice(e+1),x+=e+1,1<(n=n.split("\n")).length&&(S+=n.length-1,n.slice(0,-1).forEach(function(n){x-=n.length+1}));return M(Vt["[]"].fn,r)}for(;0<d.length;)if(g(/^if\b/)){if(m(!0),!(l=i("\n,")))throw A('missing or invalid condition in "if"');for(g("\n")?(++S,x=0):g(","),f=(o={if:{cond:l,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((l=i(["elseif","else","end"]))&&(f.statements=f.statements.concat(l)),g("elseif")){if(!(l=i("\n,")))throw A('missing or invalid condition in "elseif"');g("\n")?(++S,x=0):g(","),o.elseif.push({cond:l,statements:[]}),f=o.elseif[o.elseif.length-1]}else if(g("else"))g(/^[ \t\v\f]+/),g("\n")?(++S,x=0):g(","),f=o.else;else if(g("end")||!l)break;s.push(M(Ht,o))}else if(g(/^for\b/)){if(m(!0),!(r=g(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw A('missing or invalid declaration in "for"');if(!(l=i("\n,")))throw A('missing or invalid declaration in "for"');for(g("\n")?(++S,x=0):g(","),o={ind:Kt(y,r[1]),val:l,statements:[]};(l=i(["end"]))&&(o.statements=o.statements.concat(l)),!g("end")&&l;);s.push(M(Dt,o))}else if(g(/^while\b/)){if(m(!0),!(l=i("\n,")))throw A('missing or invalid condition in "while"');for(g("\n")?(++S,x=0):g(","),o={cond:l,statements:[]};(l=i(["end"]))&&(o.statements=o.statements.concat(l)),!g("end")&&l;);s.push(M(Jt,o))}else if(r=g(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(r[1]))break;if("continue"===r[1])g("continue"),s.push(M("continue",""));else if("break"===r[1])g("break"),s.push(M("break",""));else{if("end"!==r[1])throw A('unexpected "'+r[1]+'"');g("end"),c.unshift(M("v",Kt(y,"end")))}}else if(g("..."))g(/^[ \t\v\f]+/),g("\n")&&(++S,x=0);else if(g(";",!1)){if(n&&-1<n.indexOf(";"))break;g(";"),m(!0)}else if(g("\n",!1)){if(n&&-1<n.indexOf("\n"))break;g("\n"),++S,m(!(x=0))}else if(g(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(r=g("%"))b=d.indexOf("\n"),d=d.slice(-1<b?b+1:d.length),-1<b&&++S,m(!(x=0));else if(r=(r=g("'"))||g('"'))f=p(r[0],!0)[0],c.unshift(M("'"===r[0]?f.split(""):f));else if(r=g(/^(&&|\|\|)[^&\|]/,1))u=r[1],a.unshift([u,x,S]),h();else if(r=g(/^(xor)[^a-zA-Z]/,1))u=r[1],a.unshift([u,x,S]),h();else if(r=g(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=r[1],a.unshift([u,x,S]),h();else if(r=g("~"))a.unshift(["~",x,S]),h();else if(r=g("="))a.unshift(["=",x,S]),h();else if(r=g(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=r[0],a.unshift([u,x,S]),h();else if(r=g(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(t=r[1],g(/^\s*\:\s*\)/))f=M("v",Kt(y,t)),c.unshift(f),a.unshift(["(:)",x,S]),h();else{for(o=[];(l=i(",)"))&&o.push(l),g(","););if(!g(")"))throw A("mismatched parentheses");f=un.call(E,t)?M(E[t],o):M("v",Kt(y,t,o.length?o:null)),c.unshift(f)}g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h())}else if(r=g(/^[_a-z][_a-z0-9]*/i))t=r[0],f=un.call(E,t)&&0===E[t].length?M(E[t],[]):M("v",Kt(y,t)),c.unshift(f),g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h());else if(r=g(/^(-?\s*\d+(\.\d+)?([eE][+-]?\d+)?)([ij])?/))o=r[1].split(/\s+/).join(""),o=_?_(o):parseFloat(o,10),f=M(r[4]?new I(0,o):o),c.unshift(f);else if(r=g(/^(-?\s*\.\d+([eE][+-]?\d+)?)([ij])?/))o="-"===(o=r[1].split(/\s+/).join("")).charAt(0)?"-0"+o.slice(1):"0"+o,o=_?_(o):parseFloat(o,10),f=M(r[4]?new I(0,o):o),c.unshift(f);else if("["===(e=d.charAt(0)))d=d.slice(1),x+=1,(f=v())&&(c.unshift(f),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw A("mismatched brackets")}if("("===e)if(d=d.slice(1),x+=1,g(/^\s*\:\s*\)/))a.unshift(["(:)",x,S]),h();else{if(c.length&&a.reduce(function(n,r){return r=Vt[r[0]],n+(r.arity>c.length-n&&null!=r.arityalt?r.arityalt:r.arity)},0)<=c.length){for(h("set"),f=c.shift(),o=[];(l=i(",)"))&&o.push(l),g(","););if(!g(")"))throw A("mismatched parentheses");o.length&&(f=M("v",Kt(y,f,o)))}else if(f=i(")"),!g(")"))throw A("mismatched parentheses");f&&(c.unshift(f),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw A("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw A(n?'missing expected "'+(N(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(d=d.slice(1),l=[x+=1,S],h("set"),c.length?o=1:(o=0,c.unshift(M(":")));f=i(":,)\n"),g(/^[ \t\v\f]+/),f?(c.unshift(f),++o):g(":",!1)&&c.unshift(M(":")),g(":"););1<o&&(a.unshift([3===o?"::":":",l[0],l[1]]),h())}}return m(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function te(n,r,t){var e;if(cn(n,M)){if(""===n.op)return n.arg;if("v"===n.op)return!1===r?n.arg:cn(n.arg.v,M)?Yt(n.arg):sn(r)&&un.call(r,n.arg.v)?r[n.arg.v]:await Yt(n.arg);if(Ht===n.op)return Ht(n.arg,r,t);if(Dt===n.op)return Dt(n.arg,r,t);if(Jt===n.op)return Jt(n.arg,r,t);if("break"===n.op)return void(t&&an(t.brk)&&t.brk());if("continue"===n.op)return void(t&&an(t.cont)&&t.cont());if(Vt["="].fn===n.op)return t=t||{},e=await te(n.arg[0],!1),S(e)&&cn(e[0],Kt)&&(t.nargout=e.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[e,n.arg[1].arg.isByRef()?An(await te(n.arg[1],r,t)):await te(n.arg[1],r,t)]):n.op.apply(null,[e].concat(await Promise.all(n.arg.slice(1).map(function(n){return te(n,r,t)}))));if(an(n.op))return(t&&p(t.nargout)&&an(n.op.nargout)?n.op.nargout(t.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return te(n,r,t)})))}throw"invalid expr"}return on.op=Vt,Kt.prototype={constructor:Kt,ctx:null,v:null,i:null,get:async function(n){var r,t,e=this;if(cn(e.v,M))r=await ne(e.v);else{if(!un.call(e.ctx,e.v)&&!un.call(ln,e.v))throw'undefined variable "'+e.v+'"';r=(un.call(e.ctx,e.v)?e.ctx:ln)[e.v]}return!0!==n&&null!=e.i?(t=Lr(r),n=await Promise.all(e.i.map(function(n,r){return ne(n,{end:1===e.i.length?t[0]*t[1]:t[r]})})),or.apply(null,[r].concat(n))):r},set:async function(n){var r,t,e,i=this;if(null!=i.i){if(cn(i.v,M))r=await ne(i.v);else{if(!un.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';r=i.ctx[i.v]}t=Lr(r),1===(e=await Promise.all(i.i.map(function(n,r){return ne(n,{end:1===i.i.length?t[0]*t[1]:t[r]})}))).length&&(e=e.concat(null)),lr.apply(null,[r].concat(e).concat([n]))}else cn(i.v,M)||(i.ctx[i.v]=n);return i},isset:function(){return N(this.v)&&un.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},M.prototype={constructor:M,op:null,arg:null},l.createContext=function(){return{ans:null}},l.eval=async function(n,r,t){r=r||l.createContext();var e=re(String(n),r,null==t?1:t,1),i=null,u=!1;if(S(e))for(var f=0,o=e.length;f<o;++f)e[f]&&(i=await te(e[f]),u=!0);else e&&(i=await te(e),u=!0);return u&&(S(i)||hn(i)||w(i)||N(i))&&(r.ans=i),u?i:null},on});