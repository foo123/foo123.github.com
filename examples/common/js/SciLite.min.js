/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.12
* 2026-01-29 21:01:22
* https://github.com/foo123/SciLite
*
**/!function(r,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(r)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(r)}):n in r||(r[n]=t.call(r)||1)&&"function"==typeof define&&define.amd&&define(function(){return r[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function r(){}var t,j,T=null,A=null,F=Math,W={},e={},R=F.PI,i=F.E,o=F.log(10),f=F.log(2),fn=1/0,l=NaN,cn=1e-15,s=Number.MAX_VALUE,h=Number.MIN_VALUE,m=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,d=m,Q=0,U=1,M=-1,B=2,P=10,X=F.SQRT2,z=F.SQRT1_2,L=[],an=Object.prototype.hasOwnProperty,ln=Object.prototype.toString,k=Array.isArray||function(n){return"[object Array]"===ln.call(n)},sn={VERSION:"0.9.12",_:{},fn:{},op:{},constant:{pi:R,e:i,eps:cn,realmax:s,realmin:h,intmax:m,intmin:g,inf:fn,Inf:fn,nan:l,NaN:l}},c=sn._,hn=sn.constant,V=sn.fn;function v(n){throw String(n)+": input(s) not supported"}function mn(n,r){return n instanceof r}function gn(n){return"function"==typeof n}function pn(n){return"[object Object]"===ln.call(n)}function _(n){return"string"==typeof n}function dn(n){return bn(n)&&n.isNaN()||Number.isNaN(n)}function vn(n){return bn(n)&&!n.isFinite()||yn(n)&&!isFinite(n)}function yn(n){return"number"==typeof n}function bn(n){return null!=T&&n instanceof T}function Z(n){return"number"==typeof n||null!=T&&n instanceof T}function p(n){return bn(n)&&n.isInt()||yn(n)&&Number.isInteger(n)}function u(n){return null!=A&&n instanceof A}function wn(n){return!u(n)||H(Q,n.im)}function y(n,r){if(yn(n)||u(n)||bn(n))return!0;if(!1===r){if(b(n)&&1===n.length)return!0;if(w(n)&&1===n.length&&1===n[0].length)return!0}return!1}function b(n){return k(n)&&y(n[0])}function w(n){return k(n)&&k(n[0])&&y(n[0][0])}function xn(n){return!k(n)}function kn(n){return k(n)&&!k(n[0])}function Sn(n){return k(n)&&k(n[0])}function O(n,r){n=F.max(0,F.round(n));for(var t=new Array(n),e=0;e<n;++e)t[e]=gn(r)?r(e,t):r;return t}function S(n,r,t){n=F.max(0,F.round(n)),r=F.max(0,F.round(r));for(var e,i,u=new Array(n),o=0;o<n;++o)for(u[o]=i=new Array(r),e=0;e<r;++e)i[e]=gn(t)?t(o,e,u):t;return u}function An(n,t){return n.length?O(n[0],function(r){return 1<n.length?An(n.slice(1),function(n){return gn(t)?t([r].concat(n)):t}):gn(t)?t([r]):t}):[]}function _n(n){return xn(n)?[[n]]:kn(n)?[n]:n}function qn(n){return xn(n)?[[n]]:kn(n)?n.map(function(n){return[n]}):n}function En(n,r){return Z(n)?n:u(n)?r?n.re:n:b(n)&&1===n.length?En(n[0],r):w(n)&&1===n.length&&1===n[0].length?En(n[0][0],r):n}function q(n){if(null!=n)if(Sn(n)){if(1===G(n))return n[0];if(1===$(n))return n.map(function(n){return n[0]})}else if(xn(n))return[n];return n}function G(n){return n.length}function $(n){return n[0].length}function E(r,t){return O(r.length,function(n){return r[n][t]})}function I(n){return"number"==typeof n?n:bn(n)?n.$valueOf():u(n)?n.valueOf():n}function D(n){if(null!=T){if("number"==typeof n)return T(n);if(u(n)&&("number"==typeof n.re||"number"==typeof n.im))return new A("number"==typeof n.re?T(n.re):n.re,"number"==typeof n.im?T(n.im):n.im)}return n}function In(n){return k(n)?n.map(In):y(n)?I(n):n}function Nn(n){return k(n)?n.map(Nn):y(n)?D(n):n}function jn(n){return n=k(n)?n.map(jn):n}function Tn(r,n,t){if(Z(n))return r(n);if(u(n)){if(t)return r(n);if(H(n.im,Q))return r(n.re)}return k(n)?n.map(function(n){return Tn(r,n,t)}):n}function Rn(t,n,e,i){return Z(n)&&Z(e)?t(n,e):y(n)&&y(e)?i?t(Zn(n),Zn(e)):wn(n)&&wn(e)?t(Ln(n),Ln(e)):l:k(n)&&k(e)?n.map(function(n,r){return Rn(t,n,e[r],i)}):l}function Mn(t,e){if(!gn(t))return k(t)&&(t.$scilitevarargout$=!0),t;null==e&&(e=1);function n(){var n=[].slice.call(arguments);return n.unshift(e),n=t.apply(null,n),1<e&&k(n)&&(n.$scilitevarargout$=!0),n}return n.nargout=function(r){return function(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),(1<r||1<e)&&k(n)&&(n.$scilitevarargout$=!0),n}},n}function Pn(n){return dn(n)?n="nan":vn(n)?n=(On(n,Q)?"-":"")+"inf":p(n)?n=String(n):Z(n)?n=n.toFixed(4).replace(/\.0{4}$/,""):u(n)&&(n=String(n)),n}function Xn(t){var r;return null==t?t="":_(t)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(t)&&(t="\\text{"+t+"}"):t=dn(t)?"\\text{nan}":Z(t)?[cn,s,h,m,g].reduce(function(n,r){return n||H(t,r)},!1)?String(t):Pn(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):u(t)?String(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):w(t)?(r=!1,$(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,F.round(c.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-F.round(c.MAXPRINTSIZE/2)))}),r=!0),"\\begin{bmatrix}"+(t=G(t)>c.MAXPRINTSIZE?t.slice(0,F.round(c.MAXPRINTSIZE/2)).concat([O(t[0].length,function(n){return F.round(c.MAXPRINTSIZE/2)===n&&r?"\\ddots":"\\vdots"})]).concat(t.slice(1-F.round(c.MAXPRINTSIZE/2))):t).map(function(n){return n.map(Xn).join(" & \\hskip 1em ")}).join(" \\\\ ")+"\\end{bmatrix}"):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,F.round(c.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(t.slice(1-F.round(c.MAXPRINTSIZE/2))):t).map(Xn).join(" \\hskip 1em "):"object"==typeof t||"function"==typeof t?"":String(t),t}function zn(t){var r,e;return null==t?t="":_(t)||(t=dn(t)?"nan":Z(t)?([cn,s,h,m,g].reduce(function(n,r){return n||H(t,r)},!1)?String:Pn)(t):u(t)?String(t):w(t)?(r=!1,$(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,F.round(c.MAXPRINTSIZE/2)).concat("..").concat(n.slice(1-F.round(c.MAXPRINTSIZE/2)))}),r=!0),G(t)>c.MAXPRINTSIZE&&(t=t.slice(0,F.round(c.MAXPRINTSIZE/2)).concat([O(t[0].length,function(n){return F.round(c.MAXPRINTSIZE/2)===n&&r?":.":":"})]).concat(t.slice(1-F.round(c.MAXPRINTSIZE/2)))),e=O($(t),function(n){return E(t,n).reduce(function(n,r){return F.max(n,zn(r).length)},0)}),t.map(function(n,r){return"["+n.map(function(n,r){n=zn(n);return n=n.length<e[r]?new Array(e[r]-n.length+1).join(" ")+n:n}).join("  ")+"]"}).join("\n")):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,F.round(c.MAXPRINTSIZE/2)).concat([".."]).concat(t.slice(1-F.round(c.MAXPRINTSIZE/2))):t).map(zn).join("  "):"object"==typeof t||"function"==typeof t?"":String(t)),t}function Ln(n){return k(n)?n.map(Ln):u(n)&&H(n.im,Q)?n.re:n}function Zn(n){return A?k(n)?n.map(Zn):Z(n)?new A(D(n),Q):n:n}function H(n,r){return yn(n)?yn(r)?n===r:r.eq(n):n.eq(r)}function On(n,r){return yn(n)?yn(r)?n<r:r.gt(n):n.lt(r)}function $n(n,r){return yn(n)?yn(r)?r<n:r.lt(n):n.gt(r)}function Cn(n,r){return yn(n)?yn(r)?n<=r:r.gte(n):n.lte(r)}function Fn(n,r){return yn(n)?yn(r)?r<=n:r.lte(n):n.gte(r)}function K(n,r){return yn(n)?yn(r)?n+r:r.add(n):n.add(r)}function Wn(n,r){return yn(n)?yn(r)?n-r:r.neg().add(n):n.sub(r)}function J(n,r){return yn(n)?yn(r)?n*r:r.mul(n):n.mul(r)}function Qn(n,r){return yn(n)?yn(r)?n/r:T(n).div(r):n.div(r)}function Un(n,r){return dn(n)||dn(r)?l:yn(n)?yn(r)?n<0&&!p(r)?Ln(new A(n).pow(r)):F.pow(n,r):n<0&&!p(r)?Ln(new A(T(n)).pow(r)):T(n).pow(r):$n(Q,n)&&!p(r)?Ln(new A(n).pow(T(r))):n.pow(r)}function Bn(n,r){return yn(n)?yn(r)?n%r:T(n).mod(r):n.mod(r)}function Vn(n){return yn(n)?-n:n.neg()}function Gn(n){return yn(n)?1/n:U.div(n)}function Y(t,e){if(_(t)){if(_(e))return t===e?1:0;if(y(e))return t===String(e)?1:0;if(b(e))return e.map(function(n){return Y(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Y(t,e[n][r])})}else if(Z(t)){if(_(e))return String(t)===e?1:0;if(Z(e))return H(t,e)?1:0;if(u(e))return H(e.re,t)&&H(e.im,Q)?1:0;if(b(e))return e.map(function(n){return Y(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Y(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)===e?1:0;if(Z(e))return H(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return H(t.re,e.re)&&H(t.im,e.im)?1:0;if(b(e))return e.map(function(n){return Y(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Y(t,e[n][r])})}else if(b(t)){if(_(e)||y(e))return t.map(function(n){return Y(n,e)});if(b(e)){if(t.length!==e.length)throw"eq: inputs have incompatible dimensions";return t.map(function(n,r){return Y(n,e[r])})}if(w(e)){if(t.length!==$(e))throw"eq: inputs have incompatible dimensions";return S(G(e),$(e),function(n,r){return Y(t[r],e[n][r])})}}else if(w(t)){if(_(e)||y(e))return S(G(t),$(t),function(n,r){return Y(t[n][r],e)});if(b(e)){if($(t)!==e.length)throw"eq: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Y(t[n][r],e[r])})}if(w(e)){if(G(t)!==G(e)||$(t)!==$(e))throw"eq: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Y(t[n][r],e[n][r])})}}return 0}function Dn(t,e){if(_(t)){if(_(e))return t===e?0:1;if(y(e))return t===String(e)?0:1;if(b(e))return e.map(function(n){return Dn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Dn(t,e[n][r])})}else if(Z(t)){if(_(e))return String(t)===e?0:1;if(Z(e))return H(t,e)?0:1;if(u(e))return H(e.re,t)&&H(e.im,Q)?0:1;if(b(e))return e.map(function(n){return Dn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Dn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)===e?0:1;if(Z(e))return H(t.re,e)&&H(t.im,Q)?0:1;if(u(e))return H(t.re,e.re)&&H(t.im,e.im)?0:1;if(b(e))return e.map(function(n){return Dn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Dn(t,e[n][r])})}else if(b(t)){if(_(e)||y(e))return t.map(function(n){return Dn(n,e)});if(b(e)){if(t.length!==e.length)throw"ne: inputs have incompatible dimensions";return t.map(function(n,r){return Dn(n,e[r])})}if(w(e)){if(t.length!==$(e))throw"ne: inputs have incompatible dimensions";return S(G(e),$(e),function(n,r){return Dn(t[r],e[n][r])})}}else if(w(t)){if(_(e)||y(e))return S(G(t),$(t),function(n,r){return Dn(t[n][r],e)});if(b(e)){if($(t)!==e.length)throw"ne: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Dn(t[n][r],e[r])})}if(w(e)){if(G(t)!==G(e)||$(t)!==$(e))throw"ne: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Dn(t[n][r],e[n][r])})}}return 0}function Hn(t,e){if(_(t)){if(_(e))return t<e?1:0;if(y(e))return t<String(e)?1:0;if(b(e))return e.map(function(n){return Hn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Hn(t,e[n][r])})}else if(Z(t)){if(_(e))return String(t)<e?1:0;if(Z(e))return On(t,e)?1:0;if(u(e))return On(e.re,t)&&H(e.im,Q)?1:0;if(b(e))return e.map(function(n){return Hn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Hn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)<e?1:0;if(Z(e))return On(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return On(t.re,e.re)&&H(t.im,Q)&&H(e.im,Q)||On(t.im,e.im)&&H(t.re,Q)&&H(e.re,Q)?1:0;if(b(e))return e.map(function(n){return Hn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Hn(t,e[n][r])})}else if(b(t)){if(_(e)||y(e))return t.map(function(n){return Hn(n,e)});if(b(e)){if(t.length!==e.length)throw"lt: inputs have incompatible dimensions";return t.map(function(n,r){return Hn(n,e[r])})}if(w(e)){if(t.length!==$(e))throw"lt: inputs have incompatible dimensions";return S(G(e),$(e),function(n,r){return Hn(t[r],e[n][r])})}}else if(w(t)){if(_(e)||y(e))return S(G(t),$(t),function(n,r){return Hn(t[n][r],e)});if(b(e)){if($(t)!==e.length)throw"lt: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Hn(t[n][r],e[r])})}if(w(e)){if(G(t)!==G(e)||$(t)!==$(e))throw"lt: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Hn(t[n][r],e[n][r])})}}return 0}function Kn(t,e){if(_(t)){if(_(e))return e<t?1:0;if(y(e))return t>String(e)?1:0;if(b(e))return e.map(function(n){return Kn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Kn(t,e[n][r])})}else if(Z(t)){if(_(e))return String(t)>e?1:0;if(Z(e))return $n(t,e)?1:0;if(u(e))return $n(e.re,t)&&H(e.im,Q)?1:0;if(b(e))return e.map(function(n){return Kn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Kn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)>e?1:0;if(Z(e))return $n(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return $n(t.re,e.re)&&H(t.im,Q)&&H(e.im,Q)||$n(t.im,e.im)&&H(t.re,Q)&&H(e.re,Q)?1:0;if(b(e))return e.map(function(n){return Kn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Kn(t,e[n][r])})}else if(b(t)){if(_(e)||y(e))return t.map(function(n){return Kn(n,e)});if(b(e)){if(t.length!==e.length)throw"gt: inputs have incompatible dimensions";return t.map(function(n,r){return Kn(n,e[r])})}if(w(e)){if(t.length!==$(e))throw"gt: inputs have incompatible dimensions";return S(G(e),$(e),function(n,r){return Kn(t[r],e[n][r])})}}else if(w(t)){if(_(e)||y(e))return S(G(t),$(t),function(n,r){return Kn(t[n][r],e)});if(b(e)){if($(t)!==e.length)throw"gt: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Kn(t[n][r],e[r])})}if(w(e)){if(G(t)!==G(e)||$(t)!==$(e))throw"gt: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Kn(t[n][r],e[n][r])})}}return 0}function Jn(t,e){if(_(t)){if(_(e))return t<=e?1:0;if(y(e))return t<=String(e)?1:0;if(b(e))return e.map(function(n){return Jn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Jn(t,e[n][r])})}else if(Z(t)){if(_(e))return String(t)<=e?1:0;if(Z(e))return Cn(t,e)?1:0;if(u(e))return Cn(e.re,t)&&H(e.im,Q)?1:0;if(b(e))return e.map(function(n){return Jn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Jn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)<=e?1:0;if(Z(e))return Cn(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return Cn(t.re,e.re)&&H(t.im,Q)&&H(e.im,Q)||Cn(t.im,e.im)&&H(t.re,Q)&&H(e.re,Q)?1:0;if(b(e))return e.map(function(n){return Jn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Jn(t,e[n][r])})}else if(b(t)){if(_(e)||y(e))return t.map(function(n){return Jn(n,e)});if(b(e)){if(t.length!==e.length)throw"le: inputs have incompatible dimensions";return t.map(function(n,r){return Jn(n,e[r])})}if(w(e)){if(t.length!==$(e))throw"le: inputs have incompatible dimensions";return S(G(e),$(e),function(n,r){return Jn(t[r],e[n][r])})}}else if(w(t)){if(_(e)||y(e))return S(G(t),$(t),function(n,r){return Jn(t[n][r],e)});if(b(e)){if($(t)!==e.length)throw"le: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Jn(t[n][r],e[r])})}if(w(e)){if(G(t)!==G(e)||$(t)!==$(e))throw"le: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Jn(t[n][r],e[n][r])})}}return 0}function Yn(t,e){if(_(t)){if(_(e))return e<=t?1:0;if(y(e))return t>=String(e)?1:0;if(b(e))return e.map(function(n){return Yn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Yn(t,e[n][r])})}else if(Z(t)){if(_(e))return String(t)>=e?1:0;if(Z(e))return Fn(t,e)?1:0;if(u(e))return Fn(e.re,t)&&H(e.im,Q)?1:0;if(b(e))return e.map(function(n){return Yn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Yn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)>=e?1:0;if(Z(e))return Fn(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return Fn(t.re,e.re)&&H(t.im,Q)&&H(e.im,Q)||Fn(t.im,e.im)&&H(t.re,Q)&&H(e.re,Q)?1:0;if(b(e))return e.map(function(n){return Yn(t,n)});if(w(e))return S(G(e),$(e),function(n,r){return Yn(t,e[n][r])})}else if(b(t)){if(_(e)||y(e))return t.map(function(n){return Yn(n,e)});if(b(e)){if(t.length!==e.length)throw"ge: inputs have incompatible dimensions";return t.map(function(n,r){return Yn(n,e[r])})}if(w(e)){if(t.length!==$(e))throw"ge: inputs have incompatible dimensions";return S(G(e),$(e),function(n,r){return Yn(t[r],e[n][r])})}}else if(w(t)){if(_(e)||y(e))return S(G(t),$(t),function(n,r){return Yn(t[n][r],e)});if(b(e)){if($(t)!==e.length)throw"ge: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Yn(t[n][r],e[r])})}if(w(e)){if(G(t)!==G(e)||$(t)!==$(e))throw"ge: inputs have incompatible dimensions";return S(G(t),$(t),function(n,r){return Yn(t[n][r],e[n][r])})}}return 0}function nr(n){return u(n)?n.sign():W.sign(n)}function nn(n,r){return Z(n)&&Z(r)?K(n,r):u(n)&&y(r)?n.add(r):u(r)&&y(n)?r.add(n):l}function rn(n,r){return Z(n)&&Z(r)?Wn(n,r):u(n)&&y(r)?n.sub(r):u(r)&&y(n)?r.neg().add(n):l}function tn(n,r){return Z(n)&&Z(r)?J(n,r):u(n)&&y(r)?n.mul(r):u(r)&&y(n)?r.mul(n):l}function en(n,r){return Z(n)&&Z(r)?Qn(n,r):u(n)&&y(r)?n.div(r):u(r)&&y(n)?r.inv().mul(n):l}function rr(n,r){return Z(n)&&Z(r)?Un(n,r):u(n)&&y(r)?n.pow(r):u(r)&&y(n)?new A(n,Q).pow(r):l}function tr(n){return Z(n)?Vn(n):u(n)?n.neg():l}function er(n){return Z(n)?n:u(n)?n.conj():l}function ir(n){return Z(n)?H(n,Q)?fn:Gn(n):u(n)?H(n.abs(),Q)?new A(fn,On(n.im,Q)?fn:-fn):n.inv():l}function un(n){return Z(n)?W.abs(n):u(n)?n.abs():l}function ur(n){return Z(n)?On(n,Q)?hn.pi:Q:u(n)?n.angle():l}function or(r,e){if(_(r)&&_(e))return r+e;if(y(r)&&y(e))return nn(r,e);if(w(r)&&w(e)){if(G(r)===G(e)&&$(r)===$(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return or(n,t[r])})});throw"add: matrix dimensions do not match"}if(b(r)&&b(e)){if(r.length===e.length)return r.map(function(n,r){return or(n,e[r])});throw"add: vector dimensions do not match"}return k(r)?r.map(function(n){return or(n,e)}):k(e)?e.map(function(n){return or(r,n)}):void v("add")}function fr(r,e){if(y(r)&&y(e))return rn(r,e);if(w(r)&&w(e)){if(G(r)===G(e)&&$(r)===$(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return fr(n,t[r])})});throw"sub: matrix dimensions do not match"}if(b(r)&&b(e)){if(r.length===e.length)return r.map(function(n,r){return fr(n,e[r])});throw"sub: vector dimensions do not match"}return k(r)?r.map(function(n){return fr(n,e)}):k(e)?e.map(function(n){return fr(r,n)}):void v("sub")}function cr(r,e){if(y(r)&&y(e))return tn(r,e);if(w(r)&&w(e)){if(G(r)===G(e)&&$(r)===$(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return cr(n,t[r])})});throw"dotmul: matrix dimensions do not match"}if(b(r)&&b(e)){if(r.length===e.length)return r.map(function(n,r){return cr(n,e[r])});throw"dotmul: vector dimensions do not match"}return k(r)?r.map(function(n){return cr(n,e)}):k(e)?e.map(function(n){return cr(r,n)}):void v("dotmul")}function ar(r,e){if(y(r)&&y(e))return en(r,e);if(w(r)&&w(e)){if(G(r)===G(e)&&$(r)===$(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return ar(n,t[r])})});throw"dotdiv: matrix dimensions do not match"}if(b(r)&&b(e)){if(r.length===e.length)return r.map(function(n,r){return ar(n,e[r])});throw"dotdiv: vector dimensions do not match"}return k(r)?r.map(function(n){return ar(n,e)}):k(e)?e.map(function(n){return ar(r,n)}):void v("dotdiv")}function lr(r,e){if(y(r)&&y(e))return rr(r,e);if(w(r)&&w(e)){if(G(r)===G(e)&&$(r)===$(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return lr(n,t[r])})});throw"dotpow: matrix dimensions do not match"}if(b(r)&&b(e)){if(r.length===e.length)return r.map(function(n,r){return lr(n,e[r])});throw"dotpow: vector dimensions do not match"}return k(r)?r.map(function(n){return lr(n,e)}):k(e)?e.map(function(n){return lr(r,n)}):void v("dotpow")}function sr(u,o,n){if($(u)===G(o))return S(G(u),$(o),"lower"===n?function(n,r){if(n<r)return Q;for(var t=Q,e=r,i=n;e<=i;++e)t=nn(t,tn(u[n][e],o[e][r]));return t}:function(n,r){if(r<n)return Q;for(var t=Q,e=n,i=r;e<=i;++e)t=nn(t,tn(u[n][e],o[e][r]));return t});throw"mul: matrix-matrix dimensions do not match"}function N(i,u){if(y(i)&&y(u))return tn(i,u);if(w(i)&&w(u)){if($(i)===G(u))return n=G(i),r=$(u),o=G(u),S(n,r,function(n,r){for(var t=Q,e=0;e<o;++e)t=nn(t,tn(i[n][e],u[e][r]));return t});throw"mul: matrix-matrix dimensions do not match"}if(b(i)&&w(u)){if(i.length===G(u))return r=$(u),o=i.length,S(n=1,r,function(n,r){for(var t=Q,e=0;e<o;++e)t=nn(t,tn(i[e],u[e][r]));return t});throw"mul: vector-matrix dimensions do not match"}if(w(i)&&b(u)){var o;if($(i)===u.length)return n=G(i),o=u.length,S(n,r=1,function(n,r){for(var t=Q,e=0;e<o;++e)t=nn(t,tn(i[n][e],u[e]));return t});throw"mul: matrix-vector dimensions do not match"}var n,r;return b(i)&&b(u)?S(n=i.length,r=u.length,function(n,r){return tn(i[n],u[r])}):k(i)?i.map(function(n){return N(n,u)}):k(u)?u.map(function(n){return N(i,n)}):void v("mul")}function hr(n,r){if(y(n)&&y(r))return rr(n,r);if(w(n)&&G(n)===$(n)&&p(r)){if((r=I(r))<0&&(r=-r,!(n=_t(n))||!n.length))throw"pow: no inverse";if(0===r)return Or(G(n));if(1===r)return n;if(2===r)return N(n,n);for(var t=Or(G(n));0!==r;)1&r&&(t=N(t,n)),0<(r>>=1)&&(n=N(n,n));return t}v("pow")}function mr(n){return y(n)?tr(n):k(n)?n.map(mr):n}function gr(e,n=":",t=null){if(kn(e)){if(b(n)&&n.length===e.length&&ct(n,function(n){return 0===I(n)||1===I(n)}))return o=1===(o=n.reduce(function(n,r,t){return 1===I(r)&&n.push(e[t]),n},[])).length?o[0]:o;if(":"===(n=y(n)?En(n,!0):n)||p(n)||b(n))return r=e.length,1===(o=(n=p(n=":"===n?$r(1,r):n)?[n]:n).map(function(n){if((n=I(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[n-1]})).length?o[0]:o;throw"get: invalid range"}if(Sn(e)){var i=G(e),u=$(e),r=i*u;if(null==t&&w(n)&&G(n)===i&&$(n)===u&&ct(n,function(n){return 0===I(n)||1===I(n)})){for(var o=[],f=0;f<u;++f)for(var c=0;c<i;++c)1===I(n[c][f])&&o.push(e[c][f]);return o=1===o.length?o[0]:o}if(y(n)&&(n=En(n,!0)),y(t)&&(t=En(t,!0)),":"===n||p(n)||b(n)){if(p(n=":"===n?$r(1,i):n)&&(n=[n]),null==t)return o=1===(o=n.map(function(n){if((n=I(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[(n-1)%i][F.floor((n-1)/i)]})).length?o[0]:o;if(":"===t||p(t)||b(t))return p(t=":"===t?$r(1,u):t)&&(t=[t]),o=1===(o=n.map(function(r){if((r=I(r))<1&&(r+=i),r<1||i<r)throw"get: index out of bounds";return t.map(function(n){if((n=I(n))<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[r-1][n-1]})})).length&&1===o[0].length?o[0][0]:o}throw"get: invalid range"}return e}function pr(i,r=":",n=null,u=null){if(kn(i)){if(Sn(u)&&(u=E(u,0)),b(r)&&r.length===i.length&&ct(r,function(n){return 0===I(n)||1===I(n)})){if(xn(u))return r.forEach(function(n,r){1===I(n)&&(i[r]=u)}),i;if(k(u))return h=0,t=u.length,r.forEach(function(n,r){if(1===I(n)){if(t<=h)throw"set: index out of bounds";i[r]=u[h++]}}),i}if(":"===(r=y(r)?En(r,!0):r)||p(r)||b(r)){var e=i.length;if(p(r=":"===r?$r(1,e):r)&&(r=[r]),xn(u))return r.forEach(function(n){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u}),i;if(k(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u[r]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(Sn(i)){var o,f,t,c,a,l,s,h,m=G(i),g=$(i),e=m*g;if(w(r)&&G(r)===m&&$(r)===g&&ct(r,function(n){return 0===I(n)||1===I(n)})){if(xn(u))return r.forEach(function(n,t){n.forEach(function(n,r){1===I(n)&&(i[t][r]=u)})}),i;if(Sn(u)){for(o=G(u),f=$(u),s=a=0;a<g;++a,++s){if(1===f)s=0;else if(f<=s)throw"set: index out of bounds";for(l=c=0;c<m;++c,++l)if(1===I(r[c][a])){if(1===o)l=0;else if(o<=l)throw"set: index out of bounds";i[c][a]=u[l][s]}}return i}if(k(u)){for(t=u.length,a=h=0;a<g;++a)for(c=0;c<m;++c)if(1===I(r[c][a])){if(t<=h)throw"set: index out of bounds";i[c][a]=u[h++]}return i}}if(y(r)&&(r=En(r,!0)),y(n)&&(n=En(n,!0)),":"===r||p(r)||b(r)){if(null==n){if(p(r=":"===r?$r(1,e):r)&&(r=[r]),xn(u))return r.forEach(function(n){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][F.floor((n-1)/m)]=u}),i;if(Sn(u))return o=G(u),f=$(u),r.forEach(function(n,r){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";var t=1===o?0:r%m,r=1===f?0:F.floor(r/m);if(o<=t||f<=r)throw"set: index out of bounds";i[(n-1)%m][F.floor((n-1)/m)]=u[t][r]}),i;if(k(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][F.floor((n-1)/m)]=u[r]}),i}else if(":"===n||p(n)||b(n)){if(p(r=":"===r?$r(1,m):r)&&(r=[r]),p(n=":"===n?$r(1,g):n)&&(n=[n]),xn(u))return r.forEach(function(r){if((r=I(r))<1&&(r+=m),r<1||m<r)throw"set: index out of bounds";n.forEach(function(n){if((n=I(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";i[r-1][n-1]=u})}),i;if(Sn(u))return o=G(u),f=$(u),r.forEach(function(t,e){if((t=I(t))<1&&(t+=m),t<1||m<t)throw"set: index out of bounds";if(1===o)e=0;else if(o<=e)throw"set: index out of bounds";n.forEach(function(n,r){if((n=I(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";if(1===f)r=0;else if(f<=r)throw"set: index out of bounds";i[t-1][n-1]=u[e][r]})}),i;if(k(u)&&u.length>=r.length*n.length)return h=0,n.forEach(function(t,n){if((t=I(t))<1&&(t+=g),t<1||g<t)throw"set: index out of bounds";r.forEach(function(n,r){if((n=I(n))<1&&(n+=m),n<1||m<n)throw"set: index out of bounds";i[n-1][t-1]=u[h++]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function dr(n,r){var t,e,i;return yn(n)&&yn(r)?(t=n,e=r,t=F.abs(t),e=F.abs(e),(i=0)===t?e:0===e?t:e<t?t*F.sqrt(1+(i=e/t)*i):t<e?e*F.sqrt(1+(i=t/e)*i):t*F.SQRT2):W.sqrt(K(J(n,n),J(r,r)))}function vr(){var n,r,t,e=0,i=0;if(yn(vr.z1))return t=vr.z1,vr.z1=null,t;for(;0===e||1===e;)e=F.random();for(;0===i||1===i;)i=F.random();return r=(n=F.sqrt(-2*F.log(e)))*F.cos(2*R*i),t=n*F.sin(2*R*i),vr.z1=t,r}function yr(n,r){var t,n=1===arguments.length?n:fr(n,r);return n.reduce(function(n,r){return n&&(yn(r)||u(r)&&yn(r.re)&&yn(r.im))},!0)?(t=0,r=(r=n).map(function(n){return n=un(n),t<n&&(t=n),n}),0===t?0:t*F.sqrt(r.reduce(function(n,r){return r===t?n+1:n+(n=r/t)*n},0))):W.sqrt(on(Yr(n,n)))}function br(n,r){n=1===arguments.length?n:fr(n,r);return on(Yr(n,n))}function wr(n,r,t){n=ar(fr(n,r),t);return on(Yr(n,n))}function xr(n,r,t){n=fr(n,r);return on(Yr(q(N(n,t)),n))}function kr(n,r,t){return H(t=2===arguments.length?r:t,U)?2===arguments.length?Ar(n):Ar(n,r):H(t,B)?2===arguments.length?yr(n):yr(n,r):vn(t)?2===arguments.length?Sr(n):Sr(n,r):rr(Kr(lr(zr(2===arguments.length?n:fr(n,r)),t)),Gn(t))}function Sr(n,r){return Hr(zr(1===arguments.length?n:fr(n,r)))}function Ar(n,r){return Kr(zr(1===arguments.length?n:fr(n,r)))}function _r(n,r){return rn(U,en(en(Yr(n,r),W.sqrt(on(Yr(n,n)))),W.sqrt(on(Yr(r,r)))))}function qr(n,r){return _r(fr(n,Yt(n)),fr(r,Yt(r)))}function Er(n,e){return D(n.reduce(function(n,r,t){return n+1-Y(r,e[t])},0)/n.length)}function Ir(n,e){return D(1-n.reduce(function(n,r,t){return n+Y(r,e[t])},0)/n.length)}function Nr(n,r){for(var t,e,i=n.length,u=n.map(function(n,r){return[n,r]}).sort(function(n,r){return Y(n[0],r[0])?n[1]-r[1]:Hn(n[0],r[0])?-1:1}),o=new Array(i),f=0;f<i;){for(e=1,t=f;t+e<i&&Y(u[t][0],u[t+e][0]);)++e;for(;t<f+e;)o[u[t][1]]=dn(u[t][0])?l:D(r?(2*f<=i?f+1:i-f)+(1<e?1/e:0):f+1+(1<e?1/e:0)),++t;f=t}return o}function jr(n,r){var t=n.length;return 1<t?en(Kr(cr(ar(fr(n,Yt(n)),ne(n)),ar(fr(r,Yt(r)),ne(r)))),D(t-1)):U}function Tr(n,r){return jr(Nr(n),Nr(r))}function Rr(n,r){if(1<n.length){for(var t,e=n.length,i=Q,u=0;u<e;++u)for(t=u+1;t<e;++t)i=nn(i,tn(nr(rn(n[u],n[t])),nr(rn(r[u],r[t]))));return en(en(tn(i,B),e),e-1)}return U}function Mr(){if(!mn(this,Mr))return new Mr;this.data=[]}function on(n){return Tn(function(n){return u(n)?n.re:n},n,!0)}function Pr(n){return Tn(function(n){return u(n)?n.im:0},n,!0)}function Xr(n){return Tn(er,n,!0)}function zr(n){return Tn(un,n,!0)}function Lr(n,r){if(vn(r=null==r?B:r)){if(y(n=q(n)))return un(n);if(b(n))return(On(r,Q)?Dr:Hr)(zr(n));if(w(n)&&$n(r,Q))return Hr(Kr(zr(Fr(n))))}else if(Z(r)){if(n=q(n),H(r,U)){if(y(n))return un(n);if(b(n))return Kr(zr(n));if(w(n))return Hr(Kr(zr(n)))}else if(H(r,B)){if(y(n))return un(n);if(b(n))return yr(n);if(w(n))return Hr(Ot(n,null,!1,!1))}else if($n(r,Q)){if(y(n))return un(n);if(b(n))return kr(n,r)}}else if("fro"===r&&w(n))return W.sqrt(Nt(on(N(Wr(n),n))));v("norm")}function Zr(n,r){return b(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),Q)}function Or(n,t){return null==t&&(t=U),S(I(n=En(n=null==n?1:n,!0)),I(n),function(n,r){return n===r?t:Q})}function $r(n,r,t){if(1===arguments.length&&k(n)){if(Sn(n)){for(var e,i=G(n),u=$(n),o=new Array(u*i),f=0,c=0;c<u;++c)for(e=0;e<i;++e)o[f++]=n[e][c];return o}return n}if(null!=t&&null!=r||(null!=r?(t=r,r=U):(t=n,n=r=U)),n=En(n,!0),r=En(r,!0),t=En(t,!0),o=[],$n(r,Q))for(;Cn(n,t);n=K(n,r))o.push(n);else if(On(r,Q))for(;Fn(n,t);n=K(n,r))o.push(n);return o}function Cr(n,r,t){if("horz"===n){if(kn(r)&&kn(t))return r.concat(t);if(Sn(r)&&Sn(t)&&G(r)===G(t))return r.map(function(n,r){return n.concat(t[r])})}if("vert"===n){if(kn(r)&&kn(t))return r.concat(t);if(Sn(r)&&Sn(t)&&$(r)===$(t))return r.concat(t)}v("cat")}function Fr(t){return Sn(t)?S($(t),G(t),function(n,r){return t[r][n]}):t}function Wr(t){return Sn(t)?S($(t),G(t),function(n,r){return y(t[r][n])?er(t[r][n]):t[r][n]}):kn(t)?t.map(function(n){return y(n)?er(n):n}):y(t)?er(t):t}function Qr(t,i){return i=I(i||0),xn(t)?[[t]]:kn(t)?S(t.length,t.length,function(n,r){return i===n-r?t[n]:Q}):Sn(t)?t.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i===e-t&&n.push(r),n},n)},[]):void v("diag")}function Ur(t,n){var e,i;return xn(t)?t:kn(t)?t.slice().reverse():Sn(t)?(e=G(t),i=$(t),1===(n=I(n=null==n?1:n))?S(e,i,function(n,r){return t[e-1-n][r]}):2===n?S(e,i,function(n,r){return t[n][i-1-r]}):t):void v("flip")}function Br(n,r){var t=on(n),e=on(r),n=Pr(n),r=Pr(r),t=On(t,e)?-1:$n(t,e)?1:0,e=On(n,r)?-1:$n(n,r)?1:0;return t||e}function Vr(n,r){var t=un(n),e=un(r),n=ur(n),r=ur(r),t=On(t,e)?-1:$n(t,e)?1:0,e=On(n,r)?-1:$n(n,r)?1:0;return t||e}function Gr(r,t,e,i,n){var u;if(xn(r))return r;if(b(r))return null==i&&(i=wn(r)?Br:Vr),u=r.map(function(n,r){return{v:n,i:r}}).sort("descend"===e?function(n,r){return i(r.v,n.v)||n.i-r.i}:function(n,r){return i(n.v,r.v)||n.i-r.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(w(r)){if(1===t)return n?(u=O($(r),function(n){n=E(r,n);return Gr(n,t,e,null==i?wn(n)?Br:Vr:i,!0)}),[S(G(r),$(r),function(n,r){return u[r][0][n]}),S(G(r),$(r),function(n,r){return u[r][1][n]})]):(u=O($(r),function(n){n=E(r,n);return Gr(n,t,e,null==i?wn(n)?Br:Vr:i,!1)}),S(G(r),$(r),function(n,r){return u[r][n]}));if(2===t)return n?(u=O(G(r),function(n){n=r[n];return Gr(n,t,e,null==i?wn(n)?Br:Vr:i,!0)}),[S(G(r),$(r),function(n,r){return u[n][0][r]}),S(G(r),$(r),function(n,r){return u[n][1][r]})]):(u=O(G(r),function(n){n=r[n];return Gr(n,t,e,null==i?wn(n)?Br:Vr:i,!1)}),S(G(r),$(r),function(n,r){return u[n][r]}))}v("sort")}function Dr(r){return y(r=q(r))?r:b(r)?r.reduce(function(n,r){return n=On(r,n)?r:n},fn):w(r)?O($(r),function(n){return Dr(E(r,n))}):l}function Hr(r){return y(r=q(r))?r:b(r)?r.reduce(function(n,r){return n=$n(r,n)?r:n},-fn):w(r)?O($(r),function(n){return Hr(E(r,n))}):l}function Kr(r,n){if(y(r=q(r)))return r;if(b(r))return r.reduce(nn,Q);if(w(r)){if(1===(n=I(n=null==n?1:n)))return O($(r),function(n){return Kr(E(r,n))});if(2===n)return O(G(r),function(n){return Kr(r[n])})}return l}function Jr(r,n){if(y(r=q(r)))return r;if(b(r))return r.reduce(tn,U);if(w(r)){if(1===(n=I(n=null==n?1:n)))return O($(r),function(n){return Jr(E(r,n))});if(2===n)return O(G(r),function(n){return Jr(r[n])})}return l}function Yr(r,e,i){if(i=!0===i,r=q(r),e=q(e),y(r)&&y(e))return tn(r,i?e:er(e));if(b(r)&&b(e)){if(r.length===e.length)return r.reduce(function(n,r,t){return nn(n,tn(r,i?e[t]:er(e[t])))},0)}else if(w(r)&&w(e)&&G(r)===G(e)&&$(r)===$(e))return O($(r),function(n){return Yr(E(r,n),E(e,n),i)});return 0}function nt(t,e){var n,r,i,u;if(w(t)){if(w(e))return n=G(t),r=$(t),i=G(e),u=$(e),S(n*i,r*u,function(n,r){return N(t[F.floor(n/i)][F.floor(r/u)],e[n%i][r%u])});if(b(e))return n=G(t),r=$(t),i=1,u=e.length,S(n*i,r*u,function(n,r){return N(t[n][F.floor(r/u)],e[r%u])})}else if(b(t)){if(b(e))return S(t.length,e.length,function(n,r){return N(t[n],e[r])});if(w(e))return n=t.length,i=G(e),u=$(e),S(n*i,(r=1)*u,function(n,r){return N(t[F.floor(n/i)],e[n%i][r%u])})}return N(t,e)}function rt(r,t,n){if(b(t)){var e,i,u;if(null==r||y(r)){for(null==r&&(r=U),e=0,i=t.length-1,u=Q;e<i;++e)u=nn(u,tn(r,en(nn(t[e+1],t[e]),B)));return u}if(b(r)&&r.length===t.length){for(e=0,i=r.length-1,u=Q;e<i;++e)u=nn(u,tn(un(rn(r[e+1],r[e])),en(nn(t[e+1],t[e]),B)));return u}}else if(w(t))if(1===(n=I(n=null==n?1:n))){if(null==r||y(r)||b(r)&&r.length===G(t))return O($(t),function(n){return rt(r,E(t,n))});if(w(r)&&G(r)===G(t)&&$(r)===$(t))return O($(t),function(n){return rt(null==r?null:E(r,n),E(t,n))})}else if(2===n){if(null==r||y(r)||b(r)&&r.length===$(t))return O(G(r),function(n){return rt(r,t[n])});if(w(r)&&G(r)===G(t)&&$(r)===$(t))return O(G(r),function(n){return rt(r[n],t[n])})}v("trapz")}function tt(r,t,e,i){var u;if(y(r))return r;if(b(r)){if("reverse"===(e=null==e?"forward":e))return r.slice().reverse().map(function(n,r){return u=0===r?n:t(u,n)}).reverse();if("forward"===e)return r.map(function(n,r){return u=0===r?n:t(u,n)})}else if(w(r)){if(1===(i=I(i=null==i?1:i)))return O($(r),function(n){return tt(E(r,n),t,e,i)});if(2===i)return O(G(r),function(n){return tt(r[n],t,e,i)})}return!1}function et(r,t,e,i,u){var o;if(b(r))return O(o=r.length,function(n){return t(r.slice(F.max(0,n-e),F.min(o-1,n+i)+1))});if(w(r)){if(1===(u=I(u=null==u?1:u)))return O($(r),function(n){return et(E(r,n),t,e,i,u)});if(2===u)return O(G(r),function(n){return et(r[n],t,e,i,u)})}return!1}function it(r,t){if(p(r)){if(p(t))return I(r)&I(t);if(k(t))return t.map(function(n){return it(r,n)})}else if(k(r)){if(p(t))return r.map(function(n){return it(n,t)});if(k(t)&&r.length===t.length)return r.map(function(n,r){return it(n,t[r])})}return 0}function ut(r,t){if(p(r)){if(p(t))return I(r)|I(t);if(k(t))return t.map(function(n){return ut(r,n)})}else if(k(r)){if(p(t))return r.map(function(n){return ut(n,t)});if(k(t)&&r.length===t.length)return r.map(function(n,r){return ut(n,t[r])})}return 0}function ot(n){var r,t,e=[].slice.call(arguments,1);return k(e[0])&&(e=q(e[0])),xn(n)?(r=[1,1],e.length?e.map(function(n){return r[I(n)-1]}):r):kn(n)?(r=[1,n.length],e.length?e.map(function(n){return r[I(n)-1]}):r):k(t=n)&&k(t[0])&&k(t[0][0])?(r=[n.length].concat(ot(n[0])),e.length?e.map(function(n){return r[I(n)-1]}):r):Sn(n)?(r=[G(n),$(n)],e.length?e.map(function(n){return r[I(n)-1]}):r):[]}function ft(n,i){var u;return b(n)?n.reduce(function(n,r,t){return i(r,t+1,1)&&n.push(t+1),n},[]):w(n)?(u=G(n),n.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i(r,e+1,t+1)&&n.push(e+u*t+1),n},n)},[])):[]}function ct(n,r){if(y(n))return r(n,1,1)?1:0;if(b(n)){for(var t=0,e=n.length;t<e;++t)if(!r(n[t],t+1,1))return 0;return 1}if(w(n)){for(var t=0,i=G(n),u=$(n);t<i;++t)for(var o=0;o<u;++o)if(!r(n[t][o],t+1,o+1))return 0;return 1}return 0}function at(n,r){if(y(n))return r(n,1,1)?1:0;if(b(n)){for(var t=0,e=n.length;t<e;++t)if(r(n[t],t+1,1))return 1}else if(w(n))for(var t=0,i=G(n),u=$(n);t<i;++t)for(var o=0;o<u;++o)if(r(n[t][o],t+1,o+1))return 1;return 0}function lt(n,r,t){if(_(n)&&_(r))return n===r?1:0;if(dn(n)&&dn(r))return t?1:0;if(y(n)&&y(r))return Y(n,r)?1:0;if(k(n)&&k(r)){if(n.length!==r.length)return 0;for(var e=0,i=n.length;e<i;++e)if(!lt(n[e],r[e],t))return 0;return 1}return 0}function st(n,r,t){var e;r!==t&&(e=n[r],n[r]=n[t],n[t]=e)}function ht(n,r,t,e,i,u){var o,f=n[0].length;for(null==e&&(e=U),null==i&&(i=U),o=u||0;o<f;++o)n[r][o]=nn(tn(i,n[r][o]),tn(e,n[t][o]))}function mt(n,r,t,e,i,u,o){for(var f,c,a=n[0].length,l=0;l<a;++l)f=n[r][l],c=n[t][l],n[r][l]=nn(tn(e,f),tn(i,c)),n[t][l]=nn(tn(u,f),tn(o,c))}function gt(n,r,t,e,i,u,o){for(var f,c,a=n.length,l=0;l<a;++l)f=n[l][r],c=n[l][t],n[l][r]=nn(tn(e,f),tn(u,c)),n[l][t]=nn(tn(i,f),tn(o,c))}function pt(t,e,i,n,r){var u=G(t),o=$(t);return u&&o?k(e)&&k(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<o}),S(e.length,i.length,function(n,r){return t[e[n]][i[r]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=o),(n=null==n?u-1:n)<0&&(n+=u),(r=null==r?o-1:r)<0&&(r+=o),e=F.max(0,F.min(u-1,e)),n=F.max(0,F.min(u-1,n)),i=F.max(0,F.min(o-1,i)),r=F.max(0,F.min(o-1,r)),e<=n&&i<=r?S(n-e+1,r-i+1,function(n,r){return t[e+n][i+r]}):[]):[]}function dt(t,e,n){var i=G(t),u=$(t),o=G(e),f=$(e);return"vert"===(n=n||"horz")?S(i+o,F.max(u,f),function(n,r){return u<=r?n<i?Q:e[n-i][r]:f<=r?n<i?t[n][r]:Q:(n<i?t[n]:e[n-i])[r]}):S(F.max(i,o),u+f,function(n,r){return i<=n?r<u?Q:e[n][r-u]:o<=n?r<u?t[n][r]:Q:r<u?t[n][r]:e[n][r-u]})}function vt(r,n,t,e,i,u){var o,f,c,a,l=G(r),s=$(r);if(!1===t||l===s){for(e=D(e||0),o=F.min(l,s),a=$n(e,Q)?J(Qn(Kr(O(o,function(n){return un(r[n][n])})),o),e):Q,f=0;f<o;++f){if("lower"===n||"diagonal"===n)for(c=f+1;c<o;++c)if(!Jn(un(r[f][c]),a))return;if("upper"===n||"diagonal"===n)for(c=0;c<f;++c)if(!Jn(un(r[f][c]),a))return}if(s<l){for(f=o;f<l;++f)for(c=0;c<s;++c)if(!Jn(un(r[f][c]),a))return}else if(l<s)for(c=o;c<s;++c)for(f=0;f<l;++f)if(!Jn(un(r[f][c]),a))return;if(!0===i&&$n(e,Q)){if(u&&u._&&(r=u._=jn(r)),"upper"===n||"diagonal"===n)for(f=0;f<o;++f)for(c=0;c<f;++c)r[f][c]=Q;if("lower"===n||"diagonal"===n)for(f=0;f<o;++f)for(c=f+1;c<o;++c)r[f][c]=Q;if(s<l)for(f=o;f<l;++f)for(c=0;c<s;++c)r[f][c]=Q;else if(l<s)for(c=o;c<s;++c)for(f=0;f<l;++f)r[f][c]=Q}return 1}}function yt(n,r){var t,e,i;return Y(r,Q)?(t=U,e=Q):Y(n,Q)?(t=Q,Y(e=nr(er(r)),Q)&&(e=U)):(i=nr(n),t=en(n=un(n),n=dr(n,un(r))),e=en(tn(i,er(r)),n)),[t,e]}function bt(n,r,t,e,i,u,o){var f,c,a,l,s,h,m,g=i,p=2===r.length&&y(r[0])?(s=r[0],h=tr(r[1]),m=r[1],r[0]):2===r.length&&2===r[0].length?(s=r[0][0],h=r[0][1],m=r[1][0],r[1][1]):(s=r[t][t],h=r[t][e],m=r[e][t],r[e][e]);if("right"===n)for(f=G(i),null==o&&(o=f-1),c=u=null==u?0:u;c<=o;++c)a=i[c][t],l=i[c][e],g[c][t]=nn(tn(s,a),tn(m,l)),g[c][e]=nn(tn(h,a),tn(p,l));else for(f=$(i),null==o&&(o=f-1),c=u=null==u?0:u;c<=o;++c)a=i[t][c],l=i[e][c],g[t][c]=nn(tn(s,a),tn(h,l)),g[e][c]=nn(tn(m,a),tn(p,l));return g}function wt(t,e,i,n,u,r,o){var f,c,a;null==o&&(o=hn.eps),Cn(n=b(t)?(f=t[i],i===n?Q:on(Yr(c=t.slice(i+1,n+1),c))):u===r?(f=t[i][u],i===n?Q:on(Yr(c=t.slice(i+1,n+1).map(function(n){return n[u]}),c))):(f=t[i][u],u===r?Q:on(Yr(c=t[i].slice(u+1,r+1),c))),o)&&Cn(Un(un(Pr(f)),B),o)?(e.beta=on(f),e.tau=Q,e.v.forEach(function(n,r){e.v[r]=0===r?U:Q})):(c=W.sqrt(K(on(tn(f,er(f))),n)),Fn(on(f),Q)&&(c=tr(c)),a=rn(f,c),e.beta=c,e.tau=er(en(tr(a),c)),b(t)?e.v.forEach(function(n,r){e.v[r]=0===r?U:en(t[r+i],a)}):u===r?e.v.forEach(function(n,r){e.v[r]=0===r?U:en(t[r+i][u],a)}):e.v.forEach(function(n,r){e.v[r]=0===r?U:en(t[i][r+u],a)}))}function xt(n,r,e,i,t,u,o){var f,c,a,l,s=r.v,h=s.length,m=r.tau,g=e;if(!Y(m,Q))if("right"===n)for(f=G(e),null==i&&(i=0),null==t&&(t=$(e)-1),l=O((o=null==o?f-1:o)-(u=null==u?0:u)+1,function(n){for(var r=Q,t=0;t<h;++t)r=nn(r,tn(s[t],e[n+u][t+i]));return r}),a=u;a<=o;++a)for(c=i;c<=t;++c)g[a][c]=rn(e[a][c],tn(l[a-u],tn(m,er(s[c-i]))));else for(f=$(e),null==i&&(i=0),null==t&&(t=G(e)-1),l=O((o=null==o?f-1:o)-(u=null==u?0:u)+1,function(n){for(var r=Q,t=0;t<h;++t)r=nn(r,tn(er(s[t]),e[t+i][n+u]));return r}),a=u;a<=o;++a)for(c=i;c<=t;++c)g[c][a]=rn(e[c][a],tn(tn(m,s[c-i]),l[a-u]));return g}c.decimal=function(n){"function"==typeof n?(T=n,an.call(T.prototype,"_valueof")||(T.prototype._valueof=null,T.prototype.$valueOf=function(){return null==this._valueof&&(this._valueof=parseFloat(this.toFixed(9))),this._valueof},T.prototype.sign=function(){return T.sign(this)}),Q=T(0),U=T(1),M=T(-1),T(.5),B=T(2),P=T(10),o=T(F.log(10)),f=T(F.log(2)),X=T(F.SQRT2),z=T(F.SQRT1_2),hn.eps=T(cn),hn.pi=T(R),hn.e=T(i),hn.realmax=T(s),hn.realmin=T(h),hn.intmax=T(m),hn.intmin=T(g),hn.bitmax=T(d)):(T=null,Q=0,M=-(U=1),B=2,P=10,f=F.log(2),o=F.log(10),X=F.SQRT2,z=F.SQRT1_2,hn.eps=cn,hn.pi=R,hn.e=i,hn.realmax=s,hn.realmin=h,hn.intmax=m,hn.intmin=g,hn.bitmax=d),A&&(j=new A(Q,U),t=new A(hn.e,Q)),L.forEach(function(n){n()})},c.is_array=k,c.is_obj=pn,c.is_string=_,c.is_nan=dn,c.is_inf=vn,c.is_number=yn,c.is_decimal=bn,c.is_int=p,c.is_complex=u,c.is_real=wn,c.is_scalar=y,c.is_vector=b,c.is_matrix=w,c.array=O,c.matrix=S,c.ndarray=An,V.rowvec=_n,V.colvec=qn,c.sca=En,c.vec=q,c.tonumber=In,c.todecimal=Nn,c.copy=jn,c.apply=Tn,c.apply2=Rn,c.exist=function(n,r){return pn(r)&&_(n)&&an.call(r,n)?1:0},c.varargout=Mn,c.num2str=Pn,c.MAXPRINTSIZE=fn,c.tex=function(n){return k(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(Xn).join("\\]\n\\[")+"\\]":k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?"\\["+n.map(Xn).join("\\]\n\\[")+"\\]":"\\["+Xn(n)+"\\]":"\\["+(n=n.length>c.MAXPRINTSIZE?n.slice(0,F.round(c.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-F.round(c.MAXPRINTSIZE/2))):n).map(Xn).join("\\]\n\\[")+"\\]":"":(n=Xn(n)).length&&(n="\\["+n+"\\]"),n},c.str=function(n){return n=k(n)?n.length?n.$scilitevarargout$?n.map(zn).join("\n\n"):k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?n.map(zn).join("\n\n"):zn(n):(n=n.length>c.MAXPRINTSIZE?n.slice(0,F.round(c.MAXPRINTSIZE/2)).concat(":").concat(n.slice(1-F.round(c.MAXPRINTSIZE/2))):n).map(zn).join("\n"):"":zn(n)},c.neq=H,c.nlt=On,c.ngt=$n,c.nle=Cn,c.nge=Fn,c.nadd=K,c.nsub=Wn,c.nmul=J,c.ndiv=Qn,c.npow=Un,c.nmod=Bn,c.nneg=Vn,c.ninv=Gn,c.eq=Y,c.ne=Dn,c.lt=Hn,c.gt=Kn,c.le=Jn,c.ge=Yn,c.ssign=nr,c.sadd=nn,c.ssub=rn,c.smul=tn,c.sdiv=en,c.spow=rr,c.sneg=tr,c.sconj=er,c.sinv=ir,c.sabs=un,c.sangle=ur,c.add=or,c.sub=fr,c.dotmul=cr,V.times=cr,c.dotdiv=ar,c.dotpow=lr,V.power=lr,c.mult=sr,c.mul=N,c.pow=hr,V.mpower=hr,c.neg=mr,c.get=gr,c.set=pr,c.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],Mr.prototype={constructor:Mr,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,option:function(n,r,t,e){var i,u,o,f={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},c={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},a={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},l=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:a[l[(e||0)%l.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=a[l[(e||0)%l.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=f["-"]),n._LineStyle||(n._LineStyle="-"),t=t||0;t<r.length;){if("Color"===r[t])_(i=r[t+1])?an.call(c,i)?n.Color=a[c[i]]:an.call(a,i)&&(n.Color=a[i]):b(i)&&3===i.length&&(n.Color=In(i));else if("LineWidth"===r[t])Z(i=r[t+1])&&(n.LineWidth=2*In(i));else{if("LineStyle"!==r[t]){if(_(r[t])){for(u in o=!1,i=r[t],a)-1<i.indexOf(u)&&(n.Color=a[u],o=!0);for(u in f)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=f[u],o=!0);if(o){t+=1;continue}}break}_(i=r[t+1])&&an.call(f,i)&&(n._LineStyle=i,n.LineStyle=f[i])}t+=2}return t},parse:function(n,r,t){var e,i,u,o,f,c,a,l=this,s=0,h=0;if("pie"===r)for(;s<n.length;)b(u=q(n[s]))&&l.data.push({y:In(u)}),s+=1;else if("plot3"===r)for(;s<n.length;)c=f=o=null,b(u=q(n[s]))&&(o=u),b(u=q(n[s+1]))&&(f=u),b(u=q(n[s+2]))&&(c=u,s+=3),o&&f&&c?(s=l.option(a={},n,s,h),l.data.push({x:In(o),y:In(f),z:In(c),style:a}),++h):s+=1;else for(;s<n.length;)if(f=o=null,b(u=q(n[s]))&&(o=u),b(n[s+1])||w(n[s+1])?(f=q(n[s+1]),s+=2):o&&(o=$r(1,(f=o).length),s+=1),o&&f)if(o=In(o),s=l.option(a={},n,s,h),w(f))for(e=0,i=$(f);e<i;++e)l.data.push({x:o,y:In(E(f,e)),style:a}),a=l.option(a,n,s,++h);else l.data.push({x:o,y:In(f),style:a}),++h;else s+=1;return l}},c.figure=Mr,c.createCanvas=function(n,r){},c.currentCanvas=function(){},V.clc=r,V.disp=r,V.clear=r,V.help=r,V.who=r,V.whos=r,V.exist=r,["floor","ceil","round","sign","abs","exp","log","log10","log2","sqrt","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){W[r]="log"===r?function(n){return yn(n)?F.log(n):n.ln()}:"log10"===r?function(n){return yn(n)?F.log10(n):n.log(P)}:"log2"===r?function(n){return yn(n)?F.log2(n):n.log(B)}:function(n){return yn(n)?F[r](n):n[r]()}}),W.atan2=function(n,r){return H(Q,r)&&H(Q,n)?Q:(yn(n)&&yn(r)?F:T).atan2(n,r)},W.fix=function(n){return On(n,Q)?W.ceil(n):W.floor(n)},c.realMath=W,(A=function n(r,t,e){var i=this;if(!mn(i,n))return new n(r,t,e);u(r)?(i.re=r.re,i.im=r.im):(t=t||Q,"polar"===e?(i._rho=W.abs(r),i.re=J(i._rho,W.cos(t)),i.im=J(i._rho,W.sin(t))):(i.re=r,i.im=t))}).prototype={constructor:A,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var r=this;return null==r._rho&&(r._rho=dr(r.re,r.im)),r._rho},norm2:function(){return null==this._rho2&&(this._rho2=Un(this.abs(),B)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=W.atan2(n.im,n.re)),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=H(n.im,Q)?W.sign(n.re):n.div(n.abs()),u(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return Z(n)?new A(K(this.re,n),this.im):new A(K(this.re,n.re),K(this.im,n.im))},sub:function(n){return Z(n)?new A(Wn(this.re,n),this.im):new A(Wn(this.re,n.re),Wn(this.im,n.im))},mul:function(n){var r,t,e,i=this;return Z(n)?new A(H(i.re,Q)?Q:J(i.re,n),H(i.im,Q)?Q:J(i.im,n)):(r=i.re,e=n.re,i=i.im,t=J(r,K(e,n=n.im)),n=J(n,K(r,i)),e=J(e,Wn(i,r)),new A(Wn(t,n),K(t,e)))},div:function(n){var r,t,e,i=this;return Z(n)?new A(H(i.re,Q)?Q:Qn(i.re,n),H(i.im,Q)?Q:Qn(i.im,n)):(t=n.norm2(),r=i.re,e=Qn(n.re,t),i=i.im,t=J(r,K(e,n=Vn(Qn(n.im,t)))),n=J(n,K(r,i)),e=J(e,Wn(i,r)),new A(Wn(t,n),K(t,e)))},pow:function(n){var r,t;return dn(n)?l:Z(n)?new A(Un(this.abs(),n),J(this.angle(),n),"polar"):u(n)?(r=this.abs(),t=this.angle(),new A(Un(r,n.re),J(n.im,W.log(r)),"polar").mul(new A(W.exp(Vn(J(n.im,t))),J(t,n.re),"polar"))):void 0},neg:function(){return new A(Vn(this.re),Vn(this.im))},conj:function(){return new A(this.re,Vn(this.im))},inv:function(){var n=this.norm2();return new A(Qn(this.re,n),Vn(Qn(this.im,n)))},toString:function(){var n=this;return null==n._str&&(n._str=Pn(n.re)+(On(n.im,Q)?" - ":" + ")+Pn(W.abs(n.im))+"i"),n._str},valueOf:function(){return I(this.re)}},j=new A(Q,U),t=new A(hn.e,Q),e={floor:function(n){return new A(W.floor(n.re),W.floor(n.im))},ceil:function(n){return new A(W.ceil(n.re),W.ceil(n.im))},round:function(n){return new A(W.round(n.re),W.round(n.im))},fix:function(n){return new A(W.fix(n.re),W.fix(n.im))},sign:function(n){return n.sign()},sqrt:function(n){return new A(W.sqrt(n.abs()),Qn(n.angle(),B),"polar")},exp:function(n){return t.pow(n)},log:function(n){return new A(W.log(n.abs()),n.angle())},log10:function(n){return e.log(n).div(o)},log2:function(n){return e.log(n).div(f)},sin:function(n){return new A(J(W.sin(n.re),W.cosh(n.im)),J(W.cos(n.re),W.sinh(n.im)))},cos:function(n){return new A(J(W.cos(n.re),W.cosh(n.im)),Vn(J(W.sin(n.re),W.sinh(n.im))))},tan:function(n){return e.sin(n).div(e.cos(n))},sinh:function(n){return new A(J(W.sinh(n.re),W.cos(n.im)),J(W.cosh(n.re),W.sin(n.im)))},cosh:function(n){return new A(J(W.cosh(n.re),W.cos(n.im)),J(W.sinh(n.re),W.sin(n.im)))},tanh:function(n){return e.sinh(n).div(e.cosh(n))},asin:function(n){return j.neg().mul(e.log(j.mul(n).add(e.sqrt(A(U,Q).sub(n.pow(B))))))},acos:function(n){return j.neg().mul(e.log(n.add(j.mul(e.sqrt(A(U,Q).sub(n.pow(B)))))))},atan:function(n){return j.div(B).mul(e.log(j.add(n).div(j.sub(n))))},asinh:function(n){return e.log(n.add(e.sqrt(n.pow(B).add(U))))},acosh:function(n){return e.log(n.add(e.sqrt(n.pow(B).sub(U))))},atanh:function(n){return e.log(n.add(U).div(n.neg().add(U))).div(B)}},c.complexMath=e,V.complex=A,["floor","ceil","round","fix","sign","exp","log","log10","log2","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){V[r]=e[r]?function(n){return Tn(function(n){return(u(n)?e:W)[r](n)},n,!0)}:function(n){return Tn(function(n){return W[r](n)},n,!1)}}),V.atan2=function(n,r){return Rn(function(n,r){return W.atan2(n,r)},n,r,!1)},V.sqrt=function(n){return Tn(function(n){return u(n)?e.sqrt(n):$n(Q,n)?new A(Q,W.sqrt(Vn(n))):W.sqrt(n)},n,!0)},["sqrt","pow","log"].forEach(function(r){V["real"+r]=function(n){return Tn(function(n){u(n=Ln(n))&&v("real"+r);n=W[r](n);return dn(n)||!wn(n)?v("real"+r):n},n,!0)}}),V.real=on,V.imag=Pr,V.conj=Xr,V.abs=zr,V.angle=function(n){return Tn(ur,n,!0)},V.norm=Lr,V.zeros=function(n,r){return Zr(V.fix(n),y(r)?V.fix(r):r)},V.ones=function(n,r){return n=V.fix(n),r=y(r)?V.fix(r):r,b(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),U)},V.eye=function(n){return Or(V.fix(n),U)},V.rand=function(n,r){return n=V.fix(n),r=y(r)?V.fix(r):r,null==n?D(F.random()):(b(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),function(){return D(F.random())}))},V.randi=function(n,r,t){return e=V.fix(n),n=V.fix(r),r=y(t)?V.fix(t):t,e=I(e),null==n&&null==r?D(F.ceil(F.random()*e)):(b(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),function(){return D(F.ceil(F.random()*e))}));var e},V.randn=function(n,r){return n=V.fix(n),r=y(r)?V.fix(r):r,null==n?D(vr()):(b(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),function(){return D(vr())}))},V.magic=function(n){var t;return n=p(n=En(V.fix(n),!0))?I(n):null,!p(n)||n<=2?1===n?[[U]]:[]:(t=function n(e){var t,i,r,u,o,f,c,a=1&e,l=0==(3&e),s=e*e,h=e-a>>1;if(a)return S(e,e,function(n,r){var t=(n+1+r+1+(e-3)/2)%e;return t<0&&(t+=e),(n=(n+1+2*(r+1)-2)%e)<0&&(n+=e),e*t+n+1});if(l)return i=0,S(e,e,function(n,r){return++i,(n+1&3)>>1==(r+1&3)>>1?s-(i-1):i});if(t=h*h,f=n(h),c=S(e,e,function(n,r){return n<h?r<h?f[n][r]:f[n][r-h]+2*t:r<h?n<h?f[n][r]:f[n-h][r]+3*t:f[n-h][r-h]+t}),1<(i=(h-1)/2))for(r=1;r<=h;++r){for(u=2;u<=i;++u)o=c[r-1][u-1],c[r-1][u-1]=c[r+h-1][u-1],c[r+h-1][u-1]=o;for(u=e-i+2;u<=e;++u)o=c[r-1][u-1],c[r-1][u-1]=c[r+h-1][u-1],c[r+h-1][u-1]=o}for(r=1;r<=i;++r)o=c[r-1][0],c[r-1][0]=c[r+h-1][0],c[r+h-1][0]=o;for(r=i+2;r<=h;++r)o=c[r-1][0],c[r-1][0]=c[r+h-1][0],c[r+h-1][0]=o;return o=c[i][i-1],c[i][i-1]=c[i+h][i-1],c[i+h][i-1]=o,c}(n),S(n,n,function(n,r){return D(t[n][r])}))},V.pascal=function(n){var t,r;return 1<arguments.length&&v("pascal"),n=p(n=V.fix(En(n,!0)))?I(n):null,!p(n)||n<=0?[]:(t=S(r=n,r,function(n,r,t){return 0===n||0===r?1:t[n-1][r]+t[n][r-1]}),S(n,n,function(n,r){return D(t[n][r])}))},V.rosser=function(){return[[D(611),D(196),D(-192),D(407),D(-8),D(-52),D(-49),D(29)],[D(196),D(899),D(113),D(-192),D(-71),D(-43),D(-8),D(-44)],[D(-192),D(113),D(899),D(196),D(61),D(49),D(8),D(52)],[D(407),D(-192),D(196),D(611),D(8),D(44),D(59),D(-23)],[D(-8),D(-71),D(61),D(8),D(411),D(-599),D(208),D(208)],[D(-52),D(-43),D(49),D(44),D(-599),D(411),D(208),D(208)],[D(-49),D(-8),D(8),D(59),D(208),D(208),D(99),D(-911)],[D(29),D(-44),D(52),D(-23),D(208),D(208),D(-911),D(99)]]},V.vander=function(n){return b(n=q(n))||v("vander"),n.map(function(t){return O(n.length,function(n,r){return 0===n?U:tn(r[n-1],t)}).reverse()})},V.toeplitz=function(t,e){return 1===arguments.length?S((e=q(t)).length,e.length,function(n,r){return n===r?e[0]:n<r?e[F.abs(n-r)]:er(e[F.abs(n-r)])}):(t=q(t),e=q(e),S(t.length,e.length,function(n,r){return n===r?t[0]:(n<r?e:t)[F.abs(n-r)]}))},V.hankel=function(t,e){var i,n;return 1===arguments.length?(t=q(t),S(i=t.length,i,function(n,r){return i-1-n<r?Q:t[(n+r)%i]})):(t=q(t),e=q(e),i=t.length,S(n=e.length,n,function(n,r){return i<=n+r-1?e[n+r-i]:t[(n+r)%i]}))},V.hadamard=function(n){return function n(r){return 1===r?[[U]]:2===r?[[U,U],[U,M]]:4===r?[[U,U,U,U],[U,M,U,M],[U,U,M,M],[U,M,M,U]]:0==r%4&&(r=n(r/2)).length?nt([[U,U],[U,M]],r):[]}(I(n))},V.hilb=function(n){return S(n=I(En(n,!0)),n,function(n,r){return D(1/(n+1+r+1-1))})},V.invhilb=function(n){n=I(En(n,!0));var r=V.hilb(n);return(n<10?_t:qt)(r)},V.linspace=function(n,r,t){t=I(t=null==t?100:t);for(var e=Qn(Wn(r,n),t-1),i=new Array(t),u=0,o=n;u<t;++u,o=K(o,e))i[u]=o;return i},V.logspace=function(n,r,t){t=I(t=null==t?100:t);for(var e=Un(Qn(r,n),1/(t-1)),i=new Array(t),u=0,o=n;u<t;++u,o=tn(o,e))i[u]=o;return i},V.meshgrid=Mn(function(n,r,t){var e=r,i=t;if(null==i&&(i=e),e=q(e),i=q(i),b(e)&&b(i))return[S(i.length,e.length,function(n,r){return e[r]}),S(i.length,e.length,function(n,r){return i[n]})];v("meshgrid")},2),V.ndgrid=Mn(function(n){var r=n,t=[].slice.call(arguments,1);t=t.map(q);for(var e=[],i=O(r,function(n){return(1===t.length?t[0]:t[n]).length}),u=0;u<r;++u)e.push(An(i,function(n){return(1===t.length?t[0]:t[u])[n[u]]}));return 1===r?e[0]:e}),V.colon=function(n,r,t){return 1===arguments.length&&k(n)?qn($r(n)):$r.apply(null,arguments)},V.cat=function(n,r,t){var e,i=[];if(1===(n=I(n)))for(i=r,e=2;e<arguments.length;++e)i=Cr("vert",i,arguments[e]);else if(2===n)for(i=r,e=2;e<arguments.length;++e)i=Cr("horz",i,arguments[e]);return i},V.horzcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Cr("horz",t,arguments[e]);return t},V.vertcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Cr("vert",t,arguments[e]);return t},V.transpose=function(n){return Fr(n=kn(n)?_n(n):n)},V.ctranspose=function(n){return Wr(n=kn(n)?_n(n):n)},V.diag=Qr,V.blkdiag=function(){return t=[].slice.call(arguments),l=a=c=f=o=0,t.forEach(function(n,r){xn(n)&&(t[r]=n=[[n]]),kn(n)&&(t[r]=n=Qr(n)),Sn(n)||v("blkdiag"),o+=G(n),f+=$(n)}),e=t[c],i=G(e),u=$(e),S(o,f,function(n,r){return a+i<=n&&(a+=i,l+=u,e=t[++c],i=G(e),u=$(e)),r<l||l+u<=r?Q:e[n-a][r-l]});var t,e,i,u,o,f,c,a,l},V.tril=function(t,e){if(Sn(t))return e=I(e||0),S(G(t),$(t),function(n,r){return r<=n+e?t[n][r]:Q});v("tril")},V.triu=function(t,e){if(Sn(t))return e=I(e||0),S(G(t),$(t),function(n,r){return n+e<=r?t[n][r]:Q});v("triu")},V.repmat=function(t,e,i){return b(e)&&(i=e[1],e=e[0]),null==i&&(i=e),e=I(e),i=I(i),Sn(t=kn(t=xn(t)?[[t]]:t)?[t]:t)?S(e*G(t),i*$(t),function(n,r){return t[n%e][r%i]}):t},V.repelem=function(r,t){var e,i;if(b(r))if(b(t)){if(t.length===r.length)return e=0,i=-1,O(I(Kr(t)),function(n){return n===e&&(e+=I(t[++i])),r[i]})}else if(p(t))return t=I(t),i=-1,O(t*r.length,function(n){return 0==n%t&&++i,r[i]});return r},V.reshape=function(t,e,n){b(e)&&(n=e[1],e=e[0]),e=I(e),n=I(n);var i,r=e*n;return xn(t)&&1===e&&1===n?[[t]]:kn(t)&&t.length===r?S(e,n,function(n,r){return t[n+e*r]}):Sn(t)&&G(t)*$(t)==r?(i=G(t),S(e,n,function(n,r){n+=e*r;return t[n%i][F.floor(n/i)]})):t},V.squeeze=function(n){return n},V.rot90=function(n,r){var t=n=kn(n)?_n(n):n,n=r;if(Sn(t)){var e=G(t),i=$(t);if((n=F.round(I(n=null==n?1:n))%4)<0&&(n+=4),1===n)return S(i,e,function(n,r){return t[r][i-1-n]});if(3===n)return S(i,e,function(n,r){return t[e-1-r][n]});if(2===n)return S(e,i,function(n,r){return t[e-1-n][i-1-r]})}return t},V.flip=Ur,V.fliplr=function(n){return Ur(n,2)},V.flipud=function(n){return Ur(n,1)},V.sort=Mn(function(n,r,t,e){for(var i=2,u=null;i<arguments.length;){if("ComparisonMethod"===arguments[i]){"real"===arguments[i+1]?u=Br:"abs"===arguments[i+1]&&(u=Vr),1===i?(t=1,e="ascend"):2===i&&(e="ascend");break}i+=1}return null==e&&(e="ascend"),Gr(r,t=I(t=null==t?1:t),e,u,1<n)}),V.min=Dr,V.max=Hr,V.sum=Kr,V.prod=Jr,V.dot=Yr,V.cross=function(n,r){if(n=q(n),r=q(r),!b(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(b(r)&&3===r.length)return[rn(tn(n[1],r[2]),tn(n[2],r[1])),rn(tn(n[2],r[0]),tn(n[0],r[2])),rn(tn(n[0],r[1]),tn(n[1],r[0]))];throw"cross: input 2 not vector of length 3"},V.kron=nt,V.diff=function(n,r,t){for(null==t&&(t=1),p(r=null==r?1:r)||v("diff"),r=I(r);0<r--;)n=function r(t,n){if(b(t=q(t)))return 1<t.length?O(t.length-1,function(n){return rn(t[n+1],t[n])}):[];if(w(t)){if(1===(n=I(n=null==n?1:n)))return O($(t),function(n){return r(E(t,n))});if(2===n)return O(G(t),function(n){return r(t[n])})}v("diff")}(n,t);return n},V.trapz=function(n,r,t){return arguments.length<3&&(k(r)?t=1:k(n)&&!k(r)&&(t=r,r=n,n=null)),rt(k(n)?q(n):n,q(r),t)},V.cumtrapz=function(n,r,t){return arguments.length<3&&(k(r)?t=1:k(n)&&!k(r)&&(t=r,r=n,n=null)),function r(t,e,i){if(y(e))return e;if(b(e)){if(null==t||y(t))return e.map(function(n,r){return rt(t,e.slice(0,r+1))});if(b(t)&&t.length===e.length)return e.map(function(n,r){return rt(t.slice(0,r+1),e.slice(0,r+1))})}else if(w(e))if(1===(i=I(i=null==i?1:i))){if(null==t||y(t)||b(t)&&t.length===G(e))return O($(e),function(n){return r(t,E(e,n),i)});if(w(t)&&G(t)===G(e)&&$(t)===$(e))return O($(e),function(n){return r(E(t,n),E(e,n),i)})}else if(2===i){if(null==t||y(t)||b(t)&&t.length===$(e))return O(G(e),function(n){return r(t,e[n],i)});if(w(t)&&G(t)===G(e)&&$(t)===$(e))return O(G(e),function(n){return r(t[n],e[n],i)})}v("cumtrapz")}(k(n)?q(n):n,q(r),t)},V.cumsum=function(n,r,t){n=tt(q(n),nn,t,r);return!1===n&&v("cumsum"),n},V.cumprod=function(n,r,t){n=tt(q(n),tn,t,r);return!1===n&&v("cumprod"),n},V.cummin=function(n,r,t){n=tt(q(n),function(n,r){return Hn(n,r)?n:r},t,r);return!1===n&&v("cummin"),n},V.cummax=function(n,r,t){n=tt(q(n),function(n,r){return Kn(n,r)?n:r},t,r);return!1===n&&v("cummax"),n},V.movsum=function(n,r,t){var e,i;return b(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Kr,e,i,t))&&v("movsum"),r},V.movprod=function(n,r,t){var e,i;return b(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Jr,e,i,t))&&v("movprod"),r},V.movmean=function(n,r,t){var e,i;return b(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Yt,e,i,t))&&v("movmean"),r},V.movmin=function(n,r,t){var e,i;return b(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Dr,e,i,t))&&v("movmin"),r},V.movmax=function(n,r,t){var e,i;return b(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Hr,e,i,t))&&v("movmax"),r},V.bitshift=function(n,r){return Tn(function(n){return p(n)?On(r,Q)?I(n)>>-I(r):I(n)<<I(r):n},n,!0)},V.bitand=it,V.bitor=ut,V.bitxor=function t(r,e){if(p(r)){if(p(e))return I(r)^I(e);if(k(e))return e.map(function(n){return t(r,n)})}else if(k(r)){if(p(e))return r.map(function(n){return t(n,e)});if(k(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},V.size=function(n){return Mn(ot.apply(null,[].slice.call(arguments)))},V.length=function(n){return k(n)?n.length?F.max.apply(null,ot(n)):0:null==n?0:1},V.ndims=function(n){return 2+ot(n).slice(2).filter(function(n){return 1<n}).length},V.numel=function(n){return Jr(ot(n))},V.rows=function(n){return ot(n,1)},V.columns=function(n){return ot(n,2)},V.sub2ind=function(n,r,t){return b(r)&&(t=r[1],r=r[0]),r=I(r),t=I(t),1===n.length?r:r-1+I(n[0])*(t-1)+1},V.ind2sub=function(n,r){return r=I(r),1===n.length?[r,1]:[(r-1)%I(n[0])+1,F.floor((r-1)/I(n[0]))+1]},c.find=ft,V.find=function(n){return ft(n,function(n){return!Y(n,Q)})},c.all=ct,V.all=function(n){return ct(n,function(n){return!Y(n,Q)})},c.any=at,V.any=function(n){return at(n,function(n){return!Y(n,Q)})},V.isequal=function(){var n=arguments.length,r=0,t=1;for(1<n&&(t=lt(arguments[0],arguments[1],!1),r=2);t&&r<n;)t=lt(arguments[0],arguments[r++],!1);return t},V.isequaln=function(){var n=arguments.length,r=0,t=1;for(1<n&&(t=lt(arguments[0],arguments[1],!0),r=2);t&&r<n;)t=lt(arguments[0],arguments[r++],!0);return t},V.isnan=function n(r){return k(r)?r.map(n):dn(r)||u(r)&&(dn(r.re)||dn(r.im))?1:0},V.isinf=function n(r){return k(r)?r.map(n):Z(r)?vn(r)?1:0:u(r)&&(vn(r.re)||vn(r.im))?1:0},V.isfinite=function n(r){return k(r)?r.map(n):Z(r)?vn(r)?0:1:!u(r)||vn(r.re)||vn(r.im)?0:1},V.isreal=function(n){return ct(n,wn)},V.isempty=function(n){return k(n)?k(n[0])?n[0].length?0:1:n.length?0:1:0};var kt=function(r,n,t,e){var i,u,o,f,c,a,l,s,h,m,g,p,d,v,y=G(r),b=$(r),w=b,x=0;if(e=D(e||0),vt(r,"upper",!1,e))return n?[r,O(w,function(n){return[n,n]}).filter(function(n){return n[0]<y&&n[1]<b&&!Jn(un(r[n[0]][n[1]]),e)}),Jr(Qr(r)),Or(y)]:r;for(k(t)&&(w=F.min(w,t[1])),d=dt(r,Or(y)),i=new Array(w),u=U,v=function(n,r){r=r||0;for(var t=x-1;0<=t;--t)if(n===i[t][r])return t;return-1},o=l=0;o<y&&!(w<=l);++o){for(f=o;Jn(un(d[f][l]),e);)if(y<=++f&&(f=o,w<=++l)){l=-1;break}if(-1===l)break;for(s=-1,m=null,p=0,f=c=f;f<y;++f)Jn(g=un(d[f][l]),e)?++p:null!=m&&!Hn(g,m)||(m=g,s=f);for(;-1!==s;){if(y-c===p+1){for(o!==s&&(st(d,o,s),u=tr(u)),Hn(d[o][l],Q)&&(ht(d,o,o,Q,M,l),u=tr(u)),f=s,c=o;0<=f&&-1!==(a=v(f));)f=c-=x-a;i[x++]=[f,l],u=o<w?tn(u,d[o][o]):Q;break}for(p=0,h=s,f=c;f<y;++f)f!==h&&(ht(d,f,h,tr(en(d[f][l],d[h][l])),U,l),Jn(g=un(d[f][l]),e)?++p:Hn(g,m)&&(m=g,s=f))}++l}return x<w&&(u=Q),t=pt(d,0,b,y-1,y+b-1),d=pt(d,0,0,y-1,b-1),i.length>x&&(i.length=x),n?[d,i,u,t]:d};function St(n,r,t,e){var i,u,o,f,c,a,l=G(n),s=$(n),h=s;for(e=D(e||0),k(t)&&F.min(h,t[1]),a=dt((h=kt(n,!0,t,e))[0],h[3]),i=h[1],n=h[2],u=i.length,f=0;f<u;++f)for(o=i[f][1],c=0;c<f;++c)Jn(un(a[c][o]),e)||(ht(a,c,f,tr(a[c][o]),a[f][o]),Y(a[c][i[c][1]],U))||ht(a,c,c,Q,ir(a[c][i[c][1]]),i[c][1]);return Y(a[u-1][i[u-1][1]],U)||ht(a,u-1,u-1,Q,ir(a[u-1][i[u-1][1]]),i[u-1][1]),t=pt(a,0,s,l-1,l+s-1),a=pt(a,0,0,l-1,s-1),r?[a,i,n,t]:a}function At(n,r,t){if(y(n)&&y(r))return en(r,n);if(!w(n))return[];if(!b(r=q(r))&&!w(r))return[];var e,i=$(n);if(G(n)!==i)return[];if(e=b(r)?(h=r.length,1):(h=G(r),$(r)),i!==h)return[];var u,o,f,c,a,l,s,h=kt(Fr(n),!0);if(h[1].length!==i)return[];if(u=Fr(h[3]),o=Fr(h[0]),b(r)){for(f=O(i,Q),c=0;c<i;++c){if(Y(o[c][c],Q))return[];for(s=Q,a=0;a<c;++a)s=nn(s,tn(o[c][a],f[a]));f[c]=en(rn(r[c],s),o[c][c])}return O(i,function(r){return O(i,function(n){return tn(f[n],u[r][n])}).reduce(nn,Q)})}for(f=Zr(i,e),c=0;c<i;++c){if(Y(o[c][c],Q))return[];for(l=0;l<e;++l){for(s=Q,a=0;a<c;++a)s=nn(s,tn(o[c][a],f[a][l]));f[c][l]=en(rn(r[c][l],s),o[c][c])}}return S(i,e,function(r,t){return O(i,function(n){return tn(f[n][t],u[r][n])}).reduce(nn,Q)})}function _t(n){var r,t,e;return y(n)?ir(n):w(n)&&G(n)===$(n)?1===(t=r=G(n))?[[ir(n[0][0])]]:Y((e=St(n,!0))[0][r-1][t-1],Q)?[]:e[3].map(function(n,r){return n.map(function(n){return en(n,e[0][r][r])})}):[]}function qt(n){if(G(n)!==$(n))return[];for(var r=Or(G(n)),t=r,e=fr(r,n),i=0;i<4;++i)t=N(t,or(r,e)),i+1<4&&(e=N(e,e));return t}function Et(n,r){var t,e,i=G(n),u=$(n);return r=r||St(n,!0),e=(t=r[1]).length,[pt(n,O(i,function(n){return n}),O(e,function(n){return t[n][1]})),pt(r[0],0,0,e-1,u-1).map(function(t,e){return t.map(function(n,r){for(r=e;r+1<u&&Y(t[r],Q);)++r;return en(n,t[r])})})]}function It(t,n){var r,e,i,u,o;return y(t)?ir(t):w(t)?(r=G(t),i=$(t),function t(n,e){return y(e)?y(n)?Y(n,e):n.filter(function(n){return t(n,e)}).length===n.length:!!k(e)&&(y(n)?t(e,n):n.length===e.length&&n.filter(function(n,r){return t(n,e[r])}).length===e.length)}(t,0)?Fr(t):1===r&&1===i?[[ir(t[0][0])]]:1===r||1===i?(o=t.reduce(function(n,r){return nn(n,tn(r,er(r)))},Q),S(i,r,function(n,r){return en(er(t[r][n]),o)})):(n=(e=St(t,!0,null,n||0))[1].length)===i?r===i?e[3].map(function(n,r){return n.map(function(n){return en(n,e[0][r][r])})}):N(_t(N(u=Wr(t),t)),u):n===r?N(u=Wr(t),_t(N(t,u))):(i=Et(t,e),o=N(_t(N(u=Wr(o=i[0]),o)),u),n=N(u=Wr(n=i[1]),_t(N(n,u))),N(n,o))):[]}function Nt(e){return y(e)?e:w(e)?e.reduce(function(n,r,t){return nn(n,t<r.length?e[t][t]:0)},0):void v("trace")}function jt(e,n,r){r=D(r||0);var t=G(e);return t!==$(e)?Q:1===t?e[0][0]:vt(e,"lower",!0,r)||vt(e,"upper",!0,r)?e.reduce(function(n,r,t){return tn(n,e[t][t])},U):!0===n?function n(r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d;function v(t,n,e,i){return S(n-1,n-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})}if(1===t)f=r[0][0];else if(2===t)c=r[0][0],a=r[0][1],l=r[1][0],f=rn(tn(c,s=r[1][1]),tn(a,l));else if(3===t)c=r[0][0],a=r[0][1],l=r[0][2],s=r[1][0],h=r[1][1],m=r[1][2],g=r[2][0],p=r[2][1],d=r[2][2],f=rn(rn(rn(nn(nn(tn(tn(c,h),d),tn(tn(a,m),g)),tn(tn(l,s),p)),tn(tn(l,h),g)),tn(tn(a,s),d)),tn(tn(c,m),p));else{for(e=u=i=0;e<t;++e)Y(r[0][e],Q)&&++i,Y(r[e][0],Q)&&++u;if(o=U,f=Q,i<u)for(e=0;e<t;++e)Y(r[e][0],Q)||(f=nn(f,tn(r[e][0],tn(o,n(v(r,t,e,0),t-1))))),o=U===o?M:U;else for(e=0;e<t;++e)Y(r[0][e],Q)||(f=nn(f,tn(r[0][e],tn(o,n(v(r,t,0,e),t-1))))),o=U===o?M:U}return f}(e,t):kt(e,!0,null,r)[2]}function Tt(o){return S($(o),G(o),function(n,r){return e=r,i=n,r=!0,n=G(t=o),u=$(t),n!==u?null:n<=1?0:(i=+(i||0),(e=+(e||0))<0||n<=e||i<0||u<=i?null:(n=jt(S(n-1,u-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})),!0===r&&e+i&1?tr(n):n));var t,e,i,u})}function Rt(n,r,t){null==r&&(r=B);for(var e,i,u,o,f,c,a,l=G(n),s=l-1,h=Nn(n),m=t?O(l,U):null,g=new Array(s),p=new Array(s),d=D(1e-10),v=1;v<=100;++v){for(e=a=0;e<l;++e){for(i=0;i<s;++i)g[i]=h[u=e<=i?i+1:i][e],p[i]=h[e][u];if(f=Lr(g,r),H(c=Lr(p,r),Q)||H(f,Q))++a;else{for(o=W.sqrt(Qn(c,f)),Cn(W.abs(Wn(o,U)),d)&&++a,t&&(m[e]=J(o,m[e])),i=0;i<l;++i)h[i][e]=tn(h[i][e],o);for(i=0;i<l;++i)h[e][i]=en(h[e][i],o)}}if(l===a)break}return t?[m,h]:h}function Mt(n,r,t,e){var i=G(n);if(e=D(e||0),null==r){var u,o,f=t?Or(i):null,c=jn(n);for(a=1;a<=i-2;++a)for(l=i;a+2<=l;--l)Cn(un(c[l-1][a-1]),J(un(c[l-1-1][a-1]),e))||(o=[er((u=yt(c[l-1-1][a-1],c[l-1][a-1]))[0]),tr(er(u[1]))],t&&(f=bt("right",u,l-1-1,l-1,f)),c=bt("left",o,l-1-1,l-1,bt("right",u,l-1-1,l-1,c))),c[l-1][a-1]=Q;return t?[f,c]:c}var a,l,s,h,m=Wr(f=Xt(r,!0,!1,e)[0]),g=Or(i),p=N(m,n),d=N(m,r);for(a=1;a<=i-2;++a)for(l=i;a+2<=l;--l)Cn(un(p[l-1][a-1]),J(un(p[l-1-1][a-1]),e))||(s=[er((h=yt(p[l-1-1][a-1],p[l-1][a-1]))[0]),tr(er(h[1]))],t&&(f=bt("right",h,l-1-1,l-1,f)),p=bt("left",s,l-1-1,l-1,p),d=bt("left",s,l-1-1,l-1,d)),p[l-1][a-1]=Q,Cn(un(d[l-1][l-1-1]),J(un(d[l-1][l-1]),e))||(h=yt(tr(d[l-1][l-1]),d[l-1][l-1-1]),t&&(g=bt("right",h,l-1-1,l-1,g)),p=bt("right",h,l-1-1,l-1,p),d=bt("right",h,l-1-1,l-1,d)),d[l-1][l-1-1]=Q;return[p,d,f,g]}function Pt(n,r){for(var t,e,i,u=G(n),o=($(n),"upper"===r),f=Zr(u,u),c=Or(u),a=0;a<u;++a){for(t=0;t<a;++t){for(e=0,i=Q;e<t;++e)i=nn(i,tn(tn(c[a][e],er(c[t][e])),f[e][e]));c[a][t]=en(rn(o?n[t][a]:n[a][t],i),f[t][t])}for(e=0,i=Q;e<a;++e)i=nn(i,tn(tn(c[a][e],er(c[a][e])),f[e][e]));if(f[a][a]=rn(n[a][a],i),Jn(f[a][a],Q))return[]}return[c,f]}function Xt(n,r,t,e){var i,u,o,f,c,a,l,s,h=G(n),m=$(n),g=r?Or(h):null,p=n,d={_:1};if(e=D(e||0),vt(p,"upper",!1,e,!0,d))p=d._;else if(p=jn(n),t)for(s={},i=O(m,function(n){return n}),f=O(m,function(n){return Lr(E(p,n),B)}),l=0;l<m;++l){for(c=f[u=l],a=l+1;a<m;++a)$n(f[a],c)&&(c=f[u=a]);if(H(c,Q))break;if(l!==u)for(o=f[l],f[l]=f[u],f[u]=o,o=i[l],i[l]=i[u],i[u]=o,a=0;a<h;++a)o=p[a][l],p[a][l]=p[a][u],p[a][u]=o;for(s.v=O(h-l,Q),wt(p,s,l,h-1,l,l,e),p=xt("left",s,p,l),a=l+1;a<h;++a)p[a][l]=Q;for(r&&(g=xt("right",s,g,l)),a=l+1;a<m;++a)f[a]=Wn(f[a],Un(un(p[l][a]),B))}else for(s={},l=0;l<m;++l){for(s.v=O(h-l,Q),wt(p,s,l,h-1,l,l,e),p=xt("left",s,p,l),a=l+1;a<h;++a)p[a][l]=Q;r&&(g=xt("right",s,g,l))}return r&&t?[g,p,i?S(m,m,function(n,r){return n===i[r]?U:Q}):Or(m)]:r?[g,p]:p}function zt(n,r,t){return Cn(un(n[r+1][r]),J(K(un(n[r][r]),un(n[r+1][r+1])),t))&&(n[r+1][r]=Q,1)}function Lt(n,r,z,t){var e,i,u,o,f,c,a,l,s,L,h,m,g,p,d,Z,v,y,b,w,x,k,S,A,_,q,O=G(n),E=O-1,$={_:1},I=0,C=0;if(vt(n,"upper",!0,t=D(t||1e-10),!0,$))return r?[Or(O),$._]:$._;if(f=Mt(n,null,r,t),r&&(c=f[0],f=f[1]),Z=100*O,"complex"===z)for(;;){for(;0<E&&zt(f,E-1,t);)I=0,--E;if(E<=0)break;if(++I,Z<=++C)break;for(o=E-1;0<o&&!zt(f,o-1,t);)--o;for(x=f,k=E,q=_=A=void 0,a=(S=(10===I||20===I)&&1<E)?nn(un(on(x[k][k-1])),un(on(x[k-1][k-2]))):(S=x[k-1][k-1],A=x[k-1][k],q=x[k][k-1],x=x[k][k],S=en(S,k=K(K(un(S),un(q)),K(un(A),un(x)))),A=en(A,k),q=en(q,k),x=en(x,k),A=tn(A,q),q=rn(S,x),q=V.sqrt(nn(tn(q,q),tn(A,4))),A=rn(tn(S,x),A),S=nn(S,x),_=en(nn(S,q),B),S=en(rn(S,q),B),$n(un(_),q=un(S))?S=en(A,_):H(q,Q)||(_=en(A,S)),On(un(rn(_,x)),un(rn(S,x)))?tn(_,k):tn(S,k)),f=bt("left",[er((s=yt(rn(f[o][o],a),f[o+1][o]))[0]),tr(er(s[1]))],o,o+1,f,o,null),(f=bt("right",s,o,o+1,f,0,F.min(o+2,E)))[o+1][o]=Q,r&&(c=bt("right",s,o,o+1,c)),e=o+1;e<E;++e)L=[er((s=yt(f[e][e-1],f[e+1][e-1]))[0]),tr(er(s[1]))],f[e][e-1]=nn(tn(s[0],f[e][e-1]),tn(s[1],f[e+1][e-1])),f[e+1][e-1]=Q,f=bt("left",L,e,e+1,f,e,null),f=bt("right",s,e,e+1,f,0,F.min(e+2,E)),r&&(c=bt("right",s,e,e+1,c))}else for(J(Lr(f,fn),J(t,t)),a=[Q],l=[Q,Q,Q];0<=E;)if((o=function(n,r,t){for(;0<r&&!Cn(un(n[r][r-1]),J(K(un(n[r-1][r-1]),un(n[r][r])),t));)--r;return r}(f,E,t))===E)f[E][E]=nn(f[E][E],a[0]),0<E&&(f[E][E-1]=Q),--E,I=0;else if(o+1===E)y=c,X=a,w=P=void 0,P=en(rn((v=f)[(b=E)-1][b-1],v[b][b]),B),w=nn(tn(P,P),tn(v[b][b-1],v[b-1][b])),v[b][b]=nn(v[b][b],X[0]),v[b-1][b-1]=nn(v[b-1][b-1],X[0]),Yn(w,Q)&&(X=W.sqrt(un(w)),v=bt("left",[er((w=yt((Yn(P,Q)?nn:rn)(P,X),v[b][b-1]))[0]),tr(er(w[1]))],b-1,b,v,b-1,null),(v=bt("right",w,b-1,b,v,0,b))[b][b-1]=Q,y=y&&bt("right",w,b-1,b,y)),1<b&&(v[b-1][b-2]=Q),E-=2,I=0;else{if(++I,Z<=++C)break;m=[Q,Q,Q],j=N=X=P=M=R=T=void 0;var N,j,T=f,R=E,M=l,P=a,X=0<I&&I%16==0?I%32!=0?"wilkinson":"matlab":"none";if(M[0]=T[R][R],M[1]=T[R-1][R-1],M[2]=tn(T[R][R-1],T[R-1][R]),"wilkinson"===X){for(P[0]=nn(P[0],M[0]),N=0;N<=R;++N)T[N][N]=rn(T[N][N],M[0]);j=nn(un(T[R][R-1]),un(T[R-1][R-2])),M[0]=tn(j,.75),M[1]=tn(j,.75),M[2]=tn(tn(j,j),-.4375)}else if("matlab"===X&&Kn(j=nn(tn(j=en(rn(M[1],M[0]),B),j),M[2]),Q)){for(j=V.sqrt(j),j=nn(j=Hn(M[1],M[0])?tr(j):j,en(rn(M[1],M[0]),B)),j=en(rn(M[0],M[2]),j),P[0]=nn(P[0],j),N=0;N<=R;++N)T[N][N]=rn(T[N][N],j);M[0]=D(.964),M[1]=M[2]=M[0]}for(u=E-2;o<=u&&(h=f[u][u],p=rn(l[0],h),d=rn(l[1],h),m[0]=nn(en(rn(tn(p,d),l[2]),f[u+1][u]),f[u][u+1]),m[1]=rn(rn(rn(f[u+1][u+1],h),p),d),m[2]=f[u+2][u+1],u!==o)&&(p=tn(f[u][u-1],nn(un(m[1]),un(m[2]))),d=tn(m[0],nn(nn(un(f[u-1][u-1]),un(h)),un(f[u+1][u+1]))),!Hn(un(p),tn(d,t)));--u);for((g={}).v=[U,Q,Q],i=u;i<=E-2;++i)i===u?wt(m,g,0,2,0,0):wt(f,g,i,i+2,i-1,i-1),Y(g.beta,Q)||(i===u&&o<i?f[i][i-1]=tr(f[i][i-1]):i!==u&&(f[i][i-1]=g.beta),f=xt("left",g,f,i,i+2,i,null),f=xt("right",g,f,i,i+2,0,F.min(E,i+3)),r&&(c=xt("right",g,c,i,i+2)));for(g.v=[U,Q],wt(f,g,E-1,E,E-2,E-2),Y(g.beta,Q)||(f[E-1][E-2]=g.beta,f=xt("left",g,f,E-1,E,E-1,null),f=xt("right",g,f,E-1,E,0,E),r&&(c=xt("right",g,c,E-1,E))),e=u+2;e<=E;++e)f[e][e-2]=Q,u+2<e&&(f[e][e-3]=Q)}return r?[c,f]:f}function Zt(n,r){r=D(r||1e-10);var t,e,i,u,o=G(n),f=new Array(o),c=new Array(o),a=O(o,Q);for(n=jn(n),u=0;u<o;++u)t=(i=function(n,r,t,e){var i,u,o,f,c,a,l=Q;if(!0===e){for(f=ar(f=O(r,function(){return new A(D(F.random()||.1),Q)}),Lr(f)),i=1;i<=100&&(o=l,l=Yr(f=q(N(n,c=f)),c),Y(f[0],Q)||(f=ar(f,nr(f[0]))),f=ar(f,Lr(f)),!Cn(W.abs(Wn(on(l),on(o))),t)||!Cn(W.abs(Wn(Pr(l),Pr(o))),t));++i);return l}for(u=Wr(n),f=ar(f=O(r,function(){return new A(D(F.random()||.1),Q)}),Lr(f)),a=ar(a=O(r,function(){return new A(D(F.random()||.1),Q)}),Lr(a)),i=1;i<=100&&(o=l,f=q(N(n,c=f)),a=q(N(u,a)),l=Yr(f,c),Y(f[0],Q)||(f=ar(f,nr(f[0]))),Y(a[0],Q)||(a=ar(a,nr(a[0]))),f=ar(f,Lr(f)),a=ar(a,Lr(a)),!Cn(W.abs(Wn(on(l),on(o))),t)||!Cn(W.abs(Wn(Pr(l),Pr(o))),t));++i);return[l,f,a]}(n,o,r))[0],e=i[1],i=i[2],n=fr(n,N(N(en(a[u]=t,Yr(f[u]=e,c[u]=i,!0)),e),i));return[Ln(Fr(f)),Ln(a),Ln(Fr(c))]}function Ot(n,r,t,e){r=D(r=Z(r)?r:cn);var i,u=$(n),o=G(n);if(o<u)return i=Ot(Fr(n),r,e,t),t&&e?[Fr(i[2]),i[1],Fr(i[0])]:t||e?[Fr(i[0]),i[1]]:i;var f,c,a,l,s,h,m,g,p,d,v,y,b,w,x,k,S,A,_,z,q,E=t?o:0,I=e?u:0,N=jn(n),j=E?Zr(o,E):null,T=O(u,Q),R=I?Zr(u,I):null,L=Qn(hn.realmin,r),M=new Array(u),P=new Array(u),X=new Array(u);for(P[0]=Q,w=1;w<=u;++w){for(S=w+1,a=Q,y=w;y<=o;++y)a=K(a,K(Un(on(N[y-1][w-1]),B),Un(Pr(N[y-1][w-1]),B)));if(M[w-1]=Q,$n(a,L)&&(a=W.sqrt(a),M[w-1]=a,s=H(l=un(N[w-1][w-1]),Q)?U:en(N[w-1][w-1],l),N[w-1][w-1]=tn(s,K(a,l)),w!==u+0)){for(b=S;b<=u+0;++b){for(s=Q,y=w;y<=o;++y)s=nn(s,tn(er(N[y-1][w-1]),N[y-1][b-1]));for(s=en(s,J(a,K(a,l))),y=w;y<=o;++y)N[y-1][b-1]=rn(N[y-1][b-1],tn(s,N[y-1][w-1]))}for(s=tr(nr(er(N[w-1][w-1]))),b=S;b<=u+0;++b)N[w-1][b-1]=tn(s,N[w-1][b-1])}if(w===u)break;for(a=Q,b=S;b<=u;++b)a=K(a,K(Un(on(N[w-1][b-1]),B),Un(Pr(N[w-1][b-1]),B)));if(P[S-1]=Q,$n(a,L)){for(a=W.sqrt(a),P[S-1]=a,s=H(l=un(N[w-1][S-1]),Q)?U:en(N[w-1][S-1],l),N[w-1][S-1]=tn(s,K(a,l)),y=S;y<=o;++y){for(s=Q,b=S;b<=u;++b)s=nn(s,tn(er(N[w-1][b-1]),N[y-1][b-1]));for(s=en(s,J(a,K(a,l))),b=S;b<=u;++b)N[y-1][b-1]=rn(N[y-1][b-1],tn(s,N[w-1][b-1]))}for(s=tr(nr(er(N[w-1][S-1]))),y=S;y<=o;++y)N[y-1][S-1]=tn(N[y-1][S-1],s)}}for(h=Q,w=1;w<=u;++w)T[w-1]=M[w-1],X[w-1]=P[w-1],h=Hr([h,K(T[w-1],X[w-1])]);if(h=J(r,h),0<E)for(b=1;b<=E;++b)j[b-1][b-1]=U;if(0<I)for(b=1;b<=I;++b)R[b-1][b-1]=U;for(k=1;k<=u;++k){for(w=u+1-k,z=1;z<=100;++z){for(q=!0,_=1;_<=w;++_){if(Cn(W.abs(X[(x=w+1-_)-1]),h)){q=!1;break}if(Cn(W.abs(T[x-1-1]),h)){q=!0;break}}if(q)for(v=Q,d=U,A=x-1,y=x;y<=w&&(g=J(d,X[y-1]),X[y-1]=J(v,X[y-1]),!Cn(W.abs(g),h));++w)if(l=dr(g,p=T[y-1]),v=Qn(p,T[y-1]=l),d=Vn(Qn(g,l)),0<E)for(b=1;b<=u;++b)f=on(j[b-1][A-1]),c=on(j[b-1][y-1]),j[b-1][A-1]=K(J(f,v),J(c,d)),j[b-1][y-1]=Wn(J(c,v),J(f,d));if(l=T[w-1],x===w)break;for(f=T[x-1],c=T[w-1-1],m=X[w-1-1],p=X[w-1],m=dr(g=Qn(K(J(Wn(c,l),K(c,l)),J(Wn(m,p),K(m,p))),J(B,J(p,c))),U),On(g,Q)&&(m=Vn(m)),g=Qn(K(J(Wn(f,l),K(f,l)),J(Wn(Qn(c,K(g,m)),p),p)),f),d=v=U,y=A=x+1;A<=w;++A){if(m=X[y-1],c=T[y-1],p=J(d,m),m=J(v,m),l=dr(p,g),v=Qn(g,X[y-1-1]=l),d=Qn(p,l),g=K(J(f,v),J(m,d)),m=Wn(J(m,v),J(f,d)),p=J(c,d),c=J(c,v),0<I)for(b=1;b<=u;++b)f=on(R[b-1][y-1-1]),l=on(R[b-1][y-1]),R[b-1][y-1-1]=K(J(f,v),J(l,d)),R[b-1][y-1]=Wn(J(l,v),J(f,d));if(l=dr(p,g),v=Qn(g,T[y-1-1]=l),d=Qn(p,l),g=K(J(v,m),J(d,c)),f=Wn(J(v,c),J(d,m)),0<E)for(b=1;b<=u;++b)c=on(j[b-1][y-1-1]),l=on(j[b-1][y-1]),j[b-1][y-1-1]=K(J(c,v),J(l,d)),j[b-1][y-1]=Wn(J(l,v),J(c,d))}X[x-1]=Q,X[w-1]=g,T[w-1]=f}if(On(l,Q)&&(T[w-1]=Vn(l),0<I))for(b=1;b<=u;++b)R[b-1][w-1]=tr(R[b-1][w-1])}for(w=1;w<=u;++w){for(m=-1,y=b=w;y<=u;++y)$n(T[y-1],m)&&(m=T[y-1],b=y);if(b!==w){if(T[b-1]=T[w-1],T[w-1]=m,0<I)for(y=1;y<=u;++y)s=R[y-1][b-1],R[y-1][b-1]=R[y-1][w-1],R[y-1][w-1]=s;if(0<E)for(y=1;y<=u;++y)s=j[y-1][b-1],j[y-1][b-1]=j[y-1][w-1],j[y-1][w-1]=s}}if(0<E)for(k=1;k<=u;++k)if(!H(M[(w=u+1-k)-1],Q)){for(s=tr(nr(N[w-1][w-1])),b=1;b<=E;++b)j[w-1][b-1]=tn(s,j[w-1][b-1]);for(b=1;b<=E;++b){for(s=Q,y=w;y<=o;++y)s=nn(s,tn(er(N[y-1][w-1]),j[y-1][b-1]));for(s=en(s,tn(un(N[w-1][w-1]),M[w-1])),y=w;y<=o;++y)j[y-1][b-1]=rn(j[y-1][b-1],tn(s,N[y-1][w-1]))}}if(0<I&&2<=u)for(k=2;k<=u;++k)if(!H(P[(S=(w=u+1-k)+1)-1],Q)){for(s=tr(nr(er(N[w-1][S-1]))),b=1;b<=I;++b)R[S-1][b-1]=tn(s,R[S-1][b-1]);for(b=1;b<=I;++b){for(s=Q,y=S;y<=u;++y)s=nn(s,tn(N[w-1][y-1],R[y-1][b-1]));for(s=en(s,tn(un(N[w-1][S-1]),P[S-1])),y=S;y<=u;++y)R[y-1][b-1]=rn(R[y-1][b-1],tn(s,er(N[w-1][y-1])))}}return t&&e?[Ln(j),T,Ln(R)]:t||e?[Ln(j||R),T]:T}V.planerot=Mn(function(n,r){b(r=q(r))&&2===r.length||v("planerot");var t=yt(r[0],r[1]),t=[[t[0],t[1]],[tr(t[1]),t[0]]];return 1<n?[t,N(t,qn(r))]:t}),V.ref=Mn(function(n,r,t){w(r=y(r)?[[r]]:r)||v("ref");r=kt(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),V.rref=Mn(function(n,r,t){w(r=y(r)?[[r]]:r)||v("rref");r=St(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),V.linsolve=At,V.null=function(n,r){return r=r,i=$(t=n),u=(t=St(n,!0,null,r))[0],o=t[1],f=o.length,r=o.reduce(function(n,r){for(var t=0;t<n.length&&r[1]>n[t];)++t;return t<n.length&&r[1]===n[t]&&n.splice(t,1),n},O(i,function(n){return n})),c=f?o.reduce(function(n,r,t){return tn(n,u[t][r[1]])},U):U,r.map(function(r){for(var n,t=O(i,function(n){return n===r?c:Q}),e=0;e<f;++e)(n=o[e][1])<=r&&(t[n]=rn(t[n],tn(en(c,u[e][n]),u[e][r])));return t});var t,i,u,o,f,c},V.rowspace=function(n,r){return kt(t=n,!0,null,r)[1].map(function(n){return t[n[0]]});var t},V.colspace=function(n,r){return kt(t=n,!0,null,r)[1].map(function(r){return O(t.length,function(n){return t[n][r[1]]})});var t},V.rank=function(n){return w(n=y(n)?[[n]]:n)||v("rank"),kt(n,!0)[1].length},V.inv=function(n){return y(n)&&(x=[[n]]),w(n)||v("inv"),_t(n)},V.ainv=function(n){return y(n)&&(x=[[n]]),w(n)||v("ainv"),qt(n)},V.rankf=function(n){return w(n=y(n)?[[n]]:n)||v("rankf"),Et(n)},V.pinv=function(n,r){return w(n=y(n)?[[n]]:n)||v("pinv"),It(n,r)},V.cond=function(n,r){w(n=y(n)?[[n]]:n)||v("cond");var t=_t(n);return t&&t.length?tn(Lr(n,r=null==r?2:r),Lr(t,r)):fn},V.trace=Nt,V.det=function(n){return w(n=y(n)?[[n]]:n)||v("det"),jt(n,!1,1e-15)},V.charpoly=function(n){w(n)&&G(n)===$(n)||v("charpoly");var e,r=G(n),i=($(n),r),u=new Array(i+1),t=Zr(i,i);for(u[i]=U,e=1;e<=i;++e)t=N(n,t).map(function(n,t){return n.map(function(n,r){return t===r?nn(n,u[i-e+1]):n})}),u[i-e]=en(Nt(N(n,t)),-e);return Ln(u.reverse())},V.adjoint=function(n){return w(n)&&G(n)===$(n)||v("adjoint"),Tt(n)},V.balance=Mn(function(n,r,t){w(r=y(r)?[[r]]:r)&&G(r)===$(r)||v("balance");var e=Rt(r,B,1<n);return 2<n?[e[0],O(G(r),function(n){return n+1}),e[1]]:1<n?[Qr(e[0]),e[1]]:e}),V.hess=Mn(function(n,r,t){return w(r=y(r)?[[r]]:r)&&G(r)===$(r)||v("hess"),2<arguments.legnth?(w(t=y(t)?[[t]]:t)&&G(t)===$(t)||v("hess"),Mt(r,t,2<n)):Mt(r,null,1<n)}),V.ldl=Mn(function(n,r,t){w(r=y(r)?[[r]]:r)&&G(r)===$(r)||v("ldl");t=Pt(r,t);return t.length||v("ldl"),2<n&&t.push(Or(G(r))),t},2),V.chol=Mn(function(n,r,t){w(r=y(r)?[[r]]:r)&&G(r)===$(r)||v("chol");r=Pt(r,t=t||"upper");return r.length||v("chol"),"lower"===t?N(r[0],V.sqrt(r[1])):Wr(N(r[0],V.sqrt(r[1])))}),V.lu=Mn(function(n,r){w(r=y(r)?[[r]]:r)||v("lu");var t,r=function(n,r){var t,e,i,u,o,f,c,a,l,s,h,m,g,p,d;for(r=D(r||0),t=G(n),e=$(n),d=!1,o=jn(n),u=Or(t),f=O(t,Q),i=Or(t),c=U,a=0;a<t-1;++a){if(Jn(un(o[a][a]),r)){for(h=a+1,m=!0;h<t&&m;)Jn(un(o[h][a]),r)?++h:m=!1;if(t<=h){d=!0;break}st(o,a,h),st(i,a,h)}for(g=o[a][a],u[a][a]=g,f[a]=tn(c,g),l=a+1;l<t;++l){for(p=o[l][a],u[l][a]=p,s=a+1;s<e;++s)o[l][s]=en(rn(tn(g,o[l][s]),tn(o[a][s],p)),c);o[l][a]=Q}c=o[a][a]}return d?[]:(f[t-1]=c,[f,u,o,i])}(r);if(r.length)return t=Qr(r[0].map(ir)),2<n?[N(r[1],t),r[2],r[3]]:[N(Fr(r[3]),N(r[1],t)),r[2]];throw"lu: defficient matrix"},2),V.qr=Mn(function(n,r){return w(r=y(r)?[[r]]:r)||v("qr"),Xt(r,1<n,2<n)}),V.schur=Mn(function(n,r,t){return w(r=y(r)?[[r]]:r)&&G(r)===$(r)||v("schur"),Lt(r,1<n,"complex"!==t&&V.isreal(r)?"real":"complex")}),V.eig=Mn(function(n,r,t){w(r)&&G(r)===$(r)||v("eig"),w(t)&&v("eig");var e=null;return"nobalance"!==t&&(e=Rt(r,null,!0),r=e[1],e=e[0]),1<n?(t=Zt(r,1e-12),[e?N(Qr(e),t[0]):t[0],Qr(t[1]),e?N(Qr(e.map(Gn)),t[2]):t[2]]):Ln(O(G(r=vt(r,"lower",!0,1e-12)?r:Lt(r,!1,"complex",1e-12)),function(n){return r[n][n]}).sort(function(n,r){n=un(n),r=un(r);return $n(r,n)?1:On(r,n)?-1:0}))}),V.svd=Mn(function(n,r,t){return w(r=y(r)?[[r]]:r)||v("svd"),1<n?[(n=Ot(r,t,1<n,2<n))[0],Qr(n[1]),n[2]]:Ot(r,t,!1,!1)});var $t=function(n,r,t){for(var e,i,u,o,f,c,a,l=G(n),s=$(n),h=s,m=Q,g=t?dt(n,Or(l)):n,p=0,d=0;d<l&&!(h<=p);++d){for(e=d;Jn(un(g[e][p]),m);)if(l<=++e&&(e=d,h<=++p)){p=-1;break}if(-1===p)break;for(u=-1,f=null,a=0,e=i=e;e<l;++e)Jn(c=un(g[e][p]),m)?++a:null!=f&&!Hn(c,f)||(f=c,u=e);for(;-1!==u;){if(l-i===a+1){if(d!==u&&st(g,d,u),Hn(g[d][p],Q)&&ht(g,d,d,Q,M,p),r)for(c=g[d][p],e=0;e<d;++e)Yn(un(g[e][p]),c)&&ht(g,e,d,tr(V.floor(en(g[e][p],c))),U,p),Hn(g[e][p],Q)&&ht(g,e,d,U,U,p);e=u,i=d;break}for(a=0,o=u,e=i;e<l;++e)e!==o&&(ht(g,e,o,tr(V.floor(en(g[e][p],g[o][p]))),U,p),Jn(c=un(g[e][p]),m)?++a:Hn(c,f)&&(f=c,u=e))}++p}return t?[pt(g,0,s,l-1,l+s-1),pt(g,0,0,l-1,s-1)]:g};function Ct(n,r){for(var t,e,i,u,o,f,c=G(n),a=S(c,c,Q),l={err:0},s=0;s<c;++s)for(a[s][s]=V.sqrt(n[s][s]),t=i=s-1;0<=t;--t){for(u=Q,e=t+1;e<=i;++e)u=nn(u,tn(a[t][e],a[e][s]));o=rn(n[t][s],u),f=nn(a[t][t],a[s][s]),Y(o,Q)?a[t][s]=Q:(Y(f,Q)&&(l.err=1),a[t][s]=en(o,f))}return r&&null!=r.err&&(r.err=l.err),a}function Ft(n){for(var r,t=Or(G(n)),e=Hr([Q,K(U,W.floor(W.log2(Lr(n,fn))))]),i=or(t,r=n=ar(n,Un(B,e))),u=2;u<=25;++u)i=or(i,r=ar(N(n,r),D(u)));for(u=1,e=I(e);u<=e;++u)i=N(i,i);return i}function Wt(n,r){var t,e,i,u=G(n),o=Rt(n,null,!0),f=o[0],c=Or(u),a=D(.013325),l=0,s=0,h={err:0};for(n=o[1];$n(Lr(fr(n,c),fn),a)&&(n=Ct(n,h),++l,20<++s&&(h.err=1),!h.err););if(e=t=n=fr(n,c),!h.err)for(i=2,0;i<=10;++i)e=(1&i?or:fr)(e,ar(t=sr(n,t),D(i)));return 0<l&&(e=cr(e,Un(B,l))),r&&null!=r.err&&(r.err=h.err),N(N(Qr(f),e),Qr(f.map(Gn)))}function Qt(n){for(var r,t,e,i,u,o,f=G(n),c=Or(f),a=0;a<f;++a)c[a][a]=H(on(o=n[a][a]),Q)?H(Pr(o),Q)?U:W.sign(Pr(o)):W.sign(on(o));for(e=0;e<f-1;++e)for(a=0;a<f-e;++a)if(i=rn(n[r=a+e][r],n[a][a]),Y(c[a][a],tr(c[r][r]))){if(u=tn(n[a][r],rn(c[r][r],c[a][a])),0<e)for(t=a+1;t<=r-1;++t)u=nn(u,rn(tn(n[a][t],c[t][r]),tn(c[a][t],n[t][r])));c[a][r]=en(u,i)}else for(t=a+1;t<=r-1;++t)c[a][r]=en(tn(tr(c[a][t]),c[t][r]),nn(c[a][a],c[r][r]));return c}function Ut(n){var r,t,e,i,u,o,f,c,a=[D(34417071e-12),D(.004807320816),D(.039685094175),D(.126262963075),D(.25856709354),D(.416519074566),D(.580947286323),D(.738997052037),D(.883885725911),D(1.013025759393),D(1.126269612452),D(1.22469915728)],l=G(n),n=Lt(n,!0,"complex"),s=n[0],h=n[1],m=Or(l),g=0,p=0,d=Qr(h);for(at(d,function(n){return H(Pr(n),Q)&&(H(on(n),M)||H(on(n),U))})&&console.warn("acosm: input must not have an eigenvalue of 1 or -1 else result may be unreliable!");Kn(Lr(fr(U,d),fn),a[7]);)++g,d=V.sqrt(ar(or(U,d),B));for(j=1;j<=g;++j)h=Ct(ar(or(m,h),B));for(;0===p;){if(Cn(t=$n(t=Un(Lr(c=sr(f=fr(m,h),f),fn),.5),r=Un(Lr(c=sr(f,c),fn),1/3))?t:r,a[0])){p=1;break}if(Cn(t,a[1])){p=2;break}if(Cn(r=$n(r,t=Un(Lr(c=sr(f,c),fn),.25))?r:t,a[2])){p=3;break}if(Cn(r,a[3])){p=4;break}if(Cn(r,a[4])){p=5;break}if(Cn(t=On(r,t=$n(t,c=Un(Lr(sr(f,c),fn),.2))?t:c)?r:t,a[5])){p=6;break}if(Cn(t,a[6])){p=7;break}if(Cn(t,a[7])){p=8;break}h=Ct(ar(or(m,h),B)),++g}return i=1===p?(e=[U,D(-.1417)],[U,D(-.225)]):2===p?(e=[U,D(-.3891),D(.0187)],[U,D(-.4724),D(.0393)]):3===p?(e=[U,D(-.6381843806),D(.0998258508),D(-.002422303)],[U,D(-.721517714),D(.141202327),D(-.0062410636)]):4===p?(e=[U,D(-.8877087699),D(.2433623027),D(-.0212197774),D(.0003104661)],[U,D(-.9710421032),D(.3055324779),D(-.0340541349),D(939467e-9)]):5===p?(e=[U,D(-1.1374227978),D(.4493652033),D(-.0719901333),D(.004045028),D(-395692e-10)],[U,D(-1.2207561311),D(.5323448809),D(-.0990433864),D(.0072305607),D(-.0001367979)]):6===p?(e=[U,D(-1.3872329589),D(.7178511241),D(-.1703500659),D(.0182193375),D(-.0007178871),D(50248e-10)],[U,D(-1.4705662922),D(.8216483151),D(-.216827998),D(.027189845),D(-.0014099871),D(194672e-10)]):7===p?(e=[U,D(-1.637098276),D(1.0488276715),D(-.331921349),D(.0537536569),D(-.0041439924),D(121116e-9),D(-6.365e-7)],[U,D(-1.7204316094),D(1.1734469723),D(-.4030308611),D(.0730391826),D(-.0066542668),D(258653e-9),D(-2724e-9)]):8===p?(e=[U,D(-1.8869980457),D(1.4422987012),D(-.5723275787),D(.1254739271),D(-.0149128371),D(.0008717583),D(-19676e-9),D(8.05e-8)],[U,D(-1.970331379),D(1.5877429828),D(-.6732761377),D(.1609063722),D(-.0215156706),D(.0014963185),D(-453099e-10),D(3.763e-7)]):(e=[U],[U]),n=O(e.length,function(n,r){return 0===n?m:1===n?f:sr(f,r[n-1])}),u=Zr(l,l),o=Zr(l,l),n.forEach(function(n,r){u=or(u,cr(e[r],n)),o=or(o,cr(i[r],n))}),l=N(cr(At(o,u),X),Ct(f)),N(N(s,cr(Un(B,g),l)),Wr(s))}V.hermiteForm=Mn(function(n,r){return w(r=y(r)?[[r]]:r)||v("hermiteForm"),$t(V.round(V.real(r)),!0,1<n)}),V.smithForm=Mn(function(n,r){w(r=y(r)?[[r]]:r)||v("smithForm");r=function(n,r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d,v,y,b,w,x,k=G(n),S=$(n),A=F.min(k,S);for(r&&(e=Or(k)),t&&(i=Or(S)),u=-1,o=0;o<k;++o){for(s=!1,f=u+1;f<S;++f){for(m=0;m<k&&H(n[m][f],Q);++m);if(m<k){s=!0;break}}if(!s)break;if(H(n[o][f],Q)){for(a=0;a<k&&H(n[a][f],Q);++a);mt(n,o,a,Q,U,U,Q),r&&gt(e,o,a,Q,U,U,Q)}for(gt(n,f,o,Q,U,U,Q),t&&mt(i,f,o,Q,U,U,Q),f=o,c=!0;c;){for(c=!1,a=o+1;a<k;++a)H(n[a][f],Q)||(c=!0,H(Q,Bn(n[a][f],n[o][f]))||(p=(g=_e([n[o][f],n[a][f]]))[1],d=g[2],v=Qn(n[a][f],g[0]),y=Qn(n[o][f],g[0]),mt(n,o,a,p,d,Vn(v),y),r&&gt(e,o,a,y,Vn(d),v,p)),b=Qn(n[a][f],n[o][f]),mt(n,o,a,U,Q,Vn(b),U),r&&gt(e,o,a,U,Q,b,U));for(l=f+1;l<S;++l)H(n[o][l],Q)||(c=!0,H(Q,Bn(n[o][l],n[o][f]))||(p=(g=_e([n[o][f],n[o][l]]))[1],d=g[2],v=Qn(n[o][l],g[0]),y=Qn(n[o][f],g[0]),gt(n,f,l,p,Vn(v),d,y),t&&mt(i,f,l,y,v,Vn(d),p)),b=Qn(n[o][l],n[o][f]),gt(n,f,l,U,Vn(b),Q,U),t&&mt(i,f,l,U,b,Q,U))}u=f}for(h=0;h<A;++h)for(m=h-1;0<=m;--m)H((g=_e([n[m][m],n[h][h]]))[0],Q)||(p=g[1],d=g[2],v=Qn(n[h][h],g[0]),y=Qn(n[m][m],g[0]),w=J(d,v),x=Wn(U,J(p,y)),mt(n,m,h,U,d,v,Wn(w,U)),r&&gt(e,m,h,Wn(U,w),d,v,M),gt(n,m,h,p,x,U,Vn(y)),t&&mt(i,m,h,y,x,U,Vn(p)));return r&&t?[n,e,i]:r?[n,e]:t?[n,i]:n}(V.round(V.real(r)),1<n,1<n);return 1<n?[r[1],r[2],r[0]]:r}),V.sqrtm=Mn(function(n,r){if(2<n)throw"sqrtm: output not supported";if(y(r))return 1<n?[V.sqrt(r),Q]:V.sqrt(r);w(r)&&G(r)===$(r)||v("sqrtm");var t,e,i=N(N(e=(i=Lt(i=r,!0,"complex"))[0],Ct(i[1],t)),Wr(e));return 1<n?[i,en(Lr(fr(r,N(i,i)),U),Lr(r,U))]:i}),V.expm=function(n){return y(n)?V.exp(n):(w(n)&&G(n)===$(n)||v("expm"),Ft(n))},V.logm=Mn(function(n,r){var t,e,i={err:0},r=y(r)?V.log(r):(w(r)&&G(r)===$(r)||v("logm"),t=i,N(N(e=(r=Lt(r=r,!0,"complex"))[0],Wt(r[1],t)),Wr(e)));return 1<n?[r,i.err]:r}),V.signm=function(n){return y(n)?V.sign(n):(w(n)&&G(n)===$(n)||v("signm"),N(N(r=(n=Lt(n=n,!0,"complex"))[0],Qt(n[1])),Wr(r)));var r},V.cosm=function(n){return y(n)?V.cos(n):(w(n)&&G(n)===$(n)||v("cosm"),ar(or(Ft(cr(n,j)),Ft(cr(n,tn(M,j)))),B))},V.sinm=function(n){return y(n)?V.sin(n):(w(n)&&G(n)===$(n)||v("sinm"),ar(fr(Ft(cr(n,j)),Ft(cr(n,tn(M,j)))),tn(B,j)))},V.coshm=function(n){return y(n)?V.cosh(n):(w(n)&&G(n)===$(n)||v("coshm"),ar(or(Ft(n),Ft(cr(n,M))),B))},V.sinhm=function(n){return y(n)?V.sinh(n):(w(n)&&G(n)===$(n)||v("sinhm"),ar(fr(Ft(n),Ft(cr(n,M))),B))},V.acosm=function(n){return y(n)?V.acos(n):(w(n)&&G(n)===$(n)||v("acosm"),Ut(n))},V.asinm=function(n){return y(n)?V.asin(n):(w(n)&&G(n)===$(n)||v("asinm"),fr(Or(G(n),D(R/2)),Ut(n)))},V.acoshm=function(n){return y(n)?V.acosh(n):(w(n)&&G(n)===$(n)||v("acoshm"),r=G(n=n),t=(n=Lt(n,!0,"complex"))[0],e=Qr(n=n[1]),r=Or(r),at(e,function(n){return H(Pr(n),Q)&&On(Q,on(n))&&Cn(on(n),U)})?N(N(t,Wt(or(n,sr(Ct(fr(n,r)),Ct(or(n,r)))))),Wr(t)):cr(N(N(t,sr(Qt(cr(n,tn(M,j))),Ut(n))),Wr(t)),j));var r,t,e},V.asinhm=function(n){return y(n)?V.asinh(n):(w(n)&&G(n)===$(n)||v("asinhm"),cr(V.asinm(cr(n,tn(M,j))),j))};var Bt=.254829592,Vt=-.284496736,Gt=1.421413741,Dt=-1.453152027,Ht=1.061405429,Kt=.3275911;function Jt(n){n=on(n);var r,t=W.sign(n)||1;return t<0&&(n=Vn(n)),r=Gn(K(J(Kt,n),U)),J(t,Wn(U,J(K(J(K(J(K(J(K(J(Ht,r),Dt),r),Gt),r),Vt),r),Bt),J(r,W.exp(Vn(J(n,n)))))))}function Yt(r,n){if(y(r))return r;if(b(r))return r.length?en(Kr(r),D(r.length)):l;if(w(r)){if(1===(n=I(n=null==n?1:n)))return O($(r),function(n){return Yt(E(r,n))});if(2===n)return O(G(r),function(n){return Yt(r[n])})}v("mean")}function ne(r,n,t){if(n=I(n||0),y(r))return Q;if(b(r))return 0===r.length?l:1===r.length?Q:W.sqrt(en(Kr(lr(zr(fr(r,Yt(r))),D(2))),D(1===n?r.length:r.length-1)));if(w(r)){if(1===(t=I(t=null==t?1:t)))return O($(r),function(n){return ne(E(r,n))});if(2===t)return O(G(r),function(n){return ne(r[n])})}v("std")}function re(e,n,i){if(i=I(i||0),2!==arguments.length||0!==I(n)&&1!==I(n)||(i=I(n),n=null),null==n){if(y(e))return Q;var r;if(b(e))return e.length<=1?e.length?Q:l:(t=e.length,r=Yt(e),en(Kr(cr(Xr(r=fr(e,r)),r)),D(1===i?t:t-1)));if(w(e))return S($(e),$(e),function(n,r,t){return n===r?re(E(e,n),i):r<n?t[r][n]:re(E(e,n),E(e,r),i)})}else{if(y(e)&&y(n))return Zr(2,2);if(w(e)&&w(n)&&(e=$r(e),n=$r(n)),b(e)&&b(n)){if(e.length!==n.length)throw"cov: inputs not of same dimension";var t;return e.length<=1?e.length?Q:l:(t=e.length,en(Kr(cr(Xr(fr(e,Yt(e))),fr(n,Yt(n)))),D(1===i?t:t-1)))}}v("cov")}function te(n,r,t){for(var e,i=r.length,u=0,o=fn,f=0;f<i;++f)r[f]&&r[f].length&&On(e=t(n,r[f]),o)&&(o=e,u=f);return[u,o]}function ee(n){return n.length?Yt(n):n}function ie(i,n,r){return O(n,function(e){return ee(r.reduce(function(n,r,t){return r===e&&n.push(i[t]),n},[]))})}function ue(t,n,r,e){return t=t.slice(),O(n,function(n){var r=t.length?F.round(F.random()*(t.length-1)):-1;return-1<r?t.splice(r,1)[0]:[]})}function oe(n,t,r,e){var i=n.length;return Ie(n.slice()).reduce(function(n,r){return!n.length||n[n.length-1].length+1>i/t?n.push([r]):n[n.length-1].push(r),n},[]).map(ee)}function fe(n,r,t,e){for(var i,u,o,f,c,a=n.length,l=[n[F.round(F.random()*(a-1))]],s=new Array(a);l.length<r;){for(o=Q,u=0;u<a;++u)i=te(n[u],l,t)[1],s[u]=un(tn(i,er(i))),o=K(o,s[u]);for(f=J(o,F.random()),c=Q,u=0;u<a;++u)if(Fn(c=K(c,s[u]),f)){l.push(n[u]);break}}return l}function ce(n,r){var t,e,i,u,o,f=n.length,c=r.length,a=f+c-1;if(!f||!c)return[];for(o=new Array(a),f<c&&(u=n,f=(n=r).length,c=(r=u).length),t=0;t<a;++t)for(o[t]=Q,e=0;e<c;++e)0<=(i=t-e)&&i<f&&(o[t]=nn(o[t],tn(n[i],r[e])));return o}function ae(n,r,t){var e,i=[],u=n.slice(),o=u.length-r.length,f=r;if(0<=o)for(i=O(o+1,Q);0<=o;){for(e=o,r=f.concat(O(o,Q)),i[i.length-1-o]=en(u[0],r[0]),u=ye(u,be(r,[tr(i[i.length-1-o])]));u.length&&Y(u[0],Q);)u.shift();if((o=u.length-f.length)===e)break}return[i,t?O(n.length-u.length,Q).concat(u):u]}L.push(function(){Bt=D(.254829592),Vt=D(-.284496736),Gt=D(1.421413741),Dt=D(-1.453152027),Ht=D(1.061405429),Kt=D(.3275911)}),V.erf=function(n){return Tn(Jt,n,!0)},V.mean=Yt,V.median=function r(t,n){if(y(t))return t;if(b(t))return t.length?1&(t=Gr(t)).length?t[t.length>>1]:en(nn(t[t.length>>1],t[(t.length>>1)-1]),B):l;if(w(t)){if(1===(n=I(n=null==n?1:n)))return O($(t),function(n){return r(E(t,n))});if(2===n)return O(G(t),function(n){return r(t[n])})}v("median")},V.mode=function r(t,n){if(y(t))return t;var e,i;if(b(t))return t.length?(e={},i=0,t.reduce(function(n,r){var t=r.toString(),t=an.call(e,t)?(e[t]+=1,e[t]):e[t]=1;return i<t?(i=t,n=r):t===i&&Hn(r,n)&&(n=r),n},{})):l;if(w(t)){if(1===(n=I(n=null==n?1:n)))return O($(t),function(n){return r(E(t,n))});if(2===n)return O(G(t),function(n){return r(t[n])})}v("mode")},V.moment=function r(t,e,n){if(y(t))return Q;var i;if(b(t))return t.length<=1?t.length?Q:l:(i=t.length,en(Kr(lr(fr(t,Yt(t)),e)),D(i)));if(w(t)){if(1===(n=I(n=null==n?1:n)))return e=D(e),O($(t),function(n){return r(E(t,n),e)});if(2===n)return e=D(e),O(G(t),function(n){return r(t[n],e)})}v("moment")},V.std=ne,V.var=function r(t,e,n){if(e=I(e||0),y(t))return Q;var i,u;if(b(t))return t.length<=1?t.length?Q:l:(i=t.length,u=Yt(t),en(Kr(cr(Xr(u=fr(t,u)),u)),D(1===e?i:i-1)));if(w(t)){if(1===(n=I(n=null==n?1:n)))return O($(t),function(n){return r(E(t,n),e)});if(2===n)return O(G(t),function(n){return r(t[n],e)})}v("var")},V.cov=re,V.corrcoef=function e(i,r){if(null==r){if(y(i)||b(i))return U;if(w(i))return S($(i),$(i),function(n,r,t){return n===r?U:r<n?t[r][n]:e(E(i,n),E(i,r))})}else{if(y(i)&&y(r))return U;if(b(i)&&b(r)){if(i.length!==r.length)throw"corrcoef: inputs not of same dimension";return jr(i,r)}if(w(i)&&w(r)){if(G(i)!==G(r)||$(i)!==$(r))throw"corrcoef: inputs not of same dimension";return O($(i),function(n){return e(E(i,n),E(r,n))})}}v("corrcoef")},V.corr=Mn(function(n,t){if(1<n)throw"corr: only one output is supported";w(t=y(t)?[[t]]:t)||v("corr");var e,n=2,i=jr;if(n<arguments.length&&k(arguments[n])?(e=arguments[n],++n):e=t,n<arguments.length&&"Type"===arguments[n])switch(arguments[n+1]){case"Spearman":i=Tr;break;case"Kendall":i=Rr;break;default:i=jr}return w(e)&&G(t)===G(e)||v("corr"),S($(t),$(e),function(n,r){return i(E(t,n),E(e,r))})}),V.tiedrank=Mn(function(n,r,t,e){if(1<n)throw"tiedrank: only one output is supported";r=q(r=y(r)?[r]:r);var i=Y(Q,t)&&Y(U,e);return w(r)?Fr(O($(r),function(n){return Nr(E(r,n),i)})):Nr(r,i)}),V.pdist=function(n){var i,u,r=yr;if(w(n=b(n)?qn(n):n)||v("pdist"),1<arguments.length)switch(arguments[1]){case"fasteuclidean":case"euclidean":r=yr;break;case"fastsquaredeuclidean":case"squaredeuclidean":r=br;break;case"fastseuclidean":case"seuclidean":u=k(arguments[2])?q(arguments[2]):ne(n),r=function(n,r,t,e){return wr(n,r,u[t])};break;case"mahalanobis":u=_t(u=k(arguments[2])?arguments[2]:re(Wr(n))),i=Yt(Wr(n)),r=function(n,r,t,e){return W.sqrt(xr(r,i,u))};break;case"cityblock":r=Ar;break;case"minkowski":u=y(arguments[2])?arguments[2]:B,r=function(n,r,t,e){return kr(n,r,u)};break;case"chebychev":r=Sr;break;case"cosine":r=_r;break;case"correlation":r=qr;break;case"hamming":r=Er;break;case"jaccard":r=Ir}for(var t,e=[],o=$(n),f=0;f<o;++f)for(t=f+1;t<o;++t)e.push(r(E(n,t),E(n,f),t,f));return e},V.pdist2=function(e,i){var u,o,f=yr;if(b(e)&&(e=qn(e)),b(i)&&(i=qn(i)),w(e)&&w(i)&&G(e)===G(i)||v("pdist2"),2<arguments.length)switch(arguments[2]){case"fasteuclidean":case"euclidean":f=yr;break;case"fastsquaredeuclidean":case"squaredeuclidean":f=br;break;case"fastseuclidean":case"seuclidean":o=k(arguments[3])?q(arguments[3]):ne(e),f=function(n,r,t,e){return wr(n,r,o[t])};break;case"mahalanobis":o=_t(o=k(arguments[3])?arguments[3]:re(Wr(e))),u=Yt(Wr(e)),f=function(n,r,t,e){return W.sqrt(xr(r,u,o))};break;case"cityblock":f=Ar;break;case"minkowski":o=y(arguments[3])?arguments[3]:B,f=function(n,r,t,e){return kr(n,r,o)};break;case"chebychev":f=Sr;break;case"cosine":f=_r;break;case"correlation":f=qr;break;case"hamming":f=Er;break;case"jaccard":f=Ir}return S($(e),$(i),function(n,r,t){return n<=r?f(E(e,n),E(i,r),n,r):t[r][n]})},V.mahal=function(e,n){b(n)&&(n=qn(n)),b(e)&&(e=qn(e)),w(n)&&w(e)&&G(n)===G(e)||v("mahal");var r=Wr(n),i=_t(re(r)),u=Yt(r);return S($(e),$(n),function(n,r,t){return n<=r?xr(E(e,n),u,i):t[r][n]})},V.squareform=function(n,r){var t,e,i,u,o,f;if(b(n=q(n))||"tomatrix"===r){if(y(n))n=[n];else if(w(n))return n;for(e=n.length,t=S(i=F.round((F.sqrt(1+8*e)+1)/2),i,Q),u=f=0;u<i;++u)for(o=u+1;o<i;++o)t[o][u]=n[f++],t[u][o]=t[o][u]}else if(w(n)||"tovector"===r){if(y(n))n=[[Q,n],[n,Q]];else if(b(n))return n;for(e=G(n),t=[],u=0;u<e;++u)for(o=u+1;o<e;++o)t.push(n[o][u])}return t},V.kmeans=Mn(function(n,i,r){var t,e=3,u=fe,o=br,f=100;for(w(i)||v("kmeans");e<arguments.length;){if("Start"===arguments[e])if(w(arguments[e+1])){if($(u=arguments[e+1])!==$(i))throw"kmeans: centroids and input must have same number of columns";r=G(u)}else switch(arguments[e+1]){case"cluster":break;case"uniform":u=oe;break;case"sample":u=ue;break;default:u=fe}else if("Distance"===arguments[e])switch(arguments[e+1]){case"hamming":o=Er;break;case"correlation":o=qr;break;case"cosine":o=_r;break;case"cityblock":o=Ar;break;case"euclidean":o=yr;break;default:o=br}else"MaxIter"===arguments[e]&&(f=F.ceil(F.abs(I(En(arguments[e+1],!0)))));e+=2}return(t=function(n,r,t,e,i,u){var o,f,c,a,l=G(n),s=($(n),n.map(function(n){return te(n,t,e)[0]}));for(t=ie(n,r,s),o=1;o<=i;++o){for(f=a=0;f<l;++f)c=te(n[f],t,e)[0],s[f]!==c&&++a,s[f]=c;if(0===a)break;t=ie(n,r,s)}return[s,t]}(i,r,w(u)?u:u(i,r,o,!1),o,f,!1))[0]=t[0].map(function(n){return n+1}),1===n?t=t[0]:2<n&&(t.push(O(r,function(e){return idx.reduce(function(n,r,t){return n=r===e?nn(n,o(i[t],C[e])):n},Q)})),3<n)&&t.push(S(G(i),r,function(n,r){return o(i[n],C[r])})),t}),V.pwcdanneal=function(n,i){((i=F.round(I(En(i,!0))))<=0||!w(n)||G(n)!==$(n))&&v("pwcdanneal");for(var r=2,t=.75,e=100;r<arguments.length;)"Alpha"===arguments[r]?t=F.abs(I(En(arguments[r+1],!0))):"MaxIter"===arguments[r]&&(e=F.ceil(F.abs(I(En(arguments[r+1],!0))))),r+=2;var u=function(n,r,t,e){null==e&&(e=100),null==t&&(t=.75);for(var i,u,o,f,c,a,l,s,h,m,g,p,d,v,y,b,w=G(n),x=S(w,r,function(){return F.random()}),k=0;k<w;++k){for(l=v=0;l<r;++l)v+=x[k][l];for(l=0;l<r;++l)x[k][l]/=v}for(u=S(w,r,function(){return F.random()}),i=S(w,r,0),c=(f=I(W.sqrt(J(Lr(n,U),Lr(n,fn)))))/1e3,n=In(n),b=S(w,r,0),y=O(r,0),o=f;t<1&&c<o;){for(h=1;h<=e;++h){for(s=i,i=u,u=s,k=0;k<w;++k){for(g=x[k],p=i[k],l=v=0;l<r;++l)v+=F.exp(-p[l]/o);for(l=0;l<r;++l)g[l]=F.exp(-p[l]/o)/v}for(l=0;l<r;++l){for(a=v=0;a<w;++a)v+=x[a][l];y[l]=v}for(k=0;k<w;++k)for(g=b[k],l=0;l<r;++l){for(a=v=0;a<w;++a)v+=n[k][a]*x[a][l];g[l]=v}for(k=m=0;k<w;++k)for(g=x[k],p=u[k],l=0;l<r;++l){for(d=y[l]-g[l],a=v=0;a<w;++a)v+=x[a][l]*(n[k][a]-b[a][l]/(2*d));p[l]=v/(1+d),m=F.max(m,F.abs(p[l]-i[k][l]))}if(m<=1e-6)break}o*=t}return x}(n,i,t,e);return O(G(u),function(n){for(var r=u[n],t=0,e=1;e<i;++e)r[e]>r[t]&&(t=e);return t+1})},V.rectwin=function(n){return qn(O(n=F.round(I(En(n,!0))),function(n){return U}))},V.triang=function(r){return qn(O(r=F.round(I(En(r,!0))),1&r?function(n){return D(n+1<=(r+1)/2?2*(n+1)/(r+1):2-2*(n+1)/(r+1))}:function(n){return D(n+1<=r/2?(2*(n+1)-1)/r:2-(2*(n+1)-1)/r)}))},V.gausswin=function(r,n){r=F.round(I(En(r,!0))),n=I(En(n=null==n?2.5:n,!0));var t=(r-1)/(2*a);return t*=2*t,qn(O(r,function(n){return n-=(r-1)/2,D(F.exp(-n*n/t))}))},V.hamming=function(n,r){n=F.round(I(En(n,!0)));var t="periodic"===r?n:n-1;return qn(O(n,function(n){return D(.54-.46*F.cos(2*R*n/t))}))},V.hann=function(n,r){n=F.round(I(En(n,!0)));var t="periodic"===r?n:n-1;return qn(O(n,function(n){return D(.5*(1-F.cos(2*R*n/t)))}))},V.bartlett=function(n){var r;return 1===(n=F.round(I(En(n,!0))))?U:(r=n-1,qn(O(n,function(n){return D(n<=r/2?2*n/r:2-2*n/r)})))},V.barthannwin=function(n){var r;return 1===(n=F.round(I(En(n,!0))))?U:(r=n-1,qn(O(n,function(n){return D(.62-.48*F.abs(n/r-.5)+.38*F.cos(2*R*(n/r-.5)))})))},V.blackman=function(t,n){t=F.round(I(En(t,!0)));var n="periodic"===n?t:t-1,e=1&n?(n+1)/2:n/2;return qn(O(t,function(n,r){return n<=e-1?D(.42-.5*F.cos(2*R*n/(t-1))+.08*F.cos(4*R*n/(t-1))):r[t-1-n]}))},V.blackmanharris=function(n,r){n=F.round(I(En(n,!0)));var t="periodic"===r?n:n-1;return qn(O(n,function(n){return D(.35875-.48829*F.cos(2*R*n/t)+.14128*F.cos(4*R*n/t)-.01168*F.cos(6*R*n/t))}))},V.conv=function(n,r){return(y(n)||y(r)?cr:(n=q(n),r=q(r),b(n)&&b(r)||v("conv"),ce))(n,r)},V.deconv=Mn(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[ar(r,t),Q]:ar(r,t);else{if(r=q(r),t=q(t),b(r)&&b(t)||v("deconv"),!t.length||1===t.length&&Y(t[0],Q))throw"deconv: divisor is zero";e=ae(r,t,!0)}return 1<n?e:e[0]}),V.conv2=function(r,t){if(y(r)||y(t))return cr(r,t);if(b(r)){if(b(t))return ce(r,t);if(w(t))return O($(t),function(n){return ce(r,E(t,n))})}else{if(b(t)){if(b(r))return ce(r,t);if(w(r))return O(r[0].length,function(n){return ce(E(r,n),t)});throw"conv2: input 1 not supported"}if(!w(r))throw"conv2: input 1 not supported";if(w(t)){var n,e,i,u,o,f,c,a,l,s,h,m,g,p=r,d=t;for(G(p)<G(d)&&(g=p,p=d,d=g),n=G(p),e=$(p),o=Zr(f=n+(i=G(d))-1,c=e+(u=$(d))-1),l=0;l<f;++l)for(s=0;s<c;++s){for(a=Q,h=0;h<=l&&!(n<=h);++h)if(!(i<=l-h))for(m=0;m<=s&&!(e<=m);++m)u<=s-m||(a=nn(a,tn(p[h][m],d[l-h][s-m])));o[l][s]=a}return o}}throw"conv2: input 2 not supported"},V.filter=function(n,r,t,e,i){n=q(n),r=q(r),t=q(t),b(n)&&b(r)&&b(t)||v("filter");var u,o,f,c,a=n,l=r,s=t,h=s.length,m=l.length,g=a.length,p=new Array(h),d=l[0];for(l=l.map(function(n){return en(n,d)}),a=a.map(function(n){return en(n,d)}),u=0;u<h;++u){for(c=Q,f=u,o=0;0<=f&&o<g;++o,--f)c=nn(c,tn(a[o],s[f]));for(f=u-1,o=1;0<=f&&o<m;++o,--f)c=rn(c,tn(l[o],p[f]));p[u]=c}return p};var le={},se={};function he(n,r){for(var t,e,i=n.length,u={},o=0;o<i;++o)1!==u[o]&&(e=n[t=function(n,r){for(var t=0;1<r;)t=(t<<1)+(1&n),n>>=1,r>>=1;return t}(o,i)],r[t]=n[o],r[o]=e,u[t]=1)}function me(n,r,t){var e,i,u=n.length;if(1===u)t[0]=n[0];else{for(e=0;e<u;++e)t[e]=new A(Q,Q);for(var o,f,c,a,l,s,h=function(n){for(var r=F.sqrt(n),t=3;t<=r;){if(0==n%t)return t;t+=2}return n}(u),m=u/h,g=D(1/F.sqrt(h)),p=new Array(m),d=new Array(m),v=0;v<h;++v){for(e=0;e<m;++e)p[e]=n[e*h+v];for(1<m&&(pe(p,r,d),i=p,p=d,d=i),o=D(F.cos(2*R*v/u)),f=D((r?-1:1)*F.sin(2*R*v/u)),c=U,a=Q,e=0;e<u;++e)l=J(g,p[e%m].re),s=J(g,p[e%m].im),t[e]=t[e].add(new A(Wn(J(l,c),J(s,a)),K(J(s,c),J(l,a)))),l=Wn(J(c,o),J(a,f)),s=K(J(c,f),J(a,o)),c=l,a=s}}}function ge(n,r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d,v,y,b,w=n.length,x=1;for(he(n,t);x<w;){for(e=D((b=void 0,null==(b=se[y=x])&&(se[y]=b=F.cos(R/y)),b)),i=D((r?-1:1)*(y=void 0,null==(y=le[b=x])&&(le[b]=y=F.sin(R/b)),y)),o=w/(2*x),u=0;u<o;++u)for(l=U,s=Q,f=0;f<x;++f)g=t[h=2*u*x+f].re,p=t[h].im,c=t[m=h+x].re,a=t[m].im,d=Wn(J(l,c),J(s,a)),v=K(J(s,c),J(l,a)),t[h]=new A(J(K(g,d),z),J(K(p,v),z)),t[m]=new A(J(Wn(g,d),z),J(Wn(p,v),z)),c=Wn(J(l,e),J(s,i)),a=K(J(l,i),J(s,e)),l=c,s=a;x<<=1}}function pe(n,r,t){var e,i=n.length;if(!(i<=0))return e=!1,null==t&&(t=new Array(i),e=!0),(i&i-1?me:ge)(n,r,t),e?t:void 0}function de(n,r,t){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,o,f=!1,c=new Array(e),a=new Array(i),l=new Array(e),s=new Array(i);if(null==t){for(t=new Array(e),u=0;u<e;++u)t[u]=new Array(i);f=!0}for(o=0;o<i;++o,0){for(u=0;u<e;++u)c[u]=n[u][o];for(pe(c,r,l),u=0;u<e;++u)t[u][o]=l[u]}for(u=0;u<e;++u){for(o=0;o<i;++o,0)a[o]=t[u][o];for(pe(a,r,s),o=0;o<i;++o,0)t[u][o]=s[o]}return f?t:void 0}}function ve(n,r,t,e,i){for(var u,o,f,c,a,l=r.length,s=F.max(1,l-e),h=F.floor((t-l)/2),m=new A(Q,Q),g=new Array(t),p=new Array(t),d=lr(zr(r),B),v=s;v<l;v+=s){for(c=v;c<l;++c)d[c-v]=nn(d[c],rr(un(r[c]),B));for(c=v;c<l;++c)d[c]=nn(d[c],rr(un(r[c-v]),B))}if(r=r.map(function(n,r){return en(n,W.sqrt(on(d[r])))}),i)for(f=$(n),u=O(o=F.max(0,f*s+e),m),v=c=0;v<f;++v,c+=s){for(a=0;a<t;++a)p[a]=n[a][v],g[a]=m;for(pe(p,!0,g),a=0;a<l&&!(o<=c+a);++a)u[c+a]=nn(u[c+a],tn(r[a],g[h+a]))}else for(o=n.length,u=S(t,f=F.floor((o-e)/s),m),v=c=0;v<f;++v,c+=s){for(a=0;a<h;++a)g[a]=m,p[a]=m;for(a=0;a<l;++a)g[h+a]=c+a<o?tn(r[a],n[c+a]):m,p[h+a]=m;for(a=h+l;a<t;++a)g[a]=m,p[a]=m;for(pe(g,!1,p),a=0;a<t;++a)u[a][v]=p[a]}return u}function ye(n,r){for(var t=n.length-1,e=r.length-1,i=[];0<=t&&0<=e;)i.unshift(nn(n[t--],r[e--]));for(;0<=t;)i.unshift(n[t--]);for(;0<=e;)i.unshift(r[e--]);return i}V.fft=function(r){return w(r=q(r))?O($(r),function(n){return Ln(pe(Zn(E(r,n)),!1))}):b(r)?Ln(pe(Zn(r),!1)):void v("fft")},V.ifft=function(r){return w(r=q(r))?O($(r),function(n){return Ln(pe(Zn(E(r,n)),!0))}):b(r)?Ln(pe(Zn(r),!0)):void v("ifft")},V.fftshift=function(n,r){var t,e,i,u,o;return b(n=q(n))||w(n)?(t=n,r=y(r)?I(on(r)):null,b(t)?(e=t.length,i=F.ceil(e/2),O(e,function(n){return t[(n+i)%e]})):w(t)?(e=G(t),i=F.ceil(e/2),u=$(t),o=F.ceil(u/2),S(e,u,1===r?function(n,r){return t[(n+i)%e][r]}:2===r?function(n,r){return t[n][(r+o)%u]}:function(n,r){return t[(n+i)%e][(r+o)%u]})):t):n},V.fft2=function(n){return w(n)||v("fft2"),Ln(de(Zn(n),!1))},V.ifft2=function(n){return w(n)||v("ifft2"),Ln(de(Zn(n),!0))},V.stft=Mn(function(n,r){for(var t,e=2,i=2*R,u=null,o=null,f=null,c=null,a=null;e<arguments.length;)2===e&&y(arguments[e])?(i=I(on(arguments[e])),e+=1):"Window"===arguments[e]&&k(arguments[e+1])?(u=q(arguments[e+1]),e+=2):"OverlapLength"===arguments[e]&&y(arguments[e+1])?(o=F.round(I(on(arguments[e+1]))),e+=2):"FFTLength"===arguments[e]&&y(arguments[e+1])?(f=F.round(I(on(arguments[e+1]))),e+=2):e+=1;return null==u&&(u=q(V.hann(F.min(r.length,128),"periodic"))),null==f&&(f=F.max(128,u.length)),null==o&&(o=F.floor(.75*u.length)),w(r=q(r))?t=O($(r),function(n){return Ln(ve(Zn(E(r,n)),u,f,o,!1))}):b(r)?t=Ln(ve(Zn(r),u,f,o,!1)):v("stft"),1<n&&(c=O(f,function(n){return D(n/f*i)})),2<n&&(a=O(F.floor((r.length-o)/(u.length-o)),function(n){return D(n*F.max(1,u.length-o)/i)})),1<n?[t,c,a]:t}),V.istft=Mn(function(n,r){for(var t,e=2,i=2*R,u=null,o=null,f=null,c=null;e<arguments.length;)2===e&&y(arguments[e])?(i=I(on(arguments[e])),e+=1):"Window"===arguments[e]&&k(arguments[e+1])?(u=q(arguments[e+1]),e+=2):"OverlapLength"===arguments[e]&&y(arguments[e+1])?(o=F.round(I(on(arguments[e+1]))),e+=2):"FFTLength"===arguments[e]&&y(arguments[e+1])?(f=F.round(I(on(arguments[e+1]))),e+=2):e+=1;return null==u&&(u=q(V.hann(F.min(r.length,128),"periodic"))),null==f&&(f=F.max(128,u.length)),null==o&&(o=F.floor(.75*u.length)),w(r)&&f===G(r)?t=Ln(ve(Zn(r),u,f,o,!0)):v("istft"),1<n&&(c=O(F.floor((r.length-o)/(u.length-o)),function(n){return D(n*F.max(1,u.length-o)/i)})),1<n?[t,c]:t});var be=ce,we=ae;function xe(n,r){if(!n.length)return Q;r=r||Q;for(var t=n.length,e=0,i=n[0];e+1<t;)++e,i=nn(tn(i,r),n[e]);return i}function ke(n,r){for(var t,e,i,u=Q,o=F.min(n.length,r.length)-1,f=0;f<o;++f)t=n[f],i=n[f+1],e=r[f],u=K(u,Qn(Wn(J(t,r[f+1]),J(e,i)),B));return 1<o&&(t=n[o],i=n[0],e=r[o],u=K(u,Qn(Wn(J(t,r[0]),J(e,i)),B))),u}function Se(u,o){var f,n,r,t,e,i,c,a,l,s,h=u.length,m=O(h,function(n){return n});if(h<3)return m;for(f=0,n=1;n<h;++n)(On(o[n],o[f])||H(o[n],o[f])&&On(u[n],u[f]))&&(f=n);for(m.splice(f,1),--h,m=m.map(function(n){return[(r=u[f],t=o[f],e=u[n],i=o[n],Hn(i=W.atan2(Wn(i,t),Wn(e,r)),Q)?K(i,2*R):i),n];var r,t,e,i}).sort(function(n,r){return On(n[0],r[0])?-1:$n(n[0],r[0])?1:0}).map(function(n){return n[1]}),(r=new Array(h+1))[0]=f,r[1]=m[0],r[2]=m[1],t=3,n=2;n<h;++n){for(;1<t&&Cn(Q,(e=u[m[n]],i=o[m[n]],c=u[r[t-1]],a=o[r[t-1]],l=u[r[t-2]],s=o[r[t-2]],e=Wn(e,l),c=Wn(c,l),l=Wn(i,s),i=Wn(a,s),Wn(J(e,i),J(l,c))));)--t;r[t++]=m[n]}return r.length=t,r}function Ae(){var n,r,t,e,i=arguments,u=i.length;if(0===u)return Q;for(e=0;e<u&&H(Q,n=i[e++]););for(n=W.abs(n);e<u;){if(H(n,U))return U;for(;e<u&&H(Q,r=i[e++]););if(H(r=W.abs(r),U))return U;if(!H(r,n)){if(H(r,Q))break;for(On(n,r)&&(t=r,r=n,n=t);!H(Q,r);)r=Bn(n,t=r),n=t}}return n}function _e(n){var r,t,e,i,u=n.length,o=U,f=Q,c=Q,a=U,l=U,s=U;if(0!==u){if(r=n[0],$n(Q,r)&&(r=W.abs(r),l=M),1===u)return[r,l];if(i=2===u?[n[1],U]:_e(n.slice(1)),t=i[0],$n(Q,t)&&(t=W.abs(t),s=M),H(Q,r))return O(i.length+1,function(n){return 0===n?t:1===n?l:J(s,i[n-1])});if(H(Q,t))return O(i.length+1,function(n){return 0===n?r:1===n?l:J(s,i[n-1])});for(;;){if(e=W.floor(Qn(r,t)),r=Bn(r,t),o=Wn(o,J(e,c)),f=Wn(f,J(e,a)),H(Q,r))return c=J(c,l),a=J(a,s),O(i.length+1,function(n){return 0===n?t:1===n?c:J(a,i[n-1])});if(e=W.floor(Qn(t,r)),t=Bn(t,r),c=Wn(c,J(e,o)),a=Wn(a,J(e,f)),H(Q,t))return o=J(o,l),f=J(f,s),O(i.length+1,function(n){return 0===n?r:1===n?o:J(f,i[n-1])})}}}function qe(n,r){var t=W.abs(n);return H(t,W.abs(r))?H(n_sign(n),n_sign(r))?t:Vn(t):J(Qn(n,Ae(n,r)),r)}V.polydiv=Mn(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[ar(r,t),Q]:ar(r,t);else{if(r=q(r),t=q(t),b(r)&&b(t)||v("polydiv"),!t.length||1===t.length&&Y(t[0],Q))throw"polydiv: divisor is zero";e=we(r,t,!1)}return 1<n?e:e[0]}),V.polyval=function(r,n){return b(r=q(r))||v("polyval"),y(n)?Ln(xe(r,n)):b(n)?n.map(function(n){return Ln(xe(r,n))}):void v("polyval")},V.polyvalm=function(r,n){return b(r=q(r))||v("polyvalm"),w(n)&&G(n)===$(n)?Ln(function(n,r){if(!n.length)return Zr(G(r),$(r));for(var t=n.length,e=0,i=G(r),u=Or(i,n[0]);e+1<t;)++e,u=or(N(u,r),Or(i,n[e]));return u}(r,n)):y(n)?Ln(xe(r,n)):b(n)?n.map(function(n){return Ln(xe(r,n))}):void v("polyvalm")},V.polyfit=function(n,r,i){if(n=q(n),r=q(r),b(n)&&b(r)||v("polyfit"),n.length!==r.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return Ln(function(e,i){var n,u,o,r,t,f,c,a;if(!(b(e)&&e.length&&b(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),o=F.min(e.length,i.length),e.length=o,i.length=o,c={},a=[],u=0;u<o;++u)if(f=String(e[u]),an.call(c,f)){if(!Y(i[c[f]],i[u]))return[];a.push(u)}else c[f]=u;for(;a.length;)u=a.pop(),e.splice(u,1),i.splice(u,1);for(a=c=null,r=O(o=e.length,function(n){for(var r=U,t=0;t<o;++t)t!==n&&(r=tn(r,rn(e[n],e[t])));return r=en(i[n],r)}),t=O(o,function(n){return[U,tr(e[n])]}),n=[],u=0;u<o;++u)n=ye(n,t.reduce(function(n,r,t){return n=t!==u?be(n,r):n},[r[u]]));return n}(n,r));if(!p(i)||I(i)<0)throw"polyfit: input 3 not positive int";return i=I(i),Ln(N(It(n.reduce(function(n,r){for(var t=1,e=[U];t<=i;++t)e.unshift(tn(r,e[0]));return n.push(e),n},[])),r))},V.roots=function(n){return b(n=q(n))||v("roots"),Ln(function(r){if(r.length<=1)return[];var n,t,e,i,u,o,f,c,a,l,s,h,m,g=r.length-1,p=D(1e-10),d=new A(p,Q),v=new A(Q,Q),y=new A(U,Q);for(r=r.map(D),l=function(n){return xe(r,n)},s=function(n){return en(rn(l(nn(n,d)),l(n)),d)},n=r.map(function(n){return A(n).abs()}),o=n.length-1;0<o&&H(n[o],Q);)--o;for(e=K(Qn(Hr(n.slice(0,o))||Q,Hr([n[o],U])),U),t=Qn(n[0],Hr(K(n[0],Hr(n.slice(1))))),i=O(g,function(){return new A(K(t,J(Wn(e,t),F.random())),D(F.random()*R/2),"polar")}),a=1;a<=1e4;++a){for(o=u=0;o<g;++o){if(f=i[o],h=l(f),H((m=s(f)).re,Q)&&H(m.im,Q)){if(Cn(W.abs(h.re),p)&&Cn(W.abs(h.im),p)){++u;continue}c=new A(e,Q)}else c=h.div(m);h=c.div(y.sub(c.mul(i.reduce(function(n,r,t){return n=t===o||H(f.re,r.re)&&H(f.im,r.im)?n:n.add(f.sub(r).inv())},v)))),Cn(W.abs(h.re),p)&&Cn(W.abs(h.im),p)&&++u,i[o]=f.sub(h)}if(u===g)break}return i}(n).sort(function(n,r){return On(on(n),on(r))?-1:$n(on(n),on(r))?1:0}))},V.compan=function(n){return b(n=q(n))||v("compan"),S((t=n).length-1,t.length-1,function(n,r){return 0===n?tr(en(t[r+1],t[0])):r+1===n?U:Q});var t},V.poly=function(n){return w(n=q(n))&&V.charpoly?V.charpoly(n):(b(n)||v("poly"),Ln(n.reduce(function(n,r){return be(n,[U,tr(r)])},[U])))},V.cart2pol=Mn(function(n,r,t,e){return[V.atan2(t,r),V.sqrt(or(lr(r,B),lr(t,B))),e]},3),V.pol2cart=Mn(function(n,r,t,e){return[cr(t,V.cos(r)),cr(t,V.sin(r)),e]},3),V.cart2sph=Mn(function(n,r,t,e){var i=or(lr(r,B),lr(t,B));return[V.atan2(t,r),V.atan2(e,V.sqrt(i)),V.sqrt(or(i,lr(e,B)))]},3),V.sph2cart=Mn(function(n,r,t,e){return[cr(e,cr(V.cos(t),V.cos(r))),cr(e,cr(V.cos(t),V.sin(r))),cr(e,V.sin(t))]},3),V.polyarea=function(r,t){return r=q(r),t=q(t),w(r)&&w(t)?(G(r)===G(t)&&$(r)===$(t)||v("polyarea"),O($(r),function(n){return ke(E(r,n),E(t,n))})):b(r)&&b(t)?(r.length!==t.length&&v("polyarea"),ke(r,t)):void v("polyarea")},V.convhull=Mn(function(n,r,t,e){3<arguments.length&&v("convhull"),w(r)&&2===$(r)?(t=E(r,1),r=E(r,0)):(r=q(r),t=q(t)),b(r)&&b(t)&&r.length===t.length||v("convhull");var i=Se(r,t);return 1<n?[i.map(function(n){return n+1}),ke(i.map(function(n){return r[n]}),i.map(function(n){return t[n]}))]:i.map(function(n){return n+1})}),V.mod=function(n,t){return Y(t=En(t||0),0)?n:Tn(function(n){var r;return Z(n)?On(r=Bn(n,t),0)&&$n(t,0)?K(r,t):r:n},n,!0)},V.gcd=Mn(function(n,r,t){return function t(e,i,u){if(u){var o,f;if(k(e)){if(o=new Array(e.length),k(i))return e.length!==i.length&&v("gcd"),f=new Array(i.length),[e.map(function(n,r){return n=t(n,i[r],u),o[r]=n[1],f[r]=n[2],n[0]}),o,f];if(p(i))return f=new Array(e.length),[e.map(function(n,r){return n=t(n,i,u),o[r]=n[1],f[r]=n[2],n[0]}),o,f]}if(p(e)){if(k(i))return o=new Array(i.length),f=new Array(i.length),[i.map(function(n,r){return n=t(e,n,u),o[r]=n[1],f[r]=n[2],n[0]}),o,f];if(p(i))return _e([e,i])}}else{if(k(e)){if(k(i))return e.length!==i.length&&v("gcd"),e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(k(i))return i.map(function(n,r){return t(e,n)});if(p(i))return Ae(e,i)}}v("gcd")}(r,t,1<n)}),V.lcm=function t(e,i){if(k(e)){if(k(i))return e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(k(i))return i.map(function(n,r){return t(e,n)});if(p(i))return function(){var n,r,t=arguments,e=t.length;if(e<=1)return 1===e?t[0]:Q;if(H(Q,t[0])||H(Q,t[1]))return Q;for(r=qe(t[0],t[1]),n=2;n<e;++n){if(H(Q,t[n]))return Q;r=qe(r,t[n])}return r}(e,i)}return e};var Ee=[D(2),D(3),D(5),D(7),D(11),D(13),D(17),D(19),D(23),D(29),D(31),D(37),D(41),D(43),D(47),D(53),D(59),D(61),D(67),D(71),D(73),D(79),D(83),D(89),D(97),D(101),D(103),D(107),D(109)];function Ie(n){for(var r,t,e=1+(n.length-1);1<e--;)r=F.round(F.random()*+e),t=n[0+e],n[0+e]=n[0+r],n[0+r]=t;return n}function Ne(t){for(var n=(t=[].map.call(t,function(n){return k(n)||v("combinations"),$r(n)})).map(function(n){return n.length}),r=O(n.length,0),e=[];r&&r.length;)e.push(r.map(function(n,r){return t[r][n]})),r=function(n,r){for(var t,e=r.length-1,i=e;0<=i&&i<=e&&n[i]+1===r[+i+0];)--i;if(0<=i&&i<=e)for(n[i]=n[i]+1,t=i+1;0<=t&&t<=e;t+=1)n[t]=0;else n=null;return n}(r,n);return e}function je(n){if(_(n))return 0<n.length;if(dn(n))return!1;if(yn(n))return 0!==n;if(bn(n))return!n.eq(Q);if(u(n))return!H(n.re,Q)||!H(n.im,Q);if(k(n)){if(!n.length)return!1;for(var r=0,t=n.length;r<t;++r)if(!je(n[r]))return!1;return!0}return!0===n}L.push(function(){Ee=[D(2),D(3),D(5),D(7),D(11),D(13),D(17),D(19),D(23),D(29),D(31),D(37),D(41),D(43),D(47),D(53),D(59),D(61),D(67),D(71),D(73),D(79),D(83),D(89),D(97),D(101),D(103),D(107),D(109)]}),V.factor=function(n){for(var r,t,e=W.floor(W.abs(on(En(n)))),i=D(1e30),u=[],o=e,f=0,c=Ee.length;f<c;++f){if(H(o,r=Ee[f]))return[r];if($n(t=J(r,r),e)||null!=i&&$n(t,i))break;for(;H(Q,Bn(e,r));)u.push(r),e=Qn(e,r)}if(c<=f)for(t=J(r=K(r,B),r);Cn(t,e)&&(null==i||Cn(t,i));){for(;H(Q,Bn(e,r));)u.push(r),e=Qn(e,r);t=J(r=K(r,B),r)}return $n(e,U)&&u.push(e),u},V.randperm=function(n){return(!p(n=F.round(I(n||0)))||n<=0)&&v("randperm"),Ie(O(n,function(n){return n+1}))},V.perms=function(r){b(r=q(r))||v("perms");for(var n=O(r.length,function(n){return n}),t=[];n&&n.length;)t.push(n.map(function(n){return r[n]})),n=function(n){for(var r,t,e,i,u=n.length-1,o=u,f=o-1;0<=f&&f<=u&&+n[f]>=+n[f+1];)--f;if(0<=f&&f<=u){for(r=o;0<=r&&r<=u&&0<r-f&&+n[f]>=+n[r];)--r;for(t=n[f],n[f]=n[r],n[r]=t,e=f+1,i=o;0<=e&&e<=u&&0<=i&&i<=u&&0<i-e;)t=n[e],n[e]=n[i],n[i]=t,e+=1,--i}else n=null;return n}(n);return t},V.combinations=function(){return Ne(arguments)},V.string=function n(r){return k(r)?r.map(n):_(r)?r:String(r)},V.strlength=function(n){if(_(n))return n.length;v("strlength")},V.char=function n(r){return r=q(r),k(r)?r.map(n):_(r)?r.split(""):p(r)?String.fromCharCode(I(r)):String(r)},V.lower=V.tolower=function n(r){return k(r)?r.map(n):_(r)?r.toLowerCase():r},V.upper=V.toupper=function n(r){return k(r)?r.map(n):_(r)?r.toUpperCase():r},V.dec2bin=function n(r){return k(r)?r.map(n):yn(r)?r.toString(2):bn(r)?r.toBinary():r},V.bin2dec=function n(r){return k(r)?r.map(n):_(r)?parseInt(r,2):r},V.dec2hex=function n(r){return k(r)?r.map(n):yn(r)?r.toString(16):bn(r)?r.toHexadecimal():r},V.hex2dec=function n(r){return k(r)?r.map(n):_(r)?parseInt(r,16):r};var Te={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var r=[],t=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?t.length&&(k(t[0])?r=r.length?Cr("vert",r,t):t:r.push(t),t=[]):!mn(n,ze)&&k(n)?t=t.length?Cr("horz",t,n):n:t.push(n))}),t.length&&(k(t[0])?r=r.length?Cr("vert",r,t):t:r.length?r.push(t):r=t),r}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return V.colon(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r){return $r(n,r)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r,t){return $r(n,r,t)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return V.ctranspose(n)}},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return V.transpose(n)}},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:hr},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:lr},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,r){return At(n,r)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:ar},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:ar},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:function(n,r){return N(n=kn(n)?_n(n):n,r=kn(r)?_n(r):r)}},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:cr},"+":{name:"add",arity:2,arityalt:1,fixity:0,associativity:-1,commutativity:1,priority:25,fn:function(n,r){return 1===arguments.length?n:or(n,r)}},"-":{name:"sub",arity:2,arityalt:1,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:function(n,r){return 1===arguments.length?mr(n):fr(n,r)}},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Yn},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Jn},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Kn},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Hn},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Dn},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Y},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,r){return je(n)&&je(r)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){return je(n)||je(r)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){n=je(n),r=je(r);return n&&!r||r&&!n?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return je(n)?0:1}},"&":{name:"band",arity:2,fixity:0,associativity:-1,commutativity:1,priority:41,fn:it},"|":{name:"bor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:41,fn:ut},"=":{name:"set",breakpoint:"set",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,r){var t,e;return k(n)&&mn(n[0],ze)?(e=n,k(t=r)?await Promise.all(e.map(function(n,r){return Re(n,r<t.length?t[r]:null)})):await Promise.all(e.map(function(n,r){return Re(n,0===r?t:null)}))):Re(n,r.$scilitevarargout$?r[0]:r)}}};async function Re(n,r){if(mn(n,ze)&&_(n.v))return await n.set(r),n.get(!0);throw"setting non-variable"}async function Me(n,r,t){var e,i,u,o,f,c,a=null;if(je(await Oe(n.if.cond,r,t))){for(e=0,o=(f=n.if.statements).length;e<o;++e)null!=(c=await Oe(f[e],r,t))&&(a=c);return a}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(je(await Oe(n.elseif[i].cond,r,t))){for(e=0,o=(f=n.elseif[i].statements).length;e<o;++e)null!=(c=await Oe(f[e],r,t))&&(a=c);return a}if(n.else.statements.length){for(e=0,o=(f=n.else.statements).length;e<o;++e)null!=(c=await Oe(f[e],r,t))&&(a=c);return a}}async function Pe(n,r,t){var e,i,u,o,f,c,a,l,s=[],h=!1,m=!1,g=await Oe(n.val,r,t),p=n.statements;if(s.$scilitevarargout$=!0,k(g)){for(c=(t=t||{}).brk,a=t.cont,t.brk=function(){h=!0},t.cont=function(){m=!0},u=0,o=(l=Sn(g=q(g)))?$(g):g.length;u<o;++u){for(m=h=!1,await n.ind.set(l?E(g,u):g[u]),e=0,i=p.length;e<i&&(f=await Oe(p[e],r,t),!h&&!m);++e)null!=f&&s.push(f);if(h)break}t.brk=c,t.cont=a}return s}async function Xe(n,r,t){var e,i,u,o,f,c=[],a=!1,l=!1,s=n.statements;for(c.$scilitevarargout$=!0,o=(t=t||{}).brk,f=t.cont,t.brk=function(){a=!0},t.cont=function(){l=!0};je(await Oe(n.cond,r,t));){for(l=a=!1,e=0,i=s.length;e<i&&(u=await Oe(s[e],r,t),!a&&!l);++e)null!=u&&c.push(u);if(a)break}return t.brk=o,t.cont=f,c}function ze(n,r,t){if(!mn(this,ze))return new ze(n,r,t);this.ctx=n,this.v=r,this.i=t}async function Le(n){return mn(n,ze)?await n.get():n}function Ze(n,r){if(!mn(this,Ze))return new Ze(n,r);null==r&&(r=n,n=""),this.op=n,this.arg=r}async function Oe(n,r,t){if(mn(n,Ze))return Ce(n,r,t);if(k(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await Oe(n[e],r,t);return u}return n}function $e(v,y,b,i){var w,x=0,k=0,u=v;function S(n,r,t){null==t&&(t=k),null==r&&(r=x);var e=u.split("\n")[t];return(n=String(n)+" at line "+String((b||0)+t)+" position "+String((i||0)+r)+":")+"\n"+e+"\n"+new Array(r+1).join(" ")+"^\n"}return function i(n){var r,t,e,u,o,f,c,a=[],l=[],s=[];function h(n){var r,t,e,i,u,o,f,c;if(l.length)if(n)for(;0<l.length;){if(u=(i=l.shift())[0],n===(o=Te[u]).breakpoint){l.unshift(i);break}if(o.arity>a.length){if(!(null!=o.arityalt&&o.arityalt<=a.length))throw S('invalid or missing argument for "'+u+'"',i[1],i[2]);c=a.splice(0,o.arityalt).reverse()}else c=a.splice(0,o.arity).reverse();f=Ze(o.fn,c),a.unshift(f)}else if(t=(r=l.shift())[0],1===(e=Te[t]).fixity){if(e.arity>a.length){if(!(null!=e.arityalt&&e.arityalt<=a.length))throw S('invalid or missing argument for "'+t+'"',r[1],r[2]);c=a.splice(0,e.arityalt).reverse()}else c=a.splice(0,e.arity).reverse();f=Ze(e.fn,c),a.unshift(f)}else{if(-1!==e.fixity)for(;0<l.length&&(u=(i=l[0])[0],(o=Te[u]).priority<e.priority||o.priority===e.priority&&(o.associativity<e.associativity||o.associativity===e.associativity&&-1===o.associativity));){if(o.arity>a.length){if(!(null!=o.arityalt&&o.arityalt<=a.length))throw S('invalid or missing argument for "'+u+'"',i[1],i[2]);c=a.splice(0,o.arityalt).reverse()}else c=a.splice(0,o.arity).reverse();f=Ze(o.fn,c),a.unshift(f),l.shift()}l.unshift(r)}}function m(n){if(h(!0),1<a.length||0<l.length)throw S("mismatched terms and operators",l.length?l[0][1]:x,l.length?l[0][2]:k);!0===n&&(mn(a[0],Ze)&&s.push(a[0]),a=[],l=[])}function g(n,r){var t,e=n.test?v.match(n):n===v.slice(0,n.length);return!!e&&(!1===r?n.test?e:[n,n]:n.test?(t=e[r||0].length,v=v.slice(t),x+=t,e):(t=n.length,v=v.slice(t),x+=t,[n,n]))}function p(n,r,t){for(var e,i=t||0,u="";i<v.length;)if(n===(e=v.charAt(i))){if(!(i+1<v.length&&n===v.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return r&&(v=v.slice(i+1),x+=i+1),[u,i+1]}function d(){var n,r,t,e=function(n,r,t){for(var e,i=0,u=0;i<v.length;)if(e=v.charAt(i),!t||'"'!==e&&"'"!==e){if(r===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=p(e,!1,i+1)[1];return u||i>=v.length?-1:i}("]","[",!0);if(-1===e)throw S("mismatched brackets");if(n=v.slice(0,e),/[\[\]]/.test(n)){for(r=[];t=i(",;]");)if(r.push(t),g(","))r.push(Ze(","));else{if(!g(";"))break;r.push(Ze(";"))}g(/^\s+/),g("]")}else r=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,r){var t=n.length,e=0;return r.trim().split(-1<r.indexOf(",")?",":/\s+/g).reduce(function(n,r){return(r="~"===(r=r.trim())?Ze("v",ze(y,"")):$e(r,y,k+b,x))&&(e?n.push(Ze(",")):t&&n.push(Ze(";")),n.push(r),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,r){return(r=$e(r.trim(),y,k+b,x))&&(n.length&&n.push(Ze(",")),n.push(r)),n},[]),v=v.slice(e+1),x+=e+1,1<(n=n.split("\n")).length&&(k+=n.length-1,n.slice(0,-1).forEach(function(n){x-=n.length+1}));return Ze(Te["[]"].fn,r)}for(;0<v.length;)if(g(/^if\b/)){if(m(!0),!(c=i("\n,")))throw S('missing or invalid condition in "if"');for(g("\n")?(++k,x=0):g(","),o=(f={if:{cond:c,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((c=i(["elseif","else","end"]))&&(o.statements=o.statements.concat(c)),g("elseif")){if(!(c=i("\n,")))throw S('missing or invalid condition in "elseif"');g("\n")?(++k,x=0):g(","),f.elseif.push({cond:c,statements:[]}),o=f.elseif[f.elseif.length-1]}else if(g("else"))g(/^[ \t\v\f]+/),g("\n")?(++k,x=0):g(","),o=f.else;else if(g("end")||!c)break;s.push(Ze(Me,f))}else if(g(/^for\b/)){if(m(!0),!(r=g(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw S('missing or invalid declaration in "for"');if(!(c=i("\n,")))throw S('missing or invalid declaration in "for"');for(g("\n")?(++k,x=0):g(","),f={ind:ze(y,r[1]),val:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Ze(Pe,f))}else if(g(/^while\b/)){if(m(!0),!(c=i("\n,")))throw S('missing or invalid condition in "while"');for(g("\n")?(++k,x=0):g(","),f={cond:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Ze(Xe,f))}else if(r=g(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(r[1]))break;if("continue"===r[1])g("continue"),s.push(Ze("continue",""));else if("break"===r[1])g("break"),s.push(Ze("break",""));else{if("end"!==r[1])throw S('unexpected "'+r[1]+'"');g("end"),a.unshift(Ze("v",ze(y,"end")))}}else if(g("..."))g(/^[ \t\v\f]+/),g("\n")&&(++k,x=0);else if(g(";",!1)){if(n&&-1<n.indexOf(";"))break;g(";"),m(!0)}else if(g("\n",!1)){if(n&&-1<n.indexOf("\n"))break;g("\n"),++k,m(!(x=0))}else if(g(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(r=g("%"))w=v.indexOf("\n"),v=v.slice(-1<w?w+1:v.length),-1<w&&++k,m(!(x=0));else if(r=g("{%"))-1===(w=v.indexOf("%}"))&&(w=v.length),c=v.slice(0,w+2),v=v.slice(w+2),k+=c.split("\n").length-1,m(!(x=0));else if(r=(r=g("'"))||g('"'))o=p(r[0],!0)[0],a.unshift(Ze("'"===r[0]?o.split(""):o));else if(r=g(/^(&&|\|\||&|\|)[^&\|]/,1))u=r[1],l.unshift([u,x,k]),h();else if(r=g(/^(xor)[^a-zA-Z]/,1))u=r[1],l.unshift([u,x,k]),h();else if(r=g(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=r[1],l.unshift([u,x,k]),h();else if(r=g("~"))l.unshift(["~",x,k]),h();else if(r=g("="))l.unshift(["=",x,k]),h();else if(r=g(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=r[0],l.unshift([u,x,k]),h();else if(r=g(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(t=r[1],g(/^\s*\:\s*\)/))o=Ze("v",ze(y,t)),a.unshift(o),l.unshift(["(:)",x,k]),h();else{for(f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");o=an.call(V,t)?Ze(V[t],f):Ze("v",ze(y,t,f.length?f:null)),a.unshift(o)}g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h())}else if(r=g(/^[_a-z][_a-z0-9]*/i))t=r[0],o=an.call(V,t)&&0===V[t].length?Ze(V[t],[]):Ze("v",ze(y,t)),a.unshift(o),g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h());else if(r=g(/^(-?\s*\d+(\.\d+)?([eE][+-]?\d+)?)([ij])?/))f=r[1].split(/\s+/).join(""),f=T?T(f):parseFloat(f,10),o=Ze(r[4]?new A(0,f):f),a.unshift(o);else if(r=g(/^(-?\s*\.\d+([eE][+-]?\d+)?)([ij])?/))f="-"===(f=r[1].split(/\s+/).join("")).charAt(0)?"-0"+f.slice(1):"0"+f,f=T?T(f):parseFloat(f,10),o=Ze(r[4]?new A(0,f):f),a.unshift(o);else if("["===(e=v.charAt(0)))v=v.slice(1),x+=1,(o=d())&&(a.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw S("mismatched brackets")}if("("===e)if(v=v.slice(1),x+=1,g(/^\s*\:\s*\)/))l.unshift(["(:)",x,k]),h();else{if(a.length&&l.reduce(function(n,r){return r=Te[r[0]],n+(r.arity>a.length-n&&null!=r.arityalt?r.arityalt:r.arity)},0)<=a.length){for(h("set"),o=a.shift(),f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");f.length&&(o=Ze("v",ze(y,o,f)))}else if(o=i(")"),!g(")"))throw S("mismatched parentheses");o&&(a.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw S("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw S(n?'missing expected "'+(_(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(v=v.slice(1),c=[x+=1,k],h("set"),a.length?f=1:(f=0,a.unshift(Ze(":")));o=i(":,)\n"),g(/^[ \t\v\f]+/),o?(a.unshift(o),++f):g(":",!1)&&a.unshift(Ze(":")),g(":"););1<f&&(l.unshift([3===f?"::":":",c[0],c[1]]),h())}}return m(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function Ce(n,r,t){var e;if(mn(n,Ze)){if(""===n.op)return n.arg;if("v"===n.op)return!1===r?n.arg:mn(n.arg.v,Ze)?Le(n.arg):pn(r)&&an.call(r,n.arg.v)?r[n.arg.v]:await Le(n.arg);if(Me===n.op)return Me(n.arg,r,t);if(Pe===n.op)return Pe(n.arg,r,t);if(Xe===n.op)return Xe(n.arg,r,t);if("break"===n.op)return void(t&&gn(t.brk)&&t.brk());if("continue"===n.op)return void(t&&gn(t.cont)&&t.cont());if(Te["="].fn===n.op)return t=t||{},e=await Ce(n.arg[0],!1),k(e)&&mn(e[0],ze)&&(t.nargout=e.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[e,n.arg[1].arg.isByRef()?jn(await Ce(n.arg[1],r,t)):await Ce(n.arg[1],r,t)]):n.op.apply(null,[e].concat(await Promise.all(n.arg.slice(1).map(function(n){return Ce(n,r,t)}))));if(gn(n.op))return(t&&p(t.nargout)&&gn(n.op.nargout)?n.op.nargout(t.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return Ce(n,r,t)})))}throw"invalid expr"}return sn.op=Te,ze.prototype={constructor:ze,ctx:null,v:null,i:null,get:async function(n){var r,t,e=this;if(""===e.v)return null;if(mn(e.v,Ze))r=await Oe(e.v);else{if(!an.call(e.ctx,e.v)&&!an.call(hn,e.v))throw'undefined variable "'+e.v+'"';r=(an.call(e.ctx,e.v)?e.ctx:hn)[e.v]}return!0!==n&&null!=e.i?(t=ot(r),n=await Promise.all(e.i.map(function(n,r){return Oe(n,{end:1===e.i.length?t[0]*t[1]:t[r]})})),gr.apply(null,[r].concat(n))):r},set:async function(n){var r,t,e,i=this;if(""!==i.v)if(null!=i.i){if(mn(i.v,Ze))r=await Oe(i.v);else{if(!an.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';r=i.ctx[i.v]}t=ot(r),1===(e=await Promise.all(i.i.map(function(n,r){return Oe(n,{end:1===i.i.length?t[0]*t[1]:t[r]})}))).length&&(e=e.concat(null)),pr.apply(null,[r].concat(e).concat([n]))}else mn(i.v,Ze)||(i.ctx[i.v]=n);return i},isset:function(){return _(this.v)&&an.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},Ze.prototype={constructor:Ze,op:null,arg:null},c.createContext=function(){return{ans:null}},c.eval=async function(n,r,t){r=r||c.createContext();var e=$e(String(n),r,null==t?1:t,1),i=null,u=!1;if(k(e))for(var o=0,f=e.length;o<f;++o)e[o]&&(i=await Ce(e[o]),u=!0);else e&&(i=await Ce(e),u=!0);return u&&(k(i)||dn(i)||y(i)||_(i))&&(r.ans=i),u?i:null},sn});