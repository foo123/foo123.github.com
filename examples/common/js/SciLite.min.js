/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.6
* 2025-12-10 14:41:26
* https://github.com/foo123/SciLite
*
**/!function(r,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(r)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(r)}):n in r||(r[n]=t.call(r)||1)&&"function"==typeof define&&define.amd&&define(function(){return r[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function r(){}var t,A=null,I=null,E=Math,C={},i={},L=E.PI,e=E.E,f=1/0,l=NaN,rn=1e-15,a=Number.MAX_VALUE,tn=Number.MIN_VALUE,s=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,z=Object.prototype.hasOwnProperty,m=Object.prototype.toString,k=Array.isArray||function(n){return"[object Array]"===m.call(n)},g={VERSION:"0.9.6",_:{},fn:{},op:{},constant:{pi:L,e:e,eps:rn,realmax:a,realmin:tn,intmax:s,intmin:h,inf:f,Inf:f,nan:l,NaN:l}},c=g._,p=g.constant,N=g.fn;function w(n){throw String(n)+": input(s) not supported"}function O(n,r){return n instanceof r}function d(n){return"function"==typeof n}function v(n){return"[object Object]"===m.call(n)}function R(n){return"string"==typeof n}function en(n){return on(n)&&n.isNaN()||Number.isNaN(n)}function un(n){return on(n)&&!n.isFinite()||u(n)&&!isFinite(n)}function u(n){return"number"==typeof n}function on(n){return null!=A&&n instanceof A}function $(n){return"number"==typeof n||null!=A&&n instanceof A}function b(n){return on(n)&&n.isInt()||u(n)&&Number.isInteger(n)}function o(n){return null!=I&&n instanceof I}function S(n,r){if(u(n)||o(n)||on(n))return!0;if(!1===r){if(y(n)&&1===n.length)return!0;if(_(n)&&1===n.length&&1===n[0].length)return!0}return!1}function y(n){return k(n)&&S(n[0])}function _(n){return k(n)&&k(n[0])&&S(n[0][0])}function fn(n){return!k(n)}function cn(n){return k(n)&&!k(n[0])}function ln(n){return k(n)&&k(n[0])}function an(n){return!o(n)||B(n.im,0)}function F(n,r){for(var t=new Array(n),i=0;i<n;++i)t[i]=d(r)?r(i,t):r;return t}function j(n,r,t){for(var i,e,u=new Array(n),o=0;o<n;++o)for(u[o]=e=new Array(r),i=0;i<r;++i)e[i]=d(t)?t(o,i,u):t;return u}function sn(n,r){return $(n)?n:o(n)?r?n.re:n:y(n)&&1===n.length?sn(n[0],r):_(n)&&1===n.length&&1===n[0].length?sn(n[0][0],r):n}function hn(n){if(ln(n)){if(1===W(n))return n[0];if(1===Q(n))return n.map(function(n){return n[0]})}else if(fn(n))return[n];return n}function W(n){return n.length}function Q(n){return n[0].length}function P(r,t){return F(r.length,function(n){return r[n][t]})}function T(n){return"number"==typeof n?n:on(n)?n.$valueOf():n.valueOf()}function U(n){return null!=A&&"number"==typeof n?A(n):n}function mn(n){return k(n)?n.map(mn):S(n)?T(n):n}function gn(n){return n=k(n)?n.map(gn):n}function pn(r,n,t){if(!0===r)return n;if($(n))return r(n);if(o(n)){if(t)return r(n);if(B(n.im,0))return r(n.re)}return k(n)?n.map(function(n){return pn(r,n,t)}):n}function dn(t){function n(){var n=[].slice.call(arguments);return n.unshift(1),t.apply(null,n)}return n.nargout=function(r){return function(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),1<r&&k(n)&&(n.$scilitevarargout$=!0),n}},n}function vn(n){return en(n)?n="nan":un(n)?n=(Sn(n,0)?"-":"")+"inf":b(n)?n=String(n):$(n)?n=n.toFixed(4).replace(/\.0{4}$/,""):o(n)&&(n=String(n)),n}function yn(t){var r;return null==t?t="":R(t)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(t)&&(t="\\text{"+t+"}"):t=en(t)?"\\text{nan}":$(t)?[rn,a,tn,s,h].reduce(function(n,r){return n||B(t,r)},!1)?String(t):vn(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):o(t)?String(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):_(t)?(r=!1,Q(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,E.round(c.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-E.round(c.MAXPRINTSIZE/2)))}),r=!0),"\\begin{bmatrix}"+(t=W(t)>c.MAXPRINTSIZE?t.slice(0,E.round(c.MAXPRINTSIZE/2)).concat([F(c.MAXPRINTSIZE,function(n){return E.round(c.MAXPRINTSIZE/2)===n&&r?"\\ddots":"\\vdots"})]).concat(t.slice(1-E.round(c.MAXPRINTSIZE/2))):t).map(function(n){return n.map(yn).join(" & ")}).join(" \\\\ ")+"\\end{bmatrix}"):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,E.round(c.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(t.slice(1-E.round(c.MAXPRINTSIZE/2))):t).map(yn).join(" \\hskip 1em "):"object"==typeof t||"function"==typeof t?"":String(t),t}function wn(t){var r,i;return null==t?t="":R(t)||(t=en(t)?"nan":$(t)?([rn,a,tn,s,h].reduce(function(n,r){return n||B(t,r)},!1)?String:vn)(t):o(t)?String(t):_(t)?(r=!1,Q(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,E.round(c.MAXPRINTSIZE/2)).concat("..").concat(n.slice(1-E.round(c.MAXPRINTSIZE/2)))}),r=!0),W(t)>c.MAXPRINTSIZE&&(t=t.slice(0,E.round(c.MAXPRINTSIZE/2)).concat([F(c.MAXPRINTSIZE,function(n){return E.round(c.MAXPRINTSIZE/2)===n&&r?"\\":":"})]).concat(t.slice(1-E.round(c.MAXPRINTSIZE/2)))),i=F(Q(t),function(n){return P(t,n).reduce(function(n,r){return E.max(n,wn(r).length)},0)}),t.map(function(n,r){return"["+n.map(function(n,r){n=wn(n);return n=n.length<i[r]?new Array(i[r]-n.length+1).join(" ")+n:n}).join("  ")+"]"}).join("\n")):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,E.round(c.MAXPRINTSIZE/2)).concat([".."]).concat(t.slice(1-E.round(c.MAXPRINTSIZE/2))):t).map(wn).join("  "):"object"==typeof t||"function"==typeof t?"":String(t)),t}function bn(n){return k(n)?n.map(bn):o(n)&&B(n.im,0)?n.re:n}function xn(n){return I?k(n)?n.map(xn):$(n)?new I(n,0):n:n}function B(n,r){return u(n)?u(r)?n===r:r.eq(n):n.eq(r)}function Sn(n,r){return u(n)?u(r)?n<r:r.gt(n):n.lt(r)}function _n(n,r){return u(n)?u(r)?r<n:r.lt(n):n.gt(r)}function An(n,r){return u(n)?u(r)?n<=r:r.gte(n):n.lte(r)}function In(n,r){return u(n)?u(r)?r<=n:r.lte(n):n.gte(r)}function V(n,r){return u(n)?u(r)?n+r:r.add(n):n.add(r)}function G(n,r){return u(n)?u(r)?n-r:r.neg().add(n):n.sub(r)}function H(n,r){return u(n)?u(r)?n*r:r.mul(n):n.mul(r)}function En(n,r){return u(n)?u(r)?n/r:A(n).div(r):n.div(r)}function kn(n,r){return u(n)?u(r)?E.pow(n,r):A(n).pow(r):n.pow(r)}function Nn(n,r){return u(n)?u(r)?n%r:A(n).mod(r):n.mod(r)}function Rn(n){return u(n)?-n:n.neg()}function jn(n){return u(n)?1/n:A(1).div(n)}function M(t,i){if(R(t)){if(R(i))return t===i?1:0;if(S(i))return t===String(i)?1:0;if(y(i))return i.map(function(n){return M(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return M(t,i[n][r])})}else if($(t)){if(R(i))return String(t)===i?1:0;if($(i))return B(t,i)?1:0;if(o(i))return B(i.re,t)&&B(i.im,0)?1:0;if(y(i))return i.map(function(n){return M(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return M(t,i[n][r])})}else if(o(t)){if(R(i))return String(t)===i?1:0;if($(i))return B(t.re,i)&&B(t.im,0)?1:0;if(o(i))return B(t.re,i.re)&&B(t.im,i.im)?1:0;if(y(i))return i.map(function(n){return M(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return M(t,i[n][r])})}else if(y(t)){if(R(i)||S(i))return t.map(function(n){return M(n,i)});if(y(i)){if(t.length!==i.length)throw"eq: inputs have incompatible dimensions";return t.map(function(n,r){return M(n,i[r])})}if(_(i)){if(t.length!==Q(i))throw"eq: inputs have incompatible dimensions";return j(W(i),Q(i),function(n,r){return M(t[r],i[n][r])})}}else if(_(t)){if(R(i)||S(i))return j(W(t),Q(t),function(n,r){return M(t[n][r],i)});if(y(i)){if(Q(t)!==i.length)throw"eq: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return M(t[n][r],i[r])})}if(_(i)){if(W(t)!==W(i)||Q(t)!==Q(i))throw"eq: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return M(t[n][r],i[n][r])})}}return 0}function Pn(t,i){if(R(t)){if(R(i))return t===i?0:1;if(S(i))return t===String(i)?0:1;if(y(i))return i.map(function(n){return Pn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return Pn(t,i[n][r])})}else if($(t)){if(R(i))return String(t)===i?0:1;if($(i))return B(t,i)?0:1;if(o(i))return B(i.re,t)&&B(i.im,0)?0:1;if(y(i))return i.map(function(n){return Pn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return Pn(t,i[n][r])})}else if(o(t)){if(R(i))return String(t)===i?0:1;if($(i))return B(t.re,i)&&B(t.im,0)?0:1;if(o(i))return B(t.re,i.re)&&B(t.im,i.im)?0:1;if(y(i))return i.map(function(n){return Pn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return Pn(t,i[n][r])})}else if(y(t)){if(R(i)||S(i))return t.map(function(n){return Pn(n,i)});if(y(i)){if(t.length!==i.length)throw"ne: inputs have incompatible dimensions";return t.map(function(n,r){return Pn(n,i[r])})}if(_(i)){if(t.length!==Q(i))throw"ne: inputs have incompatible dimensions";return j(W(i),Q(i),function(n,r){return Pn(t[r],i[n][r])})}}else if(_(t)){if(R(i)||S(i))return j(W(t),Q(t),function(n,r){return Pn(t[n][r],i)});if(y(i)){if(Q(t)!==i.length)throw"ne: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return Pn(t[n][r],i[r])})}if(_(i)){if(W(t)!==W(i)||Q(t)!==Q(i))throw"ne: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return Pn(t[n][r],i[n][r])})}}return 0}function Tn(t,i){if(R(t)){if(R(i))return t<i?1:0;if(S(i))return t<String(i)?1:0;if(y(i))return i.map(function(n){return Tn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return Tn(t,i[n][r])})}else if($(t)){if(R(i))return String(t)<i?1:0;if($(i))return Sn(t,i)?1:0;if(o(i))return Sn(i.re,t)&&B(i.im,0)?1:0;if(y(i))return i.map(function(n){return Tn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return Tn(t,i[n][r])})}else if(o(t)){if(R(i))return String(t)<i?1:0;if($(i))return Sn(t.re,i)&&B(t.im,0)?1:0;if(o(i))return Sn(t.re,i.re)&&B(t.im,0)&&B(i.im,0)||Sn(t.im,i.im)&&B(t.re,0)&&B(i.re,0)?1:0;if(y(i))return i.map(function(n){return Tn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return Tn(t,i[n][r])})}else if(y(t)){if(R(i)||S(i))return t.map(function(n){return Tn(n,i)});if(y(i)){if(t.length!==i.length)throw"lt: inputs have incompatible dimensions";return t.map(function(n,r){return Tn(n,i[r])})}if(_(i)){if(t.length!==Q(i))throw"lt: inputs have incompatible dimensions";return j(W(i),Q(i),function(n,r){return Tn(t[r],i[n][r])})}}else if(_(t)){if(R(i)||S(i))return j(W(t),Q(t),function(n,r){return Tn(t[n][r],i)});if(y(i)){if(Q(t)!==i.length)throw"lt: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return Tn(t[n][r],i[r])})}if(_(i)){if(W(t)!==W(i)||Q(t)!==Q(i))throw"lt: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return Tn(t[n][r],i[n][r])})}}return 0}function Mn(t,i){if(R(t)){if(R(i))return i<t?1:0;if(S(i))return t>String(i)?1:0;if(y(i))return i.map(function(n){return Mn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return Mn(t,i[n][r])})}else if($(t)){if(R(i))return String(t)>i?1:0;if($(i))return _n(t,i)?1:0;if(o(i))return _n(i.re,t)&&B(i.im,0)?1:0;if(y(i))return i.map(function(n){return Mn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return Mn(t,i[n][r])})}else if(o(t)){if(R(i))return String(t)>i?1:0;if($(i))return _n(t.re,i)&&B(t.im,0)?1:0;if(o(i))return _n(t.re,i.re)&&B(t.im,0)&&B(i.im,0)||_n(t.im,i.im)&&B(t.re,0)&&B(i.re,0)?1:0;if(y(i))return i.map(function(n){return Mn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return Mn(t,i[n][r])})}else if(y(t)){if(R(i)||S(i))return t.map(function(n){return Mn(n,i)});if(y(i)){if(t.length!==i.length)throw"gt: inputs have incompatible dimensions";return t.map(function(n,r){return Mn(n,i[r])})}if(_(i)){if(t.length!==Q(i))throw"gt: inputs have incompatible dimensions";return j(W(i),Q(i),function(n,r){return Mn(t[r],i[n][r])})}}else if(_(t)){if(R(i)||S(i))return j(W(t),Q(t),function(n,r){return Mn(t[n][r],i)});if(y(i)){if(Q(t)!==i.length)throw"gt: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return Mn(t[n][r],i[r])})}if(_(i)){if(W(t)!==W(i)||Q(t)!==Q(i))throw"gt: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return Mn(t[n][r],i[n][r])})}}return 0}function q(t,i){if(R(t)){if(R(i))return t<=i?1:0;if(S(i))return t<=String(i)?1:0;if(y(i))return i.map(function(n){return q(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return q(t,i[n][r])})}else if($(t)){if(R(i))return String(t)<=i?1:0;if($(i))return An(t,i)?1:0;if(o(i))return An(i.re,t)&&B(i.im,0)?1:0;if(y(i))return i.map(function(n){return q(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return q(t,i[n][r])})}else if(o(t)){if(R(i))return String(t)<=i?1:0;if($(i))return An(t.re,i)&&B(t.im,0)?1:0;if(o(i))return An(t.re,i.re)&&B(t.im,0)&&B(i.im,0)||An(t.im,i.im)&&B(t.re,0)&&B(i.re,0)?1:0;if(y(i))return i.map(function(n){return q(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return q(t,i[n][r])})}else if(y(t)){if(R(i)||S(i))return t.map(function(n){return q(n,i)});if(y(i)){if(t.length!==i.length)throw"le: inputs have incompatible dimensions";return t.map(function(n,r){return q(n,i[r])})}if(_(i)){if(t.length!==Q(i))throw"le: inputs have incompatible dimensions";return j(W(i),Q(i),function(n,r){return q(t[r],i[n][r])})}}else if(_(t)){if(R(i)||S(i))return j(W(t),Q(t),function(n,r){return q(t[n][r],i)});if(y(i)){if(Q(t)!==i.length)throw"le: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return q(t[n][r],i[r])})}if(_(i)){if(W(t)!==W(i)||Q(t)!==Q(i))throw"le: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return q(t[n][r],i[n][r])})}}return 0}function qn(t,i){if(R(t)){if(R(i))return i<=t?1:0;if(S(i))return t>=String(i)?1:0;if(y(i))return i.map(function(n){return qn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return qn(t,i[n][r])})}else if($(t)){if(R(i))return String(t)>=i?1:0;if($(i))return In(t,i)?1:0;if(o(i))return In(i.re,t)&&B(i.im,0)?1:0;if(y(i))return i.map(function(n){return qn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return qn(t,i[n][r])})}else if(o(t)){if(R(i))return String(t)>=i?1:0;if($(i))return In(t.re,i)&&B(t.im,0)?1:0;if(o(i))return In(t.re,i.re)&&B(t.im,0)&&B(i.im,0)||In(t.im,i.im)&&B(t.re,0)&&B(i.re,0)?1:0;if(y(i))return i.map(function(n){return qn(t,n)});if(_(i))return j(W(i),Q(i),function(n,r){return qn(t,i[n][r])})}else if(y(t)){if(R(i)||S(i))return t.map(function(n){return qn(n,i)});if(y(i)){if(t.length!==i.length)throw"ge: inputs have incompatible dimensions";return t.map(function(n,r){return qn(n,i[r])})}if(_(i)){if(t.length!==Q(i))throw"ge: inputs have incompatible dimensions";return j(W(i),Q(i),function(n,r){return qn(t[r],i[n][r])})}}else if(_(t)){if(R(i)||S(i))return j(W(t),Q(t),function(n,r){return qn(t[n][r],i)});if(y(i)){if(Q(t)!==i.length)throw"ge: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return qn(t[n][r],i[r])})}if(_(i)){if(W(t)!==W(i)||Q(t)!==Q(i))throw"ge: inputs have incompatible dimensions";return j(W(t),Q(t),function(n,r){return qn(t[n][r],i[n][r])})}}return 0}function Xn(n){return o(n)?n.sign():C.sign(n)}function D(n,r){return $(n)&&$(r)?V(n,r):o(n)&&S(r)?n.add(r):o(r)&&S(n)?r.add(n):l}function Zn(n,r){return $(n)&&$(r)?G(n,r):o(n)&&S(r)?n.sub(r):o(r)&&S(n)?r.neg().add(n):l}function J(n,r){return $(n)&&$(r)?H(n,r):o(n)&&S(r)?n.mul(r):o(r)&&S(n)?r.mul(n):l}function K(n,r){return $(n)&&$(r)?En(n,r):o(n)&&S(r)?n.div(r):o(r)&&S(n)?r.inv().mul(n):l}function Ln(n,r){return $(n)&&$(r)?kn(n,r):o(n)&&S(r)?n.pow(r):o(r)&&S(n)?new I(n,0).pow(r):l}function zn(n){return $(n)?Rn(n):o(n)?n.neg():l}function Y(n){return $(n)?n:o(n)?n.conj():l}function On(n){return $(n)?B(n,0)?f:jn(n):o(n)?B(n.abs(),0)?new I(f,Sn(n.im,0)?f:-f):n.inv():l}function nn(n){return $(n)?C.abs(n):o(n)?n.abs():l}function Cn(n){return $(n)?Sn(n,0)?L:0:o(n)?n.angle():l}function $n(r,i){if(R(r)&&R(i))return r+i;if(S(r)&&S(i))return D(r,i);if(_(r)&&_(i)){if(W(r)===W(i)&&Q(r)===Q(i))return r.map(function(n,t){return n.map(function(n,r){return $n(n,i[t][r])})});throw"add: matrix dimensions do not match"}if(y(r)&&y(i)){if(r.length===i.length)return r.map(function(n,r){return $n(n,i[r])});throw"add: vector dimensions do not match"}return k(r)?r.map(function(n){return $n(n,i)}):k(i)?i.map(function(n){return $n(r,n)}):void w("add")}function Fn(r,i){if(S(r)&&S(i))return Zn(r,i);if(_(r)&&_(i)){if(W(r)===W(i)&&Q(r)===Q(i))return r.map(function(n,t){return n.map(function(n,r){return Fn(n,i[t][r])})});throw"sub: matrix dimensions do not match"}if(y(r)&&y(i)){if(r.length===i.length)return r.map(function(n,r){return Fn(n,i[r])});throw"sub: vector dimensions do not match"}return k(r)?r.map(function(n){return Fn(n,i)}):k(i)?i.map(function(n){return Fn(r,n)}):void w("sub")}function Wn(r,i){if(S(r)&&S(i))return J(r,i);if(_(r)&&_(i)){if(W(r)===W(i)&&Q(r)===Q(i))return r.map(function(n,t){return n.map(function(n,r){return Wn(n,i[t][r])})});throw"dotmul: matrix dimensions do not match"}if(y(r)&&y(i)){if(r.length===i.length)return r.map(function(n,r){return Wn(n,i[r])});throw"dotmul: vector dimensions do not match"}return k(r)?r.map(function(n){return Wn(n,i)}):k(i)?i.map(function(n){return Wn(r,n)}):void w("dotmul")}function Qn(r,i){if(S(r)&&S(i))return K(r,i);if(_(r)&&_(i)){if(W(r)===W(i)&&Q(r)===Q(i))return r.map(function(n,t){return n.map(function(n,r){return Qn(n,i[t][r])})});throw"dotdiv: matrix dimensions do not match"}if(y(r)&&y(i)){if(r.length===i.length)return r.map(function(n,r){return Qn(n,i[r])});throw"dotdiv: vector dimensions do not match"}return k(r)?r.map(function(n){return Qn(n,i)}):k(i)?i.map(function(n){return Qn(r,n)}):void w("dotdiv")}function Un(r,i){if(S(r)&&S(i))return Ln(r,i);if(_(r)&&_(i)){if(W(r)===W(i)&&Q(r)===Q(i))return r.map(function(n,t){return n.map(function(n,r){return Un(n,i[t][r])})});throw"dotpow: matrix dimensions do not match"}if(y(r)&&y(i)){if(r.length===i.length)return r.map(function(n,r){return Un(n,i[r])});throw"dotpow: vector dimensions do not match"}return k(r)?r.map(function(n){return Un(n,i)}):k(i)?i.map(function(n){return Un(r,n)}):void w("dotpow")}function X(e,u){if(S(e)&&S(u))return J(e,u);if(_(e)&&_(u)){if(Q(e)===W(u))return n=W(e),r=Q(u),o=W(u),j(n,r,function(n,r){for(var t=0,i=0;i<o;++i)t=D(t,J(e[n][i],u[i][r]));return t});throw"mul: matrix-matrix dimensions do not match"}if(y(e)&&_(u)){if(e.length===W(u))return r=Q(u),o=e.length,j(n=1,r,function(n,r){for(var t=0,i=0;i<o;++i)t=D(t,J(e[i],u[i][r]));return t});throw"mul: vector-matrix dimensions do not match"}if(_(e)&&y(u)){var o;if(Q(e)===u.length)return n=W(e),o=u.length,j(n,r=1,function(n,r){for(var t=0,i=0;i<o;++i)t=D(t,J(e[n][i],u[i]));return t});throw"mul: matrix-vector dimensions do not match"}var n,r;return y(e)&&y(u)?j(n=e.length,r=u.length,function(n,r){return J(e[n],u[r])}):k(e)?e.map(function(n){return X(n,u)}):k(u)?u.map(function(n){return X(e,n)}):void w("mul")}function Bn(n,r){if(S(n)&&S(r))return Ln(n,r);if(_(n)&&W(n)===Q(n)&&b(r)){if((r=T(r))<0&&(r=-r,!(n=zr(n))||!n.length))throw"pow: no inverse";if(0===r)return ur(W(n));if(1===r)return n;if(2===r)return X(n,n);for(var t=ur(W(n));0!==r;)1&r&&(t=X(t,n)),0<(r>>=1)&&(n=X(n,n));return t}w("pow")}function Vn(i,n=":",t=null){if(cn(i)){if(y(n)&&n.length===i.length&&Ir(n,function(n){return 0===T(n)||1===T(n)}))return o=1===(o=n.reduce(function(n,r,t){return 1===T(r)&&n.push(i[t]),n},[])).length?o[0]:o;if(":"===(n=S(n)?sn(n,!0):n)||b(n)||y(n))return r=i.length,1===(o=(n=b(n=":"===n?or(1,r):n)?[n]:n).map(function(n){if((n=T(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return i[n-1]})).length?o[0]:o;throw"get: invalid range"}if(ln(i)){var e=W(i),u=Q(i),r=e*u;if(null==t&&_(n)&&W(n)===e&&Q(n)===u&&Ir(n,function(n){return 0===T(n)||1===T(n)})){for(var o=[],f=0;f<u;++f)for(var c=0;c<e;++c)1===T(n[c][f])&&o.push(i[c][f]);return o=1===o.length?o[0]:o}if(S(n)&&(n=sn(n,!0)),S(t)&&(t=sn(t,!0)),":"===n||b(n)||y(n)){if(b(n=":"===n?or(1,e):n)&&(n=[n]),null==t)return o=1===(o=n.map(function(n){if((n=T(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return i[(n-1)%e][E.floor((n-1)/e)]})).length?o[0]:o;if(":"===t||b(t)||y(t))return b(t=":"===t?or(1,u):t)&&(t=[t]),o=1===(o=n.map(function(r){if((r=T(r))<1&&(r+=e),r<1||e<r)throw"get: index out of bounds";return t.map(function(n){if((n=T(n))<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return i[r-1][n-1]})})).length&&1===o[0].length?o[0][0]:o}throw"get: invalid range"}return i}function Gn(e,r=":",n=null,u=null){if(cn(e)){if(y(r)&&r.length===e.length&&Ir(r,function(n){return 0===T(n)||1===T(n)})){if(fn(u))return r.forEach(function(n,r){1===T(n)&&(e[r]=u)}),e;if(k(u))return i=0,r.forEach(function(n,r){if(1===T(n)){if(i>=u.length)throw"set: index out of bounds";e[r]=u[i++]}}),e}if(":"===(r=S(r)?sn(r,!0):r)||b(r)||y(r)){var t=e.length;if(b(r=":"===r?or(1,t):r)&&(r=[r]),fn(u))return r.forEach(function(n){if((n=T(n))<1&&(n+=t),n<1||t<n)throw"set: index out of bounds";e[n-1]=u}),e;if(k(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=T(n))<1&&(n+=t),n<1||t<n)throw"set: index out of bounds";e[n-1]=u[r]}),e;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(ln(e)){var o=W(e),f=Q(e),t=o*f;if(_(r)&&W(r)===o&&Q(r)===f&&Ir(r,function(n){return 0===T(n)||1===T(n)})){if(fn(u))return r.forEach(function(n,t){n.forEach(function(n,r){1===T(n)&&(e[t][r]=u)})}),e;if(k(u)){for(var i=0,c=0;c<f;++c)for(var l=0;l<o;++l)if(1===T(r[l][c])){if(i>=u.length)throw"set: index out of bounds";e[l][c]=u[i++]}return e}}if(S(r)&&(r=sn(r,!0)),S(n)&&(n=sn(n,!0)),":"===r||b(r)||y(r)){if(null==n){if(b(r=":"===r?or(1,t):r)&&(r=[r]),fn(u))return r.forEach(function(n){if((n=T(n))<1&&(n+=t),n<1||t<n)throw"set: index out of bounds";e[(n-1)%o][E.floor((n-1)/o)]=u}),e;if(cn(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=T(n))<1&&(n+=t),n<1||t<n)throw"set: index out of bounds";e[(n-1)%o][E.floor((n-1)/o)]=u[r]}),e}else if(":"===n||b(n)||y(n)){if(b(r=":"===r?or(1,o):r)&&(r=[r]),b(n=":"===n?or(1,f):n)&&(n=[n]),fn(u))return r.forEach(function(r){if((r=T(r))<1&&(r+=o),r<1||o<r)throw"set: index out of bounds";n.forEach(function(n){if((n=T(n))<1&&(n+=f),n<1||f<n)throw"set: index out of bounds";e[r-1][n-1]=u})}),e;if(cn(u)&&u.length>=r.length*n.length)return i=0,n.forEach(function(t,n){if((t=T(t))<1&&(t+=f),t<1||f<t)throw"set: index out of bounds";r.forEach(function(n,r){if((n=T(n))<1&&(n+=o),n<1||o<n)throw"set: index out of bounds";e[n-1][t-1]=u[i++]})}),e;if(ln(u)&&u.length>=r.length&&u[0].length>=n.length)return r.forEach(function(t,i){if((t=T(t))<1&&(t+=o),t<1||o<t)throw"set: index out of bounds";n.forEach(function(n,r){if((n=T(n))<1&&(n+=f),n<1||f<n)throw"set: index out of bounds";e[t-1][n-1]=u[i][r]})}),e}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return e}function Hn(n,r){var t,i,e;return u(n)&&u(r)?(t=n,i=r,t=E.abs(t),i=E.abs(i),(e=0)===t?i:0===i?t:i<t?t*E.sqrt(1+(e=i/t)*e):t<i?i*E.sqrt(1+(e=t/i)*e):t*E.SQRT2):C.sqrt(V(H(n,n),H(r,r)))}function Dn(n,r){var t,n=1===arguments.length?n:Fn(n,r);return n.reduce(function(n,r){return n&&(u(r)||o(r)&&u(r.re)&&u(r.im))},!0)?(t=0,r=(r=n).map(function(n){return n=nn(n),t<n&&(t=n),n}),0===t?0:t*E.sqrt(r.reduce(function(n,r){return r===t?n+1:n+(n=r/t)*n},0))):C.sqrt(Yn(wr(n,n)))}function Jn(){var n,r,t,i=0,e=0;if(u(Jn.z1))return t=Jn.z1,Jn.z1=null,t;for(;0===i||1===i;)i=E.random();for(;0===e||1===e;)e=E.random();return r=(n=E.sqrt(-2*E.log(i)))*E.cos(2*L*e),t=n*E.sin(2*L*e),Jn.z1=t,r}function Kn(){if(!O(this,Kn))return new Kn;this.data=[]}function Yn(n){return pn(function(n){return o(n)?n.re:n},n,!0)}function nr(n){return pn(function(n){return o(n)?n.im:0},n,!0)}function rr(n){return pn(Y,n,!0)}function tr(n){return pn(nn,n,!0)}function ir(n,r){if(un(r=null==r?2:r)){if(S(n))return nn(n);if(y(n))return(Sn(r,0)?pr:dr)(tr(n));if(_(n)&&_n(r,0))return dr(vr(tr(cr(n))))}else if($(r)){if(B(r,1)){if(S(n))return nn(n);if(y(n))return vr(tr(n));if(_(n))return dr(vr(tr(n)))}else if(B(r,2)){if(S(n))return nn(n);if(y(n))return Dn(n);if(_(n))return dr(Gr(n,null,!1,!1))}else if(_n(r,0)){if(S(n))return nn(n);if(y(n))return function(n,r,t){return 2===arguments.length&&(t=r),kn(vr(Un(tr(2===arguments.length?n:Fn(n,r)),t)),jn(t))}(n,r)}}else if("fro"===r&&_(n))return C.sqrt(Cr(Yn(X(lr(n),n))));w("norm")}function er(n,r){return y(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),j(T(n),T(r),U(0))}function ur(n){n=sn(n=null==n?1:n,!0);var t=U(1),i=U(0);return j(T(n),T(n),function(n,r){return n===r?t:i})}function or(n,r,t){if(1===arguments.length){if(ln(n)){for(var i,e=W(n),u=Q(n),o=new Array(u*e),f=0,c=0;c<u;++c)for(i=0;i<e;++i)o[f++]=n[i][c];return o}return n}if(null!=t&&null!=r||(null!=r?(t=r,r=1):(t=n,n=r=1)),n=sn(n,!0),r=sn(r,!0),t=sn(t,!0),o=[],_n(r,0))for(;An(n,t);n=V(n,r))o.push(n);else if(Sn(r,0))for(;In(n,t);n=V(n,r))o.push(n);return o}function fr(n,r,t){return"horz"===n&&ln(r)&&ln(t)&&W(r)===W(t)?r.map(function(n,r){return n.concat(t[r])}):"vert"===n&&ln(r)&&ln(t)&&Q(r)===Q(t)?r.concat(t):void w("cat")}function cr(t){return ln(t)?j(Q(t),W(t),function(n,r){return t[r][n]}):t}function lr(t){return ln(t)?j(Q(t),W(t),function(n,r){return S(t[r][n])?Y(t[r][n]):t[r][n]}):cn(t)?t.map(function(n){return S(n)?Y(n):n}):S(t)?Y(t):t}function ar(t,e){return e=T(e||0),fn(t)?[[t]]:cn(t)?j(t.length,t.length,function(n,r){return e===n-r?t[n]:0}):ln(t)?t.reduce(function(n,r,i){return r.reduce(function(n,r,t){return e===i-t&&n.push(r),n},n)},[]):void w("diag")}function sr(t,n){var i,e;return fn(t)?t:cn(t)?t.slice().reverse():ln(t)?(i=W(t),e=Q(t),1===(n=T(n=null==n?1:n))?j(i,e,function(n,r){return t[i-1-n][r]}):2===n?j(i,e,function(n,r){return t[n][e-1-r]}):t):void w("flip")}function hr(n,r){var t=Yn(n),i=Yn(r),n=nr(n),r=nr(r),t=Sn(t,i)?-1:_n(t,i)?1:0,i=Sn(n,r)?-1:_n(n,r)?1:0;return t||i}function mr(n,r){var t=nn(n),i=nn(r),n=Cn(n),r=Cn(r),t=Sn(t,i)?-1:_n(t,i)?1:0,i=Sn(n,r)?-1:_n(n,r)?1:0;return t||i}function gr(r,t,i,e,n){var u;if(fn(r))return r;if(y(r))return null==e&&(e=an(r)?hr:mr),u=r.map(function(n,r){return{v:n,i:r}}).sort("descend"===i?function(n,r){return e(r.v,n.v)||n.i-r.i}:function(n,r){return e(n.v,r.v)||n.i-r.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(_(r)){if(1===t)return n?(u=F(Q(r),function(n){n=P(r,n);return gr(n,t,i,null==e?an(n)?hr:mr:e,!0)}),[j(W(r),Q(r),function(n,r){return u[r][0][n]}),j(W(r),Q(r),function(n,r){return u[r][1][n]})]):(u=F(Q(r),function(n){n=P(r,n);return gr(n,t,i,null==e?an(n)?hr:mr:e,!1)}),j(W(r),Q(r),function(n,r){return u[r][n]}));if(2===t)return n?(u=F(W(r),function(n){n=r[n];return gr(n,t,i,null==e?an(n)?hr:mr:e,!0)}),[j(W(r),Q(r),function(n,r){return u[n][0][r]}),j(W(r),Q(r),function(n,r){return u[n][1][r]})]):(u=F(W(r),function(n){n=r[n];return gr(n,t,i,null==e?an(n)?hr:mr:e,!1)}),j(W(r),Q(r),function(n,r){return u[n][r]}))}w("sort")}function pr(r){return S(r)?r:y(r)?r.reduce(function(n,r){return n=Sn(r,n)?r:n},f):_(r)?F(Q(r),function(n){return pr(P(r,n))}):0}function dr(r){return S(r)?r:y(r)?r.reduce(function(n,r){return n=_n(r,n)?r:n},-f):_(r)?F(Q(r),function(n){return dr(P(r,n))}):0}function vr(r){return S(r)?r:y(r)?r.reduce(D,U(0)):_(r)?F(Q(r),function(n){return vr(P(r,n))}):l}function yr(r){return S(r)?r:y(r)?r.reduce(J,U(1)):_(r)?F(Q(r),function(n){return yr(P(r,n))}):l}function wr(r,i,e){if(e=!0===e,S(r)&&S(i))return J(r,e?i:Y(i));if(y(r)&&y(i)){if(r.length===i.length)return r.reduce(function(n,r,t){return D(n,J(r,e?i[t]:Y(i[t])))},0)}else if(_(r)&&_(i)&&W(r)===W(i)&&Q(r)===Q(i))return F(Q(r),function(n){return wr(P(r,n),P(i,n),e)});return 0}function br(r,t,i,e){var u;if(S(r))return r;if(y(r)){if("reverse"===(i=null==i?"forward":i))return r.slice().reverse().map(function(n,r){return u=0===r?n:t(u,n),acc}).reverse();if("forward"===i)return r.map(function(n,r){return u=0===r?n:t(u,n)})}else if(_(r)){if(1===(e=T(e=null==e?1:e)))return F(Q(r),function(n){return br(P(r,n),t,i,e)});if(2===e)return F(W(r),function(n){return br(r[n],t,i,e)})}return!1}function xr(r,t,i,e,u){var o;if(y(r))return F(o=r.length,function(n){return t(r.slice(E.max(0,n-i),E.min(o-1,n+e)+1))});if(_(r)){if(1===(u=T(u=null==u?1:u)))return F(Q(r),function(n){return xr(P(r,n),t,i,e,u)});if(2===u)return F(W(r),function(n){return xr(r[n],t,i,e,u)})}return!1}function Sr(r){var n=[].slice.call(arguments,1);return k(n[0])&&(n=n[0]),fn(r)?n.length?n.map(function(n){return[1,1][T(n)-1]}):[1,1]:cn(r)?n.length?n.map(function(n){return[1,r.length][T(n)-1]}):[1,r.length]:ln(r)?n.length?n.map(function(n){return[W(r),Q(r)][T(n)-1]}):[W(r),Q(r)]:[]}function _r(n){return k(n)?E.max.apply(null,Sr(n)):null==n?0:1}function Ar(n,e){var u;return y(n)?n.reduce(function(n,r,t){return e(r,t+1,1)&&n.push(t+1),n},[]):_(n)?(u=W(n),n.reduce(function(n,r,i){return r.reduce(function(n,r,t){return e(r,i+1,t+1)&&n.push(i+u*t+1),n},n)},[])):[]}function Ir(n,r){if(S(n))return r(n,1,1)?1:0;if(y(n)){for(var t=0,i=n.length;t<i;++t)if(!r(n[t],t+1,1))return 0;return 1}if(_(n)){for(var t=0,e=W(n),u=Q(n);t<e;++t)for(var o=0;o<u;++o)if(!r(n[t][o],t+1,o+1))return 0;return 1}return 0}function Er(n,r){if(S(n))return r(n,1,1)?1:0;if(y(n)){for(var t=0,i=n.length;t<i;++t)if(r(n[t],t+1,1))return 1}else if(_(n))for(var t=0,e=W(n),u=Q(n);t<e;++t)for(var o=0;o<u;++o)if(r(n[t][o],t+1,o+1))return 1;return 0}function kr(n,r,t){var i;r!==t&&(i=n[r],n[r]=n[t],n[t]=i)}function Nr(n,r,t,i,e,u){var o,f=n[0].length;for(null==i&&(i=1),null==e&&(e=1),o=u||0;o<f;++o)n[r][o]=D(J(e,n[r][o]),J(i,n[t][o]))}function Rr(n,t){return S(t)?S(n)?M(n,t):n.filter(function(n){return Rr(n,t)}).length===n.length:!!k(t)&&(S(n)?Rr(t,n):n.length===t.length&&n.filter(function(n,r){return Rr(n,t[r])}).length===t.length)}function jr(t,i,e,n,r){var u=W(t),o=Q(t);return u&&o?k(i)&&k(e)?(i=i.filter(function(n){return 0<=n&&n<u}),e=e.filter(function(n){return 0<=n&&n<o}),j(i.length,e.length,function(n,r){return t[i[n]][e[r]]})):((i=null==i?0:i)<0&&(i+=u),(e=null==e?0:e)<0&&(e+=o),(n=null==n?u-1:n)<0&&(n+=u),(r=null==r?o-1:r)<0&&(r+=o),i=E.max(0,E.min(u-1,i)),n=E.max(0,E.min(u-1,n)),e=E.max(0,E.min(o-1,e)),r=E.max(0,E.min(o-1,r)),i<=n&&e<=r?j(n-i+1,r-e+1,function(n,r){return t[i+n][e+r]}):[]):[]}function Pr(t,i,n){var e=W(t),u=Q(t),o=W(i),f=Q(i);return"vert"===(n=n||"horz")?j(e+o,E.max(u,f),function(n,r){return u<=r?n<e?0:i[n-e][r]:f<=r?n<e?t[n][r]:0:(n<e?t[n]:i[n-e])[r]}):j(E.max(e,o),u+f,function(n,r){return e<=n?r<u?0:i[n][r-u]:o<=n?r<u?t[n][r]:0:r<u?t[n][r]:i[n][r-u]})}function Tr(n,r,t,i){var e,u,o,f=W(n),c=Q(n);if(!1===t||f===c){for(i=U(i||0),e=E.min(f,c),u=0;u<e;++u){if("lower"===r||"diagonal"===r)for(o=u+1;o<e;++o)if(!q(nn(n[u][o]),i))return;if("upper"===r||"diagonal"===r)for(o=0;o<u;++o)if(!q(nn(n[u][o]),i))return}if(c<f){for(u=e;u<f;++u)for(o=0;o<c;++o)if(!q(nn(n[u][o]),i))return}else if(f<c)for(o=e;o<c;++o)for(u=0;u<f;++u)if(!q(nn(n[u][o]),i))return;return 1}}function Mr(n,r){var t,i,e;return M(r,0)?(t=U(1),i=U(0)):M(n,0)?(t=U(0),M(i=Xn(Y(r)),0)&&(i=U(1))):(e=Xn(n),t=K(n=nn(n),n=Hn(n,nn(r))),i=K(J(e,Y(r)),n)),[t,i]}function qr(n,r,t,i,e){var u,o,f,c,l,a=W(e),s=gn(e);if("right"===n)for(l=2===r.length&&S(r[0])?(o=r[0],f=zn(r[1]),c=r[1],r[0]):(o=r[t][t],f=r[t][i],c=r[i][t],r[i][i]),u=0;u<a;++u)s[u][t]=D(J(o,e[u][t]),J(c,e[u][i])),s[u][i]=D(J(f,e[u][t]),J(l,e[u][i]));else for(l=2===r.length&&S(r[0])?(o=r[0],f=zn(r[1]),c=r[1],r[0]):(o=r[t][t],f=r[t][i],c=r[i][t],r[i][i]),u=0;u<a;++u)s[t][u]=D(J(o,e[t][u]),J(f,e[i][u])),s[i][u]=D(J(c,e[t][u]),J(l,e[i][u]));return s}function Xr(n,r,t,i){var e,u,o,f,c,l,a,s,h,m,g,p,d,v,y=W(n),w=Q(n),b=w,x=0,S=U(0),_=U(1),A=U(-1);for(i=U(i||0),k(t)&&(b=E.min(b,t[1])),d=Pr(n,ur(y)),e=new Array(b),u=_,v=function(n,r){r=r||0;for(var t=x-1;0<=t;--t)if(n===e[t][r])return t;return-1},o=a=0;o<y&&!(b<=a);++o){for(f=o;q(nn(d[f][a]),i);)if(y<=++f&&(f=o,b<=++a)){a=-1;break}if(-1===a)break;for(s=-1,m=null,p=0,f=c=f;f<y;++f)q(g=nn(d[f][a]),i)?++p:null!=m&&!Tn(g,m)||(m=g,s=f);for(;;){if(-1===s)break;if(y-c===p+1){for(o!==s&&(kr(d,o,s),u=zn(u)),Tn(d[o][a],S)&&(Nr(d,o,o,S,A,a),u=zn(u)),f=s,c=o;0<=f&&-1!==(l=v(f));)f=c-=x-l;e[x++]=[f,a],u=o<b?J(u,d[o][o]):S;break}for(p=0,h=s,f=c;f<y;++f)f!==h&&(Nr(d,f,h,zn(K(d[f][a],d[h][a])),1,a),q(g=nn(d[f][a]),i)?++p:Tn(g,m)&&(m=g,s=f))}++a}return x<b&&(u=S),t=jr(d,0,w,y-1,y+w-1),d=jr(d,0,0,y-1,w-1),e.length>x&&(e.length=x),r?[d,e,u,t]:d}function Zr(n,r,t,i){var e,u,o,f,c,l,a=W(n),s=Q(n),h=s,m=U(0),g=U(1);for(i=U(i||0),k(t)&&E.min(h,t[1]),l=Pr((h=Xr(n,!0,t,i))[0],h[3]),e=h[1],n=h[2],u=e.length,f=0;f<u;++f)for(o=e[f][1],c=0;c<f;++c)q(nn(l[c][o]),i)||(Nr(l,c,f,zn(l[c][o]),l[f][o]),M(l[c][e[c][1]],g))||Nr(l,c,c,m,On(l[c][e[c][1]]),e[c][1]);return M(l[u-1][e[u-1][1]],g)||Nr(l,u-1,u-1,m,On(l[u-1][e[u-1][1]]),e[u-1][1]),t=jr(l,0,s,a-1,a+s-1),l=jr(l,0,0,a-1,s-1),r?[l,e,n,t]:l}function Lr(n,r,t){if(S(n)&&S(r))return K(r,n);if(!_(n))return[];if(!y(r)&&!_(r))return[];var i,e=Q(n);if(W(n)!==e)return[];if(i=y(r)?(h=r.length,1):(h=W(r),Q(r)),e!==h)return[];var u,o,f,c,l,a,s,h=Xr(cr(n),!0),n=h[1].length,m=U(0);if(n!==e)return[];if(u=cr(h[3]),o=cr(h[0]),y(r)){for(f=F(e,m),c=0;c<e;++c){if(M(o[c][c],0))return[];for(s=m,l=0;l<c;++l)s=D(s,J(o[c][l],f[l]));f[c]=K(Zn(r[c],s),o[c][c])}return F(e,function(r){return F(e,function(n){return J(f[n],u[r][n])}).reduce(D,m)})}for(f=er(e,i),c=0;c<e;++c){if(M(o[c][c],m))return[];for(a=0;a<i;++a){for(s=m,l=0;l<c;++l)s=D(s,J(o[c][l],f[l][a]));f[c][a]=K(Zn(r[c][a],s),o[c][c])}}return j(e,i,function(r,t){return F(e,function(n){return J(f[n][t],u[r][n])}).reduce(D,m)})}function zr(n){var r,t,i;return S(n)?On(n):_(n)&&W(n)===Q(n)?1===(t=r=W(n))?[[On(n[0][0])]]:M((i=Zr(n,!0))[0][r-1][t-1],0)?[]:i[3].map(function(n,r){return n.map(function(n){return K(n,i[0][r][r])})}):[]}function Or(t,n){var i,r,e,u,o,f,c,l;return S(t)?On(t):_(t)?(c=W(t),u=Q(t),Rr(t,0)?cr(t):1===c&&1===u?[[On(t[0][0])]]:1===c||1===u?(e=t.reduce(function(n,r){return D(n,J(r,Y(r)))},U(0)),j(u,c,function(n,r){return K(Y(t[r][n]),e)})):(n=(i=Zr(t,!0,null,n||0))[1].length)===u?c===u?i[3].map(function(n,r){return n.map(function(n){return K(n,i[0][r][r])})}):X(zr(X(r=lr(t),t)),r):n===c?X(r=lr(t),zr(X(t,r))):(o=i,n=W(u=t),l=Q(u),o=o||Zr(u,!0),c=(f=o[1]).length,u=[jr(u,F(n,function(n){return n}),F(c,function(n){return f[n][1]})),jr(o[0],0,0,c-1,l-1).map(function(n,t){return n.map(function(n,r){for(r=t;r+1<l&&M(o[0][t][r],0);)++r;return K(n,o[0][t][r])})})],e=X(zr(X(r=lr(e=u[0]),e)),r),n=X(r=lr(n=u[1]),zr(X(n,r))),X(n,e))):[]}function Cr(i){return S(i)?i:_(i)?i.reduce(function(n,r,t){return D(n,t<r.length?i[t][t]:0)},0):void w("trace")}function $r(i,n,r){r=U(r||0);var t=W(i);return t!==Q(i)?0:1===t?i[0][0]:Tr(i,"lower",!0,r)||Tr(i,"upper",!0,r)?i.reduce(function(n,r,t){return J(n,i[t][t])},1):!0===n?function n(r,t,i,e,u){var o,f,c,l,a,s,h,m,g,p,d,v,y,w;function b(t,n,i,e){return j(n-1,n-1,function(n,r){return i<=n&&++n,e<=r&&++r,t[n][r]})}if(1===t)a=r[0][0];else if(2===t)s=r[0][0],h=r[0][1],m=r[1][0],a=Zn(J(s,g=r[1][1]),J(h,m));else if(3===t)s=r[0][0],h=r[0][1],m=r[0][2],g=r[1][0],p=r[1][1],d=r[1][2],v=r[2][0],y=r[2][1],w=r[2][2],a=Zn(Zn(Zn(D(D(J(J(s,p),w),J(J(h,d),v)),J(J(m,g),y)),J(J(m,p),v)),J(J(h,g),w)),J(J(s,d),y));else{for(o=c=f=0;o<t;++o)M(r[0][o],i)&&++f,M(r[o][0],i)&&++c;if(l=e,a=i,f<c)for(o=0;o<t;++o)M(r[o][0],i)||(a=D(a,J(r[o][0],J(l,n(b(r,t,o,0),t-1,i,e,u))))),l=e===l?u:e;else for(o=0;o<t;++o)M(r[0][o],i)||(a=D(a,J(r[0][o],J(l,n(b(r,t,0,o),t-1,i,e,u))))),l=e===l?u:e}return a}(i,t,U(0),U(1),U(-1)):Xr(i,!0,null,r)[2]}function Fr(n){_(n)&&W(n)===Q(n)||w("charpoly");var i,r=W(n),e=(Q(n),r),u=new Array(e+1),t=er(e,e);for(u[e]=U(1),i=1;i<=e;++i)t=X(n,t).map(function(n,t){return n.map(function(n,r){return t===r?D(n,u[e-i+1]):n})}),u[e-i]=K(Cr(X(n,t)),-i);return u.reverse()}function Wr(o){return j(Q(o),W(o),function(n,r){return i=r,e=n,r=!0,n=W(t=o),u=Q(t),n!==u?null:n<=1?0:(e=+(e||0),(i=+(i||0))<0||n<=i||e<0||u<=e?null:(n=$r(j(n-1,u-1,function(n,r){return i<=n&&++n,e<=r&&++r,t[n][r]})),!0===r&&i+e&1?zn(n):n));var t,i,e,u})}function Qr(n,r){for(var t,i,e=W(n),u=Q(n),o=r?ur(e):null,f=n,c=0;c<u;++c)for(t=e-1;c+1<=t;--t)f=qr("left",[Y((i=Mr(f[t-1][c],f[t][c]))[0]),zn(Y(i[1]))],t-1,t,f),r&&(o=qr("right",i,t-1,t,o));return r?[o,f]:f}function Ur(n,r,t){null==r&&(r=2);for(var i,e,u,o,f,c,l=W(n),a=gn(n),s=t?F(l,1):null,h=U(1e-10),m=U(0),g=U(1),p=1;p<=1e4;++p){for(i=c=0;i<l;++i)if((o=P(a,i)).splice(i,1),(f=a[i].slice()).splice(i,1),o=ir(o,r),B(f=ir(f,r),m)||B(o,m))++c;else{for(u=C.sqrt(En(f,o)),An(C.abs(G(u,g)),h)&&++c,t&&(s[i]=H(u,s[i])),e=0;e<l;++e)a[e][i]=J(a[e][i],u);for(e=0;e<l;++e)a[i][e]=K(a[i][e],u)}if(l===c)break}return t?[s,a]:a}function Br(n,r,t){var i=W(n);if(null==r){var e,u,o=t?ur(i):null,f=n;for(c=1;c<=i-2;++c)for(l=i;c+2<=l;--l)u=[Y((e=Mr(f[l-1-1][c-1],f[l-1][c-1]))[0]),zn(Y(e[1]))],t&&(o=qr("right",e,l-1-1,l-1,o)),f=qr("left",u,l-1-1,l-1,qr("right",e,l-1-1,l-1,f));return t?[o,f]:f}var c,l,a,s,h=lr(o=Qr(r,!0)[0]),m=ur(i),g=X(h,n),p=X(h,r);for(c=1;c<=i-2;++c)for(l=i;c+2<=l;--l)a=[Y((s=Mr(g[l-1-1][c-1],g[l-1][c-1]))[0]),zn(Y(s[1]))],o=qr("right",s,l-1-1,l-1,o),g=qr("left",a,l-1-1,l-1,g),p=qr("left",a,l-1-1,l-1,p),m=qr("right",s=Mr(zn(p[l-1][l-1]),p[l-1][l-1-1]),l-1-1,l-1,m),g=qr("right",s,l-1-1,l-1,g),p=qr("right",s,l-1-1,l-1,p);return[g,p,o,m]}function Vr(n){var r,t,i,e,u=U(1e-10),o=U(0),f=(U(1),W(n)),c=new Array(f),l=new Array(f),a=F(f,0);for(n=gn(n),e=0;e<f;++e)r=(i=function(n,r,t,i){var e,u,o,f,c=lr(n),l=i,a=F(r,function(){return new I(U(E.random()||.1),i)});for(a=Qn(a,ir(a)),f=Qn(f=F(r,function(){return new I(U(E.random()||.1),i)}),ir(f)),e=1;e<=100&&(u=l,a=hn(X(n,o=a)),f=hn(X(c,f)),l=wr(a,o),a=Qn(a,a[0].sign()),f=Qn(f,f[0].sign()),a=Qn(a,ir(a)),f=Qn(f,ir(f)),!An(C.abs(G(Yn(l),Yn(u))),t)||!An(C.abs(G(nr(l),nr(u))),t));++e);return[l,a,f]}(n,f,u,o))[0],t=i[1],i=i[2],n=Fn(n,X(X(K(a[e]=r,wr(c[e]=t,l[e]=i,!0)),t),i));return[bn(cr(c)),bn(a),bn(cr(l))]}function Gr(n,r,t,i){r=U(r=$(r)?r:rn);var e,u=Q(n),o=W(n);if(o<u)return e=Gr(cr(n),r,i,t),t&&i?[cr(e[2]),e[1],cr(e[0])]:t||i?[cr(e[0]),e[1]]:e;var f,c,l,a,s,h,m,g,p,d,v,y,w,b,x,S,_,A,Z,L,z,I=t?o:0,E=i?u:0,k=gn(n),N=I?er(o,I):null,R=F(u,0),j=E?er(u,E):null,O=En(tn,r),P=U(0),T=U(1),M=new Array(u),q=new Array(u),X=new Array(u);for(q[0]=P,b=1;b<=u;++b){for(_=b+1,l=P,y=b;y<=o;++y)l=V(l,V(kn(Yn(k[y-1][b-1]),2),kn(nr(k[y-1][b-1]),2)));if(M[b-1]=P,_n(l,O)&&(l=C.sqrt(l),M[b-1]=l,s=B(a=nn(k[b-1][b-1]),P)?T:K(k[b-1][b-1],a),k[b-1][b-1]=J(s,V(l,a)),b!==u+0)){for(w=_;w<=u+0;++w){for(s=P,y=b;y<=o;++y)s=D(s,J(Y(k[y-1][b-1]),k[y-1][w-1]));for(s=K(s,H(l,V(l,a))),y=b;y<=o;++y)k[y-1][w-1]=Zn(k[y-1][w-1],J(s,k[y-1][b-1]))}for(s=zn(Xn(Y(k[b-1][b-1]))),w=_;w<=u+0;++w)k[b-1][w-1]=J(s,k[b-1][w-1])}if(b===u)break;for(l=0,w=_;w<=u;++w)l=V(l,V(kn(Yn(k[b-1][w-1]),2),kn(nr(k[b-1][w-1]),2)));if(q[_-1]=P,_n(l,O)){for(l=C.sqrt(l),q[_-1]=l,s=B(a=nn(k[b-1][_-1]),P)?T:K(k[b-1][_-1],a),k[b-1][_-1]=J(s,V(l,a)),y=_;y<=o;++y){for(s=P,w=_;w<=u;++w)s=D(s,J(Y(k[b-1][w-1]),k[y-1][w-1]));for(s=K(s,H(l,V(l,a))),w=_;w<=u;++w)k[y-1][w-1]=Zn(k[y-1][w-1],J(s,k[b-1][w-1]))}for(s=zn(Xn(Y(k[b-1][_-1]))),y=_;y<=o;++y)k[y-1][_-1]=J(k[y-1][_-1],s)}}for(h=P,b=1;b<=u;++b)R[b-1]=M[b-1],X[b-1]=q[b-1],h=dr([h,V(R[b-1],X[b-1])]);if(h=H(r,h),0<I)for(w=1;w<=I;++w)N[w-1][w-1]=T;if(0<E)for(w=1;w<=E;++w)j[w-1][w-1]=T;for(S=1;S<=u;++S){for(b=u+1-S,L=1;L<=50;++L){for(z=!0,Z=1;Z<=b;++Z){if(An(C.abs(X[(x=b+1-Z)-1]),h)){z=!1;break}if(An(C.abs(R[x-1-1]),h)){z=!0;break}}if(z)for(v=P,d=T,A=x-1,y=x;y<=b&&(g=H(d,X[y-1]),X[y-1]=H(v,X[y-1]),!An(C.abs(g),h));++b)if(a=Hn(g,p=R[y-1]),v=En(p,R[y-1]=a),d=Rn(En(g,a)),0<I)for(w=1;w<=u;++w)f=Yn(N[w-1][A-1]),c=Yn(N[w-1][y-1]),N[w-1][A-1]=V(H(f,v),H(c,d)),N[w-1][y-1]=G(H(c,v),H(f,d));if(a=R[b-1],x===b)break;for(f=R[x-1],c=R[b-1-1],m=X[b-1-1],p=X[b-1],m=Hn(g=En(V(H(G(c,a),V(c,a)),H(G(m,p),V(m,p))),H(2,H(p,c))),T),Sn(g,P)&&(m=Rn(m)),g=En(V(H(G(f,a),V(f,a)),H(G(En(c,V(g,m)),p),p)),f),d=v=T,y=A=x+1;A<=b;++A){if(m=X[y-1],c=R[y-1],p=H(d,m),m=H(v,m),a=Hn(p,g),v=En(g,X[y-1-1]=a),d=En(p,a),g=V(H(f,v),H(m,d)),m=G(H(m,v),H(f,d)),p=H(c,d),c=H(c,v),0<E)for(w=1;w<=u;++w)f=Yn(j[w-1][y-1-1]),a=Yn(j[w-1][y-1]),j[w-1][y-1-1]=V(H(f,v),H(a,d)),j[w-1][y-1]=G(H(a,v),H(f,d));if(a=Hn(p,g),v=En(g,R[y-1-1]=a),d=En(p,a),g=V(H(v,m),H(d,c)),f=G(H(v,c),H(d,m)),0<I)for(w=1;w<=u;++w)c=Yn(N[w-1][y-1-1]),a=Yn(N[w-1][y-1]),N[w-1][y-1-1]=V(H(c,v),H(a,d)),N[w-1][y-1]=G(H(a,v),H(c,d))}X[x-1]=P,X[b-1]=g,R[b-1]=f}if(Sn(a,P)&&(R[b-1]=Rn(a),0<E))for(w=1;w<=u;++w)j[w-1][b-1]=zn(j[w-1][b-1])}for(b=1;b<=u;++b){for(m=-1,y=w=b;y<=u;++y)_n(R[y-1],m)&&(m=R[y-1],w=y);if(w!==b){if(R[w-1]=R[b-1],R[b-1]=m,0<E)for(y=1;y<=u;++y)s=j[y-1][w-1],j[y-1][w-1]=j[y-1][b-1],j[y-1][b-1]=s;if(0<I)for(y=1;y<=u;++y)s=N[y-1][w-1],N[y-1][w-1]=N[y-1][b-1],N[y-1][b-1]=s}}if(0<I)for(S=1;S<=u;++S)if(!B(M[(b=u+1-S)-1],P)){for(s=zn(Xn(k[b-1][b-1])),w=1;w<=I;++w)N[b-1][w-1]=J(s,N[b-1][w-1]);for(w=1;w<=I;++w){for(s=P,y=b;y<=o;++y)s=D(s,J(Y(k[y-1][b-1]),N[y-1][w-1]));for(s=K(s,J(nn(k[b-1][b-1]),M[b-1])),y=b;y<=o;++y)N[y-1][w-1]=Zn(N[y-1][w-1],J(s,k[y-1][b-1]))}}if(0<E&&2<=u)for(S=2;S<=u;++S)if(!B(q[(_=(b=u+1-S)+1)-1],P)){for(s=zn(Xn(Y(k[b-1][_-1]))),w=1;w<=E;++w)j[_-1][w-1]=J(s,j[_-1][w-1]);for(w=1;w<=E;++w){for(s=P,y=_;y<=u;++y)s=D(s,J(k[b-1][y-1],j[y-1][w-1]));for(s=K(s,J(nn(k[b-1][_-1]),q[_-1])),y=_;y<=u;++y)j[y-1][w-1]=Zn(j[y-1][w-1],J(s,Y(k[b-1][y-1])))}}return t&&i?[bn(N),R,bn(j)]:t||i?[bn(N||j),R]:R}c.decimal=function(n){t=("function"==typeof n?(A=n,z.call(A.prototype,"_valueof")||(A.prototype._valueof=null,A.prototype.$valueOf=function(){return null==this._valueof&&(this._valueof=parseFloat(this.toFixed(9))),this._valueof},A.prototype.sign=function(){return A.sign(this)}),p.pi=A(L),p.e=A(e),p.realmax=A(a),p.realmin=A(tn),p.intmax=A(s),p.intmin=A(h)):(A=null,p.pi=L,p.e=e,p.realmax=a,p.realmin=tn,p.intmax=s,p.intmin=h),new I(p.e,0))},c.is_array=k,c.is_obj=v,c.is_string=R,c.is_nan=en,c.is_inf=un,c.is_number=u,c.is_decimal=on,c.is_int=b,c.is_complex=o,c.is_scalar=S,c.is_vector=y,c.is_matrix=_,c.is_real=an,c.array=F,c.matrix=j,N.rowvec=function(n){return fn(n)?[[n]]:cn(n)?[n]:n},N.colvec=function(n){return fn(n)?[[n]]:cn(n)?n.map(function(n){return[n]}):n},c.sca=sn,c.vec=hn,c.tonumber=mn,c.copy=gn,c.apply=pn,c.exist=function(n,r){return v(r)&&R(n)&&z.call(r,n)?1:0},c.varargout=dn,c.num2str=vn,c.MAXPRINTSIZE=f,c.tex=function(n){return k(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(yn).join("\\]\n\\[")+"\\]":k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?"\\["+n.map(yn).join("\\]\n\\[")+"\\]":"\\["+yn(n)+"\\]":"\\["+(n=n.length>c.MAXPRINTSIZE?n.slice(0,E.round(c.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-E.round(c.MAXPRINTSIZE/2))):n).map(yn).join("\\]\n\\[")+"\\]":"":(n=yn(n)).length&&(n="\\["+n+"\\]"),n},c.str=function(n){return n=k(n)?n.length?n.$scilitevarargout$?n.map(wn).join("\n\n"):k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?n.map(wn).join("\n\n"):wn(n):(n=n.length>c.MAXPRINTSIZE?n.slice(0,E.round(c.MAXPRINTSIZE/2)).concat(":").concat(n.slice(1-E.round(c.MAXPRINTSIZE/2))):n).map(wn).join("\n"):"":wn(n)},c.neq=B,c.nlt=Sn,c.ngt=_n,c.nle=An,c.nge=In,c.nadd=V,c.nsub=G,c.nmul=H,c.ndiv=En,c.npow=kn,c.nmod=Nn,c.nneg=Rn,c.ninv=jn,c.eq=M,c.ne=Pn,c.lt=Tn,c.gt=Mn,c.le=q,c.ge=qn,c.ssign=Xn,c.sadd=D,c.ssub=Zn,c.smul=J,c.sdiv=K,c.spow=Ln,c.sneg=zn,c.sconj=Y,c.sinv=On,c.sabs=nn,c.sangle=Cn,c.add=$n,c.sub=Fn,c.dotmul=Wn,N.times=Wn,c.dotdiv=Qn,c.dotpow=Un,c.mul=X,c.pow=Bn,c.get=Vn,c.set=Gn,c.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],Kn.prototype={constructor:Kn,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,option:function(n,r,t,i){var e,u,o,f={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},c={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},l={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},a=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:l[a[(i||0)%a.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=l[a[(i||0)%a.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=f["-"]),n._LineStyle||(n._LineStyle="-"),t=t||0;t<r.length;){if("Color"===r[t])R(e=r[t+1])?z.call(c,e)?n.Color=l[c[e]]:z.call(l,e)&&(n.Color=l[e]):y(e)&&3===e.length&&(n.Color=mn(e));else if("LineWidth"===r[t])$(e=r[t+1])&&(n.LineWidth=2*mn(e));else{if("LineStyle"!==r[t]){if(R(r[t])){for(u in o=!1,e=r[t],l)-1<e.indexOf(u)&&(n.Color=l[u],o=!0);for(u in f)"-"!==u&&-1<e.indexOf(u)&&(n._LineStyle=u,n.LineStyle=f[u],o=!0);if(o){t+=1;continue}}break}R(e=r[t+1])&&z.call(f,e)&&(n._LineStyle=e,n.LineStyle=f[e])}t+=2}return t},parse:function(n,r,t){var i,e,u,o,f,c,l=this,a=0,s=0;if("pie"===r)for(;a<n.length;)y(n[a])?l.data.push({y:mn(n[a++])}):a+=1;else if("plot3"===r)for(;a<n.length;)f=o=u=null,y(n[a])&&(u=n[a]),y(n[a+1])&&(o=n[a+1]),y(n[a+2])&&(f=n[a+2],a+=3),u&&o&&f?(a=l.option(c={},n,a,s),l.data.push({x:mn(u),y:mn(o),z:mn(f),style:c}),++s):a+=1;else for(;a<n.length;)if(o=u=null,y(n[a])&&(u=n[a]),y(n[a+1])||_(n[a+1])?(o=n[a+1],a+=2):u&&(u=or(1,(o=u).length),a+=1),u&&o)if(a=l.option(c={},n,a,s),_(o))for(i=0,e=Q(o);i<e;++i)l.data.push({x:mn(u),y:mn(P(o,i)),style:c}),c=l.option(c,n,a,++s);else l.data.push({x:mn(u),y:mn(o),style:c}),++s;else a+=1;return l}},c.figure=Kn,c.createCanvas=function(n,r){},c.currentCanvas=function(){},N.clc=r,N.disp=r,N.clear=r,N.help=r,N.who=r,N.whos=r,N.exist=r,["floor","ceil","round","sign","abs","exp","log","log10","sqrt","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){C[r]="log"===r?function(n){return u(n)?E.log(n):n.ln()}:"log10"===r?function(n){return u(n)?E.log10(n):n.log()}:function(n){return u(n)?E[r](n):n[r]()}}),c.realMath=C,(I=function n(r,t,i){var e=this;if(!O(e,n))return new n(r,t,i);o(r)?(e.re=r.re,e.im=r.im):(t=t||0,"polar"===i?(e._rho=C.abs(r),e._theta=t,e.re=H(e._rho,C.cos(e._theta)),e.im=H(e._rho,C.sin(e._theta))):(e.re=r,e.im=t))}).prototype={constructor:I,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var r=this;return null==r._rho&&(r._rho=Hn(r.re,r.im)),r._rho},norm2:function(){return null==this._rho2&&(this._rho2=kn(this.abs(),2)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=B(n.re,0)?(Sn(n.im,0)?-1:1)*L/2:C.atan(En(n.im,n.re))),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=B(n.im,0)?C.sign(n.re):n.div(n.abs()),o(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return $(n)?new I(V(this.re,n),this.im):new I(V(this.re,n.re),V(this.im,n.im))},sub:function(n){return $(n)?new I(G(this.re,n),this.im):new I(G(this.re,n.re),G(this.im,n.im))},mul:function(n){var r,t,i,e=this;return $(n)?new I(B(e.re,0)?0:H(e.re,n),B(e.im,0)?0:H(e.im,n)):(r=e.re,i=n.re,e=e.im,t=H(r,V(i,n=n.im)),n=H(n,V(r,e)),i=H(i,G(e,r)),new I(G(t,n),V(t,i)))},div:function(n){var r,t,i,e=this;return $(n)?new I(B(e.re,0)?0:En(e.re,n),B(e.im,0)?0:En(e.im,n)):(t=n.norm2(),r=e.re,i=En(n.re,t),e=e.im,t=H(r,V(i,n=Rn(En(n.im,t)))),n=H(n,V(r,e)),i=H(i,G(e,r)),new I(G(t,n),V(t,i)))},pow:function(n){var r,t;return $(n)?new I(kn(this.abs(),n),H(this.angle(),n),"polar"):o(n)?(r=this.abs(),t=this.angle(),new I(kn(r,n.re),H(n.im,C.log(r)),"polar").mul(new I(C.exp(Rn(H(n.im,t))),H(t,n.re),"polar"))):void 0},neg:function(){return new I(Rn(this.re),Rn(this.im))},conj:function(){return new I(this.re,Rn(this.im))},inv:function(){var n=this.norm2();return new I(En(this.re,n),Rn(En(this.im,n)))},toString:function(){var n=this;return null==n._str&&(n._str=vn(n.re)+(Sn(n.im,0)?" - ":" + ")+vn(C.abs(n.im))+"i"),n._str},valueOf:function(){return T(this.re)}},new I(0,1),t=new I(e,0),i={floor:function(n){return new I(C.floor(n.re),C.floor(n.im))},ceil:function(n){return new I(C.ceil(n.re),C.ceil(n.im))},round:function(n){return new I(C.round(n.re),C.round(n.im))},sign:function(n){return n.sign()},sqrt:function(n){return n.pow(new I(.5,0))},exp:function(n){return t.pow(n)},log:function(n){return new I(C.log(n.abs()),n.angle())},log10:function(n){return new I(C.log10(n.abs()),n.angle())},sin:function(n){return new I(H(C.sin(n.re),C.cosh(n.im)),H(C.cos(n.re),C.sinh(n.im)))},cos:function(n){return new I(H(C.cos(n.re),C.cosh(n.im)),Rn(H(C.sin(n.re),C.sinh(n.im))))},tan:function(n){return i.sin(n).div(i.cos(n))},sinh:function(n){return new I(H(C.sinh(n.re),C.cos(n.im)),H(C.cosh(n.re),C.sin(n.im)))},cosh:function(n){return new I(H(C.cosh(n.re),C.cos(n.im)),H(C.sinh(n.re),C.sin(n.im)))},tanh:function(n){return i.sinh(n).div(i.cosh(n))},asin:null,acos:null,atan:null,asinh:null,acosh:null,atanh:null},c.complexMath=i,N.complex=I,["floor","ceil","round","sign","sqrt","exp","log","log10","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){N[r]=i[r]?function(n){return pn(function(n){return(o(n)?i:C)[r](n)},n,!0)}:function(n){return pn(function(n){return C[r](n)},n,!1)}}),N.real=Yn,N.imag=nr,N.conj=rr,N.abs=tr,N.angle=function(n){return pn(Cn,n,!0)},N.norm=ir,N.zeros=er,N.ones=function(n,r){return y(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),j(T(n),T(r),U(1))},N.eye=ur,N.rand=function(n,r){return null==n?U(E.random()):(y(n)&&(r=n[1],n=n[0]),null==r&&(r=n),j(T(n),T(r),function(){return U(E.random())}))},N.randi=function(n,r,t){return null==r&&null==t?U(E.ceil(E.random()*n)):(y(r)&&(t=r[1],r=r[0]),null==t&&(t=r),j(T(r),T(t),function(){return U(E.ceil(E.random()*n))}))},N.randn=function(n,r){return null==n?U(Jn()):(y(n)&&(r=n[1],n=n[0]),null==r&&(r=n),j(T(n),T(r),function(){return U(Jn())}))},N.magic=function n(t){if(t=b(t=sn(t,!0))?T(t):null,!b(t)||t<=2)return 1===t?[[1]]:[];var i,e,u,o,f,r,c,l,a,s,h,m,g,p=1&t,d=0==(3&t),v=t*t,y=t-p>>1;if(p)return i=t+y,e=y+p,j(t,t,function(n,r){return(i+n-(r=t-1-r))%t*t+(e+r+n)%t+1});if(d)return a=0,j(t,t,function(n,r){return++a,(n+1&3)>>1==(r+1&3)>>1?v-(a-1):a});for(m=n(y),f=(o=(u=p=y*y)<<1)+p,g=j(t,t,function(n,r){return n<y&&r<y?m[n][r]:n<y?m[n][r-y]+f:r<y?m[n-y][r]+o:m[n-y][r-y]+u}),c=r=y>>>1,h=0;h<y;++h)for(s=0;s<t;++s)!(s<r||t-c<s||s===r&&h===r)||0===s&&h===r||(l=g[s][h],g[s][h]=g[s][h+y],g[s][h+y]=l);return g},N.linspace=function(n,r,t){t=T(t=null==t?100:t);for(var i=En(G(r,n),t-1),e=new Array(t),u=0,o=n;u<t;++u,o=V(o,i))e[u]=o;return e},N.logspace=function(n,r,t){t=T(t=null==t?100:t);for(var i=C.pow(En(r,n),1/(t-1)),e=new Array(t),u=0,o=n;u<t;++u,o=H(o,i))e[u]=o;return e},N.meshgrid=function(t,i){if(1===arguments.length&&(i=t),y(t)&&y(i))return[j(i.length,t.length,function(n,r){return t[r]}),j(i.length,t.length,function(n,r){return i[n]})];w("meshgrid")},N.colon=or,N.cat=function(n,r,t){var i,e=[];if(1===(n=T(n)))for(e=r,i=2;i<arguments.length;++i)e=fr("vert",e,arguments[i]);else if(2===n)for(e=r,i=2;i<arguments.length;++i)e=fr("horz",e,arguments[i]);return e},N.horzcat=function(n,r){for(var t=n,i=1;i<arguments.length;++i)t=fr("horz",t,arguments[i]);return t},N.vertcat=function(n,r){for(var t=n,i=1;i<arguments.length;++i)t=fr("vert",t,arguments[i]);return t},N.transpose=cr,N.ctranspose=lr,N.diag=ar,N.blkdiag=function(){return t=[].slice.call(arguments),a=l=c=f=o=0,t.forEach(function(n,r){fn(n)&&(t[r]=n=[[n]]),cn(n)&&(t[r]=n=ar(n)),ln(n)||w("blkdiag"),o+=W(n),f+=Q(n)}),i=t[c],e=W(i),u=Q(i),j(o,f,function(n,r){return l+e<=n&&(l+=e,a+=u,i=t[++c],e=W(i),u=Q(i)),r<a||a+u<=r?0:i[n-l][r-a]});var t,i,e,u,o,f,c,l,a},N.repmat=function(t,i,e){return y(i)&&(e=i[1],i=i[0]),null==e&&(e=i),i=T(i),e=T(e),ln(t=cn(t=fn(t)?[[t]]:t)?[t]:t)?j(i*W(t),e*Q(t),function(n,r){return t[n%i][r%e]}):t},N.repelem=function(r,t){var i,e;if(y(r))if(y(t)){if(t.length===r.length)return i=0,e=-1,F(T(vr(t)),function(n){return n===i&&(i+=T(t[++e])),r[e]})}else if(b(t))return t=T(t),e=-1,F(t*r.length,function(n){return 0==n%t&&++e,r[e]});return r},N.reshape=function(t,i,n){y(i)&&(n=i[1],i=i[0]),i=T(i),n=T(n);var e,r=i*n;return fn(t)&&1===i&&1===n?[[t]]:cn(t)&&t.length===r?j(i,n,function(n,r){return t[n+i*r]}):ln(t)&&W(t)*Q(t)==r?(e=W(t),j(i,n,function(n,r){n+=i*r;return t[n%e][E.floor(n/e)]})):t},N.squeeze=function(n){return n},N.flip=sr,N.fliplr=function(n){return sr(n,2)},N.flipud=function(n){return sr(n,1)},N.sort=dn(function(n,r,t,i){for(var e=2,u=null;e<arguments.length;){if("ComparisonMethod"===arguments[e]){"real"===arguments[e+1]?u=hr:"abs"===arguments[e+1]&&(u=mr),1===e?(t=1,i="ascend"):2===e&&(i="ascend");break}e+=1}return null==i&&(i="ascend"),gr(r,t=T(t=null==t?1:t),i,u,1<n)}),N.mod=function(n,t){return M(t=sn(t||0),0)?n:pn(function(n){var r;return $(n)?Sn(r=Nn(n,t),0)&&_n(t,0)?V(r,t):r:n},n,!0)},N.min=pr,N.max=dr,N.sum=vr,N.prod=yr,N.dot=wr,N.cross=function(n,r){if(n=hn(n),r=hn(r),!y(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(y(r)&&3===r.length)return[Zn(J(n[1],r[2]),J(n[2],r[1])),Zn(J(n[2],r[0]),J(n[0],r[2])),Zn(J(n[0],r[1]),J(n[1],r[0]))];throw"cross: input 2 not vector of length 3"},N.kron=function(t,i){var n,r,e,u;if(_(t)){if(_(i))return n=W(t),r=Q(t),e=W(i),u=Q(i),j(n*e,r*u,function(n,r){return X(t[E.floor(n/e)][E.floor(r/u)],i[n%e][r%u])});if(y(i))return n=W(t),r=Q(t),e=1,u=i.length,j(n*e,r*u,function(n,r){return X(t[n][E.floor(r/u)],i[r%u])})}else if(y(t)){if(y(i))return j(t.length,i.length,function(n,r){return X(t[n],i[r])});if(_(i))return n=t.length,e=W(i),u=Q(i),j(n*e,(r=1)*u,function(n,r){return X(t[E.floor(n/e)],i[n%e][r%u])})}return X(t,i)},N.diff=function(n,r,t){for(null==t&&(t=1),b(r=null==r?1:r)||w("diff"),r=T(r);0<r--;)n=function r(t,n){if(y(t))return 1<t.length?F(t.length-1,function(n){return Zn(t[n+1],t[n])}):[];if(_(t)){if(1===(n=T(n=null==n?1:n)))return F(Q(t),function(n){return r(P(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}w("diff")}(n,t);return n},N.cumsum=function(n,r,t){n=br(n,D,t,r);return!1===n&&w("cumsum"),n},N.cumprod=function(n,r,t){n=br(n,J,t,r);return!1===n&&w("cumprod"),n},N.cummin=function(n,r,t){n=br(n,function(n,r){return Tn(n,r)?n:r},t,r);return!1===n&&w("cummin"),n},N.cummax=function(n,r,t){n=br(n,function(n,r){return Mn(n,r)?n:r},t,r);return!1===n&&w("cummax"),n},N.movsum=function(n,r,t){var i,e;return y(r)?(i=T(r[0]),e=T(r[1])):b(r)&&(e=1&(r=T(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=xr(n,vr,i,e,t))&&w("movsum"),r},N.movprod=function(n,r,t){var i,e;return y(r)?(i=T(r[0]),e=T(r[1])):b(r)&&(e=1&(r=T(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=xr(n,yr,i,e,t))&&w("movprod"),r},N.movmean=function(n,r,t){var i,e;return y(r)?(i=T(r[0]),e=T(r[1])):b(r)&&(e=1&(r=T(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=xr(n,tt,i,e,t))&&w("movmean"),r},N.movmin=function(n,r,t){var i,e;return y(r)?(i=T(r[0]),e=T(r[1])):b(r)&&(e=1&(r=T(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=xr(n,pr,i,e,t))&&w("movmin"),r},N.movmax=function(n,r,t){var i,e;return y(r)?(i=T(r[0]),e=T(r[1])):b(r)&&(e=1&(r=T(r))?i=r>>1:(i=r>>1,r-1>>1)),!1===(r=xr(n,dr,i,e,t))&&w("movmax"),r},N.bitshift=function(n,r){return pn(function(n){return b(n)?Sn(r,0)?T(n)>>-T(r):T(n)<<T(r):n},n,!0)},N.bitand=function t(r,i){if(b(r)){if(b(i))return T(r)&T(i);if(k(i))return i.map(function(n){return t(r,n)})}else if(k(r)){if(b(i))return r.map(function(n){return t(n,i)});if(k(i)&&r.length===i.length)return r.map(function(n,r){return t(n,i[r])})}return 0},N.bitor=function t(r,i){if(b(r)){if(b(i))return T(r)|T(i);if(k(i))return i.map(function(n){return t(r,n)})}else if(k(r)){if(b(i))return r.map(function(n){return t(n,i)});if(k(i)&&r.length===i.length)return r.map(function(n,r){return t(n,i[r])})}return 0},N.bitxor=function t(r,i){if(b(r)){if(b(i))return T(r)^T(i);if(k(i))return i.map(function(n){return t(r,n)})}else if(k(r)){if(b(i))return r.map(function(n){return t(n,i)});if(k(i)&&r.length===i.length)return r.map(function(n,r){return t(n,i[r])})}return 0},N.size=Sr,N.length=_r,N.ndims=function(n){return _r(Sr(n))},N.numel=function(n){return yr(Sr(n))},N.rows=function(n){return Sr(n,1)},N.columns=function(n){return Sr(n,2)},N.sub2ind=function(n,r,t){return y(r)&&(t=r[1],r=r[0]),r=T(r),t=T(t),1===n.length?r:r-1+T(n[0])*(t-1)+1},N.ind2sub=function(n,r){return r=T(r),1===n.length?[r,1]:[(r-1)%T(n[0])+1,E.floor((r-1)/T(n[0]))+1]},c.find=Ar,N.find=function(n){return Ar(n,function(n){return!M(n,0)})},c.all=Ir,N.all=function(n){return Ir(n,function(n){return!M(n,0)})},c.any=Er,N.any=function(n){return Er(n,function(n){return!M(n,0)})},N.isreal=function(n){return Ir(n,an)},N.isempty=function(n){return k(n)?k(n[0])?n[0].length?0:1:n.length?0:1:0},N.ref=dn(function(n,r,t){_(r=S(r)?[[r]]:r)||w("ref");r=Xr(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),N.rref=dn(function(n,r,t){_(r=S(r)?[[r]]:r)||w("rref");r=Zr(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),N.linsolve=Lr,N.null=function(n,r){return n=n,r=r,e=U(0),t=U(1),u=Q(n),o=(n=Zr(n,!0,null,r))[0],f=n[1],c=f.length,r=f.reduce(function(n,r){for(var t=0;t<n.length&&r[1]>n[t];)++t;return t<n.length&&r[1]===n[t]&&n.splice(t,1),n},F(u,function(n){return n})),l=c?f.reduce(function(n,r,t){return J(n,o[t][r[1]])},t):t,r.map(function(r){for(var n,t=F(u,function(n){return n===r?l:e}),i=0;i<c;++i)(n=f[i][1])<=r&&(t[n]=Zn(t[n],J(K(l,o[i][n]),o[i][r])));return t});var e,t,u,o,f,c,l},N.rowspace=function(n,r){return Xr(t=n,!0,null,r)[1].map(function(n){return t[n[0]]});var t},N.colspace=function(n,r){return Xr(t=n,!0,null,r)[1].map(function(r){return F(t.length,function(n){return t[n][r[1]]})});var t},N.rank=function(n){return _(n=S(n)?[[n]]:n)||w("rank"),Xr(n,!0)[1].length},N.inv=function(n){return S(n)&&(x=[[n]]),_(n)||w("inv"),zr(n)},N.pinv=function(n,r){return _(n=S(n)?[[n]]:n)||w("pinv"),Or(n,r)},N.cond=function(n,r){_(n=S(n)?[[n]]:n)||w("cond");var t=zr(n);return t&&t.length?J(ir(n,r=null==r?2:r),ir(t,r)):f},N.trace=Cr,N.det=function(n){return _(n=S(n)?[[n]]:n)||w("det"),$r(n,!1,1e-15)},N.charpoly=Fr,N.adjoint=function(n){return _(n)&&W(n)===Q(n)||w("adjoint"),Wr(n)},N.ldl=function(n,r){_(n=S(n)?[[n]]:n)||w("ldl");var t,i,e,u,o,f,c=n,l=r,a=W(c),n=Q(c),s=U(0);if(a===n&&Rr(c,lr(c))){for(o=er(a,a),f=ur(a),t=0;t<a;++t){if("upper"===l){for(i=t+1;i<a;++i){for(e=t+1,u=s;e<i;++e)u=D(u,J(J(f[t][e],Y(f[i][e])),o[e][e]));f[t][i]=K(Zn(c[t][i],u),o[i][i])}for(e=t+1,u=s;e<a;++e)u=D(u,J(J(f[t][e],Y(f[t][e])),o[e][e]))}else{for(i=0;i<t;++i){for(e=0,u=s;e<i;++e)u=D(u,J(J(f[t][e],Y(f[i][e])),o[e][e]));f[t][i]=K(Zn(c[t][i],u),o[i][i])}for(e=0,u=s;e<t;++e)u=D(u,J(J(f[t][e],Y(f[t][e])),o[e][e]))}o[t][t]=Zn(c[t][t],u),q(o[t][t],s)&&w("ldl")}return[f,o]}w("ldl")},N.lu=function(n){S(n)&&(x=[[n]]),_(n)||w("lu");var r,t,i,e,u,o,f,c,l,a,s,h,m,g,p,d=!0,v=void 0,y=U(0);for(v=U(v||0),r=W(n),t=Q(n),p=!1,u=gn(n),e=ur(r),o=F(r,y),i=ur(r),f=1,c=0;c<r-1;++c){if(q(nn(u[c][c]),v)){for(s=c+1,h=!0;s<r&&h;)q(nn(u[s][c]),v)?++s:h=!1;if(r<=s){p=!0;break}kr(u,c,s),kr(i,c,s)}for(m=u[c][c],e[c][c]=m,o[c]=J(f,m),l=c+1;l<r;++l){for(g=u[l][c],e[l][c]=g,a=c+1;a<t;++a)u[l][a]=K(Zn(J(m,u[l][a]),J(u[c][a],g)),f);u[l][c]=y}f=u[c][c]}if(p)throw"lu: defficient matrix";return o[r-1]=f,d?[X(e,ar(o.map(On))),u,i]:[o,e,u,i]},N.qr=dn(function(n,r){return _(r=S(r)?[[r]]:r)||w("qr"),Qr(r,1<n)}),N.balance=dn(function(n,r,t){_(r=S(r)?[[r]]:r)&&W(r)===Q(r)||w("balance");var i=Ur(r,2,1<n);return 2<n?[i[0],F(W(r),function(n){return n+1}),i[1]]:1<n?[ar(i[0]),i[1]]:i}),N.hess=dn(function(n,r,t){return _(r=S(r)?[[r]]:r)&&W(r)===Q(r)||w("hess"),2<arguments.legnth?(_(t=S(t)?[[t]]:t)&&W(t)===Q(t)||w("hess"),Br(r,t)):Br(r,null,1<n)}),N.eig=dn(function(n,r,t){_(r)&&W(r)===Q(r)||w("eig"),_(t)&&w("eig");var i=null;return"nobalance"!==t&&(i=Ur(r,2,!0),r=i[1],i=i[0]),1<n?(t=Vr(r),[i?X(ar(i),t[0]):t[0],ar(t[1]),i?X(ar(i.map(jn)),t[2]):t[2]]):bn((Tr(r,"upper",!0,1e-15)||Tr(r,"lower",!0,1e-15)?F(W(r),function(n){return r[n][n]}):vt(Fr(r))).sort(function(n,r){return nn(r)-nn(n)}))}),N.svd=dn(function(n,r,t){return _(r=S(r)?[[r]]:r)||w("svd"),1<n?[(n=Gr(r,t,1<n,2<n))[0],ar(n[1]),n[2]]:Gr(r,t,!1,!1)});var Hr=U(.254829592),Dr=U(-.284496736),Jr=U(1.421413741),Kr=U(-1.453152027),Yr=U(1.061405429),nt=U(.3275911);function rt(n){n=Yn(n);var r,t=C.sign(n)||1,i=U(1);return t<0&&(n=Rn(n)),r=jn(V(H(nt,n),i)),H(t,G(i,H(V(H(V(H(V(H(V(H(Yr,r),Kr),r),Jr),r),Dr),r),Hr),H(r,C.exp(Rn(H(n,n)))))))}function tt(r,n){if(S(r))return r;if(y(r))return r.length?K(vr(r),U(r.length)):l;if(_(r)){if(1===(n=T(n=null==n?1:n)))return F(Q(r),function(n){return tt(P(r,n))});if(2===n)return F(W(r),function(n){return tt(r[n])})}w("mean")}function it(r,n,t){if(n=T(n||0),S(r))return U(0);if(y(r))return 0===r.length?l:1===r.length?U(0):C.sqrt(K(vr(Un(tr(Fn(r,tt(r))),U(2))),U(1===n?r.length:r.length-1)));if(_(r)){if(1===(t=T(t=null==t?1:t)))return F(Q(r),function(n){return it(P(r,n))});if(2===t)return F(W(r),function(n){return it(r[n])})}w("std")}function et(n,r){var t,i,e,u,o,f=n.length,c=r.length,l=f+c-1,a=U(0);if(!f||!c)return[];for(o=new Array(l),f<c&&(u=n,f=(n=r).length,c=(r=u).length),t=0;t<l;++t)for(o[t]=a,i=0;i<c;++i)0<=(e=t-i)&&e<f&&(o[t]=D(o[t],J(n[e],r[i])));return o}function ut(n,r,t){var i,e=[],u=n.slice(),o=u.length-r.length,f=r;if(0<=o)for(e=F(o+1,0);0<=o;){for(i=o,r=f.concat(F(o,0)),e[e.length-1-o]=K(u[0],r[0]),u=mt(u,gt(r,[zn(e[e.length-1-o])]));u.length&&M(u[0],0);)u.shift();if((o=u.length-f.length)===i)break}return[e,t?F(n.length-u.length,0).concat(u):u]}N.erf=function(n){return pn(rt,n,!0)},N.mean=tt,N.median=function r(t,n){if(S(t))return t;if(y(t))return t.length?1&(t=gr(t)).length?t[t.length>>1]:K(D(t[t.length>>1],t[(t.length>>1)-1]),U(2)):l;if(_(t)){if(1===(n=T(n=null==n?1:n)))return F(Q(t),function(n){return r(P(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}w("median")},N.mode=function r(t,n){if(S(t))return t;var i,e;if(y(t))return t.length?(i={},e=0,t.reduce(function(n,r){var t=r.toString(),t=z.call(i,t)?(i[t]+=1,i[t]):i[t]=1;return e<t?(e=t,n=r):t===e&&Tn(r,n)&&(n=r),n},{})):l;if(_(t)){if(1===(n=T(n=null==n?1:n)))return F(Q(t),function(n){return r(P(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}w("mode")},N.moment=function r(t,i,n){if(S(t))return U(0);var e;if(y(t))return t.length<=1?t.length?U(0):l:(e=t.length,K(vr(Un(Fn(t,tt(t)),i)),U(e)));if(_(t)){if(1===(n=T(n=null==n?1:n)))return i=U(i),F(Q(t),function(n){return r(P(t,n),i)});if(2===n)return i=U(i),F(W(t),function(n){return r(t[n],i)})}w("moment")},N.std=it,N.var=function r(t,i,n){if(i=T(i||0),S(t))return U(0);var e,u;if(y(t))return t.length<=1?t.length?U(0):l:(e=t.length,u=tt(t),K(vr(Wn(rr(u=Fn(t,u)),u)),U(1===i?e:e-1)));if(_(t)){if(1===(n=T(n=null==n?1:n)))return F(Q(t),function(n){return r(P(t,n),i)});if(2===n)return F(W(t),function(n){return r(t[n],i)})}w("var")},N.cov=function i(e,n,u){if(u=T(u||0),2!==arguments.length||0!==T(n)&&1!==T(n)||(u=T(n),n=null),null==n){if(S(e))return 0;var r;if(y(e))return e.length<=1?e.length?U(0):l:(t=e.length,r=tt(e),K(vr(Wn(rr(r=Fn(e,r)),r)),U(1===u?t:t-1)));if(_(e))return j(Q(e),Q(e),function(n,r,t){return n===r?i(P(e,n),u):r<n?t[r][n]:i(P(e,n),P(e,r),u)})}else{if(S(e)&&S(n))return er(2,2);if(_(e)&&_(n)&&(e=or(e),n=or(n)),y(e)&&y(n)){if(e.length!==n.length)throw"cov: inputs not of same dimension";var t;return e.length<=1?e.length?U(0):l:(t=e.length,K(vr(Wn(rr(Fn(e,tt(e))),Fn(n,tt(n)))),U(1===u?t:t-1)))}}w("cov")},N.corrcoef=function i(e,r){var u=U(1);if(null==r){if(S(e)||y(e))return u;if(_(e))return j(Q(e),Q(e),function(n,r,t){return n===r?u:r<n?t[r][n]:i(P(e,n),P(e,r))})}else{if(S(e)&&S(r))return u;if(y(e)&&y(r)){if(e.length!==r.length)throw"corrcoef: inputs not of same dimension";var n=e.length;return 1<n?K(vr(Wn(Qn(Fn(e,tt(e)),it(e)),Qn(Fn(r,tt(r)),it(r)))),U(n-1)):u}if(_(e)&&_(r)){if(W(e)!==W(r)||Q(e)!==Q(r))throw"corrcoef: inputs not of same dimension";return F(Q(e),function(n){return i(P(e,n),P(r,n))})}}w("corrcoef")},N.conv=function(n,r){return(S(n)||S(r)?Wn:(n=hn(n),r=hn(r),y(n)&&y(r)||w("conv"),et))(n,r)},N.deconv=dn(function(n,r,t){var i;if(S(r)||S(t))i=1<n?[Qn(r,t),U(0)]:Qn(r,t);else{if(r=hn(r),t=hn(t),y(r)&&y(t)||w("deconv"),!t.length||1===t.length&&M(t[0],0))throw"deconv: divisor is zero";i=ut(r,t,!0)}return 1<n?i:i[0]}),N.conv2=function(r,t){if(S(r)||S(t))return Wn(r,t);if(y(r)){if(y(t))return et(r,t);if(_(t))return F(Q(t),function(n){return et(r,P(t,n))})}else{if(y(t)){if(y(r))return et(r,t);if(_(r))return F(r[0].length,function(n){return et(P(r,n),t)});throw"conv2: input 1 not supported"}if(!_(r))throw"conv2: input 1 not supported";if(_(t)){var n,i,e,u,o,f,c,l,a,s,h,m,g,p,d=r,v=t;for(W(d)<W(v)&&(g=d,d=v,v=g),n=W(d),i=Q(d),o=er(f=n+(e=W(v))-1,c=i+(u=Q(v))-1),p=U(0),a=0;a<f;++a)for(s=0;s<c;++s){for(l=p,h=0;h<=a&&!(n<=h);++h)if(!(e<=a-h))for(m=0;m<=s&&!(i<=m);++m)u<=s-m||(l=D(l,J(d[h][m],v[a-h][s-m])));o[a][s]=l}return o}}throw"conv2: input 2 not supported"},N.filter=function(n,r,t,i,e){n=hn(n),r=hn(r),t=hn(t),y(n)&&y(r)&&y(t)||w("filter");var u,o,f,c,l=n,a=r,s=t,h=s.length,m=a.length,g=l.length,p=new Array(h),d=a[0],v=U(0);for(a=a.map(function(n){return K(n,d)}),l=l.map(function(n){return K(n,d)}),u=0;u<h;++u){for(c=v,f=u,o=0;0<=f&&o<g;++o,--f)c=D(c,J(l[o],s[f]));for(f=u-1,o=1;0<=f&&o<m;++o,--f)c=Zn(c,J(a[o],p[f]));p[u]=c}return p};var ot={},ft={};function ct(n,r){for(var t,i,e=n.length,u={},o=0;o<e;++o)1!==u[o]&&(i=n[t=function(n,r){for(var t=0;1<r;)t=(t<<1)+(1&n),n>>=1,r>>=1;return t}(o,e)],r[t]=n[o],r[o]=i,u[t]=1)}function lt(n,r,t){var i,e=n.length;if(1===e)t[0]=n[0];else{for(var u=U(0),o=U(1),f=0;f<e;++f)t[f]=new I(u,u);for(var c,l,a,s,h,m,g=function(n){for(var r=E.sqrt(n),t=3;t<=r;){if(0==n%t)return t;t+=2}return n}(e),p=e/g,d=U(1/E.sqrt(g)),v=new Array(p),y=new Array(p),w=0;w<g;++w){for(f=0;f<p;++f)v[f]=n[f*g+w];for(1<p&&(st(v,r,y),i=v,v=y,y=i),c=U(E.cos(2*L*w/e)),l=U((r?-1:1)*E.sin(2*L*w/e)),a=o,s=u,f=0;f<e;++f)h=H(d,v[f%p].re),m=H(d,v[f%p].im),t[f]=t[f].add(new I(G(H(h,a),H(m,s)),V(H(m,a),H(h,s)))),h=G(H(a,c),H(s,l)),m=V(H(a,l),H(s,c)),a=h,s=m}}}function at(n,r,t){var i,e,u,o,f,c,l,a,s,h,m,g,p,d,v,y,w,b=n.length,x=1,S=U(0),_=U(1);for(ct(n,t);x<b;){for(i=U((w=void 0,null==(w=ft[y=x])&&(ft[y]=w=E.cos(L/y)),w)),e=U((r?-1:1)*(y=void 0,null==(y=ot[w=x])&&(ot[w]=y=E.sin(L/w)),y)),o=b/(2*x),u=0;u<o;++u)for(a=_,s=S,f=0;f<x;++f)g=t[h=2*u*x+f].re,p=t[h].im,c=t[m=h+x].re,l=t[m].im,d=G(H(a,c),H(s,l)),v=V(H(s,c),H(a,l)),t[h]=new I(H(V(g,d),E.SQRT1_2),H(V(p,v),E.SQRT1_2)),t[m]=new I(H(G(g,d),E.SQRT1_2),H(G(p,v),E.SQRT1_2)),c=G(H(a,i),H(s,e)),l=V(H(a,e),H(s,i)),a=c,s=l;x<<=1}}function st(n,r,t){var i,e=n.length;if(!(e<=0))return i=!1,null==t&&(t=new Array(e),i=!0),(e&e-1?lt:at)(n,r,t),i?t:void 0}function ht(n,r,t){var i=n.length,e=n[0].length;if(!(i<=0||e<=0)){var u,o,f=!1,c=new Array(i),l=new Array(e),a=new Array(i),s=new Array(e);if(null==t){for(t=new Array(i),u=0;u<i;++u)t[u]=new Array(e);f=!0}for(o=0;o<e;++o,0){for(u=0;u<i;++u)c[u]=n[u][o];for(st(c,r,a),u=0;u<i;++u)t[u][o]=a[u]}for(u=0;u<i;++u){for(o=0;o<e;++o,0)l[o]=t[u][o];for(st(l,r,s),o=0;o<e;++o,0)t[u][o]=s[o]}return f?t:void 0}}function mt(n,r){for(var t=n.length-1,i=r.length-1,e=[];0<=t&&0<=i;)e.unshift(D(n[t--],r[i--]));for(;0<=t;)e.unshift(n[t--]);for(;0<=i;)e.unshift(r[i--]);return e}N.fft=function(r){return _(r=hn(r))?F(Q(r),function(n){return bn(st(xn(P(r,n)),!1))}):y(r)?bn(st(xn(r),!1)):void w("fft")},N.ifft=function(r){return _(r=hn(r))?F(Q(r),function(n){return bn(st(xn(P(r,n)),!0))}):y(r)?bn(st(xn(r),!0)):void w("ifft")},N.fft2=function(n){return _(n)||w("fft2"),bn(ht(xn(n),!1))},N.ifft2=function(n){return _(n)||w("ifft2"),bn(ht(xn(n),!0))};var gt=et,pt=ut;function dt(n,r){var t=U(0);if(!n.length)return t;r=r||t;for(var i=n.length,e=0,u=n[0];e+1<i;)++e,u=D(J(u,r),n[e]);return u}function vt(r){if(r.length<=1)return[];var n,t,i,e,u,o,f,c,l,a,s,h,m,g=r.length-1,p=U(1e-10),d=U(0),v=U(1),y=new I(p,d),w=new I(d,d),b=new I(v,d);for(r=r.map(U),a=function(n){return dt(r,n)},s=function(n){return K(Zn(a(D(n,y)),a(n)),y)},n=r.map(function(n){return I(n).abs()}),o=n.length-1;0<o&&B(n[o],d);)--o;for(i=V(En(dr(n.slice(0,o))||d,dr([n[o],v])),v),t=En(n[0],dr(V(n[0],dr(n.slice(1))))),e=F(g,function(){return new I(V(t,H(G(i,t),E.random())),U(E.random()*L/2),"polar")}),l=1;l<=1e4;++l){for(o=u=0;o<g;++o){if(f=e[o],h=a(f),B((m=s(f)).re,d)&&B(m.im,d)){if(An(C.abs(h.re),p)&&An(C.abs(h.im),p)){++u;continue}c=new I(i,d)}else c=h.div(m);h=c.div(b.sub(c.mul(e.reduce(function(n,r,t){return n=t===o||B(f.re,r.re)&&B(f.im,r.im)?n:n.add(f.sub(r).inv())},w)))),An(C.abs(h.re),p)&&An(C.abs(h.im),p)&&++u,e[o]=f.sub(h)}if(u===g)break}return e}function yt(n){if(R(n))return 0<n.length;if(en(n))return!1;if(u(n))return 0!==n;if(on(n))return!n.eq(0);if(o(n))return!B(n.re,0)||!B(n.im,0);if(k(n)){if(!n.length)return!1;for(var r=0,t=n.length;r<t;++r)if(!yt(n[r]))return!1;return!0}return!0===n}N.polydiv=dn(function(n,r,t){var i;if(S(r)||S(t))i=1<n?[Qn(r,t),U(0)]:Qn(r,t);else{if(r=hn(r),t=hn(t),y(r)&&y(t)||w("polydiv"),!t.length||1===t.length&&M(t[0],0))throw"polydiv: divisor is zero";i=pt(r,t,!1)}return 1<n?i:i[0]}),N.polyval=function(r,n){return y(r=hn(r))||w("polyval"),S(n)?bn(dt(r,n)):y(n)?n.map(function(n){return bn(dt(r,n))}):void w("polyval")},N.polyvalm=function(r,n){return y(r=hn(r))||w("polyvalm"),_(n)&&W(n)===Q(n)?bn(function(t,n){var i=U(0);if(!t.length)return i;for(var r=t.length,e=0,u=W(n),o=j(u,u,function(n,r){return n===r?t[0]:i});e+1<r;)++e,o=$n(X(o,n),j(u,u,function(n,r){return n===r?t[e]:i}));return o}(r,n)):S(n)?bn(dt(r,n)):y(n)?n.map(function(n){return bn(dt(r,n))}):void w("polyvalm")},N.polyfit=function(n,r,e){if(n=hn(n),r=hn(r),y(n)&&y(r)||w("polyfit"),n.length!==r.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return bn(function(i,e){var n,u,o,r,t,f,c,l,a;if(!(y(i)&&i.length&&y(e)&&e.length))return[];for(i=i.slice(),e=e.slice(),o=E.min(i.length,e.length),i.length=o,e.length=o,c={},l=[],u=0;u<o;++u)if(f=String(i[u]),z.call(c,f)){if(!M(e[c[f]],e[u]))return[];l.push(u)}else c[f]=u;for(;l.length;)u=l.pop(),i.splice(u,1),e.splice(u,1);for(l=c=null,o=i.length,a=U(1),r=F(o,function(n){for(var r=a,t=0;t<o;++t)t!==n&&(r=J(r,Zn(i[n],i[t])));return r=K(e[n],r)}),t=F(o,function(n){return[a,zn(i[n])]}),n=[],u=0;u<o;++u)n=mt(n,t.reduce(function(n,r,t){return n=t!==u?gt(n,r):n},[r[u]]));return n}(n,r));if(!b(e)||T(e)<0)throw"polyfit: input 3 not positive int";return e=T(e),bn(X(Or(n.reduce(function(n,r){for(var t=1,i=[U(1)];t<=e;++t)i.unshift(J(r,i[0]));return n.push(i),n},[])),r))},N.roots=function(n){return y(n=hn(n))||w("roots"),bn(vt(n).sort(function(n,r){return Sn(Yn(n),Yn(r))?-1:_n(Yn(n),Yn(r))?1:0}))},N.poly=function(n){return y(n=hn(n))||w("poly"),bn((n=n,t=U(1),n.reduce(function(n,r){return gt(n,[t,zn(r)])},[t])));var t},N.dec2bin=function n(r){return k(r)?r.map(n):u(r)?r.toString(2):on(r)?r.toBinary():r},N.bin2dec=function n(r){return k(r)?r.map(n):R(r)?parseInt(r,2):r},N.dec2hex=function n(r){return k(r)?r.map(n):u(r)?r.toString(16):on(r)?r.toHexadecimal():r},N.hex2dec=function n(r){return k(r)?r.map(n):R(r)?parseInt(r,16):r},N.tolower=function n(r){return k(r)?r.map(n):R(r)?r.toLowerCase():r},N.toupper=function n(r){return k(r)?r.map(n):R(r)?r.toUpperCase():r};var wt={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var r=[],t=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?t.length&&(k(t[0])?r=r.length?fr("vert",r,t):t:r.push(t),t=[]):!O(n,At)&&k(n)?t=t.length?fr("horz",t,n):n:t.push(n))}),t.length&&(k(t[0])?r=r.length?fr("vert",r,t):t:r.length?r.push(t):r=t),r}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return or(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r){return or(n,r)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r,t){return or(n,r,t)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:lr},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:cr},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:Bn},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:Un},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,r){return Lr(n,r)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:Qn},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:Qn},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:X},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:Wn},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:$n},"-":{name:"sub",arity:2,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:Fn},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:qn},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:q},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Mn},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Tn},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Pn},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:M},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,r){return yt(n)&&yt(r)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){return yt(n)||yt(r)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){n=yt(n),r=yt(r);return n&&!r||r&&!n?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return yt(n)?0:1}},"=":{name:"set",breakpoint:"end",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,r){var t,i;return k(n)&&O(n[0],At)?(i=n,k(t=r)?await Promise.all(i.map(function(n,r){return bt(n,r<t.length?t[r]:null)})):await Promise.all(i.map(function(n,r){return bt(n,0===r?t:null)}))):bt(n,r.$scilitevarargout$?r[0]:r)}}};async function bt(n,r){if(O(n,At)&&R(n.v))return await n.set(r),n.get(!0);throw"setting non-variable"}async function xt(n,r,t){var i,e,u,o,f,c,l=null;if(yt(await Et(n.if.cond,r,t))){for(i=0,o=(f=n.if.statements).length;i<o;++i)null!=(c=await Et(f[i],r,t))&&(l=c);return l}if(n.elseif.length)for(e=0,u=n.elseif.length;e<u;++e)if(yt(await Et(n.elseif[e].cond,r,t))){for(i=0,o=(f=n.elseif[e].statements).length;i<o;++i)null!=(c=await Et(f[i],r,t))&&(l=c);return l}if(n.else.statements.length){for(i=0,o=(f=n.else.statements).length;i<o;++i)null!=(c=await Et(f[i],r,t))&&(l=c);return l}}async function St(n,r,t){var i,e,u,o,f,c,l,a=null,s=!1,h=!1,m=await Et(n.val,r,t),g=n.statements;if(k(m)){for(c=(t=t||{}).brk,l=t.cont,t.brk=function(){s=!0},t.cont=function(){h=!0},u=0,o=m.length;u<o;++u){for(h=s=!1,await n.ind.set(m[u]),i=0,e=g.length;i<e&&(f=await Et(g[i],r,t),!s&&!h);++i)null!=f&&(a=f);if(s)break}t.brk=c,t.cont=l}return a}async function _t(n,r,t){var i,e,u,o=null,f=!1,c=!1,l=n.statements,a=(t=t||{}).brk,s=t.cont;for(t.brk=function(){f=!0},t.cont=function(){c=!0};yt(await Et(n.cond,r,t));){for(c=f=!1,i=0,e=l.length;i<e&&(u=await Et(l[i],r,t),!f&&!c);++i)null!=u&&(o=u);if(f)break}return t.brk=a,t.cont=s,o}function At(n,r,t){if(!O(this,At))return new At(n,r,t);this.ctx=n,this.v=r,this.i=t}async function It(n){return O(n,At)?await n.get():n}function Z(n,r){if(!O(this,Z))return new Z(n,r);null==r&&(r=n,n=""),this.op=n,this.arg=r}async function Et(n,r,t){if(O(n,Z))return Nt(n,r,t);if(k(n)){for(var i=0,e=n.length,u=new Array(e);i<e;++i)u[i]=await Et(n[i],r,t);return u}return n}function kt(v,y,w,e){var b,x=0,S=0,u=v;function _(n,r,t){null==t&&(t=S),null==r&&(r=x);var i=u.split("\n")[t];return(n=String(n)+" at line "+String((w||0)+t)+" position "+String((e||0)+r)+":")+"\n"+i+"\n"+new Array(r+1).join(" ")+"^\n"}return function e(n){var r,t,i,u,o,f,c,l=[],a=[],s=[];function h(n){var r,t,i,e,u,o,f,c;if(a.length)if(n)for(;0<a.length;){if(u=(e=a.shift())[0],n===(o=wt[u]).breakpoint){a.unshift(e);break}if("-"===u&&1===l.length)l[0]=Z(wt["*"].fn,[l[0],Z(-1)]);else{if(o.arity>l.length)throw _('invalid or missing argument for "'+u+'"',e[1],e[2]);c=l.splice(0,o.arity).reverse(),f=Z(o.fn,c),l.unshift(f)}}else if(t=(r=a.shift())[0],1===(i=wt[t]).fixity){if(i.arity>l.length)throw _('invalid or missing argument for "'+t+'"',r[1],r[2]);c=l.splice(0,i.arity).reverse(),f=Z(i.fn,c),l.unshift(f)}else{if(-1!==i.fixity)for(;0<a.length&&(u=(e=a[0])[0],(o=wt[u]).priority<i.priority||o.priority===i.priority&&(o.associativity<i.associativity||o.associativity===i.associativity&&-1===o.associativity));){if("-"===u&&1===l.length)l[0]=Z(wt["*"].fn,[l[0],Z(-1)]);else{if(o.arity>l.length)throw _('invalid or missing argument for "'+u+'"',e[1],e[2]);c=l.splice(0,o.arity).reverse(),f=Z(o.fn,c),l.unshift(f)}a.shift()}a.unshift(r)}}function m(n){if(h(!0),1<l.length||0<a.length)throw _("mismatched terms and operators",a.length?a[0][1]:x,a.length?a[0][2]:S);!0===n&&(O(l[0],Z)&&s.push(l[0]),l=[],a=[])}function g(n,r){var t,i=n.test?v.match(n):n===v.slice(0,n.length);return!!i&&(!1===r?n.test?i:[n,n]:n.test?(t=i[r||0].length,v=v.slice(t),x+=t,i):(t=n.length,v=v.slice(t),x+=t,[n,n]))}function p(n,r,t){for(var i,e=t||0,u="";e<v.length;)if(n===(i=v.charAt(e))){if(!(e+1<v.length&&n===v.charAt(e+1)))break;u+=i,e+=2}else u+=i,e+=1;return r&&(v=v.slice(e+1),x+=e+1),[u,e+1]}function d(){var n,r,t,i=function(n,r,t){for(var i,e=0,u=0;e<v.length;)if(i=v.charAt(e),!t||'"'!==i&&"'"!==i){if(r===i)++u;else if(n===i){if(0===u)break;--u}++e}else e=p(i,!1,e+1)[1];return u||e>=v.length?-1:e}("]","[",!0);if(-1===i)throw _("mismatched brackets");if(n=v.slice(0,i),/[\[\]]/.test(n)){for(r=[];t=e(",;]");)if(r.push(t),g(","))r.push(Z(","));else{if(!g(";"))break;r.push(Z(";"))}g(/^\s+/),g("]")}else r=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,r){var t=n.length,i=0;return r.trim().split(-1<r.indexOf(",")?",":/\s+/g).reduce(function(n,r){return(r=kt(r.trim(),y,S+w,x))&&(i?n.push(Z(",")):t&&n.push(Z(";")),n.push(r),i=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,r){return(r=kt(r.trim(),y,S+w,x))&&(n.length&&n.push(Z(",")),n.push(r)),n},[]),v=v.slice(i+1),x+=i+1,1<(n=n.split("\n")).length&&(S+=n.length-1,n.slice(0,-1).forEach(function(n){x-=n.length+1}));return Z(wt["[]"].fn,r)}for(;0<v.length;)if(g(/^if\b/)){if(m(!0),!(c=e("\n,")))throw _('missing or invalid condition in "if"');for(g("\n")?(++S,x=0):g(","),o=(f={if:{cond:c,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((c=e(["elseif","else","end"]))&&(o.statements=o.statements.concat(c)),g("elseif")){if(!(c=e("\n,")))throw _('missing or invalid condition in "elseif"');g("\n")?(++S,x=0):g(","),f.elseif.push({cond:c,statements:[]}),o=f.elseif[f.elseif.length-1]}else if(g("else"))g(/^[ \t\v\f]+/),g("\n")?(++S,x=0):g(","),o=f.else;else if(g("end")||!c)break;s.push(Z(xt,f))}else if(g(/^for\b/)){if(m(!0),!(r=g(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw _('missing or invalid declaration in "for"');if(!(c=e("\n,")))throw _('missing or invalid declaration in "for"');for(g("\n")?(++S,x=0):g(","),f={ind:At(y,r[1]),val:c,statements:[]};(c=e(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Z(St,f))}else if(g(/^while\b/)){if(m(!0),!(c=e("\n,")))throw _('missing or invalid condition in "while"');for(g("\n")?(++S,x=0):g(","),f={cond:c,statements:[]};(c=e(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Z(_t,f))}else if(r=g(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(r[1]))break;if("continue"===r[1])g("continue"),s.push(Z("continue",""));else if("break"===r[1])g("break"),s.push(Z("break",""));else{if("end"!==r[1])throw _('unexpected "'+r[1]+'"');g("end"),l.unshift(Z("v",At(y,"end")))}}else if(g("..."))g(/^[ \t\v\f]+/),g("\n")&&(++S,x=0);else if(g(";",!1)){if(n&&-1<n.indexOf(";"))break;g(";"),m(!0)}else if(g("\n",!1)){if(n&&-1<n.indexOf("\n"))break;g("\n"),++S,m(!(x=0))}else if(g(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(r=g("%"))b=v.indexOf("\n"),v=v.slice(-1<b?b+1:v.length),++S,m(!(x=0));else if(r=(r=g("'"))||g('"'))o=p(r[0],!0)[0],l.unshift(Z("'"===r[0]?o.split(""):o));else if(r=g(/^(&&|\|\|)[^&\|]/,1))u=r[1],a.unshift([u,x,S]),h();else if(r=g(/^(xor)[^a-zA-Z]/,1))u=r[1],a.unshift([u,x,S]),h();else if(r=g(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=r[1],a.unshift([u,x,S]),h();else if(r=g("~"))a.unshift(["~",x,S]),h();else if(r=g("="))a.unshift(["=",x,S]),h();else if(r=g(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=r[0],a.unshift([u,x,S]),h();else if(r=g(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(t=r[1],g(/^\s*\:\s*\)/))o=Z("v",At(y,t)),l.unshift(o),a.unshift(["(:)",x,S]),h();else{for(f=[];(c=e(",)"))&&f.push(c),g(","););if(!g(")"))throw _("mismatched parentheses");o=z.call(N,t)?Z(N[t],f):Z("v",At(y,t,f.length?f:null)),l.unshift(o)}g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h())}else if(r=g(/^[_a-z][_a-z0-9]*/i))t=r[0],o=z.call(N,t)&&0===N[t].length?Z(N[t],[]):Z("v",At(y,t)),l.unshift(o),g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h());else if(r=g(/^(-?\s*\d+(\.\d+)?([eE][+-]?\d+)?)([ij])?/))f=r[1].split(/\s+/).join(""),f=A?A(f):parseFloat(f,10),o=Z(r[4]?new I(0,f):f),l.unshift(o);else if("["===(i=v.charAt(0)))v=v.slice(1),x+=1,(o=d())&&(l.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h());else{if("]"===i){if(n&&-1<n.indexOf("]"))break;throw _("mismatched brackets")}if("("===i)if(v=v.slice(1),x+=1,g(/^\s*\:\s*\)/))a.unshift(["(:)",x,S]),h();else{if(l.length&&a.reduce(function(n,r){return n+("-"===r[0]&&1===l.length?1:wt[r[0]].arity)},0)<=l.length){for(h("end"),o=l.shift(),f=[];(c=e(",)"))&&f.push(c),g(","););if(!g(")"))throw _("mismatched parentheses");f.length&&(o=Z("v",At(y,o,f)))}else if(o=e(")"),!g(")"))throw _("mismatched parentheses");o&&(l.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h())}else{if(")"===i){if(n&&-1<n.indexOf(")"))break;throw _("mismatched parentheses")}if(","===i&&n&&-1<n.indexOf(","))break;if(":"!==i)throw _(n?'missing expected "'+(R(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+i+'"');if(n&&-1<n.indexOf(":"))break;for(v=v.slice(1),c=[x+=1,S],h("end"),l.length?f=1:(f=0,l.unshift(Z(":")));o=e(":,)\n"),g(/^[ \t\v\f]+/),o?(l.unshift(o),++f):g(":",!1)&&l.unshift(Z(":")),g(":"););1<f&&(a.unshift([3===f?"::":":",c[0],c[1]]),h())}}return m(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function Nt(n,r,t){var i;if(O(n,Z)){if(""===n.op)return n.arg;if("v"===n.op)return!1===r?n.arg:O(n.arg.v,Z)?It(n.arg):v(r)&&z.call(r,n.arg.v)?r[n.arg.v]:await It(n.arg);if(xt===n.op)return xt(n.arg,r,t);if(St===n.op)return St(n.arg,r,t);if(_t===n.op)return _t(n.arg,r,t);if("break"===n.op)return void(t&&d(t.brk)&&t.brk());if("continue"===n.op)return void(t&&d(t.cont)&&t.cont());if(wt["="].fn===n.op)return t=t||{},i=await Nt(n.arg[0],!1),k(i)&&O(i[0],At)&&(t.nargout=i.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[i,n.arg[1].arg.isByRef()?gn(await Nt(n.arg[1],r,t)):await Nt(n.arg[1],r,t)]):n.op.apply(null,[i].concat(await Promise.all(n.arg.slice(1).map(function(n){return Nt(n,r,t)}))));if(d(n.op))return(t&&b(t.nargout)&&d(n.op.nargout)?n.op.nargout(t.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return Nt(n,r,t)})))}throw"invalid expr"}return g.op=wt,At.prototype={constructor:At,ctx:null,v:null,i:null,get:async function(n){var r,t,i=this;if(O(i.v,Z))r=await Et(i.v);else{if(!z.call(i.ctx,i.v)&&!z.call(p,i.v))throw'undefined variable "'+i.v+'"';r=(z.call(i.ctx,i.v)?i.ctx:p)[i.v]}return!0!==n&&null!=i.i?(t=Sr(r),n=await Promise.all(i.i.map(function(n,r){return Et(n,{end:1===i.i.length?t[0]*t[1]:t[r]})})),Vn.apply(null,[r].concat(n))):r},set:async function(n){var r,t,i,e=this;if(null!=e.i){if(O(e.v,Z))r=await Et(e.v);else{if(!z.call(e.ctx,e.v))throw'undefined variable "'+e.v+'"';r=e.ctx[e.v]}t=Sr(r),1===(i=await Promise.all(e.i.map(function(n,r){return Et(n,{end:1===e.i.length?t[0]*t[1]:t[r]})}))).length&&(i=i.concat(null)),Gn.apply(null,[r].concat(i).concat([n]))}else O(e.v,Z)||(e.ctx[e.v]=n);return e},isset:function(){return R(this.v)&&z.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},Z.prototype={constructor:Z,op:null,arg:null},c.createContext=function(){return{ans:null}},c.eval=async function(n,r,t){r=r||c.createContext();var i=kt(String(n),r,null==t?1:t,1),e=null,u=!1;if(k(i))for(var o=0,f=i.length;o<f;++o)i[o]&&(e=await Nt(i[o]),u=!0);else i&&(e=await Nt(i),u=!0);return u&&(k(e)||en(e)||S(e)||R(e))&&(r.ans=e),u?e:null},g});