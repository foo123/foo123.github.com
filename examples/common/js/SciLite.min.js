/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.12
* 2026-02-04 21:19:10
* https://github.com/foo123/SciLite
*
**/!function(r,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(r)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(r)}):n in r||(r[n]=t.call(r)||1)&&"function"==typeof define&&define.amd&&define(function(){return r[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function r(){}var t,j,T=null,A=null,W=Math,Z={},e={},R=W.PI,i=W.E,o=W.log(10),f=W.log(2),fn=1/0,l=NaN,cn=1e-15,s=Number.MAX_VALUE,h=Number.MIN_VALUE,m=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,v=m,Q=0,U=1,M=-1,B=2,P=10,X=W.SQRT2,z=W.SQRT1_2,L=[],ln=Object.prototype.hasOwnProperty,an=Object.prototype.toString,k=Array.isArray||function(n){return"[object Array]"===an.call(n)},sn={VERSION:"0.9.12",_:{},fn:{},sym:{fn:{}},op:{},constant:{pi:R,e:i,eps:cn,realmax:s,realmin:h,intmax:m,intmin:g,inf:fn,Inf:fn,nan:l,NaN:l}},c=sn._,hn=sn.constant,V=sn.fn;function d(n){throw String(n)+": input(s) not supported"}function mn(n,r){return n instanceof r}function gn(n){return"function"==typeof n}function pn(n){return"[object Object]"===an.call(n)}function _(n){return"string"==typeof n}function vn(n){return wn(n)&&n.isNaN()||Number.isNaN(n)}function dn(n){return wn(n)&&!n.isFinite()||yn(n)&&!isFinite(n)}function yn(n){return"number"==typeof n}function wn(n){return null!=T&&n instanceof T}function O(n){return"number"==typeof n||null!=T&&n instanceof T}function p(n){return wn(n)&&n.isInt()||yn(n)&&Number.isInteger(n)}function u(n){return null!=A&&n instanceof A}function bn(n){return!u(n)||H(Q,n.im)}function y(n,r){if(yn(n)||u(n)||wn(n))return!0;if(!1===r){if(w(n)&&1===n.length)return!0;if(b(n)&&1===n.length&&1===n[0].length)return!0}return!1}function w(n){return k(n)&&y(n[0])}function b(n){return k(n)&&k(n[0])&&y(n[0][0])}function xn(n){return!k(n)}function kn(n){return k(n)&&!k(n[0])}function Sn(n){return k(n)&&k(n[0])}function $(n,r){n=W.max(0,W.round(n));for(var t=new Array(n),e=0;e<n;++e)t[e]=gn(r)?r(e,t):r;return t}function S(n,r,t){n=W.max(0,W.round(n)),r=W.max(0,W.round(r));for(var e,i,u=new Array(n),o=0;o<n;++o)for(u[o]=i=new Array(r),e=0;e<r;++e)i[e]=gn(t)?t(o,e,u):t;return u}function An(n,t){return n.length?$(n[0],function(r){return 1<n.length?An(n.slice(1),function(n){return gn(t)?t([r].concat(n)):t}):gn(t)?t([r]):t}):[]}function _n(n){return xn(n)?[[n]]:kn(n)?[n]:n}function qn(n){return xn(n)?[[n]]:kn(n)?n.map(function(n){return[n]}):n}function En(n,r){return O(n)?n:u(n)?r?n.re:n:w(n)&&1===n.length?En(n[0],r):b(n)&&1===n.length&&1===n[0].length?En(n[0][0],r):n}function q(n){if(null!=n)if(Sn(n)){if(1===G(n))return n[0];if(1===F(n))return n.map(function(n){return n[0]})}else if(xn(n))return[n];return n}function G(n){return n.length}function F(n){return n[0].length}function E(r,t){return $(r.length,function(n){return r[n][t]})}function I(n){return"number"==typeof n?n:wn(n)?n.$valueOf():u(n)?n.valueOf():n}function D(n){if(null!=T){if("number"==typeof n)return T(n);if(u(n)&&("number"==typeof n.re||"number"==typeof n.im))return new A("number"==typeof n.re?T(n.re):n.re,"number"==typeof n.im?T(n.im):n.im)}return n}function In(n){return k(n)?n.map(In):y(n)?I(n):n}function Nn(n){return k(n)?n.map(Nn):y(n)?D(n):n}function jn(n){return n=k(n)?n.map(jn):n}function Tn(r,n,t){if(O(n))return r(n);if(u(n)){if(t)return r(n);if(H(n.im,Q))return r(n.re)}return k(n)?n.map(function(n){return Tn(r,n,t)}):n}function Rn(t,n,e,i){return O(n)&&O(e)?t(n,e):y(n)&&y(e)?i?t(Zn(n),Zn(e)):bn(n)&&bn(e)?t(Ln(n),Ln(e)):l:k(n)&&k(e)?n.map(function(n,r){return Rn(t,n,e[r],i)}):l}function Mn(t,e){if(!gn(t))return k(t)&&(t.$scilitevarargout$=!0),t;null==e&&(e=1);function n(){var n=[].slice.call(arguments);return n.unshift(e),n=t.apply(null,n),1<e&&k(n)&&(n.$scilitevarargout$=!0),n}return n.nargout=function(r){return function(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),(1<r||1<e)&&k(n)&&(n.$scilitevarargout$=!0),n}},n}function Pn(n){return vn(n)?n="nan":dn(n)?n=(On(n,Q)?"-":"")+"inf":p(n)?n=String(n):O(n)?n=n.toFixed(4).replace(/\.0{4}$/,""):u(n)&&(n=String(n)),n}function Xn(t){var r;return null==t?t="":_(t)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(t)&&(t="\\text{"+t+"}"):t=vn(t)?"\\text{nan}":O(t)?[cn,s,h,m,g].reduce(function(n,r){return n||H(t,r)},!1)?String(t):Pn(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):u(t)?String(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):b(t)?(r=!1,F(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,W.round(c.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-W.round(c.MAXPRINTSIZE/2)))}),r=!0),"\\begin{bmatrix}"+(t=G(t)>c.MAXPRINTSIZE?t.slice(0,W.round(c.MAXPRINTSIZE/2)).concat([$(t[0].length,function(n){return W.round(c.MAXPRINTSIZE/2)===n&&r?"\\ddots":"\\vdots"})]).concat(t.slice(1-W.round(c.MAXPRINTSIZE/2))):t).map(function(n){return n.map(Xn).join(" & \\hskip 1em ")}).join(" \\\\ ")+"\\end{bmatrix}"):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,W.round(c.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(t.slice(1-W.round(c.MAXPRINTSIZE/2))):t).map(Xn).join(" \\hskip 1em "):"object"==typeof t||"function"==typeof t?"":String(t),t}function zn(t){var r,e;return null==t?t="":_(t)||(t=vn(t)?"nan":O(t)?([cn,s,h,m,g].reduce(function(n,r){return n||H(t,r)},!1)?String:Pn)(t):u(t)?String(t):b(t)?(r=!1,F(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,W.round(c.MAXPRINTSIZE/2)).concat("..").concat(n.slice(1-W.round(c.MAXPRINTSIZE/2)))}),r=!0),G(t)>c.MAXPRINTSIZE&&(t=t.slice(0,W.round(c.MAXPRINTSIZE/2)).concat([$(t[0].length,function(n){return W.round(c.MAXPRINTSIZE/2)===n&&r?":.":":"})]).concat(t.slice(1-W.round(c.MAXPRINTSIZE/2)))),e=$(F(t),function(n){return E(t,n).reduce(function(n,r){return W.max(n,zn(r).length)},0)}),t.map(function(n,r){return"["+n.map(function(n,r){n=zn(n);return n=n.length<e[r]?new Array(e[r]-n.length+1).join(" ")+n:n}).join("  ")+"]"}).join("\n")):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,W.round(c.MAXPRINTSIZE/2)).concat([".."]).concat(t.slice(1-W.round(c.MAXPRINTSIZE/2))):t).map(zn).join("  "):"object"==typeof t||"function"==typeof t?"":String(t)),t}function Ln(n){return k(n)?n.map(Ln):u(n)&&H(n.im,Q)?n.re:n}function Zn(n){return A?k(n)?n.map(Zn):O(n)?new A(D(n),Q):n:n}function H(n,r){return yn(n)?yn(r)?n===r:r.eq(n):n.eq(r)}function On(n,r){return yn(n)?yn(r)?n<r:r.gt(n):n.lt(r)}function $n(n,r){return yn(n)?yn(r)?r<n:r.lt(n):n.gt(r)}function Cn(n,r){return yn(n)?yn(r)?n<=r:r.gte(n):n.lte(r)}function Fn(n,r){return yn(n)?yn(r)?r<=n:r.lte(n):n.gte(r)}function K(n,r){return yn(n)?yn(r)?n+r:r.add(n):n.add(r)}function Wn(n,r){return yn(n)?yn(r)?n-r:r.neg().add(n):n.sub(r)}function J(n,r){return yn(n)?yn(r)?n*r:r.mul(n):n.mul(r)}function Qn(n,r){return yn(n)?yn(r)?n/r:T(n).div(r):n.div(r)}function Un(n,r){return vn(n)||vn(r)?l:yn(n)?yn(r)?n<0&&!p(r)?Ln(new A(n).pow(r)):W.pow(n,r):n<0&&!p(r)?Ln(new A(T(n)).pow(r)):T(n).pow(r):$n(Q,n)&&!p(r)?Ln(new A(n).pow(T(r))):n.pow(r)}function Bn(n,r){return yn(n)?yn(r)?n%r:T(n).mod(r):n.mod(r)}function Vn(n){return yn(n)?-n:n.neg()}function Gn(n){return yn(n)?1/n:U.div(n)}function Y(t,e){if(_(t)){if(_(e))return t===e?1:0;if(y(e))return t===String(e)?1:0;if(w(e))return e.map(function(n){return Y(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Y(t,e[n][r])})}else if(O(t)){if(_(e))return String(t)===e?1:0;if(O(e))return H(t,e)?1:0;if(u(e))return H(e.re,t)&&H(e.im,Q)?1:0;if(w(e))return e.map(function(n){return Y(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Y(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)===e?1:0;if(O(e))return H(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return H(t.re,e.re)&&H(t.im,e.im)?1:0;if(w(e))return e.map(function(n){return Y(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Y(t,e[n][r])})}else if(w(t)){if(_(e)||y(e))return t.map(function(n){return Y(n,e)});if(w(e)){if(t.length!==e.length)throw"eq: inputs have incompatible dimensions";return t.map(function(n,r){return Y(n,e[r])})}if(b(e)){if(t.length!==F(e))throw"eq: inputs have incompatible dimensions";return S(G(e),F(e),function(n,r){return Y(t[r],e[n][r])})}}else if(b(t)){if(_(e)||y(e))return S(G(t),F(t),function(n,r){return Y(t[n][r],e)});if(w(e)){if(F(t)!==e.length)throw"eq: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Y(t[n][r],e[r])})}if(b(e)){if(G(t)!==G(e)||F(t)!==F(e))throw"eq: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Y(t[n][r],e[n][r])})}}return 0}function Dn(t,e){if(_(t)){if(_(e))return t===e?0:1;if(y(e))return t===String(e)?0:1;if(w(e))return e.map(function(n){return Dn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Dn(t,e[n][r])})}else if(O(t)){if(_(e))return String(t)===e?0:1;if(O(e))return H(t,e)?0:1;if(u(e))return H(e.re,t)&&H(e.im,Q)?0:1;if(w(e))return e.map(function(n){return Dn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Dn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)===e?0:1;if(O(e))return H(t.re,e)&&H(t.im,Q)?0:1;if(u(e))return H(t.re,e.re)&&H(t.im,e.im)?0:1;if(w(e))return e.map(function(n){return Dn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Dn(t,e[n][r])})}else if(w(t)){if(_(e)||y(e))return t.map(function(n){return Dn(n,e)});if(w(e)){if(t.length!==e.length)throw"ne: inputs have incompatible dimensions";return t.map(function(n,r){return Dn(n,e[r])})}if(b(e)){if(t.length!==F(e))throw"ne: inputs have incompatible dimensions";return S(G(e),F(e),function(n,r){return Dn(t[r],e[n][r])})}}else if(b(t)){if(_(e)||y(e))return S(G(t),F(t),function(n,r){return Dn(t[n][r],e)});if(w(e)){if(F(t)!==e.length)throw"ne: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Dn(t[n][r],e[r])})}if(b(e)){if(G(t)!==G(e)||F(t)!==F(e))throw"ne: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Dn(t[n][r],e[n][r])})}}return 0}function Hn(t,e){if(_(t)){if(_(e))return t<e?1:0;if(y(e))return t<String(e)?1:0;if(w(e))return e.map(function(n){return Hn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Hn(t,e[n][r])})}else if(O(t)){if(_(e))return String(t)<e?1:0;if(O(e))return On(t,e)?1:0;if(u(e))return On(e.re,t)&&H(e.im,Q)?1:0;if(w(e))return e.map(function(n){return Hn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Hn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)<e?1:0;if(O(e))return On(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return On(t.re,e.re)&&H(t.im,Q)&&H(e.im,Q)||On(t.im,e.im)&&H(t.re,Q)&&H(e.re,Q)?1:0;if(w(e))return e.map(function(n){return Hn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Hn(t,e[n][r])})}else if(w(t)){if(_(e)||y(e))return t.map(function(n){return Hn(n,e)});if(w(e)){if(t.length!==e.length)throw"lt: inputs have incompatible dimensions";return t.map(function(n,r){return Hn(n,e[r])})}if(b(e)){if(t.length!==F(e))throw"lt: inputs have incompatible dimensions";return S(G(e),F(e),function(n,r){return Hn(t[r],e[n][r])})}}else if(b(t)){if(_(e)||y(e))return S(G(t),F(t),function(n,r){return Hn(t[n][r],e)});if(w(e)){if(F(t)!==e.length)throw"lt: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Hn(t[n][r],e[r])})}if(b(e)){if(G(t)!==G(e)||F(t)!==F(e))throw"lt: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Hn(t[n][r],e[n][r])})}}return 0}function Kn(t,e){if(_(t)){if(_(e))return e<t?1:0;if(y(e))return t>String(e)?1:0;if(w(e))return e.map(function(n){return Kn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Kn(t,e[n][r])})}else if(O(t)){if(_(e))return String(t)>e?1:0;if(O(e))return $n(t,e)?1:0;if(u(e))return $n(e.re,t)&&H(e.im,Q)?1:0;if(w(e))return e.map(function(n){return Kn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Kn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)>e?1:0;if(O(e))return $n(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return $n(t.re,e.re)&&H(t.im,Q)&&H(e.im,Q)||$n(t.im,e.im)&&H(t.re,Q)&&H(e.re,Q)?1:0;if(w(e))return e.map(function(n){return Kn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Kn(t,e[n][r])})}else if(w(t)){if(_(e)||y(e))return t.map(function(n){return Kn(n,e)});if(w(e)){if(t.length!==e.length)throw"gt: inputs have incompatible dimensions";return t.map(function(n,r){return Kn(n,e[r])})}if(b(e)){if(t.length!==F(e))throw"gt: inputs have incompatible dimensions";return S(G(e),F(e),function(n,r){return Kn(t[r],e[n][r])})}}else if(b(t)){if(_(e)||y(e))return S(G(t),F(t),function(n,r){return Kn(t[n][r],e)});if(w(e)){if(F(t)!==e.length)throw"gt: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Kn(t[n][r],e[r])})}if(b(e)){if(G(t)!==G(e)||F(t)!==F(e))throw"gt: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Kn(t[n][r],e[n][r])})}}return 0}function Jn(t,e){if(_(t)){if(_(e))return t<=e?1:0;if(y(e))return t<=String(e)?1:0;if(w(e))return e.map(function(n){return Jn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Jn(t,e[n][r])})}else if(O(t)){if(_(e))return String(t)<=e?1:0;if(O(e))return Cn(t,e)?1:0;if(u(e))return Cn(e.re,t)&&H(e.im,Q)?1:0;if(w(e))return e.map(function(n){return Jn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Jn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)<=e?1:0;if(O(e))return Cn(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return Cn(t.re,e.re)&&H(t.im,Q)&&H(e.im,Q)||Cn(t.im,e.im)&&H(t.re,Q)&&H(e.re,Q)?1:0;if(w(e))return e.map(function(n){return Jn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Jn(t,e[n][r])})}else if(w(t)){if(_(e)||y(e))return t.map(function(n){return Jn(n,e)});if(w(e)){if(t.length!==e.length)throw"le: inputs have incompatible dimensions";return t.map(function(n,r){return Jn(n,e[r])})}if(b(e)){if(t.length!==F(e))throw"le: inputs have incompatible dimensions";return S(G(e),F(e),function(n,r){return Jn(t[r],e[n][r])})}}else if(b(t)){if(_(e)||y(e))return S(G(t),F(t),function(n,r){return Jn(t[n][r],e)});if(w(e)){if(F(t)!==e.length)throw"le: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Jn(t[n][r],e[r])})}if(b(e)){if(G(t)!==G(e)||F(t)!==F(e))throw"le: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Jn(t[n][r],e[n][r])})}}return 0}function Yn(t,e){if(_(t)){if(_(e))return e<=t?1:0;if(y(e))return t>=String(e)?1:0;if(w(e))return e.map(function(n){return Yn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Yn(t,e[n][r])})}else if(O(t)){if(_(e))return String(t)>=e?1:0;if(O(e))return Fn(t,e)?1:0;if(u(e))return Fn(e.re,t)&&H(e.im,Q)?1:0;if(w(e))return e.map(function(n){return Yn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Yn(t,e[n][r])})}else if(u(t)){if(_(e))return String(t)>=e?1:0;if(O(e))return Fn(t.re,e)&&H(t.im,Q)?1:0;if(u(e))return Fn(t.re,e.re)&&H(t.im,Q)&&H(e.im,Q)||Fn(t.im,e.im)&&H(t.re,Q)&&H(e.re,Q)?1:0;if(w(e))return e.map(function(n){return Yn(t,n)});if(b(e))return S(G(e),F(e),function(n,r){return Yn(t,e[n][r])})}else if(w(t)){if(_(e)||y(e))return t.map(function(n){return Yn(n,e)});if(w(e)){if(t.length!==e.length)throw"ge: inputs have incompatible dimensions";return t.map(function(n,r){return Yn(n,e[r])})}if(b(e)){if(t.length!==F(e))throw"ge: inputs have incompatible dimensions";return S(G(e),F(e),function(n,r){return Yn(t[r],e[n][r])})}}else if(b(t)){if(_(e)||y(e))return S(G(t),F(t),function(n,r){return Yn(t[n][r],e)});if(w(e)){if(F(t)!==e.length)throw"ge: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Yn(t[n][r],e[r])})}if(b(e)){if(G(t)!==G(e)||F(t)!==F(e))throw"ge: inputs have incompatible dimensions";return S(G(t),F(t),function(n,r){return Yn(t[n][r],e[n][r])})}}return 0}function nr(n){return u(n)?n.sign():Z.sign(n)}function nn(n,r){return O(n)&&O(r)?K(n,r):u(n)&&y(r)?n.add(r):u(r)&&y(n)?r.add(n):l}function rn(n,r){return O(n)&&O(r)?Wn(n,r):u(n)&&y(r)?n.sub(r):u(r)&&y(n)?r.neg().add(n):l}function tn(n,r){return O(n)&&O(r)?J(n,r):u(n)&&y(r)?n.mul(r):u(r)&&y(n)?r.mul(n):l}function en(n,r){return O(n)&&O(r)?Qn(n,r):u(n)&&y(r)?n.div(r):u(r)&&y(n)?r.inv().mul(n):l}function rr(n,r){return O(n)&&O(r)?Un(n,r):u(n)&&y(r)?n.pow(r):u(r)&&y(n)?new A(n,Q).pow(r):l}function tr(n){return O(n)?Vn(n):u(n)?n.neg():l}function er(n){return O(n)?n:u(n)?n.conj():l}function ir(n){return O(n)?H(n,Q)?fn:Gn(n):u(n)?H(n.abs(),Q)?new A(fn,On(n.im,Q)?fn:-fn):n.inv():l}function un(n){return O(n)?Z.abs(n):u(n)?n.abs():l}function ur(n){return O(n)?On(n,Q)?hn.pi:Q:u(n)?n.angle():l}function or(r,e){if(_(r)&&_(e))return r+e;if(y(r)&&y(e))return nn(r,e);if(b(r)&&b(e)){if(G(r)===G(e)&&F(r)===F(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return or(n,t[r])})});throw"add: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return or(n,e[r])});throw"add: vector dimensions do not match"}return k(r)?r.map(function(n){return or(n,e)}):k(e)?e.map(function(n){return or(r,n)}):void d("add")}function fr(r,e){if(y(r)&&y(e))return rn(r,e);if(b(r)&&b(e)){if(G(r)===G(e)&&F(r)===F(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return fr(n,t[r])})});throw"sub: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return fr(n,e[r])});throw"sub: vector dimensions do not match"}return k(r)?r.map(function(n){return fr(n,e)}):k(e)?e.map(function(n){return fr(r,n)}):void d("sub")}function cr(r,e){if(y(r)&&y(e))return tn(r,e);if(b(r)&&b(e)){if(G(r)===G(e)&&F(r)===F(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return cr(n,t[r])})});throw"dotmul: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return cr(n,e[r])});throw"dotmul: vector dimensions do not match"}return k(r)?r.map(function(n){return cr(n,e)}):k(e)?e.map(function(n){return cr(r,n)}):void d("dotmul")}function lr(r,e){if(y(r)&&y(e))return en(r,e);if(b(r)&&b(e)){if(G(r)===G(e)&&F(r)===F(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return lr(n,t[r])})});throw"dotdiv: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return lr(n,e[r])});throw"dotdiv: vector dimensions do not match"}return k(r)?r.map(function(n){return lr(n,e)}):k(e)?e.map(function(n){return lr(r,n)}):void d("dotdiv")}function ar(r,e){if(y(r)&&y(e))return rr(r,e);if(b(r)&&b(e)){if(G(r)===G(e)&&F(r)===F(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return ar(n,t[r])})});throw"dotpow: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return ar(n,e[r])});throw"dotpow: vector dimensions do not match"}return k(r)?r.map(function(n){return ar(n,e)}):k(e)?e.map(function(n){return ar(r,n)}):void d("dotpow")}function sr(u,o,n){if(F(u)===G(o))return S(G(u),F(o),"lower"===n?function(n,r){if(n<r)return Q;for(var t=Q,e=r,i=n;e<=i;++e)t=nn(t,tn(u[n][e],o[e][r]));return t}:function(n,r){if(r<n)return Q;for(var t=Q,e=n,i=r;e<=i;++e)t=nn(t,tn(u[n][e],o[e][r]));return t});throw"mul: matrix-matrix dimensions do not match"}function N(i,u){if(y(i)&&y(u))return tn(i,u);if(b(i)&&b(u)){if(F(i)===G(u))return n=G(i),r=F(u),o=G(u),S(n,r,function(n,r){for(var t=Q,e=0;e<o;++e)t=nn(t,tn(i[n][e],u[e][r]));return t});throw"mul: matrix-matrix dimensions do not match"}if(w(i)&&b(u)){if(i.length===G(u))return r=F(u),o=i.length,S(n=1,r,function(n,r){for(var t=Q,e=0;e<o;++e)t=nn(t,tn(i[e],u[e][r]));return t});throw"mul: vector-matrix dimensions do not match"}if(b(i)&&w(u)){var o;if(F(i)===u.length)return n=G(i),o=u.length,S(n,r=1,function(n,r){for(var t=Q,e=0;e<o;++e)t=nn(t,tn(i[n][e],u[e]));return t});throw"mul: matrix-vector dimensions do not match"}var n,r;return w(i)&&w(u)?S(n=i.length,r=u.length,function(n,r){return tn(i[n],u[r])}):k(i)?i.map(function(n){return N(n,u)}):k(u)?u.map(function(n){return N(i,n)}):void d("mul")}function hr(n,r){if(y(n)&&y(r))return rr(n,r);if(b(n)&&G(n)===F(n)&&p(r)){if((r=I(r))<0&&(r=-r,!(n=qt(n))||!n.length))throw"pow: no inverse";if(0===r)return Or(G(n));if(1===r)return n;if(2===r)return N(n,n);for(var t=Or(G(n));0!==r;)1&r&&(t=N(t,n)),0<(r>>=1)&&(n=N(n,n));return t}d("pow")}function mr(n){return y(n)?tr(n):k(n)?n.map(mr):n}function gr(e,n=":",t=null){if(kn(e)){if(w(n)&&n.length===e.length&&ct(n,function(n){return 0===I(n)||1===I(n)}))return o=1===(o=n.reduce(function(n,r,t){return 1===I(r)&&n.push(e[t]),n},[])).length?o[0]:o;if(":"===(n=y(n)?En(n,!0):n)||p(n)||w(n))return r=e.length,1===(o=(n=p(n=":"===n?$r(1,r):n)?[n]:n).map(function(n){if((n=I(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[n-1]})).length?o[0]:o;throw"get: invalid range"}if(Sn(e)){var i=G(e),u=F(e),r=i*u;if(null==t&&b(n)&&G(n)===i&&F(n)===u&&ct(n,function(n){return 0===I(n)||1===I(n)})){for(var o=[],f=0;f<u;++f)for(var c=0;c<i;++c)1===I(n[c][f])&&o.push(e[c][f]);return o=1===o.length?o[0]:o}if(y(n)&&(n=En(n,!0)),y(t)&&(t=En(t,!0)),":"===n||p(n)||w(n)){if(p(n=":"===n?$r(1,i):n)&&(n=[n]),null==t)return o=1===(o=n.map(function(n){if((n=I(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[(n-1)%i][W.floor((n-1)/i)]})).length?o[0]:o;if(":"===t||p(t)||w(t))return p(t=":"===t?$r(1,u):t)&&(t=[t]),o=1===(o=n.map(function(r){if((r=I(r))<1&&(r+=i),r<1||i<r)throw"get: index out of bounds";return t.map(function(n){if((n=I(n))<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[r-1][n-1]})})).length&&1===o[0].length?o[0][0]:o}throw"get: invalid range"}return e}function pr(i,r=":",n=null,u=null){if(kn(i)){if(Sn(u)&&(u=E(u,0)),w(r)&&r.length===i.length&&ct(r,function(n){return 0===I(n)||1===I(n)})){if(xn(u))return r.forEach(function(n,r){1===I(n)&&(i[r]=u)}),i;if(k(u))return h=0,t=u.length,r.forEach(function(n,r){if(1===I(n)){if(t<=h)throw"set: index out of bounds";i[r]=u[h++]}}),i}if(":"===(r=y(r)?En(r,!0):r)||p(r)||w(r)){var e=i.length;if(p(r=":"===r?$r(1,e):r)&&(r=[r]),xn(u))return r.forEach(function(n){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u}),i;if(k(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u[r]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(Sn(i)){var o,f,t,c,l,a,s,h,m=G(i),g=F(i),e=m*g;if(b(r)&&G(r)===m&&F(r)===g&&ct(r,function(n){return 0===I(n)||1===I(n)})){if(xn(u))return r.forEach(function(n,t){n.forEach(function(n,r){1===I(n)&&(i[t][r]=u)})}),i;if(Sn(u)){for(o=G(u),f=F(u),s=l=0;l<g;++l,++s){if(1===f)s=0;else if(f<=s)throw"set: index out of bounds";for(a=c=0;c<m;++c,++a)if(1===I(r[c][l])){if(1===o)a=0;else if(o<=a)throw"set: index out of bounds";i[c][l]=u[a][s]}}return i}if(k(u)){for(t=u.length,l=h=0;l<g;++l)for(c=0;c<m;++c)if(1===I(r[c][l])){if(t<=h)throw"set: index out of bounds";i[c][l]=u[h++]}return i}}if(y(r)&&(r=En(r,!0)),y(n)&&(n=En(n,!0)),":"===r||p(r)||w(r)){if(null==n){if(p(r=":"===r?$r(1,e):r)&&(r=[r]),xn(u))return r.forEach(function(n){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][W.floor((n-1)/m)]=u}),i;if(Sn(u))return o=G(u),f=F(u),r.forEach(function(n,r){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";var t=1===o?0:r%m,r=1===f?0:W.floor(r/m);if(o<=t||f<=r)throw"set: index out of bounds";i[(n-1)%m][W.floor((n-1)/m)]=u[t][r]}),i;if(k(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=I(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][W.floor((n-1)/m)]=u[r]}),i}else if(":"===n||p(n)||w(n)){if(p(r=":"===r?$r(1,m):r)&&(r=[r]),p(n=":"===n?$r(1,g):n)&&(n=[n]),xn(u))return r.forEach(function(r){if((r=I(r))<1&&(r+=m),r<1||m<r)throw"set: index out of bounds";n.forEach(function(n){if((n=I(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";i[r-1][n-1]=u})}),i;if(Sn(u))return o=G(u),f=F(u),r.forEach(function(t,e){if((t=I(t))<1&&(t+=m),t<1||m<t)throw"set: index out of bounds";if(1===o)e=0;else if(o<=e)throw"set: index out of bounds";n.forEach(function(n,r){if((n=I(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";if(1===f)r=0;else if(f<=r)throw"set: index out of bounds";i[t-1][n-1]=u[e][r]})}),i;if(k(u)&&u.length>=r.length*n.length)return h=0,n.forEach(function(t,n){if((t=I(t))<1&&(t+=g),t<1||g<t)throw"set: index out of bounds";r.forEach(function(n,r){if((n=I(n))<1&&(n+=m),n<1||m<n)throw"set: index out of bounds";i[n-1][t-1]=u[h++]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function vr(n,r){var t,e,i;return yn(n)&&yn(r)?(t=n,e=r,t=W.abs(t),e=W.abs(e),(i=0)===t?e:0===e?t:e<t?t*W.sqrt(1+(i=e/t)*i):t<e?e*W.sqrt(1+(i=t/e)*i):t*W.SQRT2):Z.sqrt(K(J(n,n),J(r,r)))}function dr(){var n,r,t,e=0,i=0;if(yn(dr.z1))return t=dr.z1,dr.z1=null,t;for(;0===e||1===e;)e=W.random();for(;0===i||1===i;)i=W.random();return r=(n=W.sqrt(-2*W.log(e)))*W.cos(2*R*i),t=n*W.sin(2*R*i),dr.z1=t,r}function yr(n,r){var t,n=1===arguments.length?n:fr(n,r);return n.reduce(function(n,r){return n&&(yn(r)||u(r)&&yn(r.re)&&yn(r.im))},!0)?(t=0,r=(r=n).map(function(n){return n=un(n),t<n&&(t=n),n}),0===t?0:t*W.sqrt(r.reduce(function(n,r){return r===t?n+1:n+(n=r/t)*n},0))):Z.sqrt(on(Yr(n,n)))}function wr(n,r){n=1===arguments.length?n:fr(n,r);return on(Yr(n,n))}function br(n,r,t){n=lr(fr(n,r),t);return on(Yr(n,n))}function xr(n,r,t){n=fr(n,r);return on(Yr(q(N(n,t)),n))}function kr(n,r,t){return H(t=2===arguments.length?r:t,U)?2===arguments.length?Ar(n):Ar(n,r):H(t,B)?2===arguments.length?yr(n):yr(n,r):dn(t)?2===arguments.length?Sr(n):Sr(n,r):rr(Kr(ar(zr(2===arguments.length?n:fr(n,r)),t)),Gn(t))}function Sr(n,r){return Hr(zr(1===arguments.length?n:fr(n,r)))}function Ar(n,r){return Kr(zr(1===arguments.length?n:fr(n,r)))}function _r(n,r){return rn(U,en(en(Yr(n,r),Z.sqrt(on(Yr(n,n)))),Z.sqrt(on(Yr(r,r)))))}function qr(n,r){return _r(fr(n,Yt(n)),fr(r,Yt(r)))}function Er(n,e){return D(n.reduce(function(n,r,t){return n+1-Y(r,e[t])},0)/n.length)}function Ir(n,e){return D(1-n.reduce(function(n,r,t){return n+Y(r,e[t])},0)/n.length)}function Nr(n,r){for(var t,e,i=n.length,u=n.map(function(n,r){return[n,r]}).sort(function(n,r){return Y(n[0],r[0])?n[1]-r[1]:Hn(n[0],r[0])?-1:1}),o=new Array(i),f=0;f<i;){for(e=1,t=f;t+e<i&&Y(u[t][0],u[t+e][0]);)++e;for(;t<f+e;)o[u[t][1]]=vn(u[t][0])?l:D(r?(2*f<=i?f+1:i-f)+(1<e?1/e:0):f+1+(1<e?1/e:0)),++t;f=t}return o}function jr(n,r){var t=n.length;return 1<t?en(Kr(cr(lr(fr(n,Yt(n)),ne(n)),lr(fr(r,Yt(r)),ne(r)))),D(t-1)):U}function Tr(n,r){return jr(Nr(n),Nr(r))}function Rr(n,r){if(1<n.length){for(var t,e=n.length,i=Q,u=0;u<e;++u)for(t=u+1;t<e;++t)i=nn(i,tn(nr(rn(n[u],n[t])),nr(rn(r[u],r[t]))));return en(en(tn(i,B),e),e-1)}return U}function Mr(){if(!mn(this,Mr))return new Mr;this.data=[]}function on(n){return Tn(function(n){return u(n)?n.re:n},n,!0)}function Pr(n){return Tn(function(n){return u(n)?n.im:0},n,!0)}function Xr(n){return Tn(er,n,!0)}function zr(n){return Tn(un,n,!0)}function Lr(n,r){if(dn(r=null==r?B:r)){if(y(n=q(n)))return un(n);if(w(n))return(On(r,Q)?Dr:Hr)(zr(n));if(b(n)&&$n(r,Q))return Hr(Kr(zr(Fr(n))))}else if(O(r)){if(n=q(n),H(r,U)){if(y(n))return un(n);if(w(n))return Kr(zr(n));if(b(n))return Hr(Kr(zr(n)))}else if(H(r,B)){if(y(n))return un(n);if(w(n))return yr(n);if(b(n))return Hr(Ot(n,null,!1,!1))}else if($n(r,Q)){if(y(n))return un(n);if(w(n))return kr(n,r)}}else if("fro"===r&&b(n))return Z.sqrt(jt(on(N(Wr(n),n))));d("norm")}function Zr(n,r){return w(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),Q)}function Or(n,t){return null==t&&(t=U),S(I(n=En(n=null==n?1:n,!0)),I(n),function(n,r){return n===r?t:Q})}function $r(n,r,t){if(1===arguments.length&&k(n)){if(Sn(n)){for(var e,i=G(n),u=F(n),o=new Array(u*i),f=0,c=0;c<u;++c)for(e=0;e<i;++e)o[f++]=n[e][c];return o}return n}if(null!=t&&null!=r||(null!=r?(t=r,r=U):(t=n,n=r=U)),n=En(n,!0),r=En(r,!0),t=En(t,!0),o=[],$n(r,Q))for(;Cn(n,t);n=K(n,r))o.push(n);else if(On(r,Q))for(;Fn(n,t);n=K(n,r))o.push(n);return o}function Cr(n,r,t){if("horz"===n){if(kn(r)&&kn(t))return r.concat(t);if(Sn(r)&&Sn(t)&&G(r)===G(t))return r.map(function(n,r){return n.concat(t[r])})}if("vert"===n){if(kn(r)&&kn(t))return r.concat(t);if(Sn(r)&&Sn(t)&&F(r)===F(t))return r.concat(t)}d("cat")}function Fr(t){return Sn(t)?S(F(t),G(t),function(n,r){return t[r][n]}):t}function Wr(t){return Sn(t)?S(F(t),G(t),function(n,r){return y(t[r][n])?er(t[r][n]):t[r][n]}):kn(t)?t.map(function(n){return y(n)?er(n):n}):y(t)?er(t):t}function Qr(t,i){return i=I(i||0),xn(t)?[[t]]:kn(t)?S(t.length,t.length,function(n,r){return i===n-r?t[n]:Q}):Sn(t)?t.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i===e-t&&n.push(r),n},n)},[]):void d("diag")}function Ur(t,n){var e,i;return xn(t)?t:kn(t)?t.slice().reverse():Sn(t)?(e=G(t),i=F(t),1===(n=I(n=null==n?1:n))?S(e,i,function(n,r){return t[e-1-n][r]}):2===n?S(e,i,function(n,r){return t[n][i-1-r]}):t):void d("flip")}function Br(n,r){var t=on(n),e=on(r),n=Pr(n),r=Pr(r),t=On(t,e)?-1:$n(t,e)?1:0,e=On(n,r)?-1:$n(n,r)?1:0;return t||e}function Vr(n,r){var t=un(n),e=un(r),n=ur(n),r=ur(r),t=On(t,e)?-1:$n(t,e)?1:0,e=On(n,r)?-1:$n(n,r)?1:0;return t||e}function Gr(r,t,e,i,n){var u;if(xn(r))return r;if(w(r))return null==i&&(i=bn(r)?Br:Vr),u=r.map(function(n,r){return{v:n,i:r}}).sort("descend"===e?function(n,r){return i(r.v,n.v)||n.i-r.i}:function(n,r){return i(n.v,r.v)||n.i-r.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(b(r)){if(1===t)return n?(u=$(F(r),function(n){n=E(r,n);return Gr(n,t,e,null==i?bn(n)?Br:Vr:i,!0)}),[S(G(r),F(r),function(n,r){return u[r][0][n]}),S(G(r),F(r),function(n,r){return u[r][1][n]})]):(u=$(F(r),function(n){n=E(r,n);return Gr(n,t,e,null==i?bn(n)?Br:Vr:i,!1)}),S(G(r),F(r),function(n,r){return u[r][n]}));if(2===t)return n?(u=$(G(r),function(n){n=r[n];return Gr(n,t,e,null==i?bn(n)?Br:Vr:i,!0)}),[S(G(r),F(r),function(n,r){return u[n][0][r]}),S(G(r),F(r),function(n,r){return u[n][1][r]})]):(u=$(G(r),function(n){n=r[n];return Gr(n,t,e,null==i?bn(n)?Br:Vr:i,!1)}),S(G(r),F(r),function(n,r){return u[n][r]}))}d("sort")}function Dr(r){return y(r=q(r))?r:w(r)?r.reduce(function(n,r){return n=On(r,n)?r:n},fn):b(r)?$(F(r),function(n){return Dr(E(r,n))}):l}function Hr(r){return y(r=q(r))?r:w(r)?r.reduce(function(n,r){return n=$n(r,n)?r:n},-fn):b(r)?$(F(r),function(n){return Hr(E(r,n))}):l}function Kr(r,n){if(y(r=q(r)))return r;if(w(r))return r.reduce(nn,Q);if(b(r)){if(1===(n=I(n=null==n?1:n)))return $(F(r),function(n){return Kr(E(r,n))});if(2===n)return $(G(r),function(n){return Kr(r[n])})}return l}function Jr(r,n){if(y(r=q(r)))return r;if(w(r))return r.reduce(tn,U);if(b(r)){if(1===(n=I(n=null==n?1:n)))return $(F(r),function(n){return Jr(E(r,n))});if(2===n)return $(G(r),function(n){return Jr(r[n])})}return l}function Yr(r,e,i){if(i=!0===i,r=q(r),e=q(e),y(r)&&y(e))return tn(r,i?e:er(e));if(w(r)&&w(e)){if(r.length===e.length)return r.reduce(function(n,r,t){return nn(n,tn(r,i?e[t]:er(e[t])))},0)}else if(b(r)&&b(e)&&G(r)===G(e)&&F(r)===F(e))return $(F(r),function(n){return Yr(E(r,n),E(e,n),i)});return 0}function nt(t,e){var n,r,i,u;if(b(t)){if(b(e))return n=G(t),r=F(t),i=G(e),u=F(e),S(n*i,r*u,function(n,r){return N(t[W.floor(n/i)][W.floor(r/u)],e[n%i][r%u])});if(w(e))return n=G(t),r=F(t),i=1,u=e.length,S(n*i,r*u,function(n,r){return N(t[n][W.floor(r/u)],e[r%u])})}else if(w(t)){if(w(e))return S(t.length,e.length,function(n,r){return N(t[n],e[r])});if(b(e))return n=t.length,i=G(e),u=F(e),S(n*i,(r=1)*u,function(n,r){return N(t[W.floor(n/i)],e[n%i][r%u])})}return N(t,e)}function rt(r,t,n){if(w(t)){var e,i,u;if(null==r||y(r)){for(null==r&&(r=U),e=0,i=t.length-1,u=Q;e<i;++e)u=nn(u,tn(r,en(nn(t[e+1],t[e]),B)));return u}if(w(r)&&r.length===t.length){for(e=0,i=r.length-1,u=Q;e<i;++e)u=nn(u,tn(un(rn(r[e+1],r[e])),en(nn(t[e+1],t[e]),B)));return u}}else if(b(t))if(1===(n=I(n=null==n?1:n))){if(null==r||y(r)||w(r)&&r.length===G(t))return $(F(t),function(n){return rt(r,E(t,n))});if(b(r)&&G(r)===G(t)&&F(r)===F(t))return $(F(t),function(n){return rt(null==r?null:E(r,n),E(t,n))})}else if(2===n){if(null==r||y(r)||w(r)&&r.length===F(t))return $(G(r),function(n){return rt(r,t[n])});if(b(r)&&G(r)===G(t)&&F(r)===F(t))return $(G(r),function(n){return rt(r[n],t[n])})}d("trapz")}function tt(r,t,e,i){var u;if(y(r))return r;if(w(r)){if("reverse"===(e=null==e?"forward":e))return r.slice().reverse().map(function(n,r){return u=0===r?n:t(u,n)}).reverse();if("forward"===e)return r.map(function(n,r){return u=0===r?n:t(u,n)})}else if(b(r)){if(1===(i=I(i=null==i?1:i)))return $(F(r),function(n){return tt(E(r,n),t,e,i)});if(2===i)return $(G(r),function(n){return tt(r[n],t,e,i)})}return!1}function et(r,t,e,i,u){var o;if(w(r))return $(o=r.length,function(n){return t(r.slice(W.max(0,n-e),W.min(o-1,n+i)+1))});if(b(r)){if(1===(u=I(u=null==u?1:u)))return $(F(r),function(n){return et(E(r,n),t,e,i,u)});if(2===u)return $(G(r),function(n){return et(r[n],t,e,i,u)})}return!1}function it(r,t){if(p(r)){if(p(t))return I(r)&I(t);if(k(t))return t.map(function(n){return it(r,n)})}else if(k(r)){if(p(t))return r.map(function(n){return it(n,t)});if(k(t)&&r.length===t.length)return r.map(function(n,r){return it(n,t[r])})}return 0}function ut(r,t){if(p(r)){if(p(t))return I(r)|I(t);if(k(t))return t.map(function(n){return ut(r,n)})}else if(k(r)){if(p(t))return r.map(function(n){return ut(n,t)});if(k(t)&&r.length===t.length)return r.map(function(n,r){return ut(n,t[r])})}return 0}function ot(n){var r,t,e=[].slice.call(arguments,1);return k(e[0])&&(e=q(e[0])),xn(n)?(r=[1,1],e.length?e.map(function(n){return r[I(n)-1]}):r):kn(n)?(r=[1,n.length],e.length?e.map(function(n){return r[I(n)-1]}):r):k(t=n)&&k(t[0])&&k(t[0][0])?(r=[n.length].concat(ot(n[0])),e.length?e.map(function(n){return r[I(n)-1]}):r):Sn(n)?(r=[G(n),F(n)],e.length?e.map(function(n){return r[I(n)-1]}):r):[]}function ft(n,i){var u;return w(n)?n.reduce(function(n,r,t){return i(r,t+1,1)&&n.push(t+1),n},[]):b(n)?(u=G(n),n.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i(r,e+1,t+1)&&n.push(e+u*t+1),n},n)},[])):[]}function ct(n,r){if(y(n))return r(n,1,1)?1:0;if(w(n)){for(var t=0,e=n.length;t<e;++t)if(!r(n[t],t+1,1))return 0;return 1}if(b(n)){for(var t=0,i=G(n),u=F(n);t<i;++t)for(var o=0;o<u;++o)if(!r(n[t][o],t+1,o+1))return 0;return 1}return 0}function lt(n,r){if(y(n))return r(n,1,1)?1:0;if(w(n)){for(var t=0,e=n.length;t<e;++t)if(r(n[t],t+1,1))return 1}else if(b(n))for(var t=0,i=G(n),u=F(n);t<i;++t)for(var o=0;o<u;++o)if(r(n[t][o],t+1,o+1))return 1;return 0}function at(n,r,t){if(_(n)&&_(r))return n===r?1:0;if(vn(n)&&vn(r))return t?1:0;if(y(n)&&y(r))return Y(n,r)?1:0;if(k(n)&&k(r)){if(n.length!==r.length)return 0;for(var e=0,i=n.length;e<i;++e)if(!at(n[e],r[e],t))return 0;return 1}return 0}function st(n,r,t){var e;r!==t&&(e=n[r],n[r]=n[t],n[t]=e)}function ht(n,r,t,e,i,u){var o,f=n[0].length;for(null==e&&(e=U),null==i&&(i=U),o=u||0;o<f;++o)n[r][o]=nn(tn(i,n[r][o]),tn(e,n[t][o]))}function mt(n,r,t,e,i,u,o){for(var f,c,l=n[0].length,a=0;a<l;++a)f=n[r][a],c=n[t][a],n[r][a]=nn(tn(e,f),tn(i,c)),n[t][a]=nn(tn(u,f),tn(o,c))}function gt(n,r,t,e,i,u,o){for(var f,c,l=n.length,a=0;a<l;++a)f=n[a][r],c=n[a][t],n[a][r]=nn(tn(e,f),tn(u,c)),n[a][t]=nn(tn(i,f),tn(o,c))}function pt(t,e,i,n,r){var u=G(t),o=F(t);return u&&o?k(e)&&k(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<o}),S(e.length,i.length,function(n,r){return t[e[n]][i[r]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=o),(n=null==n?u-1:n)<0&&(n+=u),(r=null==r?o-1:r)<0&&(r+=o),e=W.max(0,W.min(u-1,e)),n=W.max(0,W.min(u-1,n)),i=W.max(0,W.min(o-1,i)),r=W.max(0,W.min(o-1,r)),e<=n&&i<=r?S(n-e+1,r-i+1,function(n,r){return t[e+n][i+r]}):[]):[]}function vt(t,e,n){var i=G(t),u=F(t),o=G(e),f=F(e);return"vert"===(n=n||"horz")?S(i+o,W.max(u,f),function(n,r){return u<=r?n<i?Q:e[n-i][r]:f<=r?n<i?t[n][r]:Q:(n<i?t[n]:e[n-i])[r]}):S(W.max(i,o),u+f,function(n,r){return i<=n?r<u?Q:e[n][r-u]:o<=n?r<u?t[n][r]:Q:r<u?t[n][r]:e[n][r-u]})}function dt(r,n,t,e,i,u){var o,f,c,l,a=G(r),s=F(r);if(!1===t||a===s){for(e=D(e||0),o=W.min(a,s),l=$n(e,Q)?J(Qn(Kr($(o,function(n){return un(r[n][n])})),o),e):Q,f=0;f<o;++f){if("lower"===n||"diagonal"===n)for(c=f+1;c<o;++c)if(!Jn(un(r[f][c]),l))return;if("upper"===n||"diagonal"===n)for(c=0;c<f;++c)if(!Jn(un(r[f][c]),l))return}if(s<a){for(f=o;f<a;++f)for(c=0;c<s;++c)if(!Jn(un(r[f][c]),l))return}else if(a<s)for(c=o;c<s;++c)for(f=0;f<a;++f)if(!Jn(un(r[f][c]),l))return;if(!0===i&&$n(e,Q)){if(u&&u._&&(r=u._=jn(r)),"upper"===n||"diagonal"===n)for(f=0;f<o;++f)for(c=0;c<f;++c)r[f][c]=Q;if("lower"===n||"diagonal"===n)for(f=0;f<o;++f)for(c=f+1;c<o;++c)r[f][c]=Q;if(s<a)for(f=o;f<a;++f)for(c=0;c<s;++c)r[f][c]=Q;else if(a<s)for(c=o;c<s;++c)for(f=0;f<a;++f)r[f][c]=Q}return 1}}function yt(n,r){var t,e,i;return Y(r,Q)?(t=U,e=Q):Y(n,Q)?(t=Q,Y(e=nr(er(r)),Q)&&(e=U)):(i=nr(n),t=en(n=un(n),n=vr(n,un(r))),e=en(tn(i,er(r)),n)),[t,e]}function wt(n,r,t,e,i,u,o){var f,c,l,a,s,h,m,g=i,p=2===r.length&&y(r[0])?(s=r[0],h=tr(r[1]),m=r[1],r[0]):2===r.length&&2===r[0].length?(s=r[0][0],h=r[0][1],m=r[1][0],r[1][1]):(s=r[t][t],h=r[t][e],m=r[e][t],r[e][e]);if("right"===n)for(f=G(i),null==o&&(o=f-1),c=u=null==u?0:u;c<=o;++c)l=i[c][t],a=i[c][e],g[c][t]=nn(tn(s,l),tn(m,a)),g[c][e]=nn(tn(h,l),tn(p,a));else for(f=F(i),null==o&&(o=f-1),c=u=null==u?0:u;c<=o;++c)l=i[t][c],a=i[e][c],g[t][c]=nn(tn(s,l),tn(h,a)),g[e][c]=nn(tn(m,l),tn(p,a));return g}function bt(t,e,i,n,u,r,o){var f,c,l;null==o&&(o=hn.eps),Cn(n=w(t)?(f=t[i],i===n?Q:on(Yr(c=t.slice(i+1,n+1),c))):u===r?(f=t[i][u],i===n?Q:on(Yr(c=t.slice(i+1,n+1).map(function(n){return n[u]}),c))):(f=t[i][u],u===r?Q:on(Yr(c=t[i].slice(u+1,r+1),c))),o)&&Cn(Un(un(Pr(f)),B),o)?(e.beta=on(f),e.tau=Q,e.v.forEach(function(n,r){e.v[r]=0===r?U:Q})):(c=Z.sqrt(K(on(tn(f,er(f))),n)),Fn(on(f),Q)&&(c=tr(c)),l=rn(f,c),e.beta=c,e.tau=er(en(tr(l),c)),w(t)?e.v.forEach(function(n,r){e.v[r]=0===r?U:en(t[r+i],l)}):u===r?e.v.forEach(function(n,r){e.v[r]=0===r?U:en(t[r+i][u],l)}):e.v.forEach(function(n,r){e.v[r]=0===r?U:en(t[i][r+u],l)}))}function xt(n,r,e,i,t,u,o){var f,c,l,a,s=r.v,h=s.length,m=r.tau,g=e;if(!Y(m,Q))if("right"===n)for(f=G(e),null==i&&(i=0),null==t&&(t=F(e)-1),a=$((o=null==o?f-1:o)-(u=null==u?0:u)+1,function(n){for(var r=Q,t=0;t<h;++t)r=nn(r,tn(s[t],e[n+u][t+i]));return r}),l=u;l<=o;++l)for(c=i;c<=t;++c)g[l][c]=rn(e[l][c],tn(a[l-u],tn(m,er(s[c-i]))));else for(f=F(e),null==i&&(i=0),null==t&&(t=G(e)-1),a=$((o=null==o?f-1:o)-(u=null==u?0:u)+1,function(n){for(var r=Q,t=0;t<h;++t)r=nn(r,tn(er(s[t]),e[t+i][n+u]));return r}),l=u;l<=o;++l)for(c=i;c<=t;++c)g[c][l]=rn(e[c][l],tn(tn(m,s[c-i]),a[l-u]));return g}function kt(n,i,u,o,f){f=D(f||0),o=o||[U],u=u&&q(u);var c=G(i),l=0,a=o.length;return"lower"===n?$(c,function(n,r){for(var t=Q,e=0;e<n;++e)t=nn(t,tn(i[n][e],r[e]));return t=rn(u?u[n]:Q,t),Cn(un(i[n][n]),f)&&Cn(un(t),f)?l<a?o[l++]:o[a-1]||Q:en(t,i[n][n])}):$(c,function(n,r){for(var t=Q,e=0;e<n;++e)t=nn(t,tn(i[c-1-n][c-1-e],r[e]));return t=rn(u?u[c-1-n]:Q,t),Cn(un(i[c-1-n][c-1-n]),f)&&Cn(un(t),f)?l<a?o[l++]:o[a-1]||Q:en(t,i[c-1-n][c-1-n])}).reverse()}c.decimal=function(n){"function"==typeof n?(T=n,ln.call(T.prototype,"_valueof")||(T.prototype._valueof=null,T.prototype.$valueOf=function(){return null==this._valueof&&(this._valueof=parseFloat(this.toFixed(9))),this._valueof},T.prototype.sign=function(){return T.sign(this)}),Q=T(0),U=T(1),M=T(-1),T(.5),B=T(2),P=T(10),o=T(W.log(10)),f=T(W.log(2)),X=T(W.SQRT2),z=T(W.SQRT1_2),hn.eps=T(cn),hn.pi=T(R),hn.e=T(i),hn.realmax=T(s),hn.realmin=T(h),hn.intmax=T(m),hn.intmin=T(g),hn.bitmax=T(v)):(T=null,Q=0,M=-(U=1),B=2,P=10,f=W.log(2),o=W.log(10),X=W.SQRT2,z=W.SQRT1_2,hn.eps=cn,hn.pi=R,hn.e=i,hn.realmax=s,hn.realmin=h,hn.intmax=m,hn.intmin=g,hn.bitmax=v),A&&(j=new A(Q,U),t=new A(hn.e,Q)),L.forEach(function(n){n()})},c.is_array=k,c.is_obj=pn,c.is_string=_,c.is_nan=vn,c.is_inf=dn,c.is_number=yn,c.is_decimal=wn,c.is_int=p,c.is_complex=u,c.is_real=bn,c.is_scalar=y,c.is_vector=w,c.is_matrix=b,c.array=$,c.matrix=S,c.ndarray=An,V.rowvec=_n,V.colvec=qn,c.sca=En,c.vec=q,c.tonumber=In,c.todecimal=Nn,c.copy=jn,c.apply=Tn,c.apply2=Rn,c.exist=function(n,r){return pn(r)&&_(n)&&ln.call(r,n)?1:0},c.varargout=Mn,c.num2str=Pn,c.MAXPRINTSIZE=fn,c.tex=function(n){return k(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(Xn).join("\\]\n\\[")+"\\]":k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?"\\["+n.map(Xn).join("\\]\n\\[")+"\\]":"\\["+Xn(n)+"\\]":"\\["+(n=n.length>c.MAXPRINTSIZE?n.slice(0,W.round(c.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-W.round(c.MAXPRINTSIZE/2))):n).map(Xn).join("\\]\n\\[")+"\\]":"":(n=Xn(n)).length&&(n="\\["+n+"\\]"),n},c.str=function(n){return n=k(n)?n.length?n.$scilitevarargout$?n.map(zn).join("\n\n"):k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?n.map(zn).join("\n\n"):zn(n):(n=n.length>c.MAXPRINTSIZE?n.slice(0,W.round(c.MAXPRINTSIZE/2)).concat(":").concat(n.slice(1-W.round(c.MAXPRINTSIZE/2))):n).map(zn).join("\n"):"":zn(n)},c.neq=H,c.nlt=On,c.ngt=$n,c.nle=Cn,c.nge=Fn,c.nadd=K,c.nsub=Wn,c.nmul=J,c.ndiv=Qn,c.npow=Un,c.nmod=Bn,c.nneg=Vn,c.ninv=Gn,c.eq=Y,c.ne=Dn,c.lt=Hn,c.gt=Kn,c.le=Jn,c.ge=Yn,c.ssign=nr,c.sadd=nn,c.ssub=rn,c.smul=tn,c.sdiv=en,c.spow=rr,c.sneg=tr,c.sconj=er,c.sinv=ir,c.sabs=un,c.sangle=ur,c.add=or,c.sub=fr,c.dotmul=cr,V.times=cr,c.dotdiv=lr,c.dotpow=ar,V.power=ar,c.mult=sr,c.mul=N,c.pow=hr,V.mpower=hr,c.neg=mr,c.get=gr,c.set=pr,c.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],Mr.prototype={constructor:Mr,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,option:function(n,r,t,e){var i,u,o,f={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},c={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},l={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},a=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:l[a[(e||0)%a.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=l[a[(e||0)%a.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=f["-"]),n._LineStyle||(n._LineStyle="-"),t=t||0;t<r.length;){if("Color"===r[t])_(i=r[t+1])?ln.call(c,i)?n.Color=l[c[i]]:ln.call(l,i)&&(n.Color=l[i]):w(i)&&3===i.length&&(n.Color=In(i));else if("LineWidth"===r[t])O(i=r[t+1])&&(n.LineWidth=2*In(i));else{if("LineStyle"!==r[t]){if(_(r[t])){for(u in o=!1,i=r[t],l)-1<i.indexOf(u)&&(n.Color=l[u],o=!0);for(u in f)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=f[u],o=!0);if(o){t+=1;continue}}break}_(i=r[t+1])&&ln.call(f,i)&&(n._LineStyle=i,n.LineStyle=f[i])}t+=2}return t},parse:function(n,r,t){var e,i,u,o,f,c,l,a=this,s=0,h=0;if("pie"===r)for(;s<n.length;)w(u=q(n[s]))&&a.data.push({y:In(u)}),s+=1;else if("plot3"===r)for(;s<n.length;)c=f=o=null,w(u=q(n[s]))&&(o=u),w(u=q(n[s+1]))&&(f=u),w(u=q(n[s+2]))&&(c=u,s+=3),o&&f&&c?(s=a.option(l={},n,s,h),a.data.push({x:In(o),y:In(f),z:In(c),style:l}),++h):s+=1;else for(;s<n.length;)if(f=o=null,w(u=q(n[s]))&&(o=u),w(n[s+1])||b(n[s+1])?(f=q(n[s+1]),s+=2):o&&(o=$r(1,(f=o).length),s+=1),o&&f)if(o=In(o),s=a.option(l={},n,s,h),b(f))for(e=0,i=F(f);e<i;++e)a.data.push({x:o,y:In(E(f,e)),style:l}),l=a.option(l,n,s,++h);else a.data.push({x:o,y:In(f),style:l}),++h;else s+=1;return a}},c.figure=Mr,c.createCanvas=function(n,r){},c.currentCanvas=function(){},V.clc=r,V.disp=r,V.clear=r,V.help=r,V.who=r,V.whos=r,V.exist=r,["floor","ceil","round","sign","abs","exp","log","log10","log2","sqrt","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){Z[r]="log"===r?function(n){return yn(n)?W.log(n):n.ln()}:"log10"===r?function(n){return yn(n)?W.log10(n):n.log(P)}:"log2"===r?function(n){return yn(n)?W.log2(n):n.log(B)}:function(n){return yn(n)?W[r](n):n[r]()}}),Z.atan2=function(n,r){return H(Q,r)&&H(Q,n)?Q:(yn(n)&&yn(r)?W:T).atan2(n,r)},Z.fix=function(n){return On(n,Q)?Z.ceil(n):Z.floor(n)},c.realMath=Z,(A=function n(r,t,e){var i=this;if(!mn(i,n))return new n(r,t,e);u(r)?(i.re=r.re,i.im=r.im):(t=t||Q,"polar"===e?(i._rho=Z.abs(r),i.re=J(i._rho,Z.cos(t)),i.im=J(i._rho,Z.sin(t))):(i.re=r,i.im=t))}).prototype={constructor:A,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var r=this;return null==r._rho&&(r._rho=vr(r.re,r.im)),r._rho},norm2:function(){return null==this._rho2&&(this._rho2=Un(this.abs(),B)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=Z.atan2(n.im,n.re)),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=H(n.im,Q)?Z.sign(n.re):n.div(n.abs()),u(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return O(n)?new A(K(this.re,n),this.im):new A(K(this.re,n.re),K(this.im,n.im))},sub:function(n){return O(n)?new A(Wn(this.re,n),this.im):new A(Wn(this.re,n.re),Wn(this.im,n.im))},mul:function(n){var r,t,e,i=this;return O(n)?new A(H(i.re,Q)?Q:J(i.re,n),H(i.im,Q)?Q:J(i.im,n)):(r=i.re,e=n.re,i=i.im,t=J(r,K(e,n=n.im)),n=J(n,K(r,i)),e=J(e,Wn(i,r)),new A(Wn(t,n),K(t,e)))},div:function(n){var r,t,e,i=this;return O(n)?new A(H(i.re,Q)?Q:Qn(i.re,n),H(i.im,Q)?Q:Qn(i.im,n)):(t=n.norm2(),r=i.re,e=Qn(n.re,t),i=i.im,t=J(r,K(e,n=Vn(Qn(n.im,t)))),n=J(n,K(r,i)),e=J(e,Wn(i,r)),new A(Wn(t,n),K(t,e)))},pow:function(n){var r,t;return vn(n)?l:O(n)?new A(Un(this.abs(),n),J(this.angle(),n),"polar"):u(n)?(r=this.abs(),t=this.angle(),new A(Un(r,n.re),J(n.im,Z.log(r)),"polar").mul(new A(Z.exp(Vn(J(n.im,t))),J(t,n.re),"polar"))):void 0},neg:function(){return new A(Vn(this.re),Vn(this.im))},conj:function(){return new A(this.re,Vn(this.im))},inv:function(){var n=this.norm2();return new A(Qn(this.re,n),Vn(Qn(this.im,n)))},toString:function(){var n=this;return null==n._str&&(n._str=Pn(n.re)+(On(n.im,Q)?" - ":" + ")+Pn(Z.abs(n.im))+"i"),n._str},valueOf:function(){return I(this.re)}},j=new A(Q,U),t=new A(hn.e,Q),e={floor:function(n){return new A(Z.floor(n.re),Z.floor(n.im))},ceil:function(n){return new A(Z.ceil(n.re),Z.ceil(n.im))},round:function(n){return new A(Z.round(n.re),Z.round(n.im))},fix:function(n){return new A(Z.fix(n.re),Z.fix(n.im))},sign:function(n){return n.sign()},sqrt:function(n){return new A(Z.sqrt(n.abs()),Qn(n.angle(),B),"polar")},exp:function(n){return t.pow(n)},log:function(n){return new A(Z.log(n.abs()),n.angle())},log10:function(n){return e.log(n).div(o)},log2:function(n){return e.log(n).div(f)},sin:function(n){return new A(J(Z.sin(n.re),Z.cosh(n.im)),J(Z.cos(n.re),Z.sinh(n.im)))},cos:function(n){return new A(J(Z.cos(n.re),Z.cosh(n.im)),Vn(J(Z.sin(n.re),Z.sinh(n.im))))},tan:function(n){return e.sin(n).div(e.cos(n))},sinh:function(n){return new A(J(Z.sinh(n.re),Z.cos(n.im)),J(Z.cosh(n.re),Z.sin(n.im)))},cosh:function(n){return new A(J(Z.cosh(n.re),Z.cos(n.im)),J(Z.sinh(n.re),Z.sin(n.im)))},tanh:function(n){return e.sinh(n).div(e.cosh(n))},asin:function(n){return j.neg().mul(e.log(j.mul(n).add(e.sqrt(A(U,Q).sub(n.pow(B))))))},acos:function(n){return j.neg().mul(e.log(n.add(j.mul(e.sqrt(A(U,Q).sub(n.pow(B)))))))},atan:function(n){return j.div(B).mul(e.log(j.add(n).div(j.sub(n))))},asinh:function(n){return e.log(n.add(e.sqrt(n.pow(B).add(U))))},acosh:function(n){return e.log(n.add(e.sqrt(n.pow(B).sub(U))))},atanh:function(n){return e.log(n.add(U).div(n.neg().add(U))).div(B)}},c.complexMath=e,V.complex=A,["floor","ceil","round","fix","sign","exp","log","log10","log2","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){V[r]=e[r]?function(n){return Tn(function(n){return(u(n)?e:Z)[r](n)},n,!0)}:function(n){return Tn(function(n){return Z[r](n)},n,!1)}}),V.atan2=function(n,r){return Rn(function(n,r){return Z.atan2(n,r)},n,r,!1)},V.sqrt=function(n){return Tn(function(n){return u(n)?e.sqrt(n):$n(Q,n)?new A(Q,Z.sqrt(Vn(n))):Z.sqrt(n)},n,!0)},["sqrt","pow","log"].forEach(function(r){V["real"+r]=function(n){return Tn(function(n){u(n=Ln(n))&&d("real"+r);n=Z[r](n);return vn(n)||!bn(n)?d("real"+r):n},n,!0)}}),V.real=on,V.imag=Pr,V.conj=Xr,V.abs=zr,V.angle=function(n){return Tn(ur,n,!0)},V.norm=Lr,V.zeros=function(n,r){return Zr(V.fix(n),y(r)?V.fix(r):r)},V.ones=function(n,r){return n=V.fix(n),r=y(r)?V.fix(r):r,w(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),U)},V.eye=function(n){return Or(V.fix(n),U)},V.rand=function(n,r){return n=V.fix(n),r=y(r)?V.fix(r):r,null==n?D(W.random()):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),function(){return D(W.random())}))},V.randi=function(n,r,t){return e=V.fix(n),n=V.fix(r),r=y(t)?V.fix(t):t,e=I(e),null==n&&null==r?D(W.ceil(W.random()*e)):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),function(){return D(W.ceil(W.random()*e))}));var e},V.randn=function(n,r){return n=V.fix(n),r=y(r)?V.fix(r):r,null==n?D(dr()):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(I(n),I(r),function(){return D(dr())}))},V.magic=function(n){var t;return n=p(n=En(V.fix(n),!0))?I(n):null,!p(n)||n<=2?1===n?[[U]]:[]:(t=function n(e){var t,i,r,u,o,f,c,l=1&e,a=0==(3&e),s=e*e,h=e-l>>1;if(l)return S(e,e,function(n,r){var t=(n+1+r+1+(e-3)/2)%e;return t<0&&(t+=e),(n=(n+1+2*(r+1)-2)%e)<0&&(n+=e),e*t+n+1});if(a)return i=0,S(e,e,function(n,r){return++i,(n+1&3)>>1==(r+1&3)>>1?s-(i-1):i});if(t=h*h,f=n(h),c=S(e,e,function(n,r){return n<h?r<h?f[n][r]:f[n][r-h]+2*t:r<h?n<h?f[n][r]:f[n-h][r]+3*t:f[n-h][r-h]+t}),1<(i=(h-1)/2))for(r=1;r<=h;++r){for(u=2;u<=i;++u)o=c[r-1][u-1],c[r-1][u-1]=c[r+h-1][u-1],c[r+h-1][u-1]=o;for(u=e-i+2;u<=e;++u)o=c[r-1][u-1],c[r-1][u-1]=c[r+h-1][u-1],c[r+h-1][u-1]=o}for(r=1;r<=i;++r)o=c[r-1][0],c[r-1][0]=c[r+h-1][0],c[r+h-1][0]=o;for(r=i+2;r<=h;++r)o=c[r-1][0],c[r-1][0]=c[r+h-1][0],c[r+h-1][0]=o;return o=c[i][i-1],c[i][i-1]=c[i+h][i-1],c[i+h][i-1]=o,c}(n),S(n,n,function(n,r){return D(t[n][r])}))},V.pascal=function(n){var t,r;return 1<arguments.length&&d("pascal"),n=p(n=V.fix(En(n,!0)))?I(n):null,!p(n)||n<=0?[]:(t=S(r=n,r,function(n,r,t){return 0===n||0===r?1:t[n-1][r]+t[n][r-1]}),S(n,n,function(n,r){return D(t[n][r])}))},V.rosser=function(){return[[D(611),D(196),D(-192),D(407),D(-8),D(-52),D(-49),D(29)],[D(196),D(899),D(113),D(-192),D(-71),D(-43),D(-8),D(-44)],[D(-192),D(113),D(899),D(196),D(61),D(49),D(8),D(52)],[D(407),D(-192),D(196),D(611),D(8),D(44),D(59),D(-23)],[D(-8),D(-71),D(61),D(8),D(411),D(-599),D(208),D(208)],[D(-52),D(-43),D(49),D(44),D(-599),D(411),D(208),D(208)],[D(-49),D(-8),D(8),D(59),D(208),D(208),D(99),D(-911)],[D(29),D(-44),D(52),D(-23),D(208),D(208),D(-911),D(99)]]},V.vander=function(n){return w(n=q(n))||d("vander"),n.map(function(t){return $(n.length,function(n,r){return 0===n?U:tn(r[n-1],t)}).reverse()})},V.toeplitz=function(t,e){return 1===arguments.length?S((e=q(t)).length,e.length,function(n,r){return n===r?e[0]:n<r?e[W.abs(n-r)]:er(e[W.abs(n-r)])}):(t=q(t),e=q(e),S(t.length,e.length,function(n,r){return n===r?t[0]:(n<r?e:t)[W.abs(n-r)]}))},V.hankel=function(t,e){var i,n;return 1===arguments.length?(t=q(t),S(i=t.length,i,function(n,r){return i-1-n<r?Q:t[(n+r)%i]})):(t=q(t),e=q(e),i=t.length,S(n=e.length,n,function(n,r){return i<=n+r-1?e[n+r-i]:t[(n+r)%i]}))},V.hadamard=function(n){return function n(r){return 1===r?[[U]]:2===r?[[U,U],[U,M]]:4===r?[[U,U,U,U],[U,M,U,M],[U,U,M,M],[U,M,M,U]]:0==r%4&&(r=n(r/2)).length?nt([[U,U],[U,M]],r):[]}(I(n))},V.hilb=function(n){return S(n=I(En(n,!0)),n,function(n,r){return D(1/(n+1+r+1-1))})},V.invhilb=function(n){n=I(En(n,!0));var r=V.hilb(n);return(n<10?qt:Et)(r)},V.linspace=function(n,r,t){t=I(t=null==t?100:t);for(var e=Qn(Wn(r,n),t-1),i=new Array(t),u=0,o=n;u<t;++u,o=K(o,e))i[u]=o;return i},V.logspace=function(n,r,t){t=I(t=null==t?100:t);for(var e=Un(Qn(r,n),1/(t-1)),i=new Array(t),u=0,o=n;u<t;++u,o=tn(o,e))i[u]=o;return i},V.meshgrid=Mn(function(n,r,t){var e=r,i=t;if(null==i&&(i=e),e=q(e),i=q(i),w(e)&&w(i))return[S(i.length,e.length,function(n,r){return e[r]}),S(i.length,e.length,function(n,r){return i[n]})];d("meshgrid")},2),V.ndgrid=Mn(function(n){var r=n,t=[].slice.call(arguments,1);t=t.map(q);for(var e=[],i=$(r,function(n){return(1===t.length?t[0]:t[n]).length}),u=0;u<r;++u)e.push(An(i,function(n){return(1===t.length?t[0]:t[u])[n[u]]}));return 1===r?e[0]:e}),V.colon=function(n,r,t){return 1===arguments.length&&k(n)?qn($r(n)):$r.apply(null,arguments)},V.cat=function(n,r,t){var e,i=[];if(1===(n=I(n)))for(i=r,e=2;e<arguments.length;++e)i=Cr("vert",i,arguments[e]);else if(2===n)for(i=r,e=2;e<arguments.length;++e)i=Cr("horz",i,arguments[e]);return i},V.horzcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Cr("horz",t,arguments[e]);return t},V.vertcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Cr("vert",t,arguments[e]);return t},V.transpose=function(n){return Fr(n=kn(n)?_n(n):n)},V.ctranspose=function(n){return Wr(n=kn(n)?_n(n):n)},V.diag=Qr,V.blkdiag=function(){return t=[].slice.call(arguments),a=l=c=f=o=0,t.forEach(function(n,r){xn(n)&&(t[r]=n=[[n]]),kn(n)&&(t[r]=n=Qr(n)),Sn(n)||d("blkdiag"),o+=G(n),f+=F(n)}),e=t[c],i=G(e),u=F(e),S(o,f,function(n,r){return l+i<=n&&(l+=i,a+=u,e=t[++c],i=G(e),u=F(e)),r<a||a+u<=r?Q:e[n-l][r-a]});var t,e,i,u,o,f,c,l,a},V.tril=function(t,e){if(Sn(t))return e=I(e||0),S(G(t),F(t),function(n,r){return r<=n+e?t[n][r]:Q});d("tril")},V.triu=function(t,e){if(Sn(t))return e=I(e||0),S(G(t),F(t),function(n,r){return n+e<=r?t[n][r]:Q});d("triu")},V.repmat=function(t,e,i){return w(e)&&(i=e[1],e=e[0]),null==i&&(i=e),e=I(e),i=I(i),Sn(t=kn(t=xn(t)?[[t]]:t)?[t]:t)?S(e*G(t),i*F(t),function(n,r){return t[n%e][r%i]}):t},V.repelem=function(r,t){var e,i;if(w(r))if(w(t)){if(t.length===r.length)return e=0,i=-1,$(I(Kr(t)),function(n){return n===e&&(e+=I(t[++i])),r[i]})}else if(p(t))return t=I(t),i=-1,$(t*r.length,function(n){return 0==n%t&&++i,r[i]});return r},V.reshape=function(t,e,n){w(e)&&(n=e[1],e=e[0]),e=I(e),n=I(n);var i,r=e*n;return xn(t)&&1===e&&1===n?[[t]]:kn(t)&&t.length===r?S(e,n,function(n,r){return t[n+e*r]}):Sn(t)&&G(t)*F(t)==r?(i=G(t),S(e,n,function(n,r){n+=e*r;return t[n%i][W.floor(n/i)]})):t},V.squeeze=function(n){return n},V.rot90=function(n,r){var t=n=kn(n)?_n(n):n,n=r;if(Sn(t)){var e=G(t),i=F(t);if((n=W.round(I(n=null==n?1:n))%4)<0&&(n+=4),1===n)return S(i,e,function(n,r){return t[r][i-1-n]});if(3===n)return S(i,e,function(n,r){return t[e-1-r][n]});if(2===n)return S(e,i,function(n,r){return t[e-1-n][i-1-r]})}return t},V.flip=Ur,V.fliplr=function(n){return Ur(n,2)},V.flipud=function(n){return Ur(n,1)},V.sort=Mn(function(n,r,t,e){for(var i=2,u=null;i<arguments.length;){if("ComparisonMethod"===arguments[i]){"real"===arguments[i+1]?u=Br:"abs"===arguments[i+1]&&(u=Vr),1===i?(t=1,e="ascend"):2===i&&(e="ascend");break}i+=1}return null==e&&(e="ascend"),Gr(r,t=I(t=null==t?1:t),e,u,1<n)}),V.min=Dr,V.max=Hr,V.sum=Kr,V.prod=Jr,V.dot=Yr,V.cross=function(n,r){if(n=q(n),r=q(r),!w(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(w(r)&&3===r.length)return[rn(tn(n[1],r[2]),tn(n[2],r[1])),rn(tn(n[2],r[0]),tn(n[0],r[2])),rn(tn(n[0],r[1]),tn(n[1],r[0]))];throw"cross: input 2 not vector of length 3"},V.kron=nt,V.diff=function(n,r,t){for(null==t&&(t=1),p(r=null==r?1:r)||d("diff"),r=I(r);0<r--;)n=function r(t,n){if(w(t=q(t)))return 1<t.length?$(t.length-1,function(n){return rn(t[n+1],t[n])}):[];if(b(t)){if(1===(n=I(n=null==n?1:n)))return $(F(t),function(n){return r(E(t,n))});if(2===n)return $(G(t),function(n){return r(t[n])})}d("diff")}(n,t);return n},V.trapz=function(n,r,t){return arguments.length<3&&(k(r)?t=1:k(n)&&!k(r)&&(t=r,r=n,n=null)),rt(k(n)?q(n):n,q(r),t)},V.cumtrapz=function(n,r,t){return arguments.length<3&&(k(r)?t=1:k(n)&&!k(r)&&(t=r,r=n,n=null)),function r(t,e,i){if(y(e))return e;if(w(e)){if(null==t||y(t))return e.map(function(n,r){return rt(t,e.slice(0,r+1))});if(w(t)&&t.length===e.length)return e.map(function(n,r){return rt(t.slice(0,r+1),e.slice(0,r+1))})}else if(b(e))if(1===(i=I(i=null==i?1:i))){if(null==t||y(t)||w(t)&&t.length===G(e))return $(F(e),function(n){return r(t,E(e,n),i)});if(b(t)&&G(t)===G(e)&&F(t)===F(e))return $(F(e),function(n){return r(E(t,n),E(e,n),i)})}else if(2===i){if(null==t||y(t)||w(t)&&t.length===F(e))return $(G(e),function(n){return r(t,e[n],i)});if(b(t)&&G(t)===G(e)&&F(t)===F(e))return $(G(e),function(n){return r(t[n],e[n],i)})}d("cumtrapz")}(k(n)?q(n):n,q(r),t)},V.cumsum=function(n,r,t){n=tt(q(n),nn,t,r);return!1===n&&d("cumsum"),n},V.cumprod=function(n,r,t){n=tt(q(n),tn,t,r);return!1===n&&d("cumprod"),n},V.cummin=function(n,r,t){n=tt(q(n),function(n,r){return Hn(n,r)?n:r},t,r);return!1===n&&d("cummin"),n},V.cummax=function(n,r,t){n=tt(q(n),function(n,r){return Kn(n,r)?n:r},t,r);return!1===n&&d("cummax"),n},V.movsum=function(n,r,t){var e,i;return w(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Kr,e,i,t))&&d("movsum"),r},V.movprod=function(n,r,t){var e,i;return w(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Jr,e,i,t))&&d("movprod"),r},V.movmean=function(n,r,t){var e,i;return w(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Yt,e,i,t))&&d("movmean"),r},V.movmin=function(n,r,t){var e,i;return w(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Dr,e,i,t))&&d("movmin"),r},V.movmax=function(n,r,t){var e,i;return w(r)?(e=I(r[0]),i=I(r[1])):p(r)&&(i=1&(r=I(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=et(q(n),Hr,e,i,t))&&d("movmax"),r},V.bitshift=function(n,r){return Tn(function(n){return p(n)?On(r,Q)?I(n)>>-I(r):I(n)<<I(r):n},n,!0)},V.bitand=it,V.bitor=ut,V.bitxor=function t(r,e){if(p(r)){if(p(e))return I(r)^I(e);if(k(e))return e.map(function(n){return t(r,n)})}else if(k(r)){if(p(e))return r.map(function(n){return t(n,e)});if(k(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},V.size=function(n){return Mn(ot.apply(null,[].slice.call(arguments)))},V.length=function(n){return k(n)?n.length?W.max.apply(null,ot(n)):0:null==n?0:1},V.ndims=function(n){return 2+ot(n).slice(2).filter(function(n){return 1<n}).length},V.numel=function(n){return Jr(ot(n))},V.rows=function(n){return ot(n,1)},V.columns=function(n){return ot(n,2)},V.sub2ind=function(n,r,t){return w(r)&&(t=r[1],r=r[0]),r=I(r),t=I(t),1===n.length?r:r-1+I(n[0])*(t-1)+1},V.ind2sub=function(n,r){return r=I(r),1===n.length?[r,1]:[(r-1)%I(n[0])+1,W.floor((r-1)/I(n[0]))+1]},c.find=ft,V.find=function(n){return ft(n,function(n){return!Y(n,Q)})},c.all=ct,V.all=function(n){return ct(n,function(n){return!Y(n,Q)})},c.any=lt,V.any=function(n){return lt(n,function(n){return!Y(n,Q)})},V.isequal=function(){var n=arguments.length,r=0,t=1;for(1<n&&(t=at(arguments[0],arguments[1],!1),r=2);t&&r<n;)t=at(arguments[0],arguments[r++],!1);return t},V.isequaln=function(){var n=arguments.length,r=0,t=1;for(1<n&&(t=at(arguments[0],arguments[1],!0),r=2);t&&r<n;)t=at(arguments[0],arguments[r++],!0);return t},V.isnan=function n(r){return k(r)?r.map(n):vn(r)||u(r)&&(vn(r.re)||vn(r.im))?1:0},V.isinf=function n(r){return k(r)?r.map(n):O(r)?dn(r)?1:0:u(r)&&(dn(r.re)||dn(r.im))?1:0},V.isfinite=function n(r){return k(r)?r.map(n):O(r)?dn(r)?0:1:!u(r)||dn(r.re)||dn(r.im)?0:1},V.isreal=function(n){return ct(n,bn)},V.isempty=function(n){return k(n)?k(n[0])?n[0].length?0:1:n.length?0:1:0};var St=function(r,n,t,e){var i,u,o,f,c,l,a,s,h,m,g,p,v,d,y=G(r),w=F(r),b=w,x=0;if(e=D(e||0),dt(r,"upper",!1,e))return n?[r,$(b,function(n){return[n,n]}).filter(function(n){return n[0]<y&&n[1]<w&&!Jn(un(r[n[0]][n[1]]),e)}),Jr(Qr(r)),Or(y)]:r;for(k(t)&&(b=W.min(b,t[1])),v=vt(r,Or(y)),i=new Array(b),u=U,d=function(n,r){r=r||0;for(var t=x-1;0<=t;--t)if(n===i[t][r])return t;return-1},o=a=0;o<y&&!(b<=a);++o){for(f=o;Jn(un(v[f][a]),e);)if(y<=++f&&(f=o,b<=++a)){a=-1;break}if(-1===a)break;for(s=-1,m=null,p=0,f=c=f;f<y;++f)Jn(g=un(v[f][a]),e)?++p:null!=m&&!Hn(g,m)||(m=g,s=f);for(;-1!==s;){if(y-c===p+1){for(o!==s&&(st(v,o,s),u=tr(u)),Hn(v[o][a],Q)&&(ht(v,o,o,Q,M,a),u=tr(u)),f=s,c=o;0<=f&&-1!==(l=d(f));)f=c-=x-l;i[x++]=[f,a],u=o<b?tn(u,v[o][o]):Q;break}for(p=0,h=s,f=c;f<y;++f)f!==h&&(ht(v,f,h,tr(en(v[f][a],v[h][a])),U,a),Jn(g=un(v[f][a]),e)?++p:Hn(g,m)&&(m=g,s=f))}++a}return x<b&&(u=Q),t=pt(v,0,w,y-1,y+w-1),v=pt(v,0,0,y-1,w-1),i.length>x&&(i.length=x),n?[v,i,u,t]:v};function At(n,r,t,e){var i,u,o,f,c,l,a=G(n),s=F(n),h=s;for(e=D(e||0),k(t)&&W.min(h,t[1]),l=vt((h=St(n,!0,t,e))[0],h[3]),i=h[1],n=h[2],u=i.length,f=0;f<u;++f)for(o=i[f][1],c=0;c<f;++c)Jn(un(l[c][o]),e)||(ht(l,c,f,tr(l[c][o]),l[f][o]),Y(l[c][i[c][1]],U))||ht(l,c,c,Q,ir(l[c][i[c][1]]),i[c][1]);return Y(l[u-1][i[u-1][1]],U)||ht(l,u-1,u-1,Q,ir(l[u-1][i[u-1][1]]),i[u-1][1]),t=pt(l,0,s,a-1,a+s-1),l=pt(l,0,0,a-1,s-1),r?[l,i,n,t]:l}function _t(n,r,t){if(y(n)&&y(r))return en(r,n);if(!b(n))return[];if(!w(r=q(r))&&!b(r))return[];var e,i=F(n);if(G(n)!==i)return[];if(e=w(r)?(h=r.length,1):(h=G(r),F(r)),i!==h)return[];var u,o,f,c,l,a,s,h=St(Fr(n),!0);if(h[1].length!==i)return[];if(u=Fr(h[3]),o=Fr(h[0]),w(r)){for(f=$(i,Q),c=0;c<i;++c){if(Y(o[c][c],Q))return[];for(s=Q,l=0;l<c;++l)s=nn(s,tn(o[c][l],f[l]));f[c]=en(rn(r[c],s),o[c][c])}return $(i,function(r){return $(i,function(n){return tn(f[n],u[r][n])}).reduce(nn,Q)})}for(f=Zr(i,e),c=0;c<i;++c){if(Y(o[c][c],Q))return[];for(a=0;a<e;++a){for(s=Q,l=0;l<c;++l)s=nn(s,tn(o[c][l],f[l][a]));f[c][a]=en(rn(r[c][a],s),o[c][c])}}return S(i,e,function(r,t){return $(i,function(n){return tn(f[n][t],u[r][n])}).reduce(nn,Q)})}function qt(n){var r,t,e;return y(n)?ir(n):b(n)&&G(n)===F(n)?1===(t=r=G(n))?[[ir(n[0][0])]]:Y((e=At(n,!0))[0][r-1][t-1],Q)?[]:e[3].map(function(n,r){return n.map(function(n){return en(n,e[0][r][r])})}):[]}function Et(n){if(G(n)!==F(n))return[];for(var r=Or(G(n)),t=r,e=fr(r,n),i=0;i<4;++i)t=N(t,or(r,e)),i+1<4&&(e=N(e,e));return t}function It(n,r){var t,e,i=G(n),u=F(n);return r=r||At(n,!0),e=(t=r[1]).length,[pt(n,$(i,function(n){return n}),$(e,function(n){return t[n][1]})),pt(r[0],0,0,e-1,u-1).map(function(t,e){return t.map(function(n,r){for(r=e;r+1<u&&Y(t[r],Q);)++r;return en(n,t[r])})})]}function Nt(t,n){var r,e,i,u,o;return y(t)?ir(t):b(t)?(r=G(t),i=F(t),function t(n,e){return y(e)?y(n)?Y(n,e):n.filter(function(n){return t(n,e)}).length===n.length:!!k(e)&&(y(n)?t(e,n):n.length===e.length&&n.filter(function(n,r){return t(n,e[r])}).length===e.length)}(t,0)?Fr(t):1===r&&1===i?[[ir(t[0][0])]]:1===r||1===i?(o=t.reduce(function(n,r){return nn(n,tn(r,er(r)))},Q),S(i,r,function(n,r){return en(er(t[r][n]),o)})):(n=(e=At(t,!0,null,n||0))[1].length)===i?r===i?e[3].map(function(n,r){return n.map(function(n){return en(n,e[0][r][r])})}):N(qt(N(u=Wr(t),t)),u):n===r?N(u=Wr(t),qt(N(t,u))):(i=It(t,e),o=N(qt(N(u=Wr(o=i[0]),o)),u),n=N(u=Wr(n=i[1]),qt(N(n,u))),N(n,o))):[]}function jt(e){return y(e)?e:b(e)?e.reduce(function(n,r,t){return nn(n,t<r.length?e[t][t]:0)},0):void d("trace")}function Tt(e,n,r){r=D(r||0);var t=G(e);return t!==F(e)?Q:1===t?e[0][0]:dt(e,"lower",!0,r)||dt(e,"upper",!0,r)?e.reduce(function(n,r,t){return tn(n,e[t][t])},U):!0===n?function n(r,t){var e,i,u,o,f,c,l,a,s,h,m,g,p,v;function d(t,n,e,i){return S(n-1,n-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})}if(1===t)f=r[0][0];else if(2===t)c=r[0][0],l=r[0][1],a=r[1][0],f=rn(tn(c,s=r[1][1]),tn(l,a));else if(3===t)c=r[0][0],l=r[0][1],a=r[0][2],s=r[1][0],h=r[1][1],m=r[1][2],g=r[2][0],p=r[2][1],v=r[2][2],f=rn(rn(rn(nn(nn(tn(tn(c,h),v),tn(tn(l,m),g)),tn(tn(a,s),p)),tn(tn(a,h),g)),tn(tn(l,s),v)),tn(tn(c,m),p));else{for(e=u=i=0;e<t;++e)Y(r[0][e],Q)&&++i,Y(r[e][0],Q)&&++u;if(o=U,f=Q,i<u)for(e=0;e<t;++e)Y(r[e][0],Q)||(f=nn(f,tn(r[e][0],tn(o,n(d(r,t,e,0),t-1))))),o=U===o?M:U;else for(e=0;e<t;++e)Y(r[0][e],Q)||(f=nn(f,tn(r[0][e],tn(o,n(d(r,t,0,e),t-1))))),o=U===o?M:U}return f}(e,t):St(e,!0,null,r)[2]}function Rt(o){return S(F(o),G(o),function(n,r){return e=r,i=n,r=!0,n=G(t=o),u=F(t),n!==u?null:n<=1?0:(i=+(i||0),(e=+(e||0))<0||n<=e||i<0||u<=i?null:(n=Tt(S(n-1,u-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})),!0===r&&e+i&1?tr(n):n));var t,e,i,u})}function Mt(n,r,t){null==r&&(r=B);for(var e,i,u,o,f,c,l,a=G(n),s=a-1,h=Nn(n),m=t?$(a,U):null,g=new Array(s),p=new Array(s),v=D(1e-10),d=1;d<=100;++d){for(e=l=0;e<a;++e){for(i=0;i<s;++i)g[i]=h[u=e<=i?i+1:i][e],p[i]=h[e][u];if(f=Lr(g,r),H(c=Lr(p,r),Q)||H(f,Q))++l;else{for(o=Z.sqrt(Qn(c,f)),Cn(Z.abs(Wn(o,U)),v)&&++l,t&&(m[e]=J(o,m[e])),i=0;i<a;++i)h[i][e]=tn(h[i][e],o);for(i=0;i<a;++i)h[e][i]=en(h[e][i],o)}}if(a===l)break}return t?[m,h]:h}function Pt(n,r,t,e){var i=G(n);if(e=D(e||0),null==r){var u,o,f=t?Or(i):null,c=jn(n);for(l=1;l<=i-2;++l)for(a=i;l+2<=a;--a)Cn(un(c[a-1][l-1]),J(un(c[a-1-1][l-1]),e))||(o=[er((u=yt(c[a-1-1][l-1],c[a-1][l-1]))[0]),tr(er(u[1]))],t&&(f=wt("right",u,a-1-1,a-1,f)),c=wt("left",o,a-1-1,a-1,wt("right",u,a-1-1,a-1,c))),c[a-1][l-1]=Q;return t?[f,c]:c}var l,a,s,h,m=Wr(f=zt(r,!0,!1,e)[0]),g=Or(i),p=N(m,n),v=N(m,r);for(l=1;l<=i-2;++l)for(a=i;l+2<=a;--a)Cn(un(p[a-1][l-1]),J(un(p[a-1-1][l-1]),e))||(s=[er((h=yt(p[a-1-1][l-1],p[a-1][l-1]))[0]),tr(er(h[1]))],t&&(f=wt("right",h,a-1-1,a-1,f)),p=wt("left",s,a-1-1,a-1,p),v=wt("left",s,a-1-1,a-1,v)),p[a-1][l-1]=Q,Cn(un(v[a-1][a-1-1]),J(un(v[a-1][a-1]),e))||(h=yt(tr(v[a-1][a-1]),v[a-1][a-1-1]),t&&(g=wt("right",h,a-1-1,a-1,g)),p=wt("right",h,a-1-1,a-1,p),v=wt("right",h,a-1-1,a-1,v)),v[a-1][a-1-1]=Q;return[p,v,f,g]}function Xt(n,r){for(var t,e,i,u=G(n),o=(F(n),"upper"===r),f=Zr(u,u),c=Or(u),l=0;l<u;++l){for(t=0;t<l;++t){for(e=0,i=Q;e<t;++e)i=nn(i,tn(tn(c[l][e],er(c[t][e])),f[e][e]));c[l][t]=en(rn(o?n[t][l]:n[l][t],i),f[t][t])}for(e=0,i=Q;e<l;++e)i=nn(i,tn(tn(c[l][e],er(c[l][e])),f[e][e]));if(f[l][l]=rn(n[l][l],i),Jn(f[l][l],Q))return[]}return[c,f]}function zt(n,r,t,e){var i,u,o,f,c,l,a,s,h=G(n),m=F(n),g=r?Or(h):null,p=n,v={_:1};if(e=D(e||0),dt(p,"upper",!1,e,!0,v))p=v._;else if(p=jn(n),t)for(s={},i=$(m,function(n){return n}),f=$(m,function(n){return Lr(E(p,n),B)}),a=0;a<m;++a){for(c=f[u=a],l=a+1;l<m;++l)$n(f[l],c)&&(c=f[u=l]);if(H(c,Q))break;if(a!==u)for(o=f[a],f[a]=f[u],f[u]=o,o=i[a],i[a]=i[u],i[u]=o,l=0;l<h;++l)o=p[l][a],p[l][a]=p[l][u],p[l][u]=o;for(s.v=$(h-a,Q),bt(p,s,a,h-1,a,a,e),p=xt("left",s,p,a),l=a+1;l<h;++l)p[l][a]=Q;for(r&&(g=xt("right",s,g,a)),l=a+1;l<m;++l)f[l]=Wn(f[l],Un(un(p[a][l]),B))}else for(s={},a=0;a<m;++a){for(s.v=$(h-a,Q),bt(p,s,a,h-1,a,a,e),p=xt("left",s,p,a),l=a+1;l<h;++l)p[l][a]=Q;r&&(g=xt("right",s,g,a))}return r&&t?[g,p,i?S(m,m,function(n,r){return n===i[r]?U:Q}):Or(m)]:r?[g,p]:p}function Lt(n,r,t){return Cn(un(n[r+1][r]),J(K(un(n[r][r]),un(n[r+1][r+1])),t))&&(n[r+1][r]=Q,1)}function Zt(z,n,L,r){var t,e,i,u,o,f,c,l,a,Z,s,h,m,g,p,O,v,d,y,w,b,x,k,S,A,_,q,$=G(z),E=$-1,C={_:1},I=0,F=0;if(dt(z,"upper",!0,r=D(r||1e-10),!0,C))return n?[Or($),C._]:C._;if(o=Pt(z,null,n,r),n&&(f=o[0],o=o[1]),O=100*$,"complex"===L)for(;;){for(;0<E&&Lt(o,E-1,r);)I=0,--E;if(E<=0)break;if(++I,O<=++F)break;for(u=E-1;0<u&&!Lt(o,u-1,r);)--u;for(x=o,k=E,q=_=A=void 0,c=(S=(10===I||20===I)&&1<E)?nn(un(on(x[k][k-1])),un(on(x[k-1][k-2]))):(S=x[k-1][k-1],A=x[k-1][k],q=x[k][k-1],x=x[k][k],S=en(S,k=K(K(un(S),un(q)),K(un(A),un(x)))),A=en(A,k),q=en(q,k),x=en(x,k),A=tn(A,q),q=rn(S,x),q=V.sqrt(nn(tn(q,q),tn(A,4))),A=rn(tn(S,x),A),S=nn(S,x),_=en(nn(S,q),B),S=en(rn(S,q),B),$n(un(_),q=un(S))?S=en(A,_):H(q,Q)||(_=en(A,S)),On(un(rn(_,x)),un(rn(S,x)))?tn(_,k):tn(S,k)),o=wt("left",[er((a=yt(rn(o[u][u],c),o[u+1][u]))[0]),tr(er(a[1]))],u,u+1,o,u,null),(o=wt("right",a,u,u+1,o,0,W.min(u+2,E)))[u+1][u]=Q,n&&(f=wt("right",a,u,u+1,f)),t=u+1;t<E;++t)Z=[er((a=yt(o[t][t-1],o[t+1][t-1]))[0]),tr(er(a[1]))],o[t][t-1]=nn(tn(a[0],o[t][t-1]),tn(a[1],o[t+1][t-1])),o[t+1][t-1]=Q,o=wt("left",Z,t,t+1,o,t,null),o=wt("right",a,t,t+1,o,0,W.min(t+2,E)),n&&(f=wt("right",a,t,t+1,f))}else for(J(Lr(o,fn),J(r,r)),c=[Q],l=[Q,Q,Q];0<=E;)if((u=function(n,r,t){for(;0<r&&!Cn(un(n[r][r-1]),J(K(un(n[r-1][r-1]),un(n[r][r])),t));)--r;return r}(o,E,r))===E)o[E][E]=nn(o[E][E],c[0]),0<E&&(o[E][E-1]=Q),--E,I=0;else if(u+1===E)d=f,w=c,b="realcomplex"===L,P=X=void 0,X=en(rn((v=o)[(y=E)-1][y-1],v[y][y]),B),P=nn(tn(X,X),tn(v[y][y-1],v[y-1][y])),v[y][y]=nn(v[y][y],w[0]),v[y-1][y-1]=nn(v[y-1][y-1],w[0]),(b||Yn(P,Q))&&(w=V.sqrt(P),v=wt("left",[er((b=yt((Yn(X,Q)?nn:rn)(X,w),v[y][y-1]))[0]),tr(er(b[1]))],y-1,y,v,y-1,null),(v=wt("right",b,y-1,y,v,0,y))[y][y-1]=Q,d=d&&wt("right",b,y-1,y,d)),1<y&&(v[y-1][y-2]=Q),E-=2,I=0;else{if(++I,O<=++F)break;h=[Q,Q,Q],j=N=X=P=M=R=T=void 0;var N,j,T=o,R=E,M=l,P=c,X=0<I&&I%16==0?I%32!=0?"wilkinson":"matlab":"none";if(M[0]=T[R][R],M[1]=T[R-1][R-1],M[2]=tn(T[R][R-1],T[R-1][R]),"wilkinson"===X){for(P[0]=nn(P[0],M[0]),N=0;N<=R;++N)T[N][N]=rn(T[N][N],M[0]);j=nn(un(T[R][R-1]),un(T[R-1][R-2])),M[0]=tn(j,.75),M[1]=tn(j,.75),M[2]=tn(tn(j,j),-.4375)}else if("matlab"===X&&Kn(j=nn(tn(j=en(rn(M[1],M[0]),B),j),M[2]),Q)){for(j=V.sqrt(j),j=nn(j=Hn(M[1],M[0])?tr(j):j,en(rn(M[1],M[0]),B)),j=en(rn(M[0],M[2]),j),P[0]=nn(P[0],j),N=0;N<=R;++N)T[N][N]=rn(T[N][N],j);M[0]=D(.964),M[1]=M[2]=M[0]}for(i=E-2;u<=i&&(s=o[i][i],g=rn(l[0],s),p=rn(l[1],s),h[0]=nn(en(rn(tn(g,p),l[2]),o[i+1][i]),o[i][i+1]),h[1]=rn(rn(rn(o[i+1][i+1],s),g),p),h[2]=o[i+2][i+1],i!==u)&&(g=tn(o[i][i-1],nn(un(h[1]),un(h[2]))),p=tn(h[0],nn(nn(un(o[i-1][i-1]),un(s)),un(o[i+1][i+1]))),!Hn(un(g),tn(p,r)));--i);for((m={}).v=[U,Q,Q],e=i;e<=E-2;++e)e===i?bt(h,m,0,2,0,0):bt(o,m,e,e+2,e-1,e-1),Y(m.beta,Q)||(e===i&&u<e?o[e][e-1]=tr(o[e][e-1]):e!==i&&(o[e][e-1]=m.beta),o=xt("left",m,o,e,e+2,e,null),o=xt("right",m,o,e,e+2,0,W.min(E,e+3)),n&&(f=xt("right",m,f,e,e+2)));for(m.v=[U,Q],bt(o,m,E-1,E,E-2,E-2),Y(m.beta,Q)||(o[E-1][E-2]=m.beta,o=xt("left",m,o,E-1,E,E-1,null),o=xt("right",m,o,E-1,E,0,E),n&&(f=xt("right",m,f,E-1,E))),t=i+2;t<=E;++t)o[t][t-2]=Q,i+2<t&&(o[t][t-3]=Q)}return n?[f,o]:o}function Ot(n,r,t,e){r=D(r=O(r)?r:cn);var i,u=F(n),o=G(n);if(o<u)return i=Ot(Fr(n),r,e,t),t&&e?[Fr(i[2]),i[1],Fr(i[0])]:t||e?[Fr(i[0]),i[1]]:i;var f,c,l,a,s,h,m,g,p,v,d,y,w,b,x,k,S,A,_,z,q,E=t?o:0,I=e?u:0,N=jn(n),j=E?Zr(o,E):null,T=$(u,Q),R=I?Zr(u,I):null,L=Qn(hn.realmin,r),M=new Array(u),P=new Array(u),X=new Array(u);for(P[0]=Q,b=1;b<=u;++b){for(S=b+1,l=Q,y=b;y<=o;++y)l=K(l,K(Un(on(N[y-1][b-1]),B),Un(Pr(N[y-1][b-1]),B)));if(M[b-1]=Q,$n(l,L)&&(l=Z.sqrt(l),M[b-1]=l,s=H(a=un(N[b-1][b-1]),Q)?U:en(N[b-1][b-1],a),N[b-1][b-1]=tn(s,K(l,a)),b!==u+0)){for(w=S;w<=u+0;++w){for(s=Q,y=b;y<=o;++y)s=nn(s,tn(er(N[y-1][b-1]),N[y-1][w-1]));for(s=en(s,J(l,K(l,a))),y=b;y<=o;++y)N[y-1][w-1]=rn(N[y-1][w-1],tn(s,N[y-1][b-1]))}for(s=tr(nr(er(N[b-1][b-1]))),w=S;w<=u+0;++w)N[b-1][w-1]=tn(s,N[b-1][w-1])}if(b===u)break;for(l=Q,w=S;w<=u;++w)l=K(l,K(Un(on(N[b-1][w-1]),B),Un(Pr(N[b-1][w-1]),B)));if(P[S-1]=Q,$n(l,L)){for(l=Z.sqrt(l),P[S-1]=l,s=H(a=un(N[b-1][S-1]),Q)?U:en(N[b-1][S-1],a),N[b-1][S-1]=tn(s,K(l,a)),y=S;y<=o;++y){for(s=Q,w=S;w<=u;++w)s=nn(s,tn(er(N[b-1][w-1]),N[y-1][w-1]));for(s=en(s,J(l,K(l,a))),w=S;w<=u;++w)N[y-1][w-1]=rn(N[y-1][w-1],tn(s,N[b-1][w-1]))}for(s=tr(nr(er(N[b-1][S-1]))),y=S;y<=o;++y)N[y-1][S-1]=tn(N[y-1][S-1],s)}}for(h=Q,b=1;b<=u;++b)T[b-1]=M[b-1],X[b-1]=P[b-1],h=Hr([h,K(T[b-1],X[b-1])]);if(h=J(r,h),0<E)for(w=1;w<=E;++w)j[w-1][w-1]=U;if(0<I)for(w=1;w<=I;++w)R[w-1][w-1]=U;for(k=1;k<=u;++k){for(b=u+1-k,z=1;z<=100;++z){for(q=!0,_=1;_<=b;++_){if(Cn(Z.abs(X[(x=b+1-_)-1]),h)){q=!1;break}if(Cn(Z.abs(T[x-1-1]),h)){q=!0;break}}if(q)for(d=Q,v=U,A=x-1,y=x;y<=b&&(g=J(v,X[y-1]),X[y-1]=J(d,X[y-1]),!Cn(Z.abs(g),h));++b)if(a=vr(g,p=T[y-1]),d=Qn(p,T[y-1]=a),v=Vn(Qn(g,a)),0<E)for(w=1;w<=u;++w)f=on(j[w-1][A-1]),c=on(j[w-1][y-1]),j[w-1][A-1]=K(J(f,d),J(c,v)),j[w-1][y-1]=Wn(J(c,d),J(f,v));if(a=T[b-1],x===b)break;for(f=T[x-1],c=T[b-1-1],m=X[b-1-1],p=X[b-1],m=vr(g=Qn(K(J(Wn(c,a),K(c,a)),J(Wn(m,p),K(m,p))),J(B,J(p,c))),U),On(g,Q)&&(m=Vn(m)),g=Qn(K(J(Wn(f,a),K(f,a)),J(Wn(Qn(c,K(g,m)),p),p)),f),v=d=U,y=A=x+1;A<=b;++A){if(m=X[y-1],c=T[y-1],p=J(v,m),m=J(d,m),a=vr(p,g),d=Qn(g,X[y-1-1]=a),v=Qn(p,a),g=K(J(f,d),J(m,v)),m=Wn(J(m,d),J(f,v)),p=J(c,v),c=J(c,d),0<I)for(w=1;w<=u;++w)f=on(R[w-1][y-1-1]),a=on(R[w-1][y-1]),R[w-1][y-1-1]=K(J(f,d),J(a,v)),R[w-1][y-1]=Wn(J(a,d),J(f,v));if(a=vr(p,g),d=Qn(g,T[y-1-1]=a),v=Qn(p,a),g=K(J(d,m),J(v,c)),f=Wn(J(d,c),J(v,m)),0<E)for(w=1;w<=u;++w)c=on(j[w-1][y-1-1]),a=on(j[w-1][y-1]),j[w-1][y-1-1]=K(J(c,d),J(a,v)),j[w-1][y-1]=Wn(J(a,d),J(c,v))}X[x-1]=Q,X[b-1]=g,T[b-1]=f}if(On(a,Q)&&(T[b-1]=Vn(a),0<I))for(w=1;w<=u;++w)R[w-1][b-1]=tr(R[w-1][b-1])}for(b=1;b<=u;++b){for(m=-1,y=w=b;y<=u;++y)$n(T[y-1],m)&&(m=T[y-1],w=y);if(w!==b){if(T[w-1]=T[b-1],T[b-1]=m,0<I)for(y=1;y<=u;++y)s=R[y-1][w-1],R[y-1][w-1]=R[y-1][b-1],R[y-1][b-1]=s;if(0<E)for(y=1;y<=u;++y)s=j[y-1][w-1],j[y-1][w-1]=j[y-1][b-1],j[y-1][b-1]=s}}if(0<E)for(k=1;k<=u;++k)if(!H(M[(b=u+1-k)-1],Q)){for(s=tr(nr(N[b-1][b-1])),w=1;w<=E;++w)j[b-1][w-1]=tn(s,j[b-1][w-1]);for(w=1;w<=E;++w){for(s=Q,y=b;y<=o;++y)s=nn(s,tn(er(N[y-1][b-1]),j[y-1][w-1]));for(s=en(s,tn(un(N[b-1][b-1]),M[b-1])),y=b;y<=o;++y)j[y-1][w-1]=rn(j[y-1][w-1],tn(s,N[y-1][b-1]))}}if(0<I&&2<=u)for(k=2;k<=u;++k)if(!H(P[(S=(b=u+1-k)+1)-1],Q)){for(s=tr(nr(er(N[b-1][S-1]))),w=1;w<=I;++w)R[S-1][w-1]=tn(s,R[S-1][w-1]);for(w=1;w<=I;++w){for(s=Q,y=S;y<=u;++y)s=nn(s,tn(N[b-1][y-1],R[y-1][w-1]));for(s=en(s,tn(un(N[b-1][S-1]),P[S-1])),y=S;y<=u;++y)R[y-1][w-1]=rn(R[y-1][w-1],tn(s,er(N[b-1][y-1])))}}return t&&e?[Ln(j),T,Ln(R)]:t||e?[Ln(j||R),T]:T}V.planerot=Mn(function(n,r){w(r=q(r))&&2===r.length||d("planerot");var t=yt(r[0],r[1]),t=[[t[0],t[1]],[tr(t[1]),t[0]]];return 1<n?[t,N(t,qn(r))]:t}),V.ref=Mn(function(n,r,t){b(r=y(r)?[[r]]:r)||d("ref");r=St(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),V.rref=Mn(function(n,r,t){b(r=y(r)?[[r]]:r)||d("rref");r=At(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),V.linsolve=_t,V.null=function(n,r){return r=r,i=F(t=n),u=(t=At(n,!0,null,r))[0],o=t[1],f=o.length,r=o.reduce(function(n,r){for(var t=0;t<n.length&&r[1]>n[t];)++t;return t<n.length&&r[1]===n[t]&&n.splice(t,1),n},$(i,function(n){return n})),c=f?o.reduce(function(n,r,t){return tn(n,u[t][r[1]])},U):U,r.map(function(r){for(var n,t=$(i,function(n){return n===r?c:Q}),e=0;e<f;++e)(n=o[e][1])<=r&&(t[n]=rn(t[n],tn(en(c,u[e][n]),u[e][r])));return t});var t,i,u,o,f,c},V.rowspace=function(n,r){return St(t=n,!0,null,r)[1].map(function(n){return t[n[0]]});var t},V.colspace=function(n,r){return St(t=n,!0,null,r)[1].map(function(r){return $(t.length,function(n){return t[n][r[1]]})});var t},V.rank=function(n){return b(n=y(n)?[[n]]:n)||d("rank"),St(n,!0)[1].length},V.inv=function(n){return y(n)&&(x=[[n]]),b(n)||d("inv"),qt(n)},V.ainv=function(n){return y(n)&&(x=[[n]]),b(n)||d("ainv"),Et(n)},V.rankf=function(n){return b(n=y(n)?[[n]]:n)||d("rankf"),It(n)},V.pinv=function(n,r){return b(n=y(n)?[[n]]:n)||d("pinv"),Nt(n,r)},V.cond=function(n,r){b(n=y(n)?[[n]]:n)||d("cond");var t=qt(n);return t&&t.length?tn(Lr(n,r=null==r?2:r),Lr(t,r)):fn},V.trace=jt,V.det=function(n){return b(n=y(n)?[[n]]:n)||d("det"),Tt(n,!1,1e-15)},V.charpoly=function(n){b(n)&&G(n)===F(n)||d("charpoly");var e,r=G(n),i=(F(n),r),u=new Array(i+1),t=Zr(i,i);for(u[i]=U,e=1;e<=i;++e)t=N(n,t).map(function(n,t){return n.map(function(n,r){return t===r?nn(n,u[i-e+1]):n})}),u[i-e]=en(jt(N(n,t)),-e);return Ln(u.reverse())},V.adjoint=function(n){return b(n)&&G(n)===F(n)||d("adjoint"),Rt(n)},V.balance=Mn(function(n,r,t){b(r=y(r)?[[r]]:r)&&G(r)===F(r)||d("balance");var e=Mt(r,B,1<n);return 2<n?[e[0],$(G(r),function(n){return n+1}),e[1]]:1<n?[Qr(e[0]),e[1]]:e}),V.hess=Mn(function(n,r,t){return b(r=y(r)?[[r]]:r)&&G(r)===F(r)||d("hess"),2<arguments.legnth?(b(t=y(t)?[[t]]:t)&&G(t)===F(t)||d("hess"),Pt(r,t,2<n)):Pt(r,null,1<n)}),V.ldl=Mn(function(n,r,t){b(r=y(r)?[[r]]:r)&&G(r)===F(r)||d("ldl");t=Xt(r,t);return t.length||d("ldl"),2<n&&t.push(Or(G(r))),t},2),V.chol=Mn(function(n,r,t){b(r=y(r)?[[r]]:r)&&G(r)===F(r)||d("chol");r=Xt(r,t=t||"upper");return r.length||d("chol"),"lower"===t?N(r[0],V.sqrt(r[1])):Wr(N(r[0],V.sqrt(r[1])))}),V.lu=Mn(function(n,r){b(r=y(r)?[[r]]:r)||d("lu");var t,r=function(n,r){var t,e,i,u,o,f,c,l,a,s,h,m,g,p,v;for(r=D(r||0),t=G(n),e=F(n),v=!1,o=jn(n),u=Or(t),f=$(t,Q),i=Or(t),c=U,l=0;l<t-1;++l){if(Jn(un(o[l][l]),r)){for(h=l+1,m=!0;h<t&&m;)Jn(un(o[h][l]),r)?++h:m=!1;if(t<=h){v=!0;break}st(o,l,h),st(i,l,h)}for(g=o[l][l],u[l][l]=g,f[l]=tn(c,g),a=l+1;a<t;++a){for(p=o[a][l],u[a][l]=p,s=l+1;s<e;++s)o[a][s]=en(rn(tn(g,o[a][s]),tn(o[l][s],p)),c);o[a][l]=Q}c=o[l][l]}return v?[]:(f[t-1]=c,[f,u,o,i])}(r);if(r.length)return t=Qr(r[0].map(ir)),2<n?[N(r[1],t),r[2],r[3]]:[N(Fr(r[3]),N(r[1],t)),r[2]];throw"lu: defficient matrix"},2),V.qr=Mn(function(n,r){return b(r=y(r)?[[r]]:r)||d("qr"),zt(r,1<n,2<n)}),V.schur=Mn(function(n,r,t){return b(r=y(r)?[[r]]:r)&&G(r)===F(r)||d("schur"),Zt(r,1<n,"complex"!==t&&V.isreal(r)?"real":"complex")}),V.eig=Mn(function(n,r,t){b(r)&&G(r)===F(r)||d("eig"),b(t)&&d("eig");var e=null;return"nobalance"!==t&&(1<n?(e=Mt(r,null,!0),r=e[1],e=e[0]):r=Mt(r,null,!1)),1<n?(t=function(t,n,r,e){var i,u,o,f,c,l,a,s,h,m,g,p,v=Zt(t,!0,V.isreal(t)?"realcomplex":"complex",e);if(t=v[1],v=v[0],o=G(t),f=$(o,function(n){return Ln(t[n][n])}),n||r)for(s=$(o,function(n){return n}).sort(function(n,r){var n=f[n],r=f[r],t=un(n),e=un(r),n=on(n),r=on(r);return $n(e,t)?1:On(e,t)?-1:$n(r,n)?1:On(r,n)?-1:0}),n&&(c=new Array(o)),r&&(l=new Array(o)),p=$(o,Q),i=0;i<o;++i){for(h=f[s[i]],u=s[i]-(g=1);0<=u&&Cn(un(rn(h,f[u])),e);)++g,--u;m=S(o,o,function(n,r){return n===r?rn(t[n][n],h):t[n][r]}),p[g-1]=U,n&&(a=kt("upper",m,null,p,e),c[s[i]]=lr(a,Lr(a))),r&&(a=Xr(kt("lower",Wr(m),null,p,e)),l[s[i]]=lr(a,Lr(a))),p[g-1]=Q}return[f,n?N(v,Ln(Fr(c))):null,r?N(Wr(v),Ln(Fr(l))):null]}(r,1<n,2<n,1e-16),[e&&t[1]?N(Qr(e),t[1]):t[1],Qr(t[0]),e&&t[2]?N(Qr(e.map(Gn)),t[2]):t[2]]):Ln($(G(r=dt(r,"lower",!0,1e-16)?r:Zt(r,!1,V.isreal(r)?"realcomplex":"complex",1e-16)),function(n){return r[n][n]}))}),V.svd=Mn(function(n,r,t){return b(r=y(r)?[[r]]:r)||d("svd"),1<n?[(n=Ot(r,t,1<n,2<n))[0],Qr(n[1]),n[2]]:Ot(r,t,!1,!1)});var $t=function(n,r,t){for(var e,i,u,o,f,c,l,a=G(n),s=F(n),h=s,m=Q,g=t?vt(n,Or(a)):n,p=0,v=0;v<a&&!(h<=p);++v){for(e=v;Jn(un(g[e][p]),m);)if(a<=++e&&(e=v,h<=++p)){p=-1;break}if(-1===p)break;for(u=-1,f=null,l=0,e=i=e;e<a;++e)Jn(c=un(g[e][p]),m)?++l:null!=f&&!Hn(c,f)||(f=c,u=e);for(;-1!==u;){if(a-i===l+1){if(v!==u&&st(g,v,u),Hn(g[v][p],Q)&&ht(g,v,v,Q,M,p),r)for(c=g[v][p],e=0;e<v;++e)Yn(un(g[e][p]),c)&&ht(g,e,v,tr(V.floor(en(g[e][p],c))),U,p),Hn(g[e][p],Q)&&ht(g,e,v,U,U,p);e=u,i=v;break}for(l=0,o=u,e=i;e<a;++e)e!==o&&(ht(g,e,o,tr(V.floor(en(g[e][p],g[o][p]))),U,p),Jn(c=un(g[e][p]),m)?++l:Hn(c,f)&&(f=c,u=e))}++p}return t?[pt(g,0,s,a-1,a+s-1),pt(g,0,0,a-1,s-1)]:g};function Ct(n,r){for(var t,e,i,u,o,f,c=G(n),l=S(c,c,Q),a={err:0},s=0;s<c;++s)for(l[s][s]=V.sqrt(n[s][s]),t=i=s-1;0<=t;--t){for(u=Q,e=t+1;e<=i;++e)u=nn(u,tn(l[t][e],l[e][s]));o=rn(n[t][s],u),f=nn(l[t][t],l[s][s]),Y(o,Q)?l[t][s]=Q:(Y(f,Q)&&(a.err=1),l[t][s]=en(o,f))}return r&&null!=r.err&&(r.err=a.err),l}function Ft(n){for(var r,t=Or(G(n)),e=Hr([Q,K(U,Z.floor(Z.log2(Lr(n,fn))))]),i=or(t,r=n=lr(n,Un(B,e))),u=2;u<=25;++u)i=or(i,r=lr(N(n,r),D(u)));for(u=1,e=I(e);u<=e;++u)i=N(i,i);return i}function Wt(n,r){var t,e,i,u=G(n),o=Mt(n,null,!0),f=o[0],c=Or(u),l=D(.013325),a=0,s=0,h={err:0};for(n=o[1];$n(Lr(fr(n,c),fn),l)&&(n=Ct(n,h),++a,20<++s&&(h.err=1),!h.err););if(e=t=n=fr(n,c),!h.err)for(i=2,0;i<=10;++i)e=(1&i?or:fr)(e,lr(t=sr(n,t),D(i)));return 0<a&&(e=cr(e,Un(B,a))),r&&null!=r.err&&(r.err=h.err),N(N(Qr(f),e),Qr(f.map(Gn)))}function Qt(n){for(var r,t,e,i,u,o,f=G(n),c=Or(f),l=0;l<f;++l)c[l][l]=H(on(o=n[l][l]),Q)?H(Pr(o),Q)?U:Z.sign(Pr(o)):Z.sign(on(o));for(e=0;e<f-1;++e)for(l=0;l<f-e;++l)if(i=rn(n[r=l+e][r],n[l][l]),Y(c[l][l],tr(c[r][r]))){if(u=tn(n[l][r],rn(c[r][r],c[l][l])),0<e)for(t=l+1;t<=r-1;++t)u=nn(u,rn(tn(n[l][t],c[t][r]),tn(c[l][t],n[t][r])));c[l][r]=en(u,i)}else for(t=l+1;t<=r-1;++t)c[l][r]=en(tn(tr(c[l][t]),c[t][r]),nn(c[l][l],c[r][r]));return c}function Ut(n){var r,t,e,i,u,o,f,c,l=[D(34417071e-12),D(.004807320816),D(.039685094175),D(.126262963075),D(.25856709354),D(.416519074566),D(.580947286323),D(.738997052037),D(.883885725911),D(1.013025759393),D(1.126269612452),D(1.22469915728)],a=G(n),n=Zt(n,!0,"complex"),s=n[0],h=n[1],m=Or(a),g=0,p=0,v=Qr(h);for(lt(v,function(n){return H(Pr(n),Q)&&(H(on(n),M)||H(on(n),U))})&&console.warn("acosm: input must not have an eigenvalue of 1 or -1 else result may be unreliable!");Kn(Lr(fr(U,v),fn),l[7]);)++g,v=V.sqrt(lr(or(U,v),B));for(j=1;j<=g;++j)h=Ct(lr(or(m,h),B));for(;0===p;){if(Cn(t=$n(t=Un(Lr(c=sr(f=fr(m,h),f),fn),.5),r=Un(Lr(c=sr(f,c),fn),1/3))?t:r,l[0])){p=1;break}if(Cn(t,l[1])){p=2;break}if(Cn(r=$n(r,t=Un(Lr(c=sr(f,c),fn),.25))?r:t,l[2])){p=3;break}if(Cn(r,l[3])){p=4;break}if(Cn(r,l[4])){p=5;break}if(Cn(t=On(r,t=$n(t,c=Un(Lr(sr(f,c),fn),.2))?t:c)?r:t,l[5])){p=6;break}if(Cn(t,l[6])){p=7;break}if(Cn(t,l[7])){p=8;break}h=Ct(lr(or(m,h),B)),++g}return i=1===p?(e=[U,D(-.1417)],[U,D(-.225)]):2===p?(e=[U,D(-.3891),D(.0187)],[U,D(-.4724),D(.0393)]):3===p?(e=[U,D(-.6381843806),D(.0998258508),D(-.002422303)],[U,D(-.721517714),D(.141202327),D(-.0062410636)]):4===p?(e=[U,D(-.8877087699),D(.2433623027),D(-.0212197774),D(.0003104661)],[U,D(-.9710421032),D(.3055324779),D(-.0340541349),D(939467e-9)]):5===p?(e=[U,D(-1.1374227978),D(.4493652033),D(-.0719901333),D(.004045028),D(-395692e-10)],[U,D(-1.2207561311),D(.5323448809),D(-.0990433864),D(.0072305607),D(-.0001367979)]):6===p?(e=[U,D(-1.3872329589),D(.7178511241),D(-.1703500659),D(.0182193375),D(-.0007178871),D(50248e-10)],[U,D(-1.4705662922),D(.8216483151),D(-.216827998),D(.027189845),D(-.0014099871),D(194672e-10)]):7===p?(e=[U,D(-1.637098276),D(1.0488276715),D(-.331921349),D(.0537536569),D(-.0041439924),D(121116e-9),D(-6.365e-7)],[U,D(-1.7204316094),D(1.1734469723),D(-.4030308611),D(.0730391826),D(-.0066542668),D(258653e-9),D(-2724e-9)]):8===p?(e=[U,D(-1.8869980457),D(1.4422987012),D(-.5723275787),D(.1254739271),D(-.0149128371),D(.0008717583),D(-19676e-9),D(8.05e-8)],[U,D(-1.970331379),D(1.5877429828),D(-.6732761377),D(.1609063722),D(-.0215156706),D(.0014963185),D(-453099e-10),D(3.763e-7)]):(e=[U],[U]),n=$(e.length,function(n,r){return 0===n?m:1===n?f:sr(f,r[n-1])}),u=Zr(a,a),o=Zr(a,a),n.forEach(function(n,r){u=or(u,cr(e[r],n)),o=or(o,cr(i[r],n))}),a=N(cr(_t(o,u),X),Ct(f)),N(N(s,cr(Un(B,g),a)),Wr(s))}V.hermiteForm=Mn(function(n,r){return b(r=y(r)?[[r]]:r)||d("hermiteForm"),$t(V.round(V.real(r)),!0,1<n)}),V.smithForm=Mn(function(n,r){b(r=y(r)?[[r]]:r)||d("smithForm");r=function(n,r,t){var e,i,u,o,f,c,l,a,s,h,m,g,p,v,d,y,w,b,x,k=G(n),S=F(n),A=W.min(k,S);for(r&&(e=Or(k)),t&&(i=Or(S)),u=-1,o=0;o<k;++o){for(s=!1,f=u+1;f<S;++f){for(m=0;m<k&&H(n[m][f],Q);++m);if(m<k){s=!0;break}}if(!s)break;if(H(n[o][f],Q)){for(l=0;l<k&&H(n[l][f],Q);++l);mt(n,o,l,Q,U,U,Q),r&&gt(e,o,l,Q,U,U,Q)}for(gt(n,f,o,Q,U,U,Q),t&&mt(i,f,o,Q,U,U,Q),f=o,c=!0;c;){for(c=!1,l=o+1;l<k;++l)H(n[l][f],Q)||(c=!0,H(Q,Bn(n[l][f],n[o][f]))||(p=(g=_e([n[o][f],n[l][f]]))[1],v=g[2],d=Qn(n[l][f],g[0]),y=Qn(n[o][f],g[0]),mt(n,o,l,p,v,Vn(d),y),r&&gt(e,o,l,y,Vn(v),d,p)),w=Qn(n[l][f],n[o][f]),mt(n,o,l,U,Q,Vn(w),U),r&&gt(e,o,l,U,Q,w,U));for(a=f+1;a<S;++a)H(n[o][a],Q)||(c=!0,H(Q,Bn(n[o][a],n[o][f]))||(p=(g=_e([n[o][f],n[o][a]]))[1],v=g[2],d=Qn(n[o][a],g[0]),y=Qn(n[o][f],g[0]),gt(n,f,a,p,Vn(d),v,y),t&&mt(i,f,a,y,d,Vn(v),p)),w=Qn(n[o][a],n[o][f]),gt(n,f,a,U,Vn(w),Q,U),t&&mt(i,f,a,U,w,Q,U))}u=f}for(h=0;h<A;++h)for(m=h-1;0<=m;--m)H((g=_e([n[m][m],n[h][h]]))[0],Q)||(p=g[1],v=g[2],d=Qn(n[h][h],g[0]),y=Qn(n[m][m],g[0]),b=J(v,d),x=Wn(U,J(p,y)),mt(n,m,h,U,v,d,Wn(b,U)),r&&gt(e,m,h,Wn(U,b),v,d,M),gt(n,m,h,p,x,U,Vn(y)),t&&mt(i,m,h,y,x,U,Vn(p)));return r&&t?[n,e,i]:r?[n,e]:t?[n,i]:n}(V.round(V.real(r)),1<n,1<n);return 1<n?[r[1],r[2],r[0]]:r}),V.sqrtm=Mn(function(n,r){if(2<n)throw"sqrtm: output not supported";if(y(r))return 1<n?[V.sqrt(r),Q]:V.sqrt(r);b(r)&&G(r)===F(r)||d("sqrtm");var t,e,i=N(N(e=(i=Zt(i=r,!0,"complex"))[0],Ct(i[1],t)),Wr(e));return 1<n?[i,en(Lr(fr(r,N(i,i)),U),Lr(r,U))]:i}),V.expm=function(n){return y(n)?V.exp(n):(b(n)&&G(n)===F(n)||d("expm"),Ft(n))},V.logm=Mn(function(n,r){var t,e,i={err:0},r=y(r)?V.log(r):(b(r)&&G(r)===F(r)||d("logm"),t=i,N(N(e=(r=Zt(r=r,!0,"complex"))[0],Wt(r[1],t)),Wr(e)));return 1<n?[r,i.err]:r}),V.signm=function(n){return y(n)?V.sign(n):(b(n)&&G(n)===F(n)||d("signm"),N(N(r=(n=Zt(n=n,!0,"complex"))[0],Qt(n[1])),Wr(r)));var r},V.cosm=function(n){return y(n)?V.cos(n):(b(n)&&G(n)===F(n)||d("cosm"),lr(or(Ft(cr(n,j)),Ft(cr(n,tn(M,j)))),B))},V.sinm=function(n){return y(n)?V.sin(n):(b(n)&&G(n)===F(n)||d("sinm"),lr(fr(Ft(cr(n,j)),Ft(cr(n,tn(M,j)))),tn(B,j)))},V.coshm=function(n){return y(n)?V.cosh(n):(b(n)&&G(n)===F(n)||d("coshm"),lr(or(Ft(n),Ft(cr(n,M))),B))},V.sinhm=function(n){return y(n)?V.sinh(n):(b(n)&&G(n)===F(n)||d("sinhm"),lr(fr(Ft(n),Ft(cr(n,M))),B))},V.acosm=function(n){return y(n)?V.acos(n):(b(n)&&G(n)===F(n)||d("acosm"),Ut(n))},V.asinm=function(n){return y(n)?V.asin(n):(b(n)&&G(n)===F(n)||d("asinm"),fr(Or(G(n),D(R/2)),Ut(n)))},V.acoshm=function(n){return y(n)?V.acosh(n):(b(n)&&G(n)===F(n)||d("acoshm"),r=G(n=n),t=(n=Zt(n,!0,"complex"))[0],e=Qr(n=n[1]),r=Or(r),lt(e,function(n){return H(Pr(n),Q)&&On(Q,on(n))&&Cn(on(n),U)})?N(N(t,Wt(or(n,sr(Ct(fr(n,r)),Ct(or(n,r)))))),Wr(t)):cr(N(N(t,sr(Qt(cr(n,tn(M,j))),Ut(n))),Wr(t)),j));var r,t,e},V.asinhm=function(n){return y(n)?V.asinh(n):(b(n)&&G(n)===F(n)||d("asinhm"),cr(V.asinm(cr(n,tn(M,j))),j))};var Bt=.254829592,Vt=-.284496736,Gt=1.421413741,Dt=-1.453152027,Ht=1.061405429,Kt=.3275911;function Jt(n){n=on(n);var r,t=Z.sign(n)||1;return t<0&&(n=Vn(n)),r=Gn(K(J(Kt,n),U)),J(t,Wn(U,J(K(J(K(J(K(J(K(J(Ht,r),Dt),r),Gt),r),Vt),r),Bt),J(r,Z.exp(Vn(J(n,n)))))))}function Yt(r,n){if(y(r))return r;if(w(r))return r.length?en(Kr(r),D(r.length)):l;if(b(r)){if(1===(n=I(n=null==n?1:n)))return $(F(r),function(n){return Yt(E(r,n))});if(2===n)return $(G(r),function(n){return Yt(r[n])})}d("mean")}function ne(r,n,t){if(n=I(n||0),y(r))return Q;if(w(r))return 0===r.length?l:1===r.length?Q:Z.sqrt(en(Kr(ar(zr(fr(r,Yt(r))),D(2))),D(1===n?r.length:r.length-1)));if(b(r)){if(1===(t=I(t=null==t?1:t)))return $(F(r),function(n){return ne(E(r,n))});if(2===t)return $(G(r),function(n){return ne(r[n])})}d("std")}function re(e,n,i){if(i=I(i||0),2!==arguments.length||0!==I(n)&&1!==I(n)||(i=I(n),n=null),null==n){if(y(e))return Q;var r;if(w(e))return e.length<=1?e.length?Q:l:(t=e.length,r=Yt(e),en(Kr(cr(Xr(r=fr(e,r)),r)),D(1===i?t:t-1)));if(b(e))return S(F(e),F(e),function(n,r,t){return n===r?re(E(e,n),i):r<n?t[r][n]:re(E(e,n),E(e,r),i)})}else{if(y(e)&&y(n))return Zr(2,2);if(b(e)&&b(n)&&(e=$r(e),n=$r(n)),w(e)&&w(n)){if(e.length!==n.length)throw"cov: inputs not of same dimension";var t;return e.length<=1?e.length?Q:l:(t=e.length,en(Kr(cr(Xr(fr(e,Yt(e))),fr(n,Yt(n)))),D(1===i?t:t-1)))}}d("cov")}function te(n,r,t){for(var e,i=r.length,u=0,o=fn,f=0;f<i;++f)r[f]&&r[f].length&&On(e=t(n,r[f]),o)&&(o=e,u=f);return[u,o]}function ee(n){return n.length?Yt(n):n}function ie(i,n,r){return $(n,function(e){return ee(r.reduce(function(n,r,t){return r===e&&n.push(i[t]),n},[]))})}function ue(t,n,r,e){return t=t.slice(),$(n,function(n){var r=t.length?W.round(W.random()*(t.length-1)):-1;return-1<r?t.splice(r,1)[0]:[]})}function oe(n,t,r,e){var i=n.length;return Ie(n.slice()).reduce(function(n,r){return!n.length||n[n.length-1].length+1>i/t?n.push([r]):n[n.length-1].push(r),n},[]).map(ee)}function fe(n,r,t,e){for(var i,u,o,f,c,l=n.length,a=[n[W.round(W.random()*(l-1))]],s=new Array(l);a.length<r;){for(o=Q,u=0;u<l;++u)i=te(n[u],a,t)[1],s[u]=un(tn(i,er(i))),o=K(o,s[u]);for(f=J(o,W.random()),c=Q,u=0;u<l;++u)if(Fn(c=K(c,s[u]),f)){a.push(n[u]);break}}return a}function ce(n,r){var t,e,i,u,o,f=n.length,c=r.length,l=f+c-1;if(!f||!c)return[];for(o=new Array(l),f<c&&(u=n,f=(n=r).length,c=(r=u).length),t=0;t<l;++t)for(o[t]=Q,e=0;e<c;++e)0<=(i=t-e)&&i<f&&(o[t]=nn(o[t],tn(n[i],r[e])));return o}function le(n,r,t){var e,i=[],u=n.slice(),o=u.length-r.length,f=r;if(0<=o)for(i=$(o+1,Q);0<=o;){for(e=o,r=f.concat($(o,Q)),i[i.length-1-o]=en(u[0],r[0]),u=ye(u,we(r,[tr(i[i.length-1-o])]));u.length&&Y(u[0],Q);)u.shift();if((o=u.length-f.length)===e)break}return[i,t?$(n.length-u.length,Q).concat(u):u]}L.push(function(){Bt=D(.254829592),Vt=D(-.284496736),Gt=D(1.421413741),Dt=D(-1.453152027),Ht=D(1.061405429),Kt=D(.3275911)}),V.erf=function(n){return Tn(Jt,n,!0)},V.mean=Yt,V.median=function r(t,n){if(y(t))return t;if(w(t))return t.length?1&(t=Gr(t)).length?t[t.length>>1]:en(nn(t[t.length>>1],t[(t.length>>1)-1]),B):l;if(b(t)){if(1===(n=I(n=null==n?1:n)))return $(F(t),function(n){return r(E(t,n))});if(2===n)return $(G(t),function(n){return r(t[n])})}d("median")},V.mode=function r(t,n){if(y(t))return t;var e,i;if(w(t))return t.length?(e={},i=0,t.reduce(function(n,r){var t=r.toString(),t=ln.call(e,t)?(e[t]+=1,e[t]):e[t]=1;return i<t?(i=t,n=r):t===i&&Hn(r,n)&&(n=r),n},{})):l;if(b(t)){if(1===(n=I(n=null==n?1:n)))return $(F(t),function(n){return r(E(t,n))});if(2===n)return $(G(t),function(n){return r(t[n])})}d("mode")},V.moment=function r(t,e,n){if(y(t))return Q;var i;if(w(t))return t.length<=1?t.length?Q:l:(i=t.length,en(Kr(ar(fr(t,Yt(t)),e)),D(i)));if(b(t)){if(1===(n=I(n=null==n?1:n)))return e=D(e),$(F(t),function(n){return r(E(t,n),e)});if(2===n)return e=D(e),$(G(t),function(n){return r(t[n],e)})}d("moment")},V.std=ne,V.var=function r(t,e,n){if(e=I(e||0),y(t))return Q;var i,u;if(w(t))return t.length<=1?t.length?Q:l:(i=t.length,u=Yt(t),en(Kr(cr(Xr(u=fr(t,u)),u)),D(1===e?i:i-1)));if(b(t)){if(1===(n=I(n=null==n?1:n)))return $(F(t),function(n){return r(E(t,n),e)});if(2===n)return $(G(t),function(n){return r(t[n],e)})}d("var")},V.cov=re,V.corrcoef=function e(i,r){if(null==r){if(y(i)||w(i))return U;if(b(i))return S(F(i),F(i),function(n,r,t){return n===r?U:r<n?t[r][n]:e(E(i,n),E(i,r))})}else{if(y(i)&&y(r))return U;if(w(i)&&w(r)){if(i.length!==r.length)throw"corrcoef: inputs not of same dimension";return jr(i,r)}if(b(i)&&b(r)){if(G(i)!==G(r)||F(i)!==F(r))throw"corrcoef: inputs not of same dimension";return $(F(i),function(n){return e(E(i,n),E(r,n))})}}d("corrcoef")},V.corr=Mn(function(n,t){if(1<n)throw"corr: only one output is supported";b(t=y(t)?[[t]]:t)||d("corr");var e,n=2,i=jr;if(n<arguments.length&&k(arguments[n])?(e=arguments[n],++n):e=t,n<arguments.length&&"Type"===arguments[n])switch(arguments[n+1]){case"Spearman":i=Tr;break;case"Kendall":i=Rr;break;default:i=jr}return b(e)&&G(t)===G(e)||d("corr"),S(F(t),F(e),function(n,r){return i(E(t,n),E(e,r))})}),V.tiedrank=Mn(function(n,r,t,e){if(1<n)throw"tiedrank: only one output is supported";r=q(r=y(r)?[r]:r);var i=Y(Q,t)&&Y(U,e);return b(r)?Fr($(F(r),function(n){return Nr(E(r,n),i)})):Nr(r,i)}),V.pdist=function(n){var i,u,r=yr;if(b(n=w(n)?qn(n):n)||d("pdist"),1<arguments.length)switch(arguments[1]){case"fasteuclidean":case"euclidean":r=yr;break;case"fastsquaredeuclidean":case"squaredeuclidean":r=wr;break;case"fastseuclidean":case"seuclidean":u=k(arguments[2])?q(arguments[2]):ne(n),r=function(n,r,t,e){return br(n,r,u[t])};break;case"mahalanobis":u=qt(u=k(arguments[2])?arguments[2]:re(Wr(n))),i=Yt(Wr(n)),r=function(n,r,t,e){return Z.sqrt(xr(r,i,u))};break;case"cityblock":r=Ar;break;case"minkowski":u=y(arguments[2])?arguments[2]:B,r=function(n,r,t,e){return kr(n,r,u)};break;case"chebychev":r=Sr;break;case"cosine":r=_r;break;case"correlation":r=qr;break;case"hamming":r=Er;break;case"jaccard":r=Ir}for(var t,e=[],o=F(n),f=0;f<o;++f)for(t=f+1;t<o;++t)e.push(r(E(n,t),E(n,f),t,f));return e},V.pdist2=function(e,i){var u,o,f=yr;if(w(e)&&(e=qn(e)),w(i)&&(i=qn(i)),b(e)&&b(i)&&G(e)===G(i)||d("pdist2"),2<arguments.length)switch(arguments[2]){case"fasteuclidean":case"euclidean":f=yr;break;case"fastsquaredeuclidean":case"squaredeuclidean":f=wr;break;case"fastseuclidean":case"seuclidean":o=k(arguments[3])?q(arguments[3]):ne(e),f=function(n,r,t,e){return br(n,r,o[t])};break;case"mahalanobis":o=qt(o=k(arguments[3])?arguments[3]:re(Wr(e))),u=Yt(Wr(e)),f=function(n,r,t,e){return Z.sqrt(xr(r,u,o))};break;case"cityblock":f=Ar;break;case"minkowski":o=y(arguments[3])?arguments[3]:B,f=function(n,r,t,e){return kr(n,r,o)};break;case"chebychev":f=Sr;break;case"cosine":f=_r;break;case"correlation":f=qr;break;case"hamming":f=Er;break;case"jaccard":f=Ir}return S(F(e),F(i),function(n,r,t){return n<=r?f(E(e,n),E(i,r),n,r):t[r][n]})},V.mahal=function(e,n){w(n)&&(n=qn(n)),w(e)&&(e=qn(e)),b(n)&&b(e)&&G(n)===G(e)||d("mahal");var r=Wr(n),i=qt(re(r)),u=Yt(r);return S(F(e),F(n),function(n,r,t){return n<=r?xr(E(e,n),u,i):t[r][n]})},V.squareform=function(n,r){var t,e,i,u,o,f;if(w(n=q(n))||"tomatrix"===r){if(y(n))n=[n];else if(b(n))return n;for(e=n.length,t=S(i=W.round((W.sqrt(1+8*e)+1)/2),i,Q),u=f=0;u<i;++u)for(o=u+1;o<i;++o)t[o][u]=n[f++],t[u][o]=t[o][u]}else if(b(n)||"tovector"===r){if(y(n))n=[[Q,n],[n,Q]];else if(w(n))return n;for(e=G(n),t=[],u=0;u<e;++u)for(o=u+1;o<e;++o)t.push(n[o][u])}return t},V.kmeans=Mn(function(n,i,r){var t,e=3,u=fe,o=wr,f=100;for(b(i)||d("kmeans");e<arguments.length;){if("Start"===arguments[e])if(b(arguments[e+1])){if(F(u=arguments[e+1])!==F(i))throw"kmeans: centroids and input must have same number of columns";r=G(u)}else switch(arguments[e+1]){case"cluster":break;case"uniform":u=oe;break;case"sample":u=ue;break;default:u=fe}else if("Distance"===arguments[e])switch(arguments[e+1]){case"hamming":o=Er;break;case"correlation":o=qr;break;case"cosine":o=_r;break;case"cityblock":o=Ar;break;case"euclidean":o=yr;break;default:o=wr}else"MaxIter"===arguments[e]&&(f=W.ceil(W.abs(I(En(arguments[e+1],!0)))));e+=2}return(t=function(n,r,t,e,i,u){var o,f,c,l,a=G(n),s=(F(n),n.map(function(n){return te(n,t,e)[0]}));for(t=ie(n,r,s),o=1;o<=i;++o){for(f=l=0;f<a;++f)c=te(n[f],t,e)[0],s[f]!==c&&++l,s[f]=c;if(0===l)break;t=ie(n,r,s)}return[s,t]}(i,r,b(u)?u:u(i,r,o,!1),o,f,!1))[0]=t[0].map(function(n){return n+1}),1===n?t=t[0]:2<n&&(t.push($(r,function(e){return idx.reduce(function(n,r,t){return n=r===e?nn(n,o(i[t],C[e])):n},Q)})),3<n)&&t.push(S(G(i),r,function(n,r){return o(i[n],C[r])})),t}),V.pwcdanneal=function(n,i){((i=W.round(I(En(i,!0))))<=0||!b(n)||G(n)!==F(n))&&d("pwcdanneal");for(var r=2,t=.75,e=100;r<arguments.length;)"Alpha"===arguments[r]?t=W.abs(I(En(arguments[r+1],!0))):"MaxIter"===arguments[r]&&(e=W.ceil(W.abs(I(En(arguments[r+1],!0))))),r+=2;var u=function(n,r,t,e){null==e&&(e=100),null==t&&(t=.75);for(var i,u,o,f,c,l,a,s,h,m,g,p,v,d,y,w,b=G(n),x=S(b,r,function(){return W.random()}),k=0;k<b;++k){for(a=d=0;a<r;++a)d+=x[k][a];for(a=0;a<r;++a)x[k][a]/=d}for(u=S(b,r,function(){return W.random()}),i=S(b,r,0),c=(f=I(Z.sqrt(J(Lr(n,U),Lr(n,fn)))))/1e3,n=In(n),w=S(b,r,0),y=$(r,0),o=f;t<1&&c<o;){for(h=1;h<=e;++h){for(s=i,i=u,u=s,k=0;k<b;++k){for(g=x[k],p=i[k],a=d=0;a<r;++a)d+=W.exp(-p[a]/o);for(a=0;a<r;++a)g[a]=W.exp(-p[a]/o)/d}for(a=0;a<r;++a){for(l=d=0;l<b;++l)d+=x[l][a];y[a]=d}for(k=0;k<b;++k)for(g=w[k],a=0;a<r;++a){for(l=d=0;l<b;++l)d+=n[k][l]*x[l][a];g[a]=d}for(k=m=0;k<b;++k)for(g=x[k],p=u[k],a=0;a<r;++a){for(v=y[a]-g[a],l=d=0;l<b;++l)d+=x[l][a]*(n[k][l]-w[l][a]/(2*v));p[a]=d/(1+v),m=W.max(m,W.abs(p[a]-i[k][a]))}if(m<=1e-6)break}o*=t}return x}(n,i,t,e);return $(G(u),function(n){for(var r=u[n],t=0,e=1;e<i;++e)r[e]>r[t]&&(t=e);return t+1})},V.rectwin=function(n){return qn($(n=W.round(I(En(n,!0))),function(n){return U}))},V.triang=function(r){return qn($(r=W.round(I(En(r,!0))),1&r?function(n){return D(n+1<=(r+1)/2?2*(n+1)/(r+1):2-2*(n+1)/(r+1))}:function(n){return D(n+1<=r/2?(2*(n+1)-1)/r:2-(2*(n+1)-1)/r)}))},V.gausswin=function(r,n){r=W.round(I(En(r,!0))),n=I(En(n=null==n?2.5:n,!0));var t=(r-1)/(2*a);return t*=2*t,qn($(r,function(n){return n-=(r-1)/2,D(W.exp(-n*n/t))}))},V.hamming=function(n,r){n=W.round(I(En(n,!0)));var t="periodic"===r?n:n-1;return qn($(n,function(n){return D(.54-.46*W.cos(2*R*n/t))}))},V.hann=function(n,r){n=W.round(I(En(n,!0)));var t="periodic"===r?n:n-1;return qn($(n,function(n){return D(.5*(1-W.cos(2*R*n/t)))}))},V.bartlett=function(n){var r;return 1===(n=W.round(I(En(n,!0))))?U:(r=n-1,qn($(n,function(n){return D(n<=r/2?2*n/r:2-2*n/r)})))},V.barthannwin=function(n){var r;return 1===(n=W.round(I(En(n,!0))))?U:(r=n-1,qn($(n,function(n){return D(.62-.48*W.abs(n/r-.5)+.38*W.cos(2*R*(n/r-.5)))})))},V.blackman=function(t,n){t=W.round(I(En(t,!0)));var n="periodic"===n?t:t-1,e=1&n?(n+1)/2:n/2;return qn($(t,function(n,r){return n<=e-1?D(.42-.5*W.cos(2*R*n/(t-1))+.08*W.cos(4*R*n/(t-1))):r[t-1-n]}))},V.blackmanharris=function(n,r){n=W.round(I(En(n,!0)));var t="periodic"===r?n:n-1;return qn($(n,function(n){return D(.35875-.48829*W.cos(2*R*n/t)+.14128*W.cos(4*R*n/t)-.01168*W.cos(6*R*n/t))}))},V.conv=function(n,r){return(y(n)||y(r)?cr:(n=q(n),r=q(r),w(n)&&w(r)||d("conv"),ce))(n,r)},V.deconv=Mn(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[lr(r,t),Q]:lr(r,t);else{if(r=q(r),t=q(t),w(r)&&w(t)||d("deconv"),!t.length||1===t.length&&Y(t[0],Q))throw"deconv: divisor is zero";e=le(r,t,!0)}return 1<n?e:e[0]}),V.conv2=function(r,t){if(y(r)||y(t))return cr(r,t);if(w(r)){if(w(t))return ce(r,t);if(b(t))return $(F(t),function(n){return ce(r,E(t,n))})}else{if(w(t)){if(w(r))return ce(r,t);if(b(r))return $(r[0].length,function(n){return ce(E(r,n),t)});throw"conv2: input 1 not supported"}if(!b(r))throw"conv2: input 1 not supported";if(b(t)){var n,e,i,u,o,f,c,l,a,s,h,m,g,p=r,v=t;for(G(p)<G(v)&&(g=p,p=v,v=g),n=G(p),e=F(p),o=Zr(f=n+(i=G(v))-1,c=e+(u=F(v))-1),a=0;a<f;++a)for(s=0;s<c;++s){for(l=Q,h=0;h<=a&&!(n<=h);++h)if(!(i<=a-h))for(m=0;m<=s&&!(e<=m);++m)u<=s-m||(l=nn(l,tn(p[h][m],v[a-h][s-m])));o[a][s]=l}return o}}throw"conv2: input 2 not supported"},V.filter=function(n,r,t,e,i){n=q(n),r=q(r),t=q(t),w(n)&&w(r)&&w(t)||d("filter");var u,o,f,c,l=n,a=r,s=t,h=s.length,m=a.length,g=l.length,p=new Array(h),v=a[0];for(a=a.map(function(n){return en(n,v)}),l=l.map(function(n){return en(n,v)}),u=0;u<h;++u){for(c=Q,f=u,o=0;0<=f&&o<g;++o,--f)c=nn(c,tn(l[o],s[f]));for(f=u-1,o=1;0<=f&&o<m;++o,--f)c=rn(c,tn(a[o],p[f]));p[u]=c}return p};var ae={},se={};function he(n,r){for(var t,e,i=n.length,u={},o=0;o<i;++o)1!==u[o]&&(e=n[t=function(n,r){for(var t=0;1<r;)t=(t<<1)+(1&n),n>>=1,r>>=1;return t}(o,i)],r[t]=n[o],r[o]=e,u[t]=1)}function me(n,r,t){var e,i,u=n.length;if(1===u)t[0]=n[0];else{for(e=0;e<u;++e)t[e]=new A(Q,Q);for(var o,f,c,l,a,s,h=function(n){for(var r=W.sqrt(n),t=3;t<=r;){if(0==n%t)return t;t+=2}return n}(u),m=u/h,g=D(1/W.sqrt(h)),p=new Array(m),v=new Array(m),d=0;d<h;++d){for(e=0;e<m;++e)p[e]=n[e*h+d];for(1<m&&(pe(p,r,v),i=p,p=v,v=i),o=D(W.cos(2*R*d/u)),f=D((r?-1:1)*W.sin(2*R*d/u)),c=U,l=Q,e=0;e<u;++e)a=J(g,p[e%m].re),s=J(g,p[e%m].im),t[e]=t[e].add(new A(Wn(J(a,c),J(s,l)),K(J(s,c),J(a,l)))),a=Wn(J(c,o),J(l,f)),s=K(J(c,f),J(l,o)),c=a,l=s}}}function ge(n,r,t){var e,i,u,o,f,c,l,a,s,h,m,g,p,v,d,y,w,b=n.length,x=1;for(he(n,t);x<b;){for(e=D((w=void 0,null==(w=se[y=x])&&(se[y]=w=W.cos(R/y)),w)),i=D((r?-1:1)*(y=void 0,null==(y=ae[w=x])&&(ae[w]=y=W.sin(R/w)),y)),o=b/(2*x),u=0;u<o;++u)for(a=U,s=Q,f=0;f<x;++f)g=t[h=2*u*x+f].re,p=t[h].im,c=t[m=h+x].re,l=t[m].im,v=Wn(J(a,c),J(s,l)),d=K(J(s,c),J(a,l)),t[h]=new A(J(K(g,v),z),J(K(p,d),z)),t[m]=new A(J(Wn(g,v),z),J(Wn(p,d),z)),c=Wn(J(a,e),J(s,i)),l=K(J(a,i),J(s,e)),a=c,s=l;x<<=1}}function pe(n,r,t){var e,i=n.length;if(!(i<=0))return e=!1,null==t&&(t=new Array(i),e=!0),(i&i-1?me:ge)(n,r,t),e?t:void 0}function ve(n,r,t){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,o,f=!1,c=new Array(e),l=new Array(i),a=new Array(e),s=new Array(i);if(null==t){for(t=new Array(e),u=0;u<e;++u)t[u]=new Array(i);f=!0}for(o=0;o<i;++o,0){for(u=0;u<e;++u)c[u]=n[u][o];for(pe(c,r,a),u=0;u<e;++u)t[u][o]=a[u]}for(u=0;u<e;++u){for(o=0;o<i;++o,0)l[o]=t[u][o];for(pe(l,r,s),o=0;o<i;++o,0)t[u][o]=s[o]}return f?t:void 0}}function de(n,r,t,e,i){for(var u,o,f,c,l,a=r.length,s=W.max(1,a-e),h=W.floor((t-a)/2),m=new A(Q,Q),g=new Array(t),p=new Array(t),v=ar(zr(r),B),d=s;d<a;d+=s){for(c=d;c<a;++c)v[c-d]=nn(v[c],rr(un(r[c]),B));for(c=d;c<a;++c)v[c]=nn(v[c],rr(un(r[c-d]),B))}if(r=r.map(function(n,r){return en(n,Z.sqrt(on(v[r])))}),i)for(f=F(n),u=$(o=W.max(0,f*s+e),m),d=c=0;d<f;++d,c+=s){for(l=0;l<t;++l)p[l]=n[l][d],g[l]=m;for(pe(p,!0,g),l=0;l<a&&!(o<=c+l);++l)u[c+l]=nn(u[c+l],tn(r[l],g[h+l]))}else for(o=n.length,u=S(t,f=W.floor((o-e)/s),m),d=c=0;d<f;++d,c+=s){for(l=0;l<h;++l)g[l]=m,p[l]=m;for(l=0;l<a;++l)g[h+l]=c+l<o?tn(r[l],n[c+l]):m,p[h+l]=m;for(l=h+a;l<t;++l)g[l]=m,p[l]=m;for(pe(g,!1,p),l=0;l<t;++l)u[l][d]=p[l]}return u}function ye(n,r){for(var t=n.length-1,e=r.length-1,i=[];0<=t&&0<=e;)i.unshift(nn(n[t--],r[e--]));for(;0<=t;)i.unshift(n[t--]);for(;0<=e;)i.unshift(r[e--]);return i}V.fft=function(r){return b(r=q(r))?$(F(r),function(n){return Ln(pe(Zn(E(r,n)),!1))}):w(r)?Ln(pe(Zn(r),!1)):void d("fft")},V.ifft=function(r){return b(r=q(r))?$(F(r),function(n){return Ln(pe(Zn(E(r,n)),!0))}):w(r)?Ln(pe(Zn(r),!0)):void d("ifft")},V.fftshift=function(n,r){var t,e,i,u,o;return w(n=q(n))||b(n)?(t=n,r=y(r)?I(on(r)):null,w(t)?(e=t.length,i=W.ceil(e/2),$(e,function(n){return t[(n+i)%e]})):b(t)?(e=G(t),i=W.ceil(e/2),u=F(t),o=W.ceil(u/2),S(e,u,1===r?function(n,r){return t[(n+i)%e][r]}:2===r?function(n,r){return t[n][(r+o)%u]}:function(n,r){return t[(n+i)%e][(r+o)%u]})):t):n},V.fft2=function(n){return b(n)||d("fft2"),Ln(ve(Zn(n),!1))},V.ifft2=function(n){return b(n)||d("ifft2"),Ln(ve(Zn(n),!0))},V.stft=Mn(function(n,r){for(var t,e=2,i=2*R,u=null,o=null,f=null,c=null,l=null;e<arguments.length;)2===e&&y(arguments[e])?(i=I(on(arguments[e])),e+=1):"Window"===arguments[e]&&k(arguments[e+1])?(u=q(arguments[e+1]),e+=2):"OverlapLength"===arguments[e]&&y(arguments[e+1])?(o=W.round(I(on(arguments[e+1]))),e+=2):"FFTLength"===arguments[e]&&y(arguments[e+1])?(f=W.round(I(on(arguments[e+1]))),e+=2):e+=1;return null==u&&(u=q(V.hann(W.min(r.length,128),"periodic"))),null==f&&(f=W.max(128,u.length)),null==o&&(o=W.floor(.75*u.length)),b(r=q(r))?t=$(F(r),function(n){return Ln(de(Zn(E(r,n)),u,f,o,!1))}):w(r)?t=Ln(de(Zn(r),u,f,o,!1)):d("stft"),1<n&&(c=$(f,function(n){return D(n/f*i)})),2<n&&(l=$(W.floor((r.length-o)/(u.length-o)),function(n){return D(n*W.max(1,u.length-o)/i)})),1<n?[t,c,l]:t}),V.istft=Mn(function(n,r){for(var t,e=2,i=2*R,u=null,o=null,f=null,c=null;e<arguments.length;)2===e&&y(arguments[e])?(i=I(on(arguments[e])),e+=1):"Window"===arguments[e]&&k(arguments[e+1])?(u=q(arguments[e+1]),e+=2):"OverlapLength"===arguments[e]&&y(arguments[e+1])?(o=W.round(I(on(arguments[e+1]))),e+=2):"FFTLength"===arguments[e]&&y(arguments[e+1])?(f=W.round(I(on(arguments[e+1]))),e+=2):e+=1;return null==u&&(u=q(V.hann(W.min(r.length,128),"periodic"))),null==f&&(f=W.max(128,u.length)),null==o&&(o=W.floor(.75*u.length)),b(r)&&f===G(r)?t=Ln(de(Zn(r),u,f,o,!0)):d("istft"),1<n&&(c=$(W.floor((r.length-o)/(u.length-o)),function(n){return D(n*W.max(1,u.length-o)/i)})),1<n?[t,c]:t});var we=ce,be=le;function xe(n,r){if(!n.length)return Q;r=r||Q;for(var t=n.length,e=0,i=n[0];e+1<t;)++e,i=nn(tn(i,r),n[e]);return i}function ke(n,r){for(var t,e,i,u=Q,o=W.min(n.length,r.length)-1,f=0;f<o;++f)t=n[f],i=n[f+1],e=r[f],u=K(u,Qn(Wn(J(t,r[f+1]),J(e,i)),B));return 1<o&&(t=n[o],i=n[0],e=r[o],u=K(u,Qn(Wn(J(t,r[0]),J(e,i)),B))),u}function Se(u,o){var f,n,r,t,e,i,c,l,a,s,h=u.length,m=$(h,function(n){return n});if(h<3)return m;for(f=0,n=1;n<h;++n)(On(o[n],o[f])||H(o[n],o[f])&&On(u[n],u[f]))&&(f=n);for(m.splice(f,1),--h,m=m.map(function(n){return[(r=u[f],t=o[f],e=u[n],i=o[n],Hn(i=Z.atan2(Wn(i,t),Wn(e,r)),Q)?K(i,2*R):i),n];var r,t,e,i}).sort(function(n,r){return On(n[0],r[0])?-1:$n(n[0],r[0])?1:0}).map(function(n){return n[1]}),(r=new Array(h+1))[0]=f,r[1]=m[0],r[2]=m[1],t=3,n=2;n<h;++n){for(;1<t&&Cn(Q,(e=u[m[n]],i=o[m[n]],c=u[r[t-1]],l=o[r[t-1]],a=u[r[t-2]],s=o[r[t-2]],e=Wn(e,a),c=Wn(c,a),a=Wn(i,s),i=Wn(l,s),Wn(J(e,i),J(a,c))));)--t;r[t++]=m[n]}return r.length=t,r}function Ae(){var n,r,t,e,i=arguments,u=i.length;if(0===u)return Q;for(e=0;e<u&&H(Q,n=i[e++]););for(n=Z.abs(n);e<u;){if(H(n,U))return U;for(;e<u&&H(Q,r=i[e++]););if(H(r=Z.abs(r),U))return U;if(!H(r,n)){if(H(r,Q))break;for(On(n,r)&&(t=r,r=n,n=t);!H(Q,r);)r=Bn(n,t=r),n=t}}return n}function _e(n){var r,t,e,i,u=n.length,o=U,f=Q,c=Q,l=U,a=U,s=U;if(0!==u){if(r=n[0],$n(Q,r)&&(r=Z.abs(r),a=M),1===u)return[r,a];if(i=2===u?[n[1],U]:_e(n.slice(1)),t=i[0],$n(Q,t)&&(t=Z.abs(t),s=M),H(Q,r))return $(i.length+1,function(n){return 0===n?t:1===n?a:J(s,i[n-1])});if(H(Q,t))return $(i.length+1,function(n){return 0===n?r:1===n?a:J(s,i[n-1])});for(;;){if(e=Z.floor(Qn(r,t)),r=Bn(r,t),o=Wn(o,J(e,c)),f=Wn(f,J(e,l)),H(Q,r))return c=J(c,a),l=J(l,s),$(i.length+1,function(n){return 0===n?t:1===n?c:J(l,i[n-1])});if(e=Z.floor(Qn(t,r)),t=Bn(t,r),c=Wn(c,J(e,o)),l=Wn(l,J(e,f)),H(Q,t))return o=J(o,a),f=J(f,s),$(i.length+1,function(n){return 0===n?r:1===n?o:J(f,i[n-1])})}}}function qe(n,r){var t=Z.abs(n);return H(t,Z.abs(r))?H(n_sign(n),n_sign(r))?t:Vn(t):J(Qn(n,Ae(n,r)),r)}V.polydiv=Mn(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[lr(r,t),Q]:lr(r,t);else{if(r=q(r),t=q(t),w(r)&&w(t)||d("polydiv"),!t.length||1===t.length&&Y(t[0],Q))throw"polydiv: divisor is zero";e=be(r,t,!1)}return 1<n?e:e[0]}),V.polyval=function(r,n){return w(r=q(r))||d("polyval"),y(n)?Ln(xe(r,n)):w(n)?n.map(function(n){return Ln(xe(r,n))}):void d("polyval")},V.polyvalm=function(r,n){return w(r=q(r))||d("polyvalm"),b(n)&&G(n)===F(n)?Ln(function(n,r){if(!n.length)return Zr(G(r),F(r));for(var t=n.length,e=0,i=G(r),u=Or(i,n[0]);e+1<t;)++e,u=or(N(u,r),Or(i,n[e]));return u}(r,n)):y(n)?Ln(xe(r,n)):w(n)?n.map(function(n){return Ln(xe(r,n))}):void d("polyvalm")},V.polyfit=function(n,r,i){if(n=q(n),r=q(r),w(n)&&w(r)||d("polyfit"),n.length!==r.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return Ln(function(e,i){var n,u,o,r,t,f,c,l;if(!(w(e)&&e.length&&w(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),o=W.min(e.length,i.length),e.length=o,i.length=o,c={},l=[],u=0;u<o;++u)if(f=String(e[u]),ln.call(c,f)){if(!Y(i[c[f]],i[u]))return[];l.push(u)}else c[f]=u;for(;l.length;)u=l.pop(),e.splice(u,1),i.splice(u,1);for(l=c=null,r=$(o=e.length,function(n){for(var r=U,t=0;t<o;++t)t!==n&&(r=tn(r,rn(e[n],e[t])));return r=en(i[n],r)}),t=$(o,function(n){return[U,tr(e[n])]}),n=[],u=0;u<o;++u)n=ye(n,t.reduce(function(n,r,t){return n=t!==u?we(n,r):n},[r[u]]));return n}(n,r));if(!p(i)||I(i)<0)throw"polyfit: input 3 not positive int";return i=I(i),Ln(N(Nt(n.reduce(function(n,r){for(var t=1,e=[U];t<=i;++t)e.unshift(tn(r,e[0]));return n.push(e),n},[])),r))},V.roots=function(n){return w(n=q(n))||d("roots"),Ln(function(r){if(r.length<=1)return[];var n,t,e,i,u,o,f,c,l,a,s,h,m,g=r.length-1,p=D(1e-10),v=new A(p,Q),d=new A(Q,Q),y=new A(U,Q);for(r=r.map(D),a=function(n){return xe(r,n)},s=function(n){return en(rn(a(nn(n,v)),a(n)),v)},n=r.map(function(n){return A(n).abs()}),o=n.length-1;0<o&&H(n[o],Q);)--o;for(e=K(Qn(Hr(n.slice(0,o))||Q,Hr([n[o],U])),U),t=Qn(n[0],Hr(K(n[0],Hr(n.slice(1))))),i=$(g,function(){return new A(K(t,J(Wn(e,t),W.random())),D(W.random()*R/2),"polar")}),l=1;l<=1e4;++l){for(o=u=0;o<g;++o){if(f=i[o],h=a(f),H((m=s(f)).re,Q)&&H(m.im,Q)){if(Cn(Z.abs(h.re),p)&&Cn(Z.abs(h.im),p)){++u;continue}c=new A(e,Q)}else c=h.div(m);h=c.div(y.sub(c.mul(i.reduce(function(n,r,t){return n=t===o||H(f.re,r.re)&&H(f.im,r.im)?n:n.add(f.sub(r).inv())},d)))),Cn(Z.abs(h.re),p)&&Cn(Z.abs(h.im),p)&&++u,i[o]=f.sub(h)}if(u===g)break}return i}(n).sort(function(n,r){return On(on(n),on(r))?-1:$n(on(n),on(r))?1:0}))},V.compan=function(n){return w(n=q(n))||d("compan"),S((t=n).length-1,t.length-1,function(n,r){return 0===n?tr(en(t[r+1],t[0])):r+1===n?U:Q});var t},V.poly=function(n){return b(n=q(n))&&V.charpoly?V.charpoly(n):(w(n)||d("poly"),Ln(n.reduce(function(n,r){return we(n,[U,tr(r)])},[U])))},V.cart2pol=Mn(function(n,r,t,e){return[V.atan2(t,r),V.sqrt(or(ar(r,B),ar(t,B))),e]},3),V.pol2cart=Mn(function(n,r,t,e){return[cr(t,V.cos(r)),cr(t,V.sin(r)),e]},3),V.cart2sph=Mn(function(n,r,t,e){var i=or(ar(r,B),ar(t,B));return[V.atan2(t,r),V.atan2(e,V.sqrt(i)),V.sqrt(or(i,ar(e,B)))]},3),V.sph2cart=Mn(function(n,r,t,e){return[cr(e,cr(V.cos(t),V.cos(r))),cr(e,cr(V.cos(t),V.sin(r))),cr(e,V.sin(t))]},3),V.polyarea=function(r,t){return r=q(r),t=q(t),b(r)&&b(t)?(G(r)===G(t)&&F(r)===F(t)||d("polyarea"),$(F(r),function(n){return ke(E(r,n),E(t,n))})):w(r)&&w(t)?(r.length!==t.length&&d("polyarea"),ke(r,t)):void d("polyarea")},V.convhull=Mn(function(n,r,t,e){3<arguments.length&&d("convhull"),b(r)&&2===F(r)?(t=E(r,1),r=E(r,0)):(r=q(r),t=q(t)),w(r)&&w(t)&&r.length===t.length||d("convhull");var i=Se(r,t);return 1<n?[i.map(function(n){return n+1}),ke(i.map(function(n){return r[n]}),i.map(function(n){return t[n]}))]:i.map(function(n){return n+1})}),V.mod=function(n,t){return Y(t=En(t||0),0)?n:Tn(function(n){var r;return O(n)?On(r=Bn(n,t),0)&&$n(t,0)?K(r,t):r:n},n,!0)},V.gcd=Mn(function(n,r,t){return function t(e,i,u){if(u){var o,f;if(k(e)){if(o=new Array(e.length),k(i))return e.length!==i.length&&d("gcd"),f=new Array(i.length),[e.map(function(n,r){return n=t(n,i[r],u),o[r]=n[1],f[r]=n[2],n[0]}),o,f];if(p(i))return f=new Array(e.length),[e.map(function(n,r){return n=t(n,i,u),o[r]=n[1],f[r]=n[2],n[0]}),o,f]}if(p(e)){if(k(i))return o=new Array(i.length),f=new Array(i.length),[i.map(function(n,r){return n=t(e,n,u),o[r]=n[1],f[r]=n[2],n[0]}),o,f];if(p(i))return _e([e,i])}}else{if(k(e)){if(k(i))return e.length!==i.length&&d("gcd"),e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(k(i))return i.map(function(n,r){return t(e,n)});if(p(i))return Ae(e,i)}}d("gcd")}(r,t,1<n)}),V.lcm=function t(e,i){if(k(e)){if(k(i))return e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(k(i))return i.map(function(n,r){return t(e,n)});if(p(i))return function(){var n,r,t=arguments,e=t.length;if(e<=1)return 1===e?t[0]:Q;if(H(Q,t[0])||H(Q,t[1]))return Q;for(r=qe(t[0],t[1]),n=2;n<e;++n){if(H(Q,t[n]))return Q;r=qe(r,t[n])}return r}(e,i)}return e};var Ee=[D(2),D(3),D(5),D(7),D(11),D(13),D(17),D(19),D(23),D(29),D(31),D(37),D(41),D(43),D(47),D(53),D(59),D(61),D(67),D(71),D(73),D(79),D(83),D(89),D(97),D(101),D(103),D(107),D(109)];function Ie(n){for(var r,t,e=1+(n.length-1);1<e--;)r=W.round(W.random()*+e),t=n[0+e],n[0+e]=n[0+r],n[0+r]=t;return n}function Ne(t){for(var n=(t=[].map.call(t,function(n){return k(n)||d("combinations"),$r(n)})).map(function(n){return n.length}),r=$(n.length,0),e=[];r&&r.length;)e.push(r.map(function(n,r){return t[r][n]})),r=function(n,r){for(var t,e=r.length-1,i=e;0<=i&&i<=e&&n[i]+1===r[+i+0];)--i;if(0<=i&&i<=e)for(n[i]=n[i]+1,t=i+1;0<=t&&t<=e;t+=1)n[t]=0;else n=null;return n}(r,n);return e}function je(n){if(_(n))return 0<n.length;if(vn(n))return!1;if(yn(n))return 0!==n;if(wn(n))return!n.eq(Q);if(u(n))return!H(n.re,Q)||!H(n.im,Q);if(k(n)){if(!n.length)return!1;for(var r=0,t=n.length;r<t;++r)if(!je(n[r]))return!1;return!0}return!0===n}L.push(function(){Ee=[D(2),D(3),D(5),D(7),D(11),D(13),D(17),D(19),D(23),D(29),D(31),D(37),D(41),D(43),D(47),D(53),D(59),D(61),D(67),D(71),D(73),D(79),D(83),D(89),D(97),D(101),D(103),D(107),D(109)]}),V.factor=function(n){for(var r,t,e=Z.floor(Z.abs(on(En(n)))),i=D(1e30),u=[],o=e,f=0,c=Ee.length;f<c;++f){if(H(o,r=Ee[f]))return[r];if($n(t=J(r,r),e)||null!=i&&$n(t,i))break;for(;H(Q,Bn(e,r));)u.push(r),e=Qn(e,r)}if(c<=f)for(t=J(r=K(r,B),r);Cn(t,e)&&(null==i||Cn(t,i));){for(;H(Q,Bn(e,r));)u.push(r),e=Qn(e,r);t=J(r=K(r,B),r)}return $n(e,U)&&u.push(e),u},V.randperm=function(n){return(!p(n=W.round(I(n||0)))||n<=0)&&d("randperm"),Ie($(n,function(n){return n+1}))},V.perms=function(r){w(r=q(r))||d("perms");for(var n=$(r.length,function(n){return n}),t=[];n&&n.length;)t.push(n.map(function(n){return r[n]})),n=function(n){for(var r,t,e,i,u=n.length-1,o=u,f=o-1;0<=f&&f<=u&&+n[f]>=+n[f+1];)--f;if(0<=f&&f<=u){for(r=o;0<=r&&r<=u&&0<r-f&&+n[f]>=+n[r];)--r;for(t=n[f],n[f]=n[r],n[r]=t,e=f+1,i=o;0<=e&&e<=u&&0<=i&&i<=u&&0<i-e;)t=n[e],n[e]=n[i],n[i]=t,e+=1,--i}else n=null;return n}(n);return t},V.combinations=function(){return Ne(arguments)},V.string=function n(r){return k(r)?r.map(n):_(r)?r:String(r)},V.strlength=function(n){if(_(n))return n.length;d("strlength")},V.char=function n(r){return r=q(r),k(r)?r.map(n):_(r)?r.split(""):p(r)?String.fromCharCode(I(r)):String(r)},V.lower=V.tolower=function n(r){return k(r)?r.map(n):_(r)?r.toLowerCase():r},V.upper=V.toupper=function n(r){return k(r)?r.map(n):_(r)?r.toUpperCase():r},V.dec2bin=function n(r){return k(r)?r.map(n):yn(r)?r.toString(2):wn(r)?r.toBinary():r},V.bin2dec=function n(r){return k(r)?r.map(n):_(r)?parseInt(r,2):r},V.dec2hex=function n(r){return k(r)?r.map(n):yn(r)?r.toString(16):wn(r)?r.toHexadecimal():r},V.hex2dec=function n(r){return k(r)?r.map(n):_(r)?parseInt(r,16):r};var Te={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var r=[],t=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?t.length&&(k(t[0])?r=r.length?Cr("vert",r,t):t:r.push(t),t=[]):!mn(n,ze)&&k(n)?t=t.length?Cr("horz",t,n):n:t.push(n))}),t.length&&(k(t[0])?r=r.length?Cr("vert",r,t):t:r.length?r.push(t):r=t),r}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return V.colon(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r){return $r(n,r)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r,t){return $r(n,r,t)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return V.ctranspose(n)}},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return V.transpose(n)}},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:hr},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:ar},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,r){return _t(n,r)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:lr},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:lr},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:function(n,r){return N(n=kn(n)?_n(n):n,r=kn(r)?_n(r):r)}},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:cr},"+":{name:"add",arity:2,arityalt:1,fixity:0,associativity:-1,commutativity:1,priority:25,fn:function(n,r){return 1===arguments.length?n:or(n,r)}},"-":{name:"sub",arity:2,arityalt:1,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:function(n,r){return 1===arguments.length?mr(n):fr(n,r)}},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Yn},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Jn},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Kn},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Hn},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Dn},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Y},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,r){return je(n)&&je(r)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){return je(n)||je(r)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){n=je(n),r=je(r);return n&&!r||r&&!n?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return je(n)?0:1}},"&":{name:"band",arity:2,fixity:0,associativity:-1,commutativity:1,priority:41,fn:it},"|":{name:"bor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:41,fn:ut},"=":{name:"set",breakpoint:"set",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,r){var t,e;return k(n)&&mn(n[0],ze)?(e=n,k(t=r)?await Promise.all(e.map(function(n,r){return Re(n,r<t.length?t[r]:null)})):await Promise.all(e.map(function(n,r){return Re(n,0===r?t:null)}))):Re(n,r.$scilitevarargout$?r[0]:r)}}};async function Re(n,r){if(mn(n,ze)&&_(n.v))return await n.set(r),n.get(!0);throw"setting non-variable"}async function Me(n,r,t){var e,i,u,o,f,c,l=null;if(je(await Oe(n.if.cond,r,t))){for(e=0,o=(f=n.if.statements).length;e<o;++e)null!=(c=await Oe(f[e],r,t))&&(l=c);return l}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(je(await Oe(n.elseif[i].cond,r,t))){for(e=0,o=(f=n.elseif[i].statements).length;e<o;++e)null!=(c=await Oe(f[e],r,t))&&(l=c);return l}if(n.else.statements.length){for(e=0,o=(f=n.else.statements).length;e<o;++e)null!=(c=await Oe(f[e],r,t))&&(l=c);return l}}async function Pe(n,r,t){var e,i,u,o,f,c,l,a,s=[],h=!1,m=!1,g=await Oe(n.val,r,t),p=n.statements;if(s.$scilitevarargout$=!0,k(g)){for(c=(t=t||{}).brk,l=t.cont,t.brk=function(){h=!0},t.cont=function(){m=!0},u=0,o=(a=Sn(g=q(g)))?F(g):g.length;u<o;++u){for(m=h=!1,await n.ind.set(a?E(g,u):g[u]),e=0,i=p.length;e<i&&(f=await Oe(p[e],r,t),!h&&!m);++e)null!=f&&s.push(f);if(h)break}t.brk=c,t.cont=l}return s}async function Xe(n,r,t){var e,i,u,o,f,c=[],l=!1,a=!1,s=n.statements;for(c.$scilitevarargout$=!0,o=(t=t||{}).brk,f=t.cont,t.brk=function(){l=!0},t.cont=function(){a=!0};je(await Oe(n.cond,r,t));){for(a=l=!1,e=0,i=s.length;e<i&&(u=await Oe(s[e],r,t),!l&&!a);++e)null!=u&&c.push(u);if(l)break}return t.brk=o,t.cont=f,c}function ze(n,r,t){if(!mn(this,ze))return new ze(n,r,t);this.ctx=n,this.v=r,this.i=t}async function Le(n){return mn(n,ze)?await n.get():n}function Ze(n,r){if(!mn(this,Ze))return new Ze(n,r);null==r&&(r=n,n=""),this.op=n,this.arg=r}async function Oe(n,r,t){if(mn(n,Ze))return Ce(n,r,t);if(k(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await Oe(n[e],r,t);return u}return n}function $e(d,y,w,i){var b,x=0,k=0,u=d;function S(n,r,t){null==t&&(t=k),null==r&&(r=x);var e=u.split("\n")[t];return(n=String(n)+" at line "+String((w||0)+t)+" position "+String((i||0)+r)+":")+"\n"+e+"\n"+new Array(r+1).join(" ")+"^\n"}return function i(n){var r,t,e,u,o,f,c,l=[],a=[],s=[];function h(n){var r,t,e,i,u,o,f,c;if(a.length)if(n)for(;0<a.length;){if(u=(i=a.shift())[0],n===(o=Te[u]).breakpoint){a.unshift(i);break}if(o.arity>l.length){if(!(null!=o.arityalt&&o.arityalt<=l.length))throw S('invalid or missing argument for "'+u+'"',i[1],i[2]);c=l.splice(0,o.arityalt).reverse()}else c=l.splice(0,o.arity).reverse();f=Ze(o.fn,c),l.unshift(f)}else if(t=(r=a.shift())[0],1===(e=Te[t]).fixity){if(e.arity>l.length){if(!(null!=e.arityalt&&e.arityalt<=l.length))throw S('invalid or missing argument for "'+t+'"',r[1],r[2]);c=l.splice(0,e.arityalt).reverse()}else c=l.splice(0,e.arity).reverse();f=Ze(e.fn,c),l.unshift(f)}else{if(-1!==e.fixity)for(;0<a.length&&(u=(i=a[0])[0],(o=Te[u]).priority<e.priority||o.priority===e.priority&&(o.associativity<e.associativity||o.associativity===e.associativity&&-1===o.associativity));){if(o.arity>l.length){if(!(null!=o.arityalt&&o.arityalt<=l.length))throw S('invalid or missing argument for "'+u+'"',i[1],i[2]);c=l.splice(0,o.arityalt).reverse()}else c=l.splice(0,o.arity).reverse();f=Ze(o.fn,c),l.unshift(f),a.shift()}a.unshift(r)}}function m(n){if(h(!0),1<l.length||0<a.length)throw S("mismatched terms and operators",a.length?a[0][1]:x,a.length?a[0][2]:k);!0===n&&(mn(l[0],Ze)&&s.push(l[0]),l=[],a=[])}function g(n,r){var t,e=n.test?d.match(n):n===d.slice(0,n.length);return!!e&&(!1===r?n.test?e:[n,n]:n.test?(t=e[r||0].length,d=d.slice(t),x+=t,e):(t=n.length,d=d.slice(t),x+=t,[n,n]))}function p(n,r,t){for(var e,i=t||0,u="";i<d.length;)if(n===(e=d.charAt(i))){if(!(i+1<d.length&&n===d.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return r&&(d=d.slice(i+1),x+=i+1),[u,i+1]}function v(){var n,r,t,e=function(n,r,t){for(var e,i=0,u=0;i<d.length;)if(e=d.charAt(i),!t||'"'!==e&&"'"!==e){if(r===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=p(e,!1,i+1)[1];return u||i>=d.length?-1:i}("]","[",!0);if(-1===e)throw S("mismatched brackets");if(n=d.slice(0,e),/[\[\]]/.test(n)){for(r=[];t=i(",;]");)if(r.push(t),g(","))r.push(Ze(","));else{if(!g(";"))break;r.push(Ze(";"))}g(/^\s+/),g("]")}else r=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,r){var t=n.length,e=0;return r.trim().split(-1<r.indexOf(",")?",":/\s+/g).reduce(function(n,r){return(r="~"===(r=r.trim())?Ze("v",ze(y,"")):$e(r,y,k+w,x))&&(e?n.push(Ze(",")):t&&n.push(Ze(";")),n.push(r),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,r){return(r=$e(r.trim(),y,k+w,x))&&(n.length&&n.push(Ze(",")),n.push(r)),n},[]),d=d.slice(e+1),x+=e+1,1<(n=n.split("\n")).length&&(k+=n.length-1,n.slice(0,-1).forEach(function(n){x-=n.length+1}));return Ze(Te["[]"].fn,r)}for(;0<d.length;)if(g(/^if\b/)){if(m(!0),!(c=i("\n,")))throw S('missing or invalid condition in "if"');for(g("\n")?(++k,x=0):g(","),o=(f={if:{cond:c,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((c=i(["elseif","else","end"]))&&(o.statements=o.statements.concat(c)),g("elseif")){if(!(c=i("\n,")))throw S('missing or invalid condition in "elseif"');g("\n")?(++k,x=0):g(","),f.elseif.push({cond:c,statements:[]}),o=f.elseif[f.elseif.length-1]}else if(g("else"))g(/^[ \t\v\f]+/),g("\n")?(++k,x=0):g(","),o=f.else;else if(g("end")||!c)break;s.push(Ze(Me,f))}else if(g(/^for\b/)){if(m(!0),!(r=g(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw S('missing or invalid declaration in "for"');if(!(c=i("\n,")))throw S('missing or invalid declaration in "for"');for(g("\n")?(++k,x=0):g(","),f={ind:ze(y,r[1]),val:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Ze(Pe,f))}else if(g(/^while\b/)){if(m(!0),!(c=i("\n,")))throw S('missing or invalid condition in "while"');for(g("\n")?(++k,x=0):g(","),f={cond:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Ze(Xe,f))}else if(r=g(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(r[1]))break;if("continue"===r[1])g("continue"),s.push(Ze("continue",""));else if("break"===r[1])g("break"),s.push(Ze("break",""));else{if("end"!==r[1])throw S('unexpected "'+r[1]+'"');g("end"),l.unshift(Ze("v",ze(y,"end")))}}else if(g("..."))g(/^[ \t\v\f]+/),g("\n")&&(++k,x=0);else if(g(";",!1)){if(n&&-1<n.indexOf(";"))break;g(";"),m(!0)}else if(g("\n",!1)){if(n&&-1<n.indexOf("\n"))break;g("\n"),++k,m(!(x=0))}else if(g(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(r=g("%"))b=d.indexOf("\n"),d=d.slice(-1<b?b+1:d.length),-1<b&&++k,m(!(x=0));else if(r=g("{%"))-1===(b=d.indexOf("%}"))&&(b=d.length),c=d.slice(0,b+2),d=d.slice(b+2),k+=c.split("\n").length-1,m(!(x=0));else if(r=(r=g("'"))||g('"'))o=p(r[0],!0)[0],l.unshift(Ze("'"===r[0]?o.split(""):o));else if(r=g(/^(&&|\|\||&|\|)[^&\|]/,1))u=r[1],a.unshift([u,x,k]),h();else if(r=g(/^(xor)[^a-zA-Z]/,1))u=r[1],a.unshift([u,x,k]),h();else if(r=g(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=r[1],a.unshift([u,x,k]),h();else if(r=g("~"))a.unshift(["~",x,k]),h();else if(r=g("="))a.unshift(["=",x,k]),h();else if(r=g(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=r[0],a.unshift([u,x,k]),h();else if(r=g(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(t=r[1],g(/^\s*\:\s*\)/))o=Ze("v",ze(y,t)),l.unshift(o),a.unshift(["(:)",x,k]),h();else{for(f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");o=ln.call(V,t)?Ze(V[t],f):Ze("v",ze(y,t,f.length?f:null)),l.unshift(o)}g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,k]),h())}else if(r=g(/^[_a-z][_a-z0-9]*/i))t=r[0],o=ln.call(V,t)&&0===V[t].length?Ze(V[t],[]):Ze("v",ze(y,t)),l.unshift(o),g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,k]),h());else if(r=g(/^(-?\s*\d+(\.\d+)?([eE][+-]?\d+)?)([ij])?/))f=r[1].split(/\s+/).join(""),f=T?T(f):parseFloat(f,10),o=Ze(r[4]?new A(0,f):f),l.unshift(o);else if(r=g(/^(-?\s*\.\d+([eE][+-]?\d+)?)([ij])?/))f="-"===(f=r[1].split(/\s+/).join("")).charAt(0)?"-0"+f.slice(1):"0"+f,f=T?T(f):parseFloat(f,10),o=Ze(r[4]?new A(0,f):f),l.unshift(o);else if("["===(e=d.charAt(0)))d=d.slice(1),x+=1,(o=v())&&(l.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,k]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw S("mismatched brackets")}if("("===e)if(d=d.slice(1),x+=1,g(/^\s*\:\s*\)/))a.unshift(["(:)",x,k]),h();else{if(l.length&&a.reduce(function(n,r){return r=Te[r[0]],n+(r.arity>l.length-n&&null!=r.arityalt?r.arityalt:r.arity)},0)<=l.length){for(h("set"),o=l.shift(),f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");f.length&&(o=Ze("v",ze(y,o,f)))}else if(o=i(")"),!g(")"))throw S("mismatched parentheses");o&&(l.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,k]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw S("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw S(n?'missing expected "'+(_(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(d=d.slice(1),c=[x+=1,k],h("set"),l.length?f=1:(f=0,l.unshift(Ze(":")));o=i(":,)\n"),g(/^[ \t\v\f]+/),o?(l.unshift(o),++f):g(":",!1)&&l.unshift(Ze(":")),g(":"););1<f&&(a.unshift([3===f?"::":":",c[0],c[1]]),h())}}return m(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function Ce(n,r,t){var e;if(mn(n,Ze)){if(""===n.op)return n.arg;if("v"===n.op)return!1===r?n.arg:mn(n.arg.v,Ze)?Le(n.arg):pn(r)&&ln.call(r,n.arg.v)?r[n.arg.v]:await Le(n.arg);if(Me===n.op)return Me(n.arg,r,t);if(Pe===n.op)return Pe(n.arg,r,t);if(Xe===n.op)return Xe(n.arg,r,t);if("break"===n.op)return void(t&&gn(t.brk)&&t.brk());if("continue"===n.op)return void(t&&gn(t.cont)&&t.cont());if(Te["="].fn===n.op)return t=t||{},e=await Ce(n.arg[0],!1),k(e)&&mn(e[0],ze)&&(t.nargout=e.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[e,n.arg[1].arg.isByRef()?jn(await Ce(n.arg[1],r,t)):await Ce(n.arg[1],r,t)]):n.op.apply(null,[e].concat(await Promise.all(n.arg.slice(1).map(function(n){return Ce(n,r,t)}))));if(gn(n.op))return(t&&p(t.nargout)&&gn(n.op.nargout)?n.op.nargout(t.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return Ce(n,r,t)})))}throw"invalid expr"}return sn.op=Te,ze.prototype={constructor:ze,ctx:null,v:null,i:null,get:async function(n){var r,t,e=this;if(""===e.v)return null;if(mn(e.v,Ze))r=await Oe(e.v);else{if(!ln.call(e.ctx,e.v)&&!ln.call(hn,e.v))throw'undefined variable "'+e.v+'"';r=(ln.call(e.ctx,e.v)?e.ctx:hn)[e.v]}return!0!==n&&null!=e.i?(t=ot(r),n=await Promise.all(e.i.map(function(n,r){return Oe(n,{end:1===e.i.length?t[0]*t[1]:t[r]})})),gr.apply(null,[r].concat(n))):r},set:async function(n){var r,t,e,i=this;if(""!==i.v)if(null!=i.i){if(mn(i.v,Ze))r=await Oe(i.v);else{if(!ln.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';r=i.ctx[i.v]}t=ot(r),1===(e=await Promise.all(i.i.map(function(n,r){return Oe(n,{end:1===i.i.length?t[0]*t[1]:t[r]})}))).length&&(e=e.concat(null)),pr.apply(null,[r].concat(e).concat([n]))}else mn(i.v,Ze)||(i.ctx[i.v]=n);return i},isset:function(){return _(this.v)&&ln.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},Ze.prototype={constructor:Ze,op:null,arg:null},c.createContext=function(){return{ans:null}},c.eval=async function(n,r,t){r=r||c.createContext();var e=$e(String(n),r,null==t?1:t,1),i=null,u=!1;if(k(e))for(var o=0,f=e.length;o<f;++o)e[o]&&(i=await Ce(e[o]),u=!0);else e&&(i=await Ce(e),u=!0);return u&&(k(i)||vn(i)||y(i)||_(i))&&(r.ans=i),u?i:null},sn});