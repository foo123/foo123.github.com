/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.10
* 2025-12-26 19:02:39
* https://github.com/foo123/SciLite
*
**/!function(r,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(r)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(r)}):n in r||(r[n]=t.call(r)||1)&&"function"==typeof define&&define.amd&&define(function(){return r[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function r(){}var t,_=null,I=null,k=Math,L={},e={},R=k.PI,i=k.E,o=k.log(10),c=k.log(2),a=1/0,s=NaN,nn=1e-15,h=Number.MAX_VALUE,m=Number.MIN_VALUE,g=Number.MAX_SAFE_INTEGER,T=Number.MIN_SAFE_INTEGER,X=g,O=0,$=1,Z=-1,z=.5,rn=2,tn=10,en=[],un=Object.prototype.hasOwnProperty,fn=Object.prototype.toString,S=Array.isArray||function(n){return"[object Array]"===fn.call(n)},on={VERSION:"0.9.10",_:{},fn:{},op:{},constant:{pi:R,e:i,eps:nn,realmax:h,realmin:m,intmax:g,intmin:T,inf:a,Inf:a,nan:s,NaN:s}},l=on._,ln=on.constant,E=on.fn;function d(n){throw String(n)+": input(s) not supported"}function cn(n,r){return n instanceof r}function an(n){return"function"==typeof n}function sn(n){return"[object Object]"===fn.call(n)}function N(n){return"string"==typeof n}function hn(n){return gn(n)&&n.isNaN()||Number.isNaN(n)}function mn(n){return gn(n)&&!n.isFinite()||u(n)&&!isFinite(n)}function u(n){return"number"==typeof n}function gn(n){return null!=_&&n instanceof _}function C(n){return"number"==typeof n||null!=_&&n instanceof _}function p(n){return gn(n)&&n.isInt()||u(n)&&Number.isInteger(n)}function f(n){return null!=I&&n instanceof I}function pn(n){return!f(n)||Q(O,n.im)}function y(n,r){if(u(n)||f(n)||gn(n))return!0;if(!1===r){if(w(n)&&1===n.length)return!0;if(b(n)&&1===n.length&&1===n[0].length)return!0}return!1}function w(n){return S(n)&&y(n[0])}function b(n){return S(n)&&S(n[0])&&y(n[0][0])}function vn(n){return!S(n)}function dn(n){return S(n)&&!S(n[0])}function yn(n){return S(n)&&S(n[0])}function F(n,r){for(var t=new Array(n),e=0;e<n;++e)t[e]=an(r)?r(e,t):r;return t}function A(n,r,t){for(var e,i,u=new Array(n),f=0;f<n;++f)for(u[f]=i=new Array(r),e=0;e<r;++e)i[e]=an(t)?t(f,e,u):t;return u}function wn(n,t){return n.length?F(n[0],function(r){return 1<n.length?wn(n.slice(1),function(n){return an(t)?t([r].concat(n)):t}):an(t)?t([r]):t}):[]}function bn(n){return vn(n)?[[n]]:dn(n)?[n]:n}function xn(n){return vn(n)?[[n]]:dn(n)?n.map(function(n){return[n]}):n}function Sn(n,r){return C(n)?n:f(n)?r?n.re:n:w(n)&&1===n.length?Sn(n[0],r):b(n)&&1===n.length&&1===n[0].length?Sn(n[0][0],r):n}function q(n){if(null!=n)if(yn(n)){if(1===W(n))return n[0];if(1===U(n))return n.map(function(n){return n[0]})}else if(vn(n))return[n];return n}function W(n){return n.length}function U(n){return n[0].length}function j(r,t){return F(r.length,function(n){return r[n][t]})}function v(n){return"number"==typeof n?n:gn(n)?n.$valueOf():f(n)?n.valueOf():n}function B(n){return null!=_&&"number"==typeof n?_(n):n}function An(n){return S(n)?n.map(An):y(n)?v(n):n}function _n(n){return n=S(n)?n.map(_n):n}function In(r,n,t){if(C(n))return r(n);if(f(n)){if(t)return r(n);if(Q(n.im,O))return r(n.re)}return S(n)?n.map(function(n){return In(r,n,t)}):n}function kn(t,n,e,i){return C(n)&&C(e)?t(n,e):y(n)&&y(e)?i?t(Mn(n),Mn(e)):pn(n)&&pn(e)?t(Pn(n),Pn(e)):s:S(n)&&S(e)?n.map(function(n,r){return kn(t,n,e[r],i)}):s}function En(t,e){null==e&&(e=1);function n(){var n=[].slice.call(arguments);return n.unshift(e),n=t.apply(null,n),1<e&&S(n)&&(n.$scilitevarargout$=!0),n}return n.nargout=function(r){return function(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),(1<r||1<e)&&S(n)&&(n.$scilitevarargout$=!0),n}},n}function Nn(n){return hn(n)?n="nan":mn(n)?n=(Rn(n,O)?"-":"")+"inf":p(n)?n=String(n):C(n)?n=n.toFixed(4).replace(/\.0{4}$/,""):f(n)&&(n=String(n)),n}function qn(t){var r;return null==t?t="":N(t)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(t)&&(t="\\text{"+t+"}"):t=hn(t)?"\\text{nan}":C(t)?[nn,h,m,g,T].reduce(function(n,r){return n||Q(t,r)},!1)?String(t):Nn(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):f(t)?String(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):b(t)?(r=!1,U(t)>l.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,k.round(l.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-k.round(l.MAXPRINTSIZE/2)))}),r=!0),"\\begin{bmatrix}"+(t=W(t)>l.MAXPRINTSIZE?t.slice(0,k.round(l.MAXPRINTSIZE/2)).concat([F(k.min(t[0].length,l.MAXPRINTSIZE),function(n){return k.round(l.MAXPRINTSIZE/2)===n&&r?"\\ddots":"\\vdots"})]).concat(t.slice(1-k.round(l.MAXPRINTSIZE/2))):t).map(function(n){return n.map(qn).join(" & \\hskip 1em ")}).join(" \\\\ ")+"\\end{bmatrix}"):S(t)?(t=t.length>l.MAXPRINTSIZE?t.slice(0,k.round(l.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(t.slice(1-k.round(l.MAXPRINTSIZE/2))):t).map(qn).join(" \\hskip 1em "):"object"==typeof t||"function"==typeof t?"":String(t),t}function jn(t){var r,e;return null==t?t="":N(t)||(t=hn(t)?"nan":C(t)?([nn,h,m,g,T].reduce(function(n,r){return n||Q(t,r)},!1)?String:Nn)(t):f(t)?String(t):b(t)?(r=!1,U(t)>l.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,k.round(l.MAXPRINTSIZE/2)).concat("..").concat(n.slice(1-k.round(l.MAXPRINTSIZE/2)))}),r=!0),W(t)>l.MAXPRINTSIZE&&(t=t.slice(0,k.round(l.MAXPRINTSIZE/2)).concat([F(k.min(t[0].length,l.MAXPRINTSIZE),function(n){return k.round(l.MAXPRINTSIZE/2)===n&&r?"\\":":"})]).concat(t.slice(1-k.round(l.MAXPRINTSIZE/2)))),e=F(U(t),function(n){return j(t,n).reduce(function(n,r){return k.max(n,jn(r).length)},0)}),t.map(function(n,r){return"["+n.map(function(n,r){n=jn(n);return n=n.length<e[r]?new Array(e[r]-n.length+1).join(" ")+n:n}).join("  ")+"]"}).join("\n")):S(t)?(t=t.length>l.MAXPRINTSIZE?t.slice(0,k.round(l.MAXPRINTSIZE/2)).concat([".."]).concat(t.slice(1-k.round(l.MAXPRINTSIZE/2))):t).map(jn).join("  "):"object"==typeof t||"function"==typeof t?"":String(t)),t}function Pn(n){return S(n)?n.map(Pn):f(n)&&Q(n.im,O)?n.re:n}function Mn(n){return I?S(n)?n.map(Mn):C(n)?new I(B(n),O):n:n}function Q(n,r){return u(n)?u(r)?n===r:r.eq(n):n.eq(r)}function Rn(n,r){return u(n)?u(r)?n<r:r.gt(n):n.lt(r)}function Tn(n,r){return u(n)?u(r)?r<n:r.lt(n):n.gt(r)}function Xn(n,r){return u(n)?u(r)?n<=r:r.gte(n):n.lte(r)}function Zn(n,r){return u(n)?u(r)?r<=n:r.lte(n):n.gte(r)}function V(n,r){return u(n)?u(r)?n+r:r.add(n):n.add(r)}function G(n,r){return u(n)?u(r)?n-r:r.neg().add(n):n.sub(r)}function H(n,r){return u(n)?u(r)?n*r:r.mul(n):n.mul(r)}function D(n,r){return u(n)?u(r)?n/r:_(n).div(r):n.div(r)}function zn(n,r){return hn(n)||hn(r)?s:u(n)?u(r)?n<0&&!p(r)?Pn(new I(n).pow(r)):k.pow(n,r):n<0&&!p(r)?Pn(new I(_(n)).pow(r)):_(n).pow(r):Tn(O,n)&&!p(r)?Pn(new I(n).pow(_(r))):n.pow(r)}function Ln(n,r){return u(n)?u(r)?n%r:_(n).mod(r):n.mod(r)}function On(n){return u(n)?-n:n.neg()}function $n(n){return u(n)?1/n:$.div(n)}function Cn(t,e){if(N(t)){if(N(e))return t===e?1:0;if(y(e))return t===String(e)?1:0;if(w(e))return e.map(function(n){return Cn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Cn(t,e[n][r])})}else if(C(t)){if(N(e))return String(t)===e?1:0;if(C(e))return Q(t,e)?1:0;if(f(e))return Q(e.re,t)&&Q(e.im,O)?1:0;if(w(e))return e.map(function(n){return Cn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Cn(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)===e?1:0;if(C(e))return Q(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Q(t.re,e.re)&&Q(t.im,e.im)?1:0;if(w(e))return e.map(function(n){return Cn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Cn(t,e[n][r])})}else if(w(t)){if(N(e)||y(e))return t.map(function(n){return Cn(n,e)});if(w(e)){if(t.length!==e.length)throw"eq: inputs have incompatible dimensions";return t.map(function(n,r){return Cn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"eq: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Cn(t[r],e[n][r])})}}else if(b(t)){if(N(e)||y(e))return A(W(t),U(t),function(n,r){return Cn(t[n][r],e)});if(w(e)){if(U(t)!==e.length)throw"eq: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Cn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"eq: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Cn(t[n][r],e[n][r])})}}return 0}function Fn(t,e){if(N(t)){if(N(e))return t===e?0:1;if(y(e))return t===String(e)?0:1;if(w(e))return e.map(function(n){return Fn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Fn(t,e[n][r])})}else if(C(t)){if(N(e))return String(t)===e?0:1;if(C(e))return Q(t,e)?0:1;if(f(e))return Q(e.re,t)&&Q(e.im,O)?0:1;if(w(e))return e.map(function(n){return Fn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Fn(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)===e?0:1;if(C(e))return Q(t.re,e)&&Q(t.im,O)?0:1;if(f(e))return Q(t.re,e.re)&&Q(t.im,e.im)?0:1;if(w(e))return e.map(function(n){return Fn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Fn(t,e[n][r])})}else if(w(t)){if(N(e)||y(e))return t.map(function(n){return Fn(n,e)});if(w(e)){if(t.length!==e.length)throw"ne: inputs have incompatible dimensions";return t.map(function(n,r){return Fn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"ne: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Fn(t[r],e[n][r])})}}else if(b(t)){if(N(e)||y(e))return A(W(t),U(t),function(n,r){return Fn(t[n][r],e)});if(w(e)){if(U(t)!==e.length)throw"ne: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Fn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"ne: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Fn(t[n][r],e[n][r])})}}return 0}function Wn(t,e){if(N(t)){if(N(e))return t<e?1:0;if(y(e))return t<String(e)?1:0;if(w(e))return e.map(function(n){return Wn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Wn(t,e[n][r])})}else if(C(t)){if(N(e))return String(t)<e?1:0;if(C(e))return Rn(t,e)?1:0;if(f(e))return Rn(e.re,t)&&Q(e.im,O)?1:0;if(w(e))return e.map(function(n){return Wn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Wn(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)<e?1:0;if(C(e))return Rn(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Rn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Rn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(w(e))return e.map(function(n){return Wn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Wn(t,e[n][r])})}else if(w(t)){if(N(e)||y(e))return t.map(function(n){return Wn(n,e)});if(w(e)){if(t.length!==e.length)throw"lt: inputs have incompatible dimensions";return t.map(function(n,r){return Wn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"lt: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Wn(t[r],e[n][r])})}}else if(b(t)){if(N(e)||y(e))return A(W(t),U(t),function(n,r){return Wn(t[n][r],e)});if(w(e)){if(U(t)!==e.length)throw"lt: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Wn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"lt: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Wn(t[n][r],e[n][r])})}}return 0}function Un(t,e){if(N(t)){if(N(e))return e<t?1:0;if(y(e))return t>String(e)?1:0;if(w(e))return e.map(function(n){return Un(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Un(t,e[n][r])})}else if(C(t)){if(N(e))return String(t)>e?1:0;if(C(e))return Tn(t,e)?1:0;if(f(e))return Tn(e.re,t)&&Q(e.im,O)?1:0;if(w(e))return e.map(function(n){return Un(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Un(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)>e?1:0;if(C(e))return Tn(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Tn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Tn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(w(e))return e.map(function(n){return Un(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Un(t,e[n][r])})}else if(w(t)){if(N(e)||y(e))return t.map(function(n){return Un(n,e)});if(w(e)){if(t.length!==e.length)throw"gt: inputs have incompatible dimensions";return t.map(function(n,r){return Un(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"gt: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Un(t[r],e[n][r])})}}else if(b(t)){if(N(e)||y(e))return A(W(t),U(t),function(n,r){return Un(t[n][r],e)});if(w(e)){if(U(t)!==e.length)throw"gt: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Un(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"gt: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Un(t[n][r],e[n][r])})}}return 0}function Bn(t,e){if(N(t)){if(N(e))return t<=e?1:0;if(y(e))return t<=String(e)?1:0;if(w(e))return e.map(function(n){return Bn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Bn(t,e[n][r])})}else if(C(t)){if(N(e))return String(t)<=e?1:0;if(C(e))return Xn(t,e)?1:0;if(f(e))return Xn(e.re,t)&&Q(e.im,O)?1:0;if(w(e))return e.map(function(n){return Bn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Bn(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)<=e?1:0;if(C(e))return Xn(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Xn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Xn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(w(e))return e.map(function(n){return Bn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Bn(t,e[n][r])})}else if(w(t)){if(N(e)||y(e))return t.map(function(n){return Bn(n,e)});if(w(e)){if(t.length!==e.length)throw"le: inputs have incompatible dimensions";return t.map(function(n,r){return Bn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"le: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Bn(t[r],e[n][r])})}}else if(b(t)){if(N(e)||y(e))return A(W(t),U(t),function(n,r){return Bn(t[n][r],e)});if(w(e)){if(U(t)!==e.length)throw"le: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Bn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"le: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Bn(t[n][r],e[n][r])})}}return 0}function Qn(t,e){if(N(t)){if(N(e))return e<=t?1:0;if(y(e))return t>=String(e)?1:0;if(w(e))return e.map(function(n){return Qn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Qn(t,e[n][r])})}else if(C(t)){if(N(e))return String(t)>=e?1:0;if(C(e))return Zn(t,e)?1:0;if(f(e))return Zn(e.re,t)&&Q(e.im,O)?1:0;if(w(e))return e.map(function(n){return Qn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Qn(t,e[n][r])})}else if(f(t)){if(N(e))return String(t)>=e?1:0;if(C(e))return Zn(t.re,e)&&Q(t.im,O)?1:0;if(f(e))return Zn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Zn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(w(e))return e.map(function(n){return Qn(t,n)});if(b(e))return A(W(e),U(e),function(n,r){return Qn(t,e[n][r])})}else if(w(t)){if(N(e)||y(e))return t.map(function(n){return Qn(n,e)});if(w(e)){if(t.length!==e.length)throw"ge: inputs have incompatible dimensions";return t.map(function(n,r){return Qn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"ge: inputs have incompatible dimensions";return A(W(e),U(e),function(n,r){return Qn(t[r],e[n][r])})}}else if(b(t)){if(N(e)||y(e))return A(W(t),U(t),function(n,r){return Qn(t[n][r],e)});if(w(e)){if(U(t)!==e.length)throw"ge: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Qn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"ge: inputs have incompatible dimensions";return A(W(t),U(t),function(n,r){return Qn(t[n][r],e[n][r])})}}return 0}function Vn(n){return f(n)?n.sign():L.sign(n)}function J(n,r){return C(n)&&C(r)?V(n,r):f(n)&&y(r)?n.add(r):f(r)&&y(n)?r.add(n):s}function Gn(n,r){return C(n)&&C(r)?G(n,r):f(n)&&y(r)?n.sub(r):f(r)&&y(n)?r.neg().add(n):s}function K(n,r){return C(n)&&C(r)?H(n,r):f(n)&&y(r)?n.mul(r):f(r)&&y(n)?r.mul(n):s}function Y(n,r){return C(n)&&C(r)?D(n,r):f(n)&&y(r)?n.div(r):f(r)&&y(n)?r.inv().mul(n):s}function Hn(n,r){return C(n)&&C(r)?zn(n,r):f(n)&&y(r)?n.pow(r):f(r)&&y(n)?new I(n,O).pow(r):s}function Dn(n){return C(n)?On(n):f(n)?n.neg():s}function Jn(n){return C(n)?n:f(n)?n.conj():s}function Kn(n){return C(n)?Q(n,O)?a:$n(n):f(n)?Q(n.abs(),O)?new I(a,Rn(n.im,O)?a:-a):n.inv():s}function Yn(n){return C(n)?L.abs(n):f(n)?n.abs():s}function nr(n){return C(n)?Rn(n,O)?ln.pi:O:f(n)?n.angle():s}function rr(r,e){if(N(r)&&N(e))return r+e;if(y(r)&&y(e))return J(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return rr(n,t[r])})});throw"add: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return rr(n,e[r])});throw"add: vector dimensions do not match"}return S(r)?r.map(function(n){return rr(n,e)}):S(e)?e.map(function(n){return rr(r,n)}):void d("add")}function tr(r,e){if(y(r)&&y(e))return Gn(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return tr(n,t[r])})});throw"sub: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return tr(n,e[r])});throw"sub: vector dimensions do not match"}return S(r)?r.map(function(n){return tr(n,e)}):S(e)?e.map(function(n){return tr(r,n)}):void d("sub")}function er(r,e){if(y(r)&&y(e))return K(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return er(n,t[r])})});throw"dotmul: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return er(n,e[r])});throw"dotmul: vector dimensions do not match"}return S(r)?r.map(function(n){return er(n,e)}):S(e)?e.map(function(n){return er(r,n)}):void d("dotmul")}function ir(r,e){if(y(r)&&y(e))return Y(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return ir(n,t[r])})});throw"dotdiv: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return ir(n,e[r])});throw"dotdiv: vector dimensions do not match"}return S(r)?r.map(function(n){return ir(n,e)}):S(e)?e.map(function(n){return ir(r,n)}):void d("dotdiv")}function ur(r,e){if(y(r)&&y(e))return Hn(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return ur(n,t[r])})});throw"dotpow: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return ur(n,e[r])});throw"dotpow: vector dimensions do not match"}return S(r)?r.map(function(n){return ur(n,e)}):S(e)?e.map(function(n){return ur(r,n)}):void d("dotpow")}function P(i,u){if(y(i)&&y(u))return K(i,u);if(b(i)&&b(u)){if(U(i)===W(u))return n=W(i),r=U(u),f=W(u),A(n,r,function(n,r){for(var t=O,e=0;e<f;++e)t=J(t,K(i[n][e],u[e][r]));return t});throw"mul: matrix-matrix dimensions do not match"}if(w(i)&&b(u)){if(i.length===W(u))return r=U(u),f=i.length,A(n=1,r,function(n,r){for(var t=O,e=0;e<f;++e)t=J(t,K(i[e],u[e][r]));return t});throw"mul: vector-matrix dimensions do not match"}if(b(i)&&w(u)){var f;if(U(i)===u.length)return n=W(i),f=u.length,A(n,r=1,function(n,r){for(var t=O,e=0;e<f;++e)t=J(t,K(i[n][e],u[e]));return t});throw"mul: matrix-vector dimensions do not match"}var n,r;return w(i)&&w(u)?A(n=i.length,r=u.length,function(n,r){return K(i[n],u[r])}):S(i)?i.map(function(n){return P(n,u)}):S(u)?u.map(function(n){return P(i,n)}):void d("mul")}function fr(n,r){if(y(n)&&y(r))return Hn(n,r);if(b(n)&&W(n)===U(n)&&p(r)){if((r=v(r))<0&&(r=-r,!(n=tt(n))||!n.length))throw"pow: no inverse";if(0===r)return br(W(n));if(1===r)return n;if(2===r)return P(n,n);for(var t=br(W(n));0!==r;)1&r&&(t=P(t,n)),0<(r>>=1)&&(n=P(n,n));return t}d("pow")}function or(n){return y(n)?Dn(n):S(n)?n.map(or):n}function lr(e,n=":",t=null){if(dn(e)){if(w(n)&&n.length===e.length&&Fr(n,function(n){return 0===v(n)||1===v(n)}))return f=1===(f=n.reduce(function(n,r,t){return 1===v(r)&&n.push(e[t]),n},[])).length?f[0]:f;if(":"===(n=y(n)?Sn(n,!0):n)||p(n)||w(n))return r=e.length,1===(f=(n=p(n=":"===n?xr(1,r):n)?[n]:n).map(function(n){if((n=v(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[n-1]})).length?f[0]:f;throw"get: invalid range"}if(yn(e)){var i=W(e),u=U(e),r=i*u;if(null==t&&b(n)&&W(n)===i&&U(n)===u&&Fr(n,function(n){return 0===v(n)||1===v(n)})){for(var f=[],o=0;o<u;++o)for(var l=0;l<i;++l)1===v(n[l][o])&&f.push(e[l][o]);return f=1===f.length?f[0]:f}if(y(n)&&(n=Sn(n,!0)),y(t)&&(t=Sn(t,!0)),":"===n||p(n)||w(n)){if(p(n=":"===n?xr(1,i):n)&&(n=[n]),null==t)return f=1===(f=n.map(function(n){if((n=v(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[(n-1)%i][k.floor((n-1)/i)]})).length?f[0]:f;if(":"===t||p(t)||w(t))return p(t=":"===t?xr(1,u):t)&&(t=[t]),f=1===(f=n.map(function(r){if((r=v(r))<1&&(r+=i),r<1||i<r)throw"get: index out of bounds";return t.map(function(n){if((n=v(n))<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[r-1][n-1]})})).length&&1===f[0].length?f[0][0]:f}throw"get: invalid range"}return e}function cr(i,r=":",n=null,u=null){if(dn(i)){if(yn(u)&&(u=j(u,0)),w(r)&&r.length===i.length&&Fr(r,function(n){return 0===v(n)||1===v(n)})){if(vn(u))return r.forEach(function(n,r){1===v(n)&&(i[r]=u)}),i;if(S(u))return h=0,t=u.length,r.forEach(function(n,r){if(1===v(n)){if(t<=h)throw"set: index out of bounds";i[r]=u[h++]}}),i}if(":"===(r=y(r)?Sn(r,!0):r)||p(r)||w(r)){var e=i.length;if(p(r=":"===r?xr(1,e):r)&&(r=[r]),vn(u))return r.forEach(function(n){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u}),i;if(S(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u[r]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(yn(i)){var f,o,t,l,c,a,s,h,m=W(i),g=U(i),e=m*g;if(b(r)&&W(r)===m&&U(r)===g&&Fr(r,function(n){return 0===v(n)||1===v(n)})){if(vn(u))return r.forEach(function(n,t){n.forEach(function(n,r){1===v(n)&&(i[t][r]=u)})}),i;if(yn(u)){for(f=W(u),o=U(u),s=c=0;c<g;++c,++s){if(1===o)s=0;else if(o<=s)throw"set: index out of bounds";for(a=l=0;l<m;++l,++a)if(1===v(r[l][c])){if(1===f)a=0;else if(f<=a)throw"set: index out of bounds";i[l][c]=u[a][s]}}return i}if(S(u)){for(t=u.length,c=h=0;c<g;++c)for(l=0;l<m;++l)if(1===v(r[l][c])){if(t<=h)throw"set: index out of bounds";i[l][c]=u[h++]}return i}}if(y(r)&&(r=Sn(r,!0)),y(n)&&(n=Sn(n,!0)),":"===r||p(r)||w(r)){if(null==n){if(p(r=":"===r?xr(1,e):r)&&(r=[r]),vn(u))return r.forEach(function(n){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][k.floor((n-1)/m)]=u}),i;if(yn(u))return f=W(u),o=U(u),r.forEach(function(n,r){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";var t=1===f?0:r%m,r=1===o?0:k.floor(r/m);if(f<=t||o<=r)throw"set: index out of bounds";i[(n-1)%m][k.floor((n-1)/m)]=u[t][r]}),i;if(S(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=v(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][k.floor((n-1)/m)]=u[r]}),i}else if(":"===n||p(n)||w(n)){if(p(r=":"===r?xr(1,m):r)&&(r=[r]),p(n=":"===n?xr(1,g):n)&&(n=[n]),vn(u))return r.forEach(function(r){if((r=v(r))<1&&(r+=m),r<1||m<r)throw"set: index out of bounds";n.forEach(function(n){if((n=v(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";i[r-1][n-1]=u})}),i;if(yn(u))return f=W(u),o=U(u),r.forEach(function(t,e){if((t=v(t))<1&&(t+=m),t<1||m<t)throw"set: index out of bounds";if(1===f)e=0;else if(f<=e)throw"set: index out of bounds";n.forEach(function(n,r){if((n=v(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";if(1===o)r=0;else if(o<=r)throw"set: index out of bounds";i[t-1][n-1]=u[e][r]})}),i;if(S(u)&&u.length>=r.length*n.length)return h=0,n.forEach(function(t,n){if((t=v(t))<1&&(t+=g),t<1||g<t)throw"set: index out of bounds";r.forEach(function(n,r){if((n=v(n))<1&&(n+=m),n<1||m<n)throw"set: index out of bounds";i[n-1][t-1]=u[h++]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function ar(n,r){var t,e,i;return u(n)&&u(r)?(t=n,e=r,t=k.abs(t),e=k.abs(e),(i=0)===t?e:0===e?t:e<t?t*k.sqrt(1+(i=e/t)*i):t<e?e*k.sqrt(1+(i=t/e)*i):t*k.SQRT2):L.sqrt(V(H(n,n),H(r,r)))}function sr(n,r){var t,n=1===arguments.length?n:tr(n,r);return n.reduce(function(n,r){return n&&(u(r)||f(r)&&u(r.re)&&u(r.im))},!0)?(t=0,r=(r=n).map(function(n){return n=Yn(n),t<n&&(t=n),n}),0===t?0:t*k.sqrt(r.reduce(function(n,r){return r===t?n+1:n+(n=r/t)*n},0))):L.sqrt(gr(Tr(n,n)))}function hr(){var n,r,t,e=0,i=0;if(u(hr.z1))return t=hr.z1,hr.z1=null,t;for(;0===e||1===e;)e=k.random();for(;0===i||1===i;)i=k.random();return r=(n=k.sqrt(-2*k.log(e)))*k.cos(2*R*i),t=n*k.sin(2*R*i),hr.z1=t,r}function mr(){if(!cn(this,mr))return new mr;this.data=[]}function gr(n){return In(function(n){return f(n)?n.re:n},n,!0)}function pr(n){return In(function(n){return f(n)?n.im:0},n,!0)}function vr(n){return In(Jn,n,!0)}function dr(n){return In(Yn,n,!0)}function yr(n,r){if(mn(r=null==r?rn:r)){if(y(n=q(n)))return Yn(n);if(w(n))return(Rn(r,O)?jr:Pr)(dr(n));if(b(n)&&Tn(r,O))return Pr(Mr(dr(Ar(n))))}else if(C(r)){if(n=q(n),Q(r,$)){if(y(n))return Yn(n);if(w(n))return Mr(dr(n));if(b(n))return Pr(Mr(dr(n)))}else if(Q(r,rn)){if(y(n))return Yn(n);if(w(n))return sr(n);if(b(n))return Pr(pt(n,null,!1,!1))}else if(Tn(r,O)){if(y(n))return Yn(n);if(w(n))return function(n,r,t){return 2===arguments.length&&(t=r),Hn(Mr(ur(dr(2===arguments.length?n:tr(n,r)),t)),$n(t))}(n,r)}}else if("fro"===r&&b(n))return L.sqrt(ft(gr(P(_r(n),n))));d("norm")}function wr(n,r){return w(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),O)}function br(n,t){return null==t&&(t=$),A(v(n=Sn(n=null==n?1:n,!0)),v(n),function(n,r){return n===r?t:O})}function xr(n,r,t){if(1===arguments.length&&S(n)){if(yn(n)){for(var e,i=W(n),u=U(n),f=new Array(u*i),o=0,l=0;l<u;++l)for(e=0;e<i;++e)f[o++]=n[e][l];return f}return n}if(null!=t&&null!=r||(null!=r?(t=r,r=$):(t=n,n=r=$)),n=Sn(n,!0),r=Sn(r,!0),t=Sn(t,!0),f=[],Tn(r,O))for(;Xn(n,t);n=V(n,r))f.push(n);else if(Rn(r,O))for(;Zn(n,t);n=V(n,r))f.push(n);return f}function Sr(n,r,t){if("horz"===n){if(dn(r)&&dn(t))return r.concat(t);if(yn(r)&&yn(t)&&W(r)===W(t))return r.map(function(n,r){return n.concat(t[r])})}if("vert"===n){if(dn(r)&&dn(t))return r.concat(t);if(yn(r)&&yn(t)&&U(r)===U(t))return r.concat(t)}d("cat")}function Ar(t){return yn(t)?A(U(t),W(t),function(n,r){return t[r][n]}):t}function _r(t){return yn(t)?A(U(t),W(t),function(n,r){return y(t[r][n])?Jn(t[r][n]):t[r][n]}):dn(t)?t.map(function(n){return y(n)?Jn(n):n}):y(t)?Jn(t):t}function Ir(t,i){return i=v(i||0),vn(t)?[[t]]:dn(t)?A(t.length,t.length,function(n,r){return i===n-r?t[n]:O}):yn(t)?t.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i===e-t&&n.push(r),n},n)},[]):void d("diag")}function kr(t,n){var e,i;return vn(t)?t:dn(t)?t.slice().reverse():yn(t)?(e=W(t),i=U(t),1===(n=v(n=null==n?1:n))?A(e,i,function(n,r){return t[e-1-n][r]}):2===n?A(e,i,function(n,r){return t[n][i-1-r]}):t):void d("flip")}function Er(n,r){var t=gr(n),e=gr(r),n=pr(n),r=pr(r),t=Rn(t,e)?-1:Tn(t,e)?1:0,e=Rn(n,r)?-1:Tn(n,r)?1:0;return t||e}function Nr(n,r){var t=Yn(n),e=Yn(r),n=nr(n),r=nr(r),t=Rn(t,e)?-1:Tn(t,e)?1:0,e=Rn(n,r)?-1:Tn(n,r)?1:0;return t||e}function qr(r,t,e,i,n){var u;if(vn(r))return r;if(w(r))return null==i&&(i=pn(r)?Er:Nr),u=r.map(function(n,r){return{v:n,i:r}}).sort("descend"===e?function(n,r){return i(r.v,n.v)||n.i-r.i}:function(n,r){return i(n.v,r.v)||n.i-r.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(b(r)){if(1===t)return n?(u=F(U(r),function(n){n=j(r,n);return qr(n,t,e,null==i?pn(n)?Er:Nr:i,!0)}),[A(W(r),U(r),function(n,r){return u[r][0][n]}),A(W(r),U(r),function(n,r){return u[r][1][n]})]):(u=F(U(r),function(n){n=j(r,n);return qr(n,t,e,null==i?pn(n)?Er:Nr:i,!1)}),A(W(r),U(r),function(n,r){return u[r][n]}));if(2===t)return n?(u=F(W(r),function(n){n=r[n];return qr(n,t,e,null==i?pn(n)?Er:Nr:i,!0)}),[A(W(r),U(r),function(n,r){return u[n][0][r]}),A(W(r),U(r),function(n,r){return u[n][1][r]})]):(u=F(W(r),function(n){n=r[n];return qr(n,t,e,null==i?pn(n)?Er:Nr:i,!1)}),A(W(r),U(r),function(n,r){return u[n][r]}))}d("sort")}function jr(r){return y(r=q(r))?r:w(r)?r.reduce(function(n,r){return n=Rn(r,n)?r:n},a):b(r)?F(U(r),function(n){return jr(j(r,n))}):s}function Pr(r){return y(r=q(r))?r:w(r)?r.reduce(function(n,r){return n=Tn(r,n)?r:n},-a):b(r)?F(U(r),function(n){return Pr(j(r,n))}):s}function Mr(r){return y(r=q(r))?r:w(r)?r.reduce(J,O):b(r)?F(U(r),function(n){return Mr(j(r,n))}):s}function Rr(r){return y(r=q(r))?r:w(r)?r.reduce(K,$):b(r)?F(U(r),function(n){return Rr(j(r,n))}):s}function Tr(r,e,i){if(i=!0===i,r=q(r),e=q(e),y(r)&&y(e))return K(r,i?e:Jn(e));if(w(r)&&w(e)){if(r.length===e.length)return r.reduce(function(n,r,t){return J(n,K(r,i?e[t]:Jn(e[t])))},0)}else if(b(r)&&b(e)&&W(r)===W(e)&&U(r)===U(e))return F(U(r),function(n){return Tr(j(r,n),j(e,n),i)});return 0}function Xr(t,e){var n,r,i,u;if(b(t)){if(b(e))return n=W(t),r=U(t),i=W(e),u=U(e),A(n*i,r*u,function(n,r){return P(t[k.floor(n/i)][k.floor(r/u)],e[n%i][r%u])});if(w(e))return n=W(t),r=U(t),i=1,u=e.length,A(n*i,r*u,function(n,r){return P(t[n][k.floor(r/u)],e[r%u])})}else if(w(t)){if(w(e))return A(t.length,e.length,function(n,r){return P(t[n],e[r])});if(b(e))return n=t.length,i=W(e),u=U(e),A(n*i,(r=1)*u,function(n,r){return P(t[k.floor(n/i)],e[n%i][r%u])})}return P(t,e)}function Zr(r,t,n){if(w(t)){var e,i,u;if(null==r||y(r)){for(null==r&&(r=$),e=0,i=t.length-1,u=O;e<i;++e)u=J(u,K(r,Y(J(t[e+1],t[e]),rn)));return u}if(w(r)&&r.length===t.length){for(e=0,i=r.length-1,u=O;e<i;++e)u=J(u,K(Yn(Gn(r[e+1],r[e])),Y(J(t[e+1],t[e]),rn)));return u}}else if(b(t))if(1===(n=v(n=null==n?1:n))){if(null==r||y(r)||w(r)&&r.length===W(t))return F(U(t),function(n){return Zr(r,j(t,n))});if(b(r)&&W(r)===W(t)&&U(r)===U(t))return F(U(t),function(n){return Zr(null==r?null:j(r,n),j(t,n))})}else if(2===n){if(null==r||y(r)||w(r)&&r.length===U(t))return F(W(r),function(n){return Zr(r,t[n])});if(b(r)&&W(r)===W(t)&&U(r)===U(t))return F(W(r),function(n){return Zr(r[n],t[n])})}d("trapz")}function zr(r,t,e,i){var u;if(y(r))return r;if(w(r)){if("reverse"===(e=null==e?"forward":e))return r.slice().reverse().map(function(n,r){return u=0===r?n:t(u,n)}).reverse();if("forward"===e)return r.map(function(n,r){return u=0===r?n:t(u,n)})}else if(b(r)){if(1===(i=v(i=null==i?1:i)))return F(U(r),function(n){return zr(j(r,n),t,e,i)});if(2===i)return F(W(r),function(n){return zr(r[n],t,e,i)})}return!1}function Lr(r,t,e,i,u){var f;if(w(r))return F(f=r.length,function(n){return t(r.slice(k.max(0,n-e),k.min(f-1,n+i)+1))});if(b(r)){if(1===(u=v(u=null==u?1:u)))return F(U(r),function(n){return Lr(j(r,n),t,e,i,u)});if(2===u)return F(W(r),function(n){return Lr(r[n],t,e,i,u)})}return!1}function Or(r){var n=[].slice.call(arguments,1);return S(n[0])&&(n=n[0]),vn(r)?n.length?n.map(function(n){return[1,1][v(n)-1]}):[1,1]:dn(r)?n.length?n.map(function(n){return[1,r.length][v(n)-1]}):[1,r.length]:yn(r)?n.length?n.map(function(n){return[W(r),U(r)][v(n)-1]}):[W(r),U(r)]:[]}function $r(n){return S(n)?k.max.apply(null,Or(n)):null==n?0:1}function Cr(n,i){var u;return w(n)?n.reduce(function(n,r,t){return i(r,t+1,1)&&n.push(t+1),n},[]):b(n)?(u=W(n),n.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i(r,e+1,t+1)&&n.push(e+u*t+1),n},n)},[])):[]}function Fr(n,r){if(y(n))return r(n,1,1)?1:0;if(w(n)){for(var t=0,e=n.length;t<e;++t)if(!r(n[t],t+1,1))return 0;return 1}if(b(n)){for(var t=0,i=W(n),u=U(n);t<i;++t)for(var f=0;f<u;++f)if(!r(n[t][f],t+1,f+1))return 0;return 1}return 0}function Wr(n,r){if(y(n))return r(n,1,1)?1:0;if(w(n)){for(var t=0,e=n.length;t<e;++t)if(r(n[t],t+1,1))return 1}else if(b(n))for(var t=0,i=W(n),u=U(n);t<i;++t)for(var f=0;f<u;++f)if(r(n[t][f],t+1,f+1))return 1;return 0}function Ur(n,r,t){var e;r!==t&&(e=n[r],n[r]=n[t],n[t]=e)}function Br(n,r,t,e,i,u){var f,o=n[0].length;for(null==e&&(e=$),null==i&&(i=$),f=u||0;f<o;++f)n[r][f]=J(K(i,n[r][f]),K(e,n[t][f]))}function Qr(n,r,t,e,i,u,f){for(var o,l,c=n[0].length,a=0;a<c;++a)o=n[r][a],l=n[t][a],n[r][a]=J(K(e,o),K(i,l)),n[t][a]=J(K(u,o),K(f,l))}function Vr(n,r,t,e,i,u,f){for(var o,l,c=n.length,a=0;a<c;++a)o=n[a][r],l=n[a][t],n[a][r]=J(K(e,o),K(u,l)),n[a][t]=J(K(i,o),K(f,l))}function Gr(t,e,i,n,r){var u=W(t),f=U(t);return u&&f?S(e)&&S(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<f}),A(e.length,i.length,function(n,r){return t[e[n]][i[r]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=f),(n=null==n?u-1:n)<0&&(n+=u),(r=null==r?f-1:r)<0&&(r+=f),e=k.max(0,k.min(u-1,e)),n=k.max(0,k.min(u-1,n)),i=k.max(0,k.min(f-1,i)),r=k.max(0,k.min(f-1,r)),e<=n&&i<=r?A(n-e+1,r-i+1,function(n,r){return t[e+n][i+r]}):[]):[]}function Hr(t,e,n){var i=W(t),u=U(t),f=W(e),o=U(e);return"vert"===(n=n||"horz")?A(i+f,k.max(u,o),function(n,r){return u<=r?n<i?O:e[n-i][r]:o<=r?n<i?t[n][r]:O:(n<i?t[n]:e[n-i])[r]}):A(k.max(i,f),u+o,function(n,r){return i<=n?r<u?O:e[n][r-u]:f<=n?r<u?t[n][r]:O:r<u?t[n][r]:e[n][r-u]})}function Dr(n,r,t,e){var i,u,f,o=W(n),l=U(n);if(!1===t||o===l){for(e=B(e||0),i=k.min(o,l),u=0;u<i;++u){if("lower"===r||"diagonal"===r)for(f=u+1;f<i;++f)if(!Bn(Yn(n[u][f]),e))return;if("upper"===r||"diagonal"===r)for(f=0;f<u;++f)if(!Bn(Yn(n[u][f]),e))return}if(l<o){for(u=i;u<o;++u)for(f=0;f<l;++f)if(!Bn(Yn(n[u][f]),e))return}else if(o<l)for(f=i;f<l;++f)for(u=0;u<o;++u)if(!Bn(Yn(n[u][f]),e))return;return 1}}function Jr(n,r){var t,e,i;return Cn(r,O)?(t=$,e=O):Cn(n,O)?(t=O,Cn(e=Vn(Jn(r)),O)&&(e=$)):(i=Vn(n),t=Y(n=Yn(n),n=ar(n,Yn(r))),e=Y(K(i,Jn(r)),n)),[t,e]}function Kr(n,r,t,e,i){var u,f,o,l,c=W(i),a=_n(i),s=2===r.length&&y(r[0])?(f=r[0],o=Dn(r[1]),l=r[1],r[0]):2===r.length&&2===r[0].length?(f=r[0][0],o=r[0][1],l=r[1][0],r[1][1]):(f=r[t][t],o=r[t][e],l=r[e][t],r[e][e]);if("right"===n)for(u=0;u<c;++u)a[u][t]=J(K(f,i[u][t]),K(l,i[u][e])),a[u][e]=J(K(o,i[u][t]),K(s,i[u][e]));else for(u=0;u<c;++u)a[t][u]=J(K(f,i[t][u]),K(o,i[e][u])),a[e][u]=J(K(l,i[t][u]),K(s,i[e][u]));return a}l.decimal=function(n){"function"==typeof n?(_=n,un.call(_.prototype,"_valueof")||(_.prototype._valueof=null,_.prototype.$valueOf=function(){return null==this._valueof&&(this._valueof=parseFloat(this.toFixed(9))),this._valueof},_.prototype.sign=function(){return _.sign(this)}),O=_(0),$=_(1),Z=_(-1),z=_(.5),rn=_(2),tn=_(10),o=_(k.log(10)),c=_(k.log(2)),ln.eps=_(nn),ln.pi=_(R),ln.e=_(i),ln.realmax=_(h),ln.realmin=_(m),ln.intmax=_(g),ln.intmin=_(T),ln.bitmax=_(X)):(_=null,O=0,Z=-($=1),z=.5,rn=2,tn=10,c=k.log(2),o=k.log(10),ln.eps=nn,ln.pi=R,ln.e=i,ln.realmax=h,ln.realmin=m,ln.intmax=g,ln.intmin=T,ln.bitmax=X),I&&(new I(O,$),t=new I(ln.e,O)),en.forEach(function(n){n()})},l.is_array=S,l.is_obj=sn,l.is_string=N,l.is_nan=hn,l.is_inf=mn,l.is_number=u,l.is_decimal=gn,l.is_int=p,l.is_complex=f,l.is_real=pn,l.is_scalar=y,l.is_vector=w,l.is_matrix=b,l.array=F,l.matrix=A,l.ndarray=wn,E.rowvec=bn,E.colvec=xn,l.sca=Sn,l.vec=q,l.tonumber=An,l.todecimal=function n(r){return S(r)?r.map(n):y(r)?B(r):r},l.copy=_n,l.apply=In,l.apply2=kn,l.exist=function(n,r){return sn(r)&&N(n)&&un.call(r,n)?1:0},l.varargout=En,l.num2str=Nn,l.MAXPRINTSIZE=a,l.tex=function(n){return S(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(qn).join("\\]\n\\[")+"\\]":S(n[0])?S(n[0][0])||!S(n[1])||n[0].length!==n[1].length?"\\["+n.map(qn).join("\\]\n\\[")+"\\]":"\\["+qn(n)+"\\]":"\\["+(n=n.length>l.MAXPRINTSIZE?n.slice(0,k.round(l.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-k.round(l.MAXPRINTSIZE/2))):n).map(qn).join("\\]\n\\[")+"\\]":"":(n=qn(n)).length&&(n="\\["+n+"\\]"),n},l.str=function(n){return n=S(n)?n.length?n.$scilitevarargout$?n.map(jn).join("\n\n"):S(n[0])?S(n[0][0])||!S(n[1])||n[0].length!==n[1].length?n.map(jn).join("\n\n"):jn(n):(n=n.length>l.MAXPRINTSIZE?n.slice(0,k.round(l.MAXPRINTSIZE/2)).concat(":").concat(n.slice(1-k.round(l.MAXPRINTSIZE/2))):n).map(jn).join("\n"):"":jn(n)},l.neq=Q,l.nlt=Rn,l.ngt=Tn,l.nle=Xn,l.nge=Zn,l.nadd=V,l.nsub=G,l.nmul=H,l.ndiv=D,l.npow=zn,l.nmod=Ln,l.nneg=On,l.ninv=$n,l.eq=Cn,l.ne=Fn,l.lt=Wn,l.gt=Un,l.le=Bn,l.ge=Qn,l.ssign=Vn,l.sadd=J,l.ssub=Gn,l.smul=K,l.sdiv=Y,l.spow=Hn,l.sneg=Dn,l.sconj=Jn,l.sinv=Kn,l.sabs=Yn,l.sangle=nr,l.add=rr,l.sub=tr,l.dotmul=er,E.times=er,l.dotdiv=ir,l.dotpow=ur,E.power=ur,l.mul=P,l.pow=fr,E.mpower=fr,l.neg=or,l.get=lr,l.set=cr,l.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],mr.prototype={constructor:mr,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,option:function(n,r,t,e){var i,u,f,o={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},l={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},c={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},a=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:c[a[(e||0)%a.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=c[a[(e||0)%a.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=o["-"]),n._LineStyle||(n._LineStyle="-"),t=t||0;t<r.length;){if("Color"===r[t])N(i=r[t+1])?un.call(l,i)?n.Color=c[l[i]]:un.call(c,i)&&(n.Color=c[i]):w(i)&&3===i.length&&(n.Color=An(i));else if("LineWidth"===r[t])C(i=r[t+1])&&(n.LineWidth=2*An(i));else{if("LineStyle"!==r[t]){if(N(r[t])){for(u in f=!1,i=r[t],c)-1<i.indexOf(u)&&(n.Color=c[u],f=!0);for(u in o)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=o[u],f=!0);if(f){t+=1;continue}}break}N(i=r[t+1])&&un.call(o,i)&&(n._LineStyle=i,n.LineStyle=o[i])}t+=2}return t},parse:function(n,r,t){var e,i,u,f,o,l,c,a=this,s=0,h=0;if("pie"===r)for(;s<n.length;)w(u=q(n[s]))&&a.data.push({y:An(u)}),s+=1;else if("plot3"===r)for(;s<n.length;)l=o=f=null,w(u=q(n[s]))&&(f=u),w(u=q(n[s+1]))&&(o=u),w(u=q(n[s+2]))&&(l=u,s+=3),f&&o&&l?(s=a.option(c={},n,s,h),a.data.push({x:An(f),y:An(o),z:An(l),style:c}),++h):s+=1;else for(;s<n.length;)if(o=f=null,w(u=q(n[s]))&&(f=u),w(n[s+1])||b(n[s+1])?(o=q(n[s+1]),s+=2):f&&(f=xr(1,(o=f).length),s+=1),f&&o)if(f=An(f),s=a.option(c={},n,s,h),b(o))for(e=0,i=U(o);e<i;++e)a.data.push({x:f,y:An(j(o,e)),style:c}),c=a.option(c,n,s,++h);else a.data.push({x:f,y:An(o),style:c}),++h;else s+=1;return a}},l.figure=mr,l.createCanvas=function(n,r){},l.currentCanvas=function(){},E.clc=r,E.disp=r,E.clear=r,E.help=r,E.who=r,E.whos=r,E.exist=r,["floor","ceil","round","sign","abs","exp","log","log10","log2","sqrt","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){L[r]="log"===r?function(n){return u(n)?k.log(n):n.ln()}:"log10"===r?function(n){return u(n)?k.log10(n):n.log(tn)}:"log2"===r?function(n){return u(n)?k.log2(n):n.log(rn)}:function(n){return u(n)?k[r](n):n[r]()}}),L.atan2=function(n,r){return Q(O,r)&&Q(O,n)?O:(u(n)&&u(r)?k:_).atan2(n,r)},L.fix=function(n){return Rn(n,O)?L.ceil(n):L.floor(n)},l.realMath=L,(I=function n(r,t,e){var i=this;if(!cn(i,n))return new n(r,t,e);f(r)?(i.re=r.re,i.im=r.im):(t=t||O,"polar"===e?(i._rho=L.abs(r),i.re=H(i._rho,L.cos(t)),i.im=H(i._rho,L.sin(t))):(i.re=r,i.im=t))}).prototype={constructor:I,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var r=this;return null==r._rho&&(r._rho=ar(r.re,r.im)),r._rho},norm2:function(){return null==this._rho2&&(this._rho2=zn(this.abs(),rn)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=L.atan2(n.im,n.re)),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=Q(n.im,O)?L.sign(n.re):n.div(n.abs()),f(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return C(n)?new I(V(this.re,n),this.im):new I(V(this.re,n.re),V(this.im,n.im))},sub:function(n){return C(n)?new I(G(this.re,n),this.im):new I(G(this.re,n.re),G(this.im,n.im))},mul:function(n){var r,t,e,i=this;return C(n)?new I(Q(i.re,O)?O:H(i.re,n),Q(i.im,O)?O:H(i.im,n)):(r=i.re,e=n.re,i=i.im,t=H(r,V(e,n=n.im)),n=H(n,V(r,i)),e=H(e,G(i,r)),new I(G(t,n),V(t,e)))},div:function(n){var r,t,e,i=this;return C(n)?new I(Q(i.re,O)?O:D(i.re,n),Q(i.im,O)?O:D(i.im,n)):(t=n.norm2(),r=i.re,e=D(n.re,t),i=i.im,t=H(r,V(e,n=On(D(n.im,t)))),n=H(n,V(r,i)),e=H(e,G(i,r)),new I(G(t,n),V(t,e)))},pow:function(n){var r,t;return hn(n)?s:C(n)?new I(zn(this.abs(),n),H(this.angle(),n),"polar"):f(n)?(r=this.abs(),t=this.angle(),new I(zn(r,n.re),H(n.im,L.log(r)),"polar").mul(new I(L.exp(On(H(n.im,t))),H(t,n.re),"polar"))):void 0},neg:function(){return new I(On(this.re),On(this.im))},conj:function(){return new I(this.re,On(this.im))},inv:function(){var n=this.norm2();return new I(D(this.re,n),On(D(this.im,n)))},toString:function(){var n=this;return null==n._str&&(n._str=Nn(n.re)+(Rn(n.im,O)?" - ":" + ")+Nn(L.abs(n.im))+"i"),n._str},valueOf:function(){return v(this.re)}},new I(O,$),t=new I(ln.e,O),e={floor:function(n){return new I(L.floor(n.re),L.floor(n.im))},ceil:function(n){return new I(L.ceil(n.re),L.ceil(n.im))},round:function(n){return new I(L.round(n.re),L.round(n.im))},fix:function(n){return new I(L.fix(n.re),L.fix(n.im))},sign:function(n){return n.sign()},sqrt:function(n){return n.pow(new I(z,O))},exp:function(n){return t.pow(n)},log:function(n){return new I(L.log(n.abs()),n.angle())},log10:function(n){return e.log(n).div(o)},log2:function(n){return e.log(n).div(c)},sin:function(n){return new I(H(L.sin(n.re),L.cosh(n.im)),H(L.cos(n.re),L.sinh(n.im)))},cos:function(n){return new I(H(L.cos(n.re),L.cosh(n.im)),On(H(L.sin(n.re),L.sinh(n.im))))},tan:function(n){return e.sin(n).div(e.cos(n))},sinh:function(n){return new I(H(L.sinh(n.re),L.cos(n.im)),H(L.cosh(n.re),L.sin(n.im)))},cosh:function(n){return new I(H(L.cosh(n.re),L.cos(n.im)),H(L.sinh(n.re),L.sin(n.im)))},tanh:function(n){return e.sinh(n).div(e.cosh(n))},asin:null,acos:null,atan:null,asinh:null,acosh:null,atanh:null},l.complexMath=e,E.complex=I,["floor","ceil","round","fix","sign","exp","log","log10","log2","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){E[r]=e[r]?function(n){return In(function(n){return(f(n)?e:L)[r](n)},n,!0)}:function(n){return In(function(n){return L[r](n)},n,!1)}}),E.atan2=function(n,r){return kn(function(n,r){return L.atan2(n,r)},n,r,!1)},E.sqrt=function(n){return In(function(n){return f(n)?e.sqrt(n):Tn(O,n)?new I(O,L.sqrt(On(n))):L.sqrt(n)},n,!0)},["sqrt","pow","log"].forEach(function(r){E["real"+r]=function(n){return In(function(n){f(n=Pn(n))&&d("real"+r);n=L[r](n);return hn(n)||!pn(n)?d("real"+r):n},n,!0)}}),E.real=gr,E.imag=pr,E.conj=vr,E.abs=dr,E.angle=function(n){return In(nr,n,!0)},E.norm=yr,E.zeros=function(n,r){return wr(E.fix(n),y(r)?E.fix(r):r)},E.ones=function(n,r){return n=E.fix(n),r=y(r)?E.fix(r):r,w(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),$)},E.eye=function(n){return br(E.fix(n),$)},E.rand=function(n,r){return n=E.fix(n),r=y(r)?E.fix(r):r,null==n?B(k.random()):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),function(){return B(k.random())}))},E.randi=function(n,r,t){return e=E.fix(n),n=E.fix(r),r=y(t)?E.fix(t):t,e=v(e),null==n&&null==r?B(k.ceil(k.random()*e)):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),function(){return B(k.ceil(k.random()*e))}));var e},E.randn=function(n,r){return n=E.fix(n),r=y(r)?E.fix(r):r,null==n?B(hr()):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),A(v(n),v(r),function(){return B(hr())}))},E.magic=function(n){var t;return n=p(n=Sn(E.fix(n),!0))?v(n):null,!p(n)||n<=2?1===n?[[$]]:[]:(t=function n(e){var t,i,r,u,f,o,l,c=1&e,a=0==(3&e),s=e*e,h=e-c>>1;if(c)return A(e,e,function(n,r){var t=(n+1+r+1+(e-3)/2)%e;return t<0&&(t+=e),(n=(n+1+2*(r+1)-2)%e)<0&&(n+=e),e*t+n+1});if(a)return i=0,A(e,e,function(n,r){return++i,(n+1&3)>>1==(r+1&3)>>1?s-(i-1):i});if(t=h*h,o=n(h),l=A(e,e,function(n,r){return n<h?r<h?o[n][r]:o[n][r-h]+2*t:r<h?n<h?o[n][r]:o[n-h][r]+3*t:o[n-h][r-h]+t}),1<(i=(h-1)/2))for(r=1;r<=h;++r){for(u=2;u<=i;++u)f=l[r-1][u-1],l[r-1][u-1]=l[r+h-1][u-1],l[r+h-1][u-1]=f;for(u=e-i+2;u<=e;++u)f=l[r-1][u-1],l[r-1][u-1]=l[r+h-1][u-1],l[r+h-1][u-1]=f}for(r=1;r<=i;++r)f=l[r-1][0],l[r-1][0]=l[r+h-1][0],l[r+h-1][0]=f;for(r=i+2;r<=h;++r)f=l[r-1][0],l[r-1][0]=l[r+h-1][0],l[r+h-1][0]=f;return f=l[i][i-1],l[i][i-1]=l[i+h][i-1],l[i+h][i-1]=f,l}(n),A(n,n,function(n,r){return B(t[n][r])}))},E.pascal=function(n){var t,r;return 1<arguments.length&&d("pascal"),n=p(n=E.fix(Sn(n,!0)))?v(n):null,!p(n)||n<=0?[]:(t=A(r=n,r,function(n,r,t){return 0===n||0===r?1:t[n-1][r]+t[n][r-1]}),A(n,n,function(n,r){return B(t[n][r])}))},E.rosser=function(){return[[B(611),B(196),B(-192),B(407),B(-8),B(-52),B(-49),B(29)],[B(196),B(899),B(113),B(-192),B(-71),B(-43),B(-8),B(-44)],[B(-192),B(113),B(899),B(196),B(61),B(49),B(8),B(52)],[B(407),B(-192),B(196),B(611),B(8),B(44),B(59),B(-23)],[B(-8),B(-71),B(61),B(8),B(411),B(-599),B(208),B(208)],[B(-52),B(-43),B(49),B(44),B(-599),B(411),B(208),B(208)],[B(-49),B(-8),B(8),B(59),B(208),B(208),B(99),B(-911)],[B(29),B(-44),B(52),B(-23),B(208),B(208),B(-911),B(99)]]},E.vander=function(n){return w(n=q(n))||d("vander"),n.map(function(t){return F(n.length,function(n,r){return 0===n?$:K(r[n-1],t)}).reverse()})},E.toeplitz=function(t,e){return 1===arguments.length?A((e=q(t)).length,e.length,function(n,r){return n===r?e[0]:n<r?e[k.abs(n-r)]:Jn(e[k.abs(n-r)])}):(t=q(t),e=q(e),A(t.length,e.length,function(n,r){return n===r?t[0]:(n<r?e:t)[k.abs(n-r)]}))},E.hankel=function(t,e){var i,n;return 1===arguments.length?(t=q(t),A(i=t.length,i,function(n,r){return i-1-n<r?O:t[(n+r)%i]})):(t=q(t),e=q(e),i=t.length,A(n=e.length,n,function(n,r){return i<=n+r-1?e[n+r-i]:t[(n+r)%i]}))},E.hadamard=function(n){return function n(r){return 1===r?[[$]]:2===r?[[$,$],[$,Z]]:4===r?[[$,$,$,$],[$,Z,$,Z],[$,$,Z,Z],[$,Z,Z,$]]:0==r%4&&(r=n(r/2)).length?Xr([[$,$],[$,Z]],r):[]}(v(n))},E.hilb=function(n){return A(n=v(Sn(n,!0)),n,function(n,r){return B(1/(n+1+r+1-1))})},E.invhilb=function(n){n=v(Sn(n,!0));var r=E.hilb(n);return(n<10?tt:et)(r)},E.linspace=function(n,r,t){t=v(t=null==t?100:t);for(var e=D(G(r,n),t-1),i=new Array(t),u=0,f=n;u<t;++u,f=V(f,e))i[u]=f;return i},E.logspace=function(n,r,t){t=v(t=null==t?100:t);for(var e=zn(D(r,n),1/(t-1)),i=new Array(t),u=0,f=n;u<t;++u,f=K(f,e))i[u]=f;return i},E.meshgrid=En(function(n,r,t){var e=r,i=t;if(null==i&&(i=e),e=q(e),i=q(i),w(e)&&w(i))return[A(i.length,e.length,function(n,r){return e[r]}),A(i.length,e.length,function(n,r){return i[n]})];d("meshgrid")},2),E.ndgrid=En(function(n){var r=n,t=[].slice.call(arguments,1);t=t.map(q);for(var e=[],i=F(r,function(n){return(1===t.length?t[0]:t[n]).length}),u=0;u<r;++u)e.push(wn(i,function(n){return(1===t.length?t[0]:t[u])[n[u]]}));return 1===r?e[0]:e}),E.colon=function(n,r,t){return 1===arguments.length&&S(n)?xn(xr(n)):xr.apply(null,arguments)},E.cat=function(n,r,t){var e,i=[];if(1===(n=v(n)))for(i=r,e=2;e<arguments.length;++e)i=Sr("vert",i,arguments[e]);else if(2===n)for(i=r,e=2;e<arguments.length;++e)i=Sr("horz",i,arguments[e]);return i},E.horzcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Sr("horz",t,arguments[e]);return t},E.vertcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Sr("vert",t,arguments[e]);return t},E.transpose=function(n){return Ar(n=dn(n)?bn(n):n)},E.ctranspose=function(n){return _r(n=dn(n)?bn(n):n)},E.diag=Ir,E.blkdiag=function(){return t=[].slice.call(arguments),a=c=l=o=f=0,t.forEach(function(n,r){vn(n)&&(t[r]=n=[[n]]),dn(n)&&(t[r]=n=Ir(n)),yn(n)||d("blkdiag"),f+=W(n),o+=U(n)}),e=t[l],i=W(e),u=U(e),A(f,o,function(n,r){return c+i<=n&&(c+=i,a+=u,e=t[++l],i=W(e),u=U(e)),r<a||a+u<=r?O:e[n-c][r-a]});var t,e,i,u,f,o,l,c,a},E.tril=function(t,e){if(yn(t))return e=v(e||0),A(W(t),U(t),function(n,r){return r<=n+e?t[n][r]:O});d("tril")},E.triu=function(t,e){if(yn(t))return e=v(e||0),A(W(t),U(t),function(n,r){return n+e<=r?t[n][r]:O});d("triu")},E.repmat=function(t,e,i){return w(e)&&(i=e[1],e=e[0]),null==i&&(i=e),e=v(e),i=v(i),yn(t=dn(t=vn(t)?[[t]]:t)?[t]:t)?A(e*W(t),i*U(t),function(n,r){return t[n%e][r%i]}):t},E.repelem=function(r,t){var e,i;if(w(r))if(w(t)){if(t.length===r.length)return e=0,i=-1,F(v(Mr(t)),function(n){return n===e&&(e+=v(t[++i])),r[i]})}else if(p(t))return t=v(t),i=-1,F(t*r.length,function(n){return 0==n%t&&++i,r[i]});return r},E.reshape=function(t,e,n){w(e)&&(n=e[1],e=e[0]),e=v(e),n=v(n);var i,r=e*n;return vn(t)&&1===e&&1===n?[[t]]:dn(t)&&t.length===r?A(e,n,function(n,r){return t[n+e*r]}):yn(t)&&W(t)*U(t)==r?(i=W(t),A(e,n,function(n,r){n+=e*r;return t[n%i][k.floor(n/i)]})):t},E.squeeze=function(n){return n},E.rot90=function(n,r){var t=n=dn(n)?bn(n):n,n=r;if(yn(t)){var e=W(t),i=U(t);if((n=k.round(v(n=null==n?1:n))%4)<0&&(n+=4),1===n)return A(i,e,function(n,r){return t[r][i-1-n]});if(3===n)return A(i,e,function(n,r){return t[e-1-r][n]});if(2===n)return A(e,i,function(n,r){return t[e-1-n][i-1-r]})}return t},E.flip=kr,E.fliplr=function(n){return kr(n,2)},E.flipud=function(n){return kr(n,1)},E.sort=En(function(n,r,t,e){for(var i=2,u=null;i<arguments.length;){if("ComparisonMethod"===arguments[i]){"real"===arguments[i+1]?u=Er:"abs"===arguments[i+1]&&(u=Nr),1===i?(t=1,e="ascend"):2===i&&(e="ascend");break}i+=1}return null==e&&(e="ascend"),qr(r,t=v(t=null==t?1:t),e,u,1<n)}),E.min=jr,E.max=Pr,E.sum=Mr,E.prod=Rr,E.dot=Tr,E.cross=function(n,r){if(n=q(n),r=q(r),!w(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(w(r)&&3===r.length)return[Gn(K(n[1],r[2]),K(n[2],r[1])),Gn(K(n[2],r[0]),K(n[0],r[2])),Gn(K(n[0],r[1]),K(n[1],r[0]))];throw"cross: input 2 not vector of length 3"},E.kron=Xr,E.diff=function(n,r,t){for(null==t&&(t=1),p(r=null==r?1:r)||d("diff"),r=v(r);0<r--;)n=function r(t,n){if(w(t=q(t)))return 1<t.length?F(t.length-1,function(n){return Gn(t[n+1],t[n])}):[];if(b(t)){if(1===(n=v(n=null==n?1:n)))return F(U(t),function(n){return r(j(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}d("diff")}(n,t);return n},E.trapz=function(n,r,t){return arguments.length<3&&(S(r)?t=1:S(n)&&!S(r)&&(t=r,r=n,n=null)),Zr(S(n)?q(n):n,q(r),t)},E.cumtrapz=function(n,r,t){return arguments.length<3&&(S(r)?t=1:S(n)&&!S(r)&&(t=r,r=n,n=null)),function r(t,e,i){if(y(e))return e;if(w(e)){if(null==t||y(t))return e.map(function(n,r){return Zr(t,e.slice(0,r+1))});if(w(t)&&t.length===e.length)return e.map(function(n,r){return Zr(t.slice(0,r+1),e.slice(0,r+1))})}else if(b(e))if(1===(i=v(i=null==i?1:i))){if(null==t||y(t)||w(t)&&t.length===W(e))return F(U(e),function(n){return r(t,j(e,n),i)});if(b(t)&&W(t)===W(e)&&U(t)===U(e))return F(U(e),function(n){return r(j(t,n),j(e,n),i)})}else if(2===i){if(null==t||y(t)||w(t)&&t.length===U(e))return F(W(e),function(n){return r(t,e[n],i)});if(b(t)&&W(t)===W(e)&&U(t)===U(e))return F(W(e),function(n){return r(t[n],e[n],i)})}d("cumtrapz")}(S(n)?q(n):n,q(r),t)},E.cumsum=function(n,r,t){n=zr(q(n),J,t,r);return!1===n&&d("cumsum"),n},E.cumprod=function(n,r,t){n=zr(q(n),K,t,r);return!1===n&&d("cumprod"),n},E.cummin=function(n,r,t){n=zr(q(n),function(n,r){return Wn(n,r)?n:r},t,r);return!1===n&&d("cummin"),n},E.cummax=function(n,r,t){n=zr(q(n),function(n,r){return Un(n,r)?n:r},t,r);return!1===n&&d("cummax"),n},E.movsum=function(n,r,t){var e,i;return w(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Lr(q(n),Mr,e,i,t))&&d("movsum"),r},E.movprod=function(n,r,t){var e,i;return w(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Lr(q(n),Rr,e,i,t))&&d("movprod"),r},E.movmean=function(n,r,t){var e,i;return w(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Lr(q(n),_t,e,i,t))&&d("movmean"),r},E.movmin=function(n,r,t){var e,i;return w(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Lr(q(n),jr,e,i,t))&&d("movmin"),r},E.movmax=function(n,r,t){var e,i;return w(r)?(e=v(r[0]),i=v(r[1])):p(r)&&(i=1&(r=v(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Lr(q(n),Pr,e,i,t))&&d("movmax"),r},E.bitshift=function(n,r){return In(function(n){return p(n)?Rn(r,O)?v(n)>>-v(r):v(n)<<v(r):n},n,!0)},E.bitand=function t(r,e){if(p(r)){if(p(e))return v(r)&v(e);if(S(e))return e.map(function(n){return t(r,n)})}else if(S(r)){if(p(e))return r.map(function(n){return t(n,e)});if(S(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.bitor=function t(r,e){if(p(r)){if(p(e))return v(r)|v(e);if(S(e))return e.map(function(n){return t(r,n)})}else if(S(r)){if(p(e))return r.map(function(n){return t(n,e)});if(S(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.bitxor=function t(r,e){if(p(r)){if(p(e))return v(r)^v(e);if(S(e))return e.map(function(n){return t(r,n)})}else if(S(r)){if(p(e))return r.map(function(n){return t(n,e)});if(S(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.size=Or,E.length=$r,E.ndims=function(n){return $r(Or(n))},E.numel=function(n){return Rr(Or(n))},E.rows=function(n){return Or(n,1)},E.columns=function(n){return Or(n,2)},E.sub2ind=function(n,r,t){return w(r)&&(t=r[1],r=r[0]),r=v(r),t=v(t),1===n.length?r:r-1+v(n[0])*(t-1)+1},E.ind2sub=function(n,r){return r=v(r),1===n.length?[r,1]:[(r-1)%v(n[0])+1,k.floor((r-1)/v(n[0]))+1]},l.find=Cr,E.find=function(n){return Cr(n,function(n){return!Cn(n,O)})},l.all=Fr,E.all=function(n){return Fr(n,function(n){return!Cn(n,O)})},l.any=Wr,E.any=function(n){return Wr(n,function(n){return!Cn(n,O)})},E.isnan=function n(r){return S(r)?r.map(n):hn(r)||f(r)&&(hn(r.re)||hn(r.im))?1:0},E.isinf=function n(r){return S(r)?r.map(n):C(r)?mn(r)?1:0:f(r)&&(mn(r.re)||mn(r.im))?1:0},E.isfinite=function n(r){return S(r)?r.map(n):C(r)?mn(r)?0:1:!f(r)||mn(r.re)||mn(r.im)?0:1},E.isreal=function(n){return Fr(n,pn)},E.isempty=function(n){return S(n)?S(n[0])?n[0].length?0:1:n.length?0:1:0};var Yr=function(r,n,t,e){var i,u,f,o,l,c,a,s,h,m,g,p,v,d,y=W(r),w=U(r),b=w,x=0;if(e=B(e||0),Dr(r,"upper",!1,e))return n?[r,F(b,function(n){return[n,n]}).filter(function(n){return n[0]<y&&n[1]<w&&!Bn(Yn(r[n[0]][n[1]]),e)}),Rr(Ir(r)),br(y)]:r;for(S(t)&&(b=k.min(b,t[1])),v=Hr(r,br(y)),i=new Array(b),u=$,d=function(n,r){r=r||0;for(var t=x-1;0<=t;--t)if(n===i[t][r])return t;return-1},f=a=0;f<y&&!(b<=a);++f){for(o=f;Bn(Yn(v[o][a]),e);)if(y<=++o&&(o=f,b<=++a)){a=-1;break}if(-1===a)break;for(s=-1,m=null,p=0,o=l=o;o<y;++o)Bn(g=Yn(v[o][a]),e)?++p:null!=m&&!Wn(g,m)||(m=g,s=o);for(;-1!==s;){if(y-l===p+1){for(f!==s&&(Ur(v,f,s),u=Dn(u)),Wn(v[f][a],O)&&(Br(v,f,f,O,Z,a),u=Dn(u)),o=s,l=f;0<=o&&-1!==(c=d(o));)o=l-=x-c;i[x++]=[o,a],u=f<b?K(u,v[f][f]):O;break}for(p=0,h=s,o=l;o<y;++o)o!==h&&(Br(v,o,h,Dn(Y(v[o][a],v[h][a])),$,a),Bn(g=Yn(v[o][a]),e)?++p:Wn(g,m)&&(m=g,s=o))}++a}return x<b&&(u=O),t=Gr(v,0,w,y-1,y+w-1),v=Gr(v,0,0,y-1,w-1),i.length>x&&(i.length=x),n?[v,i,u,t]:v};function nt(n,r,t,e){var i,u,f,o,l,c,a=W(n),s=U(n),h=s;for(e=B(e||0),S(t)&&k.min(h,t[1]),c=Hr((h=Yr(n,!0,t,e))[0],h[3]),i=h[1],n=h[2],u=i.length,o=0;o<u;++o)for(f=i[o][1],l=0;l<o;++l)Bn(Yn(c[l][f]),e)||(Br(c,l,o,Dn(c[l][f]),c[o][f]),Cn(c[l][i[l][1]],$))||Br(c,l,l,O,Kn(c[l][i[l][1]]),i[l][1]);return Cn(c[u-1][i[u-1][1]],$)||Br(c,u-1,u-1,O,Kn(c[u-1][i[u-1][1]]),i[u-1][1]),t=Gr(c,0,s,a-1,a+s-1),c=Gr(c,0,0,a-1,s-1),r?[c,i,n,t]:c}function rt(n,r,t){if(y(n)&&y(r))return Y(r,n);if(!b(n))return[];if(!w(r=q(r))&&!b(r))return[];var e,i=U(n);if(W(n)!==i)return[];if(e=w(r)?(h=r.length,1):(h=W(r),U(r)),i!==h)return[];var u,f,o,l,c,a,s,h=Yr(Ar(n),!0);if(h[1].length!==i)return[];if(u=Ar(h[3]),f=Ar(h[0]),w(r)){for(o=F(i,O),l=0;l<i;++l){if(Cn(f[l][l],O))return[];for(s=O,c=0;c<l;++c)s=J(s,K(f[l][c],o[c]));o[l]=Y(Gn(r[l],s),f[l][l])}return F(i,function(r){return F(i,function(n){return K(o[n],u[r][n])}).reduce(J,O)})}for(o=wr(i,e),l=0;l<i;++l){if(Cn(f[l][l],O))return[];for(a=0;a<e;++a){for(s=O,c=0;c<l;++c)s=J(s,K(f[l][c],o[c][a]));o[l][a]=Y(Gn(r[l][a],s),f[l][l])}}return A(i,e,function(r,t){return F(i,function(n){return K(o[n][t],u[r][n])}).reduce(J,O)})}function tt(n){var r,t,e;return y(n)?Kn(n):b(n)&&W(n)===U(n)?1===(t=r=W(n))?[[Kn(n[0][0])]]:Cn((e=nt(n,!0))[0][r-1][t-1],O)?[]:e[3].map(function(n,r){return n.map(function(n){return Y(n,e[0][r][r])})}):[]}function et(n){if(W(n)!==U(n))return[];for(var r=br(W(n)),t=r,e=tr(r,n),i=0;i<4;++i)t=P(t,rr(r,e)),i+1<4&&(e=P(e,e));return t}function it(n,r){var t,e,i=W(n),u=U(n);return r=r||nt(n,!0),e=(t=r[1]).length,[Gr(n,F(i,function(n){return n}),F(e,function(n){return t[n][1]})),Gr(r[0],0,0,e-1,u-1).map(function(t,e){return t.map(function(n,r){for(r=e;r+1<u&&Cn(t[r],O);)++r;return Y(n,t[r])})})]}function ut(t,n){var r,e,i,u,f;return y(t)?Kn(t):b(t)?(r=W(t),i=U(t),function t(n,e){return y(e)?y(n)?Cn(n,e):n.filter(function(n){return t(n,e)}).length===n.length:!!S(e)&&(y(n)?t(e,n):n.length===e.length&&n.filter(function(n,r){return t(n,e[r])}).length===e.length)}(t,0)?Ar(t):1===r&&1===i?[[Kn(t[0][0])]]:1===r||1===i?(f=t.reduce(function(n,r){return J(n,K(r,Jn(r)))},O),A(i,r,function(n,r){return Y(Jn(t[r][n]),f)})):(n=(e=nt(t,!0,null,n||0))[1].length)===i?r===i?e[3].map(function(n,r){return n.map(function(n){return Y(n,e[0][r][r])})}):P(tt(P(u=_r(t),t)),u):n===r?P(u=_r(t),tt(P(t,u))):(i=it(t,e),f=P(tt(P(u=_r(f=i[0]),f)),u),n=P(u=_r(n=i[1]),tt(P(n,u))),P(n,f))):[]}function ft(e){return y(e)?e:b(e)?e.reduce(function(n,r,t){return J(n,t<r.length?e[t][t]:0)},0):void d("trace")}function ot(e,n,r){r=B(r||0);var t=W(e);return t!==U(e)?0:1===t?e[0][0]:Dr(e,"lower",!0,r)||Dr(e,"upper",!0,r)?e.reduce(function(n,r,t){return K(n,e[t][t])},1):!0===n?function n(r,t){var e,i,u,f,o,l,c,a,s,h,m,g,p,v;function d(t,n,e,i){return A(n-1,n-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})}if(1===t)o=r[0][0];else if(2===t)l=r[0][0],c=r[0][1],a=r[1][0],o=Gn(K(l,s=r[1][1]),K(c,a));else if(3===t)l=r[0][0],c=r[0][1],a=r[0][2],s=r[1][0],h=r[1][1],m=r[1][2],g=r[2][0],p=r[2][1],v=r[2][2],o=Gn(Gn(Gn(J(J(K(K(l,h),v),K(K(c,m),g)),K(K(a,s),p)),K(K(a,h),g)),K(K(c,s),v)),K(K(l,m),p));else{for(e=u=i=0;e<t;++e)Cn(r[0][e],O)&&++i,Cn(r[e][0],O)&&++u;if(f=$,o=O,i<u)for(e=0;e<t;++e)Cn(r[e][0],O)||(o=J(o,K(r[e][0],K(f,n(d(r,t,e,0),t-1))))),f=$===f?Z:$;else for(e=0;e<t;++e)Cn(r[0][e],O)||(o=J(o,K(r[0][e],K(f,n(d(r,t,0,e),t-1))))),f=$===f?Z:$}return o}(e,t):Yr(e,!0,null,r)[2]}function lt(n){b(n)&&W(n)===U(n)||d("charpoly");var e,r=W(n),i=(U(n),r),u=new Array(i+1),t=wr(i,i);for(u[i]=$,e=1;e<=i;++e)t=P(n,t).map(function(n,t){return n.map(function(n,r){return t===r?J(n,u[i-e+1]):n})}),u[i-e]=Y(ft(P(n,t)),-e);return Pn(u.reverse())}function ct(f){return A(U(f),W(f),function(n,r){return e=r,i=n,r=!0,n=W(t=f),u=U(t),n!==u?null:n<=1?0:(i=+(i||0),(e=+(e||0))<0||n<=e||i<0||u<=i?null:(n=ot(A(n-1,u-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})),!0===r&&e+i&1?Dn(n):n));var t,e,i,u})}function at(n,r,t){null==r&&(r=2);for(var e,i,u,f,o,l,c=W(n),a=_n(n),s=t?F(c,$):null,h=B(1e-10),m=1;m<=1e4;++m){for(e=l=0;e<c;++e)if((f=j(a,e).map(B)).splice(e,1),(o=a[e].map(B)).splice(e,1),f=yr(f,r),Q(o=yr(o,r),O)||Q(f,O))++l;else{for(u=L.sqrt(D(o,f)),Xn(L.abs(G(u,$)),h)&&++l,t&&(s[e]=H(u,s[e])),i=0;i<c;++i)a[i][e]=K(a[i][e],u);for(i=0;i<c;++i)a[e][i]=Y(a[e][i],u)}if(c===l)break}return t?[s,a]:a}function st(n,r,t){var e=W(n);if(null==r){var i,u,f=t?br(e):null,o=n;for(l=1;l<=e-2;++l)for(c=e;l+2<=c;--c)u=[Jn((i=Jr(o[c-1-1][l-1],o[c-1][l-1]))[0]),Dn(Jn(i[1]))],t&&(f=Kr("right",i,c-1-1,c-1,f)),o=Kr("left",u,c-1-1,c-1,Kr("right",i,c-1-1,c-1,o));return t?[f,o]:o}var l,c,a,s,h=_r(f=qr_givens(r,!0)[0]),m=br(e),g=P(h,n),p=P(h,r);for(l=1;l<=e-2;++l)for(c=e;l+2<=c;--c)a=[Jn((s=Jr(g[c-1-1][l-1],g[c-1][l-1]))[0]),Dn(Jn(s[1]))],f=Kr("right",s,c-1-1,c-1,f),g=Kr("left",a,c-1-1,c-1,g),p=Kr("left",a,c-1-1,c-1,p),m=Kr("right",s=Jr(Dn(p[c-1][c-1]),p[c-1][c-1-1]),c-1-1,c-1,m),g=Kr("right",s,c-1-1,c-1,g),p=Kr("right",s,c-1-1,c-1,p);return[g,p,f,m]}function ht(n,r){for(var t,e,i,u=W(n),f=(U(n),"upper"===r),o=wr(u,u),l=br(u),c=0;c<u;++c){for(t=0;t<c;++t){for(e=0,i=O;e<t;++e)i=J(i,K(K(l[c][e],Jn(l[t][e])),o[e][e]));l[c][t]=Y(Gn(f?n[t][c]:n[c][t],i),o[t][t])}for(e=0,i=O;e<c;++e)i=J(i,K(K(l[c][e],Jn(l[c][e])),o[e][e]));if(o[c][c]=Gn(n[c][c],i),Bn(o[c][c],O))return[]}return[l,o]}function mt(n,r,t){var e,i,u,f,o,l,c,a,s,h=W(n),m=U(n),g=r?br(h):null,p=n;if(t)for(e=F(m,function(n){return n}),f=F(m,function(n){return yr(j(p,n),rn)}),c=0;c<m;++c){for(o=f[i=c],l=c+1;l<m;++l)Tn(f[l],o)&&(o=f[i=l]);if(Q(o,O))break;if(c!==i)for(u=f[c],f[c]=f[i],f[i]=u,u=e[c],e[c]=e[i],e[i]=u,l=0;l<h;++l)u=p[l][c],p[l][c]=p[l][i],p[l][i]=u;for(l=h-1;c+1<=l;--l)s=[Jn((a=Jr(p[l-1][c],p[l][c]))[0]),Dn(Jn(a[1]))],p=Kr("left",s,l-1,l,p),r&&(g=Kr("right",a,l-1,l,g));for(l=c+1;l<m;++l)f[l]=G(f[l],zn(Yn(p[c][l]),rn))}else for(c=0;c<m;++c)for(l=h-1;c+1<=l;--l)s=[Jn((a=Jr(p[l-1][c],p[l][c]))[0]),Dn(Jn(a[1]))],p=Kr("left",s,l-1,l,p),r&&(g=Kr("right",a,l-1,l,g));return r&&t?[g,p,A(m,m,function(n,r){return n===e[r]?$:O})]:r?[g,p]:p}function gt(n){var r,t,e,i,u=B(1e-10),f=W(n),o=new Array(f),l=new Array(f),c=F(f,0);for(n=_n(n),i=0;i<f;++i)r=(e=function(n,r,t,e){var i,u,f,o,l,c,a=O;if(!0===e){for(o=ir(o=F(r,function(){return new I(B(k.random()||.1),O)}),yr(o)),i=1;i<=100&&(f=a,a=Tr(o=q(P(n,l=o)),l),o=ir(o,o[0].sign()),o=ir(o,yr(o)),!Xn(L.abs(G(gr(a),gr(f))),t)||!Xn(L.abs(G(pr(a),pr(f))),t));++i);return a}for(u=_r(n),o=ir(o=F(r,function(){return new I(B(k.random()||.1),O)}),yr(o)),c=ir(c=F(r,function(){return new I(B(k.random()||.1),O)}),yr(c)),i=1;i<=100&&(f=a,o=q(P(n,l=o)),c=q(P(u,c)),a=Tr(o,l),o=ir(o,o[0].sign()),c=ir(c,c[0].sign()),o=ir(o,yr(o)),c=ir(c,yr(c)),!Xn(L.abs(G(gr(a),gr(f))),t)||!Xn(L.abs(G(pr(a),pr(f))),t));++i);return[a,o,c]}(n,f,u))[0],t=e[1],e=e[2],n=tr(n,P(P(Y(c[i]=r,Tr(o[i]=t,l[i]=e,!0)),t),e));return[Pn(Ar(o)),Pn(c),Pn(Ar(l))]}function pt(n,r,t,e){r=B(r=C(r)?r:nn);var i,u=U(n),f=W(n);if(f<u)return i=pt(Ar(n),r,e,t),t&&e?[Ar(i[2]),i[1],Ar(i[0])]:t||e?[Ar(i[0]),i[1]]:i;var o,l,c,a,s,h,m,g,p,v,d,y,w,b,x,S,A,_,I,Z,k,E=t?f:0,N=e?u:0,q=_n(n),j=E?wr(f,E):null,P=F(u,O),M=N?wr(u,N):null,z=D(ln.realmin,r),R=new Array(u),T=new Array(u),X=new Array(u);for(T[0]=O,b=1;b<=u;++b){for(A=b+1,c=O,y=b;y<=f;++y)c=V(c,V(zn(gr(q[y-1][b-1]),rn),zn(pr(q[y-1][b-1]),rn)));if(R[b-1]=O,Tn(c,z)&&(c=L.sqrt(c),R[b-1]=c,s=Q(a=Yn(q[b-1][b-1]),O)?$:Y(q[b-1][b-1],a),q[b-1][b-1]=K(s,V(c,a)),b!==u+0)){for(w=A;w<=u+0;++w){for(s=O,y=b;y<=f;++y)s=J(s,K(Jn(q[y-1][b-1]),q[y-1][w-1]));for(s=Y(s,H(c,V(c,a))),y=b;y<=f;++y)q[y-1][w-1]=Gn(q[y-1][w-1],K(s,q[y-1][b-1]))}for(s=Dn(Vn(Jn(q[b-1][b-1]))),w=A;w<=u+0;++w)q[b-1][w-1]=K(s,q[b-1][w-1])}if(b===u)break;for(c=O,w=A;w<=u;++w)c=V(c,V(zn(gr(q[b-1][w-1]),rn),zn(pr(q[b-1][w-1]),rn)));if(T[A-1]=O,Tn(c,z)){for(c=L.sqrt(c),T[A-1]=c,s=Q(a=Yn(q[b-1][A-1]),O)?$:Y(q[b-1][A-1],a),q[b-1][A-1]=K(s,V(c,a)),y=A;y<=f;++y){for(s=O,w=A;w<=u;++w)s=J(s,K(Jn(q[b-1][w-1]),q[y-1][w-1]));for(s=Y(s,H(c,V(c,a))),w=A;w<=u;++w)q[y-1][w-1]=Gn(q[y-1][w-1],K(s,q[b-1][w-1]))}for(s=Dn(Vn(Jn(q[b-1][A-1]))),y=A;y<=f;++y)q[y-1][A-1]=K(q[y-1][A-1],s)}}for(h=O,b=1;b<=u;++b)P[b-1]=R[b-1],X[b-1]=T[b-1],h=Pr([h,V(P[b-1],X[b-1])]);if(h=H(r,h),0<E)for(w=1;w<=E;++w)j[w-1][w-1]=$;if(0<N)for(w=1;w<=N;++w)M[w-1][w-1]=$;for(S=1;S<=u;++S){for(b=u+1-S,Z=1;Z<=50;++Z){for(k=!0,I=1;I<=b;++I){if(Xn(L.abs(X[(x=b+1-I)-1]),h)){k=!1;break}if(Xn(L.abs(P[x-1-1]),h)){k=!0;break}}if(k)for(d=O,v=$,_=x-1,y=x;y<=b&&(g=H(v,X[y-1]),X[y-1]=H(d,X[y-1]),!Xn(L.abs(g),h));++b)if(a=ar(g,p=P[y-1]),d=D(p,P[y-1]=a),v=On(D(g,a)),0<E)for(w=1;w<=u;++w)o=gr(j[w-1][_-1]),l=gr(j[w-1][y-1]),j[w-1][_-1]=V(H(o,d),H(l,v)),j[w-1][y-1]=G(H(l,d),H(o,v));if(a=P[b-1],x===b)break;for(o=P[x-1],l=P[b-1-1],m=X[b-1-1],p=X[b-1],m=ar(g=D(V(H(G(l,a),V(l,a)),H(G(m,p),V(m,p))),H(rn,H(p,l))),$),Rn(g,O)&&(m=On(m)),g=D(V(H(G(o,a),V(o,a)),H(G(D(l,V(g,m)),p),p)),o),v=d=$,y=_=x+1;_<=b;++_){if(m=X[y-1],l=P[y-1],p=H(v,m),m=H(d,m),a=ar(p,g),d=D(g,X[y-1-1]=a),v=D(p,a),g=V(H(o,d),H(m,v)),m=G(H(m,d),H(o,v)),p=H(l,v),l=H(l,d),0<N)for(w=1;w<=u;++w)o=gr(M[w-1][y-1-1]),a=gr(M[w-1][y-1]),M[w-1][y-1-1]=V(H(o,d),H(a,v)),M[w-1][y-1]=G(H(a,d),H(o,v));if(a=ar(p,g),d=D(g,P[y-1-1]=a),v=D(p,a),g=V(H(d,m),H(v,l)),o=G(H(d,l),H(v,m)),0<E)for(w=1;w<=u;++w)l=gr(j[w-1][y-1-1]),a=gr(j[w-1][y-1]),j[w-1][y-1-1]=V(H(l,d),H(a,v)),j[w-1][y-1]=G(H(a,d),H(l,v))}X[x-1]=O,X[b-1]=g,P[b-1]=o}if(Rn(a,O)&&(P[b-1]=On(a),0<N))for(w=1;w<=u;++w)M[w-1][b-1]=Dn(M[w-1][b-1])}for(b=1;b<=u;++b){for(m=-1,y=w=b;y<=u;++y)Tn(P[y-1],m)&&(m=P[y-1],w=y);if(w!==b){if(P[w-1]=P[b-1],P[b-1]=m,0<N)for(y=1;y<=u;++y)s=M[y-1][w-1],M[y-1][w-1]=M[y-1][b-1],M[y-1][b-1]=s;if(0<E)for(y=1;y<=u;++y)s=j[y-1][w-1],j[y-1][w-1]=j[y-1][b-1],j[y-1][b-1]=s}}if(0<E)for(S=1;S<=u;++S)if(!Q(R[(b=u+1-S)-1],O)){for(s=Dn(Vn(q[b-1][b-1])),w=1;w<=E;++w)j[b-1][w-1]=K(s,j[b-1][w-1]);for(w=1;w<=E;++w){for(s=O,y=b;y<=f;++y)s=J(s,K(Jn(q[y-1][b-1]),j[y-1][w-1]));for(s=Y(s,K(Yn(q[b-1][b-1]),R[b-1])),y=b;y<=f;++y)j[y-1][w-1]=Gn(j[y-1][w-1],K(s,q[y-1][b-1]))}}if(0<N&&2<=u)for(S=2;S<=u;++S)if(!Q(T[(A=(b=u+1-S)+1)-1],O)){for(s=Dn(Vn(Jn(q[b-1][A-1]))),w=1;w<=N;++w)M[A-1][w-1]=K(s,M[A-1][w-1]);for(w=1;w<=N;++w){for(s=O,y=A;y<=u;++y)s=J(s,K(q[b-1][y-1],M[y-1][w-1]));for(s=Y(s,K(Yn(q[b-1][A-1]),T[A-1])),y=A;y<=u;++y)M[y-1][w-1]=Gn(M[y-1][w-1],K(s,Jn(q[b-1][y-1])))}}return t&&e?[Pn(j),P,Pn(M)]:t||e?[Pn(j||M),P]:P}E.planerot=En(function(n,r){w(r=q(r))&&2===r.length||d("planerot");var t=Jr(r[0],r[1]),t=[[t[0],t[1]],[Dn(t[1]),t[0]]];return 1<n?[t,P(t,xn(r))]:t}),E.ref=En(function(n,r,t){b(r=y(r)?[[r]]:r)||d("ref");r=Yr(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),E.rref=En(function(n,r,t){b(r=y(r)?[[r]]:r)||d("rref");r=nt(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),E.linsolve=rt,E.null=function(n,r){return r=r,i=U(t=n),u=(t=nt(n,!0,null,r))[0],f=t[1],o=f.length,r=f.reduce(function(n,r){for(var t=0;t<n.length&&r[1]>n[t];)++t;return t<n.length&&r[1]===n[t]&&n.splice(t,1),n},F(i,function(n){return n})),l=o?f.reduce(function(n,r,t){return K(n,u[t][r[1]])},$):$,r.map(function(r){for(var n,t=F(i,function(n){return n===r?l:O}),e=0;e<o;++e)(n=f[e][1])<=r&&(t[n]=Gn(t[n],K(Y(l,u[e][n]),u[e][r])));return t});var t,i,u,f,o,l},E.rowspace=function(n,r){return Yr(t=n,!0,null,r)[1].map(function(n){return t[n[0]]});var t},E.colspace=function(n,r){return Yr(t=n,!0,null,r)[1].map(function(r){return F(t.length,function(n){return t[n][r[1]]})});var t},E.rank=function(n){return b(n=y(n)?[[n]]:n)||d("rank"),Yr(n,!0)[1].length},E.inv=function(n){return y(n)&&(x=[[n]]),b(n)||d("inv"),tt(n)},E.ainv=function(n){return y(n)&&(x=[[n]]),b(n)||d("ainv"),et(n)},E.rankf=function(n){return b(n=y(n)?[[n]]:n)||d("rankf"),it(n)},E.pinv=function(n,r){return b(n=y(n)?[[n]]:n)||d("pinv"),ut(n,r)},E.cond=function(n,r){b(n=y(n)?[[n]]:n)||d("cond");var t=tt(n);return t&&t.length?K(yr(n,r=null==r?2:r),yr(t,r)):a},E.trace=ft,E.det=function(n){return b(n=y(n)?[[n]]:n)||d("det"),ot(n,!1,1e-15)},E.charpoly=lt,E.adjoint=function(n){return b(n)&&W(n)===U(n)||d("adjoint"),ct(n)},E.balance=En(function(n,r,t){b(r=y(r)?[[r]]:r)&&W(r)===U(r)||d("balance");var e=at(r,2,1<n);return 2<n?[e[0],F(W(r),function(n){return n+1}),e[1]]:1<n?[Ir(e[0]),e[1]]:e}),E.hess=En(function(n,r,t){return b(r=y(r)?[[r]]:r)&&W(r)===U(r)||d("hess"),2<arguments.legnth?(b(t=y(t)?[[t]]:t)&&W(t)===U(t)||d("hess"),st(r,t)):st(r,null,1<n)}),E.ldl=En(function(n,r,t){b(r=y(r)?[[r]]:r)&&W(r)===U(r)||d("ldl");t=ht(r,t);return t.length||d("ldl"),2<n&&t.push(br(W(r))),t},2),E.chol=En(function(n,r,t){b(r=y(r)?[[r]]:r)&&W(r)===U(r)||d("chol");r=ht(r,t=t||"upper");return r.length||d("chol"),"lower"===t?P(r[0],E.sqrt(r[1])):_r(P(r[0],E.sqrt(r[1])))}),E.lu=En(function(n,r){b(r=y(r)?[[r]]:r)||d("lu");var t,r=function(n,r){var t,e,i,u,f,o,l,c,a,s,h,m,g,p,v;for(r=B(r||0),t=W(n),e=U(n),v=!1,f=_n(n),u=br(t),o=F(t,O),i=br(t),l=$,c=0;c<t-1;++c){if(Bn(Yn(f[c][c]),r)){for(h=c+1,m=!0;h<t&&m;)Bn(Yn(f[h][c]),r)?++h:m=!1;if(t<=h){v=!0;break}Ur(f,c,h),Ur(i,c,h)}for(g=f[c][c],u[c][c]=g,o[c]=K(l,g),a=c+1;a<t;++a){for(p=f[a][c],u[a][c]=p,s=c+1;s<e;++s)f[a][s]=Y(Gn(K(g,f[a][s]),K(f[c][s],p)),l);f[a][c]=O}l=f[c][c]}return v?[]:(o[t-1]=l,[o,u,f,i])}(r);if(r.length)return t=Ir(r[0].map(Kn)),2<n?[P(r[1],t),r[2],r[3]]:[P(Ar(r[3]),P(r[1],t)),r[2]];throw"lu: defficient matrix"},2),E.qr=En(function(n,r){return b(r=y(r)?[[r]]:r)||d("qr"),mt(r,1<n,2<n)}),E.schur=En(function(n,r){b(r=y(r)?[[r]]:r)&&W(r)===U(r)||d("schur");var t,e,i,u,f,o=1<n,l=W(r),c=B(1e-8),a=st(r,null,o);for(o&&(t=a[0],a=a[1]),i=l-1;0<i;--i)for(f=1;f<=100&&(a=rr(P((e=mt(tr(a,u=br(l,a[i][i])),null,!0))[1],e[0]),u),o&&(t=P(t,e[0])),!Xn(Yn(a[i][i-1]),c));++f);return o?[t,a]:a}),E.eig=En(function(n,r,t){b(r)&&W(r)===U(r)||d("eig"),b(t)&&d("eig");var e=null;return"nobalance"!==t&&(e=at(r,2,!0),r=e[1],e=e[0]),1<n?(t=gt(r),[e?P(Ir(e),t[0]):t[0],Ir(t[1]),e?P(Ir(e.map($n)),t[2]):t[2]]):Pn((Dr(r,"upper",!0,1e-15)||Dr(r,"lower",!0,1e-15)?F(W(r),function(n){return r[n][n]}):$t(lt(r))).sort(function(n,r){return Yn(r)-Yn(n)}))}),E.svd=En(function(n,r,t){return b(r=y(r)?[[r]]:r)||d("svd"),1<n?[(n=pt(r,t,1<n,2<n))[0],Ir(n[1]),n[2]]:pt(r,t,!1,!1)});var vt=function(n,r,t){for(var e,i,u,f,o,l,c,a=W(n),s=U(n),h=s,m=O,g=t?Hr(n,br(a)):n,p=0,v=0;v<a&&!(h<=p);++v){for(e=v;Bn(Yn(g[e][p]),m);)if(a<=++e&&(e=v,h<=++p)){p=-1;break}if(-1===p)break;for(u=-1,o=null,c=0,e=i=e;e<a;++e)Bn(l=Yn(g[e][p]),m)?++c:null!=o&&!Wn(l,o)||(o=l,u=e);for(;-1!==u;){if(a-i===c+1){if(v!==u&&Ur(g,v,u),Wn(g[v][p],O)&&Br(g,v,v,O,Z,p),r)for(l=g[v][p],e=0;e<v;++e)Qn(Yn(g[e][p]),l)&&Br(g,e,v,Dn(E.floor(Y(g[e][p],l))),$,p),Wn(g[e][p],O)&&Br(g,e,v,$,$,p);e=u,i=v;break}for(c=0,f=u,e=i;e<a;++e)e!==f&&(Br(g,e,f,Dn(E.floor(Y(g[e][p],g[f][p]))),$,p),Bn(l=Yn(g[e][p]),m)?++c:Wn(l,o)&&(o=l,u=e))}++p}return t?[Gr(g,0,s,a-1,a+s-1),Gr(g,0,0,a-1,s-1)]:g};E.hermiteForm=En(function(n,r){return b(r=y(r)?[[r]]:r)||d("hermiteForm"),vt(E.round(E.real(r)),!0,1<n)}),E.smithForm=En(function(n,r){b(r=y(r)?[[r]]:r)||d("smithForm");r=function(n,r,t){var e,i,u,f,o,l,c,a,s,h,m,g,p,v,d,y,w,b,x,S=W(n),A=U(n),_=k.min(S,A);for(r&&(e=br(S)),t&&(i=br(A)),u=-1,f=0;f<S;++f){for(s=!1,o=u+1;o<A;++o){for(m=0;m<S&&Q(n[m][o],O);++m);if(m<S){s=!0;break}}if(!s)break;if(Q(n[f][o],O)){for(c=0;c<S&&Q(n[c][o],O);++c);Qr(n,f,c,O,$,$,O),r&&Vr(e,f,c,O,$,$,O)}for(Vr(n,o,f,O,$,$,O),t&&Qr(i,o,f,O,$,$,O),o=f,l=!0;l;){for(l=!1,c=f+1;c<S;++c)Q(n[c][o],O)||(l=!0,Q(O,Ln(n[c][o],n[f][o]))||(p=(g=Ut([n[f][o],n[c][o]]))[1],v=g[2],d=D(n[c][o],g[0]),y=D(n[f][o],g[0]),Qr(n,f,c,p,v,On(d),y),r&&Vr(e,f,c,y,On(v),d,p)),w=D(n[c][o],n[f][o]),Qr(n,f,c,$,O,On(w),$),r&&Vr(e,f,c,$,O,w,$));for(a=o+1;a<A;++a)Q(n[f][a],O)||(l=!0,Q(O,Ln(n[f][a],n[f][o]))||(p=(g=Ut([n[f][o],n[f][a]]))[1],v=g[2],d=D(n[f][a],g[0]),y=D(n[f][o],g[0]),Vr(n,o,a,p,On(d),v,y),t&&Qr(i,o,a,y,d,On(v),p)),w=D(n[f][a],n[f][o]),Vr(n,o,a,$,On(w),O,$),t&&Qr(i,o,a,$,w,O,$))}u=o}for(h=0;h<_;++h)for(m=h-1;0<=m;--m)Q((g=Ut([n[m][m],n[h][h]]))[0],O)||(p=g[1],v=g[2],d=D(n[h][h],g[0]),y=D(n[m][m],g[0]),b=H(v,d),x=G($,H(p,y)),Qr(n,m,h,$,v,d,G(b,$)),r&&Vr(e,m,h,G($,b),v,d,Z),Vr(n,m,h,p,x,$,On(y)),t&&Qr(i,m,h,y,x,$,On(p)));return r&&t?[n,e,i]:r?[n,e]:t?[n,i]:n}(E.round(E.real(r)),1<n,1<n);return 1<n?[r[1],r[2],r[0]]:r});var dt=.254829592,yt=-.284496736,wt=1.421413741,bt=-1.453152027,xt=1.061405429,St=.3275911;function At(n){n=gr(n);var r,t=L.sign(n)||1;return t<0&&(n=On(n)),r=$n(V(H(St,n),$)),H(t,G($,H(V(H(V(H(V(H(V(H(xt,r),bt),r),wt),r),yt),r),dt),H(r,L.exp(On(H(n,n)))))))}function _t(r,n){if(y(r))return r;if(w(r))return r.length?Y(Mr(r),B(r.length)):s;if(b(r)){if(1===(n=v(n=null==n?1:n)))return F(U(r),function(n){return _t(j(r,n))});if(2===n)return F(W(r),function(n){return _t(r[n])})}d("mean")}function It(r,n,t){if(n=v(n||0),y(r))return O;if(w(r))return 0===r.length?s:1===r.length?O:L.sqrt(Y(Mr(ur(dr(tr(r,_t(r))),B(2))),B(1===n?r.length:r.length-1)));if(b(r)){if(1===(t=v(t=null==t?1:t)))return F(U(r),function(n){return It(j(r,n))});if(2===t)return F(W(r),function(n){return It(r[n])})}d("std")}function kt(n,r){var t,e,i,u,f,o=n.length,l=r.length,c=o+l-1;if(!o||!l)return[];for(f=new Array(c),o<l&&(u=n,o=(n=r).length,l=(r=u).length),t=0;t<c;++t)for(f[t]=O,e=0;e<l;++e)0<=(i=t-e)&&i<o&&(f[t]=J(f[t],K(n[i],r[e])));return f}function Et(n,r,t){var e,i=[],u=n.slice(),f=u.length-r.length,o=r;if(0<=f)for(i=F(f+1,O);0<=f;){for(e=f,r=o.concat(F(f,O)),i[i.length-1-f]=Y(u[0],r[0]),u=Zt(u,zt(r,[Dn(i[i.length-1-f])]));u.length&&Cn(u[0],O);)u.shift();if((f=u.length-o.length)===e)break}return[i,t?F(n.length-u.length,O).concat(u):u]}en.push(function(){dt=B(.254829592),yt=B(-.284496736),wt=B(1.421413741),bt=B(-1.453152027),xt=B(1.061405429),St=B(.3275911)}),E.erf=function(n){return In(At,n,!0)},E.mean=_t,E.median=function r(t,n){if(y(t))return t;if(w(t))return t.length?1&(t=qr(t)).length?t[t.length>>1]:Y(J(t[t.length>>1],t[(t.length>>1)-1]),B(2)):s;if(b(t)){if(1===(n=v(n=null==n?1:n)))return F(U(t),function(n){return r(j(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}d("median")},E.mode=function r(t,n){if(y(t))return t;var e,i;if(w(t))return t.length?(e={},i=0,t.reduce(function(n,r){var t=r.toString(),t=un.call(e,t)?(e[t]+=1,e[t]):e[t]=1;return i<t?(i=t,n=r):t===i&&Wn(r,n)&&(n=r),n},{})):s;if(b(t)){if(1===(n=v(n=null==n?1:n)))return F(U(t),function(n){return r(j(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}d("mode")},E.moment=function r(t,e,n){if(y(t))return O;var i;if(w(t))return t.length<=1?t.length?O:s:(i=t.length,Y(Mr(ur(tr(t,_t(t)),e)),B(i)));if(b(t)){if(1===(n=v(n=null==n?1:n)))return e=B(e),F(U(t),function(n){return r(j(t,n),e)});if(2===n)return e=B(e),F(W(t),function(n){return r(t[n],e)})}d("moment")},E.std=It,E.var=function r(t,e,n){if(e=v(e||0),y(t))return O;var i,u;if(w(t))return t.length<=1?t.length?O:s:(i=t.length,u=_t(t),Y(Mr(er(vr(u=tr(t,u)),u)),B(1===e?i:i-1)));if(b(t)){if(1===(n=v(n=null==n?1:n)))return F(U(t),function(n){return r(j(t,n),e)});if(2===n)return F(W(t),function(n){return r(t[n],e)})}d("var")},E.cov=function e(i,n,u){if(u=v(u||0),2!==arguments.length||0!==v(n)&&1!==v(n)||(u=v(n),n=null),null==n){if(y(i))return O;var r;if(w(i))return i.length<=1?i.length?O:s:(t=i.length,r=_t(i),Y(Mr(er(vr(r=tr(i,r)),r)),B(1===u?t:t-1)));if(b(i))return A(U(i),U(i),function(n,r,t){return n===r?e(j(i,n),u):r<n?t[r][n]:e(j(i,n),j(i,r),u)})}else{if(y(i)&&y(n))return wr(2,2);if(b(i)&&b(n)&&(i=xr(i),n=xr(n)),w(i)&&w(n)){if(i.length!==n.length)throw"cov: inputs not of same dimension";var t;return i.length<=1?i.length?O:s:(t=i.length,Y(Mr(er(vr(tr(i,_t(i))),tr(n,_t(n)))),B(1===u?t:t-1)))}}d("cov")},E.corrcoef=function e(i,r){if(null==r){if(y(i)||w(i))return $;if(b(i))return A(U(i),U(i),function(n,r,t){return n===r?$:r<n?t[r][n]:e(j(i,n),j(i,r))})}else{if(y(i)&&y(r))return $;if(w(i)&&w(r)){if(i.length!==r.length)throw"corrcoef: inputs not of same dimension";var n=i.length;return 1<n?Y(Mr(er(ir(tr(i,_t(i)),It(i)),ir(tr(r,_t(r)),It(r)))),B(n-1)):$}if(b(i)&&b(r)){if(W(i)!==W(r)||U(i)!==U(r))throw"corrcoef: inputs not of same dimension";return F(U(i),function(n){return e(j(i,n),j(r,n))})}}d("corrcoef")},E.conv=function(n,r){return(y(n)||y(r)?er:(n=q(n),r=q(r),w(n)&&w(r)||d("conv"),kt))(n,r)},E.deconv=En(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[ir(r,t),O]:ir(r,t);else{if(r=q(r),t=q(t),w(r)&&w(t)||d("deconv"),!t.length||1===t.length&&Cn(t[0],O))throw"deconv: divisor is zero";e=Et(r,t,!0)}return 1<n?e:e[0]}),E.conv2=function(r,t){if(y(r)||y(t))return er(r,t);if(w(r)){if(w(t))return kt(r,t);if(b(t))return F(U(t),function(n){return kt(r,j(t,n))})}else{if(w(t)){if(w(r))return kt(r,t);if(b(r))return F(r[0].length,function(n){return kt(j(r,n),t)});throw"conv2: input 1 not supported"}if(!b(r))throw"conv2: input 1 not supported";if(b(t)){var n,e,i,u,f,o,l,c,a,s,h,m,g,p=r,v=t;for(W(p)<W(v)&&(g=p,p=v,v=g),n=W(p),e=U(p),f=wr(o=n+(i=W(v))-1,l=e+(u=U(v))-1),a=0;a<o;++a)for(s=0;s<l;++s){for(c=O,h=0;h<=a&&!(n<=h);++h)if(!(i<=a-h))for(m=0;m<=s&&!(e<=m);++m)u<=s-m||(c=J(c,K(p[h][m],v[a-h][s-m])));f[a][s]=c}return f}}throw"conv2: input 2 not supported"},E.filter=function(n,r,t,e,i){n=q(n),r=q(r),t=q(t),w(n)&&w(r)&&w(t)||d("filter");var u,f,o,l,c=n,a=r,s=t,h=s.length,m=a.length,g=c.length,p=new Array(h),v=a[0];for(a=a.map(function(n){return Y(n,v)}),c=c.map(function(n){return Y(n,v)}),u=0;u<h;++u){for(l=O,o=u,f=0;0<=o&&f<g;++f,--o)l=J(l,K(c[f],s[o]));for(o=u-1,f=1;0<=o&&f<m;++f,--o)l=Gn(l,K(a[f],p[o]));p[u]=l}return p};var Nt={},qt={};function jt(n,r){for(var t,e,i=n.length,u={},f=0;f<i;++f)1!==u[f]&&(e=n[t=function(n,r){for(var t=0;1<r;)t=(t<<1)+(1&n),n>>=1,r>>=1;return t}(f,i)],r[t]=n[f],r[f]=e,u[t]=1)}function Pt(n,r,t){var e,i,u=n.length;if(1===u)t[0]=n[0];else{for(e=0;e<u;++e)t[e]=new I(O,O);for(var f,o,l,c,a,s,h=function(n){for(var r=k.sqrt(n),t=3;t<=r;){if(0==n%t)return t;t+=2}return n}(u),m=u/h,g=B(1/k.sqrt(h)),p=new Array(m),v=new Array(m),d=0;d<h;++d){for(e=0;e<m;++e)p[e]=n[e*h+d];for(1<m&&(Tt(p,r,v),i=p,p=v,v=i),f=B(k.cos(2*R*d/u)),o=B((r?-1:1)*k.sin(2*R*d/u)),l=$,c=O,e=0;e<u;++e)a=H(g,p[e%m].re),s=H(g,p[e%m].im),t[e]=t[e].add(new I(G(H(a,l),H(s,c)),V(H(s,l),H(a,c)))),a=G(H(l,f),H(c,o)),s=V(H(l,o),H(c,f)),l=a,c=s}}}var Mt=k.SQRT1_2;function Rt(n,r,t){var e,i,u,f,o,l,c,a,s,h,m,g,p,v,d,y,w,b=n.length,x=1;for(jt(n,t);x<b;){for(e=B((w=void 0,null==(w=qt[y=x])&&(qt[y]=w=k.cos(R/y)),w)),i=B((r?-1:1)*(y=void 0,null==(y=Nt[w=x])&&(Nt[w]=y=k.sin(R/w)),y)),f=b/(2*x),u=0;u<f;++u)for(a=$,s=O,o=0;o<x;++o)g=t[h=2*u*x+o].re,p=t[h].im,l=t[m=h+x].re,c=t[m].im,v=G(H(a,l),H(s,c)),d=V(H(s,l),H(a,c)),t[h]=new I(H(V(g,v),Mt),H(V(p,d),Mt)),t[m]=new I(H(G(g,v),Mt),H(G(p,d),Mt)),l=G(H(a,e),H(s,i)),c=V(H(a,i),H(s,e)),a=l,s=c;x<<=1}}function Tt(n,r,t){var e,i=n.length;if(!(i<=0))return e=!1,null==t&&(t=new Array(i),e=!0),(i&i-1?Pt:Rt)(n,r,t),e?t:void 0}function Xt(n,r,t){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,f,o=!1,l=new Array(e),c=new Array(i),a=new Array(e),s=new Array(i);if(null==t){for(t=new Array(e),u=0;u<e;++u)t[u]=new Array(i);o=!0}for(f=0;f<i;++f,0){for(u=0;u<e;++u)l[u]=n[u][f];for(Tt(l,r,a),u=0;u<e;++u)t[u][f]=a[u]}for(u=0;u<e;++u){for(f=0;f<i;++f,0)c[f]=t[u][f];for(Tt(c,r,s),f=0;f<i;++f,0)t[u][f]=s[f]}return o?t:void 0}}function Zt(n,r){for(var t=n.length-1,e=r.length-1,i=[];0<=t&&0<=e;)i.unshift(J(n[t--],r[e--]));for(;0<=t;)i.unshift(n[t--]);for(;0<=e;)i.unshift(r[e--]);return i}en.push(function(){Mt=B(k.SQRT1_2)}),E.fft=function(r){return b(r=q(r))?F(U(r),function(n){return Pn(Tt(Mn(j(r,n)),!1))}):w(r)?Pn(Tt(Mn(r),!1)):void d("fft")},E.ifft=function(r){return b(r=q(r))?F(U(r),function(n){return Pn(Tt(Mn(j(r,n)),!0))}):w(r)?Pn(Tt(Mn(r),!0)):void d("ifft")},E.fft2=function(n){return b(n)||d("fft2"),Pn(Xt(Mn(n),!1))},E.ifft2=function(n){return b(n)||d("ifft2"),Pn(Xt(Mn(n),!0))};var zt=kt,Lt=Et;function Ot(n,r){if(!n.length)return O;r=r||O;for(var t=n.length,e=0,i=n[0];e+1<t;)++e,i=J(K(i,r),n[e]);return i}function $t(r){if(r.length<=1)return[];var n,t,e,i,u,f,o,l,c,a,s,h,m,g=r.length-1,p=B(1e-10),v=new I(p,O),d=new I(O,O),y=new I($,O);for(r=r.map(B),a=function(n){return Ot(r,n)},s=function(n){return Y(Gn(a(J(n,v)),a(n)),v)},n=r.map(function(n){return I(n).abs()}),f=n.length-1;0<f&&Q(n[f],O);)--f;for(e=V(D(Pr(n.slice(0,f))||O,Pr([n[f],$])),$),t=D(n[0],Pr(V(n[0],Pr(n.slice(1))))),i=F(g,function(){return new I(V(t,H(G(e,t),k.random())),B(k.random()*R/2),"polar")}),c=1;c<=1e4;++c){for(f=u=0;f<g;++f){if(o=i[f],h=a(o),Q((m=s(o)).re,O)&&Q(m.im,O)){if(Xn(L.abs(h.re),p)&&Xn(L.abs(h.im),p)){++u;continue}l=new I(e,O)}else l=h.div(m);h=l.div(y.sub(l.mul(i.reduce(function(n,r,t){return n=t===f||Q(o.re,r.re)&&Q(o.im,r.im)?n:n.add(o.sub(r).inv())},d)))),Xn(L.abs(h.re),p)&&Xn(L.abs(h.im),p)&&++u,i[f]=o.sub(h)}if(u===g)break}return i}function Ct(n,r){for(var t,e,i,u=O,f=k.min(n.length,r.length)-1,o=0;o<f;++o)t=n[o],i=n[o+1],e=r[o],u=V(u,D(G(H(t,r[o+1]),H(e,i)),rn));return 1<f&&(t=n[f],i=n[0],e=r[f],u=V(u,D(G(H(t,r[0]),H(e,i)),rn))),u}function Ft(u,f){var o,n,r,t,e,i,l,c,a,s,h=u.length,m=F(h,function(n){return n});if(h<3)return m;for(o=0,n=1;n<h;++n)(Rn(f[n],f[o])||Q(f[n],f[o])&&Rn(u[n],u[o]))&&(o=n);for(m.splice(o,1),--h,m=m.map(function(n){return[(r=u[o],t=f[o],e=u[n],i=f[n],Wn(i=L.atan2(G(i,t),G(e,r)),O)?V(i,2*R):i),n];var r,t,e,i}).sort(function(n,r){return Rn(n[0],r[0])?-1:Tn(n[0],r[0])?1:0}).map(function(n){return n[1]}),(r=new Array(h+1))[0]=o,r[1]=m[0],r[2]=m[1],t=3,n=2;n<h;++n){for(;1<t&&Xn(O,(e=u[m[n]],i=f[m[n]],l=u[r[t-1]],c=f[r[t-1]],a=u[r[t-2]],s=f[r[t-2]],e=G(e,a),l=G(l,a),a=G(i,s),i=G(c,s),G(H(e,i),H(a,l))));)--t;r[t++]=m[n]}return r.length=t,r}function Wt(){var n,r,t,e,i=arguments,u=i.length;if(0===u)return O;for(e=0;e<u&&Q(O,n=i[e++]););for(n=L.abs(n);e<u;){if(Q(n,$))return $;for(;e<u&&Q(O,r=i[e++]););if(Q(r=L.abs(r),$))return $;if(!Q(r,n)){if(Q(r,O))break;for(Rn(n,r)&&(t=r,r=n,n=t);!Q(O,r);)r=Ln(n,t=r),n=t}}return n}function Ut(n){var r,t,e,i,u=n.length,f=$,o=O,l=O,c=$,a=$,s=$;if(0!==u){if(r=n[0],Tn(O,r)&&(r=L.abs(r),a=Z),1===u)return[r,a];if(i=2===u?[n[1],$]:Ut(n.slice(1)),t=i[0],Tn(O,t)&&(t=L.abs(t),s=Z),Q(O,r))return F(i.length+1,function(n){return 0===n?t:1===n?a:H(s,i[n-1])});if(Q(O,t))return F(i.length+1,function(n){return 0===n?r:1===n?a:H(s,i[n-1])});for(;;){if(e=L.floor(D(r,t)),r=Ln(r,t),f=G(f,H(e,l)),o=G(o,H(e,c)),Q(O,r))return l=H(l,a),c=H(c,s),F(i.length+1,function(n){return 0===n?t:1===n?l:H(c,i[n-1])});if(e=L.floor(D(t,r)),t=Ln(t,r),l=G(l,H(e,f)),c=G(c,H(e,o)),Q(O,t))return f=H(f,a),o=H(o,s),F(i.length+1,function(n){return 0===n?r:1===n?f:H(o,i[n-1])})}}}function Bt(n,r){var t=L.abs(n);return Q(t,L.abs(r))?Q(n_sign(n),n_sign(r))?t:On(t):H(D(n,Wt(n,r)),r)}E.polydiv=En(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[ir(r,t),O]:ir(r,t);else{if(r=q(r),t=q(t),w(r)&&w(t)||d("polydiv"),!t.length||1===t.length&&Cn(t[0],O))throw"polydiv: divisor is zero";e=Lt(r,t,!1)}return 1<n?e:e[0]}),E.polyval=function(r,n){return w(r=q(r))||d("polyval"),y(n)?Pn(Ot(r,n)):w(n)?n.map(function(n){return Pn(Ot(r,n))}):void d("polyval")},E.polyvalm=function(r,n){return w(r=q(r))||d("polyvalm"),b(n)&&W(n)===U(n)?Pn(function(n,r){if(!n.length)return wr(W(r),U(r));for(var t=n.length,e=0,i=W(r),u=br(i,n[0]);e+1<t;)++e,u=rr(P(u,r),br(i,n[e]));return u}(r,n)):y(n)?Pn(Ot(r,n)):w(n)?n.map(function(n){return Pn(Ot(r,n))}):void d("polyvalm")},E.polyfit=function(n,r,i){if(n=q(n),r=q(r),w(n)&&w(r)||d("polyfit"),n.length!==r.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return Pn(function(e,i){var n,u,f,r,t,o,l,c;if(!(w(e)&&e.length&&w(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),f=k.min(e.length,i.length),e.length=f,i.length=f,l={},c=[],u=0;u<f;++u)if(o=String(e[u]),un.call(l,o)){if(!Cn(i[l[o]],i[u]))return[];c.push(u)}else l[o]=u;for(;c.length;)u=c.pop(),e.splice(u,1),i.splice(u,1);for(c=l=null,r=F(f=e.length,function(n){for(var r=$,t=0;t<f;++t)t!==n&&(r=K(r,Gn(e[n],e[t])));return r=Y(i[n],r)}),t=F(f,function(n){return[$,Dn(e[n])]}),n=[],u=0;u<f;++u)n=Zt(n,t.reduce(function(n,r,t){return n=t!==u?zt(n,r):n},[r[u]]));return n}(n,r));if(!p(i)||v(i)<0)throw"polyfit: input 3 not positive int";return i=v(i),Pn(P(ut(n.reduce(function(n,r){for(var t=1,e=[$];t<=i;++t)e.unshift(K(r,e[0]));return n.push(e),n},[])),r))},E.roots=function(n){return w(n=q(n))||d("roots"),Pn($t(n).sort(function(n,r){return Rn(gr(n),gr(r))?-1:Tn(gr(n),gr(r))?1:0}))},E.compan=function(n){return w(n=q(n))||d("compan"),A((t=n).length-1,t.length-1,function(n,r){return 0===n?Dn(Y(t[r+1],t[0])):r+1===n?$:O});var t},E.poly=function(n){return b(n=q(n))&&E.charpoly?E.charpoly(n):(w(n)||d("poly"),Pn(n.reduce(function(n,r){return zt(n,[$,Dn(r)])},[$])))},E.cart2pol=En(function(n,r,t,e){return[E.atan2(t,r),E.sqrt(rr(ur(r,rn),ur(t,rn))),e]},3),E.pol2cart=En(function(n,r,t,e){return[er(t,E.cos(r)),er(t,E.sin(r)),e]},3),E.cart2sph=En(function(n,r,t,e){var i=rr(ur(r,rn),ur(t,rn));return[E.atan2(t,r),E.atan2(e,E.sqrt(i)),E.sqrt(rr(i,ur(e,rn)))]},3),E.sph2cart=En(function(n,r,t,e){return[er(e,er(E.cos(t),E.cos(r))),er(e,er(E.cos(t),E.sin(r))),er(e,E.sin(t))]},3),E.polyarea=function(r,t){return r=q(r),t=q(t),b(r)&&b(t)?(W(r)===W(t)&&U(r)===U(t)||d("polyarea"),F(U(r),function(n){return Ct(j(r,n),j(t,n))})):w(r)&&w(t)?(r.length!==t.length&&d("polyarea"),Ct(r,t)):void d("polyarea")},E.convhull=En(function(n,r,t,e){3<arguments.length&&d("convhull"),b(r)&&2===U(r)?(t=j(r,1),r=j(r,0)):(r=q(r),t=q(t)),w(r)&&w(t)&&r.length===t.length||d("convhull");var i=Ft(r,t);return 1<n?[i.map(function(n){return n+1}),Ct(i.map(function(n){return r[n]}),i.map(function(n){return t[n]}))]:i.map(function(n){return n+1})}),E.mod=function(n,t){return Cn(t=Sn(t||0),0)?n:In(function(n){var r;return C(n)?Rn(r=Ln(n,t),0)&&Tn(t,0)?V(r,t):r:n},n,!0)},E.gcd=En(function(n,r,t){return function t(e,i,u){if(u){var f,o;if(S(e)){if(f=new Array(e.length),S(i))return e.length!==i.length&&d("gcd"),o=new Array(i.length),[e.map(function(n,r){return n=t(n,i[r],u),f[r]=n[1],o[r]=n[2],n[0]}),f,o];if(p(i))return o=new Array(e.length),[e.map(function(n,r){return n=t(n,i,u),f[r]=n[1],o[r]=n[2],n[0]}),f,o]}if(p(e)){if(S(i))return f=new Array(i.length),o=new Array(i.length),[i.map(function(n,r){return n=t(e,n,u),f[r]=n[1],o[r]=n[2],n[0]}),f,o];if(p(i))return Ut([e,i])}}else{if(S(e)){if(S(i))return e.length!==i.length&&d("gcd"),e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(S(i))return i.map(function(n,r){return t(e,n)});if(p(i))return Wt(e,i)}}d("gcd")}(r,t,1<n)}),E.lcm=function t(e,i){if(S(e)){if(S(i))return e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(S(i))return i.map(function(n,r){return t(e,n)});if(p(i))return function(){var n,r,t=arguments,e=t.length;if(e<=1)return 1===e?t[0]:O;if(Q(O,t[0])||Q(O,t[1]))return O;for(r=Bt(t[0],t[1]),n=2;n<e;++n){if(Q(O,t[n]))return O;r=Bt(r,t[n])}return r}(e,i)}return e};var Qt=[B(2),B(3),B(5),B(7),B(11),B(13),B(17),B(19),B(23),B(29),B(31),B(37),B(41),B(43),B(47),B(53),B(59),B(61),B(67),B(71),B(73),B(79),B(83),B(89),B(97),B(101),B(103),B(107),B(109)];function Vt(t){for(var n=(t=[].map.call(t,function(n){return S(n)||d("combinations"),xr(n)})).map(function(n){return n.length}),r=F(n.length,0),e=[];r&&r.length;)e.push(r.map(function(n,r){return t[r][n]})),r=function(n,r){for(var t,e=r.length-1,i=e;0<=i&&i<=e&&n[i]+1===r[+i+0];)--i;if(0<=i&&i<=e)for(n[i]=n[i]+1,t=i+1;0<=t&&t<=e;t+=1)n[t]=0;else n=null;return n}(r,n);return e}function Gt(n){if(N(n))return 0<n.length;if(hn(n))return!1;if(u(n))return 0!==n;if(gn(n))return!n.eq(O);if(f(n))return!Q(n.re,O)||!Q(n.im,O);if(S(n)){if(!n.length)return!1;for(var r=0,t=n.length;r<t;++r)if(!Gt(n[r]))return!1;return!0}return!0===n}en.push(function(){Qt=[B(2),B(3),B(5),B(7),B(11),B(13),B(17),B(19),B(23),B(29),B(31),B(37),B(41),B(43),B(47),B(53),B(59),B(61),B(67),B(71),B(73),B(79),B(83),B(89),B(97),B(101),B(103),B(107),B(109)]}),E.factor=function(n){for(var r,t,e=L.floor(L.abs(gr(Sn(n)))),i=B(1e30),u=[],f=e,o=0,l=Qt.length;o<l;++o){if(Q(f,r=Qt[o]))return[r];if(Tn(t=H(r,r),e)||null!=i&&Tn(t,i))break;for(;Q(O,Ln(e,r));)u.push(r),e=D(e,r)}if(l<=o)for(t=H(r=V(r,rn),r);Xn(t,e)&&(null==i||Xn(t,i));){for(;Q(O,Ln(e,r));)u.push(r),e=D(e,r);t=H(r=V(r,rn),r)}return Tn(e,$)&&u.push(e),u},E.randperm=function(n){(!p(n=k.round(v(n||0)))||n<=0)&&d("randperm");for(var r,t,e=F(n,function(n){return n+1}),i=1+(e.length-1);1<i--;)r=k.round(k.random()*+i),t=e[0+i],e[0+i]=e[0+r],e[0+r]=t;return e},E.perms=function(r){w(r=q(r))||d("perms");for(var n=F(r.length,function(n){return n}),t=[];n&&n.length;)t.push(n.map(function(n){return r[n]})),n=function(n){for(var r,t,e,i,u=n.length-1,f=u,o=f-1;0<=o&&o<=u&&+n[o]>=+n[o+1];)--o;if(0<=o&&o<=u){for(r=f;0<=r&&r<=u&&0<r-o&&+n[o]>=+n[r];)--r;for(t=n[o],n[o]=n[r],n[r]=t,e=o+1,i=f;0<=e&&e<=u&&0<=i&&i<=u&&0<i-e;)t=n[e],n[e]=n[i],n[i]=t,e+=1,--i}else n=null;return n}(n);return t},E.combinations=function(){return Vt(arguments)},E.string=function n(r){return S(r)?r.map(n):N(r)?r:String(r)},E.strlength=function(n){if(N(n))return n.length;d("strlength")},E.char=function n(r){return r=q(r),S(r)?r.map(n):N(r)?r.split(""):p(r)?String.fromCharCode(v(r)):String(r)},E.lower=E.tolower=function n(r){return S(r)?r.map(n):N(r)?r.toLowerCase():r},E.upper=E.toupper=function n(r){return S(r)?r.map(n):N(r)?r.toUpperCase():r},E.dec2bin=function n(r){return S(r)?r.map(n):u(r)?r.toString(2):gn(r)?r.toBinary():r},E.bin2dec=function n(r){return S(r)?r.map(n):N(r)?parseInt(r,2):r},E.dec2hex=function n(r){return S(r)?r.map(n):u(r)?r.toString(16):gn(r)?r.toHexadecimal():r},E.hex2dec=function n(r){return S(r)?r.map(n):N(r)?parseInt(r,16):r};var Ht={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var r=[],t=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?t.length&&(S(t[0])?r=r.length?Sr("vert",r,t):t:r.push(t),t=[]):!cn(n,ne)&&S(n)?t=t.length?Sr("horz",t,n):n:t.push(n))}),t.length&&(S(t[0])?r=r.length?Sr("vert",r,t):t:r.length?r.push(t):r=t),r}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return E.colon(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r){return xr(n,r)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r,t){return xr(n,r,t)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return E.ctranspose(n)}},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return E.transpose(n)}},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:fr},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:ur},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,r){return rt(n,r)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:ir},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:ir},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:function(n,r){return P(n=dn(n)?bn(n):n,r=dn(r)?bn(r):r)}},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:er},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:rr},"-":{name:"sub",arity:2,arityalt:1,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:function(n,r){return 1===arguments.length?or(n):tr(n,r)}},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Qn},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Bn},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Un},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Wn},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Fn},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Cn},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,r){return Gt(n)&&Gt(r)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){return Gt(n)||Gt(r)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){n=Gt(n),r=Gt(r);return n&&!r||r&&!n?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return Gt(n)?0:1}},"=":{name:"set",breakpoint:"set",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,r){var t,e;return S(n)&&cn(n[0],ne)?(e=n,S(t=r)?await Promise.all(e.map(function(n,r){return Dt(n,r<t.length?t[r]:null)})):await Promise.all(e.map(function(n,r){return Dt(n,0===r?t:null)}))):Dt(n,r.$scilitevarargout$?r[0]:r)}}};async function Dt(n,r){if(cn(n,ne)&&N(n.v))return await n.set(r),n.get(!0);throw"setting non-variable"}async function Jt(n,r,t){var e,i,u,f,o,l,c=null;if(Gt(await te(n.if.cond,r,t))){for(e=0,f=(o=n.if.statements).length;e<f;++e)null!=(l=await te(o[e],r,t))&&(c=l);return c}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(Gt(await te(n.elseif[i].cond,r,t))){for(e=0,f=(o=n.elseif[i].statements).length;e<f;++e)null!=(l=await te(o[e],r,t))&&(c=l);return c}if(n.else.statements.length){for(e=0,f=(o=n.else.statements).length;e<f;++e)null!=(l=await te(o[e],r,t))&&(c=l);return c}}async function Kt(n,r,t){var e,i,u,f,o,l,c,a,s=[],h=!1,m=!1,g=await te(n.val,r,t),p=n.statements;if(s.$scilitevarargout$=!0,S(g)){for(l=(t=t||{}).brk,c=t.cont,t.brk=function(){h=!0},t.cont=function(){m=!0},u=0,f=(a=yn(g=q(g)))?U(g):g.length;u<f;++u){for(m=h=!1,await n.ind.set(a?j(g,u):g[u]),e=0,i=p.length;e<i&&(o=await te(p[e],r,t),!h&&!m);++e)null!=o&&s.push(o);if(h)break}t.brk=l,t.cont=c}return s}async function Yt(n,r,t){var e,i,u,f,o,l=[],c=!1,a=!1,s=n.statements;for(l.$scilitevarargout$=!0,f=(t=t||{}).brk,o=t.cont,t.brk=function(){c=!0},t.cont=function(){a=!0};Gt(await te(n.cond,r,t));){for(a=c=!1,e=0,i=s.length;e<i&&(u=await te(s[e],r,t),!c&&!a);++e)null!=u&&l.push(u);if(c)break}return t.brk=f,t.cont=o,l}function ne(n,r,t){if(!cn(this,ne))return new ne(n,r,t);this.ctx=n,this.v=r,this.i=t}async function re(n){return cn(n,ne)?await n.get():n}function M(n,r){if(!cn(this,M))return new M(n,r);null==r&&(r=n,n=""),this.op=n,this.arg=r}async function te(n,r,t){if(cn(n,M))return ie(n,r,t);if(S(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await te(n[e],r,t);return u}return n}function ee(d,y,w,i){var b,x=0,S=0,u=d;function A(n,r,t){null==t&&(t=S),null==r&&(r=x);var e=u.split("\n")[t];return(n=String(n)+" at line "+String((w||0)+t)+" position "+String((i||0)+r)+":")+"\n"+e+"\n"+new Array(r+1).join(" ")+"^\n"}return function i(n){var r,t,e,u,f,o,l,c=[],a=[],s=[];function h(n){var r,t,e,i,u,f,o,l;if(a.length)if(n)for(;0<a.length;){if(u=(i=a.shift())[0],n===(f=Ht[u]).breakpoint){a.unshift(i);break}if(f.arity>c.length){if(!(null!=f.arityalt&&f.arityalt<=c.length))throw A('invalid or missing argument for "'+u+'"',i[1],i[2]);l=c.splice(0,f.arityalt).reverse()}else l=c.splice(0,f.arity).reverse();o=M(f.fn,l),c.unshift(o)}else if(t=(r=a.shift())[0],1===(e=Ht[t]).fixity){if(e.arity>c.length){if(!(null!=e.arityalt&&e.arityalt<=c.length))throw A('invalid or missing argument for "'+t+'"',r[1],r[2]);l=c.splice(0,e.arityalt).reverse()}else l=c.splice(0,e.arity).reverse();o=M(e.fn,l),c.unshift(o)}else{if(-1!==e.fixity)for(;0<a.length&&(u=(i=a[0])[0],(f=Ht[u]).priority<e.priority||f.priority===e.priority&&(f.associativity<e.associativity||f.associativity===e.associativity&&-1===f.associativity));){if(f.arity>c.length){if(!(null!=f.arityalt&&f.arityalt<=c.length))throw A('invalid or missing argument for "'+u+'"',i[1],i[2]);l=c.splice(0,f.arityalt).reverse()}else l=c.splice(0,f.arity).reverse();o=M(f.fn,l),c.unshift(o),a.shift()}a.unshift(r)}}function m(n){if(h(!0),1<c.length||0<a.length)throw A("mismatched terms and operators",a.length?a[0][1]:x,a.length?a[0][2]:S);!0===n&&(cn(c[0],M)&&s.push(c[0]),c=[],a=[])}function g(n,r){var t,e=n.test?d.match(n):n===d.slice(0,n.length);return!!e&&(!1===r?n.test?e:[n,n]:n.test?(t=e[r||0].length,d=d.slice(t),x+=t,e):(t=n.length,d=d.slice(t),x+=t,[n,n]))}function p(n,r,t){for(var e,i=t||0,u="";i<d.length;)if(n===(e=d.charAt(i))){if(!(i+1<d.length&&n===d.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return r&&(d=d.slice(i+1),x+=i+1),[u,i+1]}function v(){var n,r,t,e=function(n,r,t){for(var e,i=0,u=0;i<d.length;)if(e=d.charAt(i),!t||'"'!==e&&"'"!==e){if(r===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=p(e,!1,i+1)[1];return u||i>=d.length?-1:i}("]","[",!0);if(-1===e)throw A("mismatched brackets");if(n=d.slice(0,e),/[\[\]]/.test(n)){for(r=[];t=i(",;]");)if(r.push(t),g(","))r.push(M(","));else{if(!g(";"))break;r.push(M(";"))}g(/^\s+/),g("]")}else r=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,r){var t=n.length,e=0;return r.trim().split(-1<r.indexOf(",")?",":/\s+/g).reduce(function(n,r){return(r=ee(r.trim(),y,S+w,x))&&(e?n.push(M(",")):t&&n.push(M(";")),n.push(r),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,r){return(r=ee(r.trim(),y,S+w,x))&&(n.length&&n.push(M(",")),n.push(r)),n},[]),d=d.slice(e+1),x+=e+1,1<(n=n.split("\n")).length&&(S+=n.length-1,n.slice(0,-1).forEach(function(n){x-=n.length+1}));return M(Ht["[]"].fn,r)}for(;0<d.length;)if(g(/^if\b/)){if(m(!0),!(l=i("\n,")))throw A('missing or invalid condition in "if"');for(g("\n")?(++S,x=0):g(","),f=(o={if:{cond:l,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((l=i(["elseif","else","end"]))&&(f.statements=f.statements.concat(l)),g("elseif")){if(!(l=i("\n,")))throw A('missing or invalid condition in "elseif"');g("\n")?(++S,x=0):g(","),o.elseif.push({cond:l,statements:[]}),f=o.elseif[o.elseif.length-1]}else if(g("else"))g(/^[ \t\v\f]+/),g("\n")?(++S,x=0):g(","),f=o.else;else if(g("end")||!l)break;s.push(M(Jt,o))}else if(g(/^for\b/)){if(m(!0),!(r=g(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw A('missing or invalid declaration in "for"');if(!(l=i("\n,")))throw A('missing or invalid declaration in "for"');for(g("\n")?(++S,x=0):g(","),o={ind:ne(y,r[1]),val:l,statements:[]};(l=i(["end"]))&&(o.statements=o.statements.concat(l)),!g("end")&&l;);s.push(M(Kt,o))}else if(g(/^while\b/)){if(m(!0),!(l=i("\n,")))throw A('missing or invalid condition in "while"');for(g("\n")?(++S,x=0):g(","),o={cond:l,statements:[]};(l=i(["end"]))&&(o.statements=o.statements.concat(l)),!g("end")&&l;);s.push(M(Yt,o))}else if(r=g(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(r[1]))break;if("continue"===r[1])g("continue"),s.push(M("continue",""));else if("break"===r[1])g("break"),s.push(M("break",""));else{if("end"!==r[1])throw A('unexpected "'+r[1]+'"');g("end"),c.unshift(M("v",ne(y,"end")))}}else if(g("..."))g(/^[ \t\v\f]+/),g("\n")&&(++S,x=0);else if(g(";",!1)){if(n&&-1<n.indexOf(";"))break;g(";"),m(!0)}else if(g("\n",!1)){if(n&&-1<n.indexOf("\n"))break;g("\n"),++S,m(!(x=0))}else if(g(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(r=g("%"))b=d.indexOf("\n"),d=d.slice(-1<b?b+1:d.length),-1<b&&++S,m(!(x=0));else if(r=(r=g("'"))||g('"'))f=p(r[0],!0)[0],c.unshift(M("'"===r[0]?f.split(""):f));else if(r=g(/^(&&|\|\|)[^&\|]/,1))u=r[1],a.unshift([u,x,S]),h();else if(r=g(/^(xor)[^a-zA-Z]/,1))u=r[1],a.unshift([u,x,S]),h();else if(r=g(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=r[1],a.unshift([u,x,S]),h();else if(r=g("~"))a.unshift(["~",x,S]),h();else if(r=g("="))a.unshift(["=",x,S]),h();else if(r=g(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=r[0],a.unshift([u,x,S]),h();else if(r=g(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(t=r[1],g(/^\s*\:\s*\)/))f=M("v",ne(y,t)),c.unshift(f),a.unshift(["(:)",x,S]),h();else{for(o=[];(l=i(",)"))&&o.push(l),g(","););if(!g(")"))throw A("mismatched parentheses");f=un.call(E,t)?M(E[t],o):M("v",ne(y,t,o.length?o:null)),c.unshift(f)}g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h())}else if(r=g(/^[_a-z][_a-z0-9]*/i))t=r[0],f=un.call(E,t)&&0===E[t].length?M(E[t],[]):M("v",ne(y,t)),c.unshift(f),g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h());else if(r=g(/^(-?\s*\d+(\.\d+)?([eE][+-]?\d+)?)([ij])?/))o=r[1].split(/\s+/).join(""),o=_?_(o):parseFloat(o,10),f=M(r[4]?new I(0,o):o),c.unshift(f);else if(r=g(/^(-?\s*\.\d+([eE][+-]?\d+)?)([ij])?/))o="-"===(o=r[1].split(/\s+/).join("")).charAt(0)?"-0"+o.slice(1):"0"+o,o=_?_(o):parseFloat(o,10),f=M(r[4]?new I(0,o):o),c.unshift(f);else if("["===(e=d.charAt(0)))d=d.slice(1),x+=1,(f=v())&&(c.unshift(f),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw A("mismatched brackets")}if("("===e)if(d=d.slice(1),x+=1,g(/^\s*\:\s*\)/))a.unshift(["(:)",x,S]),h();else{if(c.length&&a.reduce(function(n,r){return r=Ht[r[0]],n+(r.arity>c.length-n&&null!=r.arityalt?r.arityalt:r.arity)},0)<=c.length){for(h("set"),f=c.shift(),o=[];(l=i(",)"))&&o.push(l),g(","););if(!g(")"))throw A("mismatched parentheses");o.length&&(f=M("v",ne(y,f,o)))}else if(f=i(")"),!g(")"))throw A("mismatched parentheses");f&&(c.unshift(f),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(a.unshift([r[0],x,S]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw A("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw A(n?'missing expected "'+(N(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(d=d.slice(1),l=[x+=1,S],h("set"),c.length?o=1:(o=0,c.unshift(M(":")));f=i(":,)\n"),g(/^[ \t\v\f]+/),f?(c.unshift(f),++o):g(":",!1)&&c.unshift(M(":")),g(":"););1<o&&(a.unshift([3===o?"::":":",l[0],l[1]]),h())}}return m(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function ie(n,r,t){var e;if(cn(n,M)){if(""===n.op)return n.arg;if("v"===n.op)return!1===r?n.arg:cn(n.arg.v,M)?re(n.arg):sn(r)&&un.call(r,n.arg.v)?r[n.arg.v]:await re(n.arg);if(Jt===n.op)return Jt(n.arg,r,t);if(Kt===n.op)return Kt(n.arg,r,t);if(Yt===n.op)return Yt(n.arg,r,t);if("break"===n.op)return void(t&&an(t.brk)&&t.brk());if("continue"===n.op)return void(t&&an(t.cont)&&t.cont());if(Ht["="].fn===n.op)return t=t||{},e=await ie(n.arg[0],!1),S(e)&&cn(e[0],ne)&&(t.nargout=e.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[e,n.arg[1].arg.isByRef()?_n(await ie(n.arg[1],r,t)):await ie(n.arg[1],r,t)]):n.op.apply(null,[e].concat(await Promise.all(n.arg.slice(1).map(function(n){return ie(n,r,t)}))));if(an(n.op))return(t&&p(t.nargout)&&an(n.op.nargout)?n.op.nargout(t.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return ie(n,r,t)})))}throw"invalid expr"}return on.op=Ht,ne.prototype={constructor:ne,ctx:null,v:null,i:null,get:async function(n){var r,t,e=this;if(cn(e.v,M))r=await te(e.v);else{if(!un.call(e.ctx,e.v)&&!un.call(ln,e.v))throw'undefined variable "'+e.v+'"';r=(un.call(e.ctx,e.v)?e.ctx:ln)[e.v]}return!0!==n&&null!=e.i?(t=Or(r),n=await Promise.all(e.i.map(function(n,r){return te(n,{end:1===e.i.length?t[0]*t[1]:t[r]})})),lr.apply(null,[r].concat(n))):r},set:async function(n){var r,t,e,i=this;if(null!=i.i){if(cn(i.v,M))r=await te(i.v);else{if(!un.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';r=i.ctx[i.v]}t=Or(r),1===(e=await Promise.all(i.i.map(function(n,r){return te(n,{end:1===i.i.length?t[0]*t[1]:t[r]})}))).length&&(e=e.concat(null)),cr.apply(null,[r].concat(e).concat([n]))}else cn(i.v,M)||(i.ctx[i.v]=n);return i},isset:function(){return N(this.v)&&un.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},M.prototype={constructor:M,op:null,arg:null},l.createContext=function(){return{ans:null}},l.eval=async function(n,r,t){r=r||l.createContext();var e=ee(String(n),r,null==t?1:t,1),i=null,u=!1;if(S(e))for(var f=0,o=e.length;f<o;++f)e[f]&&(i=await ie(e[f]),u=!0);else e&&(i=await ie(e),u=!0);return u&&(S(i)||hn(i)||y(i)||N(i))&&(r.ans=i),u?i:null},on});