/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.11
* 2026-01-03 18:08:48
* https://github.com/foo123/SciLite
*
**/!function(r,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(r)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(r)}):n in r||(r[n]=t.call(r)||1)&&"function"==typeof define&&define.amd&&define(function(){return r[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function r(){}var t,e,A=null,_=null,I=Math,L={},i={},R=I.PI,f=I.E,a=I.log(10),l=I.log(2),T=1/0,s=NaN,rn=1e-15,h=Number.MAX_VALUE,m=Number.MIN_VALUE,g=Number.MAX_SAFE_INTEGER,X=Number.MIN_SAFE_INTEGER,z=g,O=0,$=1,Z=-1,tn=.5,F=2,en=10,un=[],on=Object.prototype.hasOwnProperty,fn=Object.prototype.toString,k=Array.isArray||function(n){return"[object Array]"===fn.call(n)},cn={VERSION:"0.9.11",_:{},fn:{},op:{},constant:{pi:R,e:f,eps:rn,realmax:h,realmin:m,intmax:g,intmin:X,inf:T,Inf:T,nan:s,NaN:s}},c=cn._,an=cn.constant,q=cn.fn;function v(n){throw String(n)+": input(s) not supported"}function ln(n,r){return n instanceof r}function sn(n){return"function"==typeof n}function hn(n){return"[object Object]"===fn.call(n)}function E(n){return"string"==typeof n}function mn(n){return pn(n)&&n.isNaN()||Number.isNaN(n)}function gn(n){return pn(n)&&!n.isFinite()||u(n)&&!isFinite(n)}function u(n){return"number"==typeof n}function pn(n){return null!=A&&n instanceof A}function W(n){return"number"==typeof n||null!=A&&n instanceof A}function p(n){return pn(n)&&n.isInt()||u(n)&&Number.isInteger(n)}function o(n){return null!=_&&n instanceof _}function dn(n){return!o(n)||G(O,n.im)}function y(n,r){if(u(n)||o(n)||pn(n))return!0;if(!1===r){if(w(n)&&1===n.length)return!0;if(b(n)&&1===n.length&&1===n[0].length)return!0}return!1}function w(n){return k(n)&&y(n[0])}function b(n){return k(n)&&k(n[0])&&y(n[0][0])}function vn(n){return!k(n)}function yn(n){return k(n)&&!k(n[0])}function wn(n){return k(n)&&k(n[0])}function U(n,r){for(var t=new Array(n),e=0;e<n;++e)t[e]=sn(r)?r(e,t):r;return t}function S(n,r,t){for(var e,i,u=new Array(n),o=0;o<n;++o)for(u[o]=i=new Array(r),e=0;e<r;++e)i[e]=sn(t)?t(o,e,u):t;return u}function bn(n,t){return n.length?U(n[0],function(r){return 1<n.length?bn(n.slice(1),function(n){return sn(t)?t([r].concat(n)):t}):sn(t)?t([r]):t}):[]}function xn(n){return vn(n)?[[n]]:yn(n)?[n]:n}function kn(n){return vn(n)?[[n]]:yn(n)?n.map(function(n){return[n]}):n}function Sn(n,r){return W(n)?n:o(n)?r?n.re:n:w(n)&&1===n.length?Sn(n[0],r):b(n)&&1===n.length&&1===n[0].length?Sn(n[0][0],r):n}function N(n){if(null!=n)if(wn(n)){if(1===B(n))return n[0];if(1===Q(n))return n.map(function(n){return n[0]})}else if(vn(n))return[n];return n}function B(n){return n.length}function Q(n){return n[0].length}function j(r,t){return U(r.length,function(n){return r[n][t]})}function M(n){return"number"==typeof n?n:pn(n)?n.$valueOf():o(n)?n.valueOf():n}function V(n){return null!=A&&"number"==typeof n?A(n):n}function An(n){return k(n)?n.map(An):y(n)?M(n):n}function _n(n){return k(n)?n.map(_n):y(n)?V(n):n}function In(n){return n=k(n)?n.map(In):n}function qn(r,n,t){if(W(n))return r(n);if(o(n)){if(t)return r(n);if(G(n.im,O))return r(n.re)}return k(n)?n.map(function(n){return qn(r,n,t)}):n}function En(t,n,e,i){return W(n)&&W(e)?t(n,e):y(n)&&y(e)?i?t(Tn(n),Tn(e)):dn(n)&&dn(e)?t(Rn(n),Rn(e)):s:k(n)&&k(e)?n.map(function(n,r){return En(t,n,e[r],i)}):s}function Nn(t,e){if(!sn(t))return k(t)&&(t.$scilitevarargout$=!0),t;null==e&&(e=1);function n(){var n=[].slice.call(arguments);return n.unshift(e),n=t.apply(null,n),1<e&&k(n)&&(n.$scilitevarargout$=!0),n}return n.nargout=function(r){return function(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),(1<r||1<e)&&k(n)&&(n.$scilitevarargout$=!0),n}},n}function jn(n){return mn(n)?n="nan":gn(n)?n=(Xn(n,O)?"-":"")+"inf":p(n)?n=String(n):W(n)?n=n.toFixed(4).replace(/\.0{4}$/,""):o(n)&&(n=String(n)),n}function Mn(t){var r;return null==t?t="":E(t)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(t)&&(t="\\text{"+t+"}"):t=mn(t)?"\\text{nan}":W(t)?[rn,h,m,g,X].reduce(function(n,r){return n||G(t,r)},!1)?String(t):jn(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):o(t)?String(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):b(t)?(r=!1,Q(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,I.round(c.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-I.round(c.MAXPRINTSIZE/2)))}),r=!0),"\\begin{bmatrix}"+(t=B(t)>c.MAXPRINTSIZE?t.slice(0,I.round(c.MAXPRINTSIZE/2)).concat([U(t[0].length,function(n){return I.round(c.MAXPRINTSIZE/2)===n&&r?"\\ddots":"\\vdots"})]).concat(t.slice(1-I.round(c.MAXPRINTSIZE/2))):t).map(function(n){return n.map(Mn).join(" & \\hskip 1em ")}).join(" \\\\ ")+"\\end{bmatrix}"):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,I.round(c.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(t.slice(1-I.round(c.MAXPRINTSIZE/2))):t).map(Mn).join(" \\hskip 1em "):"object"==typeof t||"function"==typeof t?"":String(t),t}function Pn(t){var r,e;return null==t?t="":E(t)||(t=mn(t)?"nan":W(t)?([rn,h,m,g,X].reduce(function(n,r){return n||G(t,r)},!1)?String:jn)(t):o(t)?String(t):b(t)?(r=!1,Q(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,I.round(c.MAXPRINTSIZE/2)).concat("..").concat(n.slice(1-I.round(c.MAXPRINTSIZE/2)))}),r=!0),B(t)>c.MAXPRINTSIZE&&(t=t.slice(0,I.round(c.MAXPRINTSIZE/2)).concat([U(t[0].length,function(n){return I.round(c.MAXPRINTSIZE/2)===n&&r?"\\":":"})]).concat(t.slice(1-I.round(c.MAXPRINTSIZE/2)))),e=U(Q(t),function(n){return j(t,n).reduce(function(n,r){return I.max(n,Pn(r).length)},0)}),t.map(function(n,r){return"["+n.map(function(n,r){n=Pn(n);return n=n.length<e[r]?new Array(e[r]-n.length+1).join(" ")+n:n}).join("  ")+"]"}).join("\n")):k(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,I.round(c.MAXPRINTSIZE/2)).concat([".."]).concat(t.slice(1-I.round(c.MAXPRINTSIZE/2))):t).map(Pn).join("  "):"object"==typeof t||"function"==typeof t?"":String(t)),t}function Rn(n){return k(n)?n.map(Rn):o(n)&&G(n.im,O)?n.re:n}function Tn(n){return _?k(n)?n.map(Tn):W(n)?new _(V(n),O):n:n}function G(n,r){return u(n)?u(r)?n===r:r.eq(n):n.eq(r)}function Xn(n,r){return u(n)?u(r)?n<r:r.gt(n):n.lt(r)}function zn(n,r){return u(n)?u(r)?r<n:r.lt(n):n.gt(r)}function Zn(n,r){return u(n)?u(r)?n<=r:r.gte(n):n.lte(r)}function Ln(n,r){return u(n)?u(r)?r<=n:r.lte(n):n.gte(r)}function D(n,r){return u(n)?u(r)?n+r:r.add(n):n.add(r)}function H(n,r){return u(n)?u(r)?n-r:r.neg().add(n):n.sub(r)}function K(n,r){return u(n)?u(r)?n*r:r.mul(n):n.mul(r)}function On(n,r){return u(n)?u(r)?n/r:A(n).div(r):n.div(r)}function $n(n,r){return mn(n)||mn(r)?s:u(n)?u(r)?n<0&&!p(r)?Rn(new _(n).pow(r)):I.pow(n,r):n<0&&!p(r)?Rn(new _(A(n)).pow(r)):A(n).pow(r):zn(O,n)&&!p(r)?Rn(new _(n).pow(A(r))):n.pow(r)}function Cn(n,r){return u(n)?u(r)?n%r:A(n).mod(r):n.mod(r)}function Fn(n){return u(n)?-n:n.neg()}function Wn(n){return u(n)?1/n:$.div(n)}function P(t,e){if(E(t)){if(E(e))return t===e?1:0;if(y(e))return t===String(e)?1:0;if(w(e))return e.map(function(n){return P(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return P(t,e[n][r])})}else if(W(t)){if(E(e))return String(t)===e?1:0;if(W(e))return G(t,e)?1:0;if(o(e))return G(e.re,t)&&G(e.im,O)?1:0;if(w(e))return e.map(function(n){return P(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return P(t,e[n][r])})}else if(o(t)){if(E(e))return String(t)===e?1:0;if(W(e))return G(t.re,e)&&G(t.im,O)?1:0;if(o(e))return G(t.re,e.re)&&G(t.im,e.im)?1:0;if(w(e))return e.map(function(n){return P(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return P(t,e[n][r])})}else if(w(t)){if(E(e)||y(e))return t.map(function(n){return P(n,e)});if(w(e)){if(t.length!==e.length)throw"eq: inputs have incompatible dimensions";return t.map(function(n,r){return P(n,e[r])})}if(b(e)){if(t.length!==Q(e))throw"eq: inputs have incompatible dimensions";return S(B(e),Q(e),function(n,r){return P(t[r],e[n][r])})}}else if(b(t)){if(E(e)||y(e))return S(B(t),Q(t),function(n,r){return P(t[n][r],e)});if(w(e)){if(Q(t)!==e.length)throw"eq: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return P(t[n][r],e[r])})}if(b(e)){if(B(t)!==B(e)||Q(t)!==Q(e))throw"eq: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return P(t[n][r],e[n][r])})}}return 0}function Un(t,e){if(E(t)){if(E(e))return t===e?0:1;if(y(e))return t===String(e)?0:1;if(w(e))return e.map(function(n){return Un(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Un(t,e[n][r])})}else if(W(t)){if(E(e))return String(t)===e?0:1;if(W(e))return G(t,e)?0:1;if(o(e))return G(e.re,t)&&G(e.im,O)?0:1;if(w(e))return e.map(function(n){return Un(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Un(t,e[n][r])})}else if(o(t)){if(E(e))return String(t)===e?0:1;if(W(e))return G(t.re,e)&&G(t.im,O)?0:1;if(o(e))return G(t.re,e.re)&&G(t.im,e.im)?0:1;if(w(e))return e.map(function(n){return Un(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Un(t,e[n][r])})}else if(w(t)){if(E(e)||y(e))return t.map(function(n){return Un(n,e)});if(w(e)){if(t.length!==e.length)throw"ne: inputs have incompatible dimensions";return t.map(function(n,r){return Un(n,e[r])})}if(b(e)){if(t.length!==Q(e))throw"ne: inputs have incompatible dimensions";return S(B(e),Q(e),function(n,r){return Un(t[r],e[n][r])})}}else if(b(t)){if(E(e)||y(e))return S(B(t),Q(t),function(n,r){return Un(t[n][r],e)});if(w(e)){if(Q(t)!==e.length)throw"ne: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Un(t[n][r],e[r])})}if(b(e)){if(B(t)!==B(e)||Q(t)!==Q(e))throw"ne: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Un(t[n][r],e[n][r])})}}return 0}function Bn(t,e){if(E(t)){if(E(e))return t<e?1:0;if(y(e))return t<String(e)?1:0;if(w(e))return e.map(function(n){return Bn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Bn(t,e[n][r])})}else if(W(t)){if(E(e))return String(t)<e?1:0;if(W(e))return Xn(t,e)?1:0;if(o(e))return Xn(e.re,t)&&G(e.im,O)?1:0;if(w(e))return e.map(function(n){return Bn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Bn(t,e[n][r])})}else if(o(t)){if(E(e))return String(t)<e?1:0;if(W(e))return Xn(t.re,e)&&G(t.im,O)?1:0;if(o(e))return Xn(t.re,e.re)&&G(t.im,O)&&G(e.im,O)||Xn(t.im,e.im)&&G(t.re,O)&&G(e.re,O)?1:0;if(w(e))return e.map(function(n){return Bn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Bn(t,e[n][r])})}else if(w(t)){if(E(e)||y(e))return t.map(function(n){return Bn(n,e)});if(w(e)){if(t.length!==e.length)throw"lt: inputs have incompatible dimensions";return t.map(function(n,r){return Bn(n,e[r])})}if(b(e)){if(t.length!==Q(e))throw"lt: inputs have incompatible dimensions";return S(B(e),Q(e),function(n,r){return Bn(t[r],e[n][r])})}}else if(b(t)){if(E(e)||y(e))return S(B(t),Q(t),function(n,r){return Bn(t[n][r],e)});if(w(e)){if(Q(t)!==e.length)throw"lt: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Bn(t[n][r],e[r])})}if(b(e)){if(B(t)!==B(e)||Q(t)!==Q(e))throw"lt: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Bn(t[n][r],e[n][r])})}}return 0}function Qn(t,e){if(E(t)){if(E(e))return e<t?1:0;if(y(e))return t>String(e)?1:0;if(w(e))return e.map(function(n){return Qn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Qn(t,e[n][r])})}else if(W(t)){if(E(e))return String(t)>e?1:0;if(W(e))return zn(t,e)?1:0;if(o(e))return zn(e.re,t)&&G(e.im,O)?1:0;if(w(e))return e.map(function(n){return Qn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Qn(t,e[n][r])})}else if(o(t)){if(E(e))return String(t)>e?1:0;if(W(e))return zn(t.re,e)&&G(t.im,O)?1:0;if(o(e))return zn(t.re,e.re)&&G(t.im,O)&&G(e.im,O)||zn(t.im,e.im)&&G(t.re,O)&&G(e.re,O)?1:0;if(w(e))return e.map(function(n){return Qn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Qn(t,e[n][r])})}else if(w(t)){if(E(e)||y(e))return t.map(function(n){return Qn(n,e)});if(w(e)){if(t.length!==e.length)throw"gt: inputs have incompatible dimensions";return t.map(function(n,r){return Qn(n,e[r])})}if(b(e)){if(t.length!==Q(e))throw"gt: inputs have incompatible dimensions";return S(B(e),Q(e),function(n,r){return Qn(t[r],e[n][r])})}}else if(b(t)){if(E(e)||y(e))return S(B(t),Q(t),function(n,r){return Qn(t[n][r],e)});if(w(e)){if(Q(t)!==e.length)throw"gt: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Qn(t[n][r],e[r])})}if(b(e)){if(B(t)!==B(e)||Q(t)!==Q(e))throw"gt: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Qn(t[n][r],e[n][r])})}}return 0}function Vn(t,e){if(E(t)){if(E(e))return t<=e?1:0;if(y(e))return t<=String(e)?1:0;if(w(e))return e.map(function(n){return Vn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Vn(t,e[n][r])})}else if(W(t)){if(E(e))return String(t)<=e?1:0;if(W(e))return Zn(t,e)?1:0;if(o(e))return Zn(e.re,t)&&G(e.im,O)?1:0;if(w(e))return e.map(function(n){return Vn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Vn(t,e[n][r])})}else if(o(t)){if(E(e))return String(t)<=e?1:0;if(W(e))return Zn(t.re,e)&&G(t.im,O)?1:0;if(o(e))return Zn(t.re,e.re)&&G(t.im,O)&&G(e.im,O)||Zn(t.im,e.im)&&G(t.re,O)&&G(e.re,O)?1:0;if(w(e))return e.map(function(n){return Vn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Vn(t,e[n][r])})}else if(w(t)){if(E(e)||y(e))return t.map(function(n){return Vn(n,e)});if(w(e)){if(t.length!==e.length)throw"le: inputs have incompatible dimensions";return t.map(function(n,r){return Vn(n,e[r])})}if(b(e)){if(t.length!==Q(e))throw"le: inputs have incompatible dimensions";return S(B(e),Q(e),function(n,r){return Vn(t[r],e[n][r])})}}else if(b(t)){if(E(e)||y(e))return S(B(t),Q(t),function(n,r){return Vn(t[n][r],e)});if(w(e)){if(Q(t)!==e.length)throw"le: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Vn(t[n][r],e[r])})}if(b(e)){if(B(t)!==B(e)||Q(t)!==Q(e))throw"le: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Vn(t[n][r],e[n][r])})}}return 0}function Gn(t,e){if(E(t)){if(E(e))return e<=t?1:0;if(y(e))return t>=String(e)?1:0;if(w(e))return e.map(function(n){return Gn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Gn(t,e[n][r])})}else if(W(t)){if(E(e))return String(t)>=e?1:0;if(W(e))return Ln(t,e)?1:0;if(o(e))return Ln(e.re,t)&&G(e.im,O)?1:0;if(w(e))return e.map(function(n){return Gn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Gn(t,e[n][r])})}else if(o(t)){if(E(e))return String(t)>=e?1:0;if(W(e))return Ln(t.re,e)&&G(t.im,O)?1:0;if(o(e))return Ln(t.re,e.re)&&G(t.im,O)&&G(e.im,O)||Ln(t.im,e.im)&&G(t.re,O)&&G(e.re,O)?1:0;if(w(e))return e.map(function(n){return Gn(t,n)});if(b(e))return S(B(e),Q(e),function(n,r){return Gn(t,e[n][r])})}else if(w(t)){if(E(e)||y(e))return t.map(function(n){return Gn(n,e)});if(w(e)){if(t.length!==e.length)throw"ge: inputs have incompatible dimensions";return t.map(function(n,r){return Gn(n,e[r])})}if(b(e)){if(t.length!==Q(e))throw"ge: inputs have incompatible dimensions";return S(B(e),Q(e),function(n,r){return Gn(t[r],e[n][r])})}}else if(b(t)){if(E(e)||y(e))return S(B(t),Q(t),function(n,r){return Gn(t[n][r],e)});if(w(e)){if(Q(t)!==e.length)throw"ge: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Gn(t[n][r],e[r])})}if(b(e)){if(B(t)!==B(e)||Q(t)!==Q(e))throw"ge: inputs have incompatible dimensions";return S(B(t),Q(t),function(n,r){return Gn(t[n][r],e[n][r])})}}return 0}function Dn(n){return o(n)?n.sign():L.sign(n)}function J(n,r){return W(n)&&W(r)?D(n,r):o(n)&&y(r)?n.add(r):o(r)&&y(n)?r.add(n):s}function Hn(n,r){return W(n)&&W(r)?H(n,r):o(n)&&y(r)?n.sub(r):o(r)&&y(n)?r.neg().add(n):s}function Y(n,r){return W(n)&&W(r)?K(n,r):o(n)&&y(r)?n.mul(r):o(r)&&y(n)?r.mul(n):s}function nn(n,r){return W(n)&&W(r)?On(n,r):o(n)&&y(r)?n.div(r):o(r)&&y(n)?r.inv().mul(n):s}function Kn(n,r){return W(n)&&W(r)?$n(n,r):o(n)&&y(r)?n.pow(r):o(r)&&y(n)?new _(n,O).pow(r):s}function Jn(n){return W(n)?Fn(n):o(n)?n.neg():s}function Yn(n){return W(n)?n:o(n)?n.conj():s}function nr(n){return W(n)?G(n,O)?T:Wn(n):o(n)?G(n.abs(),O)?new _(T,Xn(n.im,O)?T:-T):n.inv():s}function rr(n){return W(n)?L.abs(n):o(n)?n.abs():s}function tr(n){return W(n)?Xn(n,O)?an.pi:O:o(n)?n.angle():s}function er(r,e){if(E(r)&&E(e))return r+e;if(y(r)&&y(e))return J(r,e);if(b(r)&&b(e)){if(B(r)===B(e)&&Q(r)===Q(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return er(n,t[r])})});throw"add: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return er(n,e[r])});throw"add: vector dimensions do not match"}return k(r)?r.map(function(n){return er(n,e)}):k(e)?e.map(function(n){return er(r,n)}):void v("add")}function ir(r,e){if(y(r)&&y(e))return Hn(r,e);if(b(r)&&b(e)){if(B(r)===B(e)&&Q(r)===Q(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return ir(n,t[r])})});throw"sub: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return ir(n,e[r])});throw"sub: vector dimensions do not match"}return k(r)?r.map(function(n){return ir(n,e)}):k(e)?e.map(function(n){return ir(r,n)}):void v("sub")}function ur(r,e){if(y(r)&&y(e))return Y(r,e);if(b(r)&&b(e)){if(B(r)===B(e)&&Q(r)===Q(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return ur(n,t[r])})});throw"dotmul: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return ur(n,e[r])});throw"dotmul: vector dimensions do not match"}return k(r)?r.map(function(n){return ur(n,e)}):k(e)?e.map(function(n){return ur(r,n)}):void v("dotmul")}function or(r,e){if(y(r)&&y(e))return nn(r,e);if(b(r)&&b(e)){if(B(r)===B(e)&&Q(r)===Q(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return or(n,t[r])})});throw"dotdiv: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return or(n,e[r])});throw"dotdiv: vector dimensions do not match"}return k(r)?r.map(function(n){return or(n,e)}):k(e)?e.map(function(n){return or(r,n)}):void v("dotdiv")}function fr(r,e){if(y(r)&&y(e))return Kn(r,e);if(b(r)&&b(e)){if(B(r)===B(e)&&Q(r)===Q(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return fr(n,t[r])})});throw"dotpow: matrix dimensions do not match"}if(w(r)&&w(e)){if(r.length===e.length)return r.map(function(n,r){return fr(n,e[r])});throw"dotpow: vector dimensions do not match"}return k(r)?r.map(function(n){return fr(n,e)}):k(e)?e.map(function(n){return fr(r,n)}):void v("dotpow")}function d(i,u){if(y(i)&&y(u))return Y(i,u);if(b(i)&&b(u)){if(Q(i)===B(u))return n=B(i),r=Q(u),o=B(u),S(n,r,function(n,r){for(var t=O,e=0;e<o;++e)t=J(t,Y(i[n][e],u[e][r]));return t});throw"mul: matrix-matrix dimensions do not match"}if(w(i)&&b(u)){if(i.length===B(u))return r=Q(u),o=i.length,S(n=1,r,function(n,r){for(var t=O,e=0;e<o;++e)t=J(t,Y(i[e],u[e][r]));return t});throw"mul: vector-matrix dimensions do not match"}if(b(i)&&w(u)){var o;if(Q(i)===u.length)return n=B(i),o=u.length,S(n,r=1,function(n,r){for(var t=O,e=0;e<o;++e)t=J(t,Y(i[n][e],u[e]));return t});throw"mul: matrix-vector dimensions do not match"}var n,r;return w(i)&&w(u)?S(n=i.length,r=u.length,function(n,r){return Y(i[n],u[r])}):k(i)?i.map(function(n){return d(n,u)}):k(u)?u.map(function(n){return d(i,n)}):void v("mul")}function cr(n,r){if(y(n)&&y(r))return Kn(n,r);if(b(n)&&B(n)===Q(n)&&p(r)){if((r=M(r))<0&&(r=-r,!(n=yt(n))||!n.length))throw"pow: no inverse";if(0===r)return zr(B(n));if(1===r)return n;if(2===r)return d(n,n);for(var t=zr(B(n));0!==r;)1&r&&(t=d(t,n)),0<(r>>=1)&&(n=d(n,n));return t}v("pow")}function ar(n){return y(n)?Jn(n):k(n)?n.map(ar):n}function lr(e,n=":",t=null){if(yn(e)){if(w(n)&&n.length===e.length&&et(n,function(n){return 0===M(n)||1===M(n)}))return o=1===(o=n.reduce(function(n,r,t){return 1===M(r)&&n.push(e[t]),n},[])).length?o[0]:o;if(":"===(n=y(n)?Sn(n,!0):n)||p(n)||w(n))return r=e.length,1===(o=(n=p(n=":"===n?Zr(1,r):n)?[n]:n).map(function(n){if((n=M(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[n-1]})).length?o[0]:o;throw"get: invalid range"}if(wn(e)){var i=B(e),u=Q(e),r=i*u;if(null==t&&b(n)&&B(n)===i&&Q(n)===u&&et(n,function(n){return 0===M(n)||1===M(n)})){for(var o=[],f=0;f<u;++f)for(var c=0;c<i;++c)1===M(n[c][f])&&o.push(e[c][f]);return o=1===o.length?o[0]:o}if(y(n)&&(n=Sn(n,!0)),y(t)&&(t=Sn(t,!0)),":"===n||p(n)||w(n)){if(p(n=":"===n?Zr(1,i):n)&&(n=[n]),null==t)return o=1===(o=n.map(function(n){if((n=M(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[(n-1)%i][I.floor((n-1)/i)]})).length?o[0]:o;if(":"===t||p(t)||w(t))return p(t=":"===t?Zr(1,u):t)&&(t=[t]),o=1===(o=n.map(function(r){if((r=M(r))<1&&(r+=i),r<1||i<r)throw"get: index out of bounds";return t.map(function(n){if((n=M(n))<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[r-1][n-1]})})).length&&1===o[0].length?o[0][0]:o}throw"get: invalid range"}return e}function sr(i,r=":",n=null,u=null){if(yn(i)){if(wn(u)&&(u=j(u,0)),w(r)&&r.length===i.length&&et(r,function(n){return 0===M(n)||1===M(n)})){if(vn(u))return r.forEach(function(n,r){1===M(n)&&(i[r]=u)}),i;if(k(u))return h=0,t=u.length,r.forEach(function(n,r){if(1===M(n)){if(t<=h)throw"set: index out of bounds";i[r]=u[h++]}}),i}if(":"===(r=y(r)?Sn(r,!0):r)||p(r)||w(r)){var e=i.length;if(p(r=":"===r?Zr(1,e):r)&&(r=[r]),vn(u))return r.forEach(function(n){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u}),i;if(k(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u[r]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(wn(i)){var o,f,t,c,a,l,s,h,m=B(i),g=Q(i),e=m*g;if(b(r)&&B(r)===m&&Q(r)===g&&et(r,function(n){return 0===M(n)||1===M(n)})){if(vn(u))return r.forEach(function(n,t){n.forEach(function(n,r){1===M(n)&&(i[t][r]=u)})}),i;if(wn(u)){for(o=B(u),f=Q(u),s=a=0;a<g;++a,++s){if(1===f)s=0;else if(f<=s)throw"set: index out of bounds";for(l=c=0;c<m;++c,++l)if(1===M(r[c][a])){if(1===o)l=0;else if(o<=l)throw"set: index out of bounds";i[c][a]=u[l][s]}}return i}if(k(u)){for(t=u.length,a=h=0;a<g;++a)for(c=0;c<m;++c)if(1===M(r[c][a])){if(t<=h)throw"set: index out of bounds";i[c][a]=u[h++]}return i}}if(y(r)&&(r=Sn(r,!0)),y(n)&&(n=Sn(n,!0)),":"===r||p(r)||w(r)){if(null==n){if(p(r=":"===r?Zr(1,e):r)&&(r=[r]),vn(u))return r.forEach(function(n){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][I.floor((n-1)/m)]=u}),i;if(wn(u))return o=B(u),f=Q(u),r.forEach(function(n,r){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";var t=1===o?0:r%m,r=1===f?0:I.floor(r/m);if(o<=t||f<=r)throw"set: index out of bounds";i[(n-1)%m][I.floor((n-1)/m)]=u[t][r]}),i;if(k(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=M(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][I.floor((n-1)/m)]=u[r]}),i}else if(":"===n||p(n)||w(n)){if(p(r=":"===r?Zr(1,m):r)&&(r=[r]),p(n=":"===n?Zr(1,g):n)&&(n=[n]),vn(u))return r.forEach(function(r){if((r=M(r))<1&&(r+=m),r<1||m<r)throw"set: index out of bounds";n.forEach(function(n){if((n=M(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";i[r-1][n-1]=u})}),i;if(wn(u))return o=B(u),f=Q(u),r.forEach(function(t,e){if((t=M(t))<1&&(t+=m),t<1||m<t)throw"set: index out of bounds";if(1===o)e=0;else if(o<=e)throw"set: index out of bounds";n.forEach(function(n,r){if((n=M(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";if(1===f)r=0;else if(f<=r)throw"set: index out of bounds";i[t-1][n-1]=u[e][r]})}),i;if(k(u)&&u.length>=r.length*n.length)return h=0,n.forEach(function(t,n){if((t=M(t))<1&&(t+=g),t<1||g<t)throw"set: index out of bounds";r.forEach(function(n,r){if((n=M(n))<1&&(n+=m),n<1||m<n)throw"set: index out of bounds";i[n-1][t-1]=u[h++]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function hr(n,r){var t,e,i;return u(n)&&u(r)?(t=n,e=r,t=I.abs(t),e=I.abs(e),(i=0)===t?e:0===e?t:e<t?t*I.sqrt(1+(i=e/t)*i):t<e?e*I.sqrt(1+(i=t/e)*i):t*I.SQRT2):L.sqrt(D(K(n,n),K(r,r)))}function mr(){var n,r,t,e=0,i=0;if(u(mr.z1))return t=mr.z1,mr.z1=null,t;for(;0===e||1===e;)e=I.random();for(;0===i||1===i;)i=I.random();return r=(n=I.sqrt(-2*I.log(e)))*I.cos(2*R*i),t=n*I.sin(2*R*i),mr.z1=t,r}function gr(n,r){var t,n=1===arguments.length?n:ir(n,r);return n.reduce(function(n,r){return n&&(u(r)||o(r)&&u(r.re)&&u(r.im))},!0)?(t=0,r=(r=n).map(function(n){return n=rr(n),t<n&&(t=n),n}),0===t?0:t*I.sqrt(r.reduce(function(n,r){return r===t?n+1:n+(n=r/t)*n},0))):L.sqrt(jr(Hr(n,n)))}function pr(n,r){n=1===arguments.length?n:ir(n,r);return jr(Hr(n,n))}function dr(n,r,t){n=or(ir(n,r),t);return jr(Hr(n,n))}function vr(n,r,t){n=ir(n,r);return jr(Hr(N(d(n,t)),n))}function yr(n,r,t){return G(t=2===arguments.length?r:t,$)?2===arguments.length?br(n):br(n,r):G(t,F)?2===arguments.length?gr(n):gr(n,r):gn(t)?2===arguments.length?wr(n):wr(n,r):Kn(Gr(fr(Rr(2===arguments.length?n:ir(n,r)),t)),Wn(t))}function wr(n,r){return Vr(Rr(1===arguments.length?n:ir(n,r)))}function br(n,r){return Gr(Rr(1===arguments.length?n:ir(n,r)))}function xr(n,r){return Hn($,nn(nn(Hr(n,r),L.sqrt(jr(Hr(n,n)))),L.sqrt(jr(Hr(r,r)))))}function kr(n,r){return xr(ir(n,$t(n)),ir(r,$t(r)))}function Sr(n,e){return V(n.reduce(function(n,r,t){return n+1-P(r,e[t])},0)/n.length)}function Ar(n,e){return V(1-n.reduce(function(n,r,t){return n+P(r,e[t])},0)/n.length)}function _r(n,r){for(var t,e,i=n.length,u=n.map(function(n,r){return[n,r]}).sort(function(n,r){return P(n[0],r[0])?n[1]-r[1]:Bn(n[0],r[0])?-1:1}),o=new Array(i),f=0;f<i;){for(e=1,t=f;t+e<i&&P(u[t][0],u[t+e][0]);)++e;for(;t<f+e;)o[u[t][1]]=mn(u[t][0])?s:V(r?(2*f<=i?f+1:i-f)+(1<e?1/e:0):f+1+(1<e?1/e:0)),++t;f=t}return o}function Ir(n,r){var t=n.length;return 1<t?nn(Gr(ur(or(ir(n,$t(n)),Ct(n)),or(ir(r,$t(r)),Ct(r)))),V(t-1)):$}function qr(n,r){return Ir(_r(n),_r(r))}function Er(n,r){if(1<n.length){for(var t,e=n.length,i=O,u=0;u<e;++u)for(t=u+1;t<e;++t)i=J(i,Y(Dn(Hn(n[u],n[t])),Dn(Hn(r[u],r[t]))));return nn(nn(Y(i,F),e),e-1)}return $}function Nr(){if(!ln(this,Nr))return new Nr;this.data=[]}function jr(n){return qn(function(n){return o(n)?n.re:n},n,!0)}function Mr(n){return qn(function(n){return o(n)?n.im:0},n,!0)}function Pr(n){return qn(Yn,n,!0)}function Rr(n){return qn(rr,n,!0)}function Tr(n,r){if(gn(r=null==r?F:r)){if(y(n=N(n)))return rr(n);if(w(n))return(Xn(r,O)?Qr:Vr)(Rr(n));if(b(n)&&zn(r,O))return Vr(Gr(Rr(Or(n))))}else if(W(r)){if(n=N(n),G(r,$)){if(y(n))return rr(n);if(w(n))return Gr(Rr(n));if(b(n))return Vr(Gr(Rr(n)))}else if(G(r,F)){if(y(n))return rr(n);if(w(n))return gr(n);if(b(n))return Vr(Mt(n,null,!1,!1))}else if(zn(r,O)){if(y(n))return rr(n);if(w(n))return yr(n,r)}}else if("fro"===r&&b(n))return L.sqrt(kt(jr(d($r(n),n))));v("norm")}function Xr(n,r){return w(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),O)}function zr(n,t){return null==t&&(t=$),S(M(n=Sn(n=null==n?1:n,!0)),M(n),function(n,r){return n===r?t:O})}function Zr(n,r,t){if(1===arguments.length&&k(n)){if(wn(n)){for(var e,i=B(n),u=Q(n),o=new Array(u*i),f=0,c=0;c<u;++c)for(e=0;e<i;++e)o[f++]=n[e][c];return o}return n}if(null!=t&&null!=r||(null!=r?(t=r,r=$):(t=n,n=r=$)),n=Sn(n,!0),r=Sn(r,!0),t=Sn(t,!0),o=[],zn(r,O))for(;Zn(n,t);n=D(n,r))o.push(n);else if(Xn(r,O))for(;Ln(n,t);n=D(n,r))o.push(n);return o}function Lr(n,r,t){if("horz"===n){if(yn(r)&&yn(t))return r.concat(t);if(wn(r)&&wn(t)&&B(r)===B(t))return r.map(function(n,r){return n.concat(t[r])})}if("vert"===n){if(yn(r)&&yn(t))return r.concat(t);if(wn(r)&&wn(t)&&Q(r)===Q(t))return r.concat(t)}v("cat")}function Or(t){return wn(t)?S(Q(t),B(t),function(n,r){return t[r][n]}):t}function $r(t){return wn(t)?S(Q(t),B(t),function(n,r){return y(t[r][n])?Yn(t[r][n]):t[r][n]}):yn(t)?t.map(function(n){return y(n)?Yn(n):n}):y(t)?Yn(t):t}function Cr(t,i){return i=M(i||0),vn(t)?[[t]]:yn(t)?S(t.length,t.length,function(n,r){return i===n-r?t[n]:O}):wn(t)?t.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i===e-t&&n.push(r),n},n)},[]):void v("diag")}function Fr(t,n){var e,i;return vn(t)?t:yn(t)?t.slice().reverse():wn(t)?(e=B(t),i=Q(t),1===(n=M(n=null==n?1:n))?S(e,i,function(n,r){return t[e-1-n][r]}):2===n?S(e,i,function(n,r){return t[n][i-1-r]}):t):void v("flip")}function Wr(n,r){var t=jr(n),e=jr(r),n=Mr(n),r=Mr(r),t=Xn(t,e)?-1:zn(t,e)?1:0,e=Xn(n,r)?-1:zn(n,r)?1:0;return t||e}function Ur(n,r){var t=rr(n),e=rr(r),n=tr(n),r=tr(r),t=Xn(t,e)?-1:zn(t,e)?1:0,e=Xn(n,r)?-1:zn(n,r)?1:0;return t||e}function Br(r,t,e,i,n){var u;if(vn(r))return r;if(w(r))return null==i&&(i=dn(r)?Wr:Ur),u=r.map(function(n,r){return{v:n,i:r}}).sort("descend"===e?function(n,r){return i(r.v,n.v)||n.i-r.i}:function(n,r){return i(n.v,r.v)||n.i-r.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(b(r)){if(1===t)return n?(u=U(Q(r),function(n){n=j(r,n);return Br(n,t,e,null==i?dn(n)?Wr:Ur:i,!0)}),[S(B(r),Q(r),function(n,r){return u[r][0][n]}),S(B(r),Q(r),function(n,r){return u[r][1][n]})]):(u=U(Q(r),function(n){n=j(r,n);return Br(n,t,e,null==i?dn(n)?Wr:Ur:i,!1)}),S(B(r),Q(r),function(n,r){return u[r][n]}));if(2===t)return n?(u=U(B(r),function(n){n=r[n];return Br(n,t,e,null==i?dn(n)?Wr:Ur:i,!0)}),[S(B(r),Q(r),function(n,r){return u[n][0][r]}),S(B(r),Q(r),function(n,r){return u[n][1][r]})]):(u=U(B(r),function(n){n=r[n];return Br(n,t,e,null==i?dn(n)?Wr:Ur:i,!1)}),S(B(r),Q(r),function(n,r){return u[n][r]}))}v("sort")}function Qr(r){return y(r=N(r))?r:w(r)?r.reduce(function(n,r){return n=Xn(r,n)?r:n},T):b(r)?U(Q(r),function(n){return Qr(j(r,n))}):s}function Vr(r){return y(r=N(r))?r:w(r)?r.reduce(function(n,r){return n=zn(r,n)?r:n},-T):b(r)?U(Q(r),function(n){return Vr(j(r,n))}):s}function Gr(r,n){if(y(r=N(r)))return r;if(w(r))return r.reduce(J,O);if(b(r)){if(1===(n=M(n=null==n?1:n)))return U(Q(r),function(n){return Gr(j(r,n))});if(2===n)return U(B(r),function(n){return Gr(r[n])})}return s}function Dr(r,n){if(y(r=N(r)))return r;if(w(r))return r.reduce(Y,$);if(b(r)){if(1===(n=M(n=null==n?1:n)))return U(Q(r),function(n){return Dr(j(r,n))});if(2===n)return U(B(r),function(n){return Dr(r[n])})}return s}function Hr(r,e,i){if(i=!0===i,r=N(r),e=N(e),y(r)&&y(e))return Y(r,i?e:Yn(e));if(w(r)&&w(e)){if(r.length===e.length)return r.reduce(function(n,r,t){return J(n,Y(r,i?e[t]:Yn(e[t])))},0)}else if(b(r)&&b(e)&&B(r)===B(e)&&Q(r)===Q(e))return U(Q(r),function(n){return Hr(j(r,n),j(e,n),i)});return 0}function Kr(t,e){var n,r,i,u;if(b(t)){if(b(e))return n=B(t),r=Q(t),i=B(e),u=Q(e),S(n*i,r*u,function(n,r){return d(t[I.floor(n/i)][I.floor(r/u)],e[n%i][r%u])});if(w(e))return n=B(t),r=Q(t),i=1,u=e.length,S(n*i,r*u,function(n,r){return d(t[n][I.floor(r/u)],e[r%u])})}else if(w(t)){if(w(e))return S(t.length,e.length,function(n,r){return d(t[n],e[r])});if(b(e))return n=t.length,i=B(e),u=Q(e),S(n*i,(r=1)*u,function(n,r){return d(t[I.floor(n/i)],e[n%i][r%u])})}return d(t,e)}function Jr(r,t,n){if(w(t)){var e,i,u;if(null==r||y(r)){for(null==r&&(r=$),e=0,i=t.length-1,u=O;e<i;++e)u=J(u,Y(r,nn(J(t[e+1],t[e]),F)));return u}if(w(r)&&r.length===t.length){for(e=0,i=r.length-1,u=O;e<i;++e)u=J(u,Y(rr(Hn(r[e+1],r[e])),nn(J(t[e+1],t[e]),F)));return u}}else if(b(t))if(1===(n=M(n=null==n?1:n))){if(null==r||y(r)||w(r)&&r.length===B(t))return U(Q(t),function(n){return Jr(r,j(t,n))});if(b(r)&&B(r)===B(t)&&Q(r)===Q(t))return U(Q(t),function(n){return Jr(null==r?null:j(r,n),j(t,n))})}else if(2===n){if(null==r||y(r)||w(r)&&r.length===Q(t))return U(B(r),function(n){return Jr(r,t[n])});if(b(r)&&B(r)===B(t)&&Q(r)===Q(t))return U(B(r),function(n){return Jr(r[n],t[n])})}v("trapz")}function Yr(r,t,e,i){var u;if(y(r))return r;if(w(r)){if("reverse"===(e=null==e?"forward":e))return r.slice().reverse().map(function(n,r){return u=0===r?n:t(u,n)}).reverse();if("forward"===e)return r.map(function(n,r){return u=0===r?n:t(u,n)})}else if(b(r)){if(1===(i=M(i=null==i?1:i)))return U(Q(r),function(n){return Yr(j(r,n),t,e,i)});if(2===i)return U(B(r),function(n){return Yr(r[n],t,e,i)})}return!1}function nt(r,t,e,i,u){var o;if(w(r))return U(o=r.length,function(n){return t(r.slice(I.max(0,n-e),I.min(o-1,n+i)+1))});if(b(r)){if(1===(u=M(u=null==u?1:u)))return U(Q(r),function(n){return nt(j(r,n),t,e,i,u)});if(2===u)return U(B(r),function(n){return nt(r[n],t,e,i,u)})}return!1}function rt(n){var r,t,e=[].slice.call(arguments,1);return k(e[0])&&(e=N(e[0])),vn(n)?(r=[1,1],e.length?e.map(function(n){return r[M(n)-1]}):r):yn(n)?(r=[1,n.length],e.length?e.map(function(n){return r[M(n)-1]}):r):k(t=n)&&k(t[0])&&k(t[0][0])?(r=[n.length].concat(rt(n[0])),e.length?e.map(function(n){return r[M(n)-1]}):r):wn(n)?(r=[B(n),Q(n)],e.length?e.map(function(n){return r[M(n)-1]}):r):[]}function tt(n,i){var u;return w(n)?n.reduce(function(n,r,t){return i(r,t+1,1)&&n.push(t+1),n},[]):b(n)?(u=B(n),n.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i(r,e+1,t+1)&&n.push(e+u*t+1),n},n)},[])):[]}function et(n,r){if(y(n))return r(n,1,1)?1:0;if(w(n)){for(var t=0,e=n.length;t<e;++t)if(!r(n[t],t+1,1))return 0;return 1}if(b(n)){for(var t=0,i=B(n),u=Q(n);t<i;++t)for(var o=0;o<u;++o)if(!r(n[t][o],t+1,o+1))return 0;return 1}return 0}function it(n,r){if(y(n))return r(n,1,1)?1:0;if(w(n)){for(var t=0,e=n.length;t<e;++t)if(r(n[t],t+1,1))return 1}else if(b(n))for(var t=0,i=B(n),u=Q(n);t<i;++t)for(var o=0;o<u;++o)if(r(n[t][o],t+1,o+1))return 1;return 0}function ut(n,r,t){if(E(n)&&E(r))return n===r?1:0;if(mn(n)&&mn(r))return t?1:0;if(y(n)&&y(r))return P(n,r)?1:0;if(k(n)&&k(r)){if(n.length!==r.length)return 0;for(var e=0,i=n.length;e<i;++e)if(!ut(n[e],r[e],t))return 0;return 1}return 0}function ot(n,r,t){var e;r!==t&&(e=n[r],n[r]=n[t],n[t]=e)}function ft(n,r,t,e,i,u){var o,f=n[0].length;for(null==e&&(e=$),null==i&&(i=$),o=u||0;o<f;++o)n[r][o]=J(Y(i,n[r][o]),Y(e,n[t][o]))}function ct(n,r,t,e,i,u,o){for(var f,c,a=n[0].length,l=0;l<a;++l)f=n[r][l],c=n[t][l],n[r][l]=J(Y(e,f),Y(i,c)),n[t][l]=J(Y(u,f),Y(o,c))}function at(n,r,t,e,i,u,o){for(var f,c,a=n.length,l=0;l<a;++l)f=n[l][r],c=n[l][t],n[l][r]=J(Y(e,f),Y(u,c)),n[l][t]=J(Y(i,f),Y(o,c))}function lt(t,e,i,n,r){var u=B(t),o=Q(t);return u&&o?k(e)&&k(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<o}),S(e.length,i.length,function(n,r){return t[e[n]][i[r]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=o),(n=null==n?u-1:n)<0&&(n+=u),(r=null==r?o-1:r)<0&&(r+=o),e=I.max(0,I.min(u-1,e)),n=I.max(0,I.min(u-1,n)),i=I.max(0,I.min(o-1,i)),r=I.max(0,I.min(o-1,r)),e<=n&&i<=r?S(n-e+1,r-i+1,function(n,r){return t[e+n][i+r]}):[]):[]}function st(t,e,n){var i=B(t),u=Q(t),o=B(e),f=Q(e);return"vert"===(n=n||"horz")?S(i+o,I.max(u,f),function(n,r){return u<=r?n<i?O:e[n-i][r]:f<=r?n<i?t[n][r]:O:(n<i?t[n]:e[n-i])[r]}):S(I.max(i,o),u+f,function(n,r){return i<=n?r<u?O:e[n][r-u]:o<=n?r<u?t[n][r]:O:r<u?t[n][r]:e[n][r-u]})}function ht(n,r,t,e){var i,u,o,f=B(n),c=Q(n);if(!1===t||f===c){for(e=V(e||0),i=I.min(f,c),u=0;u<i;++u){if("lower"===r||"diagonal"===r)for(o=u+1;o<i;++o)if(!Vn(rr(n[u][o]),e))return;if("upper"===r||"diagonal"===r)for(o=0;o<u;++o)if(!Vn(rr(n[u][o]),e))return}if(c<f){for(u=i;u<f;++u)for(o=0;o<c;++o)if(!Vn(rr(n[u][o]),e))return}else if(f<c)for(o=i;o<c;++o)for(u=0;u<f;++u)if(!Vn(rr(n[u][o]),e))return;return 1}}function mt(n,r){var t,e,i;return P(r,O)?(t=$,e=O):P(n,O)?(t=O,P(e=Dn(Yn(r)),O)&&(e=$)):(i=Dn(n),t=nn(n=rr(n),n=hr(n,rr(r))),e=nn(Y(i,Yn(r)),n)),[t,e]}function gt(n,r,t,e,i){var u,o,f,c,a=B(i),l=In(i),s=2===r.length&&y(r[0])?(o=r[0],f=Jn(r[1]),c=r[1],r[0]):2===r.length&&2===r[0].length?(o=r[0][0],f=r[0][1],c=r[1][0],r[1][1]):(o=r[t][t],f=r[t][e],c=r[e][t],r[e][e]);if("right"===n)for(u=0;u<a;++u)l[u][t]=J(Y(o,i[u][t]),Y(c,i[u][e])),l[u][e]=J(Y(f,i[u][t]),Y(s,i[u][e]));else for(u=0;u<a;++u)l[t][u]=J(Y(o,i[t][u]),Y(f,i[e][u])),l[e][u]=J(Y(c,i[t][u]),Y(s,i[e][u]));return l}c.decimal=function(n){"function"==typeof n?(A=n,on.call(A.prototype,"_valueof")||(A.prototype._valueof=null,A.prototype.$valueOf=function(){return null==this._valueof&&(this._valueof=parseFloat(this.toFixed(9))),this._valueof},A.prototype.sign=function(){return A.sign(this)}),O=A(0),$=A(1),Z=A(-1),tn=A(.5),F=A(2),en=A(10),a=A(I.log(10)),l=A(I.log(2)),an.eps=A(rn),an.pi=A(R),an.e=A(f),an.realmax=A(h),an.realmin=A(m),an.intmax=A(g),an.intmin=A(X),an.bitmax=A(z)):(A=null,O=0,Z=-($=1),tn=.5,F=2,en=10,l=I.log(2),a=I.log(10),an.eps=rn,an.pi=R,an.e=f,an.realmax=h,an.realmin=m,an.intmax=g,an.intmin=X,an.bitmax=z),_&&(e=new _(O,$),t=new _(an.e,O)),un.forEach(function(n){n()})},c.is_array=k,c.is_obj=hn,c.is_string=E,c.is_nan=mn,c.is_inf=gn,c.is_number=u,c.is_decimal=pn,c.is_int=p,c.is_complex=o,c.is_real=dn,c.is_scalar=y,c.is_vector=w,c.is_matrix=b,c.array=U,c.matrix=S,c.ndarray=bn,q.rowvec=xn,q.colvec=kn,c.sca=Sn,c.vec=N,c.tonumber=An,c.todecimal=_n,c.copy=In,c.apply=qn,c.apply2=En,c.exist=function(n,r){return hn(r)&&E(n)&&on.call(r,n)?1:0},c.varargout=Nn,c.num2str=jn,c.MAXPRINTSIZE=T,c.tex=function(n){return k(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(Mn).join("\\]\n\\[")+"\\]":k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?"\\["+n.map(Mn).join("\\]\n\\[")+"\\]":"\\["+Mn(n)+"\\]":"\\["+(n=n.length>c.MAXPRINTSIZE?n.slice(0,I.round(c.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-I.round(c.MAXPRINTSIZE/2))):n).map(Mn).join("\\]\n\\[")+"\\]":"":(n=Mn(n)).length&&(n="\\["+n+"\\]"),n},c.str=function(n){return n=k(n)?n.length?n.$scilitevarargout$?n.map(Pn).join("\n\n"):k(n[0])?k(n[0][0])||!k(n[1])||n[0].length!==n[1].length?n.map(Pn).join("\n\n"):Pn(n):(n=n.length>c.MAXPRINTSIZE?n.slice(0,I.round(c.MAXPRINTSIZE/2)).concat(":").concat(n.slice(1-I.round(c.MAXPRINTSIZE/2))):n).map(Pn).join("\n"):"":Pn(n)},c.neq=G,c.nlt=Xn,c.ngt=zn,c.nle=Zn,c.nge=Ln,c.nadd=D,c.nsub=H,c.nmul=K,c.ndiv=On,c.npow=$n,c.nmod=Cn,c.nneg=Fn,c.ninv=Wn,c.eq=P,c.ne=Un,c.lt=Bn,c.gt=Qn,c.le=Vn,c.ge=Gn,c.ssign=Dn,c.sadd=J,c.ssub=Hn,c.smul=Y,c.sdiv=nn,c.spow=Kn,c.sneg=Jn,c.sconj=Yn,c.sinv=nr,c.sabs=rr,c.sangle=tr,c.add=er,c.sub=ir,c.dotmul=ur,q.times=ur,c.dotdiv=or,c.dotpow=fr,q.power=fr,c.mul=d,c.pow=cr,q.mpower=cr,c.neg=ar,c.get=lr,c.set=sr,c.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],Nr.prototype={constructor:Nr,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,option:function(n,r,t,e){var i,u,o,f={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},c={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},a={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},l=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:a[l[(e||0)%l.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=a[l[(e||0)%l.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=f["-"]),n._LineStyle||(n._LineStyle="-"),t=t||0;t<r.length;){if("Color"===r[t])E(i=r[t+1])?on.call(c,i)?n.Color=a[c[i]]:on.call(a,i)&&(n.Color=a[i]):w(i)&&3===i.length&&(n.Color=An(i));else if("LineWidth"===r[t])W(i=r[t+1])&&(n.LineWidth=2*An(i));else{if("LineStyle"!==r[t]){if(E(r[t])){for(u in o=!1,i=r[t],a)-1<i.indexOf(u)&&(n.Color=a[u],o=!0);for(u in f)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=f[u],o=!0);if(o){t+=1;continue}}break}E(i=r[t+1])&&on.call(f,i)&&(n._LineStyle=i,n.LineStyle=f[i])}t+=2}return t},parse:function(n,r,t){var e,i,u,o,f,c,a,l=this,s=0,h=0;if("pie"===r)for(;s<n.length;)w(u=N(n[s]))&&l.data.push({y:An(u)}),s+=1;else if("plot3"===r)for(;s<n.length;)c=f=o=null,w(u=N(n[s]))&&(o=u),w(u=N(n[s+1]))&&(f=u),w(u=N(n[s+2]))&&(c=u,s+=3),o&&f&&c?(s=l.option(a={},n,s,h),l.data.push({x:An(o),y:An(f),z:An(c),style:a}),++h):s+=1;else for(;s<n.length;)if(f=o=null,w(u=N(n[s]))&&(o=u),w(n[s+1])||b(n[s+1])?(f=N(n[s+1]),s+=2):o&&(o=Zr(1,(f=o).length),s+=1),o&&f)if(o=An(o),s=l.option(a={},n,s,h),b(f))for(e=0,i=Q(f);e<i;++e)l.data.push({x:o,y:An(j(f,e)),style:a}),a=l.option(a,n,s,++h);else l.data.push({x:o,y:An(f),style:a}),++h;else s+=1;return l}},c.figure=Nr,c.createCanvas=function(n,r){},c.currentCanvas=function(){},q.clc=r,q.disp=r,q.clear=r,q.help=r,q.who=r,q.whos=r,q.exist=r,["floor","ceil","round","sign","abs","exp","log","log10","log2","sqrt","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){L[r]="log"===r?function(n){return u(n)?I.log(n):n.ln()}:"log10"===r?function(n){return u(n)?I.log10(n):n.log(en)}:"log2"===r?function(n){return u(n)?I.log2(n):n.log(F)}:function(n){return u(n)?I[r](n):n[r]()}}),L.atan2=function(n,r){return G(O,r)&&G(O,n)?O:(u(n)&&u(r)?I:A).atan2(n,r)},L.fix=function(n){return Xn(n,O)?L.ceil(n):L.floor(n)},c.realMath=L,(_=function n(r,t,e){var i=this;if(!ln(i,n))return new n(r,t,e);o(r)?(i.re=r.re,i.im=r.im):(t=t||O,"polar"===e?(i._rho=L.abs(r),i.re=K(i._rho,L.cos(t)),i.im=K(i._rho,L.sin(t))):(i.re=r,i.im=t))}).prototype={constructor:_,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var r=this;return null==r._rho&&(r._rho=hr(r.re,r.im)),r._rho},norm2:function(){return null==this._rho2&&(this._rho2=$n(this.abs(),F)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=L.atan2(n.im,n.re)),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=G(n.im,O)?L.sign(n.re):n.div(n.abs()),o(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return W(n)?new _(D(this.re,n),this.im):new _(D(this.re,n.re),D(this.im,n.im))},sub:function(n){return W(n)?new _(H(this.re,n),this.im):new _(H(this.re,n.re),H(this.im,n.im))},mul:function(n){var r,t,e,i=this;return W(n)?new _(G(i.re,O)?O:K(i.re,n),G(i.im,O)?O:K(i.im,n)):(r=i.re,e=n.re,i=i.im,t=K(r,D(e,n=n.im)),n=K(n,D(r,i)),e=K(e,H(i,r)),new _(H(t,n),D(t,e)))},div:function(n){var r,t,e,i=this;return W(n)?new _(G(i.re,O)?O:On(i.re,n),G(i.im,O)?O:On(i.im,n)):(t=n.norm2(),r=i.re,e=On(n.re,t),i=i.im,t=K(r,D(e,n=Fn(On(n.im,t)))),n=K(n,D(r,i)),e=K(e,H(i,r)),new _(H(t,n),D(t,e)))},pow:function(n){var r,t;return mn(n)?s:W(n)?new _($n(this.abs(),n),K(this.angle(),n),"polar"):o(n)?(r=this.abs(),t=this.angle(),new _($n(r,n.re),K(n.im,L.log(r)),"polar").mul(new _(L.exp(Fn(K(n.im,t))),K(t,n.re),"polar"))):void 0},neg:function(){return new _(Fn(this.re),Fn(this.im))},conj:function(){return new _(this.re,Fn(this.im))},inv:function(){var n=this.norm2();return new _(On(this.re,n),Fn(On(this.im,n)))},toString:function(){var n=this;return null==n._str&&(n._str=jn(n.re)+(Xn(n.im,O)?" - ":" + ")+jn(L.abs(n.im))+"i"),n._str},valueOf:function(){return M(this.re)}},e=new _(O,$),t=new _(an.e,O),i={floor:function(n){return new _(L.floor(n.re),L.floor(n.im))},ceil:function(n){return new _(L.ceil(n.re),L.ceil(n.im))},round:function(n){return new _(L.round(n.re),L.round(n.im))},fix:function(n){return new _(L.fix(n.re),L.fix(n.im))},sign:function(n){return n.sign()},sqrt:function(n){return n.pow(new _(tn,O))},exp:function(n){return t.pow(n)},log:function(n){return new _(L.log(n.abs()),n.angle())},log10:function(n){return i.log(n).div(a)},log2:function(n){return i.log(n).div(l)},sin:function(n){return new _(K(L.sin(n.re),L.cosh(n.im)),K(L.cos(n.re),L.sinh(n.im)))},cos:function(n){return new _(K(L.cos(n.re),L.cosh(n.im)),Fn(K(L.sin(n.re),L.sinh(n.im))))},tan:function(n){return i.sin(n).div(i.cos(n))},sinh:function(n){return new _(K(L.sinh(n.re),L.cos(n.im)),K(L.cosh(n.re),L.sin(n.im)))},cosh:function(n){return new _(K(L.cosh(n.re),L.cos(n.im)),K(L.sinh(n.re),L.sin(n.im)))},tanh:function(n){return i.sinh(n).div(i.cosh(n))},asin:function(n){return e.neg().mul(i.log(e.mul(n).add(i.sqrt(_($,O).sub(n.pow(F))))))},acos:function(n){return e.neg().mul(i.log(n.add(e.mul(i.sqrt(_($,O).sub(n.pow(F)))))))},atan:function(n){return e.div(F).mul(i.log(e.add(n).div(e.sub(n))))},asinh:function(n){return i.log(n.add(i.sqrt(n.pow(F).add($))))},acosh:function(n){return i.log(n.add(i.sqrt(n.pow(F).sub($))))},atanh:function(n){return i.log(n.add($).div(n.neg().add($))).div(F)}},c.complexMath=i,q.complex=_,["floor","ceil","round","fix","sign","exp","log","log10","log2","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){q[r]=i[r]?function(n){return qn(function(n){return(o(n)?i:L)[r](n)},n,!0)}:function(n){return qn(function(n){return L[r](n)},n,!1)}}),q.atan2=function(n,r){return En(function(n,r){return L.atan2(n,r)},n,r,!1)},q.sqrt=function(n){return qn(function(n){return o(n)?i.sqrt(n):zn(O,n)?new _(O,L.sqrt(Fn(n))):L.sqrt(n)},n,!0)},["sqrt","pow","log"].forEach(function(r){q["real"+r]=function(n){return qn(function(n){o(n=Rn(n))&&v("real"+r);n=L[r](n);return mn(n)||!dn(n)?v("real"+r):n},n,!0)}}),q.real=jr,q.imag=Mr,q.conj=Pr,q.abs=Rr,q.angle=function(n){return qn(tr,n,!0)},q.norm=Tr,q.zeros=function(n,r){return Xr(q.fix(n),y(r)?q.fix(r):r)},q.ones=function(n,r){return n=q.fix(n),r=y(r)?q.fix(r):r,w(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),$)},q.eye=function(n){return zr(q.fix(n),$)},q.rand=function(n,r){return n=q.fix(n),r=y(r)?q.fix(r):r,null==n?V(I.random()):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),function(){return V(I.random())}))},q.randi=function(n,r,t){return e=q.fix(n),n=q.fix(r),r=y(t)?q.fix(t):t,e=M(e),null==n&&null==r?V(I.ceil(I.random()*e)):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),function(){return V(I.ceil(I.random()*e))}));var e},q.randn=function(n,r){return n=q.fix(n),r=y(r)?q.fix(r):r,null==n?V(mr()):(w(n)&&(r=n[1],n=n[0]),null==r&&(r=n),S(M(n),M(r),function(){return V(mr())}))},q.magic=function(n){var t;return n=p(n=Sn(q.fix(n),!0))?M(n):null,!p(n)||n<=2?1===n?[[$]]:[]:(t=function n(e){var t,i,r,u,o,f,c,a=1&e,l=0==(3&e),s=e*e,h=e-a>>1;if(a)return S(e,e,function(n,r){var t=(n+1+r+1+(e-3)/2)%e;return t<0&&(t+=e),(n=(n+1+2*(r+1)-2)%e)<0&&(n+=e),e*t+n+1});if(l)return i=0,S(e,e,function(n,r){return++i,(n+1&3)>>1==(r+1&3)>>1?s-(i-1):i});if(t=h*h,f=n(h),c=S(e,e,function(n,r){return n<h?r<h?f[n][r]:f[n][r-h]+2*t:r<h?n<h?f[n][r]:f[n-h][r]+3*t:f[n-h][r-h]+t}),1<(i=(h-1)/2))for(r=1;r<=h;++r){for(u=2;u<=i;++u)o=c[r-1][u-1],c[r-1][u-1]=c[r+h-1][u-1],c[r+h-1][u-1]=o;for(u=e-i+2;u<=e;++u)o=c[r-1][u-1],c[r-1][u-1]=c[r+h-1][u-1],c[r+h-1][u-1]=o}for(r=1;r<=i;++r)o=c[r-1][0],c[r-1][0]=c[r+h-1][0],c[r+h-1][0]=o;for(r=i+2;r<=h;++r)o=c[r-1][0],c[r-1][0]=c[r+h-1][0],c[r+h-1][0]=o;return o=c[i][i-1],c[i][i-1]=c[i+h][i-1],c[i+h][i-1]=o,c}(n),S(n,n,function(n,r){return V(t[n][r])}))},q.pascal=function(n){var t,r;return 1<arguments.length&&v("pascal"),n=p(n=q.fix(Sn(n,!0)))?M(n):null,!p(n)||n<=0?[]:(t=S(r=n,r,function(n,r,t){return 0===n||0===r?1:t[n-1][r]+t[n][r-1]}),S(n,n,function(n,r){return V(t[n][r])}))},q.rosser=function(){return[[V(611),V(196),V(-192),V(407),V(-8),V(-52),V(-49),V(29)],[V(196),V(899),V(113),V(-192),V(-71),V(-43),V(-8),V(-44)],[V(-192),V(113),V(899),V(196),V(61),V(49),V(8),V(52)],[V(407),V(-192),V(196),V(611),V(8),V(44),V(59),V(-23)],[V(-8),V(-71),V(61),V(8),V(411),V(-599),V(208),V(208)],[V(-52),V(-43),V(49),V(44),V(-599),V(411),V(208),V(208)],[V(-49),V(-8),V(8),V(59),V(208),V(208),V(99),V(-911)],[V(29),V(-44),V(52),V(-23),V(208),V(208),V(-911),V(99)]]},q.vander=function(n){return w(n=N(n))||v("vander"),n.map(function(t){return U(n.length,function(n,r){return 0===n?$:Y(r[n-1],t)}).reverse()})},q.toeplitz=function(t,e){return 1===arguments.length?S((e=N(t)).length,e.length,function(n,r){return n===r?e[0]:n<r?e[I.abs(n-r)]:Yn(e[I.abs(n-r)])}):(t=N(t),e=N(e),S(t.length,e.length,function(n,r){return n===r?t[0]:(n<r?e:t)[I.abs(n-r)]}))},q.hankel=function(t,e){var i,n;return 1===arguments.length?(t=N(t),S(i=t.length,i,function(n,r){return i-1-n<r?O:t[(n+r)%i]})):(t=N(t),e=N(e),i=t.length,S(n=e.length,n,function(n,r){return i<=n+r-1?e[n+r-i]:t[(n+r)%i]}))},q.hadamard=function(n){return function n(r){return 1===r?[[$]]:2===r?[[$,$],[$,Z]]:4===r?[[$,$,$,$],[$,Z,$,Z],[$,$,Z,Z],[$,Z,Z,$]]:0==r%4&&(r=n(r/2)).length?Kr([[$,$],[$,Z]],r):[]}(M(n))},q.hilb=function(n){return S(n=M(Sn(n,!0)),n,function(n,r){return V(1/(n+1+r+1-1))})},q.invhilb=function(n){n=M(Sn(n,!0));var r=q.hilb(n);return(n<10?yt:wt)(r)},q.linspace=function(n,r,t){t=M(t=null==t?100:t);for(var e=On(H(r,n),t-1),i=new Array(t),u=0,o=n;u<t;++u,o=D(o,e))i[u]=o;return i},q.logspace=function(n,r,t){t=M(t=null==t?100:t);for(var e=$n(On(r,n),1/(t-1)),i=new Array(t),u=0,o=n;u<t;++u,o=Y(o,e))i[u]=o;return i},q.meshgrid=Nn(function(n,r,t){var e=r,i=t;if(null==i&&(i=e),e=N(e),i=N(i),w(e)&&w(i))return[S(i.length,e.length,function(n,r){return e[r]}),S(i.length,e.length,function(n,r){return i[n]})];v("meshgrid")},2),q.ndgrid=Nn(function(n){var r=n,t=[].slice.call(arguments,1);t=t.map(N);for(var e=[],i=U(r,function(n){return(1===t.length?t[0]:t[n]).length}),u=0;u<r;++u)e.push(bn(i,function(n){return(1===t.length?t[0]:t[u])[n[u]]}));return 1===r?e[0]:e}),q.colon=function(n,r,t){return 1===arguments.length&&k(n)?kn(Zr(n)):Zr.apply(null,arguments)},q.cat=function(n,r,t){var e,i=[];if(1===(n=M(n)))for(i=r,e=2;e<arguments.length;++e)i=Lr("vert",i,arguments[e]);else if(2===n)for(i=r,e=2;e<arguments.length;++e)i=Lr("horz",i,arguments[e]);return i},q.horzcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Lr("horz",t,arguments[e]);return t},q.vertcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=Lr("vert",t,arguments[e]);return t},q.transpose=function(n){return Or(n=yn(n)?xn(n):n)},q.ctranspose=function(n){return $r(n=yn(n)?xn(n):n)},q.diag=Cr,q.blkdiag=function(){return t=[].slice.call(arguments),l=a=c=f=o=0,t.forEach(function(n,r){vn(n)&&(t[r]=n=[[n]]),yn(n)&&(t[r]=n=Cr(n)),wn(n)||v("blkdiag"),o+=B(n),f+=Q(n)}),e=t[c],i=B(e),u=Q(e),S(o,f,function(n,r){return a+i<=n&&(a+=i,l+=u,e=t[++c],i=B(e),u=Q(e)),r<l||l+u<=r?O:e[n-a][r-l]});var t,e,i,u,o,f,c,a,l},q.tril=function(t,e){if(wn(t))return e=M(e||0),S(B(t),Q(t),function(n,r){return r<=n+e?t[n][r]:O});v("tril")},q.triu=function(t,e){if(wn(t))return e=M(e||0),S(B(t),Q(t),function(n,r){return n+e<=r?t[n][r]:O});v("triu")},q.repmat=function(t,e,i){return w(e)&&(i=e[1],e=e[0]),null==i&&(i=e),e=M(e),i=M(i),wn(t=yn(t=vn(t)?[[t]]:t)?[t]:t)?S(e*B(t),i*Q(t),function(n,r){return t[n%e][r%i]}):t},q.repelem=function(r,t){var e,i;if(w(r))if(w(t)){if(t.length===r.length)return e=0,i=-1,U(M(Gr(t)),function(n){return n===e&&(e+=M(t[++i])),r[i]})}else if(p(t))return t=M(t),i=-1,U(t*r.length,function(n){return 0==n%t&&++i,r[i]});return r},q.reshape=function(t,e,n){w(e)&&(n=e[1],e=e[0]),e=M(e),n=M(n);var i,r=e*n;return vn(t)&&1===e&&1===n?[[t]]:yn(t)&&t.length===r?S(e,n,function(n,r){return t[n+e*r]}):wn(t)&&B(t)*Q(t)==r?(i=B(t),S(e,n,function(n,r){n+=e*r;return t[n%i][I.floor(n/i)]})):t},q.squeeze=function(n){return n},q.rot90=function(n,r){var t=n=yn(n)?xn(n):n,n=r;if(wn(t)){var e=B(t),i=Q(t);if((n=I.round(M(n=null==n?1:n))%4)<0&&(n+=4),1===n)return S(i,e,function(n,r){return t[r][i-1-n]});if(3===n)return S(i,e,function(n,r){return t[e-1-r][n]});if(2===n)return S(e,i,function(n,r){return t[e-1-n][i-1-r]})}return t},q.flip=Fr,q.fliplr=function(n){return Fr(n,2)},q.flipud=function(n){return Fr(n,1)},q.sort=Nn(function(n,r,t,e){for(var i=2,u=null;i<arguments.length;){if("ComparisonMethod"===arguments[i]){"real"===arguments[i+1]?u=Wr:"abs"===arguments[i+1]&&(u=Ur),1===i?(t=1,e="ascend"):2===i&&(e="ascend");break}i+=1}return null==e&&(e="ascend"),Br(r,t=M(t=null==t?1:t),e,u,1<n)}),q.min=Qr,q.max=Vr,q.sum=Gr,q.prod=Dr,q.dot=Hr,q.cross=function(n,r){if(n=N(n),r=N(r),!w(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(w(r)&&3===r.length)return[Hn(Y(n[1],r[2]),Y(n[2],r[1])),Hn(Y(n[2],r[0]),Y(n[0],r[2])),Hn(Y(n[0],r[1]),Y(n[1],r[0]))];throw"cross: input 2 not vector of length 3"},q.kron=Kr,q.diff=function(n,r,t){for(null==t&&(t=1),p(r=null==r?1:r)||v("diff"),r=M(r);0<r--;)n=function r(t,n){if(w(t=N(t)))return 1<t.length?U(t.length-1,function(n){return Hn(t[n+1],t[n])}):[];if(b(t)){if(1===(n=M(n=null==n?1:n)))return U(Q(t),function(n){return r(j(t,n))});if(2===n)return U(B(t),function(n){return r(t[n])})}v("diff")}(n,t);return n},q.trapz=function(n,r,t){return arguments.length<3&&(k(r)?t=1:k(n)&&!k(r)&&(t=r,r=n,n=null)),Jr(k(n)?N(n):n,N(r),t)},q.cumtrapz=function(n,r,t){return arguments.length<3&&(k(r)?t=1:k(n)&&!k(r)&&(t=r,r=n,n=null)),function r(t,e,i){if(y(e))return e;if(w(e)){if(null==t||y(t))return e.map(function(n,r){return Jr(t,e.slice(0,r+1))});if(w(t)&&t.length===e.length)return e.map(function(n,r){return Jr(t.slice(0,r+1),e.slice(0,r+1))})}else if(b(e))if(1===(i=M(i=null==i?1:i))){if(null==t||y(t)||w(t)&&t.length===B(e))return U(Q(e),function(n){return r(t,j(e,n),i)});if(b(t)&&B(t)===B(e)&&Q(t)===Q(e))return U(Q(e),function(n){return r(j(t,n),j(e,n),i)})}else if(2===i){if(null==t||y(t)||w(t)&&t.length===Q(e))return U(B(e),function(n){return r(t,e[n],i)});if(b(t)&&B(t)===B(e)&&Q(t)===Q(e))return U(B(e),function(n){return r(t[n],e[n],i)})}v("cumtrapz")}(k(n)?N(n):n,N(r),t)},q.cumsum=function(n,r,t){n=Yr(N(n),J,t,r);return!1===n&&v("cumsum"),n},q.cumprod=function(n,r,t){n=Yr(N(n),Y,t,r);return!1===n&&v("cumprod"),n},q.cummin=function(n,r,t){n=Yr(N(n),function(n,r){return Bn(n,r)?n:r},t,r);return!1===n&&v("cummin"),n},q.cummax=function(n,r,t){n=Yr(N(n),function(n,r){return Qn(n,r)?n:r},t,r);return!1===n&&v("cummax"),n},q.movsum=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),Gr,e,i,t))&&v("movsum"),r},q.movprod=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),Dr,e,i,t))&&v("movprod"),r},q.movmean=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),$t,e,i,t))&&v("movmean"),r},q.movmin=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),Qr,e,i,t))&&v("movmin"),r},q.movmax=function(n,r,t){var e,i;return w(r)?(e=M(r[0]),i=M(r[1])):p(r)&&(i=1&(r=M(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=nt(N(n),Vr,e,i,t))&&v("movmax"),r},q.bitshift=function(n,r){return qn(function(n){return p(n)?Xn(r,O)?M(n)>>-M(r):M(n)<<M(r):n},n,!0)},q.bitand=function t(r,e){if(p(r)){if(p(e))return M(r)&M(e);if(k(e))return e.map(function(n){return t(r,n)})}else if(k(r)){if(p(e))return r.map(function(n){return t(n,e)});if(k(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},q.bitor=function t(r,e){if(p(r)){if(p(e))return M(r)|M(e);if(k(e))return e.map(function(n){return t(r,n)})}else if(k(r)){if(p(e))return r.map(function(n){return t(n,e)});if(k(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},q.bitxor=function t(r,e){if(p(r)){if(p(e))return M(r)^M(e);if(k(e))return e.map(function(n){return t(r,n)})}else if(k(r)){if(p(e))return r.map(function(n){return t(n,e)});if(k(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},q.size=function(n){return Nn(rt.apply(null,[].slice.call(arguments)))},q.length=function(n){return k(n)?n.length?I.max.apply(null,rt(n)):0:null==n?0:1},q.ndims=function(n){return 2+rt(n).slice(2).filter(function(n){return 1<n}).length},q.numel=function(n){return Dr(rt(n))},q.rows=function(n){return rt(n,1)},q.columns=function(n){return rt(n,2)},q.sub2ind=function(n,r,t){return w(r)&&(t=r[1],r=r[0]),r=M(r),t=M(t),1===n.length?r:r-1+M(n[0])*(t-1)+1},q.ind2sub=function(n,r){return r=M(r),1===n.length?[r,1]:[(r-1)%M(n[0])+1,I.floor((r-1)/M(n[0]))+1]},c.find=tt,q.find=function(n){return tt(n,function(n){return!P(n,O)})},c.all=et,q.all=function(n){return et(n,function(n){return!P(n,O)})},c.any=it,q.any=function(n){return it(n,function(n){return!P(n,O)})},q.isequal=function(){var n=arguments.length,r=0,t=1;for(1<n&&(t=ut(arguments[0],arguments[1],!1),r=2);t&&r<n;)t=ut(arguments[0],arguments[r++],!1);return t},q.isequaln=function(){var n=arguments.length,r=0,t=1;for(1<n&&(t=ut(arguments[0],arguments[1],!0),r=2);t&&r<n;)t=ut(arguments[0],arguments[r++],!0);return t},q.isnan=function n(r){return k(r)?r.map(n):mn(r)||o(r)&&(mn(r.re)||mn(r.im))?1:0},q.isinf=function n(r){return k(r)?r.map(n):W(r)?gn(r)?1:0:o(r)&&(gn(r.re)||gn(r.im))?1:0},q.isfinite=function n(r){return k(r)?r.map(n):W(r)?gn(r)?0:1:!o(r)||gn(r.re)||gn(r.im)?0:1},q.isreal=function(n){return et(n,dn)},q.isempty=function(n){return k(n)?k(n[0])?n[0].length?0:1:n.length?0:1:0};var pt=function(r,n,t,e){var i,u,o,f,c,a,l,s,h,m,g,p,d,v,y=B(r),w=Q(r),b=w,x=0;if(e=V(e||0),ht(r,"upper",!1,e))return n?[r,U(b,function(n){return[n,n]}).filter(function(n){return n[0]<y&&n[1]<w&&!Vn(rr(r[n[0]][n[1]]),e)}),Dr(Cr(r)),zr(y)]:r;for(k(t)&&(b=I.min(b,t[1])),d=st(r,zr(y)),i=new Array(b),u=$,v=function(n,r){r=r||0;for(var t=x-1;0<=t;--t)if(n===i[t][r])return t;return-1},o=l=0;o<y&&!(b<=l);++o){for(f=o;Vn(rr(d[f][l]),e);)if(y<=++f&&(f=o,b<=++l)){l=-1;break}if(-1===l)break;for(s=-1,m=null,p=0,f=c=f;f<y;++f)Vn(g=rr(d[f][l]),e)?++p:null!=m&&!Bn(g,m)||(m=g,s=f);for(;-1!==s;){if(y-c===p+1){for(o!==s&&(ot(d,o,s),u=Jn(u)),Bn(d[o][l],O)&&(ft(d,o,o,O,Z,l),u=Jn(u)),f=s,c=o;0<=f&&-1!==(a=v(f));)f=c-=x-a;i[x++]=[f,l],u=o<b?Y(u,d[o][o]):O;break}for(p=0,h=s,f=c;f<y;++f)f!==h&&(ft(d,f,h,Jn(nn(d[f][l],d[h][l])),$,l),Vn(g=rr(d[f][l]),e)?++p:Bn(g,m)&&(m=g,s=f))}++l}return x<b&&(u=O),t=lt(d,0,w,y-1,y+w-1),d=lt(d,0,0,y-1,w-1),i.length>x&&(i.length=x),n?[d,i,u,t]:d};function dt(n,r,t,e){var i,u,o,f,c,a,l=B(n),s=Q(n),h=s;for(e=V(e||0),k(t)&&I.min(h,t[1]),a=st((h=pt(n,!0,t,e))[0],h[3]),i=h[1],n=h[2],u=i.length,f=0;f<u;++f)for(o=i[f][1],c=0;c<f;++c)Vn(rr(a[c][o]),e)||(ft(a,c,f,Jn(a[c][o]),a[f][o]),P(a[c][i[c][1]],$))||ft(a,c,c,O,nr(a[c][i[c][1]]),i[c][1]);return P(a[u-1][i[u-1][1]],$)||ft(a,u-1,u-1,O,nr(a[u-1][i[u-1][1]]),i[u-1][1]),t=lt(a,0,s,l-1,l+s-1),a=lt(a,0,0,l-1,s-1),r?[a,i,n,t]:a}function vt(n,r,t){if(y(n)&&y(r))return nn(r,n);if(!b(n))return[];if(!w(r=N(r))&&!b(r))return[];var e,i=Q(n);if(B(n)!==i)return[];if(e=w(r)?(h=r.length,1):(h=B(r),Q(r)),i!==h)return[];var u,o,f,c,a,l,s,h=pt(Or(n),!0);if(h[1].length!==i)return[];if(u=Or(h[3]),o=Or(h[0]),w(r)){for(f=U(i,O),c=0;c<i;++c){if(P(o[c][c],O))return[];for(s=O,a=0;a<c;++a)s=J(s,Y(o[c][a],f[a]));f[c]=nn(Hn(r[c],s),o[c][c])}return U(i,function(r){return U(i,function(n){return Y(f[n],u[r][n])}).reduce(J,O)})}for(f=Xr(i,e),c=0;c<i;++c){if(P(o[c][c],O))return[];for(l=0;l<e;++l){for(s=O,a=0;a<c;++a)s=J(s,Y(o[c][a],f[a][l]));f[c][l]=nn(Hn(r[c][l],s),o[c][c])}}return S(i,e,function(r,t){return U(i,function(n){return Y(f[n][t],u[r][n])}).reduce(J,O)})}function yt(n){var r,t,e;return y(n)?nr(n):b(n)&&B(n)===Q(n)?1===(t=r=B(n))?[[nr(n[0][0])]]:P((e=dt(n,!0))[0][r-1][t-1],O)?[]:e[3].map(function(n,r){return n.map(function(n){return nn(n,e[0][r][r])})}):[]}function wt(n){if(B(n)!==Q(n))return[];for(var r=zr(B(n)),t=r,e=ir(r,n),i=0;i<4;++i)t=d(t,er(r,e)),i+1<4&&(e=d(e,e));return t}function bt(n,r){var t,e,i=B(n),u=Q(n);return r=r||dt(n,!0),e=(t=r[1]).length,[lt(n,U(i,function(n){return n}),U(e,function(n){return t[n][1]})),lt(r[0],0,0,e-1,u-1).map(function(t,e){return t.map(function(n,r){for(r=e;r+1<u&&P(t[r],O);)++r;return nn(n,t[r])})})]}function xt(t,n){var r,e,i,u,o;return y(t)?nr(t):b(t)?(r=B(t),i=Q(t),function t(n,e){return y(e)?y(n)?P(n,e):n.filter(function(n){return t(n,e)}).length===n.length:!!k(e)&&(y(n)?t(e,n):n.length===e.length&&n.filter(function(n,r){return t(n,e[r])}).length===e.length)}(t,0)?Or(t):1===r&&1===i?[[nr(t[0][0])]]:1===r||1===i?(o=t.reduce(function(n,r){return J(n,Y(r,Yn(r)))},O),S(i,r,function(n,r){return nn(Yn(t[r][n]),o)})):(n=(e=dt(t,!0,null,n||0))[1].length)===i?r===i?e[3].map(function(n,r){return n.map(function(n){return nn(n,e[0][r][r])})}):d(yt(d(u=$r(t),t)),u):n===r?d(u=$r(t),yt(d(t,u))):(i=bt(t,e),o=d(yt(d(u=$r(o=i[0]),o)),u),n=d(u=$r(n=i[1]),yt(d(n,u))),d(n,o))):[]}function kt(e){return y(e)?e:b(e)?e.reduce(function(n,r,t){return J(n,t<r.length?e[t][t]:0)},0):void v("trace")}function St(e,n,r){r=V(r||0);var t=B(e);return t!==Q(e)?0:1===t?e[0][0]:ht(e,"lower",!0,r)||ht(e,"upper",!0,r)?e.reduce(function(n,r,t){return Y(n,e[t][t])},1):!0===n?function n(r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d;function v(t,n,e,i){return S(n-1,n-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})}if(1===t)f=r[0][0];else if(2===t)c=r[0][0],a=r[0][1],l=r[1][0],f=Hn(Y(c,s=r[1][1]),Y(a,l));else if(3===t)c=r[0][0],a=r[0][1],l=r[0][2],s=r[1][0],h=r[1][1],m=r[1][2],g=r[2][0],p=r[2][1],d=r[2][2],f=Hn(Hn(Hn(J(J(Y(Y(c,h),d),Y(Y(a,m),g)),Y(Y(l,s),p)),Y(Y(l,h),g)),Y(Y(a,s),d)),Y(Y(c,m),p));else{for(e=u=i=0;e<t;++e)P(r[0][e],O)&&++i,P(r[e][0],O)&&++u;if(o=$,f=O,i<u)for(e=0;e<t;++e)P(r[e][0],O)||(f=J(f,Y(r[e][0],Y(o,n(v(r,t,e,0),t-1))))),o=$===o?Z:$;else for(e=0;e<t;++e)P(r[0][e],O)||(f=J(f,Y(r[0][e],Y(o,n(v(r,t,0,e),t-1))))),o=$===o?Z:$}return f}(e,t):pt(e,!0,null,r)[2]}function At(n){b(n)&&B(n)===Q(n)||v("charpoly");var e,r=B(n),i=(Q(n),r),u=new Array(i+1),t=Xr(i,i);for(u[i]=$,e=1;e<=i;++e)t=d(n,t).map(function(n,t){return n.map(function(n,r){return t===r?J(n,u[i-e+1]):n})}),u[i-e]=nn(kt(d(n,t)),-e);return Rn(u.reverse())}function _t(o){return S(Q(o),B(o),function(n,r){return e=r,i=n,r=!0,n=B(t=o),u=Q(t),n!==u?null:n<=1?0:(i=+(i||0),(e=+(e||0))<0||n<=e||i<0||u<=i?null:(n=St(S(n-1,u-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})),!0===r&&e+i&1?Jn(n):n));var t,e,i,u})}function It(n,r,t){null==r&&(r=F);for(var e,i,u,o,f,c,a=B(n),l=_n(n),s=t?U(a,$):null,h=V(1e-10),m=1;m<=100;++m){for(e=c=0;e<a;++e)if((o=j(l,e)).splice(e,1),(f=l[e]).splice(e,1),o=Tr(o,r),G(f=Tr(f,r),O)||G(o,O))++c;else{for(u=L.sqrt(On(f,o)),Zn(L.abs(H(u,$)),h)&&++c,t&&(s[e]=K(u,s[e])),i=0;i<a;++i)l[i][e]=Y(l[i][e],u);for(i=0;i<a;++i)l[e][i]=nn(l[e][i],u)}if(a===c)break}return t?[s,l]:l}function qt(n,r,t){var e=B(n);if(null==r){var i,u,o=t?zr(e):null,f=n;for(c=1;c<=e-2;++c)for(a=e;c+2<=a;--a)u=[Yn((i=mt(f[a-1-1][c-1],f[a-1][c-1]))[0]),Jn(Yn(i[1]))],t&&(o=gt("right",i,a-1-1,a-1,o)),f=gt("left",u,a-1-1,a-1,gt("right",i,a-1-1,a-1,f));return t?[o,f]:f}var c,a,l,s,h=$r(o=qr_givens(r,!0)[0]),m=zr(e),g=d(h,n),p=d(h,r);for(c=1;c<=e-2;++c)for(a=e;c+2<=a;--a)l=[Yn((s=mt(g[a-1-1][c-1],g[a-1][c-1]))[0]),Jn(Yn(s[1]))],o=gt("right",s,a-1-1,a-1,o),g=gt("left",l,a-1-1,a-1,g),p=gt("left",l,a-1-1,a-1,p),m=gt("right",s=mt(Jn(p[a-1][a-1]),p[a-1][a-1-1]),a-1-1,a-1,m),g=gt("right",s,a-1-1,a-1,g),p=gt("right",s,a-1-1,a-1,p);return[g,p,o,m]}function Et(n,r){for(var t,e,i,u=B(n),o=(Q(n),"upper"===r),f=Xr(u,u),c=zr(u),a=0;a<u;++a){for(t=0;t<a;++t){for(e=0,i=O;e<t;++e)i=J(i,Y(Y(c[a][e],Yn(c[t][e])),f[e][e]));c[a][t]=nn(Hn(o?n[t][a]:n[a][t],i),f[t][t])}for(e=0,i=O;e<a;++e)i=J(i,Y(Y(c[a][e],Yn(c[a][e])),f[e][e]));if(f[a][a]=Hn(n[a][a],i),Vn(f[a][a],O))return[]}return[c,f]}function Nt(n,r,t){var e,i,u,o,f,c,a,l,s,h=B(n),m=Q(n),g=r?zr(h):null,p=n;if(t)for(e=U(m,function(n){return n}),o=U(m,function(n){return Tr(j(p,n),F)}),a=0;a<m;++a){for(f=o[i=a],c=a+1;c<m;++c)zn(o[c],f)&&(f=o[i=c]);if(G(f,O))break;if(a!==i)for(u=o[a],o[a]=o[i],o[i]=u,u=e[a],e[a]=e[i],e[i]=u,c=0;c<h;++c)u=p[c][a],p[c][a]=p[c][i],p[c][i]=u;for(c=h-1;a+1<=c;--c)s=[Yn((l=mt(p[c-1][a],p[c][a]))[0]),Jn(Yn(l[1]))],p=gt("left",s,c-1,c,p),r&&(g=gt("right",l,c-1,c,g));for(c=a+1;c<m;++c)o[c]=H(o[c],$n(rr(p[a][c]),F))}else for(a=0;a<m;++a)for(c=h-1;a+1<=c;--c)s=[Yn((l=mt(p[c-1][a],p[c][a]))[0]),Jn(Yn(l[1]))],p=gt("left",s,c-1,c,p),r&&(g=gt("right",l,c-1,c,g));return r&&t?[g,p,S(m,m,function(n,r){return n===e[r]?$:O})]:r?[g,p]:p}function jt(n){var r,t,e,i,u=V(1e-10),o=B(n),f=new Array(o),c=new Array(o),a=U(o,O);for(n=In(n),i=0;i<o;++i)r=(e=function(n,r,t,e){var i,u,o,f,c,a,l=O;if(!0===e){for(f=or(f=U(r,function(){return new _(V(I.random()||.1),O)}),Tr(f)),i=1;i<=100&&(o=l,l=Hr(f=N(d(n,c=f)),c),f=or(f,f[0].sign()),f=or(f,Tr(f)),!Zn(L.abs(H(jr(l),jr(o))),t)||!Zn(L.abs(H(Mr(l),Mr(o))),t));++i);return l}for(u=$r(n),f=or(f=U(r,function(){return new _(V(I.random()||.1),O)}),Tr(f)),a=or(a=U(r,function(){return new _(V(I.random()||.1),O)}),Tr(a)),i=1;i<=100&&(o=l,f=N(d(n,c=f)),a=N(d(u,a)),l=Hr(f,c),f=or(f,f[0].sign()),a=or(a,a[0].sign()),f=or(f,Tr(f)),a=or(a,Tr(a)),!Zn(L.abs(H(jr(l),jr(o))),t)||!Zn(L.abs(H(Mr(l),Mr(o))),t));++i);return[l,f,a]}(n,o,u))[0],t=e[1],e=e[2],n=ir(n,d(d(nn(a[i]=r,Hr(f[i]=t,c[i]=e,!0)),t),e));return[Rn(Or(f)),Rn(a),Rn(Or(c))]}function Mt(n,r,t,e){r=V(r=W(r)?r:rn);var i,u=Q(n),o=B(n);if(o<u)return i=Mt(Or(n),r,e,t),t&&e?[Or(i[2]),i[1],Or(i[0])]:t||e?[Or(i[0]),i[1]]:i;var f,c,a,l,s,h,m,g,p,d,v,y,w,b,x,k,S,A,_,z,I,q=t?o:0,E=e?u:0,N=In(n),j=q?Xr(o,q):null,M=U(u,O),P=E?Xr(u,E):null,Z=On(an.realmin,r),R=new Array(u),T=new Array(u),X=new Array(u);for(T[0]=O,b=1;b<=u;++b){for(S=b+1,a=O,y=b;y<=o;++y)a=D(a,D($n(jr(N[y-1][b-1]),F),$n(Mr(N[y-1][b-1]),F)));if(R[b-1]=O,zn(a,Z)&&(a=L.sqrt(a),R[b-1]=a,s=G(l=rr(N[b-1][b-1]),O)?$:nn(N[b-1][b-1],l),N[b-1][b-1]=Y(s,D(a,l)),b!==u+0)){for(w=S;w<=u+0;++w){for(s=O,y=b;y<=o;++y)s=J(s,Y(Yn(N[y-1][b-1]),N[y-1][w-1]));for(s=nn(s,K(a,D(a,l))),y=b;y<=o;++y)N[y-1][w-1]=Hn(N[y-1][w-1],Y(s,N[y-1][b-1]))}for(s=Jn(Dn(Yn(N[b-1][b-1]))),w=S;w<=u+0;++w)N[b-1][w-1]=Y(s,N[b-1][w-1])}if(b===u)break;for(a=O,w=S;w<=u;++w)a=D(a,D($n(jr(N[b-1][w-1]),F),$n(Mr(N[b-1][w-1]),F)));if(T[S-1]=O,zn(a,Z)){for(a=L.sqrt(a),T[S-1]=a,s=G(l=rr(N[b-1][S-1]),O)?$:nn(N[b-1][S-1],l),N[b-1][S-1]=Y(s,D(a,l)),y=S;y<=o;++y){for(s=O,w=S;w<=u;++w)s=J(s,Y(Yn(N[b-1][w-1]),N[y-1][w-1]));for(s=nn(s,K(a,D(a,l))),w=S;w<=u;++w)N[y-1][w-1]=Hn(N[y-1][w-1],Y(s,N[b-1][w-1]))}for(s=Jn(Dn(Yn(N[b-1][S-1]))),y=S;y<=o;++y)N[y-1][S-1]=Y(N[y-1][S-1],s)}}for(h=O,b=1;b<=u;++b)M[b-1]=R[b-1],X[b-1]=T[b-1],h=Vr([h,D(M[b-1],X[b-1])]);if(h=K(r,h),0<q)for(w=1;w<=q;++w)j[w-1][w-1]=$;if(0<E)for(w=1;w<=E;++w)P[w-1][w-1]=$;for(k=1;k<=u;++k){for(b=u+1-k,z=1;z<=50;++z){for(I=!0,_=1;_<=b;++_){if(Zn(L.abs(X[(x=b+1-_)-1]),h)){I=!1;break}if(Zn(L.abs(M[x-1-1]),h)){I=!0;break}}if(I)for(v=O,d=$,A=x-1,y=x;y<=b&&(g=K(d,X[y-1]),X[y-1]=K(v,X[y-1]),!Zn(L.abs(g),h));++b)if(l=hr(g,p=M[y-1]),v=On(p,M[y-1]=l),d=Fn(On(g,l)),0<q)for(w=1;w<=u;++w)f=jr(j[w-1][A-1]),c=jr(j[w-1][y-1]),j[w-1][A-1]=D(K(f,v),K(c,d)),j[w-1][y-1]=H(K(c,v),K(f,d));if(l=M[b-1],x===b)break;for(f=M[x-1],c=M[b-1-1],m=X[b-1-1],p=X[b-1],m=hr(g=On(D(K(H(c,l),D(c,l)),K(H(m,p),D(m,p))),K(F,K(p,c))),$),Xn(g,O)&&(m=Fn(m)),g=On(D(K(H(f,l),D(f,l)),K(H(On(c,D(g,m)),p),p)),f),d=v=$,y=A=x+1;A<=b;++A){if(m=X[y-1],c=M[y-1],p=K(d,m),m=K(v,m),l=hr(p,g),v=On(g,X[y-1-1]=l),d=On(p,l),g=D(K(f,v),K(m,d)),m=H(K(m,v),K(f,d)),p=K(c,d),c=K(c,v),0<E)for(w=1;w<=u;++w)f=jr(P[w-1][y-1-1]),l=jr(P[w-1][y-1]),P[w-1][y-1-1]=D(K(f,v),K(l,d)),P[w-1][y-1]=H(K(l,v),K(f,d));if(l=hr(p,g),v=On(g,M[y-1-1]=l),d=On(p,l),g=D(K(v,m),K(d,c)),f=H(K(v,c),K(d,m)),0<q)for(w=1;w<=u;++w)c=jr(j[w-1][y-1-1]),l=jr(j[w-1][y-1]),j[w-1][y-1-1]=D(K(c,v),K(l,d)),j[w-1][y-1]=H(K(l,v),K(c,d))}X[x-1]=O,X[b-1]=g,M[b-1]=f}if(Xn(l,O)&&(M[b-1]=Fn(l),0<E))for(w=1;w<=u;++w)P[w-1][b-1]=Jn(P[w-1][b-1])}for(b=1;b<=u;++b){for(m=-1,y=w=b;y<=u;++y)zn(M[y-1],m)&&(m=M[y-1],w=y);if(w!==b){if(M[w-1]=M[b-1],M[b-1]=m,0<E)for(y=1;y<=u;++y)s=P[y-1][w-1],P[y-1][w-1]=P[y-1][b-1],P[y-1][b-1]=s;if(0<q)for(y=1;y<=u;++y)s=j[y-1][w-1],j[y-1][w-1]=j[y-1][b-1],j[y-1][b-1]=s}}if(0<q)for(k=1;k<=u;++k)if(!G(R[(b=u+1-k)-1],O)){for(s=Jn(Dn(N[b-1][b-1])),w=1;w<=q;++w)j[b-1][w-1]=Y(s,j[b-1][w-1]);for(w=1;w<=q;++w){for(s=O,y=b;y<=o;++y)s=J(s,Y(Yn(N[y-1][b-1]),j[y-1][w-1]));for(s=nn(s,Y(rr(N[b-1][b-1]),R[b-1])),y=b;y<=o;++y)j[y-1][w-1]=Hn(j[y-1][w-1],Y(s,N[y-1][b-1]))}}if(0<E&&2<=u)for(k=2;k<=u;++k)if(!G(T[(S=(b=u+1-k)+1)-1],O)){for(s=Jn(Dn(Yn(N[b-1][S-1]))),w=1;w<=E;++w)P[S-1][w-1]=Y(s,P[S-1][w-1]);for(w=1;w<=E;++w){for(s=O,y=S;y<=u;++y)s=J(s,Y(N[b-1][y-1],P[y-1][w-1]));for(s=nn(s,Y(rr(N[b-1][S-1]),T[S-1])),y=S;y<=u;++y)P[y-1][w-1]=Hn(P[y-1][w-1],Y(s,Yn(N[b-1][y-1])))}}return t&&e?[Rn(j),M,Rn(P)]:t||e?[Rn(j||P),M]:M}q.planerot=Nn(function(n,r){w(r=N(r))&&2===r.length||v("planerot");var t=mt(r[0],r[1]),t=[[t[0],t[1]],[Jn(t[1]),t[0]]];return 1<n?[t,d(t,kn(r))]:t}),q.ref=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)||v("ref");r=pt(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),q.rref=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)||v("rref");r=dt(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),q.linsolve=vt,q.null=function(n,r){return r=r,i=Q(t=n),u=(t=dt(n,!0,null,r))[0],o=t[1],f=o.length,r=o.reduce(function(n,r){for(var t=0;t<n.length&&r[1]>n[t];)++t;return t<n.length&&r[1]===n[t]&&n.splice(t,1),n},U(i,function(n){return n})),c=f?o.reduce(function(n,r,t){return Y(n,u[t][r[1]])},$):$,r.map(function(r){for(var n,t=U(i,function(n){return n===r?c:O}),e=0;e<f;++e)(n=o[e][1])<=r&&(t[n]=Hn(t[n],Y(nn(c,u[e][n]),u[e][r])));return t});var t,i,u,o,f,c},q.rowspace=function(n,r){return pt(t=n,!0,null,r)[1].map(function(n){return t[n[0]]});var t},q.colspace=function(n,r){return pt(t=n,!0,null,r)[1].map(function(r){return U(t.length,function(n){return t[n][r[1]]})});var t},q.rank=function(n){return b(n=y(n)?[[n]]:n)||v("rank"),pt(n,!0)[1].length},q.inv=function(n){return y(n)&&(x=[[n]]),b(n)||v("inv"),yt(n)},q.ainv=function(n){return y(n)&&(x=[[n]]),b(n)||v("ainv"),wt(n)},q.rankf=function(n){return b(n=y(n)?[[n]]:n)||v("rankf"),bt(n)},q.pinv=function(n,r){return b(n=y(n)?[[n]]:n)||v("pinv"),xt(n,r)},q.cond=function(n,r){b(n=y(n)?[[n]]:n)||v("cond");var t=yt(n);return t&&t.length?Y(Tr(n,r=null==r?2:r),Tr(t,r)):T},q.trace=kt,q.det=function(n){return b(n=y(n)?[[n]]:n)||v("det"),St(n,!1,1e-15)},q.charpoly=At,q.adjoint=function(n){return b(n)&&B(n)===Q(n)||v("adjoint"),_t(n)},q.balance=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)&&B(r)===Q(r)||v("balance");var e=It(r,F,1<n);return 2<n?[e[0],U(B(r),function(n){return n+1}),e[1]]:1<n?[Cr(e[0]),e[1]]:e}),q.hess=Nn(function(n,r,t){return b(r=y(r)?[[r]]:r)&&B(r)===Q(r)||v("hess"),2<arguments.legnth?(b(t=y(t)?[[t]]:t)&&B(t)===Q(t)||v("hess"),qt(r,t)):qt(r,null,1<n)}),q.ldl=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)&&B(r)===Q(r)||v("ldl");t=Et(r,t);return t.length||v("ldl"),2<n&&t.push(zr(B(r))),t},2),q.chol=Nn(function(n,r,t){b(r=y(r)?[[r]]:r)&&B(r)===Q(r)||v("chol");r=Et(r,t=t||"upper");return r.length||v("chol"),"lower"===t?d(r[0],q.sqrt(r[1])):$r(d(r[0],q.sqrt(r[1])))}),q.lu=Nn(function(n,r){b(r=y(r)?[[r]]:r)||v("lu");var t,r=function(n,r){var t,e,i,u,o,f,c,a,l,s,h,m,g,p,d;for(r=V(r||0),t=B(n),e=Q(n),d=!1,o=In(n),u=zr(t),f=U(t,O),i=zr(t),c=$,a=0;a<t-1;++a){if(Vn(rr(o[a][a]),r)){for(h=a+1,m=!0;h<t&&m;)Vn(rr(o[h][a]),r)?++h:m=!1;if(t<=h){d=!0;break}ot(o,a,h),ot(i,a,h)}for(g=o[a][a],u[a][a]=g,f[a]=Y(c,g),l=a+1;l<t;++l){for(p=o[l][a],u[l][a]=p,s=a+1;s<e;++s)o[l][s]=nn(Hn(Y(g,o[l][s]),Y(o[a][s],p)),c);o[l][a]=O}c=o[a][a]}return d?[]:(f[t-1]=c,[f,u,o,i])}(r);if(r.length)return t=Cr(r[0].map(nr)),2<n?[d(r[1],t),r[2],r[3]]:[d(Or(r[3]),d(r[1],t)),r[2]];throw"lu: defficient matrix"},2),q.qr=Nn(function(n,r){return b(r=y(r)?[[r]]:r)||v("qr"),Nt(r,1<n,2<n)}),q.schur=Nn(function(n,r){b(r=y(r)?[[r]]:r)&&B(r)===Q(r)||v("schur");var t,e,i,u,o,f=1<n,c=B(r),a=V(1e-8),l=qt(r,null,f);for(f&&(t=l[0],l=l[1]),i=c-1;0<i;--i)for(o=1;o<=100&&(l=er(d((e=Nt(ir(l,u=zr(c,l[i][i])),!0))[1],e[0]),u),f&&(t=d(t,e[0])),!Zn(rr(l[i][i-1]),a));++o);return f?[t,l]:l}),q.eig=Nn(function(n,r,t){b(r)&&B(r)===Q(r)||v("eig"),b(t)&&v("eig");var e=null;return"nobalance"!==t&&(e=It(r,F,!0),r=e[1],e=e[0]),1<n?(t=jt(r),[e?d(Cr(e),t[0]):t[0],Cr(t[1]),e?d(Cr(e.map(Wn)),t[2]):t[2]]):Rn((ht(r,"upper",!0,1e-15)||ht(r,"lower",!0,1e-15)?U(B(r),function(n){return r[n][n]}):ae(At(r))).sort(function(n,r){n=rr(n),r=rr(r);return zn(r,n)?1:Xn(r,n)?-1:0}))}),q.svd=Nn(function(n,r,t){return b(r=y(r)?[[r]]:r)||v("svd"),1<n?[(n=Mt(r,t,1<n,2<n))[0],Cr(n[1]),n[2]]:Mt(r,t,!1,!1)});var Pt=function(n,r,t){for(var e,i,u,o,f,c,a,l=B(n),s=Q(n),h=s,m=O,g=t?st(n,zr(l)):n,p=0,d=0;d<l&&!(h<=p);++d){for(e=d;Vn(rr(g[e][p]),m);)if(l<=++e&&(e=d,h<=++p)){p=-1;break}if(-1===p)break;for(u=-1,f=null,a=0,e=i=e;e<l;++e)Vn(c=rr(g[e][p]),m)?++a:null!=f&&!Bn(c,f)||(f=c,u=e);for(;-1!==u;){if(l-i===a+1){if(d!==u&&ot(g,d,u),Bn(g[d][p],O)&&ft(g,d,d,O,Z,p),r)for(c=g[d][p],e=0;e<d;++e)Gn(rr(g[e][p]),c)&&ft(g,e,d,Jn(q.floor(nn(g[e][p],c))),$,p),Bn(g[e][p],O)&&ft(g,e,d,$,$,p);e=u,i=d;break}for(a=0,o=u,e=i;e<l;++e)e!==o&&(ft(g,e,o,Jn(q.floor(nn(g[e][p],g[o][p]))),$,p),Vn(c=rr(g[e][p]),m)?++a:Bn(c,f)&&(f=c,u=e))}++p}return t?[lt(g,0,s,l-1,l+s-1),lt(g,0,0,l-1,s-1)]:g};q.hermiteForm=Nn(function(n,r){return b(r=y(r)?[[r]]:r)||v("hermiteForm"),Pt(q.round(q.real(r)),!0,1<n)}),q.smithForm=Nn(function(n,r){b(r=y(r)?[[r]]:r)||v("smithForm");r=function(n,r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d,v,y,w,b,x,k=B(n),S=Q(n),A=I.min(k,S);for(r&&(e=zr(k)),t&&(i=zr(S)),u=-1,o=0;o<k;++o){for(s=!1,f=u+1;f<S;++f){for(m=0;m<k&&G(n[m][f],O);++m);if(m<k){s=!0;break}}if(!s)break;if(G(n[o][f],O)){for(a=0;a<k&&G(n[a][f],O);++a);ct(n,o,a,O,$,$,O),r&&at(e,o,a,O,$,$,O)}for(at(n,f,o,O,$,$,O),t&&ct(i,f,o,O,$,$,O),f=o,c=!0;c;){for(c=!1,a=o+1;a<k;++a)G(n[a][f],O)||(c=!0,G(O,Cn(n[a][f],n[o][f]))||(p=(g=me([n[o][f],n[a][f]]))[1],d=g[2],v=On(n[a][f],g[0]),y=On(n[o][f],g[0]),ct(n,o,a,p,d,Fn(v),y),r&&at(e,o,a,y,Fn(d),v,p)),w=On(n[a][f],n[o][f]),ct(n,o,a,$,O,Fn(w),$),r&&at(e,o,a,$,O,w,$));for(l=f+1;l<S;++l)G(n[o][l],O)||(c=!0,G(O,Cn(n[o][l],n[o][f]))||(p=(g=me([n[o][f],n[o][l]]))[1],d=g[2],v=On(n[o][l],g[0]),y=On(n[o][f],g[0]),at(n,f,l,p,Fn(v),d,y),t&&ct(i,f,l,y,v,Fn(d),p)),w=On(n[o][l],n[o][f]),at(n,f,l,$,Fn(w),O,$),t&&ct(i,f,l,$,w,O,$))}u=f}for(h=0;h<A;++h)for(m=h-1;0<=m;--m)G((g=me([n[m][m],n[h][h]]))[0],O)||(p=g[1],d=g[2],v=On(n[h][h],g[0]),y=On(n[m][m],g[0]),b=K(d,v),x=H($,K(p,y)),ct(n,m,h,$,d,v,H(b,$)),r&&at(e,m,h,H($,b),d,v,Z),at(n,m,h,p,x,$,Fn(y)),t&&ct(i,m,h,y,x,$,Fn(p)));return r&&t?[n,e,i]:r?[n,e]:t?[n,i]:n}(q.round(q.real(r)),1<n,1<n);return 1<n?[r[1],r[2],r[0]]:r}),q.sqrtm=Nn(function(n,r){if(2<n)throw"sqrtm: output not supported";if(y(r))return 1<n?[q.sqrt(r),O]:q.sqrt(r);b(r)&&B(r)===Q(r)||v("sqrtm");var t=function(n,r){null==r&&(r=100);var t,e,i,u,o=B(n),f=V(.25),c=V(.75),a=V(1e-10),l=L.sqrt(K(Tr(n,$),Tr(n,T))),a=K(a,l),s=zr(o),h=zr(o,c);for(l=nn(tn,l),t=ur(n,q.sqrt(l)),i=ir(s,ur(n,l)),u=1;u<=r&&!Zn(Vr(Vr(Rr(ir(e=d(t,er(s,ur(tn,i))),t)))),a);++u)t=e,i=d(d(i,i),er(h,ur(f,i)));return Rn(t)}(r);return 1<n?[t,nn(Tr(ir(r,cr(t,F)),$),Tr(r,$))]:t}),q.expm=function(n){if(y(n))return q.exp(n);b(n)&&B(n)===Q(n)||v("expm");var r,t,e,i=n,n=B(i),u=(V(1e-10),zr(n)),o=u,f=u,c=u,a=$,l=Vr([O,D($,L.floor(L.log2(Tr(i,T))))]),s=4*n*n;for(i=or(i,$n(F,l)),e=$,t=1;t<=s;++t)f=er(f,ur(a=On(K(a,D(H(s,t),$)),K(D(H(K(F,s),t),$),t)),c=d(i,c))),o=er(o,ur(K(e,a),c)),e=$===e?Z:$;for(r=vt(o,f),t=1,l=M(l);t<=l;++t)r=d(r,r);return r};var Rt=.254829592,Tt=-.284496736,Xt=1.421413741,zt=-1.453152027,Zt=1.061405429,Lt=.3275911;function Ot(n){n=jr(n);var r,t=L.sign(n)||1;return t<0&&(n=Fn(n)),r=Wn(D(K(Lt,n),$)),K(t,H($,K(D(K(D(K(D(K(D(K(Zt,r),zt),r),Xt),r),Tt),r),Rt),K(r,L.exp(Fn(K(n,n)))))))}function $t(r,n){if(y(r))return r;if(w(r))return r.length?nn(Gr(r),V(r.length)):s;if(b(r)){if(1===(n=M(n=null==n?1:n)))return U(Q(r),function(n){return $t(j(r,n))});if(2===n)return U(B(r),function(n){return $t(r[n])})}v("mean")}function Ct(r,n,t){if(n=M(n||0),y(r))return O;if(w(r))return 0===r.length?s:1===r.length?O:L.sqrt(nn(Gr(fr(Rr(ir(r,$t(r))),V(2))),V(1===n?r.length:r.length-1)));if(b(r)){if(1===(t=M(t=null==t?1:t)))return U(Q(r),function(n){return Ct(j(r,n))});if(2===t)return U(B(r),function(n){return Ct(r[n])})}v("std")}function Ft(e,n,i){if(i=M(i||0),2!==arguments.length||0!==M(n)&&1!==M(n)||(i=M(n),n=null),null==n){if(y(e))return O;var r;if(w(e))return e.length<=1?e.length?O:s:(t=e.length,r=$t(e),nn(Gr(ur(Pr(r=ir(e,r)),r)),V(1===i?t:t-1)));if(b(e))return S(Q(e),Q(e),function(n,r,t){return n===r?Ft(j(e,n),i):r<n?t[r][n]:Ft(j(e,n),j(e,r),i)})}else{if(y(e)&&y(n))return Xr(2,2);if(b(e)&&b(n)&&(e=Zr(e),n=Zr(n)),w(e)&&w(n)){if(e.length!==n.length)throw"cov: inputs not of same dimension";var t;return e.length<=1?e.length?O:s:(t=e.length,nn(Gr(ur(Pr(ir(e,$t(e))),ir(n,$t(n)))),V(1===i?t:t-1)))}}v("cov")}function Wt(n,r,t){for(var e,i=r.length,u=0,o=T,f=0;f<i;++f)r[f]&&r[f].length&&Xn(e=t(n,r[f]),o)&&(o=e,u=f);return[u,o]}function Ut(n){return n.length?$t(n):n}function Bt(i,n,r){return U(n,function(e){return Ut(r.reduce(function(n,r,t){return r===e&&n.push(i[t]),n},[]))})}function Qt(t,n,r,e){return t=t.slice(),U(n,function(n){var r=t.length?I.round(I.random()*(t.length-1)):-1;return-1<r?t.splice(r,1)[0]:[]})}function Vt(n,t,r,e){var i=n.length;return de(n.slice()).reduce(function(n,r){return!n.length||n[n.length-1].length+1>i/t?n.push([r]):n[n.length-1].push(r),n},[]).map(Ut)}function Gt(n,r,t,e){for(var i,u,o,f,c,a=n.length,l=[n[I.round(I.random()*(a-1))]],s=new Array(a);l.length<r;){for(o=O,u=0;u<a;++u)i=Wt(n[u],l,t)[1],s[u]=rr(Y(i,Yn(i))),o=D(o,s[u]);for(f=K(o,I.random()),c=O,u=0;u<a;++u)if(Ln(c=D(c,s[u]),f)){l.push(n[u]);break}}return l}function Dt(n,r){var t,e,i,u,o,f=n.length,c=r.length,a=f+c-1;if(!f||!c)return[];for(o=new Array(a),f<c&&(u=n,f=(n=r).length,c=(r=u).length),t=0;t<a;++t)for(o[t]=O,e=0;e<c;++e)0<=(i=t-e)&&i<f&&(o[t]=J(o[t],Y(n[i],r[e])));return o}function Ht(n,r,t){var e,i=[],u=n.slice(),o=u.length-r.length,f=r;if(0<=o)for(i=U(o+1,O);0<=o;){for(e=o,r=f.concat(U(o,O)),i[i.length-1-o]=nn(u[0],r[0]),u=ue(u,oe(r,[Jn(i[i.length-1-o])]));u.length&&P(u[0],O);)u.shift();if((o=u.length-f.length)===e)break}return[i,t?U(n.length-u.length,O).concat(u):u]}un.push(function(){Rt=V(.254829592),Tt=V(-.284496736),Xt=V(1.421413741),zt=V(-1.453152027),Zt=V(1.061405429),Lt=V(.3275911)}),q.erf=function(n){return qn(Ot,n,!0)},q.mean=$t,q.median=function r(t,n){if(y(t))return t;if(w(t))return t.length?1&(t=Br(t)).length?t[t.length>>1]:nn(J(t[t.length>>1],t[(t.length>>1)-1]),V(2)):s;if(b(t)){if(1===(n=M(n=null==n?1:n)))return U(Q(t),function(n){return r(j(t,n))});if(2===n)return U(B(t),function(n){return r(t[n])})}v("median")},q.mode=function r(t,n){if(y(t))return t;var e,i;if(w(t))return t.length?(e={},i=0,t.reduce(function(n,r){var t=r.toString(),t=on.call(e,t)?(e[t]+=1,e[t]):e[t]=1;return i<t?(i=t,n=r):t===i&&Bn(r,n)&&(n=r),n},{})):s;if(b(t)){if(1===(n=M(n=null==n?1:n)))return U(Q(t),function(n){return r(j(t,n))});if(2===n)return U(B(t),function(n){return r(t[n])})}v("mode")},q.moment=function r(t,e,n){if(y(t))return O;var i;if(w(t))return t.length<=1?t.length?O:s:(i=t.length,nn(Gr(fr(ir(t,$t(t)),e)),V(i)));if(b(t)){if(1===(n=M(n=null==n?1:n)))return e=V(e),U(Q(t),function(n){return r(j(t,n),e)});if(2===n)return e=V(e),U(B(t),function(n){return r(t[n],e)})}v("moment")},q.std=Ct,q.var=function r(t,e,n){if(e=M(e||0),y(t))return O;var i,u;if(w(t))return t.length<=1?t.length?O:s:(i=t.length,u=$t(t),nn(Gr(ur(Pr(u=ir(t,u)),u)),V(1===e?i:i-1)));if(b(t)){if(1===(n=M(n=null==n?1:n)))return U(Q(t),function(n){return r(j(t,n),e)});if(2===n)return U(B(t),function(n){return r(t[n],e)})}v("var")},q.cov=Ft,q.corrcoef=function e(i,r){if(null==r){if(y(i)||w(i))return $;if(b(i))return S(Q(i),Q(i),function(n,r,t){return n===r?$:r<n?t[r][n]:e(j(i,n),j(i,r))})}else{if(y(i)&&y(r))return $;if(w(i)&&w(r)){if(i.length!==r.length)throw"corrcoef: inputs not of same dimension";return Ir(i,r)}if(b(i)&&b(r)){if(B(i)!==B(r)||Q(i)!==Q(r))throw"corrcoef: inputs not of same dimension";return U(Q(i),function(n){return e(j(i,n),j(r,n))})}}v("corrcoef")},q.corr=Nn(function(n,t){if(1<n)throw"corr: only one output is supported";b(t=y(t)?[[t]]:t)||v("corr");var e,n=2,i=Ir;if(n<arguments.length&&k(arguments[n])?(e=arguments[n],++n):e=t,n<arguments.length&&"Type"===arguments[n])switch(arguments[n+1]){case"Spearman":i=qr;break;case"Kendall":i=Er;break;default:i=Ir}return b(e)&&B(t)===B(e)||v("corr"),S(Q(t),Q(e),function(n,r){return i(j(t,n),j(e,r))})}),q.tiedrank=Nn(function(n,r,t,e){if(1<n)throw"tiedrank: only one output is supported";r=N(r=y(r)?[r]:r);var i=P(O,t)&&P($,e);return b(r)?Or(U(Q(r),function(n){return _r(j(r,n),i)})):_r(r,i)}),q.pdist=function(n){var i,u,r=gr;if(b(n=w(n)?kn(n):n)||v("pdist"),1<arguments.length)switch(arguments[1]){case"fasteuclidean":case"euclidean":r=gr;break;case"fastsquaredeuclidean":case"squaredeuclidean":r=pr;break;case"fastseuclidean":case"seuclidean":u=k(arguments[2])?N(arguments[2]):Ct(n),r=function(n,r,t,e){return dr(n,r,u[t])};break;case"mahalanobis":u=yt(u=k(arguments[2])?arguments[2]:Ft($r(n))),i=$t($r(n)),r=function(n,r,t,e){return L.sqrt(vr(r,i,u))};break;case"cityblock":r=br;break;case"minkowski":u=y(arguments[2])?arguments[2]:F,r=function(n,r,t,e){return yr(n,r,u)};break;case"chebychev":r=wr;break;case"cosine":r=xr;break;case"correlation":r=kr;break;case"hamming":r=Sr;break;case"jaccard":r=Ar}for(var t,e=[],o=Q(n),f=0;f<o;++f)for(t=f+1;t<o;++t)e.push(r(j(n,t),j(n,f),t,f));return e},q.pdist2=function(e,i){var u,o,f=gr;if(w(e)&&(e=kn(e)),w(i)&&(i=kn(i)),b(e)&&b(i)&&B(e)===B(i)||v("pdist2"),2<arguments.length)switch(arguments[2]){case"fasteuclidean":case"euclidean":f=gr;break;case"fastsquaredeuclidean":case"squaredeuclidean":f=pr;break;case"fastseuclidean":case"seuclidean":o=k(arguments[3])?N(arguments[3]):Ct(e),f=function(n,r,t,e){return dr(n,r,o[t])};break;case"mahalanobis":o=yt(o=k(arguments[3])?arguments[3]:Ft($r(e))),u=$t($r(e)),f=function(n,r,t,e){return L.sqrt(vr(r,u,o))};break;case"cityblock":f=br;break;case"minkowski":o=y(arguments[3])?arguments[3]:F,f=function(n,r,t,e){return yr(n,r,o)};break;case"chebychev":f=wr;break;case"cosine":f=xr;break;case"correlation":f=kr;break;case"hamming":f=Sr;break;case"jaccard":f=Ar}return S(Q(e),Q(i),function(n,r,t){return n<=r?f(j(e,n),j(i,r),n,r):t[r][n]})},q.mahal=function(e,n){w(n)&&(n=kn(n)),w(e)&&(e=kn(e)),b(n)&&b(e)&&B(n)===B(e)||v("mahal");var r=$r(n),i=yt(Ft(r)),u=$t(r);return S(Q(e),Q(n),function(n,r,t){return n<=r?vr(j(e,n),u,i):t[r][n]})},q.squareform=function(n,r){var t,e,i,u,o,f;if(w(n=N(n))||"tomatrix"===r){if(y(n))n=[n];else if(b(n))return n;for(e=n.length,t=S(i=I.round((I.sqrt(1+8*e)+1)/2),i,O),u=f=0;u<i;++u)for(o=u+1;o<i;++o)t[o][u]=n[f++],t[u][o]=t[o][u]}else if(b(n)||"tovector"===r){if(y(n))n=[[O,n],[n,O]];else if(w(n))return n;for(e=B(n),t=[],u=0;u<e;++u)for(o=u+1;o<e;++o)t.push(n[o][u])}return t},q.kmeans=Nn(function(n,i,r){var t,e=3,u=Gt,o=pr,f=100;for(b(i)||v("kmeans");e<arguments.length;){if("Start"===arguments[e])if(b(arguments[e+1])){if(Q(u=arguments[e+1])!==Q(i))throw"kmeans: centroids and input must have same number of columns";r=B(u)}else switch(arguments[e+1]){case"cluster":break;case"uniform":u=Vt;break;case"sample":u=Qt;break;default:u=Gt}else if("Distance"===arguments[e])switch(arguments[e+1]){case"hamming":o=Sr;break;case"correlation":o=kr;break;case"cosine":o=xr;break;case"cityblock":o=br;break;case"euclidean":o=gr;break;default:o=pr}else"MaxIter"===arguments[e]&&(f=I.ceil(I.abs(M(Sn(arguments[e+1],!0)))));e+=2}return(t=function(n,r,t,e,i,u){var o,f,c,a,l=B(n),s=(Q(n),n.map(function(n){return Wt(n,t,e)[0]}));for(t=Bt(n,r,s),o=1;o<=i;++o){for(f=a=0;f<l;++f)c=Wt(n[f],t,e)[0],s[f]!==c&&++a,s[f]=c;if(0===a)break;t=Bt(n,r,s)}return[s,t]}(i,r,b(u)?u:u(i,r,o,!1),o,f,!1))[0]=t[0].map(function(n){return n+1}),1===n?t=t[0]:2<n&&(t.push(U(r,function(e){return idx.reduce(function(n,r,t){return n=r===e?J(n,o(i[t],C[e])):n},O)})),3<n)&&t.push(S(B(i),r,function(n,r){return o(i[n],C[r])})),t}),q.pwcdanneal=function(n,i){((i=I.round(M(Sn(i,!0))))<=0||!b(n)||B(n)!==Q(n))&&v("pwcdanneal");for(var r=2,t=.75,e=100;r<arguments.length;)"Alpha"===arguments[r]?t=I.abs(M(Sn(arguments[r+1],!0))):"MaxIter"===arguments[r]&&(e=I.ceil(I.abs(M(Sn(arguments[r+1],!0))))),r+=2;var u=function(n,r,t,e){null==e&&(e=100),null==t&&(t=.75);for(var i,u,o,f,c,a,l,s,h,m,g,p,d,v,y,w,b=B(n),x=S(b,r,function(){return I.random()}),k=0;k<b;++k){for(l=v=0;l<r;++l)v+=x[k][l];for(l=0;l<r;++l)x[k][l]/=v}for(u=S(b,r,function(){return I.random()}),i=S(b,r,0),c=(f=M(L.sqrt(K(Tr(n,$),Tr(n,T)))))/1e3,n=An(n),w=S(b,r,0),y=U(r,0),o=f;t<1&&c<o;){for(h=1;h<=e;++h){for(s=i,i=u,u=s,k=0;k<b;++k){for(g=x[k],p=i[k],l=v=0;l<r;++l)v+=I.exp(-p[l]/o);for(l=0;l<r;++l)g[l]=I.exp(-p[l]/o)/v}for(l=0;l<r;++l){for(a=v=0;a<b;++a)v+=x[a][l];y[l]=v}for(k=0;k<b;++k)for(g=w[k],l=0;l<r;++l){for(a=v=0;a<b;++a)v+=n[k][a]*x[a][l];g[l]=v}for(k=m=0;k<b;++k)for(g=x[k],p=u[k],l=0;l<r;++l){for(d=y[l]-g[l],a=v=0;a<b;++a)v+=x[a][l]*(n[k][a]-w[a][l]/(2*d));p[l]=v/(1+d),m=I.max(m,I.abs(p[l]-i[k][l]))}if(m<=1e-6)break}o*=t}return x}(n,i,t,e);return U(B(u),function(n){for(var r=u[n],t=0,e=1;e<i;++e)r[e]>r[t]&&(t=e);return t+1})},q.conv=function(n,r){return(y(n)||y(r)?ur:(n=N(n),r=N(r),w(n)&&w(r)||v("conv"),Dt))(n,r)},q.deconv=Nn(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[or(r,t),O]:or(r,t);else{if(r=N(r),t=N(t),w(r)&&w(t)||v("deconv"),!t.length||1===t.length&&P(t[0],O))throw"deconv: divisor is zero";e=Ht(r,t,!0)}return 1<n?e:e[0]}),q.conv2=function(r,t){if(y(r)||y(t))return ur(r,t);if(w(r)){if(w(t))return Dt(r,t);if(b(t))return U(Q(t),function(n){return Dt(r,j(t,n))})}else{if(w(t)){if(w(r))return Dt(r,t);if(b(r))return U(r[0].length,function(n){return Dt(j(r,n),t)});throw"conv2: input 1 not supported"}if(!b(r))throw"conv2: input 1 not supported";if(b(t)){var n,e,i,u,o,f,c,a,l,s,h,m,g,p=r,d=t;for(B(p)<B(d)&&(g=p,p=d,d=g),n=B(p),e=Q(p),o=Xr(f=n+(i=B(d))-1,c=e+(u=Q(d))-1),l=0;l<f;++l)for(s=0;s<c;++s){for(a=O,h=0;h<=l&&!(n<=h);++h)if(!(i<=l-h))for(m=0;m<=s&&!(e<=m);++m)u<=s-m||(a=J(a,Y(p[h][m],d[l-h][s-m])));o[l][s]=a}return o}}throw"conv2: input 2 not supported"},q.filter=function(n,r,t,e,i){n=N(n),r=N(r),t=N(t),w(n)&&w(r)&&w(t)||v("filter");var u,o,f,c,a=n,l=r,s=t,h=s.length,m=l.length,g=a.length,p=new Array(h),d=l[0];for(l=l.map(function(n){return nn(n,d)}),a=a.map(function(n){return nn(n,d)}),u=0;u<h;++u){for(c=O,f=u,o=0;0<=f&&o<g;++o,--f)c=J(c,Y(a[o],s[f]));for(f=u-1,o=1;0<=f&&o<m;++o,--f)c=Hn(c,Y(l[o],p[f]));p[u]=c}return p};var Kt={},Jt={};function Yt(n,r){for(var t,e,i=n.length,u={},o=0;o<i;++o)1!==u[o]&&(e=n[t=function(n,r){for(var t=0;1<r;)t=(t<<1)+(1&n),n>>=1,r>>=1;return t}(o,i)],r[t]=n[o],r[o]=e,u[t]=1)}function ne(n,r,t){var e,i,u=n.length;if(1===u)t[0]=n[0];else{for(e=0;e<u;++e)t[e]=new _(O,O);for(var o,f,c,a,l,s,h=function(n){for(var r=I.sqrt(n),t=3;t<=r;){if(0==n%t)return t;t+=2}return n}(u),m=u/h,g=V(1/I.sqrt(h)),p=new Array(m),d=new Array(m),v=0;v<h;++v){for(e=0;e<m;++e)p[e]=n[e*h+v];for(1<m&&(ee(p,r,d),i=p,p=d,d=i),o=V(I.cos(2*R*v/u)),f=V((r?-1:1)*I.sin(2*R*v/u)),c=$,a=O,e=0;e<u;++e)l=K(g,p[e%m].re),s=K(g,p[e%m].im),t[e]=t[e].add(new _(H(K(l,c),K(s,a)),D(K(s,c),K(l,a)))),l=H(K(c,o),K(a,f)),s=D(K(c,f),K(a,o)),c=l,a=s}}}var re=I.SQRT1_2;function te(n,r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d,v,y,w,b=n.length,x=1;for(Yt(n,t);x<b;){for(e=V((w=void 0,null==(w=Jt[y=x])&&(Jt[y]=w=I.cos(R/y)),w)),i=V((r?-1:1)*(y=void 0,null==(y=Kt[w=x])&&(Kt[w]=y=I.sin(R/w)),y)),o=b/(2*x),u=0;u<o;++u)for(l=$,s=O,f=0;f<x;++f)g=t[h=2*u*x+f].re,p=t[h].im,c=t[m=h+x].re,a=t[m].im,d=H(K(l,c),K(s,a)),v=D(K(s,c),K(l,a)),t[h]=new _(K(D(g,d),re),K(D(p,v),re)),t[m]=new _(K(H(g,d),re),K(H(p,v),re)),c=H(K(l,e),K(s,i)),a=D(K(l,i),K(s,e)),l=c,s=a;x<<=1}}function ee(n,r,t){var e,i=n.length;if(!(i<=0))return e=!1,null==t&&(t=new Array(i),e=!0),(i&i-1?ne:te)(n,r,t),e?t:void 0}function ie(n,r,t){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,o,f=!1,c=new Array(e),a=new Array(i),l=new Array(e),s=new Array(i);if(null==t){for(t=new Array(e),u=0;u<e;++u)t[u]=new Array(i);f=!0}for(o=0;o<i;++o,0){for(u=0;u<e;++u)c[u]=n[u][o];for(ee(c,r,l),u=0;u<e;++u)t[u][o]=l[u]}for(u=0;u<e;++u){for(o=0;o<i;++o,0)a[o]=t[u][o];for(ee(a,r,s),o=0;o<i;++o,0)t[u][o]=s[o]}return f?t:void 0}}function ue(n,r){for(var t=n.length-1,e=r.length-1,i=[];0<=t&&0<=e;)i.unshift(J(n[t--],r[e--]));for(;0<=t;)i.unshift(n[t--]);for(;0<=e;)i.unshift(r[e--]);return i}un.push(function(){re=V(I.SQRT1_2)}),q.fft=function(r){return b(r=N(r))?U(Q(r),function(n){return Rn(ee(Tn(j(r,n)),!1))}):w(r)?Rn(ee(Tn(r),!1)):void v("fft")},q.ifft=function(r){return b(r=N(r))?U(Q(r),function(n){return Rn(ee(Tn(j(r,n)),!0))}):w(r)?Rn(ee(Tn(r),!0)):void v("ifft")},q.fft2=function(n){return b(n)||v("fft2"),Rn(ie(Tn(n),!1))},q.ifft2=function(n){return b(n)||v("ifft2"),Rn(ie(Tn(n),!0))};var oe=Dt,fe=Ht;function ce(n,r){if(!n.length)return O;r=r||O;for(var t=n.length,e=0,i=n[0];e+1<t;)++e,i=J(Y(i,r),n[e]);return i}function ae(r){if(r.length<=1)return[];var n,t,e,i,u,o,f,c,a,l,s,h,m,g=r.length-1,p=V(1e-10),d=new _(p,O),v=new _(O,O),y=new _($,O);for(r=r.map(V),l=function(n){return ce(r,n)},s=function(n){return nn(Hn(l(J(n,d)),l(n)),d)},n=r.map(function(n){return _(n).abs()}),o=n.length-1;0<o&&G(n[o],O);)--o;for(e=D(On(Vr(n.slice(0,o))||O,Vr([n[o],$])),$),t=On(n[0],Vr(D(n[0],Vr(n.slice(1))))),i=U(g,function(){return new _(D(t,K(H(e,t),I.random())),V(I.random()*R/2),"polar")}),a=1;a<=1e4;++a){for(o=u=0;o<g;++o){if(f=i[o],h=l(f),G((m=s(f)).re,O)&&G(m.im,O)){if(Zn(L.abs(h.re),p)&&Zn(L.abs(h.im),p)){++u;continue}c=new _(e,O)}else c=h.div(m);h=c.div(y.sub(c.mul(i.reduce(function(n,r,t){return n=t===o||G(f.re,r.re)&&G(f.im,r.im)?n:n.add(f.sub(r).inv())},v)))),Zn(L.abs(h.re),p)&&Zn(L.abs(h.im),p)&&++u,i[o]=f.sub(h)}if(u===g)break}return i}function le(n,r){for(var t,e,i,u=O,o=I.min(n.length,r.length)-1,f=0;f<o;++f)t=n[f],i=n[f+1],e=r[f],u=D(u,On(H(K(t,r[f+1]),K(e,i)),F));return 1<o&&(t=n[o],i=n[0],e=r[o],u=D(u,On(H(K(t,r[0]),K(e,i)),F))),u}function se(u,o){var f,n,r,t,e,i,c,a,l,s,h=u.length,m=U(h,function(n){return n});if(h<3)return m;for(f=0,n=1;n<h;++n)(Xn(o[n],o[f])||G(o[n],o[f])&&Xn(u[n],u[f]))&&(f=n);for(m.splice(f,1),--h,m=m.map(function(n){return[(r=u[f],t=o[f],e=u[n],i=o[n],Bn(i=L.atan2(H(i,t),H(e,r)),O)?D(i,2*R):i),n];var r,t,e,i}).sort(function(n,r){return Xn(n[0],r[0])?-1:zn(n[0],r[0])?1:0}).map(function(n){return n[1]}),(r=new Array(h+1))[0]=f,r[1]=m[0],r[2]=m[1],t=3,n=2;n<h;++n){for(;1<t&&Zn(O,(e=u[m[n]],i=o[m[n]],c=u[r[t-1]],a=o[r[t-1]],l=u[r[t-2]],s=o[r[t-2]],e=H(e,l),c=H(c,l),l=H(i,s),i=H(a,s),H(K(e,i),K(l,c))));)--t;r[t++]=m[n]}return r.length=t,r}function he(){var n,r,t,e,i=arguments,u=i.length;if(0===u)return O;for(e=0;e<u&&G(O,n=i[e++]););for(n=L.abs(n);e<u;){if(G(n,$))return $;for(;e<u&&G(O,r=i[e++]););if(G(r=L.abs(r),$))return $;if(!G(r,n)){if(G(r,O))break;for(Xn(n,r)&&(t=r,r=n,n=t);!G(O,r);)r=Cn(n,t=r),n=t}}return n}function me(n){var r,t,e,i,u=n.length,o=$,f=O,c=O,a=$,l=$,s=$;if(0!==u){if(r=n[0],zn(O,r)&&(r=L.abs(r),l=Z),1===u)return[r,l];if(i=2===u?[n[1],$]:me(n.slice(1)),t=i[0],zn(O,t)&&(t=L.abs(t),s=Z),G(O,r))return U(i.length+1,function(n){return 0===n?t:1===n?l:K(s,i[n-1])});if(G(O,t))return U(i.length+1,function(n){return 0===n?r:1===n?l:K(s,i[n-1])});for(;;){if(e=L.floor(On(r,t)),r=Cn(r,t),o=H(o,K(e,c)),f=H(f,K(e,a)),G(O,r))return c=K(c,l),a=K(a,s),U(i.length+1,function(n){return 0===n?t:1===n?c:K(a,i[n-1])});if(e=L.floor(On(t,r)),t=Cn(t,r),c=H(c,K(e,o)),a=H(a,K(e,f)),G(O,t))return o=K(o,l),f=K(f,s),U(i.length+1,function(n){return 0===n?r:1===n?o:K(f,i[n-1])})}}}function ge(n,r){var t=L.abs(n);return G(t,L.abs(r))?G(n_sign(n),n_sign(r))?t:Fn(t):K(On(n,he(n,r)),r)}q.polydiv=Nn(function(n,r,t){var e;if(y(r)||y(t))e=1<n?[or(r,t),O]:or(r,t);else{if(r=N(r),t=N(t),w(r)&&w(t)||v("polydiv"),!t.length||1===t.length&&P(t[0],O))throw"polydiv: divisor is zero";e=fe(r,t,!1)}return 1<n?e:e[0]}),q.polyval=function(r,n){return w(r=N(r))||v("polyval"),y(n)?Rn(ce(r,n)):w(n)?n.map(function(n){return Rn(ce(r,n))}):void v("polyval")},q.polyvalm=function(r,n){return w(r=N(r))||v("polyvalm"),b(n)&&B(n)===Q(n)?Rn(function(n,r){if(!n.length)return Xr(B(r),Q(r));for(var t=n.length,e=0,i=B(r),u=zr(i,n[0]);e+1<t;)++e,u=er(d(u,r),zr(i,n[e]));return u}(r,n)):y(n)?Rn(ce(r,n)):w(n)?n.map(function(n){return Rn(ce(r,n))}):void v("polyvalm")},q.polyfit=function(n,r,i){if(n=N(n),r=N(r),w(n)&&w(r)||v("polyfit"),n.length!==r.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return Rn(function(e,i){var n,u,o,r,t,f,c,a;if(!(w(e)&&e.length&&w(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),o=I.min(e.length,i.length),e.length=o,i.length=o,c={},a=[],u=0;u<o;++u)if(f=String(e[u]),on.call(c,f)){if(!P(i[c[f]],i[u]))return[];a.push(u)}else c[f]=u;for(;a.length;)u=a.pop(),e.splice(u,1),i.splice(u,1);for(a=c=null,r=U(o=e.length,function(n){for(var r=$,t=0;t<o;++t)t!==n&&(r=Y(r,Hn(e[n],e[t])));return r=nn(i[n],r)}),t=U(o,function(n){return[$,Jn(e[n])]}),n=[],u=0;u<o;++u)n=ue(n,t.reduce(function(n,r,t){return n=t!==u?oe(n,r):n},[r[u]]));return n}(n,r));if(!p(i)||M(i)<0)throw"polyfit: input 3 not positive int";return i=M(i),Rn(d(xt(n.reduce(function(n,r){for(var t=1,e=[$];t<=i;++t)e.unshift(Y(r,e[0]));return n.push(e),n},[])),r))},q.roots=function(n){return w(n=N(n))||v("roots"),Rn(ae(n).sort(function(n,r){return Xn(jr(n),jr(r))?-1:zn(jr(n),jr(r))?1:0}))},q.compan=function(n){return w(n=N(n))||v("compan"),S((t=n).length-1,t.length-1,function(n,r){return 0===n?Jn(nn(t[r+1],t[0])):r+1===n?$:O});var t},q.poly=function(n){return b(n=N(n))&&q.charpoly?q.charpoly(n):(w(n)||v("poly"),Rn(n.reduce(function(n,r){return oe(n,[$,Jn(r)])},[$])))},q.cart2pol=Nn(function(n,r,t,e){return[q.atan2(t,r),q.sqrt(er(fr(r,F),fr(t,F))),e]},3),q.pol2cart=Nn(function(n,r,t,e){return[ur(t,q.cos(r)),ur(t,q.sin(r)),e]},3),q.cart2sph=Nn(function(n,r,t,e){var i=er(fr(r,F),fr(t,F));return[q.atan2(t,r),q.atan2(e,q.sqrt(i)),q.sqrt(er(i,fr(e,F)))]},3),q.sph2cart=Nn(function(n,r,t,e){return[ur(e,ur(q.cos(t),q.cos(r))),ur(e,ur(q.cos(t),q.sin(r))),ur(e,q.sin(t))]},3),q.polyarea=function(r,t){return r=N(r),t=N(t),b(r)&&b(t)?(B(r)===B(t)&&Q(r)===Q(t)||v("polyarea"),U(Q(r),function(n){return le(j(r,n),j(t,n))})):w(r)&&w(t)?(r.length!==t.length&&v("polyarea"),le(r,t)):void v("polyarea")},q.convhull=Nn(function(n,r,t,e){3<arguments.length&&v("convhull"),b(r)&&2===Q(r)?(t=j(r,1),r=j(r,0)):(r=N(r),t=N(t)),w(r)&&w(t)&&r.length===t.length||v("convhull");var i=se(r,t);return 1<n?[i.map(function(n){return n+1}),le(i.map(function(n){return r[n]}),i.map(function(n){return t[n]}))]:i.map(function(n){return n+1})}),q.mod=function(n,t){return P(t=Sn(t||0),0)?n:qn(function(n){var r;return W(n)?Xn(r=Cn(n,t),0)&&zn(t,0)?D(r,t):r:n},n,!0)},q.gcd=Nn(function(n,r,t){return function t(e,i,u){if(u){var o,f;if(k(e)){if(o=new Array(e.length),k(i))return e.length!==i.length&&v("gcd"),f=new Array(i.length),[e.map(function(n,r){return n=t(n,i[r],u),o[r]=n[1],f[r]=n[2],n[0]}),o,f];if(p(i))return f=new Array(e.length),[e.map(function(n,r){return n=t(n,i,u),o[r]=n[1],f[r]=n[2],n[0]}),o,f]}if(p(e)){if(k(i))return o=new Array(i.length),f=new Array(i.length),[i.map(function(n,r){return n=t(e,n,u),o[r]=n[1],f[r]=n[2],n[0]}),o,f];if(p(i))return me([e,i])}}else{if(k(e)){if(k(i))return e.length!==i.length&&v("gcd"),e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(k(i))return i.map(function(n,r){return t(e,n)});if(p(i))return he(e,i)}}v("gcd")}(r,t,1<n)}),q.lcm=function t(e,i){if(k(e)){if(k(i))return e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(k(i))return i.map(function(n,r){return t(e,n)});if(p(i))return function(){var n,r,t=arguments,e=t.length;if(e<=1)return 1===e?t[0]:O;if(G(O,t[0])||G(O,t[1]))return O;for(r=ge(t[0],t[1]),n=2;n<e;++n){if(G(O,t[n]))return O;r=ge(r,t[n])}return r}(e,i)}return e};var pe=[V(2),V(3),V(5),V(7),V(11),V(13),V(17),V(19),V(23),V(29),V(31),V(37),V(41),V(43),V(47),V(53),V(59),V(61),V(67),V(71),V(73),V(79),V(83),V(89),V(97),V(101),V(103),V(107),V(109)];function de(n){for(var r,t,e=1+(n.length-1);1<e--;)r=I.round(I.random()*+e),t=n[0+e],n[0+e]=n[0+r],n[0+r]=t;return n}function ve(t){for(var n=(t=[].map.call(t,function(n){return k(n)||v("combinations"),Zr(n)})).map(function(n){return n.length}),r=U(n.length,0),e=[];r&&r.length;)e.push(r.map(function(n,r){return t[r][n]})),r=function(n,r){for(var t,e=r.length-1,i=e;0<=i&&i<=e&&n[i]+1===r[+i+0];)--i;if(0<=i&&i<=e)for(n[i]=n[i]+1,t=i+1;0<=t&&t<=e;t+=1)n[t]=0;else n=null;return n}(r,n);return e}function ye(n){if(E(n))return 0<n.length;if(mn(n))return!1;if(u(n))return 0!==n;if(pn(n))return!n.eq(O);if(o(n))return!G(n.re,O)||!G(n.im,O);if(k(n)){if(!n.length)return!1;for(var r=0,t=n.length;r<t;++r)if(!ye(n[r]))return!1;return!0}return!0===n}un.push(function(){pe=[V(2),V(3),V(5),V(7),V(11),V(13),V(17),V(19),V(23),V(29),V(31),V(37),V(41),V(43),V(47),V(53),V(59),V(61),V(67),V(71),V(73),V(79),V(83),V(89),V(97),V(101),V(103),V(107),V(109)]}),q.factor=function(n){for(var r,t,e=L.floor(L.abs(jr(Sn(n)))),i=V(1e30),u=[],o=e,f=0,c=pe.length;f<c;++f){if(G(o,r=pe[f]))return[r];if(zn(t=K(r,r),e)||null!=i&&zn(t,i))break;for(;G(O,Cn(e,r));)u.push(r),e=On(e,r)}if(c<=f)for(t=K(r=D(r,F),r);Zn(t,e)&&(null==i||Zn(t,i));){for(;G(O,Cn(e,r));)u.push(r),e=On(e,r);t=K(r=D(r,F),r)}return zn(e,$)&&u.push(e),u},q.randperm=function(n){return(!p(n=I.round(M(n||0)))||n<=0)&&v("randperm"),de(U(n,function(n){return n+1}))},q.perms=function(r){w(r=N(r))||v("perms");for(var n=U(r.length,function(n){return n}),t=[];n&&n.length;)t.push(n.map(function(n){return r[n]})),n=function(n){for(var r,t,e,i,u=n.length-1,o=u,f=o-1;0<=f&&f<=u&&+n[f]>=+n[f+1];)--f;if(0<=f&&f<=u){for(r=o;0<=r&&r<=u&&0<r-f&&+n[f]>=+n[r];)--r;for(t=n[f],n[f]=n[r],n[r]=t,e=f+1,i=o;0<=e&&e<=u&&0<=i&&i<=u&&0<i-e;)t=n[e],n[e]=n[i],n[i]=t,e+=1,--i}else n=null;return n}(n);return t},q.combinations=function(){return ve(arguments)},q.string=function n(r){return k(r)?r.map(n):E(r)?r:String(r)},q.strlength=function(n){if(E(n))return n.length;v("strlength")},q.char=function n(r){return r=N(r),k(r)?r.map(n):E(r)?r.split(""):p(r)?String.fromCharCode(M(r)):String(r)},q.lower=q.tolower=function n(r){return k(r)?r.map(n):E(r)?r.toLowerCase():r},q.upper=q.toupper=function n(r){return k(r)?r.map(n):E(r)?r.toUpperCase():r},q.dec2bin=function n(r){return k(r)?r.map(n):u(r)?r.toString(2):pn(r)?r.toBinary():r},q.bin2dec=function n(r){return k(r)?r.map(n):E(r)?parseInt(r,2):r},q.dec2hex=function n(r){return k(r)?r.map(n):u(r)?r.toString(16):pn(r)?r.toHexadecimal():r},q.hex2dec=function n(r){return k(r)?r.map(n):E(r)?parseInt(r,16):r};var we={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var r=[],t=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?t.length&&(k(t[0])?r=r.length?Lr("vert",r,t):t:r.push(t),t=[]):!ln(n,Ae)&&k(n)?t=t.length?Lr("horz",t,n):n:t.push(n))}),t.length&&(k(t[0])?r=r.length?Lr("vert",r,t):t:r.length?r.push(t):r=t),r}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return q.colon(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r){return Zr(n,r)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r,t){return Zr(n,r,t)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return q.ctranspose(n)}},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:function(n){return q.transpose(n)}},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:cr},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:fr},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,r){return vt(n,r)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:or},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:or},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:function(n,r){return d(n=yn(n)?xn(n):n,r=yn(r)?xn(r):r)}},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:ur},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:er},"-":{name:"sub",arity:2,arityalt:1,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:function(n,r){return 1===arguments.length?ar(n):ir(n,r)}},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Gn},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Vn},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Qn},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Bn},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Un},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:P},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,r){return ye(n)&&ye(r)?$:O}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){return ye(n)||ye(r)?$:O}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){n=ye(n),r=ye(r);return n&&!r||r&&!n?$:O}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return ye(n)?O:$}},"=":{name:"set",breakpoint:"set",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,r){var t,e;return k(n)&&ln(n[0],Ae)?(e=n,k(t=r)?await Promise.all(e.map(function(n,r){return be(n,r<t.length?t[r]:null)})):await Promise.all(e.map(function(n,r){return be(n,0===r?t:null)}))):be(n,r.$scilitevarargout$?r[0]:r)}}};async function be(n,r){if(ln(n,Ae)&&E(n.v))return await n.set(r),n.get(!0);throw"setting non-variable"}async function xe(n,r,t){var e,i,u,o,f,c,a=null;if(ye(await qe(n.if.cond,r,t))){for(e=0,o=(f=n.if.statements).length;e<o;++e)null!=(c=await qe(f[e],r,t))&&(a=c);return a}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(ye(await qe(n.elseif[i].cond,r,t))){for(e=0,o=(f=n.elseif[i].statements).length;e<o;++e)null!=(c=await qe(f[e],r,t))&&(a=c);return a}if(n.else.statements.length){for(e=0,o=(f=n.else.statements).length;e<o;++e)null!=(c=await qe(f[e],r,t))&&(a=c);return a}}async function ke(n,r,t){var e,i,u,o,f,c,a,l,s=[],h=!1,m=!1,g=await qe(n.val,r,t),p=n.statements;if(s.$scilitevarargout$=!0,k(g)){for(c=(t=t||{}).brk,a=t.cont,t.brk=function(){h=!0},t.cont=function(){m=!0},u=0,o=(l=wn(g=N(g)))?Q(g):g.length;u<o;++u){for(m=h=!1,await n.ind.set(l?j(g,u):g[u]),e=0,i=p.length;e<i&&(f=await qe(p[e],r,t),!h&&!m);++e)null!=f&&s.push(f);if(h)break}t.brk=c,t.cont=a}return s}async function Se(n,r,t){var e,i,u,o,f,c=[],a=!1,l=!1,s=n.statements;for(c.$scilitevarargout$=!0,o=(t=t||{}).brk,f=t.cont,t.brk=function(){a=!0},t.cont=function(){l=!0};ye(await qe(n.cond,r,t));){for(l=a=!1,e=0,i=s.length;e<i&&(u=await qe(s[e],r,t),!a&&!l);++e)null!=u&&c.push(u);if(a)break}return t.brk=o,t.cont=f,c}function Ae(n,r,t){if(!ln(this,Ae))return new Ae(n,r,t);this.ctx=n,this.v=r,this.i=t}async function _e(n){return ln(n,Ae)?await n.get():n}function Ie(n,r){if(!ln(this,Ie))return new Ie(n,r);null==r&&(r=n,n=""),this.op=n,this.arg=r}async function qe(n,r,t){if(ln(n,Ie))return Ne(n,r,t);if(k(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await qe(n[e],r,t);return u}return n}function Ee(v,y,w,i){var b,x=0,k=0,u=v;function S(n,r,t){null==t&&(t=k),null==r&&(r=x);var e=u.split("\n")[t];return(n=String(n)+" at line "+String((w||0)+t)+" position "+String((i||0)+r)+":")+"\n"+e+"\n"+new Array(r+1).join(" ")+"^\n"}return function i(n){var r,t,e,u,o,f,c,a=[],l=[],s=[];function h(n){var r,t,e,i,u,o,f,c;if(l.length)if(n)for(;0<l.length;){if(u=(i=l.shift())[0],n===(o=we[u]).breakpoint){l.unshift(i);break}if(o.arity>a.length){if(!(null!=o.arityalt&&o.arityalt<=a.length))throw S('invalid or missing argument for "'+u+'"',i[1],i[2]);c=a.splice(0,o.arityalt).reverse()}else c=a.splice(0,o.arity).reverse();f=Ie(o.fn,c),a.unshift(f)}else if(t=(r=l.shift())[0],1===(e=we[t]).fixity){if(e.arity>a.length){if(!(null!=e.arityalt&&e.arityalt<=a.length))throw S('invalid or missing argument for "'+t+'"',r[1],r[2]);c=a.splice(0,e.arityalt).reverse()}else c=a.splice(0,e.arity).reverse();f=Ie(e.fn,c),a.unshift(f)}else{if(-1!==e.fixity)for(;0<l.length&&(u=(i=l[0])[0],(o=we[u]).priority<e.priority||o.priority===e.priority&&(o.associativity<e.associativity||o.associativity===e.associativity&&-1===o.associativity));){if(o.arity>a.length){if(!(null!=o.arityalt&&o.arityalt<=a.length))throw S('invalid or missing argument for "'+u+'"',i[1],i[2]);c=a.splice(0,o.arityalt).reverse()}else c=a.splice(0,o.arity).reverse();f=Ie(o.fn,c),a.unshift(f),l.shift()}l.unshift(r)}}function m(n){if(h(!0),1<a.length||0<l.length)throw S("mismatched terms and operators",l.length?l[0][1]:x,l.length?l[0][2]:k);!0===n&&(ln(a[0],Ie)&&s.push(a[0]),a=[],l=[])}function g(n,r){var t,e=n.test?v.match(n):n===v.slice(0,n.length);return!!e&&(!1===r?n.test?e:[n,n]:n.test?(t=e[r||0].length,v=v.slice(t),x+=t,e):(t=n.length,v=v.slice(t),x+=t,[n,n]))}function p(n,r,t){for(var e,i=t||0,u="";i<v.length;)if(n===(e=v.charAt(i))){if(!(i+1<v.length&&n===v.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return r&&(v=v.slice(i+1),x+=i+1),[u,i+1]}function d(){var n,r,t,e=function(n,r,t){for(var e,i=0,u=0;i<v.length;)if(e=v.charAt(i),!t||'"'!==e&&"'"!==e){if(r===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=p(e,!1,i+1)[1];return u||i>=v.length?-1:i}("]","[",!0);if(-1===e)throw S("mismatched brackets");if(n=v.slice(0,e),/[\[\]]/.test(n)){for(r=[];t=i(",;]");)if(r.push(t),g(","))r.push(Ie(","));else{if(!g(";"))break;r.push(Ie(";"))}g(/^\s+/),g("]")}else r=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,r){var t=n.length,e=0;return r.trim().split(-1<r.indexOf(",")?",":/\s+/g).reduce(function(n,r){return(r="~"===(r=r.trim())?Ie("v",Ae(y,"")):Ee(r,y,k+w,x))&&(e?n.push(Ie(",")):t&&n.push(Ie(";")),n.push(r),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,r){return(r=Ee(r.trim(),y,k+w,x))&&(n.length&&n.push(Ie(",")),n.push(r)),n},[]),v=v.slice(e+1),x+=e+1,1<(n=n.split("\n")).length&&(k+=n.length-1,n.slice(0,-1).forEach(function(n){x-=n.length+1}));return Ie(we["[]"].fn,r)}for(;0<v.length;)if(g(/^if\b/)){if(m(!0),!(c=i("\n,")))throw S('missing or invalid condition in "if"');for(g("\n")?(++k,x=0):g(","),o=(f={if:{cond:c,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((c=i(["elseif","else","end"]))&&(o.statements=o.statements.concat(c)),g("elseif")){if(!(c=i("\n,")))throw S('missing or invalid condition in "elseif"');g("\n")?(++k,x=0):g(","),f.elseif.push({cond:c,statements:[]}),o=f.elseif[f.elseif.length-1]}else if(g("else"))g(/^[ \t\v\f]+/),g("\n")?(++k,x=0):g(","),o=f.else;else if(g("end")||!c)break;s.push(Ie(xe,f))}else if(g(/^for\b/)){if(m(!0),!(r=g(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw S('missing or invalid declaration in "for"');if(!(c=i("\n,")))throw S('missing or invalid declaration in "for"');for(g("\n")?(++k,x=0):g(","),f={ind:Ae(y,r[1]),val:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Ie(ke,f))}else if(g(/^while\b/)){if(m(!0),!(c=i("\n,")))throw S('missing or invalid condition in "while"');for(g("\n")?(++k,x=0):g(","),f={cond:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(Ie(Se,f))}else if(r=g(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(r[1]))break;if("continue"===r[1])g("continue"),s.push(Ie("continue",""));else if("break"===r[1])g("break"),s.push(Ie("break",""));else{if("end"!==r[1])throw S('unexpected "'+r[1]+'"');g("end"),a.unshift(Ie("v",Ae(y,"end")))}}else if(g("..."))g(/^[ \t\v\f]+/),g("\n")&&(++k,x=0);else if(g(";",!1)){if(n&&-1<n.indexOf(";"))break;g(";"),m(!0)}else if(g("\n",!1)){if(n&&-1<n.indexOf("\n"))break;g("\n"),++k,m(!(x=0))}else if(g(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(r=g("%"))b=v.indexOf("\n"),v=v.slice(-1<b?b+1:v.length),-1<b&&++k,m(!(x=0));else if(r=(r=g("'"))||g('"'))o=p(r[0],!0)[0],a.unshift(Ie("'"===r[0]?o.split(""):o));else if(r=g(/^(&&|\|\|)[^&\|]/,1))u=r[1],l.unshift([u,x,k]),h();else if(r=g(/^(xor)[^a-zA-Z]/,1))u=r[1],l.unshift([u,x,k]),h();else if(r=g(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=r[1],l.unshift([u,x,k]),h();else if(r=g("~"))l.unshift(["~",x,k]),h();else if(r=g("="))l.unshift(["=",x,k]),h();else if(r=g(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=r[0],l.unshift([u,x,k]),h();else if(r=g(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(t=r[1],g(/^\s*\:\s*\)/))o=Ie("v",Ae(y,t)),a.unshift(o),l.unshift(["(:)",x,k]),h();else{for(f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");o=on.call(q,t)?Ie(q[t],f):Ie("v",Ae(y,t,f.length?f:null)),a.unshift(o)}g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h())}else if(r=g(/^[_a-z][_a-z0-9]*/i))t=r[0],o=on.call(q,t)&&0===q[t].length?Ie(q[t],[]):Ie("v",Ae(y,t)),a.unshift(o),g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h());else if(r=g(/^(-?\s*\d+(\.\d+)?([eE][+-]?\d+)?)([ij])?/))f=r[1].split(/\s+/).join(""),f=A?A(f):parseFloat(f,10),o=Ie(r[4]?new _(0,f):f),a.unshift(o);else if(r=g(/^(-?\s*\.\d+([eE][+-]?\d+)?)([ij])?/))f="-"===(f=r[1].split(/\s+/).join("")).charAt(0)?"-0"+f.slice(1):"0"+f,f=A?A(f):parseFloat(f,10),o=Ie(r[4]?new _(0,f):f),a.unshift(o);else if("["===(e=v.charAt(0)))v=v.slice(1),x+=1,(o=d())&&(a.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw S("mismatched brackets")}if("("===e)if(v=v.slice(1),x+=1,g(/^\s*\:\s*\)/))l.unshift(["(:)",x,k]),h();else{if(a.length&&l.reduce(function(n,r){return r=we[r[0]],n+(r.arity>a.length-n&&null!=r.arityalt?r.arityalt:r.arity)},0)<=a.length){for(h("set"),o=a.shift(),f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw S("mismatched parentheses");f.length&&(o=Ie("v",Ae(y,o,f)))}else if(o=i(")"),!g(")"))throw S("mismatched parentheses");o&&(a.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,k]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw S("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw S(n?'missing expected "'+(E(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(v=v.slice(1),c=[x+=1,k],h("set"),a.length?f=1:(f=0,a.unshift(Ie(":")));o=i(":,)\n"),g(/^[ \t\v\f]+/),o?(a.unshift(o),++f):g(":",!1)&&a.unshift(Ie(":")),g(":"););1<f&&(l.unshift([3===f?"::":":",c[0],c[1]]),h())}}return m(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function Ne(n,r,t){var e;if(ln(n,Ie)){if(""===n.op)return n.arg;if("v"===n.op)return!1===r?n.arg:ln(n.arg.v,Ie)?_e(n.arg):hn(r)&&on.call(r,n.arg.v)?r[n.arg.v]:await _e(n.arg);if(xe===n.op)return xe(n.arg,r,t);if(ke===n.op)return ke(n.arg,r,t);if(Se===n.op)return Se(n.arg,r,t);if("break"===n.op)return void(t&&sn(t.brk)&&t.brk());if("continue"===n.op)return void(t&&sn(t.cont)&&t.cont());if(we["="].fn===n.op)return t=t||{},e=await Ne(n.arg[0],!1),k(e)&&ln(e[0],Ae)&&(t.nargout=e.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[e,n.arg[1].arg.isByRef()?In(await Ne(n.arg[1],r,t)):await Ne(n.arg[1],r,t)]):n.op.apply(null,[e].concat(await Promise.all(n.arg.slice(1).map(function(n){return Ne(n,r,t)}))));if(sn(n.op))return(t&&p(t.nargout)&&sn(n.op.nargout)?n.op.nargout(t.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return Ne(n,r,t)})))}throw"invalid expr"}return cn.op=we,Ae.prototype={constructor:Ae,ctx:null,v:null,i:null,get:async function(n){var r,t,e=this;if(""===e.v)return null;if(ln(e.v,Ie))r=await qe(e.v);else{if(!on.call(e.ctx,e.v)&&!on.call(an,e.v))throw'undefined variable "'+e.v+'"';r=(on.call(e.ctx,e.v)?e.ctx:an)[e.v]}return!0!==n&&null!=e.i?(t=rt(r),n=await Promise.all(e.i.map(function(n,r){return qe(n,{end:1===e.i.length?t[0]*t[1]:t[r]})})),lr.apply(null,[r].concat(n))):r},set:async function(n){var r,t,e,i=this;if(""!==i.v)if(null!=i.i){if(ln(i.v,Ie))r=await qe(i.v);else{if(!on.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';r=i.ctx[i.v]}t=rt(r),1===(e=await Promise.all(i.i.map(function(n,r){return qe(n,{end:1===i.i.length?t[0]*t[1]:t[r]})}))).length&&(e=e.concat(null)),sr.apply(null,[r].concat(e).concat([n]))}else ln(i.v,Ie)||(i.ctx[i.v]=n);return i},isset:function(){return E(this.v)&&on.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},Ie.prototype={constructor:Ie,op:null,arg:null},c.createContext=function(){return{ans:null}},c.eval=async function(n,r,t){r=r||c.createContext();var e=Ee(String(n),r,null==t?1:t,1),i=null,u=!1;if(k(e))for(var o=0,f=e.length;o<f;++o)e[o]&&(i=await Ne(e[o]),u=!0);else e&&(i=await Ne(e),u=!0);return u&&(k(i)||mn(i)||y(i)||E(i))&&(r.ans=i),u?i:null},cn});