/**
*
* SciLite,
* A scientific computing environment similar to Octave/Matlab in pure JavaScript
* @version: 0.9.7
* 2025-12-14 13:14:51
* https://github.com/foo123/SciLite
*
**/!function(r,n,t){"use strict";"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[n]=t.call(r)):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["module"],function(n){return t.moduleUri=n.uri,t.call(r)}):n in r||(r[n]=t.call(r)||1)&&"function"==typeof define&&define.amd&&define(function(){return r[n]})}("undefined"!=typeof self?self:this,"SciLite",function(n){"use strict";function r(){}var t,_=null,I=null,S=Math,L={},e={},T=S.PI,i=S.E,f=S.log(10),a=S.log(2),l=1/0,s=NaN,Y=1e-15,h=Number.MAX_VALUE,m=Number.MIN_VALUE,g=Number.MAX_SAFE_INTEGER,X=Number.MIN_SAFE_INTEGER,Z=g,O=0,C=1,z=-1,nn=.5,rn=2,tn=10,en=[],un=Object.prototype.hasOwnProperty,on=Object.prototype.toString,A=Array.isArray||function(n){return"[object Array]"===on.call(n)},fn={VERSION:"0.9.7",_:{},fn:{},op:{},constant:{pi:T,e:i,eps:Y,realmax:h,realmin:m,intmax:g,intmin:X,inf:l,Inf:l,nan:s,NaN:s}},c=fn._,cn=fn.constant,E=fn.fn;function y(n){throw String(n)+": input(s) not supported"}function an(n,r){return n instanceof r}function ln(n){return"function"==typeof n}function sn(n){return"[object Object]"===on.call(n)}function k(n){return"string"==typeof n}function hn(n){return gn(n)&&n.isNaN()||Number.isNaN(n)}function mn(n){return gn(n)&&!n.isFinite()||u(n)&&!isFinite(n)}function u(n){return"number"==typeof n}function gn(n){return null!=_&&n instanceof _}function $(n){return"number"==typeof n||null!=_&&n instanceof _}function p(n){return gn(n)&&n.isInt()||u(n)&&Number.isInteger(n)}function o(n){return null!=I&&n instanceof I}function pn(n){return!o(n)||Q(O,n.im)}function w(n,r){if(u(n)||o(n)||gn(n))return!0;if(!1===r){if(v(n)&&1===n.length)return!0;if(b(n)&&1===n.length&&1===n[0].length)return!0}return!1}function v(n){return A(n)&&w(n[0])}function b(n){return A(n)&&A(n[0])&&w(n[0][0])}function dn(n){return!A(n)}function vn(n){return A(n)&&!A(n[0])}function yn(n){return A(n)&&A(n[0])}function F(n,r){for(var t=new Array(n),e=0;e<n;++e)t[e]=ln(r)?r(e,t):r;return t}function N(n,r,t){for(var e,i,u=new Array(n),o=0;o<n;++o)for(u[o]=i=new Array(r),e=0;e<r;++e)i[e]=ln(t)?t(o,e,u):t;return u}function wn(n){return dn(n)?[[n]]:vn(n)?n.map(function(n){return[n]}):n}function bn(n,r){return $(n)?n:o(n)?r?n.re:n:v(n)&&1===n.length?bn(n[0],r):b(n)&&1===n.length&&1===n[0].length?bn(n[0][0],r):n}function j(n){if(yn(n)){if(1===W(n))return n[0];if(1===U(n))return n.map(function(n){return n[0]})}else if(dn(n))return[n];return n}function W(n){return n.length}function U(n){return n[0].length}function q(r,t){return F(r.length,function(n){return r[n][t]})}function d(n){return"number"==typeof n?n:gn(n)?n.$valueOf():n.valueOf()}function B(n){return null!=_&&"number"==typeof n?_(n):n}function xn(n){return A(n)?n.map(xn):w(n)?d(n):n}function Sn(n){return n=A(n)?n.map(Sn):n}function An(r,n,t){if($(n))return r(n);if(o(n)){if(t)return r(n);if(Q(n.im,O))return r(n.re)}return A(n)?n.map(function(n){return An(r,n,t)}):n}function _n(t,n,e,i){return $(n)&&$(e)?t(n,e):w(n)&&w(e)?i?t(qn(n),qn(e)):pn(n)&&pn(e)?t(jn(n),jn(e)):s:A(n)&&A(e)?n.map(function(n,r){return _n(t,n,e[r],i)}):s}function In(t,r){null==r&&(r=1);function n(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),1<r&&A(n)&&(n.$scilitevarargout$=!0),n}return n.nargout=function(r){return function(){var n=[].slice.call(arguments);return n.unshift(r),n=t.apply(null,n),1<r&&A(n)&&(n.$scilitevarargout$=!0),n}},n}function En(n){return hn(n)?n="nan":mn(n)?n=(Pn(n,O)?"-":"")+"inf":p(n)?n=String(n):$(n)?n=n.toFixed(4).replace(/\.0{4}$/,""):o(n)&&(n=String(n)),n}function kn(t){var r;return null==t?t="":k(t)?-1===["\\cdots","\\vdots","\\ddots"].indexOf(t)&&(t="\\text{"+t+"}"):t=hn(t)?"\\text{nan}":$(t)?[Y,h,m,g,X].reduce(function(n,r){return n||Q(t,r)},!1)?String(t):En(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):o(t)?String(t).split("e").join("\\text{e}").split("nan").join("\\text{nan}").split("inf").join("\\text{inf}"):b(t)?(r=!1,U(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,S.round(c.MAXPRINTSIZE/2)).concat("\\cdots").concat(n.slice(1-S.round(c.MAXPRINTSIZE/2)))}),r=!0),"\\begin{bmatrix}"+(t=W(t)>c.MAXPRINTSIZE?t.slice(0,S.round(c.MAXPRINTSIZE/2)).concat([F(c.MAXPRINTSIZE,function(n){return S.round(c.MAXPRINTSIZE/2)===n&&r?"\\ddots":"\\vdots"})]).concat(t.slice(1-S.round(c.MAXPRINTSIZE/2))):t).map(function(n){return n.map(kn).join(" & \\hskip 1em ")}).join(" \\\\ ")+"\\end{bmatrix}"):A(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,S.round(c.MAXPRINTSIZE/2)).concat(["\\cdots"]).concat(t.slice(1-S.round(c.MAXPRINTSIZE/2))):t).map(kn).join(" \\hskip 1em "):"object"==typeof t||"function"==typeof t?"":String(t),t}function Nn(t){var r,e;return null==t?t="":k(t)||(t=hn(t)?"nan":$(t)?([Y,h,m,g,X].reduce(function(n,r){return n||Q(t,r)},!1)?String:En)(t):o(t)?String(t):b(t)?(r=!1,U(t)>c.MAXPRINTSIZE&&(t=t.map(function(n){return n.slice(0,S.round(c.MAXPRINTSIZE/2)).concat("..").concat(n.slice(1-S.round(c.MAXPRINTSIZE/2)))}),r=!0),W(t)>c.MAXPRINTSIZE&&(t=t.slice(0,S.round(c.MAXPRINTSIZE/2)).concat([F(c.MAXPRINTSIZE,function(n){return S.round(c.MAXPRINTSIZE/2)===n&&r?"\\":":"})]).concat(t.slice(1-S.round(c.MAXPRINTSIZE/2)))),e=F(U(t),function(n){return q(t,n).reduce(function(n,r){return S.max(n,Nn(r).length)},0)}),t.map(function(n,r){return"["+n.map(function(n,r){n=Nn(n);return n=n.length<e[r]?new Array(e[r]-n.length+1).join(" ")+n:n}).join("  ")+"]"}).join("\n")):A(t)?(t=t.length>c.MAXPRINTSIZE?t.slice(0,S.round(c.MAXPRINTSIZE/2)).concat([".."]).concat(t.slice(1-S.round(c.MAXPRINTSIZE/2))):t).map(Nn).join("  "):"object"==typeof t||"function"==typeof t?"":String(t)),t}function jn(n){return A(n)?n.map(jn):o(n)&&Q(n.im,O)?n.re:n}function qn(n){return I?A(n)?n.map(qn):$(n)?new I(B(n),O):n:n}function Q(n,r){return u(n)?u(r)?n===r:r.eq(n):n.eq(r)}function Pn(n,r){return u(n)?u(r)?n<r:r.gt(n):n.lt(r)}function Mn(n,r){return u(n)?u(r)?r<n:r.lt(n):n.gt(r)}function Rn(n,r){return u(n)?u(r)?n<=r:r.gte(n):n.lte(r)}function Tn(n,r){return u(n)?u(r)?r<=n:r.lte(n):n.gte(r)}function V(n,r){return u(n)?u(r)?n+r:r.add(n):n.add(r)}function G(n,r){return u(n)?u(r)?n-r:r.neg().add(n):n.sub(r)}function H(n,r){return u(n)?u(r)?n*r:r.mul(n):n.mul(r)}function Xn(n,r){return u(n)?u(r)?n/r:_(n).div(r):n.div(r)}function Zn(n,r){return hn(n)||hn(r)?s:u(n)?u(r)?n<0&&!p(r)?jn(new I(n).pow(r)):S.pow(n,r):n<0&&!p(r)?jn(new I(_(n)).pow(r)):_(n).pow(r):Mn(O,n)&&!p(r)?jn(new I(n).pow(_(r))):n.pow(r)}function zn(n,r){return u(n)?u(r)?n%r:_(n).mod(r):n.mod(r)}function Ln(n){return u(n)?-n:n.neg()}function On(n){return u(n)?1/n:C.div(n)}function P(t,e){if(k(t)){if(k(e))return t===e?1:0;if(w(e))return t===String(e)?1:0;if(v(e))return e.map(function(n){return P(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return P(t,e[n][r])})}else if($(t)){if(k(e))return String(t)===e?1:0;if($(e))return Q(t,e)?1:0;if(o(e))return Q(e.re,t)&&Q(e.im,O)?1:0;if(v(e))return e.map(function(n){return P(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return P(t,e[n][r])})}else if(o(t)){if(k(e))return String(t)===e?1:0;if($(e))return Q(t.re,e)&&Q(t.im,O)?1:0;if(o(e))return Q(t.re,e.re)&&Q(t.im,e.im)?1:0;if(v(e))return e.map(function(n){return P(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return P(t,e[n][r])})}else if(v(t)){if(k(e)||w(e))return t.map(function(n){return P(n,e)});if(v(e)){if(t.length!==e.length)throw"eq: inputs have incompatible dimensions";return t.map(function(n,r){return P(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"eq: inputs have incompatible dimensions";return N(W(e),U(e),function(n,r){return P(t[r],e[n][r])})}}else if(b(t)){if(k(e)||w(e))return N(W(t),U(t),function(n,r){return P(t[n][r],e)});if(v(e)){if(U(t)!==e.length)throw"eq: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return P(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"eq: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return P(t[n][r],e[n][r])})}}return 0}function Cn(t,e){if(k(t)){if(k(e))return t===e?0:1;if(w(e))return t===String(e)?0:1;if(v(e))return e.map(function(n){return Cn(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Cn(t,e[n][r])})}else if($(t)){if(k(e))return String(t)===e?0:1;if($(e))return Q(t,e)?0:1;if(o(e))return Q(e.re,t)&&Q(e.im,O)?0:1;if(v(e))return e.map(function(n){return Cn(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Cn(t,e[n][r])})}else if(o(t)){if(k(e))return String(t)===e?0:1;if($(e))return Q(t.re,e)&&Q(t.im,O)?0:1;if(o(e))return Q(t.re,e.re)&&Q(t.im,e.im)?0:1;if(v(e))return e.map(function(n){return Cn(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Cn(t,e[n][r])})}else if(v(t)){if(k(e)||w(e))return t.map(function(n){return Cn(n,e)});if(v(e)){if(t.length!==e.length)throw"ne: inputs have incompatible dimensions";return t.map(function(n,r){return Cn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"ne: inputs have incompatible dimensions";return N(W(e),U(e),function(n,r){return Cn(t[r],e[n][r])})}}else if(b(t)){if(k(e)||w(e))return N(W(t),U(t),function(n,r){return Cn(t[n][r],e)});if(v(e)){if(U(t)!==e.length)throw"ne: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return Cn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"ne: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return Cn(t[n][r],e[n][r])})}}return 0}function $n(t,e){if(k(t)){if(k(e))return t<e?1:0;if(w(e))return t<String(e)?1:0;if(v(e))return e.map(function(n){return $n(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return $n(t,e[n][r])})}else if($(t)){if(k(e))return String(t)<e?1:0;if($(e))return Pn(t,e)?1:0;if(o(e))return Pn(e.re,t)&&Q(e.im,O)?1:0;if(v(e))return e.map(function(n){return $n(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return $n(t,e[n][r])})}else if(o(t)){if(k(e))return String(t)<e?1:0;if($(e))return Pn(t.re,e)&&Q(t.im,O)?1:0;if(o(e))return Pn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Pn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(v(e))return e.map(function(n){return $n(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return $n(t,e[n][r])})}else if(v(t)){if(k(e)||w(e))return t.map(function(n){return $n(n,e)});if(v(e)){if(t.length!==e.length)throw"lt: inputs have incompatible dimensions";return t.map(function(n,r){return $n(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"lt: inputs have incompatible dimensions";return N(W(e),U(e),function(n,r){return $n(t[r],e[n][r])})}}else if(b(t)){if(k(e)||w(e))return N(W(t),U(t),function(n,r){return $n(t[n][r],e)});if(v(e)){if(U(t)!==e.length)throw"lt: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return $n(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"lt: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return $n(t[n][r],e[n][r])})}}return 0}function Fn(t,e){if(k(t)){if(k(e))return e<t?1:0;if(w(e))return t>String(e)?1:0;if(v(e))return e.map(function(n){return Fn(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Fn(t,e[n][r])})}else if($(t)){if(k(e))return String(t)>e?1:0;if($(e))return Mn(t,e)?1:0;if(o(e))return Mn(e.re,t)&&Q(e.im,O)?1:0;if(v(e))return e.map(function(n){return Fn(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Fn(t,e[n][r])})}else if(o(t)){if(k(e))return String(t)>e?1:0;if($(e))return Mn(t.re,e)&&Q(t.im,O)?1:0;if(o(e))return Mn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Mn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(v(e))return e.map(function(n){return Fn(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Fn(t,e[n][r])})}else if(v(t)){if(k(e)||w(e))return t.map(function(n){return Fn(n,e)});if(v(e)){if(t.length!==e.length)throw"gt: inputs have incompatible dimensions";return t.map(function(n,r){return Fn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"gt: inputs have incompatible dimensions";return N(W(e),U(e),function(n,r){return Fn(t[r],e[n][r])})}}else if(b(t)){if(k(e)||w(e))return N(W(t),U(t),function(n,r){return Fn(t[n][r],e)});if(v(e)){if(U(t)!==e.length)throw"gt: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return Fn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"gt: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return Fn(t[n][r],e[n][r])})}}return 0}function Wn(t,e){if(k(t)){if(k(e))return t<=e?1:0;if(w(e))return t<=String(e)?1:0;if(v(e))return e.map(function(n){return Wn(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Wn(t,e[n][r])})}else if($(t)){if(k(e))return String(t)<=e?1:0;if($(e))return Rn(t,e)?1:0;if(o(e))return Rn(e.re,t)&&Q(e.im,O)?1:0;if(v(e))return e.map(function(n){return Wn(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Wn(t,e[n][r])})}else if(o(t)){if(k(e))return String(t)<=e?1:0;if($(e))return Rn(t.re,e)&&Q(t.im,O)?1:0;if(o(e))return Rn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Rn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(v(e))return e.map(function(n){return Wn(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Wn(t,e[n][r])})}else if(v(t)){if(k(e)||w(e))return t.map(function(n){return Wn(n,e)});if(v(e)){if(t.length!==e.length)throw"le: inputs have incompatible dimensions";return t.map(function(n,r){return Wn(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"le: inputs have incompatible dimensions";return N(W(e),U(e),function(n,r){return Wn(t[r],e[n][r])})}}else if(b(t)){if(k(e)||w(e))return N(W(t),U(t),function(n,r){return Wn(t[n][r],e)});if(v(e)){if(U(t)!==e.length)throw"le: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return Wn(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"le: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return Wn(t[n][r],e[n][r])})}}return 0}function Un(t,e){if(k(t)){if(k(e))return e<=t?1:0;if(w(e))return t>=String(e)?1:0;if(v(e))return e.map(function(n){return Un(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Un(t,e[n][r])})}else if($(t)){if(k(e))return String(t)>=e?1:0;if($(e))return Tn(t,e)?1:0;if(o(e))return Tn(e.re,t)&&Q(e.im,O)?1:0;if(v(e))return e.map(function(n){return Un(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Un(t,e[n][r])})}else if(o(t)){if(k(e))return String(t)>=e?1:0;if($(e))return Tn(t.re,e)&&Q(t.im,O)?1:0;if(o(e))return Tn(t.re,e.re)&&Q(t.im,O)&&Q(e.im,O)||Tn(t.im,e.im)&&Q(t.re,O)&&Q(e.re,O)?1:0;if(v(e))return e.map(function(n){return Un(t,n)});if(b(e))return N(W(e),U(e),function(n,r){return Un(t,e[n][r])})}else if(v(t)){if(k(e)||w(e))return t.map(function(n){return Un(n,e)});if(v(e)){if(t.length!==e.length)throw"ge: inputs have incompatible dimensions";return t.map(function(n,r){return Un(n,e[r])})}if(b(e)){if(t.length!==U(e))throw"ge: inputs have incompatible dimensions";return N(W(e),U(e),function(n,r){return Un(t[r],e[n][r])})}}else if(b(t)){if(k(e)||w(e))return N(W(t),U(t),function(n,r){return Un(t[n][r],e)});if(v(e)){if(U(t)!==e.length)throw"ge: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return Un(t[n][r],e[r])})}if(b(e)){if(W(t)!==W(e)||U(t)!==U(e))throw"ge: inputs have incompatible dimensions";return N(W(t),U(t),function(n,r){return Un(t[n][r],e[n][r])})}}return 0}function Bn(n){return o(n)?n.sign():L.sign(n)}function D(n,r){return $(n)&&$(r)?V(n,r):o(n)&&w(r)?n.add(r):o(r)&&w(n)?r.add(n):s}function Qn(n,r){return $(n)&&$(r)?G(n,r):o(n)&&w(r)?n.sub(r):o(r)&&w(n)?r.neg().add(n):s}function J(n,r){return $(n)&&$(r)?H(n,r):o(n)&&w(r)?n.mul(r):o(r)&&w(n)?r.mul(n):s}function K(n,r){return $(n)&&$(r)?Xn(n,r):o(n)&&w(r)?n.div(r):o(r)&&w(n)?r.inv().mul(n):s}function Vn(n,r){return $(n)&&$(r)?Zn(n,r):o(n)&&w(r)?n.pow(r):o(r)&&w(n)?new I(n,O).pow(r):s}function Gn(n){return $(n)?Ln(n):o(n)?n.neg():s}function Hn(n){return $(n)?n:o(n)?n.conj():s}function Dn(n){return $(n)?Q(n,O)?l:On(n):o(n)?Q(n.abs(),O)?new I(l,Pn(n.im,O)?l:-l):n.inv():s}function Jn(n){return $(n)?L.abs(n):o(n)?n.abs():s}function Kn(n){return $(n)?Pn(n,O)?cn.pi:O:o(n)?n.angle():s}function Yn(r,e){if(k(r)&&k(e))return r+e;if(w(r)&&w(e))return D(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return Yn(n,t[r])})});throw"add: matrix dimensions do not match"}if(v(r)&&v(e)){if(r.length===e.length)return r.map(function(n,r){return Yn(n,e[r])});throw"add: vector dimensions do not match"}return A(r)?r.map(function(n){return Yn(n,e)}):A(e)?e.map(function(n){return Yn(r,n)}):void y("add")}function nr(r,e){if(w(r)&&w(e))return Qn(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return nr(n,t[r])})});throw"sub: matrix dimensions do not match"}if(v(r)&&v(e)){if(r.length===e.length)return r.map(function(n,r){return nr(n,e[r])});throw"sub: vector dimensions do not match"}return A(r)?r.map(function(n){return nr(n,e)}):A(e)?e.map(function(n){return nr(r,n)}):void y("sub")}function rr(r,e){if(w(r)&&w(e))return J(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return rr(n,t[r])})});throw"dotmul: matrix dimensions do not match"}if(v(r)&&v(e)){if(r.length===e.length)return r.map(function(n,r){return rr(n,e[r])});throw"dotmul: vector dimensions do not match"}return A(r)?r.map(function(n){return rr(n,e)}):A(e)?e.map(function(n){return rr(r,n)}):void y("dotmul")}function tr(r,e){if(w(r)&&w(e))return K(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return tr(n,t[r])})});throw"dotdiv: matrix dimensions do not match"}if(v(r)&&v(e)){if(r.length===e.length)return r.map(function(n,r){return tr(n,e[r])});throw"dotdiv: vector dimensions do not match"}return A(r)?r.map(function(n){return tr(n,e)}):A(e)?e.map(function(n){return tr(r,n)}):void y("dotdiv")}function er(r,e){if(w(r)&&w(e))return Vn(r,e);if(b(r)&&b(e)){if(W(r)===W(e)&&U(r)===U(e))return r.map(function(n,r){var t=e[r];return n.map(function(n,r){return er(n,t[r])})});throw"dotpow: matrix dimensions do not match"}if(v(r)&&v(e)){if(r.length===e.length)return r.map(function(n,r){return er(n,e[r])});throw"dotpow: vector dimensions do not match"}return A(r)?r.map(function(n){return er(n,e)}):A(e)?e.map(function(n){return er(r,n)}):void y("dotpow")}function M(i,u){if(w(i)&&w(u))return J(i,u);if(b(i)&&b(u)){if(U(i)===W(u))return n=W(i),r=U(u),o=W(u),N(n,r,function(n,r){for(var t=O,e=0;e<o;++e)t=D(t,J(i[n][e],u[e][r]));return t});throw"mul: matrix-matrix dimensions do not match"}if(v(i)&&b(u)){if(i.length===W(u))return r=U(u),o=i.length,N(n=1,r,function(n,r){for(var t=O,e=0;e<o;++e)t=D(t,J(i[e],u[e][r]));return t});throw"mul: vector-matrix dimensions do not match"}if(b(i)&&v(u)){var o;if(U(i)===u.length)return n=W(i),o=u.length,N(n,r=1,function(n,r){for(var t=O,e=0;e<o;++e)t=D(t,J(i[n][e],u[e]));return t});throw"mul: matrix-vector dimensions do not match"}var n,r;return v(i)&&v(u)?N(n=i.length,r=u.length,function(n,r){return J(i[n],u[r])}):A(i)?i.map(function(n){return M(n,u)}):A(u)?u.map(function(n){return M(i,n)}):void y("mul")}function ir(n,r){if(w(n)&&w(r))return Vn(n,r);if(b(n)&&W(n)===U(n)&&p(r)){if((r=d(r))<0&&(r=-r,!(n=Kr(n))||!n.length))throw"pow: no inverse";if(0===r)return yr(W(n));if(1===r)return n;if(2===r)return M(n,n);for(var t=yr(W(n));0!==r;)1&r&&(t=M(t,n)),0<(r>>=1)&&(n=M(n,n));return t}y("pow")}function ur(n){return w(n)?Gn(n):A(n)?n.map(ur):n}function or(e,n=":",t=null){if(vn(e)){if(v(n)&&n.length===e.length&&Or(n,function(n){return 0===d(n)||1===d(n)}))return o=1===(o=n.reduce(function(n,r,t){return 1===d(r)&&n.push(e[t]),n},[])).length?o[0]:o;if(":"===(n=w(n)?bn(n,!0):n)||p(n)||v(n))return r=e.length,1===(o=(n=p(n=":"===n?wr(1,r):n)?[n]:n).map(function(n){if((n=d(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[n-1]})).length?o[0]:o;throw"get: invalid range"}if(yn(e)){var i=W(e),u=U(e),r=i*u;if(null==t&&b(n)&&W(n)===i&&U(n)===u&&Or(n,function(n){return 0===d(n)||1===d(n)})){for(var o=[],f=0;f<u;++f)for(var c=0;c<i;++c)1===d(n[c][f])&&o.push(e[c][f]);return o=1===o.length?o[0]:o}if(w(n)&&(n=bn(n,!0)),w(t)&&(t=bn(t,!0)),":"===n||p(n)||v(n)){if(p(n=":"===n?wr(1,i):n)&&(n=[n]),null==t)return o=1===(o=n.map(function(n){if((n=d(n))<1&&(n+=r),n<1||r<n)throw"get: index out of bounds";return e[(n-1)%i][S.floor((n-1)/i)]})).length?o[0]:o;if(":"===t||p(t)||v(t))return p(t=":"===t?wr(1,u):t)&&(t=[t]),o=1===(o=n.map(function(r){if((r=d(r))<1&&(r+=i),r<1||i<r)throw"get: index out of bounds";return t.map(function(n){if((n=d(n))<1&&(n+=u),n<1||u<n)throw"get: index out of bounds";return e[r-1][n-1]})})).length&&1===o[0].length?o[0][0]:o}throw"get: invalid range"}return e}function fr(i,r=":",n=null,u=null){if(vn(i)){if(yn(u)&&(u=q(u,0)),v(r)&&r.length===i.length&&Or(r,function(n){return 0===d(n)||1===d(n)})){if(dn(u))return r.forEach(function(n,r){1===d(n)&&(i[r]=u)}),i;if(A(u))return h=0,t=u.length,r.forEach(function(n,r){if(1===d(n)){if(t<=h)throw"set: index out of bounds";i[r]=u[h++]}}),i}if(":"===(r=w(r)?bn(r,!0):r)||p(r)||v(r)){var e=i.length;if(p(r=":"===r?wr(1,e):r)&&(r=[r]),dn(u))return r.forEach(function(n){if((n=d(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u}),i;if(A(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=d(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[n-1]=u[r]}),i;throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}if(yn(i)){var o,f,t,c,a,l,s,h,m=W(i),g=U(i),e=m*g;if(b(r)&&W(r)===m&&U(r)===g&&Or(r,function(n){return 0===d(n)||1===d(n)})){if(dn(u))return r.forEach(function(n,t){n.forEach(function(n,r){1===d(n)&&(i[t][r]=u)})}),i;if(yn(u)){for(o=W(u),f=U(u),s=a=0;a<g;++a,++s){if(1===f)s=0;else if(f<=s)throw"set: index out of bounds";for(l=c=0;c<m;++c,++l)if(1===d(r[c][a])){if(1===o)l=0;else if(o<=l)throw"set: index out of bounds";i[c][a]=u[l][s]}}return i}if(A(u)){for(t=u.length,a=h=0;a<g;++a)for(c=0;c<m;++c)if(1===d(r[c][a])){if(t<=h)throw"set: index out of bounds";i[c][a]=u[h++]}return i}}if(w(r)&&(r=bn(r,!0)),w(n)&&(n=bn(n,!0)),":"===r||p(r)||v(r)){if(null==n){if(p(r=":"===r?wr(1,e):r)&&(r=[r]),dn(u))return r.forEach(function(n){if((n=d(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][S.floor((n-1)/m)]=u}),i;if(yn(u))return o=W(u),f=U(u),r.forEach(function(n,r){if((n=d(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";var t=1===o?0:r%m,r=1===f?0:S.floor(r/m);if(o<=t||f<=r)throw"set: index out of bounds";i[(n-1)%m][S.floor((n-1)/m)]=u[t][r]}),i;if(A(u)&&u.length>=r.length)return r.forEach(function(n,r){if((n=d(n))<1&&(n+=e),n<1||e<n)throw"set: index out of bounds";i[(n-1)%m][S.floor((n-1)/m)]=u[r]}),i}else if(":"===n||p(n)||v(n)){if(p(r=":"===r?wr(1,m):r)&&(r=[r]),p(n=":"===n?wr(1,g):n)&&(n=[n]),dn(u))return r.forEach(function(r){if((r=d(r))<1&&(r+=m),r<1||m<r)throw"set: index out of bounds";n.forEach(function(n){if((n=d(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";i[r-1][n-1]=u})}),i;if(yn(u))return o=W(u),f=U(u),r.forEach(function(t,e){if((t=d(t))<1&&(t+=m),t<1||m<t)throw"set: index out of bounds";if(1===o)e=0;else if(o<=e)throw"set: index out of bounds";n.forEach(function(n,r){if((n=d(n))<1&&(n+=g),n<1||g<n)throw"set: index out of bounds";if(1===f)r=0;else if(f<=r)throw"set: index out of bounds";i[t-1][n-1]=u[e][r]})}),i;if(A(u)&&u.length>=r.length*n.length)return h=0,n.forEach(function(t,n){if((t=d(t))<1&&(t+=g),t<1||g<t)throw"set: index out of bounds";r.forEach(function(n,r){if((n=d(n))<1&&(n+=m),n<1||m<n)throw"set: index out of bounds";i[n-1][t-1]=u[h++]})}),i}throw"set: invalid value or range does not match dimensions"}throw"set: invalid range"}return i}function cr(n,r){var t,e,i;return u(n)&&u(r)?(t=n,e=r,t=S.abs(t),e=S.abs(e),(i=0)===t?e:0===e?t:e<t?t*S.sqrt(1+(i=e/t)*i):t<e?e*S.sqrt(1+(i=t/e)*i):t*S.SQRT2):L.sqrt(V(H(n,n),H(r,r)))}function ar(n,r){var t,n=1===arguments.length?n:nr(n,r);return n.reduce(function(n,r){return n&&(u(r)||o(r)&&u(r.re)&&u(r.im))},!0)?(t=0,r=(r=n).map(function(n){return n=Jn(n),t<n&&(t=n),n}),0===t?0:t*S.sqrt(r.reduce(function(n,r){return r===t?n+1:n+(n=r/t)*n},0))):L.sqrt(hr(Mr(n,n)))}function lr(){var n,r,t,e=0,i=0;if(u(lr.z1))return t=lr.z1,lr.z1=null,t;for(;0===e||1===e;)e=S.random();for(;0===i||1===i;)i=S.random();return r=(n=S.sqrt(-2*S.log(e)))*S.cos(2*T*i),t=n*S.sin(2*T*i),lr.z1=t,r}function sr(){if(!an(this,sr))return new sr;this.data=[]}function hr(n){return An(function(n){return o(n)?n.re:n},n,!0)}function mr(n){return An(function(n){return o(n)?n.im:0},n,!0)}function gr(n){return An(Hn,n,!0)}function pr(n){return An(Jn,n,!0)}function dr(n,r){if(mn(r=null==r?2:r)){if(w(n))return Jn(n);if(v(n))return(Pn(r,O)?Nr:jr)(pr(n));if(b(n)&&Mn(r,O))return jr(qr(pr(xr(n))))}else if($(r)){if(Q(r,C)){if(w(n))return Jn(n);if(v(n))return qr(pr(n));if(b(n))return jr(qr(pr(n)))}else if(Q(r,2)){if(w(n))return Jn(n);if(v(n))return ar(n);if(b(n))return jr(at(n,null,!1,!1))}else if(Mn(r,O)){if(w(n))return Jn(n);if(v(n))return function(n,r,t){return 2===arguments.length&&(t=r),Vn(qr(er(pr(2===arguments.length?n:nr(n,r)),t)),On(t))}(n,r)}}else if("fro"===r&&b(n))return L.sqrt(rt(hr(M(Sr(n),n))));y("norm")}function vr(n,r){return v(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),N(d(n),d(r),O)}function yr(n,t){return null==t&&(t=C),N(d(n=bn(n=null==n?1:n,!0)),d(n),function(n,r){return n===r?t:O})}function wr(n,r,t){if(1===arguments.length&&A(n)){if(yn(n)){for(var e,i=W(n),u=U(n),o=new Array(u*i),f=0,c=0;c<u;++c)for(e=0;e<i;++e)o[f++]=n[e][c];return o}return n}if(null!=t&&null!=r||(null!=r?(t=r,r=C):(t=n,n=r=C)),n=bn(n,!0),r=bn(r,!0),t=bn(t,!0),o=[],Mn(r,O))for(;Rn(n,t);n=V(n,r))o.push(n);else if(Pn(r,O))for(;Tn(n,t);n=V(n,r))o.push(n);return o}function br(n,r,t){if("horz"===n){if(vn(r)&&vn(t))return r.concat(t);if(yn(r)&&yn(t)&&W(r)===W(t))return r.map(function(n,r){return n.concat(t[r])})}if("vert"===n){if(vn(r)&&vn(t))return r.concat(t);if(yn(r)&&yn(t)&&U(r)===U(t))return r.concat(t)}y("cat")}function xr(t){return yn(t)?N(U(t),W(t),function(n,r){return t[r][n]}):t}function Sr(t){return yn(t)?N(U(t),W(t),function(n,r){return w(t[r][n])?Hn(t[r][n]):t[r][n]}):vn(t)?t.map(function(n){return w(n)?Hn(n):n}):w(t)?Hn(t):t}function Ar(t,i){return i=d(i||0),dn(t)?[[t]]:vn(t)?N(t.length,t.length,function(n,r){return i===n-r?t[n]:O}):yn(t)?t.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i===e-t&&n.push(r),n},n)},[]):void y("diag")}function _r(t,n){var e,i;return dn(t)?t:vn(t)?t.slice().reverse():yn(t)?(e=W(t),i=U(t),1===(n=d(n=null==n?1:n))?N(e,i,function(n,r){return t[e-1-n][r]}):2===n?N(e,i,function(n,r){return t[n][i-1-r]}):t):void y("flip")}function Ir(n,r){var t=hr(n),e=hr(r),n=mr(n),r=mr(r),t=Pn(t,e)?-1:Mn(t,e)?1:0,e=Pn(n,r)?-1:Mn(n,r)?1:0;return t||e}function Er(n,r){var t=Jn(n),e=Jn(r),n=Kn(n),r=Kn(r),t=Pn(t,e)?-1:Mn(t,e)?1:0,e=Pn(n,r)?-1:Mn(n,r)?1:0;return t||e}function kr(r,t,e,i,n){var u;if(dn(r))return r;if(v(r))return null==i&&(i=pn(r)?Ir:Er),u=r.map(function(n,r){return{v:n,i:r}}).sort("descend"===e?function(n,r){return i(r.v,n.v)||n.i-r.i}:function(n,r){return i(n.v,r.v)||n.i-r.i}),n?[u.map(function(n){return n.v}),u.map(function(n){return n.i+1})]:u.map(function(n){return n.v});if(b(r)){if(1===t)return n?(u=F(U(r),function(n){n=q(r,n);return kr(n,t,e,null==i?pn(n)?Ir:Er:i,!0)}),[N(W(r),U(r),function(n,r){return u[r][0][n]}),N(W(r),U(r),function(n,r){return u[r][1][n]})]):(u=F(U(r),function(n){n=q(r,n);return kr(n,t,e,null==i?pn(n)?Ir:Er:i,!1)}),N(W(r),U(r),function(n,r){return u[r][n]}));if(2===t)return n?(u=F(W(r),function(n){n=r[n];return kr(n,t,e,null==i?pn(n)?Ir:Er:i,!0)}),[N(W(r),U(r),function(n,r){return u[n][0][r]}),N(W(r),U(r),function(n,r){return u[n][1][r]})]):(u=F(W(r),function(n){n=r[n];return kr(n,t,e,null==i?pn(n)?Ir:Er:i,!1)}),N(W(r),U(r),function(n,r){return u[n][r]}))}y("sort")}function Nr(r){return w(r)?r:v(r)?r.reduce(function(n,r){return n=Pn(r,n)?r:n},l):b(r)?F(U(r),function(n){return Nr(q(r,n))}):s}function jr(r){return w(r)?r:v(r)?r.reduce(function(n,r){return n=Mn(r,n)?r:n},-l):b(r)?F(U(r),function(n){return jr(q(r,n))}):s}function qr(r){return w(r)?r:v(r)?r.reduce(D,O):b(r)?F(U(r),function(n){return qr(q(r,n))}):s}function Pr(r){return w(r)?r:v(r)?r.reduce(J,C):b(r)?F(U(r),function(n){return Pr(q(r,n))}):s}function Mr(r,e,i){if(i=!0===i,w(r)&&w(e))return J(r,i?e:Hn(e));if(v(r)&&v(e)){if(r.length===e.length)return r.reduce(function(n,r,t){return D(n,J(r,i?e[t]:Hn(e[t])))},0)}else if(b(r)&&b(e)&&W(r)===W(e)&&U(r)===U(e))return F(U(r),function(n){return Mr(q(r,n),q(e,n),i)});return 0}function Rr(t,e){var n,r,i,u;if(b(t)){if(b(e))return n=W(t),r=U(t),i=W(e),u=U(e),N(n*i,r*u,function(n,r){return M(t[S.floor(n/i)][S.floor(r/u)],e[n%i][r%u])});if(v(e))return n=W(t),r=U(t),i=1,u=e.length,N(n*i,r*u,function(n,r){return M(t[n][S.floor(r/u)],e[r%u])})}else if(v(t)){if(v(e))return N(t.length,e.length,function(n,r){return M(t[n],e[r])});if(b(e))return n=t.length,i=W(e),u=U(e),N(n*i,(r=1)*u,function(n,r){return M(t[S.floor(n/i)],e[n%i][r%u])})}return M(t,e)}function Tr(r,t,e,i){var u;if(w(r))return r;if(v(r)){if("reverse"===(e=null==e?"forward":e))return r.slice().reverse().map(function(n,r){return u=0===r?n:t(u,n),acc}).reverse();if("forward"===e)return r.map(function(n,r){return u=0===r?n:t(u,n)})}else if(b(r)){if(1===(i=d(i=null==i?1:i)))return F(U(r),function(n){return Tr(q(r,n),t,e,i)});if(2===i)return F(W(r),function(n){return Tr(r[n],t,e,i)})}return!1}function Xr(r,t,e,i,u){var o;if(v(r))return F(o=r.length,function(n){return t(r.slice(S.max(0,n-e),S.min(o-1,n+i)+1))});if(b(r)){if(1===(u=d(u=null==u?1:u)))return F(U(r),function(n){return Xr(q(r,n),t,e,i,u)});if(2===u)return F(W(r),function(n){return Xr(r[n],t,e,i,u)})}return!1}function Zr(r){var n=[].slice.call(arguments,1);return A(n[0])&&(n=n[0]),dn(r)?n.length?n.map(function(n){return[1,1][d(n)-1]}):[1,1]:vn(r)?n.length?n.map(function(n){return[1,r.length][d(n)-1]}):[1,r.length]:yn(r)?n.length?n.map(function(n){return[W(r),U(r)][d(n)-1]}):[W(r),U(r)]:[]}function zr(n){return A(n)?S.max.apply(null,Zr(n)):null==n?0:1}function Lr(n,i){var u;return v(n)?n.reduce(function(n,r,t){return i(r,t+1,1)&&n.push(t+1),n},[]):b(n)?(u=W(n),n.reduce(function(n,r,e){return r.reduce(function(n,r,t){return i(r,e+1,t+1)&&n.push(e+u*t+1),n},n)},[])):[]}function Or(n,r){if(w(n))return r(n,1,1)?1:0;if(v(n)){for(var t=0,e=n.length;t<e;++t)if(!r(n[t],t+1,1))return 0;return 1}if(b(n)){for(var t=0,i=W(n),u=U(n);t<i;++t)for(var o=0;o<u;++o)if(!r(n[t][o],t+1,o+1))return 0;return 1}return 0}function Cr(n,r){if(w(n))return r(n,1,1)?1:0;if(v(n)){for(var t=0,e=n.length;t<e;++t)if(r(n[t],t+1,1))return 1}else if(b(n))for(var t=0,i=W(n),u=U(n);t<i;++t)for(var o=0;o<u;++o)if(r(n[t][o],t+1,o+1))return 1;return 0}function $r(n,r,t){var e;r!==t&&(e=n[r],n[r]=n[t],n[t]=e)}function Fr(n,r,t,e,i,u){var o,f=n[0].length;for(null==e&&(e=C),null==i&&(i=C),o=u||0;o<f;++o)n[r][o]=D(J(i,n[r][o]),J(e,n[t][o]))}function Wr(n,t){return w(t)?w(n)?P(n,t):n.filter(function(n){return Wr(n,t)}).length===n.length:!!A(t)&&(w(n)?Wr(t,n):n.length===t.length&&n.filter(function(n,r){return Wr(n,t[r])}).length===t.length)}function Ur(t,e,i,n,r){var u=W(t),o=U(t);return u&&o?A(e)&&A(i)?(e=e.filter(function(n){return 0<=n&&n<u}),i=i.filter(function(n){return 0<=n&&n<o}),N(e.length,i.length,function(n,r){return t[e[n]][i[r]]})):((e=null==e?0:e)<0&&(e+=u),(i=null==i?0:i)<0&&(i+=o),(n=null==n?u-1:n)<0&&(n+=u),(r=null==r?o-1:r)<0&&(r+=o),e=S.max(0,S.min(u-1,e)),n=S.max(0,S.min(u-1,n)),i=S.max(0,S.min(o-1,i)),r=S.max(0,S.min(o-1,r)),e<=n&&i<=r?N(n-e+1,r-i+1,function(n,r){return t[e+n][i+r]}):[]):[]}function Br(t,e,n){var i=W(t),u=U(t),o=W(e),f=U(e);return"vert"===(n=n||"horz")?N(i+o,S.max(u,f),function(n,r){return u<=r?n<i?O:e[n-i][r]:f<=r?n<i?t[n][r]:O:(n<i?t[n]:e[n-i])[r]}):N(S.max(i,o),u+f,function(n,r){return i<=n?r<u?O:e[n][r-u]:o<=n?r<u?t[n][r]:O:r<u?t[n][r]:e[n][r-u]})}function Qr(n,r,t,e){var i,u,o,f=W(n),c=U(n);if(!1===t||f===c){for(e=B(e||0),i=S.min(f,c),u=0;u<i;++u){if("lower"===r||"diagonal"===r)for(o=u+1;o<i;++o)if(!Wn(Jn(n[u][o]),e))return;if("upper"===r||"diagonal"===r)for(o=0;o<u;++o)if(!Wn(Jn(n[u][o]),e))return}if(c<f){for(u=i;u<f;++u)for(o=0;o<c;++o)if(!Wn(Jn(n[u][o]),e))return}else if(f<c)for(o=i;o<c;++o)for(u=0;u<f;++u)if(!Wn(Jn(n[u][o]),e))return;return 1}}function Vr(n,r){var t,e,i;return P(r,O)?(t=C,e=O):P(n,O)?(t=O,P(e=Bn(Hn(r)),O)&&(e=C)):(i=Bn(n),t=K(n=Jn(n),n=cr(n,Jn(r))),e=K(J(i,Hn(r)),n)),[t,e]}function Gr(n,r,t,e,i){var u,o,f,c,a=W(i),l=Sn(i),s=2===r.length&&w(r[0])?(o=r[0],f=Gn(r[1]),c=r[1],r[0]):2===r.length&&2===r[0].length?(o=r[0][0],f=r[0][1],c=r[1][0],r[1][1]):(o=r[t][t],f=r[t][e],c=r[e][t],r[e][e]);if("right"===n)for(u=0;u<a;++u)l[u][t]=D(J(o,i[u][t]),J(c,i[u][e])),l[u][e]=D(J(f,i[u][t]),J(s,i[u][e]));else for(u=0;u<a;++u)l[t][u]=D(J(o,i[t][u]),J(f,i[e][u])),l[e][u]=D(J(c,i[t][u]),J(s,i[e][u]));return l}c.decimal=function(n){"function"==typeof n?(_=n,un.call(_.prototype,"_valueof")||(_.prototype._valueof=null,_.prototype.$valueOf=function(){return null==this._valueof&&(this._valueof=parseFloat(this.toFixed(9))),this._valueof},_.prototype.sign=function(){return _.sign(this)}),O=_(0),C=_(1),z=_(-1),nn=_(.5),rn=_(2),tn=_(10),f=_(S.log(10)),a=_(S.log(2)),cn.eps=_(Y),cn.pi=_(T),cn.e=_(i),cn.realmax=_(h),cn.realmin=_(m),cn.intmax=_(g),cn.intmin=_(X),cn.bitmax=_(Z)):(_=null,O=0,z=-(C=1),nn=.5,rn=2,tn=10,a=S.log(2),f=S.log(10),cn.eps=Y,cn.pi=T,cn.e=i,cn.realmax=h,cn.realmin=m,cn.intmax=g,cn.intmin=X,cn.bitmax=Z),I&&(new I(O,C),t=new I(cn.e,O)),en.forEach(function(n){n()})},c.is_array=A,c.is_obj=sn,c.is_string=k,c.is_nan=hn,c.is_inf=mn,c.is_number=u,c.is_decimal=gn,c.is_int=p,c.is_complex=o,c.is_real=pn,c.is_scalar=w,c.is_vector=v,c.is_matrix=b,c.array=F,c.matrix=N,E.rowvec=function(n){return dn(n)?[[n]]:vn(n)?[n]:n},E.colvec=wn,c.sca=bn,c.vec=j,c.tonumber=xn,c.todecimal=function n(r){return A(r)?r.map(n):w(r)?B(r):r},c.copy=Sn,c.apply=An,c.apply2=_n,c.exist=function(n,r){return sn(r)&&k(n)&&un.call(r,n)?1:0},c.varargout=In,c.num2str=En,c.MAXPRINTSIZE=l,c.tex=function(n){return A(n)?n=n.length?n.$scilitevarargout$?"\\["+n.map(kn).join("\\]\n\\[")+"\\]":A(n[0])?A(n[0][0])||!A(n[1])||n[0].length!==n[1].length?"\\["+n.map(kn).join("\\]\n\\[")+"\\]":"\\["+kn(n)+"\\]":"\\["+(n=n.length>c.MAXPRINTSIZE?n.slice(0,S.round(c.MAXPRINTSIZE/2)).concat("\\vdots").concat(n.slice(1-S.round(c.MAXPRINTSIZE/2))):n).map(kn).join("\\]\n\\[")+"\\]":"":(n=kn(n)).length&&(n="\\["+n+"\\]"),n},c.str=function(n){return n=A(n)?n.length?n.$scilitevarargout$?n.map(Nn).join("\n\n"):A(n[0])?A(n[0][0])||!A(n[1])||n[0].length!==n[1].length?n.map(Nn).join("\n\n"):Nn(n):(n=n.length>c.MAXPRINTSIZE?n.slice(0,S.round(c.MAXPRINTSIZE/2)).concat(":").concat(n.slice(1-S.round(c.MAXPRINTSIZE/2))):n).map(Nn).join("\n"):"":Nn(n)},c.neq=Q,c.nlt=Pn,c.ngt=Mn,c.nle=Rn,c.nge=Tn,c.nadd=V,c.nsub=G,c.nmul=H,c.ndiv=Xn,c.npow=Zn,c.nmod=zn,c.nneg=Ln,c.ninv=On,c.eq=P,c.ne=Cn,c.lt=$n,c.gt=Fn,c.le=Wn,c.ge=Un,c.ssign=Bn,c.sadd=D,c.ssub=Qn,c.smul=J,c.sdiv=K,c.spow=Vn,c.sneg=Gn,c.sconj=Hn,c.sinv=Dn,c.sabs=Jn,c.sangle=Kn,c.add=Yn,c.sub=nr,c.dotmul=rr,E.times=rr,c.dotdiv=tr,c.dotpow=er,E.power=er,c.mul=M,c.pow=ir,E.mpower=ir,c.neg=ur,c.get=or,c.set=fr,c.PALETTE=["#ff0000","#00ff00","#0000ff","#00ffff","#ff00ff","#ffff00","#4eca8e","#df7c26","#e6e641","#6da20b","#37ed75","#a20ac4","#e6efd2","#22ad51","#2c7496","#bb3e25","#42cda8","#c02a98","#404ad4","#3f8c36","#d15fec","#c4f84d","#eb5291","#38b3e0","#29790c","#4f17e8"],sr.prototype={constructor:sr,canvas:null,type:"",data:null,no:0,xscale:"linear",yscale:"linear",xlabel:"",ylabel:"",title:"",xmin:0,xmax:1,ymin:0,ymax:1,scx:1,scy:1,sc:1,pt:45,pb:60,pl:70,pr:20,option:function(n,r,t,e){var i,u,o,f={"-":[],"--":[15,5],":":[5,5],"-.":[15,5,5,5]},c={red:"r",green:"g",blue:"b",cyan:"c",magenta:"m",yellow:"y",black:"k",white:"w"},a={r:[1,0,0],g:[0,1,0],b:[0,0,1],c:[0,1,1],m:[1,0,1],y:[1,1,0],k:[0,0,0],w:[1,1,1]},l=["b","r","g","y","c","m","k","w"];if(n.Color)return{Color:a[l[(e||0)%l.length]],LineWidth:n.LineWidth,LineStyle:n.LineStyle,_LineStyle:n._LineStyle};for(n.Color||(n.Color=a[l[(e||0)%l.length]]),n.LineWidth||(n.LineWidth=1),n.LineStyle||(n.LineStyle=f["-"]),n._LineStyle||(n._LineStyle="-"),t=t||0;t<r.length;){if("Color"===r[t])k(i=r[t+1])?un.call(c,i)?n.Color=a[c[i]]:un.call(a,i)&&(n.Color=a[i]):v(i)&&3===i.length&&(n.Color=xn(i));else if("LineWidth"===r[t])$(i=r[t+1])&&(n.LineWidth=2*xn(i));else{if("LineStyle"!==r[t]){if(k(r[t])){for(u in o=!1,i=r[t],a)-1<i.indexOf(u)&&(n.Color=a[u],o=!0);for(u in f)"-"!==u&&-1<i.indexOf(u)&&(n._LineStyle=u,n.LineStyle=f[u],o=!0);if(o){t+=1;continue}}break}k(i=r[t+1])&&un.call(f,i)&&(n._LineStyle=i,n.LineStyle=f[i])}t+=2}return t},parse:function(n,r,t){var e,i,u,o,f,c,a=this,l=0,s=0;if("pie"===r)for(;l<n.length;)v(n[l])?a.data.push({y:xn(n[l++])}):l+=1;else if("plot3"===r)for(;l<n.length;)f=o=u=null,v(n[l])&&(u=n[l]),v(n[l+1])&&(o=n[l+1]),v(n[l+2])&&(f=n[l+2],l+=3),u&&o&&f?(l=a.option(c={},n,l,s),a.data.push({x:xn(u),y:xn(o),z:xn(f),style:c}),++s):l+=1;else for(;l<n.length;)if(o=u=null,v(n[l])&&(u=n[l]),v(n[l+1])||b(n[l+1])?(o=n[l+1],l+=2):u&&(u=wr(1,(o=u).length),l+=1),u&&o)if(l=a.option(c={},n,l,s),b(o))for(e=0,i=U(o);e<i;++e)a.data.push({x:xn(u),y:xn(q(o,e)),style:c}),c=a.option(c,n,l,++s);else a.data.push({x:xn(u),y:xn(o),style:c}),++s;else l+=1;return a}},c.figure=sr,c.createCanvas=function(n,r){},c.currentCanvas=function(){},E.clc=r,E.disp=r,E.clear=r,E.help=r,E.who=r,E.whos=r,E.exist=r,["floor","ceil","round","sign","abs","exp","log","log10","log2","sqrt","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){L[r]="log"===r?function(n){return u(n)?S.log(n):n.ln()}:"log10"===r?function(n){return u(n)?S.log10(n):n.log(tn)}:"log2"===r?function(n){return u(n)?S.log2(n):n.log(rn)}:function(n){return u(n)?S[r](n):n[r]()}}),L.atan2=function(n,r){return Q(O,r)&&Q(O,n)?O:(u(n)&&u(r)?S:_).atan2(n,r)},L.fix=function(n){return Pn(n,O)?L.ceil(n):L.floor(n)},c.realMath=L,(I=function n(r,t,e){var i=this;if(!an(i,n))return new n(r,t,e);o(r)?(i.re=r.re,i.im=r.im):(t=t||O,"polar"===e?(i._rho=L.abs(r),i.re=H(i._rho,L.cos(t)),i.im=H(i._rho,L.sin(t))):(i.re=r,i.im=t))}).prototype={constructor:I,re:0,im:0,_rho:null,_rho2:null,_theta:null,_sgn:null,_str:null,abs:function(n){var r=this;return null==r._rho&&(r._rho=cr(r.re,r.im)),r._rho},norm2:function(){return null==this._rho2&&(this._rho2=Zn(this.abs(),rn)),this._rho2},angle:function(){var n=this;return null==n._theta&&(n._theta=L.atan2(n.im,n.re)),n._theta},sign:function(){var n=this;return null==n._sgn&&(n._sgn=Q(n.im,O)?L.sign(n.re):n.div(n.abs()),o(n._sgn))&&(n._sgn._sgn=n._sgn),n._sgn},add:function(n){return $(n)?new I(V(this.re,n),this.im):new I(V(this.re,n.re),V(this.im,n.im))},sub:function(n){return $(n)?new I(G(this.re,n),this.im):new I(G(this.re,n.re),G(this.im,n.im))},mul:function(n){var r,t,e,i=this;return $(n)?new I(Q(i.re,O)?O:H(i.re,n),Q(i.im,O)?O:H(i.im,n)):(r=i.re,e=n.re,i=i.im,t=H(r,V(e,n=n.im)),n=H(n,V(r,i)),e=H(e,G(i,r)),new I(G(t,n),V(t,e)))},div:function(n){var r,t,e,i=this;return $(n)?new I(Q(i.re,O)?O:Xn(i.re,n),Q(i.im,O)?O:Xn(i.im,n)):(t=n.norm2(),r=i.re,e=Xn(n.re,t),i=i.im,t=H(r,V(e,n=Ln(Xn(n.im,t)))),n=H(n,V(r,i)),e=H(e,G(i,r)),new I(G(t,n),V(t,e)))},pow:function(n){var r,t;return hn(n)?s:$(n)?new I(Zn(this.abs(),n),H(this.angle(),n),"polar"):o(n)?(r=this.abs(),t=this.angle(),new I(Zn(r,n.re),H(n.im,L.log(r)),"polar").mul(new I(L.exp(Ln(H(n.im,t))),H(t,n.re),"polar"))):void 0},neg:function(){return new I(Ln(this.re),Ln(this.im))},conj:function(){return new I(this.re,Ln(this.im))},inv:function(){var n=this.norm2();return new I(Xn(this.re,n),Ln(Xn(this.im,n)))},toString:function(){var n=this;return null==n._str&&(n._str=En(n.re)+(Pn(n.im,O)?" - ":" + ")+En(L.abs(n.im))+"i"),n._str},valueOf:function(){return d(this.re)}},new I(O,C),t=new I(cn.e,O),e={floor:function(n){return new I(L.floor(n.re),L.floor(n.im))},ceil:function(n){return new I(L.ceil(n.re),L.ceil(n.im))},round:function(n){return new I(L.round(n.re),L.round(n.im))},fix:function(n){return new I(L.fix(n.re),L.fix(n.im))},sign:function(n){return n.sign()},sqrt:function(n){return n.pow(new I(nn,O))},exp:function(n){return t.pow(n)},log:function(n){return new I(L.log(n.abs()),n.angle())},log10:function(n){return e.log(n).div(f)},log2:function(n){return e.log(n).div(a)},sin:function(n){return new I(H(L.sin(n.re),L.cosh(n.im)),H(L.cos(n.re),L.sinh(n.im)))},cos:function(n){return new I(H(L.cos(n.re),L.cosh(n.im)),Ln(H(L.sin(n.re),L.sinh(n.im))))},tan:function(n){return e.sin(n).div(e.cos(n))},sinh:function(n){return new I(H(L.sinh(n.re),L.cos(n.im)),H(L.cosh(n.re),L.sin(n.im)))},cosh:function(n){return new I(H(L.cosh(n.re),L.cos(n.im)),H(L.sinh(n.re),L.sin(n.im)))},tanh:function(n){return e.sinh(n).div(e.cosh(n))},asin:null,acos:null,atan:null,asinh:null,acosh:null,atanh:null},c.complexMath=e,E.complex=I,["floor","ceil","round","fix","sign","exp","log","log10","log2","sin","cos","tan","sinh","cosh","tanh","asin","acos","atan","asinh","acosh","atanh"].forEach(function(r){E[r]=e[r]?function(n){return An(function(n){return(o(n)?e:L)[r](n)},n,!0)}:function(n){return An(function(n){return L[r](n)},n,!1)}}),E.atan2=function(n,r){return _n(function(n,r){return L.atan2(n,r)},n,r,!1)},E.sqrt=function(n){return An(function(n){return o(n)?e.sqrt(n):Mn(O,n)?new I(O,L.sqrt(Ln(n))):L.sqrt(n)},n,!0)},["sqrt","pow","log"].forEach(function(r){E["real"+r]=function(n){return An(function(n){o(n=jn(n))&&y("real"+r);n=L[r](n);return hn(n)||!pn(n)?y("real"+r):n},n,!0)}}),E.real=hr,E.imag=mr,E.conj=gr,E.abs=pr,E.angle=function(n){return An(Kn,n,!0)},E.norm=dr,E.zeros=vr,E.ones=function(n,r){return v(n=null==n?1:n)&&(r=n[1],n=n[0]),null==r&&(r=n),N(d(n),d(r),C)},E.eye=function(n){return yr(n,C)},E.rand=function(n,r){return null==n?B(S.random()):(v(n)&&(r=n[1],n=n[0]),null==r&&(r=n),N(d(n),d(r),function(){return B(S.random())}))},E.randi=function(n,r,t){return null==r&&null==t?B(S.ceil(S.random()*n)):(v(r)&&(t=r[1],r=r[0]),null==t&&(t=r),N(d(r),d(t),function(){return B(S.ceil(S.random()*n))}))},E.randn=function(n,r){return null==n?B(lr()):(v(n)&&(r=n[1],n=n[0]),null==r&&(r=n),N(d(n),d(r),function(){return B(lr())}))},E.randperm=function(n){(!p(n=d(n||0))||n<=0)&&y("randperm");for(var r,t,e=F(n,function(n){return n+1}),i=1+(e.length-1);1<i--;)r=S.round(S.random()*+i),t=e[0+i],e[0+i]=e[0+r],e[0+r]=t;return e},E.magic=function(n){var t;return n=p(n=bn(n,!0))?d(n):null,!p(n)||n<=2?1===n?[[C]]:[]:(t=function n(t){var e,i,u,o,f,r,c,a,l,s,h,m,g,p=1&t,d=0==(3&t),v=t*t,y=t-p>>1;if(p)return e=t+y,i=y+p,N(t,t,function(n,r){return(e+n-(r=t-1-r))%t*t+(i+r+n)%t+1});if(d)return l=0,N(t,t,function(n,r){return++l,(n+1&3)>>1==(r+1&3)>>1?v-(l-1):l});for(m=n(y),f=(o=(u=p=y*y)<<1)+p,g=N(t,t,function(n,r){return n<y&&r<y?m[n][r]:n<y?m[n][r-y]+f:r<y?m[n-y][r]+o:m[n-y][r-y]+u}),c=r=y>>>1,h=0;h<y;++h)for(s=0;s<t;++s)!(s<r||t-c<s||s===r&&h===r)||0===s&&h===r||(a=g[s][h],g[s][h]=g[s][h+y],g[s][h+y]=a);return g}(n),N(n,n,function(n,r){return B(t[n][r])}))},E.pascal=function(n){var t,r;return 1<arguments.length&&y("pascal"),n=p(n=bn(n,!0))?d(n):null,!p(n)||n<=0?[]:(t=N(r=n,r,function(n,r,t){return 0===n||0===r?1:t[n-1][r]+t[n][r-1]}),N(n,n,function(n,r){return B(t[n][r])}))},E.rosser=function(){return[[B(611),B(196),B(-192),B(407),B(-8),B(-52),B(-49),B(29)],[B(196),B(899),B(113),B(-192),B(-71),B(-43),B(-8),B(-44)],[B(-192),B(113),B(899),B(196),B(61),B(49),B(8),B(52)],[B(407),B(-192),B(196),B(611),B(8),B(44),B(59),B(-23)],[B(-8),B(-71),B(61),B(8),B(411),B(-599),B(208),B(208)],[B(-52),B(-43),B(49),B(44),B(-599),B(411),B(208),B(208)],[B(-49),B(-8),B(8),B(59),B(208),B(208),B(99),B(-911)],[B(29),B(-44),B(52),B(-23),B(208),B(208),B(-911),B(99)]]},E.vander=function(n){return v(n=j(n))||y("vander"),n.map(function(t){return F(n.length,function(n,r){return 0===n?C:J(r[n-1],t)}).reverse()})},E.toeplitz=function(t,e){return 1===arguments.length?N((e=j(t)).length,e.length,function(n,r){return n===r?e[0]:n<r?e[S.abs(n-r)]:Hn(e[S.abs(n-r)])}):(t=j(t),e=j(e),N(t.length,e.length,function(n,r){return n===r?t[0]:(n<r?e:t)[S.abs(n-r)]}))},E.hankel=function(t,e){var i,n;return 1===arguments.length?(t=j(t),N(i=t.length,i,function(n,r){return i-1-n<r?O:t[(n+r)%i]})):(t=j(t),e=j(e),i=t.length,N(n=e.length,n,function(n,r){return i<=n+r-1?e[n+r-i]:t[(n+r)%i]}))},E.hadamard=function(n){return function n(r){return 1===r?[[C]]:2===r?[[C,C],[C,z]]:4===r?[[C,C,C,C],[C,z,C,z],[C,C,z,z],[C,z,z,C]]:0==r%4&&(r=n(r/2)).length?Rr([[C,C],[C,z]],r):[]}(d(n))},E.linspace=function(n,r,t){t=d(t=null==t?100:t);for(var e=Xn(G(r,n),t-1),i=new Array(t),u=0,o=n;u<t;++u,o=V(o,e))i[u]=o;return i},E.logspace=function(n,r,t){t=d(t=null==t?100:t);for(var e=Zn(Xn(r,n),1/(t-1)),i=new Array(t),u=0,o=n;u<t;++u,o=J(o,e))i[u]=o;return i},E.meshgrid=function(t,e){if(1===arguments.length&&(e=t),v(t)&&v(e))return[N(e.length,t.length,function(n,r){return t[r]}),N(e.length,t.length,function(n,r){return e[n]})];y("meshgrid")},E.colon=wr,E.cat=function(n,r,t){var e,i=[];if(1===(n=d(n)))for(i=r,e=2;e<arguments.length;++e)i=br("vert",i,arguments[e]);else if(2===n)for(i=r,e=2;e<arguments.length;++e)i=br("horz",i,arguments[e]);return i},E.horzcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=br("horz",t,arguments[e]);return t},E.vertcat=function(n,r){for(var t=n,e=1;e<arguments.length;++e)t=br("vert",t,arguments[e]);return t},E.transpose=xr,E.ctranspose=Sr,E.diag=Ar,E.blkdiag=function(){return t=[].slice.call(arguments),l=a=c=f=o=0,t.forEach(function(n,r){dn(n)&&(t[r]=n=[[n]]),vn(n)&&(t[r]=n=Ar(n)),yn(n)||y("blkdiag"),o+=W(n),f+=U(n)}),e=t[c],i=W(e),u=U(e),N(o,f,function(n,r){return a+i<=n&&(a+=i,l+=u,e=t[++c],i=W(e),u=U(e)),r<l||l+u<=r?O:e[n-a][r-l]});var t,e,i,u,o,f,c,a,l},E.tril=function(t,e){if(yn(t))return e=d(e||0),N(W(t),U(t),function(n,r){return r<=n+e?t[n][r]:O});y("tril")},E.triu=function(t,e){if(yn(t))return e=d(e||0),N(W(t),U(t),function(n,r){return n+e<=r?t[n][r]:O});y("triu")},E.repmat=function(t,e,i){return v(e)&&(i=e[1],e=e[0]),null==i&&(i=e),e=d(e),i=d(i),yn(t=vn(t=dn(t)?[[t]]:t)?[t]:t)?N(e*W(t),i*U(t),function(n,r){return t[n%e][r%i]}):t},E.repelem=function(r,t){var e,i;if(v(r))if(v(t)){if(t.length===r.length)return e=0,i=-1,F(d(qr(t)),function(n){return n===e&&(e+=d(t[++i])),r[i]})}else if(p(t))return t=d(t),i=-1,F(t*r.length,function(n){return 0==n%t&&++i,r[i]});return r},E.reshape=function(t,e,n){v(e)&&(n=e[1],e=e[0]),e=d(e),n=d(n);var i,r=e*n;return dn(t)&&1===e&&1===n?[[t]]:vn(t)&&t.length===r?N(e,n,function(n,r){return t[n+e*r]}):yn(t)&&W(t)*U(t)==r?(i=W(t),N(e,n,function(n,r){n+=e*r;return t[n%i][S.floor(n/i)]})):t},E.squeeze=function(n){return n},E.flip=_r,E.fliplr=function(n){return _r(n,2)},E.flipud=function(n){return _r(n,1)},E.sort=In(function(n,r,t,e){for(var i=2,u=null;i<arguments.length;){if("ComparisonMethod"===arguments[i]){"real"===arguments[i+1]?u=Ir:"abs"===arguments[i+1]&&(u=Er),1===i?(t=1,e="ascend"):2===i&&(e="ascend");break}i+=1}return null==e&&(e="ascend"),kr(r,t=d(t=null==t?1:t),e,u,1<n)}),E.min=Nr,E.max=jr,E.sum=qr,E.prod=Pr,E.dot=Mr,E.cross=function(n,r){if(n=j(n),r=j(r),!v(n)||3!==n.length)throw"cross: input 1 not vector of length 3";if(v(r)&&3===r.length)return[Qn(J(n[1],r[2]),J(n[2],r[1])),Qn(J(n[2],r[0]),J(n[0],r[2])),Qn(J(n[0],r[1]),J(n[1],r[0]))];throw"cross: input 2 not vector of length 3"},E.kron=Rr,E.diff=function(n,r,t){for(null==t&&(t=1),p(r=null==r?1:r)||y("diff"),r=d(r);0<r--;)n=function r(t,n){if(v(t))return 1<t.length?F(t.length-1,function(n){return Qn(t[n+1],t[n])}):[];if(b(t)){if(1===(n=d(n=null==n?1:n)))return F(U(t),function(n){return r(q(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}y("diff")}(n,t);return n},E.cumsum=function(n,r,t){n=Tr(n,D,t,r);return!1===n&&y("cumsum"),n},E.cumprod=function(n,r,t){n=Tr(n,J,t,r);return!1===n&&y("cumprod"),n},E.cummin=function(n,r,t){n=Tr(n,function(n,r){return $n(n,r)?n:r},t,r);return!1===n&&y("cummin"),n},E.cummax=function(n,r,t){n=Tr(n,function(n,r){return Fn(n,r)?n:r},t,r);return!1===n&&y("cummax"),n},E.movsum=function(n,r,t){var e,i;return v(r)?(e=d(r[0]),i=d(r[1])):p(r)&&(i=1&(r=d(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Xr(n,qr,e,i,t))&&y("movsum"),r},E.movprod=function(n,r,t){var e,i;return v(r)?(e=d(r[0]),i=d(r[1])):p(r)&&(i=1&(r=d(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Xr(n,Pr,e,i,t))&&y("movprod"),r},E.movmean=function(n,r,t){var e,i;return v(r)?(e=d(r[0]),i=d(r[1])):p(r)&&(i=1&(r=d(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Xr(n,vt,e,i,t))&&y("movmean"),r},E.movmin=function(n,r,t){var e,i;return v(r)?(e=d(r[0]),i=d(r[1])):p(r)&&(i=1&(r=d(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Xr(n,Nr,e,i,t))&&y("movmin"),r},E.movmax=function(n,r,t){var e,i;return v(r)?(e=d(r[0]),i=d(r[1])):p(r)&&(i=1&(r=d(r))?e=r>>1:(e=r>>1,r-1>>1)),!1===(r=Xr(n,jr,e,i,t))&&y("movmax"),r},E.bitshift=function(n,r){return An(function(n){return p(n)?Pn(r,O)?d(n)>>-d(r):d(n)<<d(r):n},n,!0)},E.bitand=function t(r,e){if(p(r)){if(p(e))return d(r)&d(e);if(A(e))return e.map(function(n){return t(r,n)})}else if(A(r)){if(p(e))return r.map(function(n){return t(n,e)});if(A(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.bitor=function t(r,e){if(p(r)){if(p(e))return d(r)|d(e);if(A(e))return e.map(function(n){return t(r,n)})}else if(A(r)){if(p(e))return r.map(function(n){return t(n,e)});if(A(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.bitxor=function t(r,e){if(p(r)){if(p(e))return d(r)^d(e);if(A(e))return e.map(function(n){return t(r,n)})}else if(A(r)){if(p(e))return r.map(function(n){return t(n,e)});if(A(e)&&r.length===e.length)return r.map(function(n,r){return t(n,e[r])})}return 0},E.size=Zr,E.length=zr,E.ndims=function(n){return zr(Zr(n))},E.numel=function(n){return Pr(Zr(n))},E.rows=function(n){return Zr(n,1)},E.columns=function(n){return Zr(n,2)},E.sub2ind=function(n,r,t){return v(r)&&(t=r[1],r=r[0]),r=d(r),t=d(t),1===n.length?r:r-1+d(n[0])*(t-1)+1},E.ind2sub=function(n,r){return r=d(r),1===n.length?[r,1]:[(r-1)%d(n[0])+1,S.floor((r-1)/d(n[0]))+1]},c.find=Lr,E.find=function(n){return Lr(n,function(n){return!P(n,O)})},c.all=Or,E.all=function(n){return Or(n,function(n){return!P(n,O)})},c.any=Cr,E.any=function(n){return Cr(n,function(n){return!P(n,O)})},E.isnan=function n(r){return A(r)?r.map(n):hn(r)||o(r)&&(hn(r.re)||hn(r.im))?1:0},E.isinf=function n(r){return A(r)?r.map(n):$(r)?mn(r)?1:0:o(r)&&(mn(r.re)||mn(r.im))?1:0},E.isfinite=function n(r){return A(r)?r.map(n):$(r)?mn(r)?0:1:!o(r)||mn(r.re)||mn(r.im)?0:1},E.isreal=function(n){return Or(n,pn)},E.isempty=function(n){return A(n)?A(n[0])?n[0].length?0:1:n.length?0:1:0};var Hr=function(n,r,t,e){var i,u,o,f,c,a,l,s,h,m,g,p,d,v,y=W(n),w=U(n),b=w,x=0;for(e=B(e||0),A(t)&&(b=S.min(b,t[1])),d=Br(n,yr(y)),i=new Array(b),u=C,v=function(n,r){r=r||0;for(var t=x-1;0<=t;--t)if(n===i[t][r])return t;return-1},o=l=0;o<y&&!(b<=l);++o){for(f=o;Wn(Jn(d[f][l]),e);)if(y<=++f&&(f=o,b<=++l)){l=-1;break}if(-1===l)break;for(s=-1,m=null,p=0,f=c=f;f<y;++f)Wn(g=Jn(d[f][l]),e)?++p:null!=m&&!$n(g,m)||(m=g,s=f);for(;;){if(-1===s)break;if(y-c===p+1){for(o!==s&&($r(d,o,s),u=Gn(u)),$n(d[o][l],O)&&(Fr(d,o,o,O,z,l),u=Gn(u)),f=s,c=o;0<=f&&-1!==(a=v(f));)f=c-=x-a;i[x++]=[f,l],u=o<b?J(u,d[o][o]):O;break}for(p=0,h=s,f=c;f<y;++f)f!==h&&(Fr(d,f,h,Gn(K(d[f][l],d[h][l])),1,l),Wn(g=Jn(d[f][l]),e)?++p:$n(g,m)&&(m=g,s=f))}++l}return x<b&&(u=O),t=Ur(d,0,w,y-1,y+w-1),d=Ur(d,0,0,y-1,w-1),i.length>x&&(i.length=x),r?[d,i,u,t]:d};function Dr(n,r,t,e){var i,u,o,f,c,a,l=W(n),s=U(n),h=s;for(e=B(e||0),A(t)&&S.min(h,t[1]),a=Br((h=Hr(n,!0,t,e))[0],h[3]),i=h[1],n=h[2],u=i.length,f=0;f<u;++f)for(o=i[f][1],c=0;c<f;++c)Wn(Jn(a[c][o]),e)||(Fr(a,c,f,Gn(a[c][o]),a[f][o]),P(a[c][i[c][1]],C))||Fr(a,c,c,O,Dn(a[c][i[c][1]]),i[c][1]);return P(a[u-1][i[u-1][1]],C)||Fr(a,u-1,u-1,O,Dn(a[u-1][i[u-1][1]]),i[u-1][1]),t=Ur(a,0,s,l-1,l+s-1),a=Ur(a,0,0,l-1,s-1),r?[a,i,n,t]:a}function Jr(n,r,t){if(w(n)&&w(r))return K(r,n);if(!b(n))return[];if(!v(r)&&!b(r))return[];var e,i=U(n);if(W(n)!==i)return[];if(e=v(r)?(h=r.length,1):(h=W(r),U(r)),i!==h)return[];var u,o,f,c,a,l,s,h=Hr(xr(n),!0);if(h[1].length!==i)return[];if(u=xr(h[3]),o=xr(h[0]),v(r)){for(f=F(i,O),c=0;c<i;++c){if(P(o[c][c],O))return[];for(s=O,a=0;a<c;++a)s=D(s,J(o[c][a],f[a]));f[c]=K(Qn(r[c],s),o[c][c])}return F(i,function(r){return F(i,function(n){return J(f[n],u[r][n])}).reduce(D,O)})}for(f=vr(i,e),c=0;c<i;++c){if(P(o[c][c],O))return[];for(l=0;l<e;++l){for(s=O,a=0;a<c;++a)s=D(s,J(o[c][a],f[a][l]));f[c][l]=K(Qn(r[c][l],s),o[c][c])}}return N(i,e,function(r,t){return F(i,function(n){return J(f[n][t],u[r][n])}).reduce(D,O)})}function Kr(n){var r,t,e;return w(n)?Dn(n):b(n)&&W(n)===U(n)?1===(t=r=W(n))?[[Dn(n[0][0])]]:P((e=Dr(n,!0))[0][r-1][t-1],0)?[]:e[3].map(function(n,r){return n.map(function(n){return K(n,e[0][r][r])})}):[]}function Yr(n,r){var t,e,i=W(n),u=U(n);return r=r||Dr(n,!0),e=(t=r[1]).length,[Ur(n,F(i,function(n){return n}),F(e,function(n){return t[n][1]})),Ur(r[0],0,0,e-1,u-1).map(function(t,e){return t.map(function(n,r){for(r=e;r+1<u&&P(t[r],O);)++r;return K(n,t[r])})})]}function nt(t,n){var r,e,i,u,o;return w(t)?Dn(t):b(t)?(r=W(t),i=U(t),Wr(t,0)?xr(t):1===r&&1===i?[[Dn(t[0][0])]]:1===r||1===i?(o=t.reduce(function(n,r){return D(n,J(r,Hn(r)))},O),N(i,r,function(n,r){return K(Hn(t[r][n]),o)})):(n=(e=Dr(t,!0,null,n||0))[1].length)===i?r===i?e[3].map(function(n,r){return n.map(function(n){return K(n,e[0][r][r])})}):M(Kr(M(u=Sr(t),t)),u):n===r?M(u=Sr(t),Kr(M(t,u))):(i=Yr(t,e),o=M(Kr(M(u=Sr(o=i[0]),o)),u),n=M(u=Sr(n=i[1]),Kr(M(n,u))),M(n,o))):[]}function rt(e){return w(e)?e:b(e)?e.reduce(function(n,r,t){return D(n,t<r.length?e[t][t]:0)},0):void y("trace")}function tt(e,n,r){r=B(r||0);var t=W(e);return t!==U(e)?0:1===t?e[0][0]:Qr(e,"lower",!0,r)||Qr(e,"upper",!0,r)?e.reduce(function(n,r,t){return J(n,e[t][t])},1):!0===n?function n(r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d;function v(t,n,e,i){return N(n-1,n-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})}if(1===t)f=r[0][0];else if(2===t)c=r[0][0],a=r[0][1],l=r[1][0],f=Qn(J(c,s=r[1][1]),J(a,l));else if(3===t)c=r[0][0],a=r[0][1],l=r[0][2],s=r[1][0],h=r[1][1],m=r[1][2],g=r[2][0],p=r[2][1],d=r[2][2],f=Qn(Qn(Qn(D(D(J(J(c,h),d),J(J(a,m),g)),J(J(l,s),p)),J(J(l,h),g)),J(J(a,s),d)),J(J(c,m),p));else{for(e=u=i=0;e<t;++e)P(r[0][e],O)&&++i,P(r[e][0],O)&&++u;if(o=C,f=O,i<u)for(e=0;e<t;++e)P(r[e][0],O)||(f=D(f,J(r[e][0],J(o,n(v(r,t,e,0),t-1))))),o=C===o?z:C;else for(e=0;e<t;++e)P(r[0][e],O)||(f=D(f,J(r[0][e],J(o,n(v(r,t,0,e),t-1))))),o=C===o?z:C}return f}(e,t):Hr(e,!0,null,r)[2]}function et(n){b(n)&&W(n)===U(n)||y("charpoly");var e,r=W(n),i=(U(n),r),u=new Array(i+1),t=vr(i,i);for(u[i]=C,e=1;e<=i;++e)t=M(n,t).map(function(n,t){return n.map(function(n,r){return t===r?D(n,u[i-e+1]):n})}),u[i-e]=K(rt(M(n,t)),-e);return u.reverse()}function it(o){return N(U(o),W(o),function(n,r){return e=r,i=n,r=!0,n=W(t=o),u=U(t),n!==u?null:n<=1?0:(i=+(i||0),(e=+(e||0))<0||n<=e||i<0||u<=i?null:(n=tt(N(n-1,u-1,function(n,r){return e<=n&&++n,i<=r&&++r,t[n][r]})),!0===r&&e+i&1?Gn(n):n));var t,e,i,u})}function ut(n,r){for(var t,e,i=W(n),u=U(n),o=r?yr(i):null,f=n,c=0;c<u;++c)for(t=i-1;c+1<=t;--t)f=Gr("left",[Hn((e=Vr(f[t-1][c],f[t][c]))[0]),Gn(Hn(e[1]))],t-1,t,f),r&&(o=Gr("right",e,t-1,t,o));return r?[o,f]:f}function ot(n,r,t){null==r&&(r=2);for(var e,i,u,o,f,c,a=W(n),l=Sn(n),s=t?F(a,C):null,h=B(1e-10),m=1;m<=1e4;++m){for(e=c=0;e<a;++e)if((o=q(l,e).map(B)).splice(e,1),(f=l[e].map(B)).splice(e,1),o=dr(o,r),Q(f=dr(f,r),O)||Q(o,O))++c;else{for(u=L.sqrt(Xn(f,o)),Rn(L.abs(G(u,C)),h)&&++c,t&&(s[e]=H(u,s[e])),i=0;i<a;++i)l[i][e]=J(l[i][e],u);for(i=0;i<a;++i)l[e][i]=K(l[e][i],u)}if(a===c)break}return t?[s,l]:l}function ft(n,r,t){var e=W(n);if(null==r){var i,u,o=t?yr(e):null,f=n;for(c=1;c<=e-2;++c)for(a=e;c+2<=a;--a)u=[Hn((i=Vr(f[a-1-1][c-1],f[a-1][c-1]))[0]),Gn(Hn(i[1]))],t&&(o=Gr("right",i,a-1-1,a-1,o)),f=Gr("left",u,a-1-1,a-1,Gr("right",i,a-1-1,a-1,f));return t?[o,f]:f}var c,a,l,s,h=Sr(o=ut(r,!0)[0]),m=yr(e),g=M(h,n),p=M(h,r);for(c=1;c<=e-2;++c)for(a=e;c+2<=a;--a)l=[Hn((s=Vr(g[a-1-1][c-1],g[a-1][c-1]))[0]),Gn(Hn(s[1]))],o=Gr("right",s,a-1-1,a-1,o),g=Gr("left",l,a-1-1,a-1,g),p=Gr("left",l,a-1-1,a-1,p),m=Gr("right",s=Vr(Gn(p[a-1][a-1]),p[a-1][a-1-1]),a-1-1,a-1,m),g=Gr("right",s,a-1-1,a-1,g),p=Gr("right",s,a-1-1,a-1,p);return[g,p,o,m]}function ct(n){var r,t,e,i,u=B(1e-10),o=W(n),f=new Array(o),c=new Array(o),a=F(o,0);for(n=Sn(n),i=0;i<o;++i)r=(e=function(n,r,t,e){var i,u,o,f,c,a,l=O;if(!0===e){for(f=tr(f=F(r,function(){return new I(B(S.random()||.1),O)}),dr(f)),i=1;i<=100&&(o=l,l=Mr(f=j(M(n,c=f)),c),f=tr(f,f[0].sign()),f=tr(f,dr(f)),!Rn(L.abs(G(hr(l),hr(o))),t)||!Rn(L.abs(G(mr(l),mr(o))),t));++i);return l}for(u=Sr(n),f=tr(f=F(r,function(){return new I(B(S.random()||.1),O)}),dr(f)),a=tr(a=F(r,function(){return new I(B(S.random()||.1),O)}),dr(a)),i=1;i<=100&&(o=l,f=j(M(n,c=f)),a=j(M(u,a)),l=Mr(f,c),f=tr(f,f[0].sign()),a=tr(a,a[0].sign()),f=tr(f,dr(f)),a=tr(a,dr(a)),!Rn(L.abs(G(hr(l),hr(o))),t)||!Rn(L.abs(G(mr(l),mr(o))),t));++i);return[l,f,a]}(n,o,u))[0],t=e[1],e=e[2],n=nr(n,M(M(K(a[i]=r,Mr(f[i]=t,c[i]=e,!0)),t),e));return[jn(xr(f)),jn(a),jn(xr(c))]}function at(n,r,t,e){r=B(r=$(r)?r:Y);var i,u=U(n),o=W(n);if(o<u)return i=at(xr(n),r,e,t),t&&e?[xr(i[2]),i[1],xr(i[0])]:t||e?[xr(i[0]),i[1]]:i;var f,c,a,l,s,h,m,g,p,d,v,y,w,b,x,S,A,_,I,Z,E,k=t?o:0,N=e?u:0,j=Sn(n),q=k?vr(o,k):null,P=F(u,O),M=N?vr(u,N):null,z=Xn(cn.realmin,r),R=new Array(u),T=new Array(u),X=new Array(u);for(T[0]=O,b=1;b<=u;++b){for(A=b+1,a=O,y=b;y<=o;++y)a=V(a,V(Zn(hr(j[y-1][b-1]),rn),Zn(mr(j[y-1][b-1]),rn)));if(R[b-1]=O,Mn(a,z)&&(a=L.sqrt(a),R[b-1]=a,s=Q(l=Jn(j[b-1][b-1]),O)?C:K(j[b-1][b-1],l),j[b-1][b-1]=J(s,V(a,l)),b!==u+0)){for(w=A;w<=u+0;++w){for(s=O,y=b;y<=o;++y)s=D(s,J(Hn(j[y-1][b-1]),j[y-1][w-1]));for(s=K(s,H(a,V(a,l))),y=b;y<=o;++y)j[y-1][w-1]=Qn(j[y-1][w-1],J(s,j[y-1][b-1]))}for(s=Gn(Bn(Hn(j[b-1][b-1]))),w=A;w<=u+0;++w)j[b-1][w-1]=J(s,j[b-1][w-1])}if(b===u)break;for(a=O,w=A;w<=u;++w)a=V(a,V(Zn(hr(j[b-1][w-1]),rn),Zn(mr(j[b-1][w-1]),rn)));if(T[A-1]=O,Mn(a,z)){for(a=L.sqrt(a),T[A-1]=a,s=Q(l=Jn(j[b-1][A-1]),O)?C:K(j[b-1][A-1],l),j[b-1][A-1]=J(s,V(a,l)),y=A;y<=o;++y){for(s=O,w=A;w<=u;++w)s=D(s,J(Hn(j[b-1][w-1]),j[y-1][w-1]));for(s=K(s,H(a,V(a,l))),w=A;w<=u;++w)j[y-1][w-1]=Qn(j[y-1][w-1],J(s,j[b-1][w-1]))}for(s=Gn(Bn(Hn(j[b-1][A-1]))),y=A;y<=o;++y)j[y-1][A-1]=J(j[y-1][A-1],s)}}for(h=O,b=1;b<=u;++b)P[b-1]=R[b-1],X[b-1]=T[b-1],h=jr([h,V(P[b-1],X[b-1])]);if(h=H(r,h),0<k)for(w=1;w<=k;++w)q[w-1][w-1]=C;if(0<N)for(w=1;w<=N;++w)M[w-1][w-1]=C;for(S=1;S<=u;++S){for(b=u+1-S,Z=1;Z<=50;++Z){for(E=!0,I=1;I<=b;++I){if(Rn(L.abs(X[(x=b+1-I)-1]),h)){E=!1;break}if(Rn(L.abs(P[x-1-1]),h)){E=!0;break}}if(E)for(v=O,d=C,_=x-1,y=x;y<=b&&(g=H(d,X[y-1]),X[y-1]=H(v,X[y-1]),!Rn(L.abs(g),h));++b)if(l=cr(g,p=P[y-1]),v=Xn(p,P[y-1]=l),d=Ln(Xn(g,l)),0<k)for(w=1;w<=u;++w)f=hr(q[w-1][_-1]),c=hr(q[w-1][y-1]),q[w-1][_-1]=V(H(f,v),H(c,d)),q[w-1][y-1]=G(H(c,v),H(f,d));if(l=P[b-1],x===b)break;for(f=P[x-1],c=P[b-1-1],m=X[b-1-1],p=X[b-1],m=cr(g=Xn(V(H(G(c,l),V(c,l)),H(G(m,p),V(m,p))),H(rn,H(p,c))),C),Pn(g,O)&&(m=Ln(m)),g=Xn(V(H(G(f,l),V(f,l)),H(G(Xn(c,V(g,m)),p),p)),f),d=v=C,y=_=x+1;_<=b;++_){if(m=X[y-1],c=P[y-1],p=H(d,m),m=H(v,m),l=cr(p,g),v=Xn(g,X[y-1-1]=l),d=Xn(p,l),g=V(H(f,v),H(m,d)),m=G(H(m,v),H(f,d)),p=H(c,d),c=H(c,v),0<N)for(w=1;w<=u;++w)f=hr(M[w-1][y-1-1]),l=hr(M[w-1][y-1]),M[w-1][y-1-1]=V(H(f,v),H(l,d)),M[w-1][y-1]=G(H(l,v),H(f,d));if(l=cr(p,g),v=Xn(g,P[y-1-1]=l),d=Xn(p,l),g=V(H(v,m),H(d,c)),f=G(H(v,c),H(d,m)),0<k)for(w=1;w<=u;++w)c=hr(q[w-1][y-1-1]),l=hr(q[w-1][y-1]),q[w-1][y-1-1]=V(H(c,v),H(l,d)),q[w-1][y-1]=G(H(l,v),H(c,d))}X[x-1]=O,X[b-1]=g,P[b-1]=f}if(Pn(l,O)&&(P[b-1]=Ln(l),0<N))for(w=1;w<=u;++w)M[w-1][b-1]=Gn(M[w-1][b-1])}for(b=1;b<=u;++b){for(m=-1,y=w=b;y<=u;++y)Mn(P[y-1],m)&&(m=P[y-1],w=y);if(w!==b){if(P[w-1]=P[b-1],P[b-1]=m,0<N)for(y=1;y<=u;++y)s=M[y-1][w-1],M[y-1][w-1]=M[y-1][b-1],M[y-1][b-1]=s;if(0<k)for(y=1;y<=u;++y)s=q[y-1][w-1],q[y-1][w-1]=q[y-1][b-1],q[y-1][b-1]=s}}if(0<k)for(S=1;S<=u;++S)if(!Q(R[(b=u+1-S)-1],O)){for(s=Gn(Bn(j[b-1][b-1])),w=1;w<=k;++w)q[b-1][w-1]=J(s,q[b-1][w-1]);for(w=1;w<=k;++w){for(s=O,y=b;y<=o;++y)s=D(s,J(Hn(j[y-1][b-1]),q[y-1][w-1]));for(s=K(s,J(Jn(j[b-1][b-1]),R[b-1])),y=b;y<=o;++y)q[y-1][w-1]=Qn(q[y-1][w-1],J(s,j[y-1][b-1]))}}if(0<N&&2<=u)for(S=2;S<=u;++S)if(!Q(T[(A=(b=u+1-S)+1)-1],O)){for(s=Gn(Bn(Hn(j[b-1][A-1]))),w=1;w<=N;++w)M[A-1][w-1]=J(s,M[A-1][w-1]);for(w=1;w<=N;++w){for(s=O,y=A;y<=u;++y)s=D(s,J(j[b-1][y-1],M[y-1][w-1]));for(s=K(s,J(Jn(j[b-1][A-1]),T[A-1])),y=A;y<=u;++y)M[y-1][w-1]=Qn(M[y-1][w-1],J(s,Hn(j[b-1][y-1])))}}return t&&e?[jn(q),P,jn(M)]:t||e?[jn(q||M),P]:P}E.planerot=In(function(n,r){v(r=j(r))&&2===r.length||y("planerot");var t=Vr(r[0],r[1]),t=[[t[0],t[1]],[Gn(t[1]),t[0]]];return 1<n?[t,M(t,wn(r))]:t}),E.ref=In(function(n,r,t){b(r=w(r)?[[r]]:r)||y("ref");r=Hr(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),E.rref=In(function(n,r,t){b(r=w(r)?[[r]]:r)||y("rref");r=Dr(r,!0,null,t);return 1<n?[r[0],r[1].map(function(n){return n[1]+1})]:r[0]}),E.linsolve=Jr,E.null=function(n,r){return r=r,i=U(t=n),u=(t=Dr(n,!0,null,r))[0],o=t[1],f=o.length,r=o.reduce(function(n,r){for(var t=0;t<n.length&&r[1]>n[t];)++t;return t<n.length&&r[1]===n[t]&&n.splice(t,1),n},F(i,function(n){return n})),c=f?o.reduce(function(n,r,t){return J(n,u[t][r[1]])},C):C,r.map(function(r){for(var n,t=F(i,function(n){return n===r?c:O}),e=0;e<f;++e)(n=o[e][1])<=r&&(t[n]=Qn(t[n],J(K(c,u[e][n]),u[e][r])));return t});var t,i,u,o,f,c},E.rowspace=function(n,r){return Hr(t=n,!0,null,r)[1].map(function(n){return t[n[0]]});var t},E.colspace=function(n,r){return Hr(t=n,!0,null,r)[1].map(function(r){return F(t.length,function(n){return t[n][r[1]]})});var t},E.rank=function(n){return b(n=w(n)?[[n]]:n)||y("rank"),Hr(n,!0)[1].length},E.inv=function(n){return w(n)&&(x=[[n]]),b(n)||y("inv"),Kr(n)},E.rankf=function(n){return b(n=w(n)?[[n]]:n)||y("rankf"),Yr(n)},E.pinv=function(n,r){return b(n=w(n)?[[n]]:n)||y("pinv"),nt(n,r)},E.cond=function(n,r){b(n=w(n)?[[n]]:n)||y("cond");var t=Kr(n);return t&&t.length?J(dr(n,r=null==r?2:r),dr(t,r)):l},E.trace=rt,E.det=function(n){return b(n=w(n)?[[n]]:n)||y("det"),tt(n,!1,1e-15)},E.charpoly=et,E.adjoint=function(n){return b(n)&&W(n)===U(n)||y("adjoint"),it(n)},E.ldl=function(n,r){b(n=w(n)?[[n]]:n)||y("ldl");var t,e,i,u,o,f,c=n,a=r,l=W(c);if(l===U(c)&&Wr(c,Sr(c))){for(o=vr(l,l),f=yr(l),t=0;t<l;++t){if("upper"===a){for(e=t+1;e<l;++e){for(i=t+1,u=O;i<e;++i)u=D(u,J(J(f[t][i],Hn(f[e][i])),o[i][i]));f[t][e]=K(Qn(c[t][e],u),o[e][e])}for(i=t+1,u=O;i<l;++i)u=D(u,J(J(f[t][i],Hn(f[t][i])),o[i][i]))}else{for(e=0;e<t;++e){for(i=0,u=O;i<e;++i)u=D(u,J(J(f[t][i],Hn(f[e][i])),o[i][i]));f[t][e]=K(Qn(c[t][e],u),o[e][e])}for(i=0,u=O;i<t;++i)u=D(u,J(J(f[t][i],Hn(f[t][i])),o[i][i]))}o[t][t]=Qn(c[t][t],u),Wn(o[t][t],O)&&y("ldl")}return[f,o]}y("ldl")},E.lu=function(n){w(n)&&(x=[[n]]),b(n)||y("lu");var r,t,e,i,u,o,f,c,a,l,s,h,m,g,p,d=!0,v=void 0;for(v=B(v||0),r=W(n),t=U(n),p=!1,u=Sn(n),i=yr(r),o=F(r,O),e=yr(r),f=1,c=0;c<r-1;++c){if(Wn(Jn(u[c][c]),v)){for(s=c+1,h=!0;s<r&&h;)Wn(Jn(u[s][c]),v)?++s:h=!1;if(r<=s){p=!0;break}$r(u,c,s),$r(e,c,s)}for(m=u[c][c],i[c][c]=m,o[c]=J(f,m),a=c+1;a<r;++a){for(g=u[a][c],i[a][c]=g,l=c+1;l<t;++l)u[a][l]=K(Qn(J(m,u[a][l]),J(u[c][l],g)),f);u[a][c]=O}f=u[c][c]}if(p)throw"lu: defficient matrix";return o[r-1]=f,d?[M(i,Ar(o.map(Dn))),u,e]:[o,i,u,e]},E.qr=In(function(n,r){return b(r=w(r)?[[r]]:r)||y("qr"),ut(r,1<n)}),E.balance=In(function(n,r,t){b(r=w(r)?[[r]]:r)&&W(r)===U(r)||y("balance");var e=ot(r,2,1<n);return 2<n?[e[0],F(W(r),function(n){return n+1}),e[1]]:1<n?[Ar(e[0]),e[1]]:e}),E.hess=In(function(n,r,t){return b(r=w(r)?[[r]]:r)&&W(r)===U(r)||y("hess"),2<arguments.legnth?(b(t=w(t)?[[t]]:t)&&W(t)===U(t)||y("hess"),ft(r,t)):ft(r,null,1<n)}),E.eig=In(function(n,r,t){b(r)&&W(r)===U(r)||y("eig"),b(t)&&y("eig");var e=null;return"nobalance"!==t&&(e=ot(r,2,!0),r=e[1],e=e[0]),1<n?(t=ct(r),[e?M(Ar(e),t[0]):t[0],Ar(t[1]),e?M(Ar(e.map(On)),t[2]):t[2]]):jn((Qr(r,"upper",!0,1e-15)||Qr(r,"lower",!0,1e-15)?F(W(r),function(n){return r[n][n]}):Rt(et(r))).sort(function(n,r){return Jn(r)-Jn(n)}))}),E.svd=In(function(n,r,t){return b(r=w(r)?[[r]]:r)||y("svd"),1<n?[(n=at(r,t,1<n,2<n))[0],Ar(n[1]),n[2]]:at(r,t,!1,!1)});var lt=.254829592,st=-.284496736,ht=1.421413741,mt=-1.453152027,gt=1.061405429,pt=.3275911;function dt(n){n=hr(n);var r,t=L.sign(n)||1;return t<0&&(n=Ln(n)),r=On(V(H(pt,n),C)),H(t,G(C,H(V(H(V(H(V(H(V(H(gt,r),mt),r),ht),r),st),r),lt),H(r,L.exp(Ln(H(n,n)))))))}function vt(r,n){if(w(r))return r;if(v(r))return r.length?K(qr(r),B(r.length)):s;if(b(r)){if(1===(n=d(n=null==n?1:n)))return F(U(r),function(n){return vt(q(r,n))});if(2===n)return F(W(r),function(n){return vt(r[n])})}y("mean")}function yt(r,n,t){if(n=d(n||0),w(r))return O;if(v(r))return 0===r.length?s:1===r.length?O:L.sqrt(K(qr(er(pr(nr(r,vt(r))),B(2))),B(1===n?r.length:r.length-1)));if(b(r)){if(1===(t=d(t=null==t?1:t)))return F(U(r),function(n){return yt(q(r,n))});if(2===t)return F(W(r),function(n){return yt(r[n])})}y("std")}function wt(n,r){var t,e,i,u,o,f=n.length,c=r.length,a=f+c-1;if(!f||!c)return[];for(o=new Array(a),f<c&&(u=n,f=(n=r).length,c=(r=u).length),t=0;t<a;++t)for(o[t]=O,e=0;e<c;++e)0<=(i=t-e)&&i<f&&(o[t]=D(o[t],J(n[i],r[e])));return o}function bt(n,r,t){var e,i=[],u=n.slice(),o=u.length-r.length,f=r;if(0<=o)for(i=F(o+1,O);0<=o;){for(e=o,r=f.concat(F(o,O)),i[i.length-1-o]=K(u[0],r[0]),u=jt(u,qt(r,[Gn(i[i.length-1-o])]));u.length&&P(u[0],O);)u.shift();if((o=u.length-f.length)===e)break}return[i,t?F(n.length-u.length,O).concat(u):u]}en.push(function(){lt=B(.254829592),st=B(-.284496736),ht=B(1.421413741),mt=B(-1.453152027),gt=B(1.061405429),pt=B(.3275911)}),E.erf=function(n){return An(dt,n,!0)},E.mean=vt,E.median=function r(t,n){if(w(t))return t;if(v(t))return t.length?1&(t=kr(t)).length?t[t.length>>1]:K(D(t[t.length>>1],t[(t.length>>1)-1]),B(2)):s;if(b(t)){if(1===(n=d(n=null==n?1:n)))return F(U(t),function(n){return r(q(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}y("median")},E.mode=function r(t,n){if(w(t))return t;var e,i;if(v(t))return t.length?(e={},i=0,t.reduce(function(n,r){var t=r.toString(),t=un.call(e,t)?(e[t]+=1,e[t]):e[t]=1;return i<t?(i=t,n=r):t===i&&$n(r,n)&&(n=r),n},{})):s;if(b(t)){if(1===(n=d(n=null==n?1:n)))return F(U(t),function(n){return r(q(t,n))});if(2===n)return F(W(t),function(n){return r(t[n])})}y("mode")},E.moment=function r(t,e,n){if(w(t))return O;var i;if(v(t))return t.length<=1?t.length?O:s:(i=t.length,K(qr(er(nr(t,vt(t)),e)),B(i)));if(b(t)){if(1===(n=d(n=null==n?1:n)))return e=B(e),F(U(t),function(n){return r(q(t,n),e)});if(2===n)return e=B(e),F(W(t),function(n){return r(t[n],e)})}y("moment")},E.std=yt,E.var=function r(t,e,n){if(e=d(e||0),w(t))return O;var i,u;if(v(t))return t.length<=1?t.length?O:s:(i=t.length,u=vt(t),K(qr(rr(gr(u=nr(t,u)),u)),B(1===e?i:i-1)));if(b(t)){if(1===(n=d(n=null==n?1:n)))return F(U(t),function(n){return r(q(t,n),e)});if(2===n)return F(W(t),function(n){return r(t[n],e)})}y("var")},E.cov=function e(i,n,u){if(u=d(u||0),2!==arguments.length||0!==d(n)&&1!==d(n)||(u=d(n),n=null),null==n){if(w(i))return O;var r;if(v(i))return i.length<=1?i.length?O:s:(t=i.length,r=vt(i),K(qr(rr(gr(r=nr(i,r)),r)),B(1===u?t:t-1)));if(b(i))return N(U(i),U(i),function(n,r,t){return n===r?e(q(i,n),u):r<n?t[r][n]:e(q(i,n),q(i,r),u)})}else{if(w(i)&&w(n))return vr(2,2);if(b(i)&&b(n)&&(i=wr(i),n=wr(n)),v(i)&&v(n)){if(i.length!==n.length)throw"cov: inputs not of same dimension";var t;return i.length<=1?i.length?O:s:(t=i.length,K(qr(rr(gr(nr(i,vt(i))),nr(n,vt(n)))),B(1===u?t:t-1)))}}y("cov")},E.corrcoef=function e(i,r){if(null==r){if(w(i)||v(i))return C;if(b(i))return N(U(i),U(i),function(n,r,t){return n===r?C:r<n?t[r][n]:e(q(i,n),q(i,r))})}else{if(w(i)&&w(r))return C;if(v(i)&&v(r)){if(i.length!==r.length)throw"corrcoef: inputs not of same dimension";var n=i.length;return 1<n?K(qr(rr(tr(nr(i,vt(i)),yt(i)),tr(nr(r,vt(r)),yt(r)))),B(n-1)):C}if(b(i)&&b(r)){if(W(i)!==W(r)||U(i)!==U(r))throw"corrcoef: inputs not of same dimension";return F(U(i),function(n){return e(q(i,n),q(r,n))})}}y("corrcoef")},E.conv=function(n,r){return(w(n)||w(r)?rr:(n=j(n),r=j(r),v(n)&&v(r)||y("conv"),wt))(n,r)},E.deconv=In(function(n,r,t){var e;if(w(r)||w(t))e=1<n?[tr(r,t),O]:tr(r,t);else{if(r=j(r),t=j(t),v(r)&&v(t)||y("deconv"),!t.length||1===t.length&&P(t[0],O))throw"deconv: divisor is zero";e=bt(r,t,!0)}return 1<n?e:e[0]}),E.conv2=function(r,t){if(w(r)||w(t))return rr(r,t);if(v(r)){if(v(t))return wt(r,t);if(b(t))return F(U(t),function(n){return wt(r,q(t,n))})}else{if(v(t)){if(v(r))return wt(r,t);if(b(r))return F(r[0].length,function(n){return wt(q(r,n),t)});throw"conv2: input 1 not supported"}if(!b(r))throw"conv2: input 1 not supported";if(b(t)){var n,e,i,u,o,f,c,a,l,s,h,m,g,p=r,d=t;for(W(p)<W(d)&&(g=p,p=d,d=g),n=W(p),e=U(p),o=vr(f=n+(i=W(d))-1,c=e+(u=U(d))-1),l=0;l<f;++l)for(s=0;s<c;++s){for(a=O,h=0;h<=l&&!(n<=h);++h)if(!(i<=l-h))for(m=0;m<=s&&!(e<=m);++m)u<=s-m||(a=D(a,J(p[h][m],d[l-h][s-m])));o[l][s]=a}return o}}throw"conv2: input 2 not supported"},E.filter=function(n,r,t,e,i){n=j(n),r=j(r),t=j(t),v(n)&&v(r)&&v(t)||y("filter");var u,o,f,c,a=n,l=r,s=t,h=s.length,m=l.length,g=a.length,p=new Array(h),d=l[0];for(l=l.map(function(n){return K(n,d)}),a=a.map(function(n){return K(n,d)}),u=0;u<h;++u){for(c=O,f=u,o=0;0<=f&&o<g;++o,--f)c=D(c,J(a[o],s[f]));for(f=u-1,o=1;0<=f&&o<m;++o,--f)c=Qn(c,J(l[o],p[f]));p[u]=c}return p};var xt={},St={};function At(n,r){for(var t,e,i=n.length,u={},o=0;o<i;++o)1!==u[o]&&(e=n[t=function(n,r){for(var t=0;1<r;)t=(t<<1)+(1&n),n>>=1,r>>=1;return t}(o,i)],r[t]=n[o],r[o]=e,u[t]=1)}function _t(n,r,t){var e,i,u=n.length;if(1===u)t[0]=n[0];else{for(e=0;e<u;++e)t[e]=new I(O,O);for(var o,f,c,a,l,s,h=function(n){for(var r=S.sqrt(n),t=3;t<=r;){if(0==n%t)return t;t+=2}return n}(u),m=u/h,g=B(1/S.sqrt(h)),p=new Array(m),d=new Array(m),v=0;v<h;++v){for(e=0;e<m;++e)p[e]=n[e*h+v];for(1<m&&(kt(p,r,d),i=p,p=d,d=i),o=B(S.cos(2*T*v/u)),f=B((r?-1:1)*S.sin(2*T*v/u)),c=C,a=O,e=0;e<u;++e)l=H(g,p[e%m].re),s=H(g,p[e%m].im),t[e]=t[e].add(new I(G(H(l,c),H(s,a)),V(H(s,c),H(l,a)))),l=G(H(c,o),H(a,f)),s=V(H(c,f),H(a,o)),c=l,a=s}}}var It=S.SQRT1_2;function Et(n,r,t){var e,i,u,o,f,c,a,l,s,h,m,g,p,d,v,y,w,b=n.length,x=1;for(At(n,t);x<b;){for(e=B((w=void 0,null==(w=St[y=x])&&(St[y]=w=S.cos(T/y)),w)),i=B((r?-1:1)*(y=void 0,null==(y=xt[w=x])&&(xt[w]=y=S.sin(T/w)),y)),o=b/(2*x),u=0;u<o;++u)for(l=C,s=O,f=0;f<x;++f)g=t[h=2*u*x+f].re,p=t[h].im,c=t[m=h+x].re,a=t[m].im,d=G(H(l,c),H(s,a)),v=V(H(s,c),H(l,a)),t[h]=new I(H(V(g,d),It),H(V(p,v),It)),t[m]=new I(H(G(g,d),It),H(G(p,v),It)),c=G(H(l,e),H(s,i)),a=V(H(l,i),H(s,e)),l=c,s=a;x<<=1}}function kt(n,r,t){var e,i=n.length;if(!(i<=0))return e=!1,null==t&&(t=new Array(i),e=!0),(i&i-1?_t:Et)(n,r,t),e?t:void 0}function Nt(n,r,t){var e=n.length,i=n[0].length;if(!(e<=0||i<=0)){var u,o,f=!1,c=new Array(e),a=new Array(i),l=new Array(e),s=new Array(i);if(null==t){for(t=new Array(e),u=0;u<e;++u)t[u]=new Array(i);f=!0}for(o=0;o<i;++o,0){for(u=0;u<e;++u)c[u]=n[u][o];for(kt(c,r,l),u=0;u<e;++u)t[u][o]=l[u]}for(u=0;u<e;++u){for(o=0;o<i;++o,0)a[o]=t[u][o];for(kt(a,r,s),o=0;o<i;++o,0)t[u][o]=s[o]}return f?t:void 0}}function jt(n,r){for(var t=n.length-1,e=r.length-1,i=[];0<=t&&0<=e;)i.unshift(D(n[t--],r[e--]));for(;0<=t;)i.unshift(n[t--]);for(;0<=e;)i.unshift(r[e--]);return i}en.push(function(){It=B(S.SQRT1_2)}),E.fft=function(r){return b(r=j(r))?F(U(r),function(n){return jn(kt(qn(q(r,n)),!1))}):v(r)?jn(kt(qn(r),!1)):void y("fft")},E.ifft=function(r){return b(r=j(r))?F(U(r),function(n){return jn(kt(qn(q(r,n)),!0))}):v(r)?jn(kt(qn(r),!0)):void y("ifft")},E.fft2=function(n){return b(n)||y("fft2"),jn(Nt(qn(n),!1))},E.ifft2=function(n){return b(n)||y("ifft2"),jn(Nt(qn(n),!0))};var qt=wt,Pt=bt;function Mt(n,r){if(!n.length)return O;r=r||O;for(var t=n.length,e=0,i=n[0];e+1<t;)++e,i=D(J(i,r),n[e]);return i}function Rt(r){if(r.length<=1)return[];var n,t,e,i,u,o,f,c,a,l,s,h,m,g=r.length-1,p=B(1e-10),d=new I(p,O),v=new I(O,O),y=new I(C,O);for(r=r.map(B),l=function(n){return Mt(r,n)},s=function(n){return K(Qn(l(D(n,d)),l(n)),d)},n=r.map(function(n){return I(n).abs()}),o=n.length-1;0<o&&Q(n[o],O);)--o;for(e=V(Xn(jr(n.slice(0,o))||O,jr([n[o],C])),C),t=Xn(n[0],jr(V(n[0],jr(n.slice(1))))),i=F(g,function(){return new I(V(t,H(G(e,t),S.random())),B(S.random()*T/2),"polar")}),a=1;a<=1e4;++a){for(o=u=0;o<g;++o){if(f=i[o],h=l(f),Q((m=s(f)).re,O)&&Q(m.im,O)){if(Rn(L.abs(h.re),p)&&Rn(L.abs(h.im),p)){++u;continue}c=new I(e,O)}else c=h.div(m);h=c.div(y.sub(c.mul(i.reduce(function(n,r,t){return n=t===o||Q(f.re,r.re)&&Q(f.im,r.im)?n:n.add(f.sub(r).inv())},v)))),Rn(L.abs(h.re),p)&&Rn(L.abs(h.im),p)&&++u,i[o]=f.sub(h)}if(u===g)break}return i}function Tt(n,r){for(var t,e,i,u=O,o=S.min(n.length,r.length)-1,f=0;f<o;++f)t=n[f],i=n[f+1],e=r[f],u=V(u,Xn(G(H(t,r[f+1]),H(e,i)),rn));return 1<o&&(t=n[o],i=n[0],e=r[o],u=V(u,Xn(G(H(t,r[0]),H(e,i)),rn))),u}function Xt(u,o){var f,n,r,t,e,i,c,a,l,s,h=u.length,m=F(h,function(n){return n});if(h<3)return m;for(f=0,n=1;n<h;++n)(Pn(o[n],o[f])||Q(o[n],o[f])&&Pn(u[n],u[f]))&&(f=n);for(m.splice(f,1),--h,m=m.map(function(n){return[(r=u[f],t=o[f],e=u[n],i=o[n],$n(i=L.atan2(G(i,t),G(e,r)),O)?V(i,2*T):i),n];var r,t,e,i}).sort(function(n,r){return Pn(n[0],r[0])?-1:Mn(n[0],r[0])?1:0}).map(function(n){return n[1]}),(r=new Array(h+1))[0]=f,r[1]=m[0],r[2]=m[1],t=3,n=2;n<h;++n){for(;1<t&&Rn(O,(e=u[m[n]],i=o[m[n]],c=u[r[t-1]],a=o[r[t-1]],l=u[r[t-2]],s=o[r[t-2]],e=G(e,l),c=G(c,l),l=G(i,s),i=G(a,s),G(H(e,i),H(l,c))));)--t;r[t++]=m[n]}return r.length=t,r}function Zt(){var n,r,t,e,i=arguments,u=i.length;if(0===u)return O;for(e=0;e<u&&Q(O,n=i[e++]););for(n=L.abs(n);e<u;){if(Q(n,C))return C;for(;e<u&&Q(O,r=i[e++]););if(Q(r=L.abs(r),C))return C;if(!Q(r,n)){if(Q(r,O))break;for(Pn(n,r)&&(t=r,r=n,n=t);!Q(O,r);)r=zn(n,t=r),n=t}}return n}function zt(t,e,i){if(i){var u,o;if(A(t)){if(u=new Array(t.length),A(e))return t.length!==e.length&&y("gcd"),o=new Array(e.length),[t.map(function(n,r){n=zt(n,e[r],i);return u[r]=n[1],o[r]=n[2],n[0]}),u,o];if(p(e))return o=new Array(t.length),[t.map(function(n,r){n=zt(n,e,i);return u[r]=n[1],o[r]=n[2],n[0]}),u,o]}if(p(t)){if(A(e))return u=new Array(e.length),o=new Array(e.length),[e.map(function(n,r){n=zt(t,n,i);return u[r]=n[1],o[r]=n[2],n[0]}),u,o];if(p(e))return function n(r){var t,e,i,u,o=r.length,f=C,c=O,a=O,l=C,s=C,h=C;if(0!==o){if(t=r[0],Mn(O,t)&&(t=L.abs(t),s=z),1===o)return[t,s];if(u=2===o?[r[1],C]:n(r.slice(1)),e=u[0],Mn(O,e)&&(e=L.abs(e),h=z),Q(O,t))return F(u.length+1,function(n){return 0===n?e:1===n?s:H(h,u[n-1])});if(Q(O,e))return F(u.length+1,function(n){return 0===n?t:1===n?s:H(h,u[n-1])});for(;;){if(i=L.floor(Xn(t,e)),t=zn(t,e),f=G(f,H(i,a)),c=G(c,H(i,l)),Q(O,t))return a=H(a,s),l=H(l,h),F(u.length+1,function(n){return 0===n?e:1===n?a:H(l,u[n-1])});if(i=L.floor(Xn(e,t)),e=zn(e,t),a=G(a,H(i,f)),l=G(l,H(i,c)),Q(O,e))return f=H(f,s),c=H(c,h),F(u.length+1,function(n){return 0===n?t:1===n?f:H(c,u[n-1])})}}}([t,e])}}else{if(A(t)){if(A(e))return t.length!==e.length&&y("gcd"),t.map(function(n,r){return zt(n,e[r])});if(p(e))return t.map(function(n){return zt(n,e)})}if(p(t)){if(A(e))return e.map(function(n,r){return zt(t,n)});if(p(e))return Zt(t,e)}}y("gcd")}function Lt(n,r){var t=L.abs(n);return Q(t,L.abs(r))?Q(n_sign(n),n_sign(r))?t:Ln(t):H(Xn(n,Zt(n,r)),r)}E.polydiv=In(function(n,r,t){var e;if(w(r)||w(t))e=1<n?[tr(r,t),O]:tr(r,t);else{if(r=j(r),t=j(t),v(r)&&v(t)||y("polydiv"),!t.length||1===t.length&&P(t[0],O))throw"polydiv: divisor is zero";e=Pt(r,t,!1)}return 1<n?e:e[0]}),E.polyval=function(r,n){return v(r=j(r))||y("polyval"),w(n)?jn(Mt(r,n)):v(n)?n.map(function(n){return jn(Mt(r,n))}):void y("polyval")},E.polyvalm=function(r,n){return v(r=j(r))||y("polyvalm"),b(n)&&W(n)===U(n)?jn(function(n,r){if(!n.length)return vr(W(r),U(r));for(var t=n.length,e=0,i=W(r),u=yr(i,n[0]);e+1<t;)++e,u=Yn(M(u,r),yr(i,n[e]));return u}(r,n)):w(n)?jn(Mt(r,n)):v(n)?n.map(function(n){return jn(Mt(r,n))}):void y("polyvalm")},E.polyfit=function(n,r,i){if(n=j(n),r=j(r),v(n)&&v(r)||y("polyfit"),n.length!==r.length)throw"polyfit: input 1 and 2 must have same length";if(3!==arguments.length)return jn(function(e,i){var n,u,o,r,t,f,c,a;if(!(v(e)&&e.length&&v(i)&&i.length))return[];for(e=e.slice(),i=i.slice(),o=S.min(e.length,i.length),e.length=o,i.length=o,c={},a=[],u=0;u<o;++u)if(f=String(e[u]),un.call(c,f)){if(!P(i[c[f]],i[u]))return[];a.push(u)}else c[f]=u;for(;a.length;)u=a.pop(),e.splice(u,1),i.splice(u,1);for(a=c=null,r=F(o=e.length,function(n){for(var r=C,t=0;t<o;++t)t!==n&&(r=J(r,Qn(e[n],e[t])));return r=K(i[n],r)}),t=F(o,function(n){return[C,Gn(e[n])]}),n=[],u=0;u<o;++u)n=jt(n,t.reduce(function(n,r,t){return n=t!==u?qt(n,r):n},[r[u]]));return n}(n,r));if(!p(i)||d(i)<0)throw"polyfit: input 3 not positive int";return i=d(i),jn(M(nt(n.reduce(function(n,r){for(var t=1,e=[C];t<=i;++t)e.unshift(J(r,e[0]));return n.push(e),n},[])),r))},E.roots=function(n){return v(n=j(n))||y("roots"),jn(Rt(n).sort(function(n,r){return Pn(hr(n),hr(r))?-1:Mn(hr(n),hr(r))?1:0}))},E.poly=function(n){return v(n=j(n))||y("poly"),jn(n.reduce(function(n,r){return qt(n,[C,Gn(r)])},[C]))},E.cart2pol=In(function(n,r,t,e){return[E.atan2(t,r),E.sqrt(Yn(er(r,rn),er(t,rn))),e]},3),E.pol2cart=In(function(n,r,t,e){return[rr(t,E.cos(r)),rr(t,E.sin(r)),e]},3),E.cart2sph=In(function(n,r,t,e){var i=Yn(er(r,rn),er(t,rn));return[E.atan2(t,r),E.atan2(e,E.sqrt(i)),E.sqrt(Yn(i,er(e,rn)))]},3),E.sph2cart=In(function(n,r,t,e){return[rr(e,rr(E.cos(t),E.cos(r))),rr(e,rr(E.cos(t),E.sin(r))),rr(e,E.sin(t))]},3),E.polyarea=function(r,t){return r=j(r),t=j(t),b(r)&&b(t)?(W(r)===W(t)&&U(r)===U(t)||y("polyarea"),F(U(r),function(n){return Tt(q(r,n),q(t,n))})):v(r)&&v(t)?(r.length!==t.length&&y("polyarea"),Tt(r,t)):void y("polyarea")},E.convhull=In(function(n,r,t,e){3<arguments.length&&y("convhull"),b(r)&&2===U(r)?(t=q(r,1),r=q(r,0)):(r=j(r),t=j(t)),v(r)&&v(t)&&r.length===t.length||y("convhull");var i=Xt(r,t);return 1<n?[i.map(function(n){return n+1}),Tt(i.map(function(n){return r[n]}),i.map(function(n){return t[n]}))]:i.map(function(n){return n+1})}),E.mod=function(n,t){return P(t=bn(t||0),0)?n:An(function(n){var r;return $(n)?Pn(r=zn(n,t),0)&&Mn(t,0)?V(r,t):r:n},n,!0)},E.gcd=In(function(n,r,t){return zt(r,t,1<n)}),E.lcm=function t(e,i){if(A(e)){if(A(i))return e.map(function(n,r){return t(n,i[r])});if(p(i))return e.map(function(n){return t(n,i)})}if(p(e)){if(A(i))return i.map(function(n,r){return t(e,n)});if(p(i))return function(){var n,r,t=arguments,e=t.length;if(e<=1)return 1===e?t[0]:O;if(Q(O,t[0])||Q(O,t[1]))return O;for(r=Lt(t[0],t[1]),n=2;n<e;++n){if(Q(O,t[n]))return O;r=Lt(r,t[n])}return r}(e,i)}return e};var Ot=[B(2),B(3),B(5),B(7),B(11),B(13),B(17),B(19),B(23),B(29),B(31),B(37),B(41),B(43),B(47),B(53),B(59),B(61),B(67),B(71),B(73),B(79),B(83),B(89),B(97),B(101),B(103),B(107),B(109)];function Ct(n){if(k(n))return 0<n.length;if(hn(n))return!1;if(u(n))return 0!==n;if(gn(n))return!n.eq(O);if(o(n))return!Q(n.re,O)||!Q(n.im,O);if(A(n)){if(!n.length)return!1;for(var r=0,t=n.length;r<t;++r)if(!Ct(n[r]))return!1;return!0}return!0===n}en.push(function(){Ot=[B(2),B(3),B(5),B(7),B(11),B(13),B(17),B(19),B(23),B(29),B(31),B(37),B(41),B(43),B(47),B(53),B(59),B(61),B(67),B(71),B(73),B(79),B(83),B(89),B(97),B(101),B(103),B(107),B(109)]}),E.factor=function(n){for(var r,t,e=L.floor(L.abs(hr(bn(n)))),i=B(1e30),u=[],o=e,f=0,c=Ot.length;f<c;++f){if(Q(o,r=Ot[f]))return[r];if(Mn(t=H(r,r),e)||null!=i&&Mn(t,i))break;for(;Q(O,zn(e,r));)u.push(r),e=Xn(e,r)}if(c<=f)for(t=H(r=V(r,rn),r);Rn(t,e)&&(null==i||Rn(t,i));){for(;Q(O,zn(e,r));)u.push(r),e=Xn(e,r);t=H(r=V(r,rn),r)}return Mn(e,C)&&u.push(e),u},E.string=function n(r){return A(r)?r.map(n):k(r)?r:String(r)},E.strlength=function(n){if(k(n))return n.length;y("strlength")},E.char=function n(r){return r=j(r),A(r)?r.map(n):k(r)?r.split(""):p(r)?String.fromCharCode(d(r)):String(r)},E.lower=E.tolower=function n(r){return A(r)?r.map(n):k(r)?r.toLowerCase():r},E.upper=E.toupper=function n(r){return A(r)?r.map(n):k(r)?r.toUpperCase():r},E.dec2bin=function n(r){return A(r)?r.map(n):u(r)?r.toString(2):gn(r)?r.toBinary():r},E.bin2dec=function n(r){return A(r)?r.map(n):k(r)?parseInt(r,2):r},E.dec2hex=function n(r){return A(r)?r.map(n):u(r)?r.toString(16):gn(r)?r.toHexadecimal():r},E.hex2dec=function n(r){return A(r)?r.map(n):k(r)?parseInt(r,16):r};var $t={"[]":{name:"literal_array",arity:1,fixity:-1,associativity:-1,commutativity:0,priority:0,fn:function(){var r=[],t=[];return[].forEach.call(arguments,function(n){","!==n&&(";"===n?t.length&&(A(t[0])?r=r.length?br("vert",r,t):t:r.push(t),t=[]):!an(n,Qt)&&A(n)?t=t.length?br("horz",t,n):n:t.push(n))}),t.length&&(A(t[0])?r=r.length?br("vert",r,t):t:r.length?r.push(t):r=t),r}},"(:)":{name:"colon",arity:1,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n){return wr(n)}},":":{name:"colon1",arity:2,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r){return wr(n,r)}},"::":{name:"colon2",arity:3,fixity:1,associativity:-1,commutativity:0,priority:30,fn:function(n,r,t){return wr(n,r,t)}},"'":{name:"ctranspose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:Sr},".'":{name:"transpose",arity:1,fixity:1,associativity:-1,commutativity:0,priority:10,fn:xr},"^":{name:"pow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:ir},".^":{name:"dotpow",arity:2,fixity:0,associativity:-1,commutativity:0,priority:15,fn:er},"\\":{name:"mldivide",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:function(n,r){return Jr(n,r)}},"/":{name:"div",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:tr},"./":{name:"dotdiv",arity:2,fixity:0,associativity:-1,commutativity:0,priority:20,fn:tr},"*":{name:"mul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:M},".*":{name:"dotmul",arity:2,fixity:0,associativity:-1,commutativity:1,priority:20,fn:rr},"+":{name:"add",arity:2,fixity:0,associativity:-1,commutativity:1,priority:25,fn:Yn},"-":{name:"sub",arity:2,arityalt:1,fixity:0,associativity:-1,commutativity:-1,priority:25,fn:function(n,r){return 1===arguments.length?ur(n):nr(n,r)}},">=":{name:"ge",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Un},"<=":{name:"le",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Wn},">":{name:"gt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:Fn},"<":{name:"lt",arity:2,fixity:0,associativity:-1,commutativity:0,priority:35,fn:$n},"~=":{name:"ne",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:Cn},"==":{name:"eq",arity:2,fixity:0,associativity:-1,commutativity:1,priority:40,fn:P},"&&":{name:"and",arity:2,fixity:0,associativity:-1,commutativity:1,priority:32,fn:function(n,r){return Ct(n)&&Ct(r)?1:0}},"||":{name:"or",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){return Ct(n)||Ct(r)?1:0}},xor:{name:"xor",arity:2,fixity:0,associativity:-1,commutativity:1,priority:33,fn:function(n,r){n=Ct(n),r=Ct(r);return n&&!r||r&&!n?1:0}},"~":{name:"not",arity:1,fixity:-1,associativity:-1,commutativity:-1,priority:31,fn:function(n){return Ct(n)?0:1}},"=":{name:"set",breakpoint:"set",arity:2,fixity:0,associativity:-1,commutativity:0,priority:45,fn:async function(n,r){var t,e;return A(n)&&an(n[0],Qt)?(e=n,A(t=r)?await Promise.all(e.map(function(n,r){return Ft(n,r<t.length?t[r]:null)})):await Promise.all(e.map(function(n,r){return Ft(n,0===r?t:null)}))):Ft(n,r.$scilitevarargout$?r[0]:r)}}};async function Ft(n,r){if(an(n,Qt)&&k(n.v))return await n.set(r),n.get(!0);throw"setting non-variable"}async function Wt(n,r,t){var e,i,u,o,f,c,a=null;if(Ct(await Gt(n.if.cond,r,t))){for(e=0,o=(f=n.if.statements).length;e<o;++e)null!=(c=await Gt(f[e],r,t))&&(a=c);return a}if(n.elseif.length)for(i=0,u=n.elseif.length;i<u;++i)if(Ct(await Gt(n.elseif[i].cond,r,t))){for(e=0,o=(f=n.elseif[i].statements).length;e<o;++e)null!=(c=await Gt(f[e],r,t))&&(a=c);return a}if(n.else.statements.length){for(e=0,o=(f=n.else.statements).length;e<o;++e)null!=(c=await Gt(f[e],r,t))&&(a=c);return a}}async function Ut(n,r,t){var e,i,u,o,f,c,a,l=null,s=!1,h=!1,m=await Gt(n.val,r,t),g=n.statements;if(A(m)){for(c=(t=t||{}).brk,a=t.cont,t.brk=function(){s=!0},t.cont=function(){h=!0},u=0,o=m.length;u<o;++u){for(h=s=!1,await n.ind.set(m[u]),e=0,i=g.length;e<i&&(f=await Gt(g[e],r,t),!s&&!h);++e)null!=f&&(l=f);if(s)break}t.brk=c,t.cont=a}return l}async function Bt(n,r,t){var e,i,u,o=null,f=!1,c=!1,a=n.statements,l=(t=t||{}).brk,s=t.cont;for(t.brk=function(){f=!0},t.cont=function(){c=!0};Ct(await Gt(n.cond,r,t));){for(c=f=!1,e=0,i=a.length;e<i&&(u=await Gt(a[e],r,t),!f&&!c);++e)null!=u&&(o=u);if(f)break}return t.brk=l,t.cont=s,o}function Qt(n,r,t){if(!an(this,Qt))return new Qt(n,r,t);this.ctx=n,this.v=r,this.i=t}async function Vt(n){return an(n,Qt)?await n.get():n}function R(n,r){if(!an(this,R))return new R(n,r);null==r&&(r=n,n=""),this.op=n,this.arg=r}async function Gt(n,r,t){if(an(n,R))return Dt(n,r,t);if(A(n)){for(var e=0,i=n.length,u=new Array(i);e<i;++e)u[e]=await Gt(n[e],r,t);return u}return n}function Ht(v,y,w,i){var b,x=0,S=0,u=v;function A(n,r,t){null==t&&(t=S),null==r&&(r=x);var e=u.split("\n")[t];return(n=String(n)+" at line "+String((w||0)+t)+" position "+String((i||0)+r)+":")+"\n"+e+"\n"+new Array(r+1).join(" ")+"^\n"}return function i(n){var r,t,e,u,o,f,c,a=[],l=[],s=[];function h(n){var r,t,e,i,u,o,f,c;if(l.length)if(n)for(;0<l.length;){if(u=(i=l.shift())[0],n===(o=$t[u]).breakpoint){l.unshift(i);break}if(o.arity>a.length){if(!(null!=o.arityalt&&o.arityalt<=a.length))throw A('invalid or missing argument for "'+u+'"',i[1],i[2]);c=a.splice(0,o.arityalt).reverse()}else c=a.splice(0,o.arity).reverse();f=R(o.fn,c),a.unshift(f)}else if(t=(r=l.shift())[0],1===(e=$t[t]).fixity){if(e.arity>a.length)throw A('invalid or missing argument for "'+t+'"',r[1],r[2]);c=a.splice(0,e.arity).reverse(),f=R(e.fn,c),a.unshift(f)}else{if(-1!==e.fixity)for(;0<l.length&&(u=(i=l[0])[0],(o=$t[u]).priority<e.priority||o.priority===e.priority&&(o.associativity<e.associativity||o.associativity===e.associativity&&-1===o.associativity));){if(o.arity>a.length){if(!(null!=o.arityalt&&o.arityalt<=a.length))throw A('invalid or missing argument for "'+u+'"',i[1],i[2]);c=a.splice(0,o.arityalt).reverse()}else c=a.splice(0,o.arity).reverse();f=R(o.fn,c),a.unshift(f),l.shift()}l.unshift(r)}}function m(n){if(h(!0),1<a.length||0<l.length)throw A("mismatched terms and operators",l.length?l[0][1]:x,l.length?l[0][2]:S);!0===n&&(an(a[0],R)&&s.push(a[0]),a=[],l=[])}function g(n,r){var t,e=n.test?v.match(n):n===v.slice(0,n.length);return!!e&&(!1===r?n.test?e:[n,n]:n.test?(t=e[r||0].length,v=v.slice(t),x+=t,e):(t=n.length,v=v.slice(t),x+=t,[n,n]))}function p(n,r,t){for(var e,i=t||0,u="";i<v.length;)if(n===(e=v.charAt(i))){if(!(i+1<v.length&&n===v.charAt(i+1)))break;u+=e,i+=2}else u+=e,i+=1;return r&&(v=v.slice(i+1),x+=i+1),[u,i+1]}function d(){var n,r,t,e=function(n,r,t){for(var e,i=0,u=0;i<v.length;)if(e=v.charAt(i),!t||'"'!==e&&"'"!==e){if(r===e)++u;else if(n===e){if(0===u)break;--u}++i}else i=p(e,!1,i+1)[1];return u||i>=v.length?-1:i}("]","[",!0);if(-1===e)throw A("mismatched brackets");if(n=v.slice(0,e),/[\[\]]/.test(n)){for(r=[];t=i(",;]");)if(r.push(t),g(","))r.push(R(","));else{if(!g(";"))break;r.push(R(";"))}g(/^\s+/),g("]")}else r=/[,;\n]/.test(n)?n.trim().split(/[;\n]/g).reduce(function(n,r){var t=n.length,e=0;return r.trim().split(-1<r.indexOf(",")?",":/\s+/g).reduce(function(n,r){return(r=Ht(r.trim(),y,S+w,x))&&(e?n.push(R(",")):t&&n.push(R(";")),n.push(r),e=1),n},n)},[]):n.trim().split(/\s+/g).reduce(function(n,r){return(r=Ht(r.trim(),y,S+w,x))&&(n.length&&n.push(R(",")),n.push(r)),n},[]),v=v.slice(e+1),x+=e+1,1<(n=n.split("\n")).length&&(S+=n.length-1,n.slice(0,-1).forEach(function(n){x-=n.length+1}));return R($t["[]"].fn,r)}for(;0<v.length;)if(g(/^if\b/)){if(m(!0),!(c=i("\n,")))throw A('missing or invalid condition in "if"');for(g("\n")?(++S,x=0):g(","),o=(f={if:{cond:c,statements:[]},elseif:[],else:{statements:[]}}).if;;)if((c=i(["elseif","else","end"]))&&(o.statements=o.statements.concat(c)),g("elseif")){if(!(c=i("\n,")))throw A('missing or invalid condition in "elseif"');g("\n")?(++S,x=0):g(","),f.elseif.push({cond:c,statements:[]}),o=f.elseif[f.elseif.length-1]}else if(g("else"))g(/^[ \t\v\f]+/),g("\n")?(++S,x=0):g(","),o=f.else;else if(g("end")||!c)break;s.push(R(Wt,f))}else if(g(/^for\b/)){if(m(!0),!(r=g(/^\s+([_a-z][_a-z0-9]*)\s*=\s*/i)))throw A('missing or invalid declaration in "for"');if(!(c=i("\n,")))throw A('missing or invalid declaration in "for"');for(g("\n")?(++S,x=0):g(","),f={ind:Qt(y,r[1]),val:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(R(Ut,f))}else if(g(/^while\b/)){if(m(!0),!(c=i("\n,")))throw A('missing or invalid condition in "while"');for(g("\n")?(++S,x=0):g(","),f={cond:c,statements:[]};(c=i(["end"]))&&(f.statements=f.statements.concat(c)),!g("end")&&c;);s.push(R(Bt,f))}else if(r=g(/^(continue|break|elseif|else|end)\b/,!1)){if(n&&-1<n.indexOf(r[1]))break;if("continue"===r[1])g("continue"),s.push(R("continue",""));else if("break"===r[1])g("break"),s.push(R("break",""));else{if("end"!==r[1])throw A('unexpected "'+r[1]+'"');g("end"),a.unshift(R("v",Qt(y,"end")))}}else if(g("..."))g(/^[ \t\v\f]+/),g("\n")&&(++S,x=0);else if(g(";",!1)){if(n&&-1<n.indexOf(";"))break;g(";"),m(!0)}else if(g("\n",!1)){if(n&&-1<n.indexOf("\n"))break;g("\n"),++S,m(!(x=0))}else if(g(/^\s+/)){if(n&&-1<n.indexOf(" "))break}else if(r=g("%"))b=v.indexOf("\n"),v=v.slice(-1<b?b+1:v.length),-1<b&&++S,m(!(x=0));else if(r=(r=g("'"))||g('"'))o=p(r[0],!0)[0],a.unshift(R("'"===r[0]?o.split(""):o));else if(r=g(/^(&&|\|\|)[^&\|]/,1))u=r[1],l.unshift([u,x,S]),h();else if(r=g(/^(xor)[^a-zA-Z]/,1))u=r[1],l.unshift([u,x,S]),h();else if(r=g(/^(>=|<=|==|~=|>|<)[^<>=]/,1))u=r[1],l.unshift([u,x,S]),h();else if(r=g("~"))l.unshift(["~",x,S]),h();else if(r=g("="))l.unshift(["=",x,S]),h();else if(r=g(/^(\+|-|\.\*|\*|\.\/|\/|\\|\.\^|\^)/i))u=r[0],l.unshift([u,x,S]),h();else if(r=g(/^([_a-z][_a-z0-9]*)\s*\(/i)){if(t=r[1],g(/^\s*\:\s*\)/))o=R("v",Qt(y,t)),a.unshift(o),l.unshift(["(:)",x,S]),h();else{for(f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw A("mismatched parentheses");o=un.call(E,t)?R(E[t],f):R("v",Qt(y,t,f.length?f:null)),a.unshift(o)}g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,S]),h())}else if(r=g(/^[_a-z][_a-z0-9]*/i))t=r[0],o=un.call(E,t)&&0===E[t].length?R(E[t],[]):R("v",Qt(y,t)),a.unshift(o),g(/^[ \t\v\f]+/),(r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,S]),h());else if(r=g(/^(-?\s*\d+(\.\d+)?([eE][+-]?\d+)?)([ij])?/))f=r[1].split(/\s+/).join(""),f=_?_(f):parseFloat(f,10),o=R(r[4]?new I(0,f):f),a.unshift(o);else if(r=g(/^(-?\s*\.\d+([eE][+-]?\d+)?)([ij])?/))f="-"===(f=r[1].split(/\s+/).join("")).charAt(0)?"-0"+f.slice(1):"0"+f,f=_?_(f):parseFloat(f,10),o=R(r[4]?new I(0,f):f),a.unshift(o);else if("["===(e=v.charAt(0)))v=v.slice(1),x+=1,(o=d())&&(a.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,S]),h());else{if("]"===e){if(n&&-1<n.indexOf("]"))break;throw A("mismatched brackets")}if("("===e)if(v=v.slice(1),x+=1,g(/^\s*\:\s*\)/))l.unshift(["(:)",x,S]),h();else{if(a.length&&l.reduce(function(n,r){return r=$t[r[0]],n+(r.arity>a.length-n&&null!=r.arityalt?r.arityalt:r.arity)},0)<=a.length){for(h("set"),o=a.shift(),f=[];(c=i(",)"))&&f.push(c),g(","););if(!g(")"))throw A("mismatched parentheses");f.length&&(o=R("v",Qt(y,o,f)))}else if(o=i(")"),!g(")"))throw A("mismatched parentheses");o&&(a.unshift(o),g(/^[ \t\v\f]+/),r=(r=g("'"))||g(".'"))&&(l.unshift([r[0],x,S]),h())}else{if(")"===e){if(n&&-1<n.indexOf(")"))break;throw A("mismatched parentheses")}if(","===e&&n&&-1<n.indexOf(","))break;if(":"!==e)throw A(n?'missing expected "'+(k(n)?n.split(""):n).join('" or "')+'"':'unexpected "'+e+'"');if(n&&-1<n.indexOf(":"))break;for(v=v.slice(1),c=[x+=1,S],h("set"),a.length?f=1:(f=0,a.unshift(R(":")));o=i(":,)\n"),g(/^[ \t\v\f]+/),o?(a.unshift(o),++f):g(":",!1)&&a.unshift(R(":")),g(":"););1<f&&(l.unshift([3===f?"::":":",c[0],c[1]]),h())}}return m(!0),0===s.length?null:1===s.length?s[0]:s}(!1)}async function Dt(n,r,t){var e;if(an(n,R)){if(""===n.op)return n.arg;if("v"===n.op)return!1===r?n.arg:an(n.arg.v,R)?Vt(n.arg):sn(r)&&un.call(r,n.arg.v)?r[n.arg.v]:await Vt(n.arg);if(Wt===n.op)return Wt(n.arg,r,t);if(Ut===n.op)return Ut(n.arg,r,t);if(Bt===n.op)return Bt(n.arg,r,t);if("break"===n.op)return void(t&&ln(t.brk)&&t.brk());if("continue"===n.op)return void(t&&ln(t.cont)&&t.cont());if($t["="].fn===n.op)return t=t||{},e=await Dt(n.arg[0],!1),A(e)&&an(e[0],Qt)&&(t.nargout=e.length),2===n.arg.length&&"v"===n.arg[1].op?n.op.apply(null,[e,n.arg[1].arg.isByRef()?Sn(await Dt(n.arg[1],r,t)):await Dt(n.arg[1],r,t)]):n.op.apply(null,[e].concat(await Promise.all(n.arg.slice(1).map(function(n){return Dt(n,r,t)}))));if(ln(n.op))return(t&&p(t.nargout)&&ln(n.op.nargout)?n.op.nargout(t.nargout):n.op).apply(null,await Promise.all(n.arg.map(function(n){return Dt(n,r,t)})))}throw"invalid expr"}return fn.op=$t,Qt.prototype={constructor:Qt,ctx:null,v:null,i:null,get:async function(n){var r,t,e=this;if(an(e.v,R))r=await Gt(e.v);else{if(!un.call(e.ctx,e.v)&&!un.call(cn,e.v))throw'undefined variable "'+e.v+'"';r=(un.call(e.ctx,e.v)?e.ctx:cn)[e.v]}return!0!==n&&null!=e.i?(t=Zr(r),n=await Promise.all(e.i.map(function(n,r){return Gt(n,{end:1===e.i.length?t[0]*t[1]:t[r]})})),or.apply(null,[r].concat(n))):r},set:async function(n){var r,t,e,i=this;if(null!=i.i){if(an(i.v,R))r=await Gt(i.v);else{if(!un.call(i.ctx,i.v))throw'undefined variable "'+i.v+'"';r=i.ctx[i.v]}t=Zr(r),1===(e=await Promise.all(i.i.map(function(n,r){return Gt(n,{end:1===i.i.length?t[0]*t[1]:t[r]})}))).length&&(e=e.concat(null)),fr.apply(null,[r].concat(e).concat([n]))}else an(i.v,R)||(i.ctx[i.v]=n);return i},isset:function(){return k(this.v)&&un.call(this.ctx,this.v)},isByRef:function(){return null==this.i}},R.prototype={constructor:R,op:null,arg:null},c.createContext=function(){return{ans:null}},c.eval=async function(n,r,t){r=r||c.createContext();var e=Ht(String(n),r,null==t?1:t,1),i=null,u=!1;if(A(e))for(var o=0,f=e.length;o<f;++o)e[o]&&(i=await Dt(e[o]),u=!0);else e&&(i=await Dt(e),u=!0);return u&&(A(i)||hn(i)||w(i)||k(i))&&(r.ans=i),u?i:null},fn});